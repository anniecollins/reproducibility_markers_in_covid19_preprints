bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5

FISIK: Framework for the Inference of in Situ Interaction Kinetics from singlemolecule imaging data
L. R. de Oliveira and K. Jaqaman

1

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23

Abstract
Recent experimental and computational developments have been pushing the limits of live-cell
single-molecule imaging, enabling the monitoring of inter-molecular interactions in their native
environment with high spatiotemporal resolution. However, interactions are captured only for the
labeled subset of molecules, which tends to be a small fraction. As a result, it has remained a
challenge to calculate molecular interaction kinetics, in particular association rates, from live-cell
single-molecule tracking data. To overcome this challenge, we developed a mathematical
modeling-based Framework for the Inference of in Situ Interaction Kinetics from single-molecule
imaging data with sub-stoichiometric labeling (termed â€œFISIKâ€). FISIK consists of (I) devising a
mathematical model of molecular movement and interactions, mimicking the biological system
and data-acquisition setup, and (II) estimating the unknown model parameters, including
molecular association and dissociation rates, by fitting the model to experimental single-molecule
data. Due to the stochastic nature of the model and data, we adapted the method of indirect
inference for model calibration. We validated FISIK using a series of tests, where we simulated
trajectories of diffusing molecules that interact with each other, considering a wide range of model
parameters, and including resolution limitations, tracking errors and mismatches between the
model and the biological system it mimics. We found that FISIK has the sensitivity to determine
association and dissociation rates, with accuracy and precision depending on the labeled fraction
of molecules and the extent of molecule tracking errors. For cases where the labeled fraction is too
low (e.g. to afford accurate tracking), combining dynamic but sparse single-molecule imaging data
with almost whole-population oligomer distribution data improves FISIKâ€™s performance. All in
all, FISIK is a promising approach for the derivation of molecular interaction kinetics in their
native environment from single-molecule imaging data with sub-stoichiometric labeling.

2

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11

Significance
Live-cell single-molecule imaging has the unique power to capture inter-molecular interactions in
their native environment. However, single-molecule approaches in cells suffer from the inherent
limitation that only a small fraction of molecules can be visualized at a time. Therefore, it has
remained a challenge to calculate interaction rates, especially association rates, from these data.
We have developed a mathematical modeling and model calibration-based framework (FISIK) to
address this challenge, and derive molecular interaction rates from the subset of interactions
captured by single-molecule imaging with sub-stoichiometric labeling. FISIK is a general
framework, not limited to any particular interaction model, and is thus expected to be widely
applicable, allowing the full use of the rich information provided by single-molecule imaging
experiments.

3

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44

Introduction
Light microscopy is providing information on molecular activities in cells with ever-increasing
sensitivity and spatial and temporal resolution. Modalities such as live-cell single-molecule
imaging provide the highest sensitivity and resolution, reporting on the dynamic activities of
individual molecules. Recent experimental and computational developments have been pushing
the limits of single-molecule imaging to capture not only molecular movement â€“ the traditional
strength of single-molecule imaging (1-3) â€“ but also inter-molecular interactions (4-9). Capturing
molecular interactions in their native cellular environment provides critical spatial and temporal
context for the observed interactions. For example, receptor interactions in their native plasma
membrane environment can have different kinetics from the interactions observed via traditional
3D in vitro methods (5, 10, 11). These kinetics might also depend on the cellular environment and
subcellular context (12). Additionally, microscopy approaches allow the study of interactions
between proteins, such as transmembrane proteins, that are difficult to purify for traditional
biophysical studies.
However, most live-cell single-molecule approaches, from direct one-color and multi-color
imaging (4, 6-8, 13, 14) to single-molecule FÃ¶rster resonance energy transfer (smFRET) (5, 15),
suffer from the inherent limitation that only a small fraction of molecules can be visualized at a
time. Such sub-stoichiometric labeling is necessary because of diffraction, which limits resolution
to ~200 nm laterally and ~500 nm axially, and because of the need to track the imaged molecules
over time (16). As a consequence of sub-stoichiometric labeling, it is challenging to calculate
molecular interaction rates from single-molecule experiments, in spite of the rich information they
might provide. This is because only a small subset of interaction events can be captured in singlemolecule imaging
experiments.
Importantly,
this
subset
is
biased
toward
oligomers/complexes/clusters with a smaller number of molecules. For example, if 10% of
molecules are labeled, then only 1% of dimers would be fully labeled and thus visualized as dimers,
0.1% of trimers, etc.
To the best of our knowledge, there are less than a handful of previous studies that have
estimated molecular interaction rates from single-molecule data with sub-stoichiometric labeling.
These studies were primarily focused on the special cases of dimerization (8, 17) and bimolecular
interactions (14). Additionally, to derive association rates, they employed single-molecule
experiments with a high-labeled fraction, greater than 75% (14, 17). Such a high degree of labeling
is generally not compatible with single-molecule imaging for most molecules at their endogenous
expression levels.
To fill this technological void, here we present a generic, mathematical modeling-based
approach to calculate interaction kinetics from single-molecule data with sub-stoichiometric
labeling, termed FISIK (Framework for the Inference of in Situ Interaction Kinetics). FISIK
consists of two components: (I) devising a mathematical model that mimics the dynamics,
interactions and sub-stoichiometric labeling of the molecular system, and (II) calibrating the model
with single-molecule data to estimate the unknown model parameters, including the molecular
association and dissociation rates. To test the feasibility, strengths and limitations of FISIK, here
we applied it to the case of movements and interactions in 2D, applicable to e.g. cell-surface
receptors, a system often studied with single-molecule imaging (4-9). To the best of our
knowledge, this is the first attempt to develop a generic framework to derive molecular interaction
rates from single-molecule data with sub-stoichiometric labeling, not limited to

4

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44

dimerization/bimolecular interactions. Our proof-of-principle tests also shed light on experimental
design strategies that can be employed to maximize the performance of FISIK and derive the
molecular interaction rates of interest.

Methods
1. Overall workflow of FISIK
FISIK consists of two components (Fig 1):
Component I. A stochastic mathematical model of molecular movement and interactions,
mimicking the biological system and data acquisition setup, including sparse labeling. Many
parameters in this model are derived explicitly from the experimental data and directly input into
the model, such as molecular movement properties and most data acquisition parameters (e.g.
sampling rate). This constrains the
modeling and leaves only a few unknown
model parameters, including the rates of
molecular association and dissociation, to
be estimated by fitting the model to
experimental single-molecule data. The
specific model employed to test the
easibility of FISIK is described in
subsection 2 below.
Component II. Model Calibration
with experimental single-molecule data to
estimate molecular association and
dissociation rates. The stochasticity of
molecular movement and interactions,
compounded by the labeling of a random
subset of molecules, makes it meaningless
to compare model-generated and
experimental molecular trajectories and
interaction instances point-by-point for
model calibration, as would be done for a
deterministic system. Therefore, we have
devised a stochastic model calibration
algorithm by adapting the method of
Indirect Inference (18-20). In this Figure 1. FISIK workflow. FISIK consists of two
approach, the model-generated (termed components: (I) Building a mathematical model
â€œprobeâ€) and experimental (termed and generating simulated data (probe) that mimic
â€œtargetâ€) data are first analyzed to extract the biological system and acquired experimental
from them descriptors, called intermediate data (target). (II) Fitting the model to target data in
statistics, which characterize them. The order to determine the unknown model parameters,
specific intermediate statistics used for including molecular association and dissociation
calibrating our test model, which are rates. This requires a stochastic model calibration
closely related to the unknown model framework, as both model and data are stochastic.
parameters, are discussed in subsection 4

5

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43

below. The choice of intermediate statistics is critical for the success of statistical inference
methods such as Indirect Inference. The intermediate statistics should be sufficient, i.e. they should
capture the important information about the system, yet they should minimize redundancy (21,
22). The difference between probe and target is then taken as the difference between their
respective intermediate statistics, calculated as the Mahalanobis distance between them (23).
Specifically, if Î¸prb and Î¸tar are, respectively, the intermediate statistics of the probe and target data,
with associated variance-covariance matrices Vprb and Vtar, then the Mahalanobis distance S is
calculated as:
âˆ’1
ğ‘†ğ‘† = ï¿½ğœƒğœƒğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ âˆ’ ğœƒğœƒğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ ï¿½â€²ï¿½ğ‘‰ğ‘‰ğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ + ğ‘‰ğ‘‰ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ ï¿½ ï¿½ğœƒğœƒğ‘ğ‘ğ‘ğ‘ğ‘ğ‘ âˆ’ ğœƒğœƒğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ğ‘¡ ï¿½.
(1)
Casting the comparison in terms of the Mahalanobis distance has two advantages: (i) The
difference between intermediate statistics gets weighted by their variance-covariance matrices,
thus accounting for the statisticsâ€™ uncertainties when calculating the difference between target and
probe. (ii) Under the null hypothesis that Î¸prb = Î¸tar, and given that the intermediate statistics are
normally distributed (as verified using a Lilliefors test, which gave p-values in the range 0.12-0.5),
S follows a Ï‡2-distribution with number of degrees of freedom equal to number of intermediate
statistics. This allows us to calculate a comparison p-value for any given S, facilitating the
interpretation of the value of S (24, 25). Specifically, probes with comparison p-value < Î± (e.g.
0.05) are considered statistically different from the target, and are thus outside the solution range.
Probes with p-value â‰¥ Î± are statistically indistinguishable from the target, and are thus possible
solutions.
Note that, at the conceptual level, FISIK is not limited to using Indirect Inference for
stochastic model calibration. Other methods, such as Bayesian Inference (26, 27), including
Approximate Bayesian Computation (28-30), are expected to be equally applicable.
2. Stochastic model of molecular movement, interactions and sub-stoichiometric labeling
To test the feasibility of FISIK, we employed a simple stochastic model of molecular diffusion
and interactions in 2D, as well as sub-stoichiometric labeling to mimic single-molecule sampling.
A 2D model is less computationally intensive to simulate than a 3D model, while at the same time
providing equal power to test the feasibility of FISIK. Additionally, a 2D model is a reasonable
approximation of e.g. receptor movement on the cell surface, a system that is particularly
accessible and heavily studied by single-molecule imaging approaches (4-9). Membrane proteins
are also challenging to purify for traditional in vitro biophysical methods, making cell-based
imaging approaches particularly useful to study them. The model contains only one molecular
species (e.g. a particular receptor type), which can oligomerize into dimers, trimers, etc. Note that
in the following and subsequent descriptions, oligomer(n) indicates an oligomer of size n, where
n = 1 means monomer, n = 2 means dimer, n = 3 means trimer, etc. The terms monomer and
oligomer(1) will be used interchangeably, as needed for compactness of description.
In this simple model, molecules have a 2D density Ï and undergo 2D free diffusion with
diffusion coefficient D. When a monomer and an oligomer(n â‰¥ 1) encounter each other, i.e. their
pairwise distance â‰¤ dsize (taken as 10 nm, assuming a molecular radius of ~ 5 nm), they associate
with probability pa(n+1) to form an oligomer(n+1). The case of n = 1 is the special case of two
monomers associating to form a dimer. Molecules in an oligomer diffuse together, with the same
diffusion coefficient D. For an oligomer(n â‰¥ 2), a molecule can dissociate from it with rate koff(n),

6

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44

to produce a monomer and an oligomer(n-1) (note that association and dissociation are limited to
one molecule at a time).
To mimic single-molecule imaging with sub-stoichiometric labeling, a fraction f of the
molecules is labeled, with individual fluorophore intensity Iind ~ N(Î¼ind,Ïƒind) (for Ïƒind > 0, the
intensity of an individual fluorophore fluctuates over time, mimicking realistic fluorophore
intensity fluctuations). The remaining fraction of molecules (1-f) is invisible. Therefore, while all
molecules diffuse and interact, only the trajectories of labeled molecules and the interactions
between labeled molecules are visible. Note that if a labeled molecule interacts with an unlabeled
molecule, that interaction is not visible and is not recorded in the output trajectory of the labeled
molecule.
The unknown parameters in this model are the motion parameter D, the interaction
parameters pa(n) and koff(n) (n = 2, 3, 4, â€¦), the population parameters Ï and f, and the fluorophore
intensity parameters Î¼ind and Ïƒind. Among these parameters, D can be estimated directly from the
single-molecule data, as it is not affected by under-sampling. The fluorophore intensity parameters
are simplified to Î¼ind = 1 and Ïƒind = 0 for probe simulations, but can otherwise be estimated
experimentally as well, using e.g. monodispersion experiments (6). The remaining parameters,
however, must be estimated by fitting the model to experimental data, as described in the general
framework above (subsection 1), and using the intermediate statistics described in subsection 4
below.
3. Kinetic Monte Carlo simulations
To generate molecular trajectories and interactions from the above model, we used kinetic Monte
Carlo simulations explicit in both space and time (effectively particle-based reaction-diffusion
simulations, similar to (31, 32), although in 2D instead of 3D). In these simulations, space is treated
as a continuum, while time is discretized into a series of time steps Î”t, where Î”t is small enough
to minimize discretization artifacts (more on this below). To simulate molecules at density Ï within
a simulation area A, Nmol = Ï Ã— A molecules are initially placed randomly within the simulation
area, all starting as monomers. Reflecting boundary conditions are used to keep the molecules
within the simulation area. Each simulation starts with an initialization time Tinit (usually 10 s) so
that the system reaches steady state (Fig S1A; Table S1, Row 1), followed by the desired
simulation time Tsim. Only the post-initialization time (i.e. steady-state) trajectories and
interactions are output for further processing and analysis.
At every time point t after the initial time point, molecules can dissociate, move and
associate, in this order, as described in the following:
(1) Molecule dissociation: For each oligomer(n â‰¥ 2) at the previous time point (t â€“ Î”t), one
molecule can dissociate from it at time point t with probability poff(n) = koff(n) Ã— Î”t, producing a
monomer and an oligomer(n-1). If a dissociation happens, the involved monomer and oligomer
are not allowed to associate with each other or with any other monomer or oligomer in the current
time point (step 3 below), to avoid what will appear as instantaneous swapping of molecules
between oligomers in one time point. This constraint is acceptable as long as the time step is small
enough, as demonstrated by our validation tests (Fig 2).
(2) Initial update of molecule positions: Under the model of free diffusion, each oligomer(n
â‰¥ 1) takes a step from time point t â€“ Î”t to time point t with x- and y-components, sx and sy, ~
ğ‘ğ‘(0, âˆš2ğ·ğ·âˆ†ğ‘¡ğ‘¡ ) , where D is the diffusion coefficient. As mentioned above, all molecules within an
7

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44

oligomer move together. Note that if a molecule has dissociated from an oligomer (step 1 above),
it moves independently of the oligomer to which it used to belong. The resulting positions are
considered â€œinitial positionsâ€ because, as described next, these positions might be altered by
association.
(3) Molecule association and final update of positions: From the model definition, if the distance
between two molecules â‰¤ dsize (= 10 nm) at time point t, they are considered to encounter each
other and thus might associate. However, due to time discretization in the simulations, molecules
might pass by each other as they move from time point t â€“ Î”t to time point t, but the distance
between them might be greater than dsize at both time points. Therefore, we devised a simulation
strategy to compensate for the effect of finite Î”t on molecular encounters. The compensation
strategy is based on assigning molecules an â€œeffective radiusâ€ (Reff) based on their extent of
movement within Î”t rather than their physical size, defined as ğ‘…ğ‘…ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ğ‘’ = âˆš4ğ·ğ·âˆ†ğ‘¡ğ‘¡. This allows us to
define a movement-based encounter distance, dmove = 2Reff. For example, for D = 0.1 Î¼m2/s, dmove
= 12.6 nm (â‰ˆ dsize = 10 nm) for Î”t = 10-4 s, but dmove = 126 nm for Î”t = 10-2 s. In the simulation,
the encounter distance dencounter is then taken as max(dsize, dmove). Testing this compensation strategy
demonstrated that it renders the simulation output insensitive to Î”t up to 10-2s (Fig S1B), a
practically feasible Î”t, which is more than 2 orders of magnitude larger than the Î”t needed to avoid
time discretization artifacts.
With this, all monomer-oligomer(n â‰¥ 1) pairs with pairwise distance â‰¤ dencounter are
considered as encounter candidates. If any objects (monomers or oligomers) appear in more than
one pair because their distance â‰¤ dencounter to more than one object, graph matching is used to resolve
these conflicts globally (33) and impose that each object may interact with only one other object
per time point. With this, monomer-oligomer(n â‰¥ 1) pairs that encounter each other can associate
with probability pa(n+1) to form an oligomer(n+1). When an association happens, the position of
the resulting oligomer is the average position of the two associating objects. This yields the final
positions of molecules at time t of the simulation.
Particle tracks output of kinetic Monte Carlo simulations.
The trajectories output by the simulation code to use for further analysis within FISIK are in the
same form as tracks obtained via multiple particle tracking of one-color single-molecule data
(using e.g. u-track (7)). Every object (monomer or oligomer) becomes a particle, and the only
information stored are its position and intensity over time (as with experimental single-molecule
data). When an association happens, two particles merge into one. When a dissociation happens,
one particle splits into two. The time step for the output particle tracks is a user-specified
parameter, generally chosen to match the experimental data time step.
Note that the oligomeric state of particles is not stored explicitly, as this information is not
a direct output of single-molecule imaging experiments. However, for probe simulations, where
the individual fluorophore intensity Iind ~ N(1,0), particle intensity is effectively equal to
oligomeric state. For target simulations, on the other hand, the individual fluorophore Ïƒind > 0, as
would be the case for experimental single-molecule data. In this case, the oligomeric state of the
particles is unknown and is subsequently estimated from the particle intensities and their merging
and splitting history, as described in the next section.
4. Single-molecule data analysis to calculate intermediate statistics

8

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15

Estimation of oligomeric state from particle intensities and merging and splitting history
The first step for calculating the intermediate statistics is to estimate the oligomeric state of each
particle over time, i.e. it dynamic oligomerization history, using the available information, namely
the particle intensities and their merging and splitting history. For this, particle tracks are divided
into segments, where each segment starts via an appearance or a split, and ends via a disappearance
or a merge. The dynamic oligomerization history is then determined as follows:
For probe data: Because the individual fluorophore intensity Iind ~ N(1,0) in probe
simulations, the oligomeric state of a probe particle over time is given by its intensity over time.
For target data (whether experimental or simulated): The oligomeric state of each track
segment is determined using constrained least squares minimization. Specifically, suppose a group
of Nseg segments undergo merging and splitting events with each other (in the example shown in
Fig S2A, Nseg = 5). Given a mean intensity Ij for each segment j (j = 1, 2, â€¦, Nseg), the oligomeric
states sj (j = 1, 2, â€¦, Nseg) of all segments in the group are determined by minimizing the least
squares function F:
=
F

Nseg

âˆ‘ ( s j Âµind âˆ’ I j )

2

,

(2)

j =1

16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40

where Î¼ind is the (known) mean intensity of an individual fluorophore. The minimization is subject
to constraints from the merging and splitting history of the segments, imposing conservation of
number of molecules. We will use the example shown in Fig S2A to illustrate the constraints: In
that example, segments 1 and 2 merge to form segment 3, and then segment 3 splits into segments
4 and 5. This imposes the constraints that:
s1 + s2 = s3 and s3 = s4 + s5.
(3)
Thus, for the example shown in Fig S2A, F in Eq. 2 will be minimized subject to the constraints
in Eq. 3. Given the integer nature of the unknown oligomeric states, the constrained least squares
minimization is solved as a Mixed Integer Quadratic Programming problem (using the Package
YALMIP (34) (https://yalmip.github.io/)). Of note, Eq. 2 is a simplification of the real objective
function to be minimized, which should weight each term j by its oligomeric state, as the variance
generally increases with number of fluorophores being summed up. In addition, fluorophore
fluorescence can follow a log-normal distribution, rather than a normal distribution as assumed in
Eq. 2 (35). Nevertheless, Eq. 2 is an acceptable simplification because the constraints play the
major role in determining the oligomeric state.
This analysis yields the dynamic oligomerization history of the labeled molecules
throughout the simulation/observation time.
Calculation of intermediate statistics
Within the framework of Indirect Inference, FISIK uses the labeled oligomer densities and the
labeled molecule dissociation rates as intermediate statistics. These intermediate statistics were
chosen because they are closely related to the unknown model parameters, namely the interaction
parameters pa(n) and koff(n) (n = 2, 3, 4, â€¦) and the population parameters Ï and f. Their choice
was also validated a posteriori as they indeed enabled FISIK to estimate the unknown model
parameters (as discussed in the Results section).

9

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41

Using the labeled moleculesâ€™ dynamic oligomerization history (generated as described
above), the intermediate statistics are calculated as follows for each simulation (or experimental
time lapse in the case of experimental data):
(i) Labeled oligomer densities: Having the oligomeric state of every particle at every time
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
point, the average density of monomers (ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(1)), dimers (ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(2)), etc. is calculated. The
superscript â€œlabâ€ is to emphasize that these are the oligomeric states and their densities as revealed
by the labeled subset of molecules.
(ii) Labeled molecule dissociation rates: These are derived by treating transitions between
labeled oligomeric states as a Markov process. If there are labeled molecule oligomers up to
lab
lab
oligomeric state Omax
, then the Markov process consists of Omax
states (Fig S2B). For each
oligomeric state n â‰¥ 2, we calculate from the dynamic oligomerization history its average lifetime
ğœğœ(ğ‘›ğ‘›) and its probability pnâ†’n-1 to transition to state n-1 (i.e. a labeled molecule dissociates; Fig
S2B). Inverting the Gillespie algorithm for the simulation of stochastic processes (36), the labeled
molecule dissociation rate is then calculated as
ğ‘ğ‘
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(ğ‘›ğ‘›) = ğ‘›ğ‘›â†’ğ‘›ğ‘›âˆ’1
,
ğ‘›ğ‘› = 2, 3, â€¦ , ğ‘‚ğ‘‚ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š
.
(4)
ğœğœ(ğ‘›ğ‘›)
Note that, in order to minimize redundancy between intermediate statistics (21), the labeled
molecule association rates are not used as intermediate statistics. This is because, under the
assumption of steady state, they are simply calculated from the labeled molecule oligomer
densities and labeled molecule dissociation rates:
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œ
(ğ‘›ğ‘›) =

ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(ğ‘›ğ‘›)ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(ğ‘›ğ‘›)

ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(ğ‘›ğ‘›âˆ’1)ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(1)

,

ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
n = 2, 3, â€¦ , ğ‘‚ğ‘‚ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š
.

(5)

In other words, the labeled molecule densities and off rates are sufficient to capture all the available
information about the molecular interactions of interest.
With this, the vector of intermediate statistics describing each simulation/experimental
time lapse is constructed as
lab
lab
lab
lab
lab
lab
lab ï£¹â€²
(6)
, koff
Î¸ = ï£® Ïoligo
Omax
Omax
(1) , Ïoligo
( 2 ) ,ï‹ , Ïoligo
( 2 ) ,ï‹ , koff
ï£°
ï£»
For a probe/target represented by multiple simulations (or multiple experimental time
lapses), its vector of intermediate statistics Î¸prb/Î¸tar and associated variance-covariance matrix
Vprb/Vtar are calculated as the mean and covariance, respectively, of the intermediate statistics
vectors from its multiple simulations. The calculated Î¸prb and Î¸tar and associated Vprb and Vtar are
then used in Eq. 1 to calculate the Mahalanobis distance to compare probes and targets.

(

)

(

)

Results and Discussion
The intermediate statistics accurately characterize the modeled molecular interactions
To validate our choice of intermediate statistics, we employed simulations where all molecules
were labeled, in which case there are straightforward relationships between the input model
parameters and the calculated intermediate statistics. We systematically varied the model
parameters, i.e. Ï, pa, koff and D and investigated how the intermediate statistics responded. Note
that, for the sake of simplicity, in these and most of the following tests pa refers to pa(2 â‰¤ n â‰¤ 5)
(all equal) and koff refers to koff(2 â‰¤ n â‰¤ 5) (also all equal). Unless explicitly stated otherwise, pa(n
> 5) = 0, i.e. the maximum oligomer that could be formed was a pentamer. The simulation
parameters employed for these tests are shown in Table S1, Row 1.

10

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1

Figure 2. The intermediate statistics accurately reflect the modeled interactions. (A-E)
Influence of varying molecule density Ï (A), dissociation rate koff (B), association probability
pa (C), diffusion coefficient D (D) and labeled fraction f (E) on the intermediate statistics
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
lab
ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
, k lab
off and k on . Shown are the mean and standard deviation from 10 simulations per
parameter combination. Each panel explicitly states the varied parameter values, while the
parameters not stated take on the following values: Ï = 4 mol/Âµm2, pa = 0.05, koff = 1/s, D = 0.1
Âµm2/s and f = 1. In the first column, the right-most measurement (with gray background) is the
total molecule density (ğœŒğœŒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ ) as calculated from the oligomer densities: ğœŒğœŒğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ = âˆ‘ğ‘›ğ‘›â‰¥1 ğ‘›ğ‘› Ã—
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
(ğ‘›ğ‘›). Note that the left and right y-axes have different ranges. (E) shows the oligomer
ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
fraction instead of oligomer density to illustrate better the shift toward smaller labeled oligomer
sizes as the labeled fraction decreases.

11

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43

ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
The calculated total molecule density (Ïlab) and dissociation rate (ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
) were equal to their
corresponding input values, and they only varied when their input values were changed (Fig 2Ağ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
D, 1st and 2nd columns; ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
was slightly underestimated for input koff = 2/s because of the
employed output trajectory time step of 0.1 s). The distribution of oligomeric states
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
(ğ‘›ğ‘›); ğ‘›ğ‘› = 1, 2, 3, â€¦ , ğ‘‚ğ‘‚ğ‘šğ‘šğ‘šğ‘šğ‘šğ‘š
(ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
) shifted toward higher values as the input pa or D increased, or
the input koff decreased (Fig 2A-D, 1st column). While not used as an intermediate statistic, we also
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
investigated how the calculated association rate (ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œ
) varied with model parameters, as this
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
information is implicitly contained in ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ (ğ‘›ğ‘›) and ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
. We found that ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œ
varied
approximately linearly with the input pa and D, and was largely independent of the input Ï and koff
(Fig 2A-D, 3rd column), as it should be. These results validate our simulation and intermediate
statistics calculation strategy, and support our choice of intermediate statistics to capture the
relevant information about the system for model calibration.
Before proceeding to test FISIK, we also investigated how the intermediate statistics varied
with the labeled fraction f (Fig 2E). This would aid us in interpreting our test results. As expected,
reducing f shifted the distribution of labeled molecule oligomeric states toward lower values,
completely eliminating in some cases the observation of higher oligomeric states, and reduced
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œ
. More interestingly, because less interaction events were visible for simulations with lower f,
all oligomeric states, except for the highest one, appeared longer-lived than they truly were, leading

lab
to a reduced koff
as well.

FISIK can estimate interaction parameters from single-molecule trajectories with substoichiometric labeling, provided a sufficient fraction/number of molecules is labeled
In order to achieve reasonably accurate particle tracking, most 2D single-molecule imaging
experiments operate at a labeled molecule density roughly in the range 0.1-1 mol/Î¼m2 (7, 9, 16).
Therefore, as a first test of FISIK, we focused on simulations with relatively low molecule densities
(Ï = 1-16 mol/Î¼m2), in order to afford low-medium labeled fractions (f = 0.1-0.6). Taking the
example of cell-surface receptors, such densities are realistic for various receptor types, such as
CD36 (6), EpoR (37), LDLR (38) and various GPCRs (14, 17). Because the parameter inference
problem is expected to get more difficult as the labeled fraction gets smaller â€“ an expectation that
is met in our tests as will be discussed shortly â€“ these initial studies test FISIK under relatively
favorable conditions.
For these studies we used the model parameters in Table S2, Row 1 (see also Fig 3) and
simulation parameters in Table S1, Row 2. The values of D and koff were motivated by singlemolecule observations of a variety of cell surface receptors (6, 8, 14). The relatively small values
of pa were chosen to reflect that molecules must have the correct relative orientation in order to
ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
associate (39). Of note, the combination of D and pa values indeed resulted in ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œ
that was within
the range of experimentally observed values (14, 17). The probe parameter landscape consisted of
3360 parameter combinations, each represented by 10 simulations. This probe landscape was
tested against several targets, each also represented by 10 simulations. However, to mimic
molecule density variability between cells, the target simulations differed from the probe
simulations in that the density varied between the 10 simulations of each target, following a normal
distribution with mean = the specified density and standard deviation = 0.1 Ã— mean. Additionally,
to mimic individual fluorophore intensity fluctuations and the fact that the oligomeric state is

12

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39

unknown in experimental single-molecule data, in the target simulations the individual fluorophore
intensity fluctuated over time, following the distribution Iind ~ N(1,0.3) (in the probe simulations
Iind ~ N(1,0)). The target parameters were chosen to span a wide range of values for the interaction
parameters pa and koff and the population parameters Ï and f.
In the following we discuss our major findings from these tests, using representative targets
for demonstration. Taking the target Ï = 4 Â± 0.4 mol/Âµm2, f = 0.2, pa = 0.05 and koff = 1/s as our
reference point, we will first explain how the parameter inference results are displayed (Fig 3A).
As explained in Methods, Section 1, the difference between a probe and a target is calculated as
the Mahalanobis distance between their intermediate statistics (Eq. 1), which is converted to a pvalue. Thus the results are shown as p-value landscapes. However, because we are searching in a
4-dimensional parameter space, the p-value landscapes are shown in two steps. In the first step,
the Ï vs. f landscape is shown on the left, where each rectangle is a â€œsummary viewâ€ of the koff vs.
pa landscape corresponding to each Ï-f pair (specifically, it shows the maximum p-value obtained
for the underlying koff vs. pa landscape). White rectangles indicate Ï-f pairs containing no matches
with the target (for any tested koff-pa combination). Non-white rectangles indicate Ï-f pairs
containing some matches with the target (for some koff-pa pairs, as explained next). Darker
rectangles indicate matches with higher p-value. In the second step, the non-white rectangles in
the Ï vs. f landscape are â€œexpandedâ€ on the right, to show the full koff vs. pa landscapes
corresponding to those Ï-f pairs. Again, white rectangles indicate koff-pa pairs (for each Ï-f pair)
that do not match the target (p-value < 0.05), non-white rectangles indicate koff-pa pairs (for each
Ï-f pair) that are considered to match the target (p-value â‰¥ 0.05), and darker rectangles indicate
higher p-values.
For the reference target (Fig 3A), FISIK was able to identify the correct parameters
(indicated by white circles; p-value = 0.9967), within a small range of solutions. This range of
solutions was in part due to the expected coupling between the population parameters Ï and f, such
that the estimated Ï Ã— f â‰ˆ the average density of labeled molecules in the target (= 0.8 labeled
mol/Î¼m2 for this target). Note, however, that this coupling did not extend indefinitely. For
example, comparing the probe landscape to a target with Ï = 100 Â± 10 mol/Âµm2, f = 0.03, pa = 0.05
and koff = 1/s (described in detail in the next section) did not yield any matches between them, even
though 100 Ã— 0.03 = 3 labeled mol/Âµm2, a labeled molecule density that was achievable by multiple
Ï-f combinations in the probe landscape. We suspect that the finite range of Ï-f combinations in
the solution is due to constraints imposed by estimating these two population parameters in the
context of the interaction parameters koff and pa. Therefore, even though FISIK yields a range of
estimated Ï and f values, the range is finite and contained within one order of magnitude at most.
In spite of the observed Ï-f coupling, which reduced the determinability of Ï and f, the
estimated koff and pa, i.e. the interaction parameters of interest, were relatively consistent for the
different Ï-f combinations. Both exhibited a narrow range, with high p-value solutions at koff = 1/s
and pa = 0.04-0.06 (target koff = 1/s and pa = 0.05). The low p-value solutions at Ï = 8 and f = 0.1
were slightly shifted up for both koff (1.25-1.5/s) and pa (0.06-0.08), most likely to compensate for

40

lab
lab
the lower estimated koff
and kon for lower f (Fig 2E). Testing FISIK against targets of different
population parameters f and Ï in the neighborhood of the reference parameters indicated that
targets with higher f or Ï led to narrower solution ranges, while targets with lower f or Ï led to
wider solution ranges, reducing the determinability of some parameters, especially pa (Fig 3B, C
and Fig S3).

41
42
43
44

13

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 3. FISIK can estimate interaction parameters from single-molecule trajectories
with sub-stoichiometric labeling, and can detect shifts in parameter values. (A) Four
dimensional p-value landscape for comparing probe trajectories to the indicated target, as a
function of the population parameters Ï and f and the interaction parameters pa and koff (total of
3360 probes). The p-value is shown as a heat map, going from white (p-value < 0.05) to black
(p-value = 1). The Ï vs. f landscape is shown on the left, where each rectangle is a â€œsummary
viewâ€ of the koff vs. pa landscape corresponding to each Ï-f pair. Specifically, it shows the
maximum p-value obtained for the underlying koff vs. pa landscape. The non-white rectangles
in the Ï vs. f landscape are then â€œexpandedâ€ on the right, showing the corresponding full koff
vs. pa landscapes. The specific Ï-f pairs being expanded are indicated above each koff vs. pa
landscape, with the target Ï-f pair in bold. The target parameter values are also indicated by a
white open circle in the Ï vs. f landscape on the left and a white open circle in the koff vs. pa
landscape on the right. (B-G) Same as (A), but with target f increased (B) or decreased (C),
target koff decreased (D) or increased (E), or target pa decreased (F) or increased (G) to the
indicated values. The correct probe parameters (= target parameters) had the following pvalues: 0.9967 (rank 1/7 possible solutions) in (A), 0.9915 (rank 1/6 possible solutions) in (B),
0.8120 (rank 4/30 possible solutions) in (C), 0.9998 (rank 1/6 possible solutions) in (D), 0.9963
(rank 1/17 possible solutions) in (E), 0.9995 (rank 1/14 possible solutions) in (F), and 0.9871
(rank 1/5 possible solutions) in (G).
1

14

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11

Next we tested the sensitivity of FISIK to detect shifts in interaction rates. Varying target
koff from 1/s to 0.5/s or to 1.5/s led to clear shifts in the solution range, from 1-1.5/s for target koff
= 1/s to 0.5/s for target koff = 0.5/s and to 1.25-2/s for target koff = 1.5/s (Fig 3A, D, E). Varying pa
from 0.05 to 0.03 or to 0.07 shifted the high p-value solution range from 0.04-0.06 for target pa =
0.05, to 0.03-0.05 for target pa = 0.03, and to 0.06-0.08 for target pa = 0.07 (Fig 3A, F, G).
All in all, these tests demonstrate that FISIK is able to estimate molecular interaction
parameters from single-molecule data, as long as there is a sufficient fraction/number of labeled
molecules. Because of the slight dependence of the estimated interaction parameters on the
estimated population parameters, combining FISIK with prior knowledge about the molecule
density, which is experimentally achievable via methods such as flow cytometry (40, 41), is
expected to aid FISIK with this task.

12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43

The fraction of labeled molecules in single-molecule trajectory data is a critical factor for
FISIKâ€™s ability to estimate interaction parameters
While many transmembrane proteins exist at a surface density in the 1-10 mol/Î¼m2 range, others
are much more highly expressed. Examples of receptors with high surface densities are CD8 (42)
and receptors of the ErbB family (38, 43). In such cases, the labeled fraction f will be below 0.1 to
maintain single-molecule trackability. Therefore, as a next test of FISIK, we simulated targets and
probes with Ï â‰ˆ 100 mol/Î¼m2 and f close to 0.1 and below. These tests not only investigated the
performance of FISIK when f is very low, but also allowed us to determine more conclusively
which property is more important: the labeled fraction f or the labeled molecule density = Ï Ã— f
(the tests above showed some interdependence between the minimum necessary f and Ï; see Fig
3A, C and Fig S3C).
For these studies we used the model parameters in Table S2, Row 2 and the simulation
parameters in Table S1, Row 3. The probe parameter landscape consisted of 2352 parameter
combinations, where each parameter combination was represented by 30 simulations (here the
simulation area was smaller for the sake of simulation efficiency, and thus we compensated for the
smaller area, i.e. smaller number of events, by combining 30 simulations instead of 10). The target
parameters were Ï = 100 Â± 10 mol/Âµm2, pa = 0.05, koff = 1/s and multiple values for f to investigate
its effect on interaction parameter determinability (also 30 simulations per target).
First we investigated the solution range when the target f = 0.03 (Fig 4A), because a target
with Ï = 100 Â± 10 mol/Âµm2 and f = 0.03 has the same labeled molecule density as a target with Ï
= 10 Â± 1 mol/Âµm2 and f = 0.3, a target for which FISIK yielded an almost perfect solution (Fig
S3D). However, in contrast to the Ï = 10 Â± 1 mol/Î¼m2 and f = 0.3 case, the Ï = 100 Â± 10 mol/Î¼m2
and f = 0.03 case had a wide range of solutions, with pa practically undeterminable. This test clearly
demonstrates that the labeled fraction f, and not the labeled density per se, is the most critical
parameter influencing the performance of FISIK.
To determine the minimum labeled fraction needed to accurately estimate the interaction
parameters, next we increased the target f from 0.03 to 0.06 (Fig. 4B), 0.09 and 0.12 (data not
shown). As f increased, the solution range decreased. By f = 0.06, koff was estimated accurately
within a narrow range (all solutions were at 1/s; Fig 4B). The range of pa also gradually decreased
as f increased, although it was still quite wide even at f = 0.12 (data not shown).
Putting together the results of the tests here and in the previous section, we conclude that
the labeled fraction of molecules is a critical parameter for FISIKâ€™s performance. The

15

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 4. The dissociation rate koff can be estimated accurately with a smaller fraction of
labeled molecules than the association probability pa. (A) Four dimensional p-value
landscape for comparing probe trajectories to the indicated target, as a function of the
population parameters Ï and f and the interaction parameters pa and koff (total of 2352 probes).
Detailed description as in Fig 3A. (B) Same as (A), but with target f increased to 0.6 . The
correct probe parameters (= target parameters) had the following p-values: 0. 9880 (rank 2/87
possible solutions) in (A), and 0.91 (rank 6/45 possible solutions) in (B).
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17

number/density of labeled molecules is important (e.g. Fig 3A vs. Fig S3C), but the labeled fraction
of molecules is much more critical. When the labeled fraction is too small, a too large fraction of
multi-molecular events in the system, such as association, becomes invisible. Fundamental
information is lost about these multi-molecular processes, and the information seems to be
irrecoverable. As a result, determining pa, which characterizes a mutli-molecular process
(association), requires labeled fractions of at least ~0.2 (Fig 3A). In contrast, determining koff is
possible with relatively low labeled fractions, down to ~0.06 (Fig 4B), as dissociation is a unimolecular process.
Static oligomer distribution data can complement low-labeled-fraction single-molecule
trajectory data and increase FISIKâ€™s power
Our results thus far pose a dilemma. The inference of interaction parameter values, especially pa,
improves as the labeled fraction of molecules increases. Yet increasing the labeled fraction often
increases particle tracking errors (7, 16), thus reducing the data quality for model calibration and
parameter inference (the effect of tracking errors will be investigated in more detail later). One
approach to address this challenge is to employ multi-color single-molecule imaging (e.g. 2- or 3-

16

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30

color, or even more with hyperspectral imaging (4)), where the labeled fraction in each channel
affords good trackability, while the sum of all channels gives a high enough total labeled fraction.
This approach is conceptually similar to the above tests, and thus will not be explored further here.
Another approach to address this challenge is to combine the dynamic but sparse information from
single-molecule tracking with dense but static information from approaches such as Number and
Brightness (N&B) analysis (44, 45), Spatial Intensity Distribution Analysis (SpIDA) (46), and
Single-Molecule Localization Microscopy (SMLM) (47, 48). These approaches yield a dense
snapshot of the oligomeric state distribution of the majority of molecules of interest, thus
potentially complementing low-labeled-fraction single-molecule tracking data and improving the
ability of FISIK to infer interaction parameters.
As a first step, we investigated the performance of FISIK when using only static oligomer
distribution data. For these tests we used the model parameters in Table S2, Row 3 and the
simulation parameters in Table S1, Row 4. In terms of model parameters (Table S2), we replaced
the labeled fraction f with the observed fraction ğœ™ğœ™. The observed fraction accounts for the fact that,
even when all molecules are labeled, not all molecules are observed, due to incomplete fluorophore
maturation (17), or incomplete photoconversion and localization in the case of SMLM (49, 50). In
the targets we used ğœ™ğœ™ = 0.85, and made ğœ™ğœ™ an unknown parameter to estimate; in the probes ğœ™ğœ™ was
varied in the range 0.75-0.95 (17, 49, 50). The output of the static snapshot simulations was the
particle intensities and positions at the end of the simulation, equivalent to the output of the full
trajectory simulations, but for one-time point (Methods, Section 3). As there is no merging and
splitting history in the static snapshot data, the oligomeric state of each particle in this case was
determined solely from the particle intensities, i.e. by minimizing the objective function in Eq. 2
but without any constraints (Methods, Section 4). Additionally, the only intermediate statistics to
be used for target and probe comparison in the case of static distribution data were the observed
ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
ğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
oligomer densities: ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(1) (monomers), ğœŒğœŒğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œğ‘œ
(2) (dimers), etc.
These tests demonstrated that implementing FISIK with static oligomer distribution data
instead of dynamic single-molecule trajectory data yielded an accurate estimate of the ratio of koff
to pa (Fig 5A). Note that pa is linearly related to the association rate kon (Fig 2C); as a result,

31
32
33
34
35
36
37
38
39
40
41
42
43
44

static oligomer distribution data extracts from these data the maximum information possible,
namely the dissociation constant(s) describing molecular interactions. The accuracy of the
estimated Kdâ€™s is expected to depend on the accuracy of the experimental and analytical procedures
employed to calculate the distribution of oligomeric states. For example, in the case of SMLM,
fluorophore blinking and multiple appearances must be accounted for properly to avoid overcounting that results in exaggerated apparent oligomerization (47).
Our tests thus far indicate that FISIK with low-labeled-fraction single-molecule trajectory
data yields accurate estimates of koff, while FISIK with static oligomer distribution data yields
accurate estimates of koff/pa. Therefore, we surmised that combining the two data types should
yield an accurate estimate of both koff and pa, along with estimating Ï, f and ğœ™ğœ™ (i.e. 5 parameters in
total). We implemented the combination of data types at the level of FISIKâ€™s solution space.
Specifically, we defined the combined p-value for probe-target comparison as:

koff pa âˆ koff kon =
K d , the dissociation constant. In other words, applying FISIK with dense,

17

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1

Figure 5. Dense but static oligomer distribution data increase FISIKâ€™s power in the case
of sparse single-molecule trajectory data. (A) Four-dimensional p-value landscape for
comparing probe oligomer distribution data to the indicated target oligomer distribution data,
as a function of the population parameters Ï and ğœ™ğœ™ and the interaction parameters pa and koff
(total of 840 probes). Detailed description as in Fig 3A, except that the labeled fraction f is
replaced by the observed fraction ğœ™ğœ™ (see text for details). (B) Five-dimensional p-value
landscape for comparing combined probe data (trajectories + distribution data) to the indicated
target (also trajectories + distribution data), as a function of the population parameters Ï, f and
ğœ™ğœ™ and the interaction parameters pa and koff (total of 11760 probes). Detailed description as in
Fig 3A, except that the parameter space includes both f and ğœ™ğœ™. (C) Same as (B), but with target
f increased to 0.6. The correct probe parameters (= the target parameters) had the following pvalues: 0.9995 (rank 1/28 possible solutions) in (A), 0.9980 (rank 1/23 possible solutions) in
(B), 0.91 (rank 1/12 possible solutions) in (C).
18

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

(

)

combined p-value pa , koff , Ï , f , Ï† | dynamic trajectory data + static distribution data =
1

2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40

(
(

ï£« p-value pa , koff , Ï , f | dynamic trajectory data
min ï£¬
ï£¬ p-value p , k , Ï , Ï† | static distribution data
a off
ï£­

)

) , ï£¶ï£·

(7)

ï£·
ï£¸

where the p-values are calculated from the Mahalanobis distance as done previously (Eq. 1). With
this, a combination of pa, koff and Ï values will only be accepted as a possible solution if it is a
possible solution in both the dynamic comparison and the static comparison. This strategy indeed
enabled the accurate estimation of pa and koff with a single-molecule labeled fraction as low as 0.06
(Fig 5B, C; for f = 0.06, estimated pa range 0.04-0.06 and koff = 1/s for target pa = 0.05 and koff =
1/s). These tests demonstrate that combining these two types of complementary data is indeed a
viable approach to enhance the accuracy of FISIK, without the need to increase the labeled fraction
in single-molecule trajectory data.
FISIK can estimate molecular interaction parameters in the presence of limited mismatch
between model and system
In our tests of FISIK thus far, there was no mismatch between model (i.e. probe) and the system it
mimics (i.e. target). However, when applying FISIK to experimental data, it is highly likely that
the employed model is an approximation of reality. Therefore, we investigated the performance of
FISIK when there is a model mismatch between probe and target. Specifically, we investigated the
effect of a mismatch in the maximum achievable oligomeric state (Omax, such that pa(n>Omax) =
0)), and a mismatch in the diffusion coefficient D, as both of these are parameters that we have
thus far assumed known instead of determining their values through model fitting.
To test the effect of mismatches in Omax, we simulated targets with different Omax, while
retaining the probe Omax at 5 (Fig 6A). The employed target parameters were otherwise those of
our reference target (Ï = 4 Â± 0.4 mol/Âµm2, f = 0.2, pa (2â‰¤nâ‰¤ Omax) = 0.05 and koff = 1/s; Fig 3A).
High p-value solutions started to appear at target Omax = 3, where the interaction parameters were
estimated with reasonable accuracy (high p-value solutions for pa = 0.04-0.07 and koff = 1.25-1.5/s),
although at the wrong Ï-f combination (8Ã—0.1 instead of 4Ã—0.2). Increasing Omax to 4, the
interaction parameters were estimated accurately and at the correct Ï-f combination, although high
p-value solutions were still present at the 8Ã—0.1 Ï-f combination. For Omax > 5, the solution range
was very similar to that for target Omax = 5 (Fig 6A vs. Fig 3A). These results suggest that FISIKâ€™s
performance is relatively robust against mismatches in Omax; if it is able to estimate the interaction
parameters, they are estimated reasonably accurately. If the mismatch in Omax between target and
probe is too large, it appears that FISIK does not yield any solution, instead of an erroneous one.
This robustness however implies that FISIK as applied to single-molecule tracking data alone is
not able to estimate Omax. Other techniques, such as static distribution data, would be better suited
to estimate Omax, which should then be input into the model.
To test the effect of mismatches in D, we simulated targets with different D, while retaining
the probe D at 0.1 Âµm2/s. Again, the employed target parameters were otherwise those of our
reference target (Fig 3A). We found that lower/higher D in target compared to probe were
compensated for by lower/higher pa in the solution (Fig 6B). This is most likely because of the

19

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1

Figure 6. FISIK can estimate molecular interaction parameters in the presence of limited
model mismatch between probe and target. Four dimensional p-value landscape for
comparing probe trajectories to the indicated targets, as a function of the population parameters
Ï and f and the interaction parameters pa and koff (total of 3360 probes). Targets are subject to
mismatch in the maximum achievable oligomeric state Omax (A), and in the diffusion coefficient
D (B-C). In (B), all molecules in target have the indicated D (which is different from the probe
D). In (C), D for target molecules follows the indicated normal distribution. Detailed description
as in Fig 3A. In (A), the correct probe parameters (= target parameters) were outside of the

20

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

solution range for Omax = 2 and Omax = 3, and had the following p-values for the other tests: 0.6418
(rank 5/13 possible solutions) for Omax = 4, 0.9892 (rank 1/5 possible solutions) for Omax = 6, and
0.8984 (rank 2/10 possible solutions) for Omax = 8. In (B), the correct probe parameters were
outside of the solution range for D = 0.05, 0.07, and 0.2 Âµm2/s, and had the following p-values for
the other tests: 0.5165 (rank 3/10 possible solutions, for D = 0.08 Âµm2/s), 0.9738 (rank 2/8 possible
solutions, for D = 0.11 Âµm2/s), 0.1061 (rank 4/4 possible solutions, for D = 0.14 Âµm2/s) in (B). In
(C), the correct probe parameters had a p-value = 0.9991 (rank 1/7 possible solutions).
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35

ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™ğ‘™
approximately linear dependence of ğ‘˜ğ‘˜ğ‘œğ‘œğ‘œğ‘œ
on pa and D (Fig 2C and D, 3rd column). Mismatches in
D of ~20% were tolerated (e.g. target D = 0.08 or 0.11 Âµm2/s), but beyond that the estimated pa
range no longer contained the true target pa, at least at the correct Ï-f combination. The tested
mismatches in D had very little effect on estimating koff, on the other hand. In another test, we
allowed D to vary between molecules in the target, following a normal distribution with mean =
probe D (0.1 Âµm2/s), while retaining that all molecules in the probe had the same D. Even up to a
standard deviation = 40% of the mean D (for larger standard deviations the distribution shifts
substantially from a normal distribution, as D cannot be negative), the solution range remained
very similar to that with no variation in D between molecules (Fig 6C vs. Fig 3A).
These tests indicate that FISIK is relatively sensitive to mismatches in the mean D between
model and system, where mismatches in D are compensated for with the estimated pa, but it is
robust against heterogeneity between molecules around their mean D. Therefore, especially in light
of the coupling between pa and D that these tests revealed, it is important to obtain good estimates
of the mean D, potentially as a function of oligomeric state, via thorough analysis of the singlemolecule trajectories, to use in the model. Yet the heterogeneity around the mean D does not have
to be explicitly modeled.

FISIK can estimate molecular interaction parameters from single-molecule trajectories
subject to resolution limitations and tracking errors
While single-molecule imaging can reveal colocalization of molecules, suggestive of interactions,
on its own it cannot distinguish between molecules interacting with vs. passing by each other,
largely because of the resolution limit. Note that for the purposes of this section we are using the
term interactions in a general sense, thus including direct interactions, indirect interactions and
clustering within a common nanodomain. Distinguishing between these different types of
interactions depends on the known biology and further experimentation of the system under study.
Here we are concerned with distinguishing between them and coincidental colocalization due to
molecules passing by each other. One-color single-molecule imaging suffers the most from the
limited resolution of light microscopy. Multi-color imaging suffers less due to the ability to use
e.g. co-movement in addition to colocalization to assess specific interactions (8). FRET-based
experiments suffer the least from the resolution limit, due to the requirement of very close
proximity for FRET. Nevertheless, fundamentally all light microscopy approaches face the
challenge of distinguishing between proximity due to interactions vs. due to passing-by events.
Here we tested FISIKâ€™s performance when applied to single-molecule trajectories obtained
from one-color imaging data, as the most challenging scenario. We and others have previously

21

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44

developed particle tracking algorithms to capture merging and splitting events between imaged
molecules in one-color time-lapses (7, 51, 52), reflecting molecular interactions (in the general
sense defined above) (6, 13). For these tests, we used low density and low-medium labeled fraction
simulations (Table S2, Row 1), as FISIK had an overall good performance under these conditions
in the absence of particle tracking errors (Fig 3). We generated synthetic single-molecule image
series that mimicked experimental time-lapses from simulated target trajectories (see Table S3 for
image generation parameters). Then we detected and tracked the molecules in the synthetic image
series using u-track (7), as we would detect and track actual experimental data (see Tables S4 and
S5 for detection and tracking parameters). Finally, we used the tracking output, after a minor â€œclean
upâ€ (Note S1), as the target data for model calibration within FISIK. Note that the probe trajectories
were used directly as output by the Monte Carlo simulations.
With the above strategy, we tested FISIK by generating images with an average signal-tonoise ratio (SNR) of 20 (high) or 7 (medium). High SNR conditions are not very common in singlemolecule data, but they are achievable with quantum dot labeling (6, 8), for example. Medium
SNR conditions are achievable with many organic dyes imaged via total internal reflection
fluorescence microscopy (TIRFM), a common combination for single-molecule imaging. We
started with a target with Ï = 2 Â± 0.2 mol/Î¼m2, f = 0.2, pa = 0.05 and koff = 1/s (as in Fig S3C). We
chose this Ï and f combination because a labeled-molecule density of 0.4 mol/Î¼m2 afforded
(visually) acceptable detection and tracking performance (Videos S1-S4), and our previous tests
on error-free data showed that f should be at least 0.2 for FISIK to estimate pa well.
For both SNRs, FISIK estimated koff well, within a narrow range, albeit slightly shifted
toward smaller koff values (estimated koff in the range 0.5-1/s, with most high p-value solutions at
0.5/s and 0.75/s; Fig 7A). We surmised that this was due to the tracking software constraint that
merges and splits were only allowed when there was no possibility of gap closing (Table S5). This
constraint helped reduce the assignment of merge-to-split events to molecules merely passing by
each other, but at the same time it might eliminate short-lived specific interactions between
molecules. To investigate this issue further, we tested FISIK against targets with lower and higher
koff values. Indeed, the downward shift was more pronounced for higher target koff values (Fig 7B,
C). These observations imply that FISIK can estimate koff accurately from single-molecule imaging
data subject to resolution limitations, as long as the dissociation time scale is considerably longer
than the time scale of molecules diffusing past each other, in order to distinguish between the two
events.
Estimating pa was more challenging than estimating koff, and depended more strongly on
the image SNR. Specifically, the range of solutions for pa was shifted toward higher values, and
the shift increased as the SNR decreased. For SNR = 20, the target pa, was often just at the
periphery of the solution range (Fig 7A-C, middle rows). For SNR = 7, the solution was shifted
further away from the target pa of 0.05, and was generally in the range 0.09-0.15 (Fig 7A-C, bottom
rows). Close inspection of the detection and tracking steps of u-track suggested that FISIK
performed worse with lower SNR because of detection errors (specifically related to the detection
of very nearby particles) that propagated into tracking errors, as the tracking step had to balance
the potentially conflicting events of gap closing, merging and splitting. Nevertheless, the solution
range for pa was finite and within 2-4-fold of the target pa, at least for average SNRs down to 7.
The requirement for relatively high SNR raised the concern of the effect of photobleaching
on FISIKâ€™s performance. To address this issue, we simulated targets where the fraction of labeled

22

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1

23

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

Figure 7. FISIKâ€™s estimation of interaction parameters from single-molecule trajectories
is influenced by resolution limitation and image SNR. (A) Four dimensional p-value
landscape for comparing probe trajectories to the indicated target, as a function of the
population parameters Ï and f and the interaction parameters pa and koff (total of 3584 probes;
see Table). Detailed description as in Fig 3A. Top row (titled â€œDirect simulationâ€) shows
landscape for comparing to target trajectories directly as output by the Monte Carlo simulations
(as done for all figures up to Fig 6). Middle and bottom rows (titled â€œu-track (image SNR=20)â€
and â€œu-track (image SNR=7),â€ respectively) show landscape for comparing to target
trajectories as output by u-track analysis of images with indicated SNR (see text for image
generation and tracking details). (B, C) Same as (A), but with koff decreased (B) or increased
(C) to the indicated values. For direct simulation comparisons, the correct probe parameters (=
target parameters) had the following p-values: 0.8917 (rank 2/72 possible solutions) in (A),
0.4138 (rank 14/49 possible solutions) in (B), and 0.7717 (rank 14/47 possible solutions) in
(C). For u-track comparisons, the correct parameters had a p-value < 0.05 and were outside of
the solution range.
1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26

molecules decreased over time to mimic photobleaching. Starting with our reference target (Fig
3A), we simulated a range of photobleaching rates, inspired by TIRF-based single-molecule
imaging using organic dyes (Fig S4A). In contrast to the targets, the probes did not include any
photobleaching. As expected, for low photobleaching rates that retained ~90% of the labeled
molecules by the end of a 20 s â€œtime-lapseâ€ (0.005 and 0.007/s in Fig S4A), FISIKâ€™s performance
was very similar to that in the absence of photobleaching (Fig S4B, left, vs. Fig 3A). As the
photobleaching rate increased further, such that less than 50% of labeled molecules were retained
by the end of a 20 s â€œtime-lapseâ€ (0.03 and 0.05/s in Fig S4A), the solution range shifted toward
lower Ï Ã— f combinations, presumably to compensate for photobleaching (Fig S4B, bottom row).
The interaction parameters remained in the vicinity of their target values, although pa became less
determinable and its solution shifted toward higher values. For such high photobleaching rates,
including photobleaching explicitly in the probe simulations will most likely improve FISIKâ€™s
ability to accurately estimate the interaction rates.
All in all, these tests demonstrate that FISIK is able to extract molecular interaction
parameters from sub-stoichiometrically labeled single-molecule imaging data, although with some
systematic shifts due to the limited resolution and SNR inherent to light microscopy. For realistic
SNRs commonly encountered in single-molecule imaging data, the imperfections of molecule
detection and subsequently tracking might have to be compensated for by reducing the labeled
fraction in order to maintain good tracking accuracy. If this labeled fraction is insufficient for
interaction rate estimation (especially the association rate), then our collective results suggest that
combining tracking data from multiple channels, and/or combining tracking data with dense but
static oligomer distribution data (Fig 5), would provide sufficient information for FISIK to
estimate accurately the unknown model parameters.

Conclusion

24

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44

In conclusion, the framework that we have developed, FISIK, is a promising approach for the
inference of in situ interaction kinetics from single-molecule imaging data with sub-stoichiometric
labeling. By including a labeled fraction parameter in FISIKâ€™s modeling component, and then
fitting the model to single-molecule data to determine the unknown model parameters, including
the labeled fraction alongside the association and dissociation rates, FISIK tackles the issue of substoichiometric labeling in a generic manner. Our proof-of-principle tests demonstrate that FISIK
can indeed estimate molecular association and dissociation rates using single-molecule data with
labeled fractions as low as ~0.2 and ~0.06, respectively. Prior knowledge about the molecule
density allows FISIK to estimate the unknown model parameters with greater accuracy. The proofof-principle tests also show that FISIKâ€™s performance critically depends on the accuracy of
molecule tracking. For molecular systems where accurate tracking requires a labeled fraction that
is insufficient for parameter estimation, combining tracking data from multiple channels, and/or
combining tracking data with dense but static oligomer distribution data, is a viable strategy to
provide sufficient information for FISIK to estimate molecular association and dissociation rates.
As our tests also show, the accuracy of FISIK depends on the accuracy of the model it employs to
describe the biological system under study. Various lines of experimentation will most likely be
needed to define an appropriate model to use within FISIK (e.g. motion types, interdependence
between motion type and interactions, and maximum oligomeric state) and to constrain the model
fitting problem. With this, FISIK is expected to allow us to estimate the interaction rates between
molecules in their native cellular environment, taking full advantage of the rich spatial and
temporal information present in live-cell single-molecule imaging data.

Software availability
FISIK code, to perform all of the procedures and analyses described in this work, is available on
github (https://github.com/kjaqaman/FISIK).

Supporting material
The manuscript includes 1 supporting note, 5 supporting figures, 5 supporting tables and 4
supporting videos.

Author contributions
KJ and LRO designed and implemented the framework, performed the tests and data analysis
(primarily LRO), and wrote the manuscript.

Acknowledgments
We thank R. Yirdaw for contributing toward initial implementations of the simulation code. We
thank Chad Brautigam and Satwik Rajaram for critical reading of the manuscript and helpful
discussions. This work was supported by funding from The Welch Foundation (I-1901),
NIH/NIGMS (R35 GM119619) CPRIT (R1216), and the UT Southwestern Endowed Scholars
program to KJ.

References

1.

Fujiwara, T., K. Ritchie, H. Murakoshi, K. Jacobson, and A. Kusumi. 2002. Phospholipids undergo
hop diffusion in compartmentalized cell membrane. J. Cell Biol. 157(6):1071-1081. Article.

25

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46

2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.

14.
15.
16.

Gebhardt, J. C. M., D. M. Suter, R. Roy, Z. Q. W. Zhao, A. R. Chapman, S. Basu, T. Maniatis, and X.
S. Xie. 2013. Single-molecule imaging of transcription factor binding to DNA in live mammalian
cells. Nat. Methods 10(5):421-+. Article.
Yildiz, A., J. N. Forkey, S. A. McKinney, T. Ha, Y. E. Goldman, and P. R. Selvin. 2003. Myosin V walks
hand-over-hand: Single fluorophore imaging with 1.5-nm localization. Science 300(5628):20612065. Article.
Cutler, P. J., M. D. Malik, S. Liu, J. M. Byars, D. S. Lidke, and K. A. Lidke. 2013. Multi-Color Quantum
Dot Tracking Using a High-Speed Hyperspectral Line-Scanning Microscope. PLoS One 8(5). Article.
Huppa, J. B., M. Axmann, M. A. Mortelmaier, B. F. Lillemeier, E. W. Newell, M. Brameshuber, L. O.
Klein, G. J. Schutz, and M. M. Davis. 2010. TCR-peptide-MHC interactions in situ show accelerated
kinetics and increased affinity. Nature 463(7283):963-967.
Jaqaman, K., H. Kuwata, N. Touret, R. Collins, W. S. Trimble, G. Danuser, and S. Grinstein. 2011.
Cytoskeletal control of CD36 diffusion promotes its receptor and signaling function. Cell
146(4):593-606.
Jaqaman, K., D. Loerke, M. Mettlen, H. Kuwata, S. Grinstein, S. L. Schmid, and G. Danuser. 2008.
Robust single-particle tracking in live-cell time-lapse sequences. Nat. Methods 5(8):695-702.
Low-Nam, S. T., K. A. Lidke, P. J. Cutler, R. C. Roovers, P. Henegouwen, B. S. Wilson, and D. S. Lidke.
2011. ErbB1 dimerization is promoted by domain co-confinement and stabilized by ligand binding.
Nat. Struct. Mol. Biol. 18(11):1244-U1288. Article.
Calebiro, D., and T. Sungkaworn. 2018. Single-Molecule Imaging of GPCR Interactions. Trends
Pharmacol. Sci. 39(2):109-122. Review.
Axmann, M., J. B. Huppa, M. M. Davis, and G. J. Schutz. 2012. Determination of interaction kinetics
between the T cell receptor and peptide-loaded MHC class II via single-molecule diffusion
measurements. Biophys. J. 103(2):L17-19.
Huang, J., V. I. Zarnitsyna, B. Liu, L. J. Edwards, N. Jiang, B. D. Evavold, and C. Zhu. 2010. The
kinetics of two-dimensional TCR and pMHC interactions determine T-cell responsiveness. Nature
464(7290):932-936.
Liu, B. Y., W. Chen, K. Natarajan, Z. H. Li, D. H. Margulies, and C. Zhu. 2015. The cellular
environment regulates in situ kinetics of T-cell receptor interaction with peptide major
histocompatibility complex. Eur. J. Immunol. 45(7):2099-2110. Article.
Calebiro, D., F. Rieken, J. Wagner, T. Sungkaworn, U. Zabel, A. Borzi, E. Cocucci, A. Zurn, and M. J.
Lohse. 2013. Single-molecule analysis of fluorescently labeled G-protein-coupled receptors
reveals complexes with distinct dynamics and organization. Proc. Natl. Acad. Sci. U. S. A.
110(2):743-748. Article.
Sungkaworn, T., M. L. Jobin, K. Burnecki, A. Weron, M. J. Lohse, and D. Calebiro. 2017. Singlemolecule imaging reveals receptor-G protein interactions at cell surface hot spots. Nature
550(7677):543-+. Article.
Suzuki, K. G. N., R. S. Kasai, K. M. Hirosawa, Y. L. Nemoto, M. Ishibashi, Y. Miwa, T. K. Fujiwara, and
A. Kusumi. 2012. Transient GPI-anchored protein homodimers are units for raft organization and
function. Nat. Chem. Biol. 8(9):774-783. Article.
Chenouard, N., I. Smal, F. de Chaumont, M. Maska, I. F. Sbalzarini, Y. H. Gong, J. Cardinale, C.
Carthel, S. Coraluppi, M. Winter, A. R. Cohen, W. J. Godinez, K. Rohr, Y. Kalaidzidis, L. Liang, J.
Duncan, H. Y. Shen, Y. K. Xu, K. E. G. Magnusson, J. Jalden, H. M. Blau, P. Paul-Gilloteaux, P. Roudot,
C. Kervrann, F. Waharte, J. Y. Tinevez, S. L. Shorte, J. Willemse, K. Celler, G. P. van Wezel, H. W.
Dan, Y. S. Tsai, C. O. de Solorzano, J. C. Olivo-Marin, and E. Meijering. 2014. Objective comparison
of particle tracking methods. Nat. Methods 11(3):281-U247. Article.

26

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45

17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.
29.
30.
31.
32.
33.
34.
35.
36.

Kasai, R. S., K. G. N. Suzuki, E. R. Prossnitz, I. Koyama-Honda, C. Nakada, T. K. Fujiwara, and A.
Kusumi. 2011. Full characterization of GPCR monomer-dimer dynamic equilibrium by single
molecule imaging. J. Cell Biol. 192(3):463-480. Article.
Gourieroux, C., A. Monfort, and E. Renault. 1993. Indirect inference. J. Appl. Econometrics
8(S1):S85-S118.
Jaqaman, K., and G. Danuser. 2006. Linking data to models: data regression. Nat. Rev. Mol. Cell
Biol. 7(11):813-819.
Jiang, W. X., and B. Turnbull. 2004. The indirect method: Inference based on intermediate
statistics - A synthesis and examples. Stat. Sci. 19(2):239-263. Article.
Hartig, F., J. M. Calabrese, B. Reineking, T. Wiegand, and A. Huth. 2011. Statistical inference for
stochastic simulation models - theory and application. Ecol. Lett. 14(8):816-827. Review.
Frazier, D. T., and E. Renault. 2019. Indirect Inference: Which Moments to Match? Econometrics
7(1). Article.
Mahalanobis, P. C. 1936. On the Generalised Distance in Statistics. Proc. Natl Inst. Sci. India 12:4955.
Schrangl, L., J. Gohring, and G. J. Schutz. 2018. Kinetic analysis of single molecule FRET transitions
without trajectories. J. Chem. Phys. 148(12). Article.
Wieser, S., M. Axmann, and G. J. Schutz. 2008. Versatile Analysis of Single-Molecule Tracking Data
by Comprehensive Testing against Monte Carlo Simulations. Biophys. J. 95(12):5988-6001. Article.
Golightly, A., and D. J. Wilkinson. 2011. Bayesian parameter inference for stochastic biochemical
network models using particle Markov chain Monte Carlo. Interface Focus 1(6):807-820. Article.
Smith, C. S., K. Jouravleva, M. Huisman, S. M. Jolly, P. D. Zamore, and D. Grunwald. 2019. An
automated Bayesian pipeline for rapid analysis of single-molecule binding data. Nature
Communications 10(1):272.
Jagiella, N., D. Rickert, F. J. Theis, and J. Hasenauer. 2017. Parallelization and High-Performance
Computing Enables Automated Statistical Inference of Multi-scale Models. Cell Syst. 4(2):194-+.
Article.
Toni, T., D. Welch, N. Strelkowa, A. Ipsen, and M. P. H. Stumpf. 2009. Approximate Bayesian
computation scheme for parameter inference and model selection in dynamical systems. J. R. Soc.
Interface 6(31):187-202. Article.
Beaumont, M. A. 2019. Approximate Bayesian Computation. In Annual Review of Statistics and Its
Application. Annual Review of Statistics and Its Application, Vol 6. N. Reid, editor. Annual Reviews,
Palo Alto, pp. 379-403.
Andrews, S. S., and D. Bray. 2004. Stochastic simulation of chemical reactions with spatial
resolution and single molecule detail. Phys. Biol. 1(3):137-151. Article.
Frazier, Z., and F. Alber. 2012. A Computational Approach to Increase Time Scales in Brownian
Dynamics-Based Reaction-Diffusion Modeling. J. Comput. Biol. 19(6):606-618. Article.
West, D. B. 1999. Introduction to Graph Theory, Chapter 3. Prentice Hall.
Lofberg, J. 2004. YALMIP : A Toolbox for Modeling and Optimization in MATLAB. Proceedings of
the CACSD Conference.
Mutch, S. A., B. S. Fujimoto, C. L. Kuyper, J. S. Kuo, S. M. Bajjalieh, and D. T. Chiu. 2007.
Deconvolving single-molecule intensity distributions for quantitative microscopy measurements.
Biophys. J. 92(8):2926-2943. Article.
Gillespie, D. T. 1977. EXACT STOCHASTIC SIMULATION OF COUPLED CHEMICAL-REACTIONS. J.
Phys. Chem. 81(25):2340-2361. Article.

27

bioRxiv preprint doi: https://doi.org/10.1101/530063; this version posted June 28, 2019. The copyright holder for this preprint (which was not
certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made available under
aCC-BY-NC-ND 4.0 International license.

1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43

37.
38.
39.
40.
41.
42.
43.
44.
45.
46.
47.
48.
49.
50.
51.

52.

Elliott, S., A. Sinclair, H. Collins, L. Rice, and W. Jelkmann. 2014. Progress in detecting cell-surface
protein receptors: the erythropoietin receptor example. Ann. Hematol. 93(2):181-192. Review.
Shankaran, H., H. Resat, and H. S. Wiley. 2007. Cell surface receptors for signal transduction and
ligand transport: A design principles study. PLoS Comput. Biol. 3(6):986-999. Article.
Schreiber, G., G. Haran, and H. X. Zhou. 2009. Fundamental Aspects of Protein-Protein Association
Kinetics. Chem. Rev. 109(3):839-860. Review.
Imoukhuede, P. I., and A. S. Popel. 2011. Quantification and cell-to-cell variation of vascular
endothelial growth factor receptors. Exp. Cell Res. 317(7):955-965. Article.
Wang, L., H. Degheidy, F. Abbasi, H. Mostowski, G. Marti, S. Bauer, R. A. Hoffman, and A. K.
Gaigalas. 2016. Quantitative Flow Cytometry Measurements in Antibodies Bound per Cell Based
on a CD4 Reference. Curr. Prot. Cytometry 75:1.29.21-21.29.14.
Moskalensky, A. E., A. V. Chernyshev, M. A. Yurkin, V. M. Nekrasov, A. A. Polshchitsin, D. R. Parks,
W. A. Moore, A. Filatenkov, V. P. Maltsev, and D. Y. Orlova. 2015. Dynamic quantification of
antigen molecules with flow cytometry. J. Immunol. Methods 418:66-74. Article.
Eladdadi, A., and D. Isaacson. 2008. A mathematical model for the effects of HER2 overexpression
on cell proliferation in breast cancer. Bull. Math. Biol. 70(6):1707-1729. Article.
James, N. G., M. A. Digman, E. Gratton, B. Barylko, X. D. Ding, J. P. Albanesi, M. S. Goldberg, and
D. M. Jameson. 2012. Number and Brightness Analysis of LRRK2 Oligomerization in Live Cells.
Biophys. J. 102(11):A41-A43. Article.
Plotegher, N., E. Gratton, and L. Bubacco. 2014. Number and Brightness analysis of alphasynuclein oligomerization and the associated mitochondrial morphology alterations in live cells.
Biochim. Biophys. Acta-Gen. Subj. 1840(6):2014-2024. Article.
Godin, A. G., B. Rappaz, L. Potvin-Trottier, T. E. Kennedy, Y. De Koninck, and P. W. Wisemant. 2015.
Spatial Intensity Distribution Analysis Reveals Abnormal Oligomerization of Proteins in Single
Cells. Biophys. J. 109(4):710-721. Article.
Fricke, F., J. Beaudouin, R. Eils, and M. Heilemann. 2015. One, two or three? Probing the
stoichiometry of membrane proteins by single-molecule localization microscopy. Sci. Rep. 5.
Article.
Kruger, C. L., M. T. Zeuner, G. S. Cottrell, D. Widera, and M. Heilemann. 2017. Quantitative singlemolecule imaging of TLR4 reveals ligand-specific receptor dimerization. Sci. Signal. 10(503).
Article.
Holden, S. J., S. Uphoff, and A. N. Kapanidis. 2011. DAOSTORM: an algorithm for high-density
super-resolution microscopy. Nat. Methods 8(4):279-280. Letter.
Min, J. H., C. Vonesch, H. Kirshner, L. Carlini, N. Olivier, S. Holden, S. Manley, J. C. Ye, and M. Unser.
2014. FALCON: fast and unbiased reconstruction of high-density super-resolution microscopy
data. Sci. Rep. 4. Article.
Genovesio, A., and J. C. Olivo-Marin. 2004. Split and merge data association filter for dense multitarget tracking. In International Conference on Pattern Recognition. Proceedings of the 17th
International Conference on Pattern Recognition, Vol 4. J. Kittler, M. Petrou, and M. Nixon,
editors. Ieee Computer Soc, Los Alamitos, pp. 677-680.
Park, C., T. J. Woehl, J. E. Evans, and N. D. Browning. 2015. Minimum Cost Multi-Way Data
Association for Optimizing Multitarget Tracking of Interacting Objects. IEEE Trans. Pattern Anal.
Mach. Intell. 37(3):611-624. Article.

44
45

28

