bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

2

Large-scale network analysis captures
biological features of bacterial plasmids

3

Mislav Acman1, Lucy van Dorp1, Joanne M. Santini2 and Francois Balloux1

1

4
5

1

UCL Genetics Institute, University College London, Gower Street, London WC1E 6BT, UK

6
7

2

Institute of Structural & Molecular Biology, University College London, Gower Street, London WC1E 6BT,

8

Correspondence: Mislav Acman: mislav.acman.17@ucl.ac.uk and Francois Balloux: f.balloux@ucl.ac.uk

UK

9
10

Keywords: plasmid classification, Jaccard index, community detection algorithm, horizontal gene transfer,

11

Abstract

12
13
14
15
16
17
18
19
20
21

Most bacteria exchange genetic material through Horizontal Gene Transfer (HGT). The primary vehicles for HGT

mobile genetic elements, antimicrobial resistance

are plasmids and plasmid-borne transposable elements, though their population structure and dynamics remain
poorly understood. Here, we quantified genetic similarity between more than 10,000 bacterial plasmids and
reconstructed a network based on their shared k-mer content. Using a community detection algorithm, we assigned
plasmids into cliques which are highly correlated with plasmid gene content, bacterial host range, GC content, as
well as replicon and mobility (MOB) type classifications. Resolving the plasmid population structure further
allowed identification of candidates for yet-undescribed replicon genes. Our work provides biological insights
into the dynamics of plasmids and plasmid-borne mobile elements, with the latter representing the main drivers
of HGT at broad phylogenetic scales. Our results illustrate the potential of network-based analyses for the bacterial
‚Äòmobilome‚Äô and open up the prospect of a natural, exhaustive classification framework for bacterial plasmids.

1

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

22

Introduction

23
24
25
26
27
28
29
30
31

Plasmids are extra-chromosomal DNA molecules found across all three Domains of Life. In bacteria, they are one

32
33
34
35
36
37
38
39
40

Currently, there are two well-established plasmid classification schemes which attempt to bin plasmids according

41
42
43
44
45
46
47
48
49
50
51
52
53

Despite being widely used and informative, these typing schemes only work within a limited taxonomic

54
55
56
57
58
59

As bacterial plasmids undergo extensive recombination and HGT, their evolutionary history is not well captured

of the main mediators of horizontal gene transfer (HGT) through the processes of conjugation and
transformation1‚Äì3. Plasmids generally harbour non-essential genes that can modulate the fitness of their bacterial
host. Some prominent examples include toxin-antitoxin systems, virulence factors, metabolic pathways, antibiotic
biosynthesis, metal resistance and antimicrobial resistance (AMR) genes. These accessory genes can be located
on transposable elements involved in gene transfer across genomes and can thus lead to a highly mosaic structure
of plasmid genomes4. The mix of vertical and horizontal inheritance of plasmids, together with exchanges of
plasmid-borne genes, generates complex dynamics that are difficult to capture with classical population genetics
tools and make it challenging to classify plasmids within a coherent universal framework.

to their propagation mechanisms, while indirectly capturing some features of the plasmid backbone. The first
scheme is based on replicon types5 and the second on mobility (MOB) groups6. Replicon-based typing relies on
relatively conserved genes of the replicon region which encode the plasmid replication and partitioning
machinery5. Plasmids with matching replication or partitioning systems cannot stably coexist within the same cell.
Conversely, MOB typing is used to classify self-transmissible and mobilizable plasmids into six MOB types6.
The MOB typing scheme relies on the conserved N-terminal sequence of the relaxase, a site-specific DNA
endonuclease which binds to the origin of transfer (oriT) cleaving at the nic site and is essential for plasmid
conjugation.

range7‚Äì9. Replicon typing is dependent on the availability of prior experimental evidence and remains restricted
to culturable bacteria from the family Enterobacteriaceae and several well-studied genera of gram-positive
bacteria1,10‚Äì12. Furthermore, this approach can lead to ambiguous classification, even for experimentally validated
replicons, as recently demonstrated by the discovery of compatible plasmids assigned to the same replicon type,
which led to the further subdivision of the IncK type into IncK1 and IncK213, and IncA/C type into IncA and
IncC14. In addition, plasmids can carry genes from more than one replication machinery and are thus assigned to
multiple replicon types, further reducing interpretability7,8. MOB typing schemes generate fewer multiple
assignments and can cover a potentially wider taxonomic range, however they are not applicable to the
classification of non-mobilizable plasmids. These two typing schemes have inspired several in silico classification
tools, such as PlasmidFinder12, the plasmid MultiLocus Sequence Typing (MLST) database, and MOB-suite15.
However, all of these tools intrinsically rely on the completeness of their reference sequence databases, which
typically lack representatives from understudied and/or unculturable bacterial hosts.

by phylogenetic trees, which are designed for the analysis of point mutation in sequence alignments16,17. Network
models offer an attractive alternative given they can incorporate both horizontal and vertical inheritance18, and
can deal with point mutations as well as structural variants. Networks have gained much attention in the past
decade as an alternative method for studying prokaryotic evolution, including plasmids3,8,18,19. Plasmid genesharing networks have proven a useful means to track AMR and virulence dissemination yielding deeper insights

2

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

60
61
62
63
64
65
66

into HGT events17,20,21. However, the main drawback of previous work relying on plasmid sequence alignments

67
68
69
70
71
72
73
74
75

In this work, we have quantified the genetic similarity between more than 10,000 bacterial plasmids available on

is the exclusion of important non-coding elements such as non-coding RNAs, promoter regions, CRISPRs,
stretches of homologous sequences, or putative, disrupted and currently unannotated genes. A more
comprehensive approach could consider a plasmid network based on estimates of alignment-free sequence
similarity22. A recently published Plasmid ATLAS tool by Jesus et al.23 provides an illustration of such an
approach, with a network of plasmids constructed based on pairwise genetic distances estimated using alignmentfree k-mer matching methods implemented in Mash24.

NCBI‚Äôs RefSeq database and constructed a network reflecting their relatedness based on shared k-mer content.
Applying a community detection algorithm allowed us to cluster plasmids into statistically significant cliques
(complete subgraphs), and revealed a strong underlying population structure. Cliques are highly correlated with
the gene content of the plasmid backbone, bacterial host and GC content, as well as replicon and MOB types.
Uncovering the structure of the full plasmid population allowed for the discovery of candidates for yetundescribed replicon genes and provided insights into broad-scale plasmid dynamics. Taken together, our results
illustrate the potential of network-based analyses of plasmid sequences and open up the prospect of a natural,
exhaustive classification framework for bacterial plasmids.

3

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

76

Results

77

A dataset of complete bacterial plasmids

78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93

A dataset of complete bacterial plasmids was assembled comprising 10,696 sequences found in bacteria from 22

94

Uncovering the population structure of plasmids using a network-based approach

phyla and over 400 genera (Supplementary Table 1, Figure 1A, and Supplementary Figure 1). The composition
of plasmid hosts reflects current research interests, with the Proteobacteria and Firmicutes phyla together
representing over 84% of plasmid sequences. In total, 510,463 different Coding Sequences (CDSs) were identified
in the plasmid dataset. 66.01% of the CDSs were predicted to encode a hypothetical protein, 27.9% had a known
product with Gene Ontology (GO) biological process annotation, with the remaining 6.09% encoded a known
protein product with unknown biological function (Figure 1B). There are 3,328,916 bacterial genes available in
the RefSeq database (NCBI Gene Statistics accessed on June 19th 2019), meaning that roughly one in twenty of
the currently known bacterial genes are plasmid-borne. The GO biological processes associated with plasmid
CDSs are diverse. The dominant associated terms relate to catabolic and biosynthetic processes (20.64%),
transposon mobility (17.09%) and positive and negative regulation of transcription (7.70%). Replicon-based
typing classified 27.66% of the plasmids into 163 different replicon types (Figure 1C and Supplementary Figure
2). However, 31.67% of these classified plasmids were assigned to multiple replicon types. MOB typing was more
comprehensive, successfully classifying 32.63% of the plasmids into six MOB types of which 9.48% were
assigned to multiple types (Figure 1C). Unsurprisingly, classification by these two methods performed best for
well-studied plasmids of the phyla Proteobacteria and Firmicutes.

95
96
97
98
99
100
101
102
103
104
105
106

We constructed a network based on the plasmid pairwise sequence similarities. This represents a weighted,

107
108
109
110
111
112

Finding all the cliques of a network is a nondeterministic polynomial (NP)-complete problem25. This means that

undirected network with plasmids (vertices) connected by edges indicating similarity (Supplementary Figure 3).
Similarity was scored using the exact Jaccard index (JI), defined as the size of the intersection divided by the size
of the union of two sets of k-mers. Plasmid pairs which shared less than 100 k-mers were considered to have a JI
equal to zero. This cut-off value was implemented since the majority of CDSs found on plasmids have lengths
greater than 100bp, thus only a fraction of the functional genome is common between plasmids with low shared
k-mer count (Supplementary Figures 4 and 5). The majority of plasmid pairs shared little to no similarity (Figure
1D). 6.14% (657) of the plasmids were singletons, whilst 3.31% (354) were connected to only one other plasmid,
illustrating the high levels of diversity across bacterial plasmid genomes. It follows that plasmids with more
k-mers in common are more likely to share the same functional genetic elements and hence participate in similar
biological processes falling within the same host niche (Supplementary Figure 5). Such plasmids are presumed to
form cliques with high internal JI score.

while a solution for a single clique can be quickly verified, the time required to find all possible cliques scales
rapidly as the size of the network increases. In the case of our large network of plasmids, a full solution cannot be
found within a reasonable timeframe given current computational limitations. As an alternative solution, a
community detection algorithm OSLOM (Ordered Statistics Local Optimization Method) was implemented26.
OSLOM detects communities (i.e. densely interconnected subgraphs) with statistical significance, meaning that

4

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

113
114
115
116
117

they have a low probability of being encountered by chance in a random network with similar features to the

118
119
120
121
122
123
124
125
126
127
128
129
130

Despite the notable dissimilarity among plasmids, the network as a whole was too dense (network density =

131

Plasmid cliques agree with current typing schemes

132
133
134
135
136
137
138
139
140
141
142

Analysis of the sparse network with OSLOM successfully assigned 50.21% (5371) of the plasmids into 561

143
144
145
146
147
148
149
150

Clique purity and Normalized Mutual Information (NMI) were used to assess the quality of clique-based

plasmid network. OSLOM is well suited for this task since it can be used to analyse undirected networks with
overlapping communities or hierarchical structures. In addition, OSLOM shows similar performance to other
widely used methods such as Infomap or Louvain26,27 which, unlike OSLOM, were unable to analyse this dataset
due to size and memory limitations.

0.0438) to yield a consistent performance for every OSLOM run (Figure 2 and Supplementary Figures 3 and 6).
Furthermore, a large proportion of communities detected did not form cliques, and thus had to be disregarded
(Figure 2A). A JI threshold was therefore introduced to increase the sparsity of the network. A range of thresholds
were assessed based on the following criteria: (i) the clique to community ratio (Figure 2A), (ii) the proportion of
plasmids assigned to cliques (Figure 2B), (iii) the congruence with replicon-based typing (Figure 2C), and (iv)
the consistency of OSLOM performance (Figure 2 and Supplementary Figure 6). The optimum threshold was
consistently obtained at a JI of 0.3. This threshold was also corroborated by an alternative data driven approach
introduced by Branger et al.28 called the giant component analysis. This method determines the optimal JI
threshold by tracking the size of the giant component (i.e. the largest cluster) of the network, and the total number
of components. In this case, the relative stability of the size of the giant component was reached at a JI threshold
of 0.3 (Supplementary Figure 7). Edges with values lower than the threshold were removed from the network.
The resulting sparse network is shown in Figure 3 (network density = 0.00128).

cliques (Figure 1C, Figure 3, and Supplementary Figure 10). 1.64% (88) of these plasmids were assigned to
multiple cliques, and were found in the densest regions of the network and at the interfaces between cliques
indicating the presence of ‚Äòchimeric plasmids‚Äô (i.e. hybrid plasmids generated through merging of two different
plasmids), large-scale transposition or recombination events, or extensive repeated transposition/recombination
(Figure 1C and Figure 3). In addition, this approach covered 564 plasmids from phyla other than the Proteobacteria
and Firmicutes, namely from Spirochaetes, Chlamydiae, Actinobacteria, Tenericutes, Bacteroidetes,
Cyanobacteria, and Fusobacteria. Interestingly, after applying the 0.3 JI threshold, 38.01% (4066) of plasmids
were separated from the network as singletons, while 10.10% (1080) shared an edge with a single plasmid. Such
plasmids could not be assigned to a clique. Therefore, only 1.67% (179) of plasmids were effectively left
unassigned by the algorithm.

classification (see Methods). These metrics were calculated for cliques comprising plasmids with identified
replicon type, plasmids carrying a single identified replicon type, or plasmids with assigned MOB type. Untyped
plasmids were disregarded. The observed purity scores were high (>85%) indicating the homogeneity of cliques
for a particular plasmid type (Supplementary Figure 8). This was particularly the case for MOB types (purity =
0.9887) and plasmids assigned to a single replicon type (purity = 0.9522). NMI provides an entropy-based measure
of the similarity between two classification systems where a score equal to one indicates identical partitioning
into classes while zero means independent classification. NMI penalizes differences in the number of assignment

5

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

151
152
153
154
155
156
157

classes which justifies the low score observed when assessing clique-based versus MOB-based typing (NMI =

158

Candidate replicon genes recovered from cliques of untyped plasmids

159
160
161
162
163

The majority of plasmids with unknown replicon types formed small cliques (Supplementary Figure 10). In fact,

164
165
166
167
168
169
170
171
172
173

In total, there are 388 cliques with no assigned replicon types. As the cliques tend to be homogeneous for a

174
175
176
177
178
179
180
181
182
183
184
185

To verify the plausibility of the identified gene candidates, HMMER (version 3.2.1) was used to scan amino acid

0.5223). Nevertheless, high NMI scores were obtained when considering a replicon-based classification scheme
(NMI = 0.9044 all types, and NMI = 0.9336 for single replicon types). It follows that plasmids with the same
replicon type often fall together within the same clique. This is also supported by the high correlation between the
clique membership size and the number of plasmids assigned to the corresponding replicon class (Supplementary
Figure 9, R2=0.862 for plasmids assigned to a single replicon types). However, there are exceptions where
plasmids from larger replicon classes are further resolved into a few smaller evolutionary related cliques.

81.02% of the smallest cliques (carrying three to five plasmids) contain exclusively untyped plasmids. Together
with the aforementioned singletons and lone plasmid pairs, this trend highlights the many understudied and
underrepresented plasmids in sequence databases. Accordingly, the next objective was to investigate the genetic
content of untyped cliques to determine candidate replicon genes and further traits of biological relevance.

replicon type, only the core genes (i.e. genes occurring on all plasmids of a particular clique) found on untyped
cliques were considered. Core genes were translated into protein sequences and screened against the translated
PlasmidFinder database using TBLASTN29. A range of e-values were assessed to determine the threshold
maximizing the discovery of replicon candidates while minimizing false positives (Supplementary Figure 11).
The majority of plasmids were assigned to one replicon type with some plasmids having hits to a maximum of
three to four different types. The optimal e-value threshold was selected when the total number of core gene hits
started to diverge from the number of untyped cliques covered. With this in mind, a conservative e-value threshold
of 0.001 was chosen which resulted in the identification of 105 candidate genes from 106 plasmid cliques
(Supplementary Table 1).

sequences for known protein domain families found in the Pfam database (version 32.0)30. 166 families, with
e-values lower than 0.001, were identified on 97 protein sequences and were most commonly associated with
replication initiation (Supplementary Figure 12). Moreover, the majority of functions associated with the
discovered protein families relate to plasmid replicon proteins. For example, domains with helix-turn-helix motifs
are important for DNA binding of replicon proteins and allow some proteins to regulate their own transcription31.
Other examples of transcriptional regulators also exist in plasmid replicon regions, while the DNA primase
activity has been found on the RepB replicon protein31. Interestingly, replicon proteins involved in rolling-circle
replication (a mechanism of plasmid replication) share some of their motifs with proteins involved in plasmid
transfer and mobilization31. This could explain why some of the discovered domain families are linked to plasmid
mobilization. On the whole, the candidate replicon genes are highly specific to a particular clique of plasmids and
should be useful for describing new incompatibility types.

6

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

186
187

Plasmids within cliques have a low variability in GC content and share a common
bacterial host

188
189
190
191
192
193
194
195
196
197

The unprocessed plasmid network exhibited a pronounced structure in terms of the plasmid nucleotide

198
199
200
201
202
203
204
205
206

Plasmid GC content has been shown to be strongly correlated to the base composition of the bacterial host‚Äôs

207

Plasmids within cliques have uniform gene content

208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223

The gene content of cliques was assessed for all genes occurring five or more times in the dataset. In total, 15,851

composition, measured by GC content (Supplementary Figure 3). This trend was also reflected in the clique
composition (Supplementary Figure 13A). Within a clique, the standard deviation of GC content rarely exceeds
0.02 and is weakly correlated with the clique size (R2 = 0.0155) (Supplementary Figure 13B). Furthermore, a
significant difference in GC content is often found between cliques. Analysis of variance (ANOVA), followed by
a Tukey test, found that 85.3% of the time the GC content between two cliques differs significantly (adjusted pvalue < 0.001). In contrast, the sequence lengths of plasmids within a clique are more variable, but are also not
strongly correlated with clique size (R2 = 0.029) (Supplementary Figure 13C and 13D). Similarly, a Tukey test
showed that a significant difference in plasmid length between cliques is observed less than 34% of the time
(adjusted p-value < 0.001).

chromosome32. Indeed, the cliques showed a very high homogeneity (purity) relative to their hosts (Supplementary
Figure 14), a trend which has been identified in other plasmid network reconstruction efforts20. At higher
taxonomic levels, cliques have near perfect purity scores (>0.99). The purity score slightly decreases at the level
of the plasmid host family, reaching a value of 0.807 at the species level. Therefore, plasmids with high genetic
similarity rarely transcend the level of the bacterial genus, which suggests a limited host range for the vast majority
of plasmids. However, these results need to be carefully considered due to inherent biases in the dataset, especially
in terms of the predominance of well-studied taxa. Overall, the plasmid cliques show a strong intrinsic propensity
towards confined GC content and are found in a limited range of bacterial hosts.

out of 35,883 (44.17%) of the assessed genes were ‚Äòcore‚Äô genes, meaning they had a within-clique frequency
equal to one, suggesting an overall uniformity of gene content in cliques (Supplementary Figure 15). Furthermore,
6,577 (18.33%) of the genes were ‚Äòprivate‚Äô. Private genes are those found in only one clique, with a frequency of
one, and their relatively high abundance in the dataset suggests the uniqueness of some cliques with respect to
their gene content. However, there is an inherent bias. Plasmids within larger cliques tend to be more dissimilar
and share proportionally fewer genes (Supplementary Figure 16). This pattern can in part be explained by the
broader gene content of large cliques and the high sequence similarity required for same-gene clustering (95%)
within the default implementation of the Prokka-Roary annotation pipeline. 31.94% of cliques containing five or
more plasmids were found to have one to 10 core genes. However, cliques exhibited a wide range in the number
of core genes with 7.74% of cliques carrying over 100 shared genes. Interestingly, 13.55% (42) of cliques had no
core genes which could also be an artefact of the gene annotation pipeline sensitivity. For instance, plasmids from
19 cliques carried no recognized genes from the pool of 35,883 assessed genes. Functionally, core genes were
found to be more often associated with various metabolic processes, transcription regulation and transmembrane
transport (Supplementary Figure 17) when compared to the overall distribution of GO terms, shown in Figure 1B.
Similarly, fewer core genes were involved in transposon movement, pathogenesis, and resistance.

7

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

224

Inferring bacterial horizontal gene transfer through clique interactions

225
226
227
228
229
230
231

Gene content was also considered in the context of clique structure and interconnectedness. To do so, the original

232
233
234
235
236
237
238
239
240
241

The clustering of cliques in Figure 4 shows high concordance with the phylogenetic hierarchy of the bacterial

242
243
244
245
246
247
248
249

The core and shared gene content of the three Firmicutes clusters (Staphylococcus, Enterococcus and Dairy) was

network of plasmids (Supplementary Figure 3) was rearranged such that: (i) plasmids assigned to the same clique
were clustered under a single vertex; (ii) plasmids assigned to multiple cliques were left as solitary vertices
anchoring the cliques; (iii) unassigned plasmids were removed. The resulting network is shown in Figure 4. As
highlighted earlier, large cliques generally show lower internal similarity compared to the smaller ones. It is
important to note that an arbitrary JI threshold of 0.01 was introduced in Figure 4 to assist visual interpretation,
but the unfiltered version of the network is provided in Supplementary Figure 18.

hosts. On a global scale, there are four large interconnected clusters (three corresponding to cliques from the
phylum Firmicutes and one from the Proteobacteria), eight disjointed clusters, and a dozen singled-out triplets
and pairs. The clique clusters mostly contain plasmids from a specific genus with some minor deviations ‚Äì hence
the cluster naming. The only two exceptions are the large and diverse Proteobacteria cluster which harbours
plasmids mainly from the genera Escherichia, Klebsiella, and Salmonella, and the Dairy bacteria. The majority
of genes identified in these four large clusters were those functionally involved in transposition. Specifically,
26.4% of the genes in the Proteobacteria cluster were transposition related. In addition, 9.66% of the genes in the
Proteobacteria were involved in some form of AMR or metal resistance, and 7.38% in pathogenesis, which may
reflect the high number of pathogens found in this phylum33.

also assessed (Figure 4, Venn diagram). Gene sharing was most common between the plasmid clusters associated
with Staphylococcus and Enterococcus potentially indicating a high frequency of HGT between them, and the
least between the Staphylococcus and Dairy bacteria cluster. Analysing the content of these shared genes provides
insight into both plasmid function and dynamics, such as the identification of HGT events. For example, the same
lactose metabolism genes were found in both Staphylococcus and Dairy bacteria plasmids. Also, the trpF gene,
involved in tryptophan biosynthesis and previously associated with the Tn3000 and Tn125 transposable
elements34,35, was found on plasmids in all three clusters.

8

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

250

Discussion

251
252
253
254
255
256
257

Using alignment-free sequence similarity comparison and subsequent network analysis we uncovered strong

258
259
260
261
262
263
264
265
266

A network-based representation of plasmid sequence similarities condenses both vertical and horizontal

267
268
269
270
271
272
273
274
275
276
277

Jaccard index (i.e. the fraction of shared k-mers) was chosen as a measure of sequence similarity between pairs

278
279
280
281
282
283
284
285
286
287

Assessing the statistical significance of all resulting cliques is computationally intractable given the size of the

population structure in bacterial plasmids. This approach, applied to a comprehensive set of complete bacterial
plasmids, yielded a network in which over half of the plasmids were assigned to statistically significant cliques.
This is a significant improvement in coverage over existing plasmid typing methods. Additionally, the cliques
capture biologically meaningful information. For example, plasmids assigned to the same clique show good
accord with replicon and MOB typing schemes, high homogeneity in terms of their respective bacterial hosts, and
similar GC and gene content.

evolutionary histories in a similar fashion to gene-sharing networks17,20,21, making it ideally suited for the
identification of mobile genetic elements. The model employed here assigns plasmids to cliques, delineating
clusters of plasmids with shared evolutionary history. This in turn allows for inference on the nature of HGT
events and plasmid function. Moreover, the approach facilitates identification of new replicon gene candidates,
as well as detailed investigation of the distribution of plasmid-borne genetic determinants of incompatibility,
mobility, AMR, virulence, and transposon carriage. Such meta-information could be incorporated within the
network framework thanks to a plethora of well-maintained bioinformatics tools, ever growing genetic databases,
and gene ontology efforts to systematize gene annotation.

of plasmids due to it being a straightforward metric which considers genome sequences as a whole, embodying
both point mutations and large-scale genome rearrangements. As a result, it is not biased by the ability to annotate
genes, open reading frames, or other genetic elements. In addition, it is not prone to errors and biases intrinsically
associated with alignment-based methods, such as: a priori assumptions about the sequence evolution, higher
inaccuracy when comparing more dissimilar sequences, or suboptimal alignments22. JI can in principle provide
fine-scale resolution when comparing small genomes, a characteristic common to the majority of plasmids.
Conversely, JI is sensitive to varying genome sizes24 and plasmids are known to differ more than 1000-fold in
sequence length7,36. While differences in plasmid genome size can lead to a drop in JI score even when high
proportions of k-mers are shared, sequence length variation did not seem to impact our structuring into cliques
which comprise plasmids of different lengths (Supplementary Figure 13C and D).

network. Hence, the OSLOM community detection algorithm was employed to uncover cliques that are unlikely
to be found in a random network. In an effort to optimize the performance of the OSLOM algorithm and maximize
the number of biologically meaningful cliques, all edges with a JI value below 0.3 were removed from the
network. This threshold was chosen to maximise compliance with replicon-based typing as well as several other
criteria. The implementation of the 0.3 JI threshold somewhat allegorizes the average nucleotide identity (ANI),
which was set over a decade ago at 95%, to define the species boundary for prokaryotes37. However, depending
on the question pursued, enforcing a strict JI threshold may not be necessary, and it could be left to plasmid
sequences in the network to solely inform the cut-offs. Some boundaries are likely to be blurrier than others,
largely reflecting the extensive variation of genetic inheritance in different bacterial hosts.

9

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

288
289
290
291
292
293
294
295

The strong underlying population structure we document for plasmids throughout bacteria suggests it should be
possible to devise a ‚Äònatural‚Äô, global sequence-based classification scheme for bacterial plasmids. This being said,
our findings do not diminish the relevance of replicon and MOB typing schemes, rather they build upon these
prior classification schemes and may even extend them to plasmids from understudied and uncultured bacteria.
Beyond just plasmid classification, our network-based approach also has potential to infer key features of plasmid
groupings. Indeed, plasmid clique assignment can be completely automated and inspection of any particular area
of the network facilitates biological inference about plasmid dynamics and their biological features within various
groups of bacterial hosts.

10

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

296

Methods

297

Assembling a dataset of complete bacterial plasmids

298
299
300
301
302
303
304
305

A dataset of complete plasmids was downloaded from NCBI‚Äôs RefSeq release repository38 on 26th of September

306
307
308
309
310
311
312

Information about the taxonomic hierarchy of plasmid bacterial hosts was obtained with the ncbi_taxonomy

313
314
315
316
317
318
319
320
321

Plasmid CDSs were annotated using the Prokka41 (version 1.13.3) and Roary42 (version 3.12.0) pipelines run with

322

Assessing similarity between pairs of plasmids

323
324
325
326
327

The exact Jaccard index (JI) was used as a measure of similarity between all possible plasmid pairs. To do this,

328

Implementing OSLOM community detection algorithm

329
330

OSLOM (Ordered Statistics Local Optimization Model version 2.5) was applied to identify statistically significant

2018. The metadata accompanying each plasmid sequence was parsed from the associated GenBank files
(Supplementary Table 1). The resulting dataset was then systematically curated to include only those plasmids
sequenced from a bacterial host and with a sequence description which implies a complete plasmid sequence
(regular expression term used: ‚Äúplasmid.*complete sequence‚Äù). This is a simpler, but similar approach
to a previously reported curation effort by Orlek and collegues9. Nevertheless, a large portion of unsuitable entries,
such as gene sequences, partial plasmid genomes, whole genomes, non-bacterial sequences and other poorly
annotated sequences, were removed. The final dataset included 10,696 complete bacterial plasmids.

module from the ETE 3 Python toolkit39. To determine the replicon and MOB types of plasmids included in the
dataset we used the PlasmidFinder replicon database12 and MOBtyping software40. The PlasmidFinder database
was screened using BLAST29 with a minimum coverage and percentage nucleotide identity of 95%. In cases
where two or more replicon hits were found at overlapping positions on a plasmid, the one with higher percentage
identity was retained. For determining the plasmid MOB type, MOBtyping software was used with the
recommended settings of 14 PSI-BLAST iterations.

default parameters. The identified CDSs were further associated with Gene Ontology (GO) terms43,44 to facilitate
downstream gene content analysis. Since Prokka uses a variety of databases to annotate identified CDSs, different
resources have been used to append the corresponding GO terms. For example, GO terms for CDSs with a known
protein product have been obtained using Uniprot‚Äôs ‚ÄòRetrieve/ID Mapping‚Äô tool45, while the GO terms for CDSs
with just the HAMAP family were obtained with the hamap2go mapping table46 (version date: 2019/05/04). CDSs
annotated with the ISfinder database were given GO terms GO:0070893 and GO:0004803 in order to associate
them with transposition. Similarly, CDS annotated with Aragorn, MinCED, and BARRGD were given
GO:0006412, GO:0099048, and GO0046677 terms respectively.

each plasmid sequence was converted to a set of 21 bp k-mers. The JI was then calculated as the fraction of shared
k-mers between two sets. JI thus takes a value between 0 and 1, where 1 indicates 100% k-mer similarity, and 0
indicates no k-mers shared. We applied Bindash47 to calculate the exact JI which resulted in the creation of a
plasmid adjacency matrix which was used to build the network.

cliques (complete subgraphs) in the plasmid network26. OSLOM aims to identify highly cohesive clusters of

11

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

331
332
333
334
335
336
337
338
339
340
341
342

vertices (communities) which may or may not be cliques (complete subgraphs). The statistical significance of a

343

OSLOM was executed for an undirected and weighted network with the following parameters:

cluster is measured as the probability of finding the cluster in a configuration model which is designed to build
random networks while preserving the degrees (number of neighbours) of each vertex. The method locally
optimizes the statistical significance with respect to vertices directly neighbouring a particular cluster. In brief,
OSLOM starts by randomly choosing vertices from a network which are regarded as clusters of size one. These
small clusters alongside their neighbouring vertices are assessed. Vertices are scored based on their connection
strength with a particular cluster and are either added or removed from the cluster. The process continues until
the entire network is covered. Due to the stochastic nature of the algorithm, this network assessment goes through
many iterations after which the frequently emerging significant clusters (i.e. communities) are kept. The algorithm
then proceeds to assess the clusters of the next hierarchical level; vertices belonging to the significant clusters are
condensed into super-vertices with weighted edges connecting them. The process of cluster assessment is repeated
at higher hierarchical levels until no more significant clusters are recovered.

344

oslom_undir -w -t 0.05 -r 50 -cp 0 -singlet -hr 0 -seed 1

345
346
347
348
349
350
351
352
353
354

Clusters were considered significant if their p-value was lower than 0.05 ( -t 0.05 ). The number of iterations

355
356
357
358
359

As mentioned earlier, OSLOM is a non-deterministic algorithm and the initial single-vertex clusters are chosen at

360

Scoring normalized mutual information (NMI) and purity

361
362
363

The compliance of cliques with replicon and MOB typing schemes was assessed by measuring the Normalized

required before the recovery of significant clusters was set to 50 during the search for the optimally sparse network
( -r 50 ), and 250 for the final network analysis after the introduction of the 0.3 JI threshold ( -r 250 ). After
the iteration process, OSLOM considers merging similar significant clusters if the significance of their union is
high enough. This feature can potentially yield less cliques and was suppressed with the coverage parameter set
to zero ( -cp 0 ) thus forcing OSLOM to opt for the biggest and most significant cluster from a set of similar
clusters. In addition, OSLOM tries to place all vertices of a network in clusters which is also unfavourable for
clique recovery and was suppressed with option ( -singlet ). Lastly, significant cliques can only be recovered
at the first hierarchical level. Therefore, the OSLOM analysis of the higher hierarchical levels was disregarded
( -hr 0 ).

random. While looking for the optimally sparse network, five OSLOM runs were executed to assess every JI
threshold and were given seeds for a random number generator ( -seed ) of 1, 5, 42, 93, and 212. The final
network analysis was performed with a seed equal to 42, after which only cliques were considered with noncomplete communities disregarded.

Mutual Information (NMI) and purity between them. NMI is a commonly used method to assess the performance
of clustering algorithms48. For the two clustering/classification schemes (C1 and C2) NMI is defined as49:
ùëµùë¥ùë∞(ùë™ùüè , ùë™ùüê ) =

ùë∞(ùë™ùüè , ùë™ùüê )
.
[ùëØ(ùë™ùüè ) + ùëØ(ùë™ùüê )]
ùüê

(1)

12

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

364
365
366
367
368
369
370
371
372

In equation (1), the mutual information, also known as the information gain and denoted as I(C1,C2), is an

373
374

Purity was used to estimate the homogeneity of cliques for replicon or MOB types, and plasmid host taxa. For a

information theory concept which measures the reduction of uncertainty around C1 given knowledge about the
C2, and vice versa. It is normalized by the averaged Shannon entropy (H) between C1 and C2. Shannon entropy
tends to be larger as the number of classes in C1 or C2 approach the size of the dataset in question. Consequently,
the NMI is sensitive to differences in the number of classes between C1 and C2, and to extensively fragmented
classifications. The NMI equals one if the two classifications yield identical partitioning of the dataset, whereas a
value of zero indicates complete incoherence. The NMI was measured using the R package NMI (version 2.0;
https://CRAN.R-project.org/package=NMI). During the assessment, plasmids which were not classified by
replication or MOB typing schemes were disregarded.

set of cliques C, and a plasmid typing scheme T, purity is defined as:
ùíëùíñùíìùíäùíïùíö(ùë™, ùëª) =

ùüè
8 ùê¶ùêöùê±>ùíÑùíä ‚à© ùíïùíã >
ùíïùíã ‚ààùëª
ùëµ

(2)

ùíÑùíä ‚ààùë™

375
376
377
378
379

where N is the total number of plasmids covered by a set of cliques, C = { c1, c2, ‚Ä¶, ci } is a set of cliques in which
plasmids were placed, and T = { t1, t2, ‚Ä¶, tj } are the types associated with plasmids. Similar to NMI, the purity
scores a value between 0 and 1 with high purity indicating high homogeneity of classes in the dataset for a given
set of plasmid types. The purity was only assessed for cliques which contain at least one typed plasmid. Untyped
plasmids found within the assessed cliques were disregarded.

13

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439

References
1.
2.
3.
4.
5.
6.
7.
8.
9.
10.
11.
12.
13.
14.
15.
16.
17.
18.
19.
20.
21.
22.
23.
24.
25.
26.
27.
28.

Shintani, M. & Suzuki, H. Plasmids and Their Hosts. in DNA Traffic in the Environment 109‚Äì133
(Springer Singapore, 2019).
Von Wintersdorff, C. J. H. et al. Dissemination of antimicrobial resistance in microbial ecosystems
through horizontal gene transfer. Front. Microbiol. 7, (2016).
Halary, S., Leigh, J. W., Cheaib, B., Lopez, P. & Bapteste, E. Network analyses structure genetic
diversity in independent genetic worlds. Proc. Natl. Acad. Sci. 107, 127‚Äì132 (2010).
Stokes, H. W. & Gillings, M. R. Gene flow, mobile genetic elements and the recruitment of antibiotic
resistance genes into Gram-negative pathogens. FEMS Microbiol. Rev. 35, 790‚Äì819 (2011).
Carattoli, A. et al. Identification of plasmids by PCR-based replicon typing. J. Microbiol. Methods 63,
219‚Äì228 (2005).
Garcill√°n-Barcia, M. P., Francia, M. V. & de La Cruz, F. The diversity of conjugative relaxases and its
application in plasmid classification. FEMS Microbiol. Rev. 33, 657‚Äì687 (2009).
Shintani, M., Sanchez, Z. K. & Kimbara, K. Genomics of microbial plasmids: Classification and
identification based on replication and transfer systems and host taxonomy. Front. Microbiol. 6, 1‚Äì16
(2015).
Orlek, A. et al. Plasmid classification in an era of whole-genome sequencing: Application in studies of
antibiotic resistance epidemiology. Frontiers in Microbiology 8, 1‚Äì10 (2017).
Orlek, A. et al. Ordering the mob: Insights into replicon and MOB typing schemes from analysis of a
curated dataset of publicly available plasmids. Plasmid 91, 42‚Äì52 (2017).
Lozano, C. et al. Expansion of a plasmid classification system for Gram-positive bacteria and
determination of the diversity of plasmids in Staphylococcus aureus strains of human, animal, and food
origins. Appl. Environ. Microbiol. 78, 5948‚Äì55 (2012).
Jensen, L. B. et al. A classification system for plasmids from enterococci and other Gram-positive
bacteria. J. Microbiol. Methods 80, 25‚Äì43 (2010).
Carattoli, A. et al. In Silico Detection and Typing of Plasmids using PlasmidFinder and Plasmid
Multilocus Sequence Typing. 58, 3895‚Äì3903 (2014).
Rozwandowicz, M. et al. Plasmids of Distinct IncK Lineages Show Compatible Phenotypes.
Antimicrob. Agents Chemother. 61, e01954-16 (2017).
Ambrose, S. J., Harmer, C. J. & Hall, R. M. Compatibility and entry exclusion of IncA and IncC
plasmids revisited: IncA and IncC plasmids are compatible. Plasmid 96‚Äì97, 7‚Äì12 (2018).
Robertson, J. & Nash, J. H. E. MOB-suite: software tools for clustering, reconstruction and typing of
plasmids from draft assemblies. Microb. Genomics 4, (2018).
Bapteste, E. et al. Prokaryotic evolution and the tree of life are two different things. Biol. Direct 4, 34
(2009).
Brilli, M. et al. Analysis of plasmid genes by phylogenetic profiling and visualization of homology
relationships using Blast2Network. BMC Bioinformatics 9, 551 (2008).
Corel, E., Lopez, P., M√©heust, R. & Bapteste, E. Network-Thinking: Graphs to Analyze Microbial
Complexity and Evolution. Trends Microbiol. 24, 224‚Äì237 (2016).
Dagan, T., Artzy-Randrup, Y. & Martin, W. Modular networks and cumulative impact of lateral transfer
in prokaryote genome evolution. Proc. Natl. Acad. Sci. U. S. A. 105, 10039‚Äì44 (2008).
Tamminen, M., Virta, M., Fani, R. & Fondi, M. Large-Scale Analysis of Plasmid Relationships through
Gene-Sharing Networks. Mol. Biol. Evol. 29, 1225‚Äì1240 (2012).
Yamashita, A. et al. Characterization of Antimicrobial Resistance Dissemination across Plasmid
Communities Classified by Network Analysis. Pathogens 3, 356‚Äì376 (2014).
Zielezinski, A., Vinga, S., Almeida, J. & Karlowski, W. M. Alignment-free sequence comparison:
Benefits, applications, and tools. Genome Biol. 18, 1‚Äì17 (2017).
Jesus, T. F. et al. Plasmid ATLAS: plasmid visual analytics and identification in high-throughput
sequencing data. Nucleic Acids Res. 47, D188‚ÄìD194 (2019).
Ondov, B. D. et al. Mash: fast genome and metagenome distance estimation using MinHash. Genome
Biol. 1‚Äì14 (2016).
Karp, R. M. Reducibility among Combinatorial Problems. in Complexity of Computer Computations
85‚Äì103 (Springer US, 1972).
Lancichinetti, A., Radicchi, F., Ramasco, J. J. & Fortunato, S. Finding Statistically Significant
Communities in Networks. PLoS One 6, e18961 (2011).
Hric, D., Darst, R. K. & Fortunato, S. Community detection in networks: Structural communities versus
ground truth. Phys. Rev. E 90, 062805 (2014).
Branger, C. et al. Extended-spectrum Œ≤-lactamase-encoding genes are spreading on a wide range of
Escherichia coli plasmids existing prior to the use of third-generation cephalosporins. Microb. Genomics

14

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483

29.
30.
31.
32.
33.
34.
35.
36.
37.
38.
39.
40.
41.
42.
43.
44.
45.
46.
47.
48.
49.

4, e000203 (2018).
Altschul, S. F., Gish, W., Miller, W., Myers, E. W. & Lipman, D. J. Basic local alignment search tool. J.
Mol. Biol. 215, 403‚Äì410 (1990).
El-Gebali, S. et al. The Pfam protein families database in 2019. Nucleic Acids Res. 47, D427‚ÄìD432
(2019).
del Solar, G., Giraldo, R., Ruiz-Echevarr√≠a, M. J., Espinosa, M. & D√≠az-Orejas, R. Replication and
control of circular bacterial plasmids. Microbiol. Mol. Biol. Rev. 62, 434‚Äì64 (1998).
Nishida, H. Comparative Analyses of Base Compositions, DNA Sizes, and Dinucleotide Frequency
Profiles in Archaeal and Bacterial Chromosomes and Plasmids. Int. J. Evol. Biol. 2012, 1‚Äì5 (2012).
Rizzatti, G., Lopetuso, L. R., Gibiino, G., Binda, C. & Gasbarrini, A. Proteobacteria: A Common Factor
in Human Diseases. Biomed Res. Int. 2017, 9351507 (2017).
Hu, H. et al. Novel plasmid and its variant harboring both a bla(NDM-1) gene and type IV secretion
system in clinical isolates of Acinetobacter lwoffii. Antimicrob. Agents Chemother. 56, 1698‚Äì702
(2012).
Campos, J. C. et al. Characterization of Tn3000, a Transposon Responsible for blaNDM-1
Dissemination among Enterobacteriaceae in Brazil, Nepal, Morocco, and India. Antimicrob. Agents
Chemother. 59, 7387‚Äì95 (2015).
Smillie, C., Garcill√°n-Barcia, M. P., Francia, M. V., Rocha, E. P. C. & de la Cruz, F. Mobility of
plasmids. Microbiol. Mol. Biol. Rev. 74, 434‚Äì52 (2010).
Klappenbach, J. A. et al. DNA‚ÄìDNA hybridization values and their relationship to whole-genome
sequence similarities. Int. J. Syst. Evol. Microbiol. 57, 81‚Äì91 (2007).
O‚ÄôLeary, N. A. et al. Reference sequence (RefSeq) database at NCBI: current status, taxonomic
expansion, and functional annotation. Nucleic Acids Res. 44, D733-45 (2016).
Huerta-Cepas, J., Serra, F. & Bork, P. ETE 3: Reconstruction, Analysis, and Visualization of
Phylogenomic Data. Mol. Biol. Evol. 33, 1635‚Äì1638 (2016).
Orlek, A. et al. A curated dataset of complete Enterobacteriaceae plasmids compiled from the NCBI
nucleotide database. Data Br. 12, 423‚Äì426 (2017).
Seemann, T. Prokka: rapid prokaryotic genome annotation. Bioinformatics 30, 2068‚Äì2069 (2014).
Page, A. J. et al. Roary: rapid large-scale prokaryote pan genome analysis. Bioinformatics 31, 3691‚Äì
3693 (2015).
Ashburner, M. et al. Gene ontology: tool for the unification of biology. The Gene Ontology Consortium.
Nat. Genet. 25, 25‚Äì9 (2000).
Carbon, S. et al. The Gene Ontology Resource: 20 years and still GOing strong. Nucleic Acids Res. 47,
D330‚ÄìD338 (2019).
Huang, H. et al. A comprehensive protein-centric ID mapping service for molecular data integration.
Bioinformatics 27, 1190‚Äì1191 (2011).
Lima, T. et al. HAMAP: a database of completely sequenced microbial proteome sets and manually
curated microbial protein families in UniProtKB/Swiss-Prot. Nucleic Acids Res. 37, D471‚ÄìD478 (2009).
Zhao, X. BinDash, software for fast genome distance estimation on a typical personal laptop.
Bioinformatics 35, 671‚Äì673 (2019).
Fortunato, S. & Hric, D. Community detection in networks: A user guide. Phys. Rep. 659, 1‚Äì44 (2016).
Fred, A. L. N. & Jain, A. K. Robust data clustering. in 2003 IEEE Computer Society Conference on
Computer Vision and Pattern Recognition, 2003. Proceedings. 2, II-128-II‚Äì133 (IEEE Comput. Soc,
2003).

484

15

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

485

Acknowledgments

486
487
488
489
490
491

M.A. was supported by a PhD scholarship from BBSRC (XXX). L.v.D. and F.B. acknowledge financial support

492

Contributions

493
494
495
496
497

M.A., and F.B. conceived the project and designed the experiments. M.A. performed all the analyses under the

498

Competing Interests

499

The authors declare no competing financial interests.

from the Newton Fund UK-China NSFC initiative (MRC grant MR/P007597/1). F.B. additionally acknowledges
support from the BBSRC GCRF scheme and the National Institute for Health Research University College
London Hospitals Biomedical Research Centre. The funders had no role in study design, data collection,
interpretation of results, or the decision to submit the work for publication. Lastly, we would like to thank Prof
Chris Barnes for providing advice about network analyses.

guidance of L.v.D and F.B. J.M.S advised on plasmid biology. M.A., Lv.D and F.B. take responsibility for the
accuracy and availability of the results. L.v.D. provided moral support to M.A. M.A. wrote the paper with
contributions from L.v.D and F.B.. All authors read and commented on successive drafts and all approved the
content of the final version.

16

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

500
501

Figures
Firmicutes (23.24%)

A

Spirochaetes (5.49%)
Other (15.76%)

Actinobacteria (4.55%)
Cyanobacteria (1.99%)
Other (1.78%)
Bacteroidetes (1.12%)
Chlamydiae (0.81%)

Proteobacteria (60.99%)

B

25
20

unknown
function (6.09%)

15
10

hypothetical protein
(66.01%)

5

40

8

10

7

10

6

10

5

10

4

r
Ot
he

s
roc
cp

me

tab

oli

itio
os
sp

tra
n

Types/Cliques
assigned:

10

es

ted
nr

ula

ela

tio
n

ort
sp

reg

scr
tra
n

tra
n

ipt
ion

bra
em

DN

sm

Ar

ec

ne

om

tra
n

ge

bin

ne

ati

on

sis

e
nc
pa

C

D

Single
30

Multiple

Phylum:

20

Count

Plasmids covered (%)

50

tho

ista

tio
n
ga
nju

res

air
ep

co

es

ivis

Ar
DN

s

ll d

roc
np

ce

is
tas
os

ctio

me

du

ho

-re

on

tio
n

ni
ox

ida

iro

ion

0

Proportion (%) of Annotated Genes

30

known function (27.9%)

Proteobacteria
10

Firmicutes
Other

0
Replicon typing

502
503
504
505
506
507
508
509
510
511

MOB typing

Network

0

(0,0.25] (0.25,0.5] (0.5,0.75] (0.75,1]

Jaccard Index of Plasmid Pairs

Figure 1. Summary of the dataset of complete bacterial plasmids. (A) The distribution of host phylum
represented in the plasmid dataset. (B) Functional annotation of plasmid-borne genes. The pie chart shows
the proportion of CDSs with hypothetical function as predicted by Prokka41, and CDSs (genes) with
known/unknown biological function based on GO annotation. The bar chart provides the most common
biological functions associated with plasmid-borne genes also considering the respective frequency of
these genes on plasmid genomes. (C) The percentage of plasmids covered by the three classification
methods: replicon and MOB typing schemes, and clique assignment. (D) The distribution of pairwise
plasmid similarities (Jaccard Index).

17

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Plasmids covered (%)

512
90
80
70
60
50
40
30
20
10
0

A

Clique
Community

Plasmids covered (%)

0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

60

0.9

1.0

B

50
40
30

Cliques
assigned:
Single

20

Multiple

10
0
0.0

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1.0

0.90

NMI

Cluster
feature:

Replicon
types:

0.85

C

0.80

All
Single

0.75
0.0

513
514
515
516
517
518
519
520
521
522

0.1

0.2

0.3

0.4

0.5

0.6

0.7

0.8

0.9

1.0

Jaccard Index threshold

Figure 2. Searching for the optimally sparse plasmid network. A range of Jaccard Index (JI) thresholds
were applied to the original plasmid network (Supplementary Figure 3) prior to OSLOM analysis. During
the process, several criteria were considered: (A) clique to community ratio; (B) percentage of plasmids
covered by the cliques; (C) the congruence with replicon typing measured by NMI score. NMI was
calculated for all cliques containing plasmids assigned to a single or multiple replicon types (legend: All)
and just to a single replicon type (legend: Single). Error bars (A and B) and light-coloured shading (C)
provide two standard deviations of uncertainty. The dashed vertical line indicates the selected optimal JI
threshold of 0.3.

18

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

523
524
525
526
527
528

Single-clique plasmids

Multi-clique plasmids

Unassigned plasmids

Figure 3. Sparse network of plasmids assigned to cliques by OSLOM algorithm (network density =
0.00128). The network includes 5371 plasmids (nodes) assigned into 561 cliques (connected sub-graphs).
5,008 unassigned plasmids, which formed disjoined singletons and pairs, were removed from the network.
Coloured nodes indicate plasmids assigned to a single clique.

19

bioRxiv preprint doi: https://doi.org/10.1101/785212; this version posted September 28, 2019. The copyright holder for this preprint (which
was not certified by peer review) is the author/funder, who has granted bioRxiv a license to display the preprint in perpetuity. It is made
available under aCC-BY-NC-ND 4.0 International license.

Cliques of plasmids:
Proteobacteria
Firmicutes

Borreliella
clusters

Other phylum
Multi-clique plasmids
High JI

Edges:
many connections

Low JI

Piscirickettsia

Xanthomonas

few connections

Proteobacteria

5

10
5
0

do

Ps
eu

Ae
ro

id

id

Phaeobacter

sm

pla

1970

transposition; AMR
DNA recombination; conjugation

iron ion homeostasis; pathogenesis

543

conjugation

AMR

32

tryptophan
biosynthesis

AMR

AMR

107
transposition
lactose
metabolism
AMR

40
30
20
10
0

metal resistance

protein transport

pathogenesis

999

Sta
p

transposition

oc
cu
s
on
os
toc
Lis
ter
Pe
ia
dio
co
ccu
La
cto
s
ba
cillu
La
cto
s
co
ccu
s

carbohydrate metabolism
transcription antitermination

DNA integration

loc

recombination

uc

DNA

Proportion (%)

hemolysis

33

transposition

spore formation
chromosome segregation
DNA repair

Enterococcus
cluster

carbohydrate transport

DNA recombination

cadmium resistance

transcription regulation

transposition
DNA recombination

hy

1228
transposition

Staphylococcus
cluster

Bacillus clusters

Dairy
bacteria
cluster

Le

sm

Aeromonas

mo
n

pa
rtit
ion
ce
ing
ll d
ma ivisio
int
n
tra
e
n
ns
me
DN ance
mb
Ar
tra
ran
ep
ns
crip e tra air
ns
tio
po
rt
me n reg
ula
ta
tio
DN bolic
pro n
Ar
ec
c
e
om
s
bin s
atio
co
n
nju
ga
pa
t
ion
tho
ge
ne
sis
res
ista
nc
e
Ot
tra
he
ns
r
rela posit
io
ted n

0

15

as
Vib
rio
mo
Ph
n
as
a
C a eo ba
mp
c
ylo ter
ba
c
ter
Cit
ro
En bact
er
ter
Ac obac
ine
ter
tob
ac
ter
Ye
rsin
ia
Ot
h
Sa
er
lm
on
ella
Kle
b
Es siella
ch
eric
hia

10

Proportion (%)

15

20

Proportion (%)

25
20

pla

Zymomonas

30
25

529
530
531
532
533
534
535
536
537
538
539
540
541
542
543

Rhizobium clusters

Figure 4. The network of cliques. Cliques, represented as vertices, are connected with an edge if the average
Jaccard Index (JI) between plasmids of two cliques is higher than 0.01. The colour of the edges indicates the
average JI while the width is proportional to the number of connections between a pair of cliques. The shape
and colour of the cliques indicates the phylum of the predominant bacterial host. The size and the transparency
are proportional to the clique size and the internal JI respectively. The cliques form multiple clusters which
have been named based on the genus of the bacterial host characteristic for a particular cluster. There are two
exceptions ‚Äì the Proteobacteria and the Dairy (Lactic) cluster whose respective genera distributions have been
provided. The most common GO biological functions of the genes found on plasmids of Proteobacteria,
Staphylococcus, Enterococcus and Dairy clusters were further assessed. During the assessment, the respective
frequencies of the genes were considered. In case of Proteobacteria, the bar chart distribution of the biological
functions is provided. The shared and core gene content of Staphylococcus, Enterococcus and Dairy clusters
is presented in the Venn diagram with the numbers in the diagram indicating the number of core and shared
genes.

20

