Astronomy & Astrophysics manuscript no. ciarVF
June 27, 2019

c ESO 2019

Discrete-time autoregressive model for unequally spaced
time-series observations
Felipe Elorrieta1, 3 , Susana Eyheramendy2, 3, 4, 5 , and Wilfredo Palma2, 3
1
2
3

arXiv:1906.11158v1 [astro-ph.IM] 26 Jun 2019

4
5

Departmento de Matem√°ticas, Facultad de Ciencia, Universidad de Santiago de Chile, Av. Libertador Bernardo O‚ÄôHiggins 3663.
Estacion Central, Santiago, Chile
Departmento de Estad√≠stica, Facultad de Matem√°ticas, Pontificia Universidad Cat√≥lica de Chile, Av. Vicu√±a Mackenna 4860, 7
820436 Macul, Santiago, Chile
Millennium Institute of Astrophysics, Santiago, Chile
Max-Planck-Institut f√ºr Astronomie, Heidelberg, Germany
Faculty of Engineering and Sciences, Universidad Adolfo Iba√±ez, Diagonal Las Torres 2700, Pe√±alol√©n, Santiago, Chile

June 27, 2019
ABSTRACT

Most time-series models assume that the data come from observations that are equally spaced in time. However, this assumption does
not hold in many diverse scientific fields, such as astronomy, finance, and climatology, among others. There are some techniques
that fit unequally spaced time series, such as the continuous-time autoregressive moving average (CARMA) processes. These models
are defined as the solution of a stochastic differential equation. It is not uncommon in astronomical time series, that the time gaps
between observations are large. Therefore, an alternative suitable approach to modeling astronomical time series with large gaps
between observations should be based on the solution of a difference equation of a discrete process. In this work we propose a novel
model to fit irregular time series called the complex irregular autoregressive (CIAR) model that is represented directly as a discretetime process. We show that the model is weakly stationary and that it can be represented as a state-space system, allowing efficient
maximum likelihood estimation based on the Kalman recursions. Furthermore, we show via Monte Carlo simulations that the finite
sample performance of the parameter estimation is accurate. The proposed methodology is applied to light curves from periodic
variable stars, illustrating how the model can be implemented to detect poor adjustment of the harmonic model. This can occur when
the period has not been accurately estimated or when the variable stars are multiperiodic. Last, we show how the CIAR model, through
its state space representation, allows unobserved measurements to be forecast.
Key words. autoregressive model,time series,light curves,negative autocorrelation,antipersistent process

1. Introduction
Time-series theory is vast and provides a myriad of methods to
model the serial correlation of a temporal sequence. Most of
these methods assume that the observed values are measured
regularly in time. However, there are many cases where this
assumption is not valid. When this happens, we say that the time
series is sampled irregularly.
An irregular time series is defined as a real valued sequence
{yti }ni=1 measured at observational times t1 , . . . , tn , such that
the sequence t1 , . . . , tN is strictly increasing and the distance
between consecutive times t j ‚àí t j‚àí1 is not constant.
Irregular time series can be observed in many disciplines.
For example, natural disasters such as earthquakes do not occur
regularly in time. Paleoclimate data are often sampled irregularly
due to the difficulty in obtaining historical information. In astronomy, objects can be observed irregularly in time because of,
for example, the dependency of optical telescopes on clear skies.
Analyzing irregular time series is challenging because there
are still few robust statistical tools available. In astronomy,
some efforts have been made that attempt to model irregular
time series. One approach is to transform the irregular times
into regular ones by interpolation (Rehfeld et al. (2011)). Other

approaches implement Gaussian processes to fit the light curves
in the time domain (Foreman-Mackey et al. (2017)), but this solution can be computationally expensive. In some cases, regular
time-series models have also been used to model astronomical
data (for a review of such methods see e.g., Feigelson et al.
(2018)). Alternatively, the CARMA family of models has been
popular for fitting astronomical time series (Kelly et al. (2014)),
however these models are defined as the solution of a differential
stochastic equation, underlying the assumption of small time
gaps between observations. Therefore, we consider it important
to develop alternative models that can fit irregularly spaced time
series under the assumption of discrete time gaps.
In Eyheramendy et al. (2018) we introduced a new model
called the Irregular Autoregressive (IAR) model to fit unequally
spaced time series. The IAR model is a discrete representation
of the continuous autoregressive model of order 1 (CAR(1)),
which is strictly stationary and ergodic. The IAR has some
extra flexibility when compared with the CAR(1). In the model
assumptions, the IAR can assume distributions other than
Gaussian1 .

1
We use the term Gaussian data to make reference to normally distributed time-series data.

Article number, page 1 of 12

A&A proofs: manuscript no. ciarVF

The IAR model has two parameters that need to be estimated
from the observed series. One parameter represents the variance
of the process and the other one the value of the autocorrelation
function (ACF). A limitation of the IAR model (and also of
the CAR(1) model) is that the ACF derived from the estimated
model parameters - via eq.(1) - is positive only. This is a
limitation that the regular autoregressive model does not have;
the latter can detect both positive and negative values of the ACF.

In this study, we apply the CIAR model to astronomical
data, but the model can be applied in any other field in which
irregular time series are available. In astronomy, the analysis of
the temporal behavior of variable stars, transients, or supernovae
attracts significant interest because several properties of the
objects can be obtained from the analysis of their light curves
(e.g., Richards et al. 2011; Kelly et al. 2014; Elorrieta et al.
2016).

Negative values of the ACF appear often in some disciplines. For instance, they have been detected in some physical
phenomena, such as the velocity for hard spheres (e.g., Williams
et al. 2006; Alder & Wainwright 1970). In financial time series,
it is common to find significant negative autocorrelation for
weekly and monthly stock returns (further discussion can be
found in Sewell (2011)). Negative values of the ACF are also
generally observed in stocks with a high trading frequency (e.g.,
Conrad et al. 1994; Campbell et al. 1997).

In particular, in the analysis of variable stars the temporal
modeling of the light curves is an important step to classify
them. From a harmonic model fitted to the light curves of
periodic variable stars, several features are extracted which
describe the physical behavior of a specific class of variable
stars. We implement the CIAR model on the residuals of the
harmonic model fitted on variable stars from OGLE (Udalski
et al. 1999) and Hipparcos (Perryman et al. 1997). Under this
scenario, our aim is to assess whether the harmonic model
is capable of describing the temporal structure of the light
curves of variable stars or some autocorrelation remains on the
residuals.

Well-known examples of time series with negative values
for the ACF are the antipersistent processes, which are characterized as having negative values of the ACF for all positive lags
(Bondon & Palma (2007)). One of the best known anti-persistent
processes is the Kolmogorov energy spectrum of turbulence
(Gao et al. (2007)). There are several examples of antipersistent
processes in meteorology. For instance, Ausloos & Ivanova
(2001) detect antipersistence in the fluctuations of the Southern
Oscillation Index, such as the sea level pressure. Carvalho et al.
(2007) also detected antipersistence in temperature anomalies.
Other examples are in financial data; for example, the electricity
prices in some Canadian provinces show an antipersistent
behavior (e.g., Uritskaya & Uritsky 2015).
The problem of detecting negative values of the ACF in
irregularly sampled time series has scarcely been addressed in
the literature. Chan & Tong (1987) showed that a discrete-time
regular autoregressive model of order 1 (AR(1)) with negative
coefficient can always be embedded in a suitably chosen
continuous-time ARMA(2,1) process, but this is not necessarily
a parsimonious solution. Alternatively, when an irregular time
series has an antipersistent behavior it can be fitted by the
continuous-time ARFIMA (CARFIMA) process (Tsai (2009))
with an intermediate memory,that is, the Hurst parameter H
is such that 0 < H < 1/2. In this work we propose another
alternative that corresponds to an extension of the IAR model.
We call this model the Complex Irregular Autoregressive
(CIAR) model because it needs complex numbers to represent
the series.
Complex stochastic processes have been addressed by
several authors, such as Miller (1974) and Picinbono & Bondon
(1997). These processes are often used in signal-processing
analyses since for example in telecommunication systems it is
common to find complex signals. In addition, Dubois & Glanz
(1986) and Sekita et al. (1991) introduced a complex extension
of a regular autoregressive model, where they proposed to
use the coefficients of these models for shape recognition.
Furthermore, Martin (1999) proposed a method to estimate
the parameters of the CAR(1) model in a complex time series.
However, in these studies it is assumed that both the real
and the imaginary part of the complex process are observed.
The model proposed here assumes that only the real part of
the process is observed and the imaginary part is a latent process.

The structure of this paper is as follows. In Sect. 2 we
present the irregular discrete time series models: the IAR model
proposed by Eyheramendy et al. (2018) and the CIAR model.
In both cases the maximum likelihood estimation procedure
is described. In the case of the CIAR model, we also provide
expressions for forecasting unobserved measurements. In Sect.
3 we assess the variance and bias of the estimated parameters of
the CIAR model using Monte Carlo simulations. Furthermore,
we perform simulations in order to compare the performance
in fitting negative values of the ACF of well-known time series
models and the CIAR model. In Sect. 4 we apply the CIAR
model to light curves of variable stars from the OGLE and
Hipparcos surveys. We also implement the CIAR model on an
AGN to demonstrate the forecasting procedure. We compare
the results obtained with the IAR model and illustrate some
applications for these data. The article ends with a discussion
and proposals for future work in Sect. 5.

2. Methods
2.1. Irregular Autoregressive (IAR) model

Letting {yt j } be a time series observed at irregular times, where
{t j } is an increasing sequence of observational times for j =
1, . . . , n, the irregular autoregressive (IAR) process is defined as
yt j = œÜt j ‚àít j‚àí1 yt j‚àí1 + œÉy

(1)

where œÜ is the parameter of the ACF and Œµt j is a white noise
sequence2 with zero mean and unit variance. We note that
E(yt j ) = 0 and V(yt j ) = œÉ2y ‚àÄt j .

The autocovariance function between two observational
times, s and t, with s < t, is given by Œ≥(t‚àís) = E(yt y s ) = œÉ2y œÜt‚àís ,
t‚àís
and the ACF, œÅ(t ‚àí s) = Œ≥(t‚àís)
Œ≥(0) = œÜ . Therefore, if 0 < œÜ < 1
2

Article number, page 2 of 12

q
1 ‚àí œÜ2(t j ‚àít j‚àí1 ) Œµt j ,

A white noise is an uncorrelated weakly stationary process.

Elorrieta et al.: A discrete-time autoregressive model

the sequence {yt j } corresponds to a second-order or weakly
stationary process, that is, the time series has constant mean and
finite second moment, and possesses an autocovariance function.
Furthermore, under some regularity conditions, the process
{yt j } is strictly stationary and ergodic (Eyheramendy et al.
(2018)).
We note that the IAR process is an extension of the regular
autoregressive process. If t j ‚àí t j‚àí1 = 1 is assumed, the IAR process becomes the autoregressive model of order 1 (AR(1)). Also,
the IAR process is equivalent to the continuous autoregressive
process of order 1 (CAR(1)) when a Gaussian distribution is
assumed on the white noise sequence Œµt j . However, the IAR
process is more flexible since it allows also nonGaussian data
(Eyheramendy et al. (2018)).
The finite past predictor of the process at time t j is given by,

b
yt j = œÜt j ‚àít j‚àí1 yt j‚àí1 , for j = 2, . . . , n,

(2)

where the initial value is b
yt1 = 0. Consequently, et1 = yt1 and
ŒΩt1 = Var(et1 ) = œÉ2y . Furthermore, et j = yt j ‚àíb
yt j is the innovation
2
2(t j ‚àít j‚àí1 )
with variance ŒΩt j = Var(et j ) = œÉy [1 ‚àí œÜ
].
The estimation of the model parameters Œ∏ = (œÉ2y , œÜ) can be
performed by maximum likelihood. Minus the log-likelihood of
the process when a Gaussian distribution is assumed on Œµt j is
given by
n

`(Œ∏) =

n

2

1 X et j
1X
n
log ŒΩt j +
log(2œÄ) +
.
2
2 j=1
2 j=1 ŒΩt j

(3)

For other distributional assumptions it can be written similarly.
We can obtain the maximum likelihood estimator of œÉ2y by directly maximizing the log-likelihood (3),
œÉÃÇy 2 =

n
yt j )2
1 X (yt j ‚àí b
, where œÑt j = ŒΩt j /œÉ2y ,
n j=1
œÑt j

(4)

but it is not possible to find a closed form expression for the
maximum likelihood estimator of œÜ. However, iterative methods
can be used.
A drawback of this model is that œÜ can only take values in the
interval [0, 1], since a negative œÜ to the power of a real (and not
integer) number is a complex number. Therefore, the IAR model
only allows us to estimate positive values of the autocorrelation.
To detect negative values of the ACF, the IAR model must be
extended. In the following section we introduce the CIAR which
allows for negative as well as positive autocorrelation to be modeled.
2.2. Complex Irregular Autoregressive (CIAR) model

To derive a complex extension of model (1), we follow the approach of Sekita et al. (1991), which builds a complex autoregressive model for regular times. Supposing that xt j is a complex
valued sequence, such that, xt j = yt j + izt j ‚àÄ j = 1, . . . , n, and
likewise, œÜ = œÜR + iœÜI is the complex coefficient of the model

and Œµt j = ŒµRtj + iŒµtIj is a complex white noise, we define the CIAR
process as,
yt j + izt j = (œÜR + iœÜI )t j ‚àít j‚àí1 (yt j‚àí1 + izt j‚àí1 ) + œÉt j (ŒµRtj + iŒµtIj ),
(5)
q
where œÉt j = œÉ 1 ‚àí |œÜt j ‚àít j‚àí1 |2 and |.| is the modulus of a complex
number. We assume that only the real part yt j is observed and
that the imaginary part zt j is a latent process. In addition,
ŒµRtj and ŒµtIj , the real and imaginary part of Œµt j , respectively,
are assumed to be independent with zero mean and positive
variance V(ŒµRt ) = 1 and V(ŒµtI ) = c, respectively, where c is a
fixed parameter that takes values in R+ . Generally, we assume
c = 1, and the initial values are yt1 = œÉŒµRt1 and zt1 = œÉŒµtI1 . In the
following lemma we state some of the properties of this process.
Lemma 1: Consider the CIAR process xt j described by Eq.
(5). Define Œ≥0 = E(xt j xt j ), Œ≥k = E(xt j+k xt j ), and œÅk as the variance,
autocovariance, and autocorrelation, respectively, of the process
xt j . Subsequently, the expected value, the variance, the autocovariance, and autocorrelation of the process respectively satisfy
a) E(xt j ) = 0,
b) V(xt j ) = Œ≥0 = E(xt j xt j ) = œÉ2 (1 + c),
c) Œ≥k = E(xt j+k xt j ) = œÜ‚àÜk œÉ2 (1 + c),
d) œÅk = œÜ‚àÜk ,
where ‚àÜk = t j+k ‚àí t j denotes the time differences between the
observational times t j+k and t j . In addition, xt j is the complex
conjugate of xt j . See Appendix A for a proof of this lemma.
If |œÜ| = |œÜR + iœÜI | < 1, the results on Lemma 1 above show
that the complex sequence xt j is a weakly stationary process.
We note that the ACF œÅk of the CIAR process decays at a rate
œÜt j+k ‚àít j (the so-called exponential decay). This autocorrelation
structure is different to an antipersistent or intermediate memory
CARFIMA process, since the ACF of the latter decays more
slowly than an exponential decay. Thus, although both models
can fit irregular time series with negative values of the ACF, the
appropriate use of these models will depend on the correlation
structure of the data. To make a decision about the most suitable
model for the data, techniques based on the likelihood of the
data, such as AIC, BIC, and so on, can be used.
In what follows, we express the CIAR model in terms
of a state-space system. This representation allows us: i) to
implement the Kalman filter to obtain maximum likelihood
estimators of the parameters of the model; and ii) to forecast
unobserved measurements.

2.3. State-space system

A linear state-space system may be described by the following
equations.
Xt = Ft Xt‚àí1 + Vt ,

(6)

Yt = GXt + Wt ,

(7)
Article number, page 3 of 12

A&A proofs: manuscript no. ciarVF

where (6) is known as the state equation which determines
a v‚àídimensional state variable Xt . Equation (7) is called the
observation equation, which expresses the w‚àídimensional observation Yt . In addition, Ft is a sequence of v √ó v matrices called
the transition matrices, and G ‚àà Rw√óv is the observation linear
operator of the observation matrix. Finally, Wt ‚àº WN(0, Rt ),
Vt ‚àº WN(0, Qt ) and Vt is uncorrelated with Wt .
In order to represent the CIAR model in a state-space system
we need to rewrite equation (5). In the following lemma an
alternative way of writing the CIAR model is proposed.
Lemma 2: The CIAR process described by Eq. (5) can be
expressed by the following equation.
yt j + izt j =

(Œ±Rtj

+

iŒ±tIj ) (yt j‚àí1

+ izt j‚àí1 ) +

œÉt j (ŒµRtj

+

yt j =



1

yt j
zt j

!
.

(12)

We note that in this representation, the transition matrixand
the variance of noise term of the state equation Qt j = |œÉt j |2 V Œµt j
depend on time.
Lemma 3: Now we let Œ±t j = Œ±Rtj + iŒ±tIj . If sup |Œ±t j | < 1, the
process in Eqs. (11)-(12) is stable and has a unique stationary
solution given by
Xt j = Vt j +

iŒµtIj ),

0



P‚àû
k=1

Vt j‚àík

Qk‚àí1
i=0

(13)

Ft j‚àíi

(8)

where
Œ±Rtj = |œÜ|Œ¥ j cos(Œ¥ j œà), Œ±tIj = |œÜ|Œ¥ j sin(Œ¥ j œà), Œ¥ j = t j ‚àí t j‚àí1 ,
 R
œà = arccos œÜ|œÜ| and œÜ = œÜR + iœÜI . See Appendix B for a proof
of this lemma.

where Vt j‚àík = œÉt j‚àík

!
ŒµRtj‚àík
. Appendix C presents a proof of this
ŒµtIj‚àík

lemma.

2.4. Estimation

By following the representation of the CIAR model described in Lemma 2, we can express the observed process as
yt j = Œ±Rtj yt j‚àí1 ‚àí Œ±tIj zt j‚àí1 + œÉt j ŒµRtj ,

(9)

and the latent process as
zt j = Œ±tIj yt j‚àí1 + Œ±Rtj zt j‚àí1 + œÉt j ŒµtIj .

Another important consideration is that the observed process
yt j does not depend directly on ŒµtIj . Consequently, the variance
of the imaginary part c is a nuisance parameter, in the sense that
it takes any value in R+ and does not cause significant changes
in the model.
Equation (8) can be represented by the state-space
system
!
yt j
of Eq. (6) - (7) assuming t = t j and Xt j =
. Given that
zt j
only yt j are actually observed, we obtain Yt = yt j . Therefore,


G = 1 0 is the observation matrix under this representation.
To complete the specification
we define the transition matrix
!
Œ±Rtj ‚àíŒ±tIj
as Ft j =
and the noise of equations (6) and (7) as
Œ±tIj Œ±Rtj
!
ŒµRtj
Vt j = œÉt j
and Wt j = 0, respectively. Finally, the observaŒµtIj
tion and state equations of the state-space representation of the
CIAR model are,
!
=

Œ±Rtj
Œ±tIj

‚àíŒ±tIj
Œ±Rtj

!

Article number, page 4 of 12

yt j‚àí1
zt j‚àí1

‚Ñ¶t1 = œÉ

(10)

We note that the observed process yt j is an IAR with
parameter œÜ, if we assume Œ±tIj = 0 and Œ±Rtj = œÜt j ‚àít j‚àí1 . In addition,
it is straightforward to show that Œ±tIj = 0 is equivalent to œÜI = 0.

yt j
zt j

For the state-space model of Eq. (6) - (7), the one-step predictors XÃÇt j = Pt j‚àí1 (Xt j ) and their error covariance matrices ‚Ñ¶t j =
E[(Xt j ‚àí XÃÇt j )(Xt j ‚àí XÃÇt j )0 ] are unique and determined by the initial
!
0
values: XÃÇt1 =
and ‚Ñ¶t1 = E[(Xt1 ‚àí XÃÇt1 )(Xt1 ‚àí XÃÇt1 )0 ]. Using
0
the properties of model (5) we can rewrite ‚Ñ¶t1 as,

!
+ œÉt j

ŒµRtj
ŒµtIj

!
,

(11)

2

1
0

0
c

!
.

The Kalman recursions, for j = 1, . . . , n ‚àí 1 are defined as
follows.
Œõt j = Gt j ‚Ñ¶t j G0t j ,
Œòt j = Ft j ‚Ñ¶t j G0t j ,
0
‚Ñ¶t j+1 = Ft j ‚Ñ¶t j Ft0j + Qt j ‚àí Œòt j Œõ‚àí1
t j Œòt j ,

ŒΩt j = yt j ‚àí Gt j XÃÇt j ,
XÃÇt j+1 = Ft j XÃÇt j + Œòt j Œõ‚àí1
t j ŒΩt j ,

(14)

where {ŒΩt j } is called the innovation sequence.
The maximum likelihood estimators of the CIAR model parameters œÜR and œÜI can be obtained by minimizing the reduced likelihood defined as,
`(œÜ) ‚àù

Ô£´
Ô£∂
n
ŒΩt2j Ô£∑Ô£∑Ô£∑
1 X Ô£¨Ô£¨Ô£¨Ô£¨
Ô£∑Ô£∑ ,
log(Œõ
)
+
Ô£¨
tj
n j=1 Ô£≠
Œõt j Ô£∏

where Œõt j and ŒΩt j come from the Kalman recursion. We developed scripts in the statistical language/software R and in Python
to perform the estimation of the parameters of the model using
Kalman recursions.
Another feature of this model is that it allows forecasting,
the process of which is explained below.

Elorrieta et al.: A discrete-time autoregressive model

2.5. Forecasting

Using the space-state equations (11) - (12) it is straightforward to
define a forecasting expression for the CIAR model. We note that
from the Kalman filter recursions (14) we obtain the estimates
of the state XÃÇt j , Œõt j , Œòt j and ŒΩt j at the last time point tn . A onestep forecasting for the CIAR model can be obtained from the
following equations.
XÃÇtn+1 = Ftn+1 XÃÇtn + Œòtn Œõt‚àí1
ŒΩt n
n
YÃÇtn+1 = Gtn+1 XÃÇtn+1
where Ftn+1 = |œÜ|Œ¥

,
cos(Œ¥œà) ‚àí sin(Œ¥œà)
sin(Œ¥œà) cos(Œ¥œà)

(15)
!
and Œ¥ = tn+1 ‚àí tn .

In addition, a confidence interval for the forecast YÃÇtn+1 can be
defined by,
p
YÃÇtn+1 ¬± z1‚àíŒ±/2 V(etn+1 ),

(16)

where etn+1 = Ytn+1 ‚àí YÃÇtn+1 is the forecast error with variance
2
V(etn+1 ) = œÉ2 (1 ‚àí œÜt j ‚àít j‚àí1 ) and z1‚àíŒ±/2 is the 1 ‚àí Œ±/2 quantile of
the standard normal distribution.

3. Simulation results
3.1. Assessing the estimation performance of the CIAR
model

In this section, we assess the performance of the estimation procedure proposed for the CIAR model. We perform Monte Carlo
experiments based on 1000 repetitions of each simulation. In
each repetition we generate a CIAR sequence from the model
(5) using coefficients with different positive and negative values
for the real part œÜR . In addition, both the imaginary part of the coefficient and the imaginary variance are set to œÜI = 0 and c = 1,
and the real and imaginary errors are assumed to follow a Gaussian distribution with a mean equal to zero and a variance of one.
The irregular times are generated using the following mixture of
two exponential distributions,
f (t|Œª1 , Œª2 , œâ1 , œâ2 ) = œâ1 g(t|Œª1 ) + œâ2 g(t|Œª2 ).

shows that the IAR model cannot detect negative values of the
ACF, unlike the CIAR model. Finally, we note that the accuracy
of the estimated values does not depend on the magnitude of the
coefficient.
Another method commonly used for estimating autocorrelation in irregular time series is the discrete correlation
function (DCF;(Edelson & Krolik 1988)). This method is based
on computing a Pearson correlation coefficient between data
pairs. Each data pair is composed by observations with a time
difference in the interval (œÑ ‚àí Œ¥/2, œÑ + Œ¥/2) where œÑ is the order
of the autocorrelation and Œ¥ is the bin window size. In order
to assess whether this method can detect the autocorrelation of
the CIAR process, we implement the DCF using the package
sour of R (Edelson et al. 2017). The last two columns in Table
1 correspond to the mean of the DCF estimates of order œÑ = 1
and its standard deviation, respectively. We note that the DCF
estimates are close to the œÜR parameter when it is positive, but
with a large standard deviation. On the other hand, when œÜR is
negative, the DCF estimates are not accurate.

(17)

We choose Œª1 = 15 and Œª2 = 2 as the means of each
exponential distribution, respectively, and œâ1 = 0.15 and
œâ1 = 0.85 as their respective weights. Under these parameters,
the mean of the time differences in the simulated data is
‚âà 3.95. The rationale for choosing this distribution came from
mimicking time gaps observed in surveys such as the VVV
(https://vvvsurvey.org/) where some observations are
very close to each other followed by observations that are more
separated from each other.
Table 1 shows the results of the Monte Carlo simulations,
which suggest that the finite-sample performance of the proposed methodology is accurate, both for positive and negative
values of the parameter œÜR . In addition, we also estimate the parameter œÜ of the IAR model in each simulation. A precise IAR
coefficient estimate is obtained when œÜR is positive, but when the
CIAR process is generated with negative œÜR the estimation of the
IAR coefficient is close to zero. This result is important since it

3.2. Comparison of the CIAR with other time series models

We perform a simulation experiment to compare the performance of well-known time series models, that is, IAR, AR(1),
ARFIMA and CAR(1), in fitting a CIAR process. This experiment consists in generating 1000 sequences of the CIAR process
{y1 , . . . , yn } with length n = 300. In order to generate positive
and negative values of the ACF, œÜR = 0.99 and œÜR = ‚àí0.99 are
used. The remaining parameters are set as œÜI = 0, c = 1 and the
irregular times are generated with a mixture of two exponential
distributions. We then fit each sequence using the different
time-series models, and the CIAR model. The AR(1), ARFIMA,
and CAR(1) models were estimated by maximum likelihood
using the functions arima, arfima, and cts, respectively,
from the statistical software R. To compare its performance
we compute the root mean squared error (RMSE). Figure 1 a)
shows that the RMSE estimated by the irregular time-series
models is smaller in comparison with that of either the AR or
ARFIMA model which assume regular sampling. However, as
can be seen in Figure 1b the CIAR model shows significantly
better performance in fitting the negatively correlated processes
than the other implemented models. Therefore, we verify that
a CIAR process with a large and negative value of œÜR cannot
be correctly modeled with the conventional time-series models,
including those that assume irregular sampling.

3.3. Computation of the autocorrelation in a harmonic model

An important advantage of the CIAR process over other timeseries models for unequally spaced observation is its ability
to model weakly stationary time series with negative as well
as positive values of the ACF. A well-known example of a
time series that can be negatively correlated is the following
harmonic process,

yti = A sin( f ti + œà) + ti ,

(18)

where f is the frequency of the process and ti is a Gaussian
sequence with a mean of zero and a variance of œÉ2 . In addition,
Article number, page 5 of 12

A&A proofs: manuscript no. ciarVF
Table 1. Maximum likelihood estimation of complex œÜ computed by the CIAR model in the real part of the simulated CIAR data. The observational
times are generated using a mixture of exponential distribution with Œª1 = 15 and Œª2 = 2, œâ1 = 0.15 and œâ2 = 0.85.

Case
1
2
3
4
5
6
7
8

œÜR
0.999
0.9
0.7
0.5
-0.999
-0.9
-0.7
-0.5

N
300
300
300
300
300
300
300
300

b
œÜR
0.9949
0.8960
0.6967
0.4942
-0.9984
-0.8991
-0.6991
-0.4971

SD(b
œÜR )
0.0036
0.0187
0.0412
0.0596
0.0012
0.0154
0.0414
0.0717

œÜI
0
0
0
0
0
0
0
0

b
œÜI
0.0009
0.0116
0.0557
0.0849
0.0001
0.0014
0.0061
0.0091

SD(b
œÜI )
0.0030
0.0413
0.0819
0.1111
0.0009
0.0134
0.0354
0.0607

b
œÜIAR
0.9949
0.8950
0.6948
0.4965
0.0626
0.0643
0.0628
0.0589

(a)

0.7

SD(b
œÜIAR )
0.0036
0.0188
0.0406
0.0569
0.0265
0.0299
0.0289
0.0283

DCF
0.9743
0.8809
0.6909
0.5004
-0.6260
-0.5644
-0.4382
-0.3152

SD(DCF)
0.1273
0.1315
0.1279
0.1240
0.1038
0.1166
0.1114
0.1089

(b)

‚óè

‚óè

‚óè

‚óè

‚óè
‚óè

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè

1.2

‚óè
‚óè

‚óè
‚óè

‚óè
‚óè
‚óè
‚óè
‚óè

‚óè
‚óè
‚óè
‚óè
‚óè

‚óè

‚óè
‚óè

AR

ARFIMA

‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè

‚óè

0.6
‚óè

‚óè

‚óè
‚óè
‚óè
‚óè
‚óè

‚óè

‚óè

‚óè
‚óè
‚óè
‚óè

1.0
‚óè
‚óè
‚óè
‚óè

0.5

0.8

‚óè

0.6
0.4

‚óè
‚óè
‚óè

‚óè

CIAR

IAR

AR

‚óè
‚óè

ARFIMA

‚óè

‚óè

CAR

CIAR

IAR

CAR

Fig. 1. Boxplot of the root mean squared error computed for the fitted models on the 1000 sequences simulated of the real part of the CIAR
process. In a) each CIAR process was generated using œÜR = 0.99. In b) each CIAR process was generated using œÜR = ‚àí0.99. The other parameters
of the models are defined as œÜI = 0, c = 0 and length n = 300. The observational times are generated using a mixture of Exponential distribution
with Œª1 = 15 and Œª2 = 2, œâ1 = 0.15 and œâ2 = 0.85 .

the amplitude A is a fixed parameter and the phase œà is a random
variable with uniform distribution between ‚àíœÄ and œÄ. We note
that the weakly stationarity of the process yti is guaranteed when
this distribution for œà is assumed (for more details, see e.g.,
Lindgren et al. (2013)). Assuming regular observational times,
the one-step autocorrelation is given by œÅ1 = cos( f ) (Broersen
(2006)). This result is also satisfied under irregular times. We
note that this autocorrelation is negative for f ‚àà (œÄ/2, œÄ). In
addition, we note that for higher-frequency values the harmonic
process (18) becomes more anti-persistent (Alperovich et al.
(2017)).

frequency values to the theoretical autocorrelation cos( f ) is depicted as a red line. We note that the œÜR parameter estimated by
the CIAR model fits the theoretical values almost perfectly.

We performed a simulation study in order to assess whether
the CIAR model can detect the correlation structure of an irregular harmonic model. We generated the irregular observational
times ti with i = 1, . . . , n using the mixture of exponentials distributions (Eq. (17)). The process yti is simulated with length
n = 300, amplitude A = 20, and a unit variance for ti . Simulations using (18) are run with k = 200 different frequencies taken
equally spaced from the interval (0, œÄ). We fit a CIAR model to
each simulated sequence. In Figure 2 the parameters estimated
(y-axis) from the CIAR model for each of the 200 frequencies
(x-axis) are shown as the black line, and the mapping of the

In this section we show some results of the implementation
of the CIAR model in astronomical time series. Astronomical
data are naturally irregularly sampled since it is not always
possible to get observational data from optical telescopes due to
a dependency on clear skies. Many astronomical objects, such as
variable stars, transients, and supernovae, can be characterized
by their brightness. Generally, this brightness is represented by
a time series (light curve) of this object. We apply the CIAR
model to the residuals of a harmonic model fitted to the light
curves of variable stars.

Article number, page 6 of 12

4. Application of the CIAR model to astronomical
data

Elorrieta et al.: A discrete-time autoregressive model

1.0

1.0

Comparison IAR vs CIAR

‚óè‚óè‚óè
‚óè ‚óè‚óè‚óè‚óè

0.5

0.5

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚àí0.5

0.0

0.0

CIAR

‚óè

‚àí0.5

Estimated Autocorrelation Parameter

‚óè

‚óè
‚óè
‚óè‚óè
‚óè‚óè‚óè
‚óè ‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè ‚óè‚óè
‚óè‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè ‚óè
‚óè
‚óè‚óè‚óè ‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè‚óè‚óè‚óè
‚óè ‚óè‚óè‚óè
‚óè
‚óè ‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè ‚óè
‚óè
‚óè
‚óè
‚óè ‚óè‚óè ‚óè
‚óè ‚óè
‚óè‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè‚óè
‚óè‚óè ‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè ‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè ‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè ‚óè‚óè ‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè
‚óè ‚óè
‚óè
‚óè
‚óè
‚óè
‚óè‚óè

‚óè
‚óè‚óè
‚óè ‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè‚óè‚óè

‚óè

‚óè
‚óè‚óè

‚óè
‚óè ‚óè‚óè‚óè
‚óè
‚óè
‚óè‚óè

‚óè
‚óè
‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè‚óè

‚óè‚óè
‚óè‚óè
‚óè‚óè
‚óè
‚óè‚óè‚óè
‚óè‚óè‚óè
‚óè
‚óè ‚óè
‚óè‚óè

‚óè
‚óè‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè‚óè ‚óè
‚óè
‚óè‚óè‚óè

‚óè

‚óè ‚óè
‚óè‚óè

‚óè

‚óè
‚óè‚óè‚óè
‚óè

‚óè

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚óè

‚óè

‚óè

‚àí1.0

‚óè
‚óè

‚óè

0

œÄ 4

œÄ 2

3œÄ 4

0.0

œÄ

Frequency

0.2

0.4

0.6

0.8

IAR

Fig. 2. Estimated coefficients œÜR (y-axis) by the CIAR model in k = 200
harmonic processes generated using frequencies (x-axis) in the interval
(0, œÄ). The black line corresponds to the coefficients estimated by the
CIAR model. The red line is the theoretical autocorrelation of the process yti

Fig. 3. Plot of œÜR vs. œÜIAR , the parameter coefficients estimated by the
CIAR and IAR models, respectively, from light curves in OGLE and
HIPPARCOS.

4.1. Modeling light curves

However, we observe that several cases identified as uncorrelated by the IAR model, that is, œÜIAR ‚âà 0, have a high but
negative autocorrelation estimated by the CIAR model. In other
words, these light curves remain with negative dependency
structure on the residuals after fitting the harmonic model.
Double-mode cepheids (DMCEP) and eclipsing binaries (EB)
make up the majority of these variable stars.

One of the most important challenges in the analysis of variable
stars is to classify them based on their temporal behavior. The
pulsating variables represent a particular class of variable stars
that are characterized by having a periodical behavior. Therefore,
the light curves of pulsating variable stars are generally fitted
by a harmonic model (see e.g.(Debosscher et al. 2007; Richards
et al. 2011; Elorrieta et al. 2016, e.g.)).The p-harmonic model is
defined as
y(t) = Œ≤0 +

p
X

(Œ±1 j sin(2œÄ f1 jt) + Œ≤1 j cos(2œÄ f1 jt)) + (t),

(19)

j=1

where f1 corresponds to the dominant frequency estimated by
the generalized Lomb-Scargle periodogram (GLS; Zechmeister
& K√ºrster (2009)). Following Debosscher et al. (2007),for
example, p = 4 is assumed to fit the light curves. The main goal
of implementing the irregular time series models in light curves
from periodic variable stars is to detect whether the harmonic
model is sufficient to capture all the temporal dependency in
the light curve. Otherwise, the residuals of the harmonic model
remain with autocorrelation.
We apply the CIAR model to the residuals of the harmonic
model fitted on light curves of variable stars from the optical
surveys OGLE and Hipparcos. We use these data since many
classes of variable stars are available in the catalogue of these
surveys.
In order to fit both models on these data, each light curve of
the OGLE and Hipparcos surveys was fitted by a four-harmonic
model (equation (19)). The residuals of each harmonic model
are then fitted using both the IAR and CIAR models. In Figure
3, we note that there is a high correlation between the estimated
coefficients œÜÃÇIAR and œÜÀÜR of the IAR and CIAR models, respectively, on the light curves when both values are positive, which

is consistent with the results of the Monte Carlo simulations.

The time structure detected can be due to the fact that a light
curve was incorrectly fitted by the harmonic model, for example
when using an incorrect period. Also the CIAR model can detect
a correlation structure in the residuals of a harmonic model fitted
to the light curve of a multiperiodic variable star. Intuitively, if
the light curve has two or more periods, a harmonic model fitted
using only the dominant frequency is not sufficient to account
for all its temporal dependency structure.
It is also important to assess the goodness of fit performance
of the IAR and CIAR models on these data. We compute the
RMSE after fitting each irregular model on the residuals of the
harmonic model. These results do not vary significantly when
œÜR is positive. However, if this coefficient is negative, the RMSE
estimated by the CIAR model is smaller than the one obtained
when we fit these data using the IAR model, as can be seen in
Figure 4. This result is consistent with those obtained in Section
3.2.

4.2. Statistical test for the autocorrelation parameter

The magnitude of the coefficients estimated by the irregular time
series models depends on the period of the light curve. Light
curves with short periods have, in general, smaller estimated
coefficients. In other words, a small value of the estimated coefficient does not always imply uncorrelated residuals. If the light
curve has a large period, a small coefficient could mean uncorreArticle number, page 7 of 12

A&A proofs: manuscript no. ciarVF

CIAR
IAR

4.3. Classification features estimated from the irregular
time-series models

One of the most important aims in the light curve analysis from
variable stars is to find features that can discriminate one class
of variable star from another. Finding a good feature is the key
to building a classifier with good performance to detect stars of
a given class. Generally, these features are extracted from the
temporal behavior of the brightness of each variable star.

10

5

0
0.50

0.75

1.00

1.25

Fig. 4. Kernel Density of the RMSE computed for the residuals of harmonic fit in the light curves when the CIAR coefficient is negative. The
red density corresponds to the RMSE computed using the CIAR model,
and the blue density corresponds to the RMSE computed using the IAR
model.

lated residuals. However, if the variable star has a shorter period,
it could mean the opposite. Therefore, we cannot make decisions
based only on the value of the parameter estimated by the model.
To overcome this problem we designed a statistical test that
can assess when a value of œÜ is significantly different from
(larger than) the values that can arise by chance. To do that,
we estimated the distribution of the parameter b
œÜR for time series with autocorrelation. We then assessd how likely it is to observe a particular value of b
œÜR under this distribution. Following
the methodology proposed by Eyheramendy et al. (2018) we selected 38 different frequencies to fit each light curve incorrectly,
where each of them is a variation of the correct period in the interval ( f1 ‚àí0.5 f1 , f1 +0.5 f1 ). The factor f1 corresponds to the correct frequency of the light curve. To develop the test we assumed
that the log(|b
œÜR |) follows a Gaussian distribution, estimated usR
ing the 38 b
œÜi , i = 1, . . . , 38 obtained from the CIAR fit of the
time series that each assume a different incorrect frequency from
the interval. Consequently, the null hypothesis here is that the
log(|b
œÜR |) belongs to this Gaussian distribution. We note that the
test is formulated so that each estimated coefficient is compared
only with the estimated ones in the same light curve fitted incorrectly.
Using this test, there are some examples in which the IAR
model cannot distinguish if the model is correctly fitted or not,
but the CIAR model can always do this. Figure 5 shows an example of a RRc star observed by the HIPPARCOS survey. Figure (5)(a) shows the perfect fit of the harmonic model to the
light curve. Figures (5) (b) and (c) show that the CIAR and IAR
models, respectively, have an estimate of the parameter close to
zero on the residuals of the 39 fitted models. However, the CIAR
model gives a value of |b
œÜR | significantly smaller than the remaining ones when the light curve is correctly fitted, giving a p-value
close to zero (Figure (5) (b).

Article number, page 8 of 12

In this study, we propose to use the parameter estimated by
the CIAR model as a feature. For example, for a multiperiodic
variable star, it can then be expected that a harmonic model
fitted using only the dominant frequency will not be enough to
describe its temporal dependency structure. In other words, if we
fit the CIAR and IAR models to the residuals of the harmonic
model in (19) we should obtain values for the parameter of
the ACF that are significantly different from zero. Therefore,
it is natural to think that these coefficients are capable of
distinguishing multiperiodic variable stars from other classes.
In the OGLE and HIPPARCOS catalogs there are two classes
of multiperiodic variable stars: the double-mode RR Lyraes
(RRDs) and the double-mode Cepheids (DMCEPs).
We implement the IAR and the CIAR models on the
residuals after fitting a harmonic model with only one period
to the light curves of these classes. We found several examples
of negative autocorrelation in the residuals of the harmonic
model, which cannot be detected using the IAR model. One of
these examples is a bi-periodic double-mode Cepheid (OGLE
ID:175210) in which the IAR and the CIAR coefficients estimated on these residuals are œÜÀÜR = ‚àí0.561 and œÜÃÇIAR = 0.011.
Consequently, we focus on the CIAR model estimates.
The features that can be extracted from the CIAR model
are the parameter œÜR and the p-value associated to the test
performed on œÜR . It is interesting to assess whether these
features can separate the multiperiodic classes from the other
RR-Lyraes and Cepheids, respectively. Figures 6 (a) and (b)
show the distribution of the p-values computed by the CIAR
model. As can be seen from these figures there are significant
differences between the classes of RR-Lyraes and Cepheids in
the distributions of the computed p-values. We note that the
RRD and DMCEP classes take larger values in comparison to
the other classes.
The use of the p-value as a feature reflects the multiperiodic
behavior of the RRD and DMCEP classes.

4.4. Forecasting astronomical data

In this section, we illustrate the forecasting procedure implemented for the CIAR model. For this we use the light curve of
the AGN MCG-6-30-15 (Lira et al. (2015)) measured in the
K-band. The time series of this object has n = 237 observations
taken over a period of approximately 4.5 years.
Initially, we normalize the time series and use the first 90%
of the data to estimate the parameters of the CIAR model.
We forecast the next observation at the time t j+1 given the
observational times t1 , . . . , t j corresponding to the first 90% of
the data. Later, we include the observation at the moment t j+1

Elorrieta et al.: A discrete-time autoregressive model

(a)

(b)

‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè ‚óè‚óè
‚óè ‚óè
‚óè‚óè ‚óè
‚óè‚óè
‚óè‚óè
‚óè
‚óè
‚óè ‚óè

‚óè

‚óè

‚óè

‚óè ‚óè
‚óè

‚óè

‚óè

‚àí10

‚àí20

‚àí20

‚óè ‚óè
‚óè

‚óè

‚óè
‚óè
‚óè ‚óè

‚óè

‚óè

‚óè
‚óè
‚óè
‚óè ‚óè‚óè
‚óè ‚óè
‚óè

‚óè

‚óè

‚óè
‚óè
‚óè
‚óè ‚óè‚óè
‚óè ‚óè
‚óè

‚óè

‚óè

‚óè
‚óè
‚óè
‚óè‚óè
‚óè

‚óè

‚óè
‚óè
‚óè
‚óè‚óè
‚óè

‚óè

‚óè

‚óè‚óè‚óè‚óè
‚óè ‚óè
‚óè

‚óè‚óè

‚óè‚óè‚óè‚óè
‚óè ‚óè
‚óè

‚óè‚óè
‚óè
‚óè‚óè

‚óè
‚óè‚óè

‚óè‚óè

‚óè‚óè
‚óè
‚óè

‚óè
‚óè

‚óè‚óè
‚óè

0.0

0.5

‚óè ‚óè
‚óè ‚óè ‚óè
‚óè ‚óè ‚óè
‚óè
‚óè‚óè
‚óè ‚óè ‚óè

‚àí30
‚óè

‚óè
‚óè ‚óè‚óè
‚óè
‚óè

‚óè
‚óè‚óè
‚óè

‚óè

‚àí30

‚óè‚óè
‚óè‚óè
‚óè

‚óè

‚óè

‚óè
‚óè

‚óè‚óè

‚óè‚óè
‚óè‚óè
‚óè‚óè
‚óè

‚óè

0.2

‚àí10
‚óè

‚óè
‚óè
‚óè
‚óè ‚óè

‚óè

0.0

‚óè
‚óè

‚óè

(c)

log(œÜ)

‚àí0.2

‚óè
‚óè

log(|œÜR|)

‚óè

‚óè
‚óè‚óè
‚óè
‚óè‚óè
‚óè
‚óè ‚óè‚óè
‚óè ‚óè
‚óè‚óè ‚óè
‚óè‚óè
‚óè‚óè
‚óè
‚óè
‚óè ‚óè

‚óè‚óè

‚óè
‚óè‚óè
‚óè
‚óè‚óè

‚óè

1.0

1.5

‚óè

‚óè ‚óè
‚óè ‚óè ‚óè
‚óè ‚óè ‚óè
‚óè
‚óè‚óè
‚óè ‚óè ‚óè

2.0

0.5 f1

0.75 f1

f1

1.25 f1

1.5 f1

0.5 f1

0.75 f1

f1

1.25 f1

1.5 f1

Fig. 5. a) Light curve of a RRc star observed by the HIPPARCOS survey. The continuous blue line is the harmonic best fit. b) Natural logarithm
of the absolute value of the estimated parameter œÜÀÜR by the CIAR model on the residuals of the harmonic model fitted with different frequencies;
x-axis shows percentage variation from the correct frequency, y-axis shows the natural logarithm of œÜÃÇR . c) Natural logarithm of the estimated
parameter œÜÃÇIAR by the IAR model on the residuals of the harmonic model fitted with different frequencies; x-axis shows the percentual variations
from the correct frequency, y-axis shows the natural logarithm of œÜÃÇIAR .

(a)

(b)
1.00

1.00

‚óè
‚óè
‚óè
‚óè
‚óè

‚óè

‚óè
‚óè

0.75

0.75

‚óè

class

class

‚óè

RRAB
RRC
RRD

0.50

CLCEP
DMCEP
PTCEP

0.50
‚óè

‚óè

‚óè

‚óè

‚óè

‚óè

‚óè

‚óè
‚óè

0.25

0.25

‚óè
‚óè
‚óè
‚óè
‚óè
‚óè
‚óè

RRAB

RRC

‚óè
‚óè

PTCEP

‚óè

RRD

‚óè
‚óè

CLCEP

0.00

‚óè

0.00

‚óè
‚óè
‚óè
‚óè

DMCEP

‚óè

Fig. 6. a) Boxplot of the p-value estimated from the CIAR model in the RR-Lyraes variable stars separated by subclass. b) Boxplot of the p-value
estimated from the CIAR model in the Cepheids variable stars separated by subclass.

and re-estimate the model to forecast the observation at the
following time t j+2 . This procedure is repeated iteratively until
the remaining 10% of the data is forecasted, obtaining the vector
of one-step forecasted values (yÃÇ j+1 , . . . , yÃÇn ). Figure 7 (a) shows
the normalized MCG-6-30-15 light curve and the forecasted
values represented with red dots.
The parameters estimated for this light curve were
b
œÜR = 0.9859 and b
œÜI ‚âà 0 for the first 90% of the data and
R
b
œÜ = 0.9863 and b
œÜI ‚âà 0 for all the data. In addition, we
also compute the confidence interval at a 90% level for each
forecasted value, which is shown in Figure 7 (b). We note that
the interval size is larger for larger time gaps.

5. Discussion
In this work we present an extension of the irregular autoregressive (IAR) model (Eyheramendy et al. (2018)), that we
call the Complex Irregular Autoregressive (CIAR) model. As
opposed to the IAR model that can only estimate positive values
of the ACF, the CIAR model can estimate both positive and
negative values of the ACF. We have shown that this model is
weakly stationary and its state-space representation is stable
under regular assumptions. We propose a maximum likelihood
estimation procedure for the parameters of this model, where
the solution is reached using Kalman recursions. We developed
a code in R and Python to perform an estimation of the model.
There is a strong connection between the three models:
CAR(1), IAR, and CIAR. Assuming a null imaginary part and
Article number, page 9 of 12

A&A proofs: manuscript no. ciarVF

2

(b)

2

(a)

‚óè
‚óè
‚óè
‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚óè
‚óè
‚óè

1

‚óè
‚óè
‚óè

1

‚óè
‚óè

‚óè
‚óè
‚óè
‚óè
‚óè
‚óè

‚óè

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚óè
‚óè

‚óè‚óè
‚óè
‚óè‚óè
‚óè ‚óè
‚óè

‚óè
‚óè

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚óè

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚óè

‚óè
‚óè

‚óè

‚óè
‚óè
‚óè

‚àí1

‚óè
‚óè‚óè
‚óè
‚óè‚óè ‚óè
‚óè‚óè
‚óè‚óè
‚óè ‚óè

‚àí1

‚óè

‚óè

0

‚óè
‚óè
‚óè
‚óè

0

‚óè

‚óè

‚óè

‚óè
‚óè

‚óè
‚óè

‚óè

‚óè

‚óè

‚óè

‚óè

‚óè
‚óè

‚àí2

‚àí2

‚óè

4500

5000

5500

5660

5680

5700

5720

5740

5760

(b)

Fig. 7. a) Normalized K-band MCG-6-30-15 light curve. The red dots are the forecasted values. b) Zoom of the last 10% of the MCG-6-30-15
light curve. The red dots are the forecasted values using the CIAR model and the gray bars are the confidence intervals at the 90% level.

positive real part of the complex autocorrelation parameter,
the CIAR model becomes the IAR model. The connection
between both models is verified by Monte Carlo simulations in
Section 3.1. Also, when Gaussian data is fitted in the models,
the IAR and the CAR(1) are equivalent. Both the IAR and
the CIAR models fit the irregularity of the time gaps between
observations as discrete times as opposed to the CAR(1) model
which considers time as a continuous variable. At this stage,
only the IAR model can fit data that is not Gaussian; the CIAR
and the CAR models can only fit Gaussian data.
We illustrate the contribution of the CIAR model in two
applications. First, the CIAR process can fit irregular time series
with negative values of the ACF, the shape of which is an exponential decay. Second, the CIAR process can identify series with
negative values of the ACF such as a high frequency harmonic
model or an antipersistent process. In both applications, we
show with simulated data that the CIAR model performs better
than other popular time-series models.
A negative autocorrelated time series is characterized by
more fluctuations (Box et al. (2015)). Take for example ‚àÜt =
yt ‚àí yt‚àí1 and the variance Var(‚àÜt ) = 2œÉ2y (1 ‚àí œÜ). This variance is
larger for œÜ < 0 than for positive values of œÜ. Figure 8 illustrates
the behavior mentioned above from a CIAR process simulated
with œÜR = 0.99 and œÜR = ‚àí0.99. We note that there are more
oscillations in the CIAR process generated with negative autocorrelation.

The application of the proposed model is performed on astronomical data. Particularly, we use the light curves of variable
stars observed by the OGLE and HIPPARCOS surveys. As
many variable stars show periodical behavior in terms of their
brightness, it is common to fit the light curves by a harmonic
model. We have discussed that the irregular time series models
are useful to determine whether or not the residuals of the
harmonic fit are still autocorrelated. When a time dependency
Article number, page 10 of 12

structure remains on the residuals, we can conclude either that
the light curve was not correctly fitted or that it corresponds to
a multiperiodic variable star. Furthermore, we noticed that the
estimated coefficients are highly related to the frequency of the
light curves. In order to interpret the coefficient correctly, we
have developed a statistical test.
After fitting both models to the light curves, we can see a
strong relationship between the IAR and CIAR models when
the coefficient œÜR of the CIAR model is positive. However,
we have also found several cases of negative values of the
ACF of light curves that the IAR model is not capable of
identifying. In addition, we show examples where the inability
to estimate negative values of œÜ from the IAR model prevents us
from finding multiperiodic variable stars or correctly detecting
whether the harmonic model is incorrectly specified.
It is expected that negative values of the ACF will be less
frequent than positive values. This hypothesis is reflected in
the astronomical datasets analyzed. However, there are several
examples of negative values obtained from time series of light
curves from the OGLE and HIPPARCOS surveys. This result
shows how important it is to have a model that can identify
the negative as well as the positive time dependencies in
an irregular time series. Among the time-series models that
assume irregular sampling, only the CARFIMA process can fit
a negative autocorrelated time series if this has an antipersistent
behavior. The contribution of the model proposed here is that it
can model series with negative exponential decay in the ACF.
In other words, both processes can be negatively autocorrelated,
but still have different correlation structures.
In addition, we have shown that the p-values obtained from
the test proposed in this work for the CIAR model are useful for
characterizing the multiperiodic classes of RR-Lyraes (RRDs)
and Cepheids (DMCEPs). This result indicates that the p-value
can be an important feature for a machine-learned classifier
implemented on these classes. In a future study, a classifier

Elorrieta et al.: A discrete-time autoregressive model

(b)

-2

-2

-1

-1

0

0

1

1

2

2

3

(a)

0

2000

4000

6000

8000

0

2000

4000

6000

8000

Fig. 8. a) CIAR process with positive autocorrelation generated using parameters œÜR = 0.99, œÜI = 0, c = 0 and length n = 300 . b) CIAR process
with negative autocorrelation generated using parameters œÜR = ‚àí0.99, œÜI = 0, c = 0 and length n = 300.

for multiperiodic variable stars will be implemented using this
feature.
The main aim of this work is to continue developing models
for irregularly observed time series where time is considered
discrete as opposed to continuous. This will allow us to extend
the popular ARMA models for regular observations to the irregular case. We have shown that the CIAR model extends the IAR
model by allowing negative as well as positive autocorrelations
to be captured. We will continue working on expanding the
scope of irregularly observed time series.
Acknowledgements. Support for this research was provided by grant IC120009,
awarded to The Millennium Institute of Astrophysics, MAS, and from Fondecyt
grant 1160861. F.E. acknowledges support from CONICYT-PCHA (Doctorado
Nacional 2014- 21140566).

References
Alder, B. & Wainwright, T. 1970, Physical review A, 1, 18
Alperovich, Y., Alperovich, M., & Spiro, A. 2017, in 2017 Tenth International
Conference Management of Large-Scale System Development (MLSD), 1‚Äì4
Ausloos, M. & Ivanova, K. 2001, Phys. Rev. E, 63, 047201
Bondon, P. & Palma, W. 2007, Journal of Time Series Analysis, 28, 261
Box, G. E. P., Jenkins, G. M., Reinsel, G. C., & Ljung, G. M. 2015, Time Series
Analysis: Forecasting and Control (5th edition) (John Wiley & Sons, Inc.)
Brockwell, P. & Davis, R. 2002, Introduction to Time Series and Forecasting
(Springer-Verlag New York)
Broersen, P. M. T. 2006, Automatic Autocorrelation and Spectral Analysis (Secaucus, NJ, USA: Springer-Verlag New York, Inc.)
Campbell, J. Y., Lo, A. W.-C., & MacKinlay, A. C. 1997, The Econometrics of
Financial Markets (princeton University press), 632
Carvalho, L. M. V. d., Tsonis, A. A., Jones, C., Rocha, H. R. d., & Polito, P. S.
2007, Nonlinear Processes in Geophysics, 14, 723
Chan, K. S. & Tong, H. 1987, Journal of Time Series Analysis, 8, 277
Conrad, J. S., Hameed, A., & Niden, C. 1994, Journal of Finance, 49, 1305
Debosscher, J., Sarro, L. M., Aerts, C., et al. 2007, A&A, 475, 1159
Dubois, S. R. & Glanz, F. H. 1986, IEEE Trans Pattern Anal Mach Intell, 8, 55
Edelson, R., Gelbord, J., Cackett, E., et al. 2017, The Astrophysical Journal, 840,
41
Edelson, R. A. & Krolik, J. H. 1988, ApJ, 333, 646
Elorrieta, F., Eyheramendy, S., Jord√°n, A., et al. 2016, A&A, 595, A82
Eyheramendy, S., Elorrieta, F., & Palma, W. 2018, Monthly Notices of the Royal
Astronomical Society, 481, 4311
Feigelson, E. D., Babu, G. J., & Caceres, G. A. 2018, Frontiers in Physics, 6, 80

Foreman-Mackey, D., Agol, E., Ambikasaran, S., & Angus, R. 2017, The Astronomical Journal, 154, 220
Gao, J., Cao, Y., Tung, W.-w., & Hu, J. 2007, Multiscale Analysis of Complex
Time Series: Integration of Chaos and Random Fractal Theory, and Beyond
(Wiley-Interscience)
Kelly, B. C., Becker, A. C., Sobolewska, M., Siemiginowska, A., & Uttley, P.
2014, The Astrophysical Journal, 788, 33
Lindgren, G., Rootz√©n, H., & Sandsten, M. 2013, Stationary stochastic processes
for scientists and engineers (Chapman and Hall)
Lira, P., Ar√©valo, P., Uttley, P., McHardy, I. M. M., & Videla, L. 2015, Monthly
Notices of the Royal Astronomical Society, 454, 368
Martin, R. 1999, Signal Processing, 77, 139
Miller, K. 1974, Complex Stochastic Processes: an Introduction to Theory and
Application, Advanced book program (Addison-Wesley Publishing Company, Advanced Book Program)
Perryman, M. A. C., Lindegren, L., Kovalevsky, J., et al. 1997, A&A, 323, L49
Picinbono, B. & Bondon, P. 1997, IEEE Transactions on Signal Processing, 45,
411
Rehfeld, K., Marwan, N., Heitzig, J., & Kurths, J. 2011, Nonlinear Processes in
Geophysics, 18, 389
Richards, J. W., Starr, D. L., Butler, N. R., et al. 2011, ApJ, 733, 10
Sekita, I., Kurita, T., & Otsu, N. 1991, Complex autoregressive model and its
properties
Sewell, M. 2011, Characterization of Financial Time Series
Tsai, H. 2009, Bernoulli, 15, 178
Udalski, A., Soszynski, I., Szymanski, M., et al. 1999, Acta Astron., 49, 223
Uritskaya, O. Y. & Uritsky, V. M. 2015, Energy Economics, 49, 72
Williams, S. R., Bryant, G., Snook, I. K., & van Megen, W. 2006, Physical review
letters, 96, 087801
Zechmeister, M. & K√ºrster, M. 2009, A&A, 496, 577

Article number, page 11 of 12

A&A proofs: manuscript no. ciarVF

Appendix A: Proof of Lemma 1
Consider the CIAR process xt j described by Eq. (5). We note
that E(yt j ) = 0 and E(zt j ) = 0. Therefore, xt j = yt j + izt j is such
that E(xt j ) = 0. According to the definition of the model, we have

xt j xt j



œÜŒ¥ j xt j‚àí1 + œÉt j Œµt j œÜŒ¥ j xt j‚àí1 + œÉt j Œµt j

=



=

œÜŒ¥ j

2

2

xt j‚àí1 + . . . + œÉt j

2

Applying expectation E and using the properties of the model

=

2

=

|œÜ|Œ¥ j cos(Œ¥ j œà) + i|œÜ|Œ¥ j sin(Œ¥ j œà)

=

Œ±Rtj + iŒ±tIj .

Finally, the Complex IAR model can be represented by the expression

2

Œµt j .

(5)
Œ≥0

Using the De Moivre formula, we have

Œ¥ j
œÜR + iœÜI
= |œÜ|Œ¥ j (cos(Œ¥ j œà) + i sin(Œ¥ j œà))

yt j + izt j = (Œ±Rtj + iŒ±tIj ) (yt j‚àí1 + izt j‚àí1 ) + œÉt j (ŒµRtj + iŒµtIj ).

2

œÜŒ¥ j Œ≥0 + œÉt j (1 + c),

Appendix C: Proof of Lemma 3
At a fixed time t j , the eigenvalues of the transition matrix of the
!
Œ±Rtj ‚àíŒ±tIj
CIAR process Ft j =
satisfy the following equaŒ±tIj Œ±Rtj
tion.

from which we obtain

Œ≥0

=

=

(1 + c) œÉt j
1 ‚àí œÜŒ¥ j

2

2



2
(1 + c)œÉ2 1 ‚àí œÜŒ¥ j
1‚àí

2
œÜŒ¥ j

|(Ft j ‚àí ŒªI)| =

= (1 + c)œÉ2 .

It can be shown that by recursion the autocovariance function is
given by
Œ≥k = œÜt j+k ‚àít j œÉ2 (1 + c) = œÜ‚àÜk œÉ2 (1 + c),
œÜ‚àÜk

Appendix B: Proof of Lemma 2
The CIAR model is defined as yt j + izt j = (œÜR + iœÜI )t j ‚àít j‚àí1 (yt j‚àí1 +
izt j‚àí1 ) + œÉt j (ŒµRtj + iŒµtIj ). Let us focus on the term (œÜR + iœÜI )t j ‚àít j‚àí1 ,
(œÜ + iœÜ )

I t j ‚àít j‚àí1

=

I Œ¥j

(œÜ + iœÜ ) = |œÜ|
R

Œ¥j

œÜR + iœÜ
|œÜ|

Using the polar representation for complex numbers we obtain
!Œ¥
œÜR + iœÜI j
|œÜ|

Œ¥ j
œÜR + iœÜI

= (cos(œà) + i sin(œà))Œ¥ j
= |œÜ|Œ¥ j (cos(œà) + i sin(œà))Œ¥ j .

Article number, page 12 of 12

‚àí

‚àíŒ±tIj
Œ±Rtj ‚àí Œª

Œª 0
0 Œª
!

=

(Œ±Rtj ‚àí Œª)2 + Œ±tI2j

=

I2
Œª2 ‚àí 2Œ±Rtj Œª + (Œ±R2
t j + Œ±t j )

=

0,

q
R2
I2
2Œ±Rtj ¬± 4Œ±R2
t j ‚àí4(Œ±t j +Œ±t j )
2

=
=
=
=
=
+

!

= Œ±Rtj ¬± iŒ±tIj .

Ft j Xt j‚àí1 + Vt j
Ft j (Ft j‚àí1 Xt j‚àí2 + Vt j‚àí1 ) + Vt j
Ft j Ft j‚àí1 Xt j‚àí2 + Ft j Vt j‚àí1 + Vt j
Ft j Ft j‚àí1 (Ft j‚àí2 Xt j‚àí3 + Vt j‚àí2 ) + Ft j Vt j‚àí1 + Vt j
Ft j Ft j‚àí1 Ft j‚àí2 Xt j‚àí3 + Ft j Ft j‚àí1 Vt j‚àí2
Ft j Vt j‚àí1 + Vt j .

Therefore, the general form can be written as,
Xt j = Xt j‚àín

.

!

Since |Œ±Rtj + iŒ±tIj | = |Œ±Rtj ‚àí iŒ±tIj | = |Œ±t j |, then the process is
stable if sup |Œ±t j | < 1. Therefore, under this assumption the CIAR
process has the unique stationary solution (Brockwell & Davis
(2002)) given by
Xt j

and therefore, the autocorrelation can be expressed as œÅk =
.

!
I Œ¥j

‚áíŒª=

‚àíŒ±tIj
Œ±Rtj

Œ±Rtj ‚àí Œª
Œ±tIj

=

The autocovariance of the process is defined by Œ≥k =
E(xt j+k xt j ), such that

 
E(xt j+k xt j ) = E œÜŒ¥ j+k xt j+k‚àí1 + œÉt j+k Œµt j+k xt j


= œÜŒ¥ j+k E xt j+k‚àí1 xt j

 
= œÜŒ¥ j+k E œÜŒ¥ j+k‚àí1 xt j+k‚àí2 + œÉt j+k‚àí1 Œµt j+k‚àí1 xt j


= œÜt j+k ‚àít j+k‚àí2 E xt j+k‚àí2 xt j .

R

Œ±Rtj
Œ±tIj

n‚àí1
Y

Ft j‚àík + Vt j +

k=0

n‚àí1
X
k=1

Vt j‚àík

k‚àí1
Y

Ft j‚àíi .

i=0

Qn‚àí1
Qn‚àí1
Since
k=0 F t j‚àík and |F t j‚àík | < 1 due to the
k=0 F t j‚àík =
Q
stability of the process, then lim n‚àí1
k=0 F t j‚àík = 0. Finally, if n ‚Üí
n‚Üí‚àû
‚àû then the unique stationary solution is given by,
Xt j = Vt j +

‚àû
X
k=1

Vt j‚àík

k‚àí1
Y
i=0

Ft j‚àíi .

