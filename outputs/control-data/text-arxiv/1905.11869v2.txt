arXiv:1905.11869v2 [math.AG] 29 May 2021

Cohomology and the Brauer groups of diagonal
surfaces
DamiaÌn Gvirtz and Alexei N. Skorobogatov
June 1, 2021
in memory of Sir Peter Swinnerton-Dyer
Abstract
We present a method for calculating the Brauer group of a surface given by
a diagonal equation in projective space. For diagonal quartic surfaces with
coefficients in Q we determine the Brauer groups over Q and Q(i).

Contents
6
1 Surfaces with torsion-free Picard group
1.1 Cohomological tools . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6
1.2 Brauer group of varieties dominated by products of curves . . . . . . 12
2 Cohomology of Fermat surfaces
2.1 Topological background . . . . . . . . . . . . . . . . . .
2.2 Primitive cohomology and the cup-product . . . . . . .
2.3 Hodge decomposition . . . . . . . . . . . . . . . . . . .
2.4 Recovering full cohomology from primitive cohomology
2.5 Galois representation over the cyclotomic field . . . . .
3 The
3.1
3.2
3.3

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

.
.
.
.
.

13
13
14
18
19
20

Fermat quartic surface
22
Explicit transcendental lattice . . . . . . . . . . . . . . . . . . . . . . 22
Explicit Galois representation . . . . . . . . . . . . . . . . . . . . . . 23
Diagonal quartic surfaces . . . . . . . . . . . . . . . . . . . . . . . . . 26

4 Main theorem
30
4.1 Reduction to finite group cohomology . . . . . . . . . . . . . . . . . . 30
4.2 The case of Q(i) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 32
4.3 The case of Q . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 35
1

A Computations for the main theorem

37

B Computations for the supplement

40

Introduction
Diagonal equations occupy a special place in number theory: due to separation of
variables many questions about such equations can be reduced to questions about
equations in one variable. This provided AndreÌ Weil with a key example for the
Weil conjectures [Wei49, Wei52]. Diagonal hypersurfaces are a particular case of
varieties dominated by products of curves (DPC). The Tate conjecture is known
for DPC varieties defined over fields finitely generated over Q, see [Tat94, (5.5)].
Using the results of [SZ14] (based on the work of Faltings) it is easy to show that for
DPC varieties defined over such fields the Galois-invariant subgroup of the geometric
Brauer group is finite.
In this paper we use diagonal surfaces to test new techniques for computing the
Brauer group, a task motivated by the Brauerâ€“Manin obstruction to the local-toglobal principle for rational points over number fields (see [CTS21] for a general
introduction). To put this into perspective, in characteristic zero, the Brauer group
of any quadric X over any field k is trivial, that is, equal to the image Br0 (X) of the
canonical map Br(k) â†’ Br(X). The Brauer group of a cubic surface X can be nontrivial, but it is equal to the algebraic Brauer group, that is, to the kernel Br1 (X) of
the canonical map Br(X) â†’ Br(X), where X = X Ã—k kÌ„ for an algebraic closure kÌ„
of k. This simplifies matters considerably, because Br1 (X)/Br0 (X) is a subgroup of
H1 (k, Pic(X)) and is equal to this group if k is a number field. For diagonal cubic
surfaces over Q all elements of Br(X) modulo Br0 (X) and the ensuing Brauerâ€“Manin
conditions were determined in [CKS87].
The arithmetic of diagonal quartic surfaces is a recurrent theme in the work of Peter Swinnerton-Dyer, from his first paper [SD43], revisited in [SD68, PSD91, SD00,
SD14], until his last published paper [SD16]. The algebraic Brauer groups Br1 (X)
of diagonal quartic surfaces over arbitrary fields of characteristic zero were classified
by Bright in his thesis [Bri02, Bri06], though an explicit form of the elements of
this group is not known in general, cf. [Bri11]. Ieronymou [Ier10, Thm. 3.1] constructed generators of Br(X)[2] and showed [Ier10, Prop. 4.9] that they come from
âˆš
4-torsion elements of the Brauer group of the quartic Fermat surface over Q(i, 4 2)
(in fact, they come from 2-torsion elements, see Corollary 3.5 below). He then obtained sufficient conditions on the diagonal quartic surface X over Q under which
the 2-torsion subgroup of Br(X)/Br1 (X) is trivial [Ier10, Thm. 5.2]. This, âˆš
together
with Mizukamiâ€™s isomorphism between the quartic Fermat surface over Q(i, 2) and
a certain Kummer surface, was used in [ISZ11] to deduce an explicit upper bound
for the size of Br(X)/Br0 (X). Finally, the odd order torsion subgroup of Br(X)
2

was determined in [IS15] using a different method; the elements of this group have
an explicit description, enabling one to compute the associated Brauerâ€“Manin conditions. The complete determination of the 2-primary torsion subgroup of Br(X)
could not be done by previously known methods. We now describe a new approach
that allowed us to achieve this.
Let k be a number field and let Î“ = Gal(kÌ„/k). For a smooth and projective surface
X over k such that Pic(X) is torsion-free and Br(X)Î“ is finite, the determination
of Br(X)/Br0 (X) involves the following steps. (These conditions hold, for example,
when X is a K3 surface [SZ08] or a diagonal surface in P3k , see [SGA7, XI.1.8] and
Proposition 1.7 below.)
(a) Determine the action of Î“ on the geometric Brauer group Br(X), hence compute Br(X)Î“ . For a K3 surface with complex multiplication this involves identifying the GroÌˆssencharakter which describes the action of Î“ on the Tate module of
Br(X). For diagonal quartic surfaces, this has essentially been done by Pinch and
Swinnerton-Dyer in [PSD91] using work of Weil [Wei52].
(b) Determine the image of Br(X) â†’ Br(X)Î“ , called the transcendental Brauer
group. The crucial fact is that when Pic(X) is torsion-free, the 2-term complex of
Î“-modules
Hom(Pic(XC ), Z) âˆ’â†’ T (XC ) âŠ— Q/Z
(1)

is quasi-isomorphic to the truncated complex Ï„[1,2] Rpâˆ— Gm,X , where p : X â†’ Spec(k)
is the structure morphism. Here T (XC ) is the transcendental lattice, and the map
in (1) comes from the cup-product bilinear form on H2 (XC , Z(1)).
(c) The group Br1 (X)/Br0 (X) âˆ¼
= H1 (k, Pic(X)) is finite; it can be determined if we
know an integral basis of Pic(X) and the action of Î“ on it. The group Br(X)/Br0 (X),
an extension of finite abelian groups Br(X)/Br1 (X) by Br1 (X)/Br0 (X), is computed
as the first Galois hypercohomology group of the complex (1).

The methods in (b) and (c) are used for the first time in this paper. We apply
them to advance this program for diagonal surfaces of arbitrary degree d in P3k , using
the description of integral homology of the Fermat hypersurface F of degree d over
C obtained by Pham [Pha65], see also [Lo10, ABB13, DS16].
Pham considers a natural â€œvanishing cycleâ€ in the complement UC to a coordinate
hyperplane section of FC and shows that its orbit under the action of the group of
diagonal automorphisms G = (Âµd )3 generates the primitive subgroup of H2 (FC , Z)
(the kernel of the intersection product with the hyperplane section). He also computes the intersection product in the resulting integral basis. The group H2 (FC , C)
decomposes into a direct sum of 1-dimensional eigenspaces of G, compatibly with
the Hodge decomposition (which was determined by Shioda [Sh79] using work of
Griffiths). The Galois representation in the eÌtale cohomology of F goes back to
Weil [Wei49, Wei52], and was studied by Katz, Shioda, and Ulmer, among others,
see [Ulm02]. Combining these data, the computation of the Brauer group of diagonal surfaces of any degree d over the cyclotomic field Q(Âµd ) can in principle be done
3

by a computer. We work out precise details in the case of diagonal quartic surfaces
with coefficients in Q over the ground field Q(i), which are then used to deal with
the case of the ground field Q.
P
To state our results, we call two diagonal quartic forms 3i=0 ai x4i , where ai âˆˆ K Ã—
for i = 0, 1, 2, 3, equivalent if one is obtained from another by permuting the variables
x0 , x1 , x2 , x3 , multiplying the coefficients ai by fourth powers in K Ã— , and multiplying
all four coefficients by a common multiple in K Ã— . A diagonal quartic surface is the
surface given by a diagonal quartic form in P3K ; surfaces given by equivalent forms
will be called equivalent. It is clear that equivalent surfaces are isomorphic.
Main theorem. Let a1 , a2 , a3 be non-zero rational numbers. Let X âŠ‚ P3Q be the
surface
x40 + a1 x41 + a2 x42 + a3 x43 = 0.
(1) Let k = Q(i) and let Xk = X Ã—Q k. If Xk is equivalent to the diagonal quartic
surface with coefficients (a1 , a2 , a3 ) = (1, 2, âˆ’2), then the 2-primary torsion subgroup
of Br(Xk )/Br1 (Xk ) is Z/2; otherwise this subgroup is 0.
(2) If X is equivalent to the diagonal quartic surface with coefficients (1, 2, âˆ’2) or
(1, 8, âˆ’8), then the 2-primary torsion subgroup of Br(X)/Br1 (X) is Z/2; otherwise
this subgroup is 0.
The two exceptional surfaces in (2) are non-equivalent over Q but equivalent,
hence isomorphic over Q(i). We do not know whether they are isomorphic over Q.
Both have rational points over Q. In Proposition 4.7 we show that multiplying two
of the coefficients by âˆ’4 gives rise to surfaces with isomorphic Galois representations
in the second eÌtale cohomology group with coefficients Q2 and Zâ„“ for any odd prime
â„“. By analogy with the Tate module of abelian varieties one may conjecture that
these surfaces are related by an isogeny whose degree is a power of 2.
By the main theorem, only finitely many diagonal quartic surfaces with coefficients
in Q, considered over Q or Q(i), up to isomorphism, have non-zero 2-torsion in the
transcendental Brauer group. In contrast, there are infinitely many non-equivalent
diagonal quartic surfaces over Q with odd order torsion in the transcendental Brauer
group. Indeed, by [IS15, Thm. 1.1] the odd torsion subgroup of Br(X)/Br1 (X) is
0, unless âˆ’3a1 a2 a3 is a fourth power or âˆ’4 times a fourth power in Q when this
subgroup is Z/3, or 125a1 a2 a3 is a fourth power or âˆ’4 times a fourth power in Q
when this subgroup is Z/5. (When Q is replaced by Q(i) we have (Z/3)2 and (Z/5)2
instead of Z/3 and Z/5, respectively.) Thus we now have a complete classification
of the transcendental Brauer groups of diagonal quartic surfaces with coefficients in
Q over Q and Q(i). Note that the method of our paper works for all primes â„“, so our
Proposition 3.2 directly implies [IS15, Thm. 1.1], which was proved by a different
method that works only for odd â„“.
As a consequence, we show non-existence of a 2-primary Brauerâ€“Manin obstruction to the Hasse principle alluded to in [ISZ11, p. 660].
4

Corollary Let X be a diagonal quartic surface over Q with coefficients a1 , a2 , a3
such that a1 a2 a3 is a square in Q. Then Br(X) = Br1 (X).
We can be even more precise: carrying out calculations of step (c) we describe
the structure of the extension
0 âˆ’â†’ Br1 (X)/Br0 (X) âˆ’â†’ Br(X)/Br0 (X) âˆ’â†’ Br(X)/Br1 (X) âˆ’â†’ 0.

(2)

Supplement to the main theorem (1) Let Xk be the diagonal quartic surface
with coefficients (1, 2, âˆ’2) over k = Q(i). Then the exact sequence (2) for Xk over
k is the extension
0 âˆ’â†’ Z/2 Ã— Z/4 âˆ’â†’ (Z/4)2 âˆ’â†’ Z/2 âˆ’â†’ 0.
(2) Let X be the diagonal quartic surface with coefficients (1, 2, âˆ’2) or (1, 8, âˆ’8)
over Q. Then the exact sequence (2) for X over Q is the extension
0 âˆ’â†’ Z/4 âˆ’â†’ Z/8 âˆ’â†’ Z/2 âˆ’â†’ 0.
Combined with Brightâ€™s classification of algebraic Brauer groups of diagonal quartic surfaces [Bri02], this completes the classification of the Brauer groups of diagonal
quartic surfaces with coefficients in Q over the ground fields Q and Q(i).
The supplement illustrates a difficulty in lifting Galois-invariant elements of Br(X)[2]
to Br(X) already apparent in work of Ieronymou [Ier10]: an element in the image
of Br(X) â†’ Br(X) may not lift to an element of Br(X) of the same order. This
difficulty does not arise for odd order elements because Br1 (X)/Br0 (X) is always a
2-group, as Î“ acts on Pic(X) via a finite 2-group.
The 2-primary torsion subgroup of Br(X) contains a unique non-zero element
invariant under the group of diagonal automorphisms of X. This element is Galoisinvariant (Proposition 3.6, Corollary 3.11). Our calculations in step (b) show that
the map Br(X) â†’ Br(X) is almost always zero on the 2-primary torsion subgroups,
but when Br(X)/Br1 (X) is non-zero in the exceptional cases above, it is generated
by this element. This answers Question 1 raised at the end of [Sko17].
The first named author has successfully applied the methods developed in this
paper to diagonal surfaces of degrees 5 and 6. These methods also work for diagonal
surfaces in weighted projective spaces, see [GLN, Gvi19].
Let us outline the structure of the paper. In the preliminary Section 1 we develop
necessary cohomological machinery and prove a finiteness result for the Brauer group
of diagonal surfaces over fields finitely generated over Q. In Section 2 we recall the
description of the integral primitive cohomology of the complex Fermat surface of
degree d, including the cup-product and Hodge decomposition, and explain how
to recover the full cohomology lattice from the primitive cohomology sublattice.
We also recall a known description of the associated representation of the absolute
5

Galois group of the cyclotomic field Q(Âµd ). In Section 3 we specialise to the case
d = 4 and compute the transcendental lattice of the quartic Fermat surface F and
the representation of the absolute Galois group of Q in the â„“-adic Tate module of
Br(F ). This allows us to carry out step (a). Although our general methods do
not rely on the assumption that the geometric Picard group of the Fermat surface is
integrally generated by lines (which, by a theorem of Degtyarev [Deg15], holds if and
only if d â‰¤ 4 or d is coprime to 6; for the case d = 4 see [PSD91]), our calculations in
step (b) become simpler if we use this fact. We prove the main theorem in Section 4
(see Theorems 4.2 and 4.6); details of computations are collected in Appendix A.
The computational proof of the supplement can be found in Appendix B.
This paper owns its existence to many happy discussions of the second named
author with Peter Swinnerton-Dyer, and to Peterâ€™s lifelong interest in diagonal quartics. We dedicate this paper to his memory.
We are grateful to Martin Bright, Rachel Newton, Domenico Valloni, Olivier
Wittenberg and Yuri Zarhin for their questions and useful discussions. The integral
basis of lines on the Fermat quartic surface used in the appendix was kindly provided
to us by Peter Swinnerton-Dyer.
The final part of the work on this paper was done at the Institut Henri PoincareÌ
in Paris. We thank the IHP for hospitality and support.

1
1.1

Surfaces with torsion-free Picard group
Cohomological tools

We start by recalling some basic homological algebra from [CTS13, Â§3.1]. Let A, B
be abelian categories and let G : A â†’ B be an additive functor. Let
0 âˆ’â†’ A âˆ’â†’ B âˆ’â†’ C âˆ’â†’ 0

(3)

be an exact sequence in A. Using injective resolutions one constructs a 2-term
complex E = [E 0 â†’ E 1 ] in B together with maps of complexes

Ï„[1,2] G(B â€¢ ) [1] â†âˆ’ E âˆ’â†’ [(R1 G)C â†’ (R2 G)A],
(4)

where B â€¢ is an injective resolution of B and Ï„[1,2] is the natural truncation. (See the
diagram in [CTS13], the proof of Lemma 3.2.) It satisfies the following properties.
(1) The leftward arrow induces an isomorphism of cohomology groups in degree 0.
In degree 1 it induces the natural map from Coker[(R1 G)C â†’ (R2 G)A] to (R2 G)B.
(2) The rightward arrow induces an isomorphism in degree 1. In degree 0 it
induces the natural map from (R1 G)B to Ker[(R1 G)C â†’ (R2 G)A].
Let k be a field with separable closure kÌ„ and Galois group Î“ = Gal(kÌ„/k). Let
p : X â†’ Spec(k) be a variety over k. We write X = X Ã—k kÌ„. The structure morphism
6

p defines the derived functor Rpâˆ— from the derived category D(X) of bounded below
complexes of eÌtale sheaves of abelian groups on X to the derived category D(k) of
bounded below complexes of continuous discrete Î“-modules.
Lemma 1.1 Let p : X â†’ Spec(k) be a proper, geometrically reduced and geometrically connected variety over a field k. There is a natural map
Br(X)/Br0 (X) âˆ’â†’ H2 (k, Ï„[1,2] Rpâˆ— Gm,X ),
which is an isomorphism when k is a number field.
Proof. The assumption on X implies H0 (X, OX ) âˆ¼
= kÌ„, hence H0 (X, Gm ) âˆ¼
= kÌ„ âˆ— . The
derived functor of H0 (k, Â·) is a functor from D(k) to the derived category of bounded
below complexes of abelian groups. Applying it to the exact triangle
Ï„[0] Rpâˆ— Gm,X âˆ’â†’ Ï„[0,2] Rpâˆ—Gm,X âˆ’â†’ Ï„[1,2] Rpâˆ— Gm,X
gives an exact sequence
Br(k) âˆ’â†’ Br(X) âˆ’â†’ H2 (k, Ï„[1,2] Rpâˆ— Gm,X ) âˆ’â†’ H3 (k, kÌ„ Ã— ).
If k is a number field, then H3 (k, kÌ„ Ã— ) = 0. 
We now assume that k has characteristic zero and that X is a smooth, proper
and geometrically integral variety over k such that Pic(X) is torsion-free. Let (3)
be the Kummer exact sequence
1 âˆ’â†’ Âµn âˆ’â†’ Gm âˆ’â†’ Gm âˆ’â†’ 1,
where n â‰¥ 1. This sequence shows that H1 (X, Âµn ) = 0 for any n â‰¥ 1, thus in this
case the rightward arrow in (4) is a quasi-isomorphism. In the derived category
D(k) we obtain a morphism
[Pic(X) â†’ H2 (X, Âµn )] âˆ’â†’ (Ï„[1,2] Rpâˆ— Gm,X )[1]
Ëœ
nx 7â†’ x, in degree 0 and the natural
inducing the isomorphism nPic(X)âˆ’â†’Pic(X),
inclusion Br(X)[n] â†’ Br(X) in degree 1. If â„“ is a prime and m is a positive integer,
then setting n = â„“m and passing to the inductive limit as m â†’ âˆ we obtain a
morphism
[Pic(X) âŠ— Z[â„“âˆ’1 ] â†’ H2 (X, Qâ„“ /Zâ„“ (1))] âˆ’â†’ (Ï„[1,2] Rpâˆ— Gm,X )[1].
In degree 0 it induces the identity on Pic(X) and in degree 1 the natural inclusion
Br(X){â„“} Ö’â†’ Br(X), where Br(X){â„“} is the â„“-primary torsion subgroup, see [Gro68,
7

II, Thm. 3.1]. Since X is smooth, Br(X) is a torsion group [Gro68, II, Prop. 1.4].
Thus summing over all primes â„“ we obtain a quasi-isomorphism
[Pic(X) âŠ— Q â†’ H2 (X, Q/Z(1))]âˆ’â†’(Ï„
Ëœ [1,2] Rpâˆ— Gm,X )[1].

(5)

Let X be a smooth, projective, geometrically integral surface over a field k âŠ‚ C
such that Pic(XC ) is torsion-free. Then H2 (XC , Z(1)) is a torsion-free abelian
group and the first Chern class identifies Pic(XC ) with a saturated subgroup of
H2 (XC , Z(1)) (that is, the quotient is torsion-free). The cup-product defines a unimodular symmetric bilinear pairing
H2 (XC , Z(1)) Ã— H2 (XC , Z(1)) âˆ’â†’ H4 (XC , Z(2)) = Z.
Since H2 (XC , Z(1)) is torsion-free, the cup-product induces an isomorphism
2
H2 (XC , Z(1))âˆ’â†’Hom(H
Ëœ
(XC , Z(1)), Z).

The Hodge index theorem implies that the restriction of the cup-product to Pic(XC ),
which coincides with the intersection pairing on Pic(XC ), has non-zero discriminant.
Define the transcendental lattice T (XC ) as the orthogonal complement to Pic(XC )
in H2 (XC , Z(1)) with respect to the cup-product. Thus Pic(XC ) âˆ© T (XC ) = 0,
and Pic(XC ) âŠ• T (XC ) has finite index in H2 (XC , Z(1)). Since Pic(XC ) is a saturated
subgroup of H2 (XC , Z(1)), it is the orthogonal complement to T (XC ). Using the unimodularity of the cup-product on H2 (XC , Z(1)) we obtain canonical isomorphisms
of finite abelian groups
Hom(Pic(XC ), Z) âˆ¼ H2 (XC , Z(1)) âˆ¼ Hom(T (XC ), Z)
.
=
=
Pic(XC )
Pic(XC ) âŠ• T (XC )
T (XC )
Let us call this group âˆ†X , or simply âˆ†, if there is no confusion. We write âˆ† = âŠ•â„“ âˆ†â„“ ,
where the order of âˆ†â„“ is a power of a prime number â„“. We deduce an exact sequence
of abelian groups


0 âˆ’â†’ âˆ†â„“ âˆ’â†’ Pic(XC )âŠ—Qâ„“ /Zâ„“ âŠ• T (XC )âŠ—Qâ„“ /Zâ„“ âˆ’â†’ H2 (XC , Z(1))âŠ—Qâ„“ /Zâ„“ âˆ’â†’ 0.

The group of connected components of the Picard scheme of X Ã—k K, where K is an
algebraically closed field extension of k, does not depend on the choice of K. Thus,
under the assumption that Pic(XC ) is torsion-free, the groups Pic(X) and Pic(XC )
are canonically isomorphic. By the comparison theorem between classical and eÌtale
cohomology we have an isomorphism H2 (XC , Z(1)) âŠ— Zâ„“ âˆ¼
= H2 (X, Zâ„“ (1)), compatible
with the cycle class map and the cup-product. Thus T (XC ) âŠ— Zâ„“ âˆ¼
= T (X)â„“ , where
T (X)â„“ âŠ‚ H2 (X, Zâ„“ (1)) is the orthogonal complement to the (injective) image of
Pic(X) under the class map, and the previous exact sequence is canonically identified
with the exact sequence of Î“-modules


0 âˆ’â†’ âˆ†â„“ âˆ’â†’ Pic(X)âŠ—Qâ„“ /Zâ„“ âŠ• T (X)â„“ âŠ—Qâ„“ /Zâ„“ âˆ’â†’ H2 (X, Zâ„“ (1))âŠ—Qâ„“ /Zâ„“ âˆ’â†’ 0.
8

This gives rise to the commutative diagram of Î“-modules
âˆ† â„“_ 



T (X)â„“ âŠ— Qâ„“ /Zâ„“
/

_

[âˆ’1]



Pic(X) âŠ— Qâ„“ /Zâ„“ 





H2 (X, Zâ„“ (1)) âŠ— Qâ„“ /Zâ„“
/

Summing over all primes â„“ we obtain a commutative diagram of Î“-modules
âˆ† _ 


/

T (XC ) âŠ—
 Q/Z
_

[âˆ’1]



Pic(XC ) âŠ— Q/Z


/



H2 (XC , Z(1)) âŠ— Q/Z

Using the non-degeneracy of the intersection pairing on Pic(X) we identify the
Î“-modules Pic(X) âŠ— Q and Hom(Pic(X), Q). This gives rise to the commutative
diagram of Î“-modules
Hom(Pic(XC ), Z)

//



Pic(XC ) âŠ— Q

//

âˆ†


Pic(XC ) âŠ— Q/Z

Finally, we compose horizontal arrows in the two last diagrams to obtain a commutative diagram of Î“-modules
Hom(Pic(XC ), Z)
/

T (XC ) âŠ— Q/Z
[âˆ’1]



Pic(XC ) âŠ— Q
/

(6)



H2 (XC , Z(1)) âŠ— Q/Z

Since X is a surface, by PoincareÌ duality H2 (X, Zâ„“ )tors = 0 implies H3 (X, Zâ„“ )tors =
0, for all â„“. By the Kummer sequence this implies that Br(X) âˆ¼
= Br(XC ) is divisible
and the â„“-primary torsion subgroup Br(X){â„“} is the quotient of H2 (X, Zâ„“ (1))âŠ—Qâ„“ /Zâ„“
by Pic(X) âŠ— Qâ„“ /Zâ„“ , see [CTS13], diagram (26), p. 157. Taking the direct sum over
all primes â„“ we obtain a canonical isomorphism of Î“-modules
HomZ (T (XC ), Q/Z)âˆ’â†’Br(X).
Ëœ

(7)

For future use we point out that (7) gives rise to an isomorphism of Î“-modules
m
],
HomZ (T (XC ), Z/â„“m )âˆ’â†’Br(X)[â„“
Ëœ

for any prime â„“ and any positive integer m.
9

(8)

Proposition 1.2 Let X be a smooth, projective, geometrically integral surface over
a subfield k âŠ‚ C such that Pic(XC ) is torsion-free. Then the map of horizontal 2term complexes of Î“-modules in (6) is a quasi-isomorphism. Each of these complexes
concentrated in degrees 0 and 1 represents (Ï„[1,2] Rpâˆ— Gm,X )[1] in D(k).
Proof. The first statement follows from the construction of (6). Indeed, the induced
map in degree 0 is the identity on Pic(XC ) = Pic(X). The induced map in degree 1
is the canonical isomorphism (7).
Since H3 (XC , Z)tors = 0, the exact sequence
0 âˆ’â†’ Z âˆ’â†’ Q âˆ’â†’ Q/Z âˆ’â†’ 0
gives a natural isomorphism
H2 (XC , Z(1)) âŠ— Q/Zâˆ’â†’H
Ëœ 2 (XC , Q/Z(1)).
Now the quasi-isomorphism (5) gives that the bottom complex of (6) is quasiisomorphic to (Ï„[1,2] Rpâˆ— Gm,X )[1]. 
Remark 1.3 For completeness we note that Ï„[0,1] Rpâˆ—Gm,X is represented by the
complex of Î“-modules div : kÌ„(X)Ã— â†’ Div(X), where div sends a function to its
divisor, see [BvH09, Lemma 2.3].
Corollary 1.4 Let X be a smooth, projective, geometrically integral surface over a
number field k such that Pic(X) is torsion-free. Then the group Br(X)/Br0 (X) is
canonically isomorphic to the Galois hypercohomology group


H1 (k, Hom(Pic(X), Z) â†’ T (XC ) âŠ— Q/Z ).
Proof. This follows from Proposition 1.2 in view of Lemma 1.1. 
Recall that we have exact sequences of Î“-modules
0 âˆ’â†’ âˆ† âˆ’â†’ T (XC ) âŠ—Z Q/Z âˆ’â†’ Br(X) âˆ’â†’ 0

(9)

0 âˆ’â†’ Pic(X) âˆ’â†’ HomZ (Pic(X), Z) âˆ’â†’ âˆ† âˆ’â†’ 0.

(10)

and

Corollary 1.5 Let X be a smooth, projective, geometrically integral surface over a
number field k such that Pic(X) is torsion-free. Then the image of the natural map
Br(X) â†’ Br(X) is equal to the kernel of the composition
âˆ‚

âˆ‚

1
2
Br(X)Î“ âˆ’â†’
H1 (k, âˆ†) âˆ’â†’
H2 (k, Pic(X)),

where âˆ‚1 is defined by (9) and âˆ‚2 is defined by (10).
10

Proof. This follows from Proposition 1.2 using that H3 (k, kÌ„ Ã— ) = 0 for a number field
k. See also [CTS13, Prop. 4.1]. 
Corollary 1.6 Let X be a smooth, projective, geometrically integral surface over
a number field k such that Pic(X) is torsion-free. Suppose that the image of the
natural map Br(X) â†’ Br(X)Î“ is contained in Br(X)[n] for some n â‰¥ 1. Let
Tn âŠ‚ T (XC ) âŠ— Q/Z be the inverse image of Br(X)[n] in (9). Let Î“K be the kernel
of the natural map
Î“ âˆ’â†’ Aut(Pic(X)) Ã— Aut(Tn ),
and let K = (kÌ„)Î“K , G = Gal(K/k). Then we have the following statements.
(a) The image of the natural map Br(X) â†’ Br(X)Î“ is equal to the kernel of the
composition
âˆ‚1
âˆ‚2
Br(X)[n]G âˆ’â†’
H1 (G, âˆ†) âˆ’â†’
H2 (G, Pic(X)).

(b) The group Br(X)/Br0 (X) is canonically isomorphic to the hypercohomology
group
H1 (G, [Hom(Pic(XC ), Z) â†’ Tn ]).
(11)
Proof. (a) It is clear that the action of Î“ on the terms of (10) and on the terms of
0 âˆ’â†’ âˆ† âˆ’â†’ Tn âˆ’â†’ Br(X)[n] âˆ’â†’ 0
factors through G. We have Pic(X)Î“K = Pic(X), which is a finitely generated
free abelian group, hence H1 (K, Pic(X)) = 0. From the Hochschildâ€“Serre spectral
sequence we deduce the injectivity of the inflation map
H2 (G, Pic(X)) âˆ’â†’ H2 (k, Pic(X)).
Now (a) follows from Corollary 1.5.
(b) Let K be the complex Hom(Pic(X), Z) â†’ T (XC ) âŠ— Q/Z and let Kn be the
complex Hom(Pic(XC ), Z) â†’ Tn . Using Proposition 1.2 we obtain a commutative
diagram, whose lower part is constructed using inflation maps:
0

H1 (k, Pic(X))
/

/

O

H1 (k, K)
/

O

Br(X)Î“
/

O

H2 (k, Pic(X))
O

âˆ¼
=

âˆ¼
=

0
/

H1 (k, Pic(X))

/ H1 (k, Kn )
O

O

âˆ¼
=

0
/

1

H (G, Pic(X))

?

/

Br(X)[n]Î“
/

O

H2 (k, Pic(X))
O

/

âˆ¼
=
1

H (G, Kn )

/ Br(X)[n]G
/

2

H (G, Pic(X))

A diagram chase gives canonical isomorphisms
H1 (G, Kn )âˆ’â†’H
Ëœ 1 (k, Kn )âˆ’â†’H
Ëœ 1 (k, K)âˆ’â†’Br(X)/Br
Ëœ
0 (X),
the last one given by Corollary 1.4. 
11

?

1.2

Brauer group of varieties dominated by products of
curves

A smooth, projective and geometrically integral variety X over a field k is called a
variety dominated by a product of curves if there is a dominant rational map from a
product of geometrically integral kÌ„-curves to X.
Proposition 1.7 Let k be a field finitely generated over Q. If X is a smooth,
projective and geometrically integral variety over k dominated by a product of curves,
then Br(X)Î“ is finite.
Proof. If V and W are smooth, projective and geometrically integral varieties over
a field k which is finitely generated over Q, then the cokernel of the natural map
Br(V )Î“ âŠ• Br(W )Î“ â†’ Br(V Ã— W )Î“ is finite by [SZ14, Thm. A]. The Brauer group
of a curve over an algebraically closed field is zero [Gro68, III, Cor. 1.2], [CTS21,
Thm. 5.6.1 (ii)]. Thus if Z is a product of smooth, projective and geometrically
integral curves over k, then Br(Z)Î“ is finite.
Replacing k by a finite field extension we obtain geometrically integral k-curves
Q
C1 , . . . , Cn such that there is a dominant rational map f from S = ni=1 Ci to
X defined over k. Let d = dim(X). There is a dense open subset U âŠ‚ S such
that the restriction of f to U is a smooth morphism U â†’ X. After another finite
extension of k we can find a k-point P âˆˆ U(k). The induced map of tangent spaces
fâˆ— : TS,P â†’ TX,f (P ) is surjective, so we can choose a d-element subset I âŠ‚ {1, . . . , n}
âˆ¼ Q Ci is the k-fibre of the projection
such that
f
âˆ— (TSI ,P ) = TX,f (P ) , where SI =
iâˆˆI
Q
S â†’ iâˆˆI
C
which
contains
P
.
Thus
f
restricts
to a dominant, generically finite
i
/
rational map from a product of d geometrically integral k-curves to X.
Since char(k) = 0, we can assume that there is a smooth, projective and geometrically integral variety Y over k, a birational morphism Y â†’ Z, where Z is a product
of smooth, projective and geometrically integral curves, and a dominant, generically finite morphism f : Y â†’ X. By the birational invariance of the Brauer group
[Gro68, III, Â§7], [CTS21, Cor. 6.2.11] we have Br(Y )Î“ âˆ¼
= Br(Z)Î“ . A general theorem of Grothendieck says that the natural map Br(X) Ö’â†’ Br(kÌ„(X)) is injective, see
[Gro68, III, Cor. 6.2], [CTS21, Thm. 3.5.5]. The standard restriction-corestriction
argument then gives that the kernel of f âˆ— : Br(X) â†’ Br(Y ) is killed by the degree
[kÌ„(Y ) : kÌ„(X)]. Since Br(X) is a torsion group of cofinite type [Gro68, II, Cor. 3.4],
[CTS21, Prop. 5.2.9], this kernel is finite. Hence Br(X)Î“ is finite. 
Corollary 1.8 Let k be a field finitely generated over Q. Let f (t) and g(t) be
separable polynomials of degree d â‰¥ 2. Let F (x, y) and G(x, y) be homogeneous
forms of degree d such that f (t) = F (t, 1) and g(t) = G(t, 1). Let X âŠ‚ P3k be the
surface with equation F (x, y) = G(z, w), for example, a diagonal surface. Then the
Brauer group Br(X) is finite modulo Br(k).
12

Proof. Consider the smooth plane curves C and D given by z d = F (x, y) and
ud = G(v, w), respectively. Passing to the quotient by the action of Âµd on C Ã— D,
which multiplies z and u by the same root of unity, gives a dominant rational map
from C Ã— D to X. Thus X is a DPC surface. Since Pic(X) is torsion-free [SGA7,
XI.1.8], the group Br1 (X)/Br0 (X) is finite. The finiteness of Br(X)Î“ follows from
Proposition 1.7. 

2
2.1

Cohomology of Fermat surfaces
Topological background

Let X be a smooth irreducible subvariety of Pn+1
of dimension n. Let Z âŠ‚ X
C
be a smooth hyperplane section and let U = X \ Z. The long exact sequence of
relative homology groups and the long exact sequence of cohomology groups with
compact support form the following commutative diagram, where vertical arrows
are the PoincareÌ duality isomorphisms (see, e.g., the diagram in the proof of [Hat02,
Prop. 3.46]):
Hn+1 (X, U, Z)

Hn (U, Z)
/

O

Hn (X, Z)
/

âˆ¼
=

O

O

âˆ¼
=

Hnâˆ’1 (Z, Z)
/

/

Hn (X, U, Z)
O

âˆ¼
=

Hnc (U, Z)
/

âˆ¼
=

Hn (X, Z)
/

(12)

Hn (Z, Z)

Next, we have a commutative diagram, where the maps h are defined by evaluating cochains on chains and the isomorphisms are dual to the PoincareÌ duality
isomorphisms:
Hn (U, Z)

h

Hn (X, Z)

h

/

O

/

Hom(Hn (U, Z), Z)

âˆ¼

Hom(Hn (X, Z), Z)

âˆ¼

O

/

/

Hom(Hnc (U, Z), Z)
O

Hom(Hn (X, Z), Z)

The commutativity of this diagram implies compatibility of the cup-product pairings
Hn (U, Z) Ã— Hnc (U, Z) âˆ’â†’ Z
â†‘
â†“
||
n
n
H (X, Z) Ã— H (X, Z) âˆ’â†’ Z
Modulo torsion subgroups, these pairings are perfect dualities, cf. [Hat02, Prop. 3.38].
The natural map Hnc (U, Z) â†’ Hn (U, Z) gives rise to a bilinear form on Hnc (U, Z).
The PoincareÌ duality isomorphism Hnc (U, Z) âˆ¼
= Hn (U, Z) identifies this form with the
intersection products of homology classes, see [GH78, pp. 43â€“60].
13

2.2

Primitive cohomology and the cup-product

Let F âŠ‚ P3Q be the Fermat surface
xd0 + xd1 + xd2 + xd3 = 0.
The abelian group H = H2 (FC , Z(1)) is finitely generated and free, so the cupproduct defines a unimodular symmetric bilinear form hx, yi on H. Let L âˆˆ H
be the hyperplane section class. Let P = P 2 (FC , Z(1)) âŠ‚ H be the orthogonal
complement to L with respect to the cup-product pairing. Thus P is the kernel
of the map H â†’ Z sending x âˆˆ H to hx, Li, so P is a saturated subgroup of H.
Since hL, Li = d > 0, the restriction of the cup-product pairing H Ã— H â†’ Z to P is
non-degenerate.
Let Î› âˆˆ H be the class of a line contained in FC . Since hL, Î›i = 1, we see that L
is a primitive element of H. (This holds for arbitrary smooth complete intersection
surfaces in a projective space, see [SGA7, XI.1.8].) Our map H â†’ Z sends Î› to 1,
so we have a direct sum decomposition of abelian groups H = ZÎ› âŠ• P .
Let G be the group Q-scheme (Âµd )3 . We write G for G(Q). The choice of a
primitive d-th root Îµ of 1 defines an isomorphism of groups G â‰ƒ (Z/d)3 so that the
elements of G are monomials ua1 ub2 uc3 , where
u1 = (Îµ, 1, 1),

u2 = (1, Îµ, 1),

u3 = (1, 1, Îµ),

and (a, b, c) âˆˆ (Z/d)3 . The group G acts on FC by automorphisms so that ui
multiplies xi by Îµ and leaves the other coordinates unaltered.
Let U âŠ‚ F be the complement to the smooth hyperplane section Z âŠ‚ F given by
x0 = 0. We are in the situation of the previous section, with X = FC . It is clear
that the group G â‰ƒ (Z/d)3 acts on all the terms of diagram (12) so that the rows
are exact sequences of G-modules. The PoincareÌ duality isomorphisms are defined
by taking the cap-product with the fundamental class in H4 (FC , Z) âˆ¼
= Z, given by
the orientation of FC . The fundamental class is fixed by the action of G, hence the
PoincareÌ duality isomorphisms are isomorphisms of Z[G]-modules.
From (12) we thus obtain an exact sequence of G-modules
0 âˆ’â†’ H1 (ZC , Z) âˆ’â†’ H2 (UC , Z) âˆ’â†’ H2 (FC , Z) âˆ’â†’ H0 (ZC , Z) âˆ¼
= Z,

(13)

where we used that H1 (FC , Z) = 0. If we ignore the twists, then the last arrow is
the map H â†’ Z sending x âˆˆ H to hx, Li, so its kernel is P . Thus (13) gives rise to
an exact sequence of G-modules
0 âˆ’â†’ H1 (ZC , Z) âˆ’â†’ H2 (UC , Z) âˆ’â†’ P âˆ’â†’ 0,

(14)

where we ignore the twists. (The twist of P plays no role in the description of
the cup-product pairing and the action of G on P , but will be essential for the
determination of the action of complex conjugation, see Remark 2.3.)
14

Since the cup-product pairing on P is non-degenerate, the kernel of the intersection pairing on H2 (UC , Z) is the image of H1 (ZC , Z).
Let us recall a description of the G-module H2 (UC , Z) together with the intersection pairing on it, obtained by Pham in [Pha65, Thm. 1]. The affine Fermat surface
U âŠ‚ A3k is given by
xd1 + xd2 + xd3 = âˆ’1.

Let S âŠ‚ R3 be the standard 2-dimensional simplex z1 + z2 + z3 = 1, zi â‰¥ 0, for
i = 1, 2, 3. Consider the map e : S â†’ UC given by


1/d
1/d
1/d
,
e(z1 , z2 , z3 ) = Î¶2d z1 , Î¶2d z2 , Î¶2d z3
2
where Î¶2d is a primitive root of unity of degree 2d such that Î¶2d
= Îµ. Then
âˆ’1
âˆ’1
e = (1 âˆ’ uâˆ’1
1 )(1 âˆ’ u2 )(1 âˆ’ u3 )e âˆˆ H2 (UC , Z)

is a cycle. Pham shows that the topological space of the simplicial complex generated
by g(e), for g âˆˆ G, is a G-equivariant deformation retract of UC . The resulting chain
compex gives isomorphisms of Z[G]-modules

H2 (UC , Z) âˆ¼
(15)
= Z[G]e âˆ¼
= Z[u1 , u1 , u3]/ Ï†(u1), Ï†(u2 ), Ï†(u3) ,

where Ï†(x) is defined as follows:

Ï†(x) = 1 + x + x2 + Â· Â· Â· + xdâˆ’1 âˆˆ Z[x],

Ï(x, y) =

X

0â‰¤iâ‰¤jâ‰¤dâˆ’2

y i xj âˆˆ Z[x, y]. (16)

Consider the ring Rx := Z[x]/(Ï†(x)) â‰ƒ Zdâˆ’1 . It is immediate to check that in Rx we
have (1 âˆ’ x)Ï(1, x) = d, so d(1 âˆ’ x)âˆ’1 âˆˆ Rx . In this notation, Phamâ€™s isomorphism
(15) is H2 (UC , Z) âˆ¼
= Ru1 âŠ— Ru2 âŠ— Ru3 .
Lemma 2.1 We have an isomorphism of Z[G]-modules
P âˆ¼
= Z[u1 , u1 , u3]/I,

where I = (Ï†(u1), Ï†(u2), Ï†(u3 ), Ï†(u1u2 u3 )) .

Proof. In [Pha65, p. 337] Pham defines a Z[G]-valued form (x|y) on H2 (UC , Z), as
follows:
X
(x|y) =
hx, gyig âˆ’1.
gâˆˆG

This form is Z[G]-linear in y and Z[G]-antilinear in x, with respect to the involution
of the ring Z[G] that sends g to g âˆ’1 . Then he computes [Pha65, p. 340]
(e|e) = âˆ’(1 âˆ’ u1 )(1 âˆ’ u2 )(1 âˆ’ u3 )(1 âˆ’ (u1 u2 u3 )âˆ’1 ).
15

(17)

(Note that the right-hand side of (17) is invariant under the involution of Z[G].)
Since x is invertible in Rx , and 1 âˆ’ x becomes invertible in Rx âŠ— Q, we deduce that
the kernel of the intersection product on H2 (UC , Z) is the annihilator of 1âˆ’u1 u2 u3 in
the ring Ru1 âŠ—Ru2 âŠ—Ru3 . We need to prove that this ideal is generated by Ï†(u1u2 u3 ).
This can be rephrased in terms of group cohomology of the cyclic group Cd .
Namely, we have an exact sequence of Cd -modules
0 âˆ’â†’ Z âˆ’â†’ Z[Cd ] âˆ’â†’ Rx âˆ’â†’ 0,
where Z is a trivial Cd -module. Multiplication by u1 u2 u3 on Ru1 âŠ— Ru2 âŠ— Ru3 makes
it a Cd -module isomorphic to (Z[Cd ]/Z)âŠ—3 . The annihilator ideal of 1 âˆ’ u1 u2 u3 is
the Cd -invariant subgroup of (Z[Cd ]/Z)âŠ—3 , whereas Ï†(u1 u2 u3 ) is the norm element
of the group ring Z[Cd ]. Thus we need to show that the 0-th Tate cohomology group
b 0 (Cd , (Z[Cd ]/Z)âŠ—3 ) is trivial.
H
Taking the triple self-product of the exact complex 0 â†’ Z â†’ Z[Cd ] we obtain the
following exact sequence of Cd -modules:
0 âˆ’â†’ Z âˆ’â†’ Z[Cd ]âŠ•3 âˆ’â†’ (Z[Cd ]âŠ—2 )âŠ•3 âˆ’â†’ Z[Cd ]âŠ—3 âˆ’â†’ (Z[Cd ]/Z)âŠ—3 âˆ’â†’ 0.
The three terms in the middle are free Z[Cd ]-modules, hence all their Tate cohomology groups are trivial. We obtain
b 0 (Cd , (Z[Cd ]/Z)âŠ—3 ) âˆ¼
H
= H3 (Cd , Z) âˆ¼
= Hom(Cd , Z) = 0.

This finishes the proof. 

Remark 2.2 This result is stated in [Lo10, Cor. 2.2]. The argument in the above
proof gives that H0 (Cd , (Z[Cd ]/Z)âŠ—(n+1) ) is zero when n is even, and is isomorphic to
Z/d when n is odd. This second case is missed in [Lo10, Cor. 2.2] so the statement
of loc. cit. for odd n needs to be modified.
Remark 2.3 The complex conjugation is an involution of the real manifold F (C).
Denote by Ï„ the induced involutions of the homology and cohomology groups of FC
and UC with coefficients Z. Then Ï„ g = g âˆ’1 Ï„ for any g âˆˆ G. From Ï„ (e) = (u1 u2 u3 )âˆ’1 e
we deduce that Ï„ (e) = âˆ’e.
Let eâ€² âˆˆ H2 (FC , Z) be the image of e âˆˆ H2 (UC , Z). Since the maps in (13)
respect the action of Ï„ , we have Ï„ (eâ€² ) = âˆ’eâ€² . The complex conjugation Ï„ preserves
the orientation of FC , because FC has complex dimension 2, hence preserves the
fundamental class, so the PoincareÌ duality isomorphisms respect the action of Ï„ .
Now let us consider the twisted cohomology group H = H2 (FC , Z(1)). By definition, there is an isomorphism
H2 (FC , Z)âˆ’â†’H
Ëœ 2 (FC , Z(1))
16

sending x to 2Ï€ix. Thus H with its natural (twisted) action of Ï„ is a subgroup of the
complex vector space H2 (FC , C) where the complex conjugation is the product of Ï„ ,
which is induced by the conjugation acting on F (C), and the complex conjugation
in C. Let us denote by Ï„ (1) this twisted action on H. In particular, for 2Ï€ieâ€² âˆˆ H
we have
Ï„ (1)(2Ï€ieâ€² ) = 2Ï€ieâ€² .
(18)
As 2Ï€ieâ€² generates the Z[G]-module P , the isomorphism of Lemma 2.1 identifies
2Ï€ieâ€² âˆˆ P with the image of 1 âˆˆ Z[G], so this isomorphism is compatible with the
action of Ï„ (1) on Z[G] which fixes 1 and sends each g âˆˆ G to g âˆ’1. (According to
[Lo10, Cor. 2.2], permutations of {1, 2, 3} act on eâ€² by the sign character.)
The cup-product symmetric bilinear form on P has the following description.
Define Ï• : Âµd â†’ Z by Ï•(1) = 1, Ï•(Îµ) = âˆ’1, and Ï•(Îµi ) = 0 for i = 2, . . . , d âˆ’ 1.
Proposition 2.4 Under the isomorphism of G-modules P âˆ¼
= Z[G]/I, the cupproduct is the unique symmetric G-invariant bilinear form hx, yi : P Ã— P â†’ Z such
that
hua1 ub2 uc3 , 1i = âˆ’Ï•(Îµa )Ï•(Îµb)Ï•(Îµc ) âˆ’ Ï•(Îµâˆ’a )Ï•(Îµâˆ’b )Ï•(Îµâˆ’c ).
For any r âˆˆ Z[G] we have hrx, yi = hx, rÌ„yi, where r 7â†’ rÌ„ is the automorphism of
the abelian group Z[G] that sends g to g âˆ’1 for any g âˆˆ G.
Proof. This is obtain by a straightforward calculation from (17). The last statement
follows from G-invariance of the form. 
We write E = Q(Âµd ). It is well known that Gal(E/Q) âˆ¼
= (Z/d)Ã— .
b = Hom(G, CÃ— ) âˆ¼
Let G
= (Z/d)3 be the group of characters. Write Ï‡(ua1 ub2 uc3 ) =
Îµla+mb+nc , where l, m, n are elements of {0, . . . , d âˆ’ 1}. Then
M
E[G] = E[u1 , u2 , u3 ]/(udi âˆ’ 1) =
VÏ‡
b
Ï‡âˆˆG

is a direct sum of 1-dimensional eigenspaces VÏ‡ generated by the orthogonal idempotents
dâˆ’1

Î±Ï‡ = Î±l (u1 )Î±m (u2)Î±n (u3 ) âˆˆ E[G],

1 X âˆ’ij j
where Î±i (u) =
Îµ u.
d j=0

Indeed, one readily checks that Î±Ï‡ is an eigenvector with eigenvalue Ï‡:
[g]Î±Ï‡ = Ï‡(g)Î±Ï‡

for any g âˆˆ G,

(19)

where we write [g] for the natural action of G on E[G]. Hence Î±Ï‡ Î±Ï† is a multiple of
Î´Ï‡,Ï† , where Î´ is the Kronecker delta. Our normalisation is such that Î±Ï‡2 = Î±Ï‡ .
17

b we have hÎ±Ï‡ , Î±Ï† i = 0 if Ï† 6= Ï‡âˆ’1 , and
Corollary 2.5 For any Ï‡, Ï† âˆˆ G
hÎ±Ï‡ , Î±Ï‡âˆ’1 i = hÎ±Ï‡2 , 1i = hÎ±Ï‡ , 1i = âˆ’


2
Re (1 âˆ’ Îµl )(1 âˆ’ Îµm )(1 âˆ’ Îµn ) .
3
d

(20)

Proof. This follows directly from Proposition 2.4. 

We note that IE = I âŠ— E is the direct sum of the spaces VÏ‡ such that Ï‡ restricts
trivially to any of the three coordinates Âµd âŠ‚ G (that is, l = 0 or m = 0 or
n = 0) or to the diagonal Âµd âŠ‚ G (that is, l + m + n is divisible by d). Let us
b In other words, S is the set of triples
denote by S the complement to this set in G.
(l, m, n) âˆˆ {1, . . . , d âˆ’ 1}3 such that l + m + n is not divisible by d. Then
M
P âŠ—E =
VÏ‡ ,
Ï‡âˆˆS

so that the rank of P is |S|. For d = 2, 3, 4 we have |S| = 1, 6, 21, respectively.
b = Hom(G, E Ã— ) via its natural action
The group Gal(E/Q) âˆ¼
= (Z/d)Ã— acts on G
b
on E, which raises Îµ to powers coprime to d. Note that this action preserves S âŠ‚ G.
For Ïƒ âˆˆ Gal(E/Q) we have hÎ±Ï‡ , Î±Ï† i = hÎ±Ïƒ(Ï‡) , Î±Ïƒ(Ï†) i.

2.3

Hodge decomposition

The Hodge decomposition P âŠ— C = P 1,âˆ’1 âŠ• P 0,0 âŠ• P âˆ’1,1 can
as follows.

 be described
âˆ’
1.
Note
that q
Let q be the function S â†’ {âˆ’1, 0, 1} given by q(Ï‡) = l+m+n
d
depends on the choice of Îµ.
Lemma 2.6 The Hodge subspace P p,q âŠ‚ P âŠ— C = P 2 (FC , C(1)) is the direct sum of
VÏ‡ âŠ—E C for Ï‡ âˆˆ S such that q(Ï‡) = q.
Proof. This is [Sh79, Thm. I]. For a proof see [ABB13, Prop. 2.7] based on [Lo10]. 
In particular, the C-vector space P p,q comes from the E-vector space âŠ•q(Ï‡)=q VÏ‡ .
Let Sâ™¯ âŠ‚ S be the union of the Gal(E/Q)-orbits in S that contain an element
Ï‡ with q(Ï‡) 6= 0. Since Gal(E/Q) contains complex conjugation, this condition is
equivalent to the existence of Ï‡ such that q(Ï‡) = 1.
The transcendental lattice T (FC ) is the smallest saturated sublattice of P such
that P 1,âˆ’1 âŠ‚ T (FC ) âŠ— C. Thus T (FC ) = P âˆ© (T (FC ) âŠ— Q), where T (FC ) âŠ— Q is the
smallest Q-vector space V such that âŠ•q(Ï‡)=1 VÏ‡ âŠ‚ V âŠ— E. It is clear that T (FC ) âŠ— E
is the direct sum of VÏ‡ for Ï‡ âˆˆ Sâ™¯ .
Lemma 2.7 The action of Ï„ (1) on the E-vector space P âŠ— E is anti-linear and
b
preserves the Hodge decomposition. We have Ï„ (1)(Î±Ï‡ ) = Î±Ï‡ for every Ï‡ âˆˆ G.
18

Proof. We have seen that the action of Ï„ (1) on H2 (FC , C(1)) is anti-linear, hence
the action on P âŠ— E âŠ‚ H2 (FC , C(1)) is also anti-linear. The generator 2Ï€ieâ€² of P is
fixed by Ï„ (1), see (18). We have Ï„ (1)[g] = [g âˆ’1]Ï„ (1) for g âˆˆ G and Ï„ (1)Îµ = Îµâˆ’1 Ï„ (1),
thus Ï„ (Î±Ï‡ ) = Î±Ï‡ . 
That Ï„ (1) is anti-linear and preserves the Hodge decomposition is a general fact.
In Deligneâ€™s notation Ï„ = Fâˆ , but Fâˆ (Hp,q ) = Hq,p by [Del79, 0.2.5]. Our Ï„ (1) is
the composition of Fâˆ with the complex conjugation of the coefficients C, hence
Ï„ (1)(Hp,q ) = Hp,q , see [Del79, Prop. 1.4, Cor. 1.6].

2.4

Recovering full cohomology from primitive cohomology

As was noted in Section 2.2, we have H = ZÎ› âŠ• P , where Î› âˆˆ H is the class of a line
in FC . Let c = L âˆ’ dÎ› âˆˆ P , where L is the hyperplane section class. Then H is the
subgroup of QL âŠ• (P âŠ— Q) generated by ZL âŠ• P and d1 (L âˆ’ c). We have hL, Li = d,
and Proposition 2.4 explicitly describes the restriction of the cup-product form to
P . Thus, in order to recover the full cohomology group H = H2 (FC , Z(1)) as a
G-module together with its unimodular G-invariant cup-product bilinear form from
the G-module P and the restriction of the cup-product form to P , it is enough to
find a formula for c. This can be done using calculations of intersection indices from
the paper of A. Degtyarev and I. Shimada [DS16]. Recall that Ï†(x) and Ï(x, y) were
introduced in (16). It is immediate to check that in the ring Z[x, y]/(xd âˆ’ 1, y d âˆ’ 1)
we have the identity [DS16, Lemma 4.5]
(1 âˆ’ y)Ï†(xy) = (1 âˆ’ x)(1 âˆ’ y)Ï(x, y).
Since 1âˆ’x is a unit in Q[x]/(Ï†(x)), in the ring Rx âŠ—Ry we have Ï†(xy) = (1âˆ’x)Ï(x, y).
Proposition 2.8 Write u0 = (u1 u2 u3 )âˆ’1 so that u0 u1 u2u3 = 1. Define
c = (1 âˆ’ u0 )âˆ’1 Ï†(u0 u1) Â· (1 âˆ’ u2 )âˆ’1 Ï†(u2 u3 ) = Ï(u0 , u1 )Ï(u2 , u3) âˆˆ P.
Then 1d (L âˆ’ c) is the class of the line in FC given by x1 = Î¶2d x0 , x3 = Î¶2d x2 . The
group H âŠ‚ QL âŠ• (P âŠ— Q) is generated by ZL âŠ• P and 1d (L âˆ’ c).
Proof. Let Î› âˆˆ H be the class of this line. The lattice H is non-degenerate, so it
suffices to show that the images of d1 (L âˆ’ c) and Î› in H âˆ— âŠ‚ (ZL)âˆ— âŠ• P âˆ— coincide.
The images of these elements in (ZL)âˆ— are equal, so it remains to show that they
are equal in P âˆ—.
The G-module isomorphism P âˆ¼
= Z[G]/I gives rise to the map which evaluates
the linear function given by the cup-product with x âˆˆ H on the elements of G:
X
ev : H âˆ’â†’ P âˆ— âˆ’â†’ Z[G],
ev(x) =
hx, gig
gâˆˆG

19

By [DS16, p. 989], we have ev(Î›) = Ïˆ, where Ïˆ = (1 âˆ’ u1 )(1 âˆ’ u3)Ï†(u2 u3 ). It is
clear that ev(L) = 0, so it remains to show that ev(c) = âˆ’dÏˆ. For h âˆˆ G, we find
using the G-invariance of the cup-product pairing that
X
X
X
ev(h) =
hh, gig =
h1, hâˆ’1gig =
h1, gigh = ev(1)h.
gâˆˆG

gâˆˆG

gâˆˆG

We have ev(1) = (e|e) = âˆ’(1 âˆ’ u0 )(1 âˆ’ u1 )(1 âˆ’ u2 )(1 âˆ’ u3 ), by (17). Hence, we get
âˆ’ev(c) = (1 âˆ’ u0 )(1 âˆ’ u1 )(1 âˆ’ u2 )(1 âˆ’ u3 )Ï(u0 , u1)Ï(u2 , u3)
= (1 âˆ’ u1 )(1 âˆ’ u3 )Ï†(u0u1 )Ï†(u2 u3 )
= (1 âˆ’ u1 )(1 âˆ’ u3 )Ï†(u2u3 )2
= (1 âˆ’ u1 )(1 âˆ’ u3 )dÏ†(u2u3 ) = dÏˆ. 

2.5

Galois representation over the cyclotomic field

Let â„“ be a prime number. Using the comparison theorem of classical and â„“-adic eÌtale
cohomology, we obtain a G-module isomorphism
Pâ„“ := P âŠ— Zâ„“ = P 2 (F , Zâ„“ (1)) âˆ¼
= Zâ„“ [G]/(I âŠ— Zâ„“ ),
where P 2 (F , Zâ„“ (1)) âŠ‚ H2eÌt (F , Zâ„“ (1)) is the orthogonal complement to the hyperplane
section class. Since Tâ„“ := T (FC ) âŠ— Zâ„“ is the orthogonal complement to the subgroup
generated by the classes of divisors in Pâ„“ , the Galois group Î“ acts on Tâ„“ .
Let us assume that the ground field k contains E = Q(Âµd ). Then the action of
Î“ = Gal(k/k) on P 2 (F , Zâ„“ (1)) commutes with the action of G.
Let Î» be a prime of E above â„“. Let OÎ» be the ring of integers of EÎ» . The EÎ» -vector
space P âŠ— EÎ» is the direct sum of the 1-dimensional G-eigenspaces VÏ‡ âŠ—E EÎ» , where
Ï‡ âˆˆ S, which are therefore preserved by the Galois group Î“. We have
M
VÏ‡ âŠ—E EÎ» .
T (FC ) âŠ— EÎ» =
Ï‡âˆˆSâ™¯

Let Ok be the ring of integers of k. Let p âŠ‚ Ok be a prime ideal coprime to dâ„“,
and let Fp = Ok /p. Let p = char(Fp ). For x âˆˆ FÃ—
p let Ïˆ(x) be the unique d-th root
(N (p)âˆ’1)/d
of unity in E âŠ‚ k whose reduction in Fp equals x
, where N(p) = |Fp |. Thus
Ã—
Ïˆ : Fp â†’ Âµd is a multiplicative character of order d. The Gauss sum g(r) âˆˆ Q(Îµ, Î¶)
is
X
Ïˆ(x)r Î¶ TrFp /Fp (x) ,
r = 0, . . . , d âˆ’ 1,
g(r) =
xâˆˆFÃ—
p

where Î¶ is a primitive p-th root of unity in C. We have g(0) = 0, g(r) = Ïˆ(âˆ’1)g(âˆ’r)
and |g(r)|2 = N(p). Note that Ïˆ(âˆ’1) = 1 if d is odd or both d and (N(p) âˆ’ 1)/d
20

are even; if d is even and (N(p) âˆ’ 1)/d is odd, then Ïˆ(âˆ’1) = âˆ’1, see [LN97, Â§5.2]
or [IR90, Â§10.3].
The Jacobi sum J(Ï‡) is an element of the ring of integers OE = Z[Îµ] defined by
J(Ï‡) =

X

x1 +x2 +x3 =1

Ïˆ(x1 )l Ïˆ(x2 )m Ïˆ(x3 )n =

g(l)g(m)g(n)
g(l)g(m)g(n)g(r)
= Ïˆ(âˆ’1)
,
g(l + m + n)
N(p)



d. The second
where x1 , x2 , x3 âˆˆ Fp . The integer r satisfies l + m + n + r = l+m+n
d
equality here is [LN97, Thm. 5.21], and the third one follows from the properties of
Gauss sums discussed above, cf. [IR90, Ch. 8, Thm. 3].
The following proposition can be found in D. Ulmerâ€™s paper [Ulm02], though it
goes back to N. Katz and T. Shioda. We give a simpler proof using the Fourier
transform on the finite abelian group G.
Proposition 2.9 Let Î» be a prime of E = Q(Âµd ) above â„“. Let p be a prime of k
not dividing dâ„“. Then Frobp acts on VÏ‡ âŠ—E EÎ» , where Ï‡ âˆˆ S, as multiplication by
Ïˆ(âˆ’1)N(p)âˆ’1 J(Ï‡) âˆˆ N(p)âˆ’1 OE âŠ‚ E.
Before giving a proof we explain how the Galois representation attached to an
arbitrary diagonal surface can be obtained from the Galois representation attached
to the Fermat surface.
Remark 2.10 Let K be a subfield of C. For a = (a1 , a2 , a3 ) âˆˆ (K Ã— )3 we write
X = Xa for the surface in P3K given by
xd0 + a1 xd1 + a2 xd2 + a3 xd3 = 0.
In particular, the Fermat surface F = X(1,1,1) . The surface Xa is obtained by
twisting F over K by a 1-cocycle of Gal(K/K) with values in the group K-scheme
G = (Âµd )3 , whose class in H1 (K, G) âˆ¼
= (K Ã— /K Ã—d )3 is the image of a = (a1 , a2 , a3 )
under the natural coordinate-wise map (K Ã— )3 â†’ (K Ã— /K Ã—d )3 . The Gal(K/K)modules Pic(X a ) and Tâ„“ (Xa,C ) are obtained from the Gal(K/K)-modules Pic(F ) and
Tâ„“ (FC ), respectively, by twisting them by this cocycle with respect to the relevant
induced actions of G. If E âŠ‚ K, then the action of Gal(K/K) commutes with the
action of G, so Gal(K/K) preserves the eigenspaces VÏ‡ âŠ—E EÎ» . In the case of Xa ,
the action of Gal(K/K) on VÏ‡ âŠ—E EÎ» is the same as the action in the case of F
followed by multiplication by the inverse of the d-power character Gal(K/K) â†’ Âµd
n
associated to al1 am
2 a3 , where Ï‡ = (l, m, n).
Proof of Proposition 2.9. For Ï‡ = (l, m, n) âˆˆ S let h(Ï‡) âˆˆ EÎ» be the eigenvalue of
b is not in S, then we set h(Ï‡) = 0.
Frobp on VÏ‡ âŠ— EÎ» . If Ï‡ âˆˆ G
21

Let a = (a1 , a2 , a3 ) âˆˆ G. The multiplicative character Ïˆ defines an isomorphism
Ã—
Fp /FÃ—d
Ëœ d . Pick any lifting aÌƒi âˆˆ FÃ—
p âˆ’â†’Âµ
p of ai , for i = 1, 2, 3, and consider the surface
in Xa âŠ‚ P3Fp with equation
xd + aÌƒ1 xd1 + aÌƒ2 xd2 + aÌƒ3 xd3 = 0.
Since G acts on VÏ‡ via Ï‡, the twisted action of Frobp on VÏ‡ âŠ— EÎ» , i.e. the action
defined by the action of the Galois group Î“ on P 2 (X a , EÎ» (1)), is via multiplication by h(Ï‡)/Ïˆ(aÌƒ1 )l Ïˆ(aÌƒ2 )m Ïˆ(aÌƒ3 )n . Hence, by the Lefschetz trace formula, we have
|Xa (Fp )| = |P2 (Fp )| + f (a)N(p), where
X
X
n âˆ’1
f (a) =
Ïˆ(aÌƒl1 aÌƒm
aÌƒ
)
h(Ï‡)
=
Ï‡(âˆ’a)h(Ï‡).
2 3
b
Ï‡âˆˆG

b
Ï‡âˆˆG

Weilâ€™s classical calculation with exponential sums [Wei49], [LN97] gives that this
also holds when h(Ï‡) is replaced by g(Ï‡) = Ïˆ(âˆ’1)J(Ï‡)N(p)âˆ’1 for Ï‡ âˆˆ S and by
g(Ï‡) = 0 for Ï‡ âˆˆ
/ S. Thus f is the Fourier transform of either h or g. The inverse
Fourier transform now gives
X
h(Ï‡) = dâˆ’3
Ï‡(a)f (a) = g(Ï‡).

aâˆˆG

3

The Fermat quartic surface

From now on let d = 4. In this section we let k = E = Q(i) and O = Z[i]. For a
number field K âŠ‚ Q we write Î“K = Gal(Q/K).

3.1

Explicit transcendental lattice

By definition, the transcendental lattice T (FC ) is the smallest saturated Z-submodule
of P whose complexification contains P 1,âˆ’1. Thus we have
T (FC ) = P âˆ© (V(1,1,1) âŠ• V(3,3,3) ) âŠ‚ P âŠ— k.
Lemma 3.1 We have T (FC ) = Zw1 âŠ• Zw2 , where
w1 = 8(Î±(1,1,1) + Î±(3,3,3) ),

w2 = 8i(Î±(1,1,1) âˆ’ Î±(3,3,3) ).

We have
hw1 , w1 i = hw2 , w2 i = 8,

hw1 , w2 i = 0.

(21)

Proof. It is clear that w1 , w2 is a basis of T (FC ) âŠ— Q. One immediately obtains
(21) from (20). Recall that 26 Î±(1,1,1) is the sum of iâˆ’(a+b+c) ua1 ub2 uc3 , where a, b, c âˆˆ
{0, 1, 2, 3}. We calculate
h2

6

Î±(1,1,1) , uÎ±1 uÎ²2 uÎ³3 i

=

3
X

a,b,c=0

câˆ’Î³
âˆ’(Î±+Î²+Î³)
,
iâˆ’(a+b+c) huaâˆ’Î±
ubâˆ’Î²
2 u3 , 1i = 4i
1

22

hence hw1 , uÎ±1 uÎ²2 uÎ³3 i = Re(iâˆ’(Î±+Î²+Î³) ) and hw2 , uÎ±1 uÎ²2 uÎ³3 i = âˆ’Im(iâˆ’(Î±+Î²+Î³) ). This implies that if sw1 + tw2 âˆˆ H for some s, t âˆˆ Q, then s, t âˆˆ Z. This also implies
hwi , P i = Z. Recall that H = P âŠ• ZÎ›, where Î› is the class of a line in FC . Since
wi âˆˆ T (FC ) âŠ— Q, we have hwi , Î›i = 0 for i = 1, 2, hence hwi , Hi = Z. This
implies wi âˆˆ H âˆ— = H by the unimodularity of H. This finishes the proof that
T (FC ) = Zw1 âŠ• Zw2 . 
This lemma implies that âˆ† â‰ƒ (Z/8)2 , as was already discovered in [PS71].
Let Âµ4 be one of the factors of G = (Âµ4 )3 . In other words, choose one of x1 , x2 , x3 ,
say x3 , and multiply x3 by fourth roots of unity. Let us write the induced action
of u âˆˆ Âµ4 on P as [u]. Extending the coefficients, this gives rise to a k-linear
action of Âµ4 on P âŠ— k. By (19) we then have [i]Î±(l,m,n) = in Î±(l,m,n) . In particular,
[i]Î±(1,1,1) = iÎ±(1,1,1) and [i]Î±(3,3,3) = âˆ’iÎ±(3,3,3) . (Note that these formulae will be the
same if we consider the action of Âµ4 on x1 or x2 instead of x3 .) Hence we obtain that
[i] acts on T (FC ) by the rule [i]w1 = w2 , [i]w2 = âˆ’w1 . This gives an isomorphism
of O-modules, where O = Z[i]:
T (FC ) âˆ¼
(22)
= O.
The isomorphism is unique up to the multiplication by an element of Âµ4 ; we fix the
isomorphism by identifying 1 âˆˆ O with w1 . The cup-product form on T (FC ) then
becomes hx, yi = 4Trk/Q (xy).
Ëœ (FC )âˆ— .
The normalised cup-product form 18 hx, yi induces an isomorphism T (FC )âˆ’â†’T
By the compatibility between classical and â„“-adic eÌtale cohomology, for any prime â„“
the normalised cup-product in â„“-adic eÌtale cohomology 81 hx, yiâ„“ gives an isomorphism
of Î“-modules
T (X)â„“ âˆ¼
Ëœ (FC )âˆ— âŠ— Zâ„“ ,
= T (FC ) âŠ— Zâ„“ âˆ’â†’T
cf. Section 1.1. Thus from (7) and (8) we obtain isomorphisms of Î“-modules
T (XC ) âŠ— Q/Z âˆ¼
= Br(X)[â„“m ],
= Br(X) and T (XC )/â„“m âˆ¼
for any prime â„“ and any positive integer m. Since T (FC )âˆ— =
sequence (9) becomes the exact sequence of Î“-modules
[8]

0 âˆ’â†’ Br(F )[8] âˆ’â†’ Br(F ) âˆ’â†’ Br(F ) âˆ’â†’ 0.

3.2

1
T (FC ),
8

(23)
the exact

(24)

Explicit Galois representation

Let â„“ be a prime number and let Î» be a prime of k = Q(i) above â„“. Let p be a prime
of k not dividing 2â„“. The principal ideal p âŠ‚ O has a unique generator Ï€ which is a
primary prime Ï€ â‰¡ 1 mod (1 + i)3 . (Note that this works both in the split and the
inert cases.)
Pinch and Swinnerton-Dyer [PSD91], using Weil [Wei49, Wei52] who relied on
Stickelberger, computed the eigenvalues of Frobp acting on P 2 (F , kÎ» (1)) = P âŠ— kÎ» ,
23

where F is the quartic Fermat surface. The Galois group Î“k commutes with G, hence
the representation of Î“k in P âŠ— kÎ» attached to F is a direct sum of 1-dimensional
representations VÏ‡ âŠ— kÎ» described in Proposition
2.9. For d = 4 the multiplicative

x
character Ïˆ(x) is the biquadratic residue Ï€ 4 .
b by 4-tuples of integers
Below, for symmetry reasons, we represent characters Ï‡ âˆˆ G
(l, m, n, r) âˆˆ {1, 2, 3}4 with sum divisible by 4.

â€¢ Ï‡ = (1, 1, 1, 1). By Lemma 2.6 we have P 1,âˆ’1 = V(1,1,1,1) âŠ—k C. By Proposition 2.9 and the quartic Jacobi sum calculation [IR90, Prop. 9.9.5], the representation of Î“k in V(1,1,1,1) âŠ—k kÎ» sends Frobp to Ï€/Ï€. (In the inert case this
equals 1.)

â€¢ Ï‡ = (3, 3, 3, 3). We have P âˆ’1,1 = P 1,âˆ’1 = V(3,3,3,3) âŠ—k C, so the representation
of Î“k in V(3,3,3,3) âŠ—k kÎ» is conjugate to the representation of Î“k in V(1,1,1,1) âŠ—k kÎ» .
â€¢ The spaces VÏ‡ for all other characters belong to P 0,0 . The space V(2,2,2,2) is
defined over Q. There are six spaces like V(1,1,3,3) (obtained by permuting the
coordinates of Ï‡) that come in conjugate pairs. The action of Î“k on all of
these spaces is trivial. Finally, there are twelve spaces like V(1,2,2,3) ; the action
of Frobp on them is via multiplication by Ïˆ(âˆ’1). In particular, we recover the
known fact that Î“Q(Âµ8 ) acts trivially on Pic(F ).
It is more delicate to make explicit the Galois representation over Q. In the case
d = 4 we use the fact that Î“Q is the semi-direct product of Î“k and Gal(C/R) âˆ¼
=
âˆ¼
Gal(Q/(Q âˆ© R)) = Z/2.
For odd primes â„“ the following statement was obtained in [IS15] by a different
method (see the proof of [IS15, Lemma 4.2]).
Proposition 3.2 The representation of Î“Q = Î“k â‹Š Gal(Q/Q âˆ© R) in T (FC ) âŠ— Zâ„“ âˆ¼
=
O âŠ— Zâ„“ is as follows:
if p is coprime to 2â„“, then Frobp âˆˆ Î“k acts as multiplication by Ï€/Ï€ where Ï€ is a
primary generator of p;
the generator of Gal(Q/Q âˆ© R) acts on T (FC ) as Ï„ (1), namely, Ï„ (1)(w1 ) = w1 ,
Ï„ (1)(w2 ) = âˆ’w2 , i.e., as the usual conjugation of O.
Proof. Recall that T (FC ) = Zw1 âŠ• Zw2 was made into an O-module using the
action of [i] which sends w1 to w2 and w2 to âˆ’w1 . We know that on (O âŠ— Zâ„“ )Î±(1,1,1)
the Frobenius element Frobp , where p is coprime to 2â„“, acts as multiplication by
Ï€/Ï€ âˆˆ (O âŠ— Zâ„“ )âˆ— . One then immediately checks that Frobp acts on T (XC ) âŠ— Zâ„“ =
Zâ„“ w1 âŠ• Zâ„“ w2 as the (2 Ã— 2)-matrix given by multiplication by Ï€/Ï€ on O âŠ— Zâ„“ .
Let us prove the second statement. We have comparison isomorphisms
2
2
H2 (F (C), Z/â„“n )âˆ’â†’H
Ëœ eÌt
(FC , Z/â„“n )âˆ’â†’H
Ëœ eÌt
(F , Z/â„“n )

24

which are functorial with respect to the action of Gal(C/R) = Gal(Q/(Q âˆ© R)).
Thus the action of Gal(C/R) on H2 (F (C), Z) induced by the complex conjugation
of F (C), that is, the action sending the generator of Gal(C/R) to Ï„ , is compatible
2
with the representation of Gal(Q/(Q âˆ© R)) in HeÌt
(F , Zâ„“ ), cf. [Del79, 0.3]. It follows
2
that the representation of Gal(Q/(Q âˆ© R)) in HeÌt (F , Zâ„“ (1)) sends the generator to
2
Ï„ (1). The representation of Gal(Q/(Q âˆ© R)) in T (FC ) âŠ— Zâ„“ âŠ‚ HeÌt
(F , Zâ„“ (1)) extends
2
to T (FC ) âŠ— kÎ» âŠ‚ HeÌt (F , kÎ» (1)). The k-vector space T (FC ) âŠ— k has basis Î±(1,1,1) and
Î±(3,3,3) , which are fixed by Ï„ (1), see Lemma 2.7. From this we obtain the action of
Ï„ (1) on w1 and w2 . 
Proposition 3.3 (i) The Î“k -invariant subgroup of Br(F ){2} is Br(F )[4].
(ii) The Î“k(âˆš2) -invariant subgroup of Br(F ){2} is Br(F )[8].
âˆš
âˆš
4
(iii) We have k( 4 2) = k( 4 âˆ’2). The Î“k( âˆš
âˆ’2) -invariant subgroup of Br(F ){2} is
Br(F )[16].
(iv) The Î“k( âˆš8 âˆ’2) -invariant subgroup of Br(F ){2} is Br(F )[32].
Proof. (i) By (22) and (23) there is an isomorphism of Î“k -modules Br(F )[2m ] =
O/2m for each m â‰¥ 1. We have Ï€ = a + bi, where a is odd and b is even. Hence
Ï€ â‰¡ Ï€ mod 4. From the explicit description of the Galois action in Proposition 3.2
we see that Î“k acts trivially on Br(F )[4]. To finish the proof of (i) it is enough to
show that each element of O/8 fixed by Î“k is divisible by 2. One easily checks that
if x + iy âˆˆ O is fixed modulo 8 by FrobÏ€ , where Ï€ = âˆ’1 + 2i, then x and y are even.
(ii) A supplement to the quadratic reciprocity law states that 2 is a square modulo
a prime p â‰¡ 1 mod 4 precisely when p â‰¡ 1 mod 8. Write p = N(Ï€), where Ï€ is a
primary prime in O. Since Z/pâˆ’â†’O/Ï€,
Ëœ
we see that 2 is a square modulo Ï€ if
and only if p â‰¡ 1 mod 8, that is, if and only if 4 divides b, that is, if and only
if Ï€ â‰¡ Ï€ mod 8. This shows that Î“k(âˆš2) acts trivially on Br(F )[8]. The same
calculation as in (i) shows that if x + iy âˆˆ O is fixed modulo 16 by FrobÏ€ , where
Ï€ = 1 + 4i, then x and y are even.
(iii) A supplement to the biquadratic reciprocity law [Cox89, Thm. 4.23], [Lem00,
Thm. 6.9] states that 2 is the fourth power modulo Ï€ if and only if 8 divides b,
that is, if and only if Ï€ â‰¡ Ï€ mod 16. The same calculation as in (i) shows that if
x + iy âˆˆ O is fixed modulo 32 by FrobÏ€ , where Ï€ = 5 + 8i, then x and y are even.
(iv) A supplement to the octic reciprocity law [Wes11, II.12] states that for Ï€Ï€ =
p â‰¡ 1 mod 8 with 8 | b, 2 is an eighth power modulo Ï€ if and only if b â‰¡ p âˆ’ 1 â‰¡
0 mod 16 or b â‰¡ p âˆ’ 1 â‰¡ 8 mod 16 and âˆ’1 is an eighth power modulo Ï€ if and only if
p âˆ’1 â‰¡ 0 mod 16. Thus âˆ’2 is an eighth power modulo Ï€ if and only if b â‰¡ 0 mod 16,
that is Ï€ â‰¡ Ï€ mod 32. The same calculation as in (i) shows that if x + iy âˆˆ O is
fixed modulo 64 by FrobÏ€ , where Ï€ = 1 + 16i, then x and y are even. 
Remark 3.4 The invariant subfield of the kernel of the Galois action on Br(F )[2n ]
is the ring class field of k = Q(i) of conductor 2nâˆ’1 . This follows from the definition:
25

Kc /K is the abelian extension of K corresponding to the class group IK (c)/PK,Z;
in other words, precisely the primes congruent to an element of Z modulo c split
in Kc . Indeed, FrobÏ€ acts on O/2n trivially if and only if Ï€ â‰¡ Ï€ mod 2n , which is
equivalent toâˆšthe divisibility of b by 2nâˆ’1 . See [Cox89, p. 179]. For the calculation
Q(i)8 = Q(i, 4 2), see [Cox89, Prop. 9.5].
We now reprove a result of Ieronymou [Ier10, Thm. 4.2]. Recall that if K1 âŠ‚ K2
are algebraically closed fields of characteristic zero, and X is a smooth and proper
variety over K1 , then the induced map Br(X) â†’ Br(X Ã—K1 K2 ) is an isomorphism.
Thus we can use the notation Br(F ) without specifying the underlying algebraically
close field.
Since F is defined over Q, from the exact sequence (24) we obtain the exact
sequence of Î“Q -modules
[2]

0 âˆ’â†’ O/8 âˆ’â†’ O/16 âˆ’â†’ O/2 = Br(F )[2] âˆ’â†’ 0.

(25)

The following corollary should be compared to Ieronymouâ€™s results [Ier10, Thm.
3.1, Prop. 4.9].
Corollary
3.5 Let F be the Fermat quartic surface. Let K be a field extension of
âˆš
4
Q(i, 2). Then the natural map Br(FK )[2] â†’ Br(F )[2] is surjective.

âˆš
Proof. It is enough to prove this for K = Q(i, 4 2). The Fermat quartic surface
has obvious rational points over Q(Âµ8 ); pick one of them and call it P . We can
write Br(FK ) = Br(K) âŠ• Br(FK )P , where Br(FK )P âŠ‚ Br(FK ) consists of the classes
vanishing at P . Since Î“K = Gal(Q/K) acts trivially on Pic(F ) â‰ƒ Z20 , we have
H1 (K, Pic(F )) = 0. The standard spectral sequence then shows that the canonical
map Br(FK ) â†’ Br(F ) restricted to Br(FK )P is an injective map Br(FK )P Ö’â†’ Br(F ).
It follows that an element of Br(F )[2] which can be lifted to an element of Br(FK ),
can also be lifted to an element of Br(FK )[2]P âŠ‚ Br(FK )[2].
It remains to show that Br(F )[2] is contained in the image of Br(FK ) in Br(F ).
By Proposition 3.3 (iii) the abelian groups in (25) are trivial Î“K -modules. It follows
that âˆ‚1 (Br(F )[2]) = 0, so we can conclude by applying Corollary 1.5. 

3.3

Diagonal quartic surfaces

We start with a general observation about arbitrary diagonal quartic surfaces (proved
in [Sko17, Prop. 4.8] by a different method).
Proposition 3.6 Let X = Xa be a diagonal quartic surface over a field K of characteristic zero. We have âˆ†X [2]Gal(K/K) 6= 0, hence Br(X)[2]Gal(K/K) 6= 0.
26

Proof. Without loss of generality we assume that K = Q(a1 , a2 , a3 ); in particular, K
can be embedded into C. Then we have a canonical isomorphism Pic(X) âˆ¼
= Pic(XC ).
We construct an explicit Gal(K/K)-invariant 2-torsion element in âˆ†X using the
canonical isomorphism of Gal(K/K)-modules âˆ†X âˆ¼
= Pic(X)âˆ— /Pic(X). The snake
lemma shows that the Gal(K/K)-module âˆ†X [2] is canonically isomorphic to the
kernel of the map Pic(X)/2 â†’ Pic(X)âˆ— /2 given by the intersection pairing. Thus it
is enough to exhibit a divisor class D âˆˆ Pic(X) with the following properties:
(a) hD, xi âˆˆ 2Z for every x âˆˆ Pic(X);
(b) the class of D in Pic(X)/2 is Gal(K/K)-invariant;
(c) the class of D in Pic(X)/2 is not zero.
Consider the surjective morphism s : X â†’ Q, where Q is the diagonal quadric
y02 + a1 y12 + a2 y22 + a3 y32 = 0,

and s (x0 : x1 : x2 : x3 ) = (x20 : x21 : x22 : x23 ). There are two families of lines
on Q defined over K. Let fÂ± âˆˆ Pic(Q) be the classes of these families, and let
DÂ± = sâˆ— (fÂ± ). It is clear that the set {D+ , Dâˆ’ } âŠ‚ Pic(X) is Gal(K/K)-invariant.
Let us show that we can take D to be either of D+ and Dâˆ’ . Indeed, the inverse
images of the two families of lines in Q are pencils of genus 1 curves on F such that
D+ + Dâˆ’ = 2L, where L is the hyperplane section class. It is well known and easy
to check that each of the 48 lines on X is a component of a degenerate fibre of one
of these families. Thus for any line â„“ âŠ‚ X we have either hâ„“, D+ i = 0 or hâ„“, D+ i = 2.
Since Pic(X) is generated by lines, we get hD+ , xi âˆˆ 2Z for every x âˆˆ Pic(X). By
the formula D+ + Dâˆ’ = 2L, the same holds for Dâˆ’ . This gives (a) and (b).
The class of an integral curve of arithmetic genus 1 on a complex K3 surface XC
is primitive in Pic(XC ) = Pic(X) [Huy16, Ch. 2, Rem. 3.13 (i)]. This gives (c). 
Definition 3.7 Let X be a diagonal surface over a field K. We say that X is split
by a field extension L/K if XL âˆ¼
= FL .
Theorem 3.8 Let X be a diagonal quartic surface over a field
âˆš K containing k =
Q(i), which is split by a field extension of K not containing 4 2. Then
Br(X)[2] âˆ© Im[Br(X) â†’ Br(X)] = 0.
Proof. To prove that this intersection is âˆš
zero we can enlarge the field
K. So we
âˆš
4
can assume that K contains Q(Âµ8 ) = k( 2) but does not contain 2, and that
X â‰ƒ FK . The group Gal(K/K)
âˆš acts on the terms of the exact sequence (25) via the
map Gal(K/K) â†’ Gal(Q/k( 2)) = Î“k(âˆš2) . By Proposition 3.3 (iii), Î“k(âˆš2) acts via
âˆš
âˆš
âˆš
the surjective map Î“k(âˆš2) â†’ Gal(k( 4 2)/k( 2)). Since K and k( 4 2) are linearly
âˆš
disjoint over k( 2), the following map is surjective:
âˆš
âˆš
âˆš
4
4
Gal(K/K) â†’ Gal(K( 2)/K) âˆ¼
= Gal(k( 2)/k( 2)) âˆ¼
= Z/2.
27

Proposition 3.3 (ii) says that the Î“k(âˆš2) -invariant subgroup of O/16 is 2O/16, which
is exactly the kernel of O/16 â†’ O/2. Hence this is also the Gal(K/K)-invariant
subgroup of O/16. This implies that âˆ‚1 induces an injective map
âˆ‚1 : Br(F )[2]Î“K = O/2 âˆ’â†’ H1 (K, âˆ†F ) = H1 (K, O/8).
We claim thatâˆšin our situation âˆ‚2 : H1 (K, âˆ†F ) â†’ H2 (K, Pic(F )) is injective. Indeed, since k( 2) = Q(Âµ8 ) is contained in K, and Î“Q(Âµ8 ) acts trivially on Pic(F ),
the group Gal(K/K) acts trivially on Pic(F ), and hence also on Pic(F )âˆ— . Thus
H1 (K, Pic(F )âˆ— ) = 0, so that âˆ‚2 is indeed injective. We have proved that âˆ‚2 âˆ‚1 is
injective on Br(F )[2], so by Corollary 1.5 the intersection of Br(F )[2] and the image
of Br(FK ) in Br(F ) is zero. 
The following result shows that for any diagonal quartic surface over Q or k = Q(i)
the Galois-invariant subgroup of Br(X) is annihilated by 4.
Proposition 3.9 Let X = Xa be a diagonal quartic surface over Q.
(i) If a1 a2 a3 âˆˆ k Ã—4 , then the Î“k -invariant subgroup of Br(X){2} is Br(X)[4].
(ii) If a1 a2 a3 âˆˆ QÃ—4 , then the Î“Q -invariant subgroup of Br(X){2} is 41 (Z+2iZ)/O.
If a1 a2 a3 âˆˆ âˆ’4QÃ—4 , then the Î“Q -invariant subgroup of Br(X){2} is 41 (1 âˆ’ i)Z/Z.
(iii) If a1 a2 a3 âˆˆ k Ã—2 but a1 a2 a3 âˆˆ
/ k Ã—4 , then the Î“k -invariant subgroup of Br(X){2}
is Br(X)[2]. The same holds if k is replaced by Q.
(iv) If a1 a2 a3 âˆˆ
/ k Ã—2 , then the Î“k -invariant subgroup of Br(X){2} is Z/2 generated
by the class of 1 + i in 21 O/O.
Remark 3.10 Let us recall the description of the twisted Galois representation
from Remark 2.10 in the case d = 4. The group scheme G = (Âµ4 )3 acts on Î±(1,1,1)
via the product character (Âµ4 )3 â†’ Âµ4 . If K is a subfield of C and a = (a1 , a2 , a3 ) âˆˆ
(K Ã— )3 , then the action of Gal(K/K) on T (Xa,C ) âŠ— Zâ„“ is obtained by twisting the
action of Gal(K/K) on T (FC ) âŠ— Zâ„“ by the 1-cocycle Gal(K/K) â†’ Âµ4 with class
a1 a2 a3 âˆˆ K Ã— /K Ã—4 = H1 (K, Âµ4 ). For example, if a1 a2 a3 âˆˆ K Ã—4 , then the action of
Gal(K/K) on T (Xa,C )âŠ—Zâ„“ is the same as the action of Gal(K/K) on T (FC )âŠ—Zâ„“ . In
general, if K contains k, the twisted action is obtained by composing the untwisted
action with the inverse of the
 quartic character given by a1 a2 a3 . The value of this
a1 a2 a3 âˆ’1
.
character on Frobp is
Ï€
4

Proof of Proposition 3.9. (i) By Remark 3.10, in this case the action of Î“k is the same
as for the Fermat surface over k, so we read off the result from Proposition 3.3 (i).
(ii) By the same remark, the action Î“Q is the same as for the Fermat surface, so
compared to (a) we only need to take into account the action of Ï„ (1). As explained
in Proposition 3.2, it acts on O as the usual conjugation, hence the first formula. If
a1 a2 a3 âˆˆ âˆ’4QÃ—4 , then Ï„ (1) acts on O as the usual complex conjugation followed by
28

multiplication by (1 + i)/(1 âˆ’ i), which the value on the complex conjugation of the
1-cocycle given by âˆ’4. Thus the twisted action of Ï„ (1) sends a + bi to b + ai, hence
the result.
(iii) Recall that Frobp âˆˆ Î“k acts on Br(X)[2m ] = O/2m , m â‰¥ 1, as multiplication
a1 a2 a3
Ï€
by ( a1 ap2 a3 )âˆ’1
)4 is 1 if a1 a2 a3 is a fourth power modulo p, and âˆ’1 oth4 Ï€Ì„ . Here (
p
erwise. One easily checks that, whatever the sign, the Frobâˆ’1+2i -invariant subgroup
of O/2m is killed by 4. But Frobp , for any p coprime to 2, acts on O/4 as multiplication by ( a1 ap2 a3 )âˆ’1
4 . Since a1 a2 a3 is not a fourth power in k, by the Chebotarev
density theorem we can find a prime ideal p such that Frobp acts as âˆ’1. This proves
(iii) for k.
The kernel of the natural map QÃ— /QÃ—4 â†’ k Ã— /k Ã—4 is the group of order 2 generated
by âˆ’4. Hence a square in Q which is not a fourth power in Q cannot become a fourth
power in k. The action of Ï„ (1) on O/2 = Br(F )[2] is trivial, so the action of Ï„ (1)
on O/2 = Br(X)[2] is by multiplication by the inverse of the value of the 1-cocycle
given by a1 a2 a3 evaluated at the complex conjugation. This is an element of {Â±1},
so it acts trivially on O/2. Thus the statement (iii) for Q follows from the same
statement for k.
âˆ’1+2i
= 1 + 4i multiplied by Â±1 or
(iv) In this case Frobâˆ’1+2i acts on O/2m as âˆ’1âˆ’2i
Â±i. One checks that in all cases the Frobâˆ’1+2i -invariant subgroup of O/2m is killed
by 4. By the same argument as in (iii), for any odd prime ideal p âŠ‚ O, the action
of Frobp on O/4 is by multiplication by Â±1 or Â±i. Since a1 a2 a3 is not a square in
k, by the Chebotarev density theorem we can find a prime ideal p such that FrobÏ€
acts on O/4 as multiplication by Â±i. Then the FrobÏ€ -invariant subgroup of O/4 is
Z/2 generated by 2(1 + i). This subgroup is Î“k -invariant, which proves (iv). 
The following statement answers Question 2 raised at the end of [Sko17] and gives
a different proof of Proposition 3.6.
Corollary 3.11 Let K be a field of characteristic zero, a = (a1 , a2 , a3 ) âˆˆ (K Ã— )3 ,
and let X = Xa . Then the action of Gal(K/K) on Br(X)[2] fixes the unique nonzero Âµ4 -invariant element; the other two non-zero 2-torsion elements are permuted
âˆš
by Gal(K( a1 a2 a3 )/K).
Proof. The Galois group Gal(K/K) acts on Br(F ) via Î“ = Gal(Q/Q), but Î“ acts
trivially on Br(F )[2] by the proof of (ii) above. Thus Gal(K/K) acts on Br(X)[2]
via the inverse of the quartic character associated to a1 a2 a3 . The action of Âµ4 on
O/2O fixes the class of 1 + i and permutes the classes of 1 and i, hence the result.

Another result of Ieronymou [Ier10, Thm. 5.2] is a corollary of Theorem 3.8.
Proposition 3.12 (Ieronymou) Let X = Xa be a diagonal quartic surface over
Q such that 2 does not belong to the subgroup of QÃ— generated by âˆ’4, a1 , a2 , a3 and
QÃ—4 . Then Br(X)[2] âˆ© Im[Br(X) â†’ Br(X)] = 0, so that Br(X)[2] âŠ‚ Br1 (X).
29

âˆš âˆš âˆš
Proof. The surface X is split by the field K = k( 4 a1 , 4 a2 , 4 a3 ), where k = Q(i).
The kernel of QÃ— /QÃ—4 â†’ k Ã— /k Ã—4 is generated by the class of âˆ’4, so the kernel of
QÃ— /QÃ—4 â†’ K Ã— /K Ã—4 is generated by the classes of âˆ’4, a1 , a2 , a3 . Hence 2 âˆˆ
/ K Ã—4 ,
so the statement follows from Theorem 3.8. 
Proposition 3.13 Let X = Xa be a diagonal quartic surface over a field K containing k = Q(i). If a1 a2 a3 âˆˆ K Ã—4 and 2 âˆˆ K Ã—4 , then Br(X)[2] âŠ‚ Im[Br(X) â†’ Br(X)].
Proof. By Remark 3.10, the action of Gal(K/K) on Br(X) is the same as the action
of Gal(K/K) on Br(F ), so the arguments from the second part of the proof of
Corollary 3.5 still work. 
The proof of Corollary 3.5 shows that in this situation each element of Br(X)[2]
can be lifted to an element of Br(X)/Br0 (X) of order 2.

4
4.1

Main theorem
Reduction to finite group cohomology

Let Xa be a diagonal quartic surface over Q with coefficients a1 , a2 , a3 âˆˆ QÃ— . To
a = (a1 , a2 , a3 ) and a field L of characteristic zero we attach a finite Galois extension
La and its Galois group
âˆš
âˆš âˆš âˆš
4
Ga,L = Gal(La /L).
La = L(i, 2, 4 a1 , 4 a2 , 4 a3 ),
ea and its Galois group
We shall also consider a larger Galois extension L
âˆš
âˆš âˆš
4
ea = L(i, 8 âˆ’2, âˆš
ea,L = Gal(L
ea /L).
L
a1 , 4 a2 , 4 a3 ),
G

Note that La splits Xa and contains Q(Âµ8 ). We see that Pic(X), and hence also
Pic(X)âˆ— and âˆ†X , are trivial Gal(Q/La )-modules. By Proposition 3.3 (iii), Br(X)[16]
is a trivial Gal(Q/La )-module too. Thus Î“L = Gal(Q/L) acts on these modules via
ea )-module, so Î“L acts
Ga,L . By Proposition 3.3 (iv), Br(X)[32] is a trivial Gal(Q/L
ea,L .
on it via G
In view of Proposition 3.9, the main theorem can be proved by applying Corollary
ea,Q and G
ea,k , where k = Q(i). This is a finite
1.6 with n = 4 to all possible groups G
calculation because each of these groups is a subgroup of the â€˜genericâ€™ Galois group
e defined by treating a1 , a2 , a3 as independent variables. However, we have chosen
G
a slightly more elaborate line of proof which has the advantage of reducing the use
of computer to a small number of group cohomology calculations.
The exact sequence (9) in our particular case takes the form (24). From it we
obtain exact sequences of Î“L -modules
[8]

0 âˆ’â†’ âˆ†X âˆ’â†’ Br(X)[16] âˆ’â†’ Br(X)[2] âˆ’â†’ 0,
30

(26)

[8]

0 âˆ’â†’ âˆ†X âˆ’â†’ Br(X)[32] âˆ’â†’ Br(X)[4] âˆ’â†’ 0.

(27)

The sequence (26) is thus an exact sequence of Ga,L -modules, and so defines a
boundary map H0 (Ga,L , Br(X)[2]) â†’ H1 (Ga,L , âˆ†X ). Similarly, the sequence (27)
e a,L , âˆ†X ).
ea,L , Br(X)[4]) â†’ H1 (G
defines a boundary map H0 (G

Lemma
âˆš 4.1 Let k = Q(i). Suppose that the
âˆš image of the natural map Ga,L â†’
Gal(k( 4 2)/Q) contains the subgroup Gal(k( 4 2)/k) â‰ƒ Z/4. Then
(a) the group Br(X)[2] âˆ© Im[Br(XL ) â†’ Br(X)] is the intersection of images of the
following maps:
H1 (Ga,L , Pic(X)âˆ— ) âˆ’â†’ H1 (Ga,L , âˆ†X ) â†âˆ’ H0 (Ga,L , Br(X)[2]);

(b) the group Br(X){2} âˆ© Im[Br(XL ) â†’ Br(X)] is the intersection of images of
the following maps:
ea,L , âˆ†X ) â†âˆ’ H0 (G
ea,L , Br(X)[4]).
ea,L , Pic(X)âˆ— ) âˆ’â†’ H1 (G
H1 (G

Proof. Let us show that Br(X){2}Î“L is killed by 4. For this it is enough to show
that Br(X)[8]Î“L is killed by 4. Let us first assume that a1 a2 a3 is a fourth power
in L. In this case, the Î“L -modules Br(X){2} and Br(F ){2} are isomorphic.
By
âˆš
Proposition 3.3 (ii), the group Î“L acts
âˆš on Br(F )[8] via its image Gal(L(i,
âˆš 2)/L). By
assumption, the subgroup Gal(L(i, 2)/L(i)) is isomorphic to Gal(k( 2)/k)
âˆš â‰ƒ Z/2.
As in the proof of Proposition 3.3 (i), the non-trivial element of Gal(k( 2)/k) can
be taken to be FrobÏ€ , where Ï€ = âˆ’1 + 2i. If x + iy âˆˆ O is fixed modulo 8 under
the multiplication by Ï€Ì„Ï€ , then x and y are even. Thus 4 kills Br(X){2}Î“L in this
case. In general, the Galois representation on Br(X)[8] is obtained by twisting the
representation on Br(F )[8] by the inverse of the quartic character of a1 a2 a3 , so Ï€Ï€Ì„ is
multiplied by Â±1 or Â±i. An easy check shows that 4 kills Br(X){2}Î“L in all cases.
In view of the exact sequence (26) this implies that the boundary maps
Br(X)[2]Î“L âˆ’â†’ H1 (L, âˆ†X ),

H0 (Ga,L , Br(X)[2]) âˆ’â†’ H1 (Ga,L , âˆ†X )

are injective. We have a commutative diagram
âˆ—
)
H1 (L, Pic(X)
O

/

H1 (L,O âˆ†X ) o

âˆ¼
=

H1 (Ga,L , Pic(X)âˆ— )

âˆ‚1

? _ Br(X)[2]Î“L
O

/

âˆ¼
=

?

H1 (Ga,L , âˆ†X ) o

? _ H0 (Ga,L , Br(X)[2])

where the vertical arrows are inflation maps. Claim (a) follows from this diagram.
Similarly, the boundary maps defined by the exact sequence (27)
Br(X){2}Î“L = Br(X)[4]Î“L âˆ’â†’ H1 (L, âˆ†X ),
31

ea,L , Br(X)[4]) âˆ’â†’ H1 (Ga,L , âˆ†X )
H0 (G

are injective. We have a similar commutative diagram
H1 (L, Pic(X)âˆ— )

/ H1 (L, âˆ†X ) o
O

O

âˆ¼
=

ea,L , Pic(X)âˆ— )
H1 (G

It immediately implies (b). 

4.2

/

?

ea,L , âˆ†X ) o
H1 (G

âˆ‚1

? _ Br(X)[4]Î“L
O
âˆ¼
=

? _ H0 (G
ea,L , Br(X)[4]).

The case of Q(i)

The main result of this section is the following description of the 2-primary torsion
subgroup of the transcendental Brauer group of X over the field k = Q(i).
Theorem 4.2 Let X = Xa be a diagonal quartic surface with a1 , a2 , a3 âˆˆ QÃ— . Then
(Br(Xk )/Br1 (Xk )) {2} is Z/2 if Xk is equivalent to X1,2,8 Ã—Q k, and 0 otherwise.
âˆš
We will apply Lemmaâˆš4.1 to a field extension L = K of k not containing k( 2)
and such that Ka = K( 4 2). Then
âˆš
âˆš
4
4
Ga,K = Gal(K( 2)/K) = Gal(k( 2)/k),
âˆš
âˆš
ea,K = Gal(K( 8 âˆ’2)/K) = Gal(k( 8 âˆ’2)/k).
G

In particular, the condition of Lemma 4.1 is satisfied.

âˆš
Lemma
4.3 Let K be a field extension of k not containing k( 2) such that Ka =
âˆš
K( 4 2). Then the cardinality of the image of H1 (Ga,K , Pic(X)âˆ— ) â†’ H1 (Ga,K , âˆ†X ) is
equal to the cardinality of the cokernel of H0 (Ga,K , Pic(X)âˆ— ) â†’ H0 (Ga,K , âˆ†X ). The
ea,K .
same is true if Ga,K is replaced by G
Proof. By the duality theorem for Tate cohomology groups [Bro82, Ch. VI, Â§7,
Exercise 3] we have an isomorphism
Hâˆ’1 (Ga,K , Pic(X)âˆ— ) âˆ¼
= Hom(H1 (Ga,K , Pic(X)), Z/4).
Since Ga,K is cyclic, we have a canonical isomorphism
Hâˆ’1 (Ga,K , Pic(X)âˆ— ) âˆ¼
= H1 (Ga,K , Pic(X)âˆ— ).
Thus H1 (Ga,K , Pic(X)âˆ— ) is (non-canonically) isomorphic to H1 (Ga,K , Pic(X)). The
ea,K is also cyclic, so the same argument applies with Z/4 replaced by Z/8.
group G
We have an exact sequence of abelian groups
H0 (Ga,K , Pic(X)âˆ— ) â†’ H0 (Ga,K , âˆ†X ) â†’ H1 (Ga,K , Pic(X)) â†’ H1 (Ga,K , Pic(X)âˆ— ),

ea,K . The cardinalities of the third and fourth groups
and a similar sequence for G
are equal, and our statement follows. 
32

âˆš
Lemma 4.4 Let K be a field extension of k not containing k( 2). Let X = Xa be
a diagonal quartic surface where (a1 , a2 , a3 ) is in the following list:
(1, 1, 2),

(1, 1, 4),

(1, 1, 8),

(1, 2, 2),

(1, 2, 4),

(1, 4, 4),

(1, 4, 8),

(2, 4, 8).

Then Br(X)[2] âˆ© Im[Br(XK ) â†’ Br(X)] = 0.
Proof. In the proof of the statement, we can
âˆš replace K by a finite extension. In the
cases
(1, 1, 4) and (1, 4, 4) we go over to K( 2) which splits X but does not contain
âˆš
4
2, so the result follows from Theorem 3.8.
We identify (1, 1, 2) and (1, 1, 8) as case B59, while (2, 4, 8) is case B46 in [Bri02,
Table B]. In these cases H1 (Ga,K , Pic(X)) = 0, hence H1 (Ga,K , Pic(X)âˆ— ) = 0, so we
conclude by Lemma 4.1 (a).
It remains to consider the cases (1, 2, 2), (1, 2, 4), and (1, 4, 8). Using a computer
we check that the map H0 (Ga,K , Pic(X)âˆ— ) â†’ H0 (Ga,K , âˆ†X ) is surjective in these
three cases (see Lemma A.1). By Lemma 4.3 it follows that H1 (Ga,K , Pic(X)âˆ— ) â†’
H1 (Ga,K , âˆ†X ) is the zero map. We conclude by applying Lemma 4.1 (a). 
Proof of Theorem 4.2. Since âˆ’4 is a fourth power in k = Q(i) we can multiply
the coefficients a1 , a2 , a3 by âˆ’4 and fourth powers of their denominators if necessary
and so assume that they are positive integers. Write
a1 = 2Î± a,

a2 = 2Î² b,

a3 = 2Î³ c,

where a, b, c are positive odd integers. The triviality of the intersection of Br(X)[2]
with the image ofâˆšBr(Xk ) in Br(X) can be proved over a finite extension of k. The
âˆš 4 âˆš
field K = k( 4 a, b, 4 c) satisfies the assumptions of Lemma 4.4, so we conclude the
proof by replacing k with K, except in the case when XK is equivalent to X1,2,8 Ã—Q K
which is not covered by Lemma 4.4.
In the rest of the proof we deal with this exceptional case and assume a1 = a,
a2 = 2b, a3 = 8c, where a, b, c are positive odd integers.
The main case. Let us first deal with the case (a1 , a2 , a3 ) = (1, 2, 8). We observe
that the product of the coefficients is a fourth power in Q, so the Î“Q -modules Br(X)
We work over K = k and apply Lemma 4.1 (a). The
and Br(F ) are isomorphic.
âˆš
4
action of Ga,K = Gal(k( 2)/k) on O/8 factors through a group of order 2 whose
generator acts as multiplication by 1 + 4i. By the standard formula for the first cohomology group of a cyclic group we obtain H1 (Ga,K , âˆ†X ) â‰ƒ (Z/2)2 . The injective
map H0 (Ga,K , Br(X)[2]) = O/2 â†’ H1 (Ga,K , âˆ†X ) is therefore an isomorphism. By
Lemma 4.3 the image of H1 (Ga,K , Pic(X)âˆ— ) â†’ H1 (Ga,K , âˆ†X ) has the same cardinality as the cokernel of H0 (Ga,K , Pic(X)âˆ— ) â†’ H0 (Ga,K , âˆ†X ). It can be checked on a
computer (cf. Lemma A.2) that this cardinality is 2.
To prove that (Br(Xk )/Br1 (Xk )) {2} âˆ¼
= Z/2 we show that this group does not
have an element of order 4. By Lemma 4.3 the image of the homomorphism
33

ea,K , Pic(X)âˆ— ) â†’ H1 (G
ea,K , âˆ†X ) has the same cardinality as the cokernel of
H1 (G
ea,K , Pic(X)âˆ— ) â†’ H0 (G
ea,K , âˆ†X ). But this cokernel is the same as the cokernel
H0 (G
ea,K factors through
of H0 (Ga,K , Pic(X)âˆ— ) â†’ H0 (Ga,K , âˆ†X ), because the action of G
the action of Ga,K . By Lemma 4.1 (b) we conclude that the 2-primary torsion
subgroup of Br(Xk )/Br1 (Xk ) is Z/2.
The remaining cases. Having dealt with the main case we need to show that in all
other cases Br(X)[2] intersects trivially with the image of Br(Xk ) â†’ Br(X). There
is a prime p dividing the positive odd integer abc. Let L be the field obtained by
adjoining to k the fourth roots of all the prime factors of abc other than p. Then
XL is equivalent to a diagonal quartic surface of one of the following types.
(pn , 2, 8), where n = 1, 2, 3. Let K be the extension of L obtained by adjoining
the fourth root
of p/4, p/2, p/4, respectively. We note that 2 is not a square in K
âˆš
4
and Ka = K( 2). As XK is equivalent to X2,4,8 Ã—Q K considered in Lemma 4.4, we
conclude by this lemma.
p
(1, 2pm , 8pn ), where m > 0 or n > 0. Let K = L( 4 p/2). A tedious but easy
verification shows that XK is equivalent to one of the surfaces considered
in Lemma
p
4
2
2
2
4.4, except in the case (1, 2p , 8p ). In this case we let M = L( 2p ). Note that 2
is a square in M, so 8p2 is a fourth power in M, hence M splits X. But 2 is not a
fourth power in M, so we conclude by Theorem 3.8.
m
(p2 , 2pp
, 8pn ). Another tedious but easy verification shows that extending L to
K = L( 4 p/2) reduces all cases, except those equivalent over K to (p2 , 2p2 , 8), to
the cases covered in Lemma 4.4.
p
2
(p, 2pm , 8pn ). Let K0 = L(Ï€), where Ï€âˆš
= p, and let K = K0 ( 4 Ï€/2). We note
that 2 is not a square in K and Ka = K( 4 2). The surface XK is equivalent to one
of the cases treated before, unless it is equivalent to (Ï€ 2 , 2Ï€ 2 , 8).
It remains to show that for the diagonal
surface X with coefficients
âˆš quartic
âˆš
2
2
(r , 2r , 8) over a field K âŠƒ k such that [K( 2, r) : K] = 4 we have Br(X){2} =
Br1 (X){2}. The proof uses the following lemma.
Lemma 4.5 Let AÃ—B be a product of two groups. Let M be a B-module. Consider
M as an A Ã— B-module with trivial action of A. Then the inflation-restriction
sequence with respect to the subgroup A âŠ‚ A Ã— B is a split exact sequence, so we
have a canonical isomorphism
H1 (A Ã— B, M) âˆ¼
= H1 (A, M)B âŠ• H1 (B, M),
where H1 (A, M)B âˆ¼
= Hom(A, M B ).
Proof. We have H1 (A, M) âˆ¼
= Hom(A, M), and since A and B commute, we have
B
B
Hom(A, M) = Hom(A, M ).

34

The restriction map H1 (A Ã— B, M) â†’ H1 (A, M)B = Hom(A, M B ) has a section
given by the inflation map Hom(A, M B ) â†’ H1 (A Ã— B, M). Thus H1 (A Ã— B, M) is
the direct sum of H1 (A, M)B and H1 (B, M A ) = H1 (B, M). 
End of proof of Theorem 4.2. The product of the coefficients (r 2 , 2r 2 , 8) is a fourth
power in âˆš
K, so the Gal(K/K)-modules Br(X) and Br(F ) are isomorphic. We have
âˆš
Ka = K( 4 2, r) and Ga,K = G Ã— H, where
âˆš
âˆš
âˆš
4
4
G = Gal(K( 2)/K) = Gal(k( 2)/k) â‰ƒ Z/4,
H = Gal(K( r)/K) â‰ƒ Z/2,
and H acts trivially on Br(X)[16]. The condition of Lemma 4.1 is satisfied.
We can apply Lemma 4.5 to M = âˆ†X , A = H, B = G. Note that the inclusion (âˆ†X )G â†’ âˆ†X is the natural map O/4 â†’ O/8; it induces an isomorphism
H1 (H, (âˆ†X )G )âˆ’â†’H
Ëœ 1 (H, âˆ†X ) as both groups are O/2. By Lemma 4.5 we obtain
H1 (G Ã— H, âˆ†X ) âˆ¼
= H1 (G, âˆ†X ) âŠ• O/2.
= H1 (G, âˆ†X ) âŠ• Hom(H, (âˆ†X )G ) âˆ¼

The map âˆ‚1 : (O/2)G â†’ H1 (G, âˆ†X ) was already computed in the previous case
(1, 2, 8), and was found to be an isomorphism. The inflation-restriction sequence
with respect to the subgroup H âŠ‚ G Ã— H gives rise to the following commutative
diagram, where the middle column is a split exact sequence of Lemma 4.5:
H1 (H, Pic(X)âˆ— )
/

O

O

res

res

H1 (G Ã— H, Pic(X)âˆ— )

O/2

/

H1 (G, âˆ†X ) âŠ• O/2 o
O

H1 (G, âˆ†X ) o

(O/2)GÃ—H
O

=

inf

?

âˆ‚1

âˆ¼
=

(O/2)G

By Lemma 4.1 (a), if the intersection of images of the maps in the middle row is zero,
then Br(XK ){2} = Br1 (XK ){2}. The commutativity of this diagram implies that
Im(âˆ‚1 ) coincides with the direct summand H1 (G, âˆ†X ) of H1 (G, âˆ†X )âŠ•O/2. Thus we
need to show that the image of H1 (G Ã— H, Pic(X)âˆ— ) intersects H1 (G, âˆ†X ) trivially.
The cardinality of the image of H1 (G Ã— H, Pic(X)âˆ— ) is 4. This can be checked
using the exact sequence in the proof of Lemma 4.3 using the fact that each of the
groups H1 (G Ã— H, Pic(X)) and H1 (G Ã— H, Pic(X)âˆ— ) has 16 elements. Indeed, since
(âˆ†X )GÃ—H â‰ƒ (Z/4)2 , one needs to check that the image of (Pic(X)âˆ— )GÃ—H â†’ (âˆ†X )GÃ—H
is 4. Furthermore, the composition of the left upward arrow and the top horizontal
arrow is surjective; see Lemma A.3 for all these facts. The commutativity of the
diagram now implies the desired result. This finishes the proof of Theorem 4.2. 

4.3

The case of Q

The following is the main result of the paper.
35

Theorem 4.6 Let X = Xa be a diagonal quartic surface with a1 , a2 , a3 âˆˆ QÃ— . Then
(Br(X)/Br1 (X)) {2} is Z/2 if X is equivalent to X1,2,âˆ’2 or X1,8,âˆ’8 , and 0 otherwise.
Proof. By Theorem 4.2 we need to deal with the following cases:
(1, 2, 8),

(1, âˆ’2, âˆ’8),

(2, âˆ’2, âˆ’4),

(âˆ’2, 4, 8), (1, 2, âˆ’2), (1, 8, âˆ’8). (28)
âˆš
âˆš
Each of these surfaces satisfies Qa = Q(i, 4 2) = k( 4 2), where k = Q(i). By Lemma
4.1, in order to conclude that Br(X){2} = Br1 (X){2} it is enough to show that
the images of H0 (Ga,Q , Br(X)[2]) and H1 (Ga,Q , Pic(X)âˆ— ) in H1 (Ga,Q , âˆ†X ) intersect
trivially.
In the first three cases the product of coefficients is in QÃ—4 , so the Î“Q -modules
Br(X) and Br(F ) are isomorphic, hence H1 (Ga,Q , âˆ†X ) â‰ƒ H1 (Ga,Q , âˆ†F ). Proposition
3.9 (ii) implies that Br(X){2}Î“Q â‰ƒ Z/2 Ã— Z/4, hence H0 (Ga,Q , Br(X)[2]) âˆ¼
= O/2. A
computer calculation (cf. Lemma A.4) shows that H1 (Ga,Q , âˆ†X ) â‰ƒ (Z/2)4 and in
each case the image of H1 (Ga,Q , Pic(X)âˆ— ) has trivial intersection with the image of
H0 (Ga,Q , Br(X)[2]).
In the last three cases, where the product is in âˆ’4QÃ—4 , we have Br(X){2}Î“Q â‰ƒ
Z/4, hence H0 (Ga,Q , Br(X)[2]) âˆ¼
= Z/2. One checks that in all three cases the group
H1 (Ga,Q , âˆ†X ) is Z/2. Then a computer calculation (cf. Lemma A.4) shows that in
the case (âˆ’2, 4, 8) the image of H1 (Ga,Q , Pic(X)âˆ— ) â†’ H1 (Ga,Q , âˆ†X ) is 0. In contrast,
in the last two cases the map H1 (Ga,Q , Pic(X)âˆ— ) â†’ H1 (Ga,Q , âˆ†X ) turns out to be
the surjective map Z/4 â†’ Z/2. Thus (Br(X)/Br1 (X)) [2] âˆ¼
= Z/2.
It remains to prove that there is noâˆšelement of order 4 in (Br(X)/Br1 (X)) {2}.
ea,Q = Gal(k( 8 âˆ’2)/Q). By Lemma 4.1 it is enough to
To do this, consider G
ea,Q , Br(X)[4]) with the image of
show that the intersection of the image of H0 (G
ea,Q , Pic(X)âˆ— ) in H1 (G
e a,Q , âˆ†X ) is killed by 2. We have a commutative diagram
H1 (G
ea,Q , Pic(X)âˆ— )
H1 (G

/

ea,Q , âˆ†X )
H1 (G

H1 (Ga,Q , Pic(X)âˆ— )
/

H1 (Ga,Q , âˆ†X )

O

O

âˆ¼
=

?

which shows that the image of the upper horizontal arrow is isomorphic to the image
of lower horizontal arrow, which is Z/2. 
Proposition 4.7 Let X be a diagonal quartic surface over Q. Let X â€² be the diagonal quartic surface obtained by multiplying any two coefficients of X by âˆ’4. Then
â€²
2
(X , Q2 ) are isomorphic, and the Î“Q -modules
the Î“Q -modules H2eÌt (X, Q2 ) and HeÌt
â€²
H2eÌt (X, Zâ„“ ) and H2eÌt (X , Zâ„“ ) are isomorphic for all odd primes â„“. In particular,
|X(Fq )| = |X â€² (Fq )| for all prime powers q coprime to a1 a2 a3 .
36

Proof. Twisting both surfaces we can assume that X = F is the Fermat surface
and X â€² = F â€² = X(1,âˆ’4,âˆ’4) . Since the degree of the polarisation is 4, it is enough
to construct an isomorphism between primitive cohomology Î“Q -modules Pâ„“ (F ) and
Pâ„“ (F â€² ), and also between P (F ) âŠ— Q2 and P (F â€² ) âŠ— Q2 . Write k = Q(i). Since
âˆ’4 âˆˆ (k Ã— )4 , we have Fk âˆ¼
= Fkâ€² and thus the representations of Î“k are isomorphic. It
remains to show that this isomorphism extends to complex conjugation.
Recall that the action of Ï„ (1) on P (F ) fixes the generator: Ï„ (1)(2Ï€ieâ€² ) = 2Ï€ieâ€² ,
see (18). Thus for P (F â€²) we have Ï„ (1)(2Ï€ieâ€² ) = u2 u3 (2Ï€ieâ€² ). In Z[x]/(x3 +x2 +x+1)
we have 4(1 âˆ’ x)âˆ’1 = x2 + 2x + 3. Hence (1 âˆ’ x)(1 âˆ’ y) is an invertible element of
Q2 [x, y]/(x3 +x2 +x+1, y 3 +y 2 +y +1) and of Zâ„“ [x, y]/(x3 +x2 +x+1, y 3 +y 2 +y +1),
where â„“ is odd. It follows that multiplication by (1âˆ’u2)(1âˆ’u3 ) defines isomorphisms
P (F ) âŠ— Q2 âˆ¼
= Pâ„“ (F â€² ) where â„“ is odd. Since Î“k commutes
= P (F â€² ) âŠ— Q2 and Pâ„“ (F ) âˆ¼
with (Âµ4 )3 , these isomorphisms respect the action of Î“k . As one immediately checks,
they also respect the action of Ï„ (1). 

A

Computations for the main theorem

This appendix collects details of computations used in the proofs of Theorems 4.2
and 4.6. While these are not too challenging to be unachievable by hand, it is more
convenient to carry them out with the help of a computer algebra system. Magma
[Magma] code to this effect is available at https://github.com/dgvirtz/diagonalquartics
and from the auxiliary files accompanying this article arXiv:1905.11869 on the
arxiv.org preprint server.
Consider the diagonal quartic surface Xt with coefficients t1 , t2 , t3 over the field
Q(t1 , t2 , t3 ), where t1 , t2 , t3 are independent variables. Let
âˆš
âˆš âˆš âˆš
4
GÎ· = Gal(Q(i, 2, 4 t1 , 4 t2 , 4 t3 )/Q(t1 , t2 , t3 )).
We denote the generators of GÎ· by
âˆš
âˆš
âˆš
âˆš
âˆš
âˆš
âˆš
âˆš
4
4
Ï„ (i) = âˆ’i, Ïƒ( 2) = i 2, s1 ( 4 t1 ) = i 4 t1 , s2 ( 4 t2 ) = i 4 t2 , s3 ( 4 t3 ) = i 4 t3 ,
âˆš âˆš âˆš âˆš
with the understanding that Ï„ acts trivially on 4 2, 4 t1 , 4 t2 , 4 t3 , Ïƒ acts trivially
âˆš âˆš âˆš
on i, 4 t1 , 4 t2 , 4 t3 , and similarly for s1 , s2 , s3 . A diagonal quartic surface Xa over a
number field K gives rise to a subgroup Ga,K âŠ‚ GÎ· which will be described explicitly
in each case.
âˆš âˆš âˆš
Fix fourth roots 4 a1 , 4 a2 , 4 a3 and a primitive eighth root of unity Î¶. Recall that
the abelian group Pic(X) is generated by 48 lines of the form
âˆš
âˆš
âˆš
Î›m,n
Î¶ mx0 = 4 ah xh , Î¶ n 4 ai xi = 4 aj xj ,
h,i,j :
where (h, i, j) is a permutation of (1, 2, 3) and m, n âˆˆ {1, 3, 5, 7}. A basis B of 20
lines, which Swinnerton-Dyer kindly provided to the authors, is given by
1,3
1,5
1,7
3,1
3,3
3,5
5,1
5,3
5,5
Î›1,1
1,2,3 , Î›1,2,3 , Î›1,2,3 , Î›1,2,3 , Î›1,2,3 , Î›1,2,3 , Î›1,2,3 , Î›1,2,3 , Î›1,2,3 , Î›1,2,3 ,

37

1,3
1,5
3,1
3,3
3,5
Î›1,1
2,3,1 , Î›2,3,1 , Î›2,3,1 , Î›2,3,1 , Î›2,3,1 , Î›2,3,1 ,
3,1
1,5
1,3
Î›1,1
3,1,2 , Î›3,1,2 , Î›3,1,2 , Î›3,1,2 .

(A similar basis of 20 lines appears in [SS].) The description of Pic(X) in terms of
lines can be matched with the description in the main text by first identifying the
1,1
line Î›1,2,3
with 41 (L âˆ’ c) and then identifying all other lines using the actions of (Âµ4 )3
and S3 on X. The images of w1 , w2 in âˆ†X are expressed in the basis B as
1
(1
8
1
(2
8

1 0 0 1 4 7 0 7 3 6 6 4 2 2 4 0 4 0 4),
7 3 2 1 6 1 1 5 4 4 6 6 4 2 2 4 4 4 4).

We write elements of T (XC ) and âˆ†X âˆ¼
= T (XC )/8 in the basis (w1 , w2 ). The 1cocycles in group cohomology will be explicitly described as maps from Ga,K to the
coefficient module.
In order to assist an independent verification, we give intermediate
steps and
âˆš
4
details of our computations. Let k = Q(i) and let G = Gal(k( 2)/k).
Lemma A.1 Let a âˆšâˆˆ {(1, 2, 2), (1, 2, 4), (1, 4, 8)}. Let K be a field extension of
k not containing k( 2). Then G âˆ¼
= Ga,K and the map (Pic(X)âˆ— )G â†’ (âˆ†X )G is
surjective.
Proof. In the first case, one has Ga,K = hÏƒs2 s3 i. A computation of invariants
gives (Pic(X)âˆ— )G â‰ƒ Z6 . By Proposition 3.9, one has (âˆ†X )G = âˆ†X [2]; lifting the
generators of âˆ†X [2] to (Pic(X)âˆ— )G is easy.
In the last two cases Ga,K = hÏƒs2 s23 i and Ga,K = hÏƒs22 s33 i, respectively. A
computation of invariants gives (Pic(X)âˆ— )G â‰ƒ Z3 . By Proposition 3.9, the group
(âˆ†X )G â‰ƒ Z/2 is generated by 12 (w1 + w2 ) which lifts to (Pic(X)âˆ— )G . 
Lemma A.2 Assume K = k = Q(i) and a = (1, 2, 8). Then G âˆ¼
= Ga,k and the
âˆ— G
G
cokernel of the map (Pic(X) ) â†’ (âˆ†X ) has cardinality 2.
Proof. One has Ga,k = hÏƒs2 s33 i. Proposition 3.9 gives (âˆ†X )G = âˆ†X [4]. A computation of invariants shows that (Pic(X)âˆ— )G â‰ƒ Z6 and that the image of this group in
âˆ†X [4] is generated by the elements 41 (w1 Â± w2 ). 
Lemma A.3 Let K be anâˆšextension of k = Q(i) and let a = (r 2 , 2r 2, 8), where
âˆš
r âˆˆ K Ã— is such that [K( 2, r) : K] = 4. We have Ga,K âˆ¼
= G Ã— H, where
âˆš
âˆ— GÃ—H
GÃ—H
H = Gal(K( r)/K). The image of (Pic(X) )
â†’ (âˆ†X )
has cardinality 4,
|H1 (G Ã— H, Pic(X)âˆ— )| = |H1 (G Ã— H, Pic(X))| = 16
and the composition of the following maps is surjective:
res

H1 (G Ã— H, Pic(X)âˆ— ) âˆ’â†’ H1 (H, Pic(X)âˆ— ) âˆ’â†’ H1 (H, âˆ†X ) = âˆ†X [2].
38

Proof. One has Ga,K = hÏƒs2 s23 , s21 s22 i. A computation gives (Pic(X)âˆ— )GÃ—H â‰ƒ Z4 . The
four generators of (Pic(X)âˆ— )GÃ—H lie in Pic(X) only after doubling and, furthermore,
they are not all in the same equivalence class modulo Pic(X). Thus their images
span âˆ†X [2].
The first cohomology of Pic(X) was already computed in [Bri02, Table B], case
B37. Another computation shows that H1 (G Ã— H, Pic(X)âˆ— ) is generated by three
1-cocycles c1 , c2 and c3 of orders 2, 2 and 4 such that c2 and c3 map to generators
of H1 (H, âˆ†X ) âˆ¼
= âˆ†X [2]. 
Lemmas A.1â€“A.3 concern Pic(X), Pic(X)âˆ— and âˆ†X . In particular, no computational input about the transcendental lattice and its interplay with the algebraic
cycles is necessary. Thus the verification of the computational facts up to this point
can be achieved using solely the description of Pic(X) in terms of lines. This is not
so for the next lemma used in the proof of Theorem 4.6.
Lemma A.4 Assume that K = Q and a is in the list (28). Then the intersection
of images of the following maps
Ï

âˆ‚

1
Br(X)[2]Ga,Q
H1 (Ga,Q , Pic(X)âˆ— ) âˆ’â†’ H1 (Ga,Q , âˆ†X ) â†âˆ’

is trivial in the first four cases and is Z/2 in the last two cases of (28).
Proof. In all cases Ga,Q is generated by two elements g1 , g2 , which we specify. We
describe 1-cocycles by the images of g1 and g2 .
Case a = (1, 2, 8). We have g1 = Ïƒs2 s33 and g2 = Ï„ . A computation gives
H1 (Ga,Q , Pic(X)âˆ— ) â‰ƒ (Z/2)2 . The group H1 (Ga,Q , âˆ†X ) â‰ƒ (Z/2)4 is generated by
g1 7â†’ (0, 2)
g2 7â†’ 0

g1 â†’
7 (âˆ’4, 0)
g2 â†’
7
0

g1 â†’
7
0
g2 â†’
7 (âˆ’4, 0)

g1 7â†’ (âˆ’2, 0)
g2 7â†’ (0, 1).

In this basis of H1 (Ga,Q , âˆ†X ), we have
Im(âˆ‚1 ) = h(1, 1, 0, 0), (0, 0, 0, 1)i and Im(Ï) = h(0, 1, 0, 0)i.
Case a = (1, âˆ’2, âˆ’8). We have g1 = Ïƒs2 s33 and g2 = s2 s3 Ï„ . A computation gives
H1 (Ga,Q , Pic(X)âˆ— ) â‰ƒ (Z/2)2 . The group H1 (Ga,Q , âˆ†X ) â‰ƒ (Z/2)4 is generated by
g1 7â†’ (4, 4)
g2 7â†’ 0

g1 7â†’ (âˆ’2, 0)
g2 7â†’
0

g1 7â†’ 0
g2 7â†’ (4, 4)

g1 7â†’ (2, 2)
g2 7â†’ (âˆ’1, 0).

In this basis, Im(âˆ‚1 ) is as in the previous case and Im(Ï) = h(1, 0, 1, 0)i.
Case a = (2, âˆ’2, âˆ’4). We have g1 = Ïƒs1 s32 and g2 = s2 s3 Ï„ . A computation gives
an isomorphism H1 (Ga,Q , Pic(X)âˆ— ) â‰ƒ (Z/2)3 . The group H1 (Ga,Q , âˆ†X ) â‰ƒ (Z/2)4 is
39

generated by the same cocycles as for a = (1, âˆ’2, âˆ’8). In this basis, Im(âˆ‚1 ) is as in
the previous case and Im(Ï) = h(1, 0, 0, 0), (0, 0, 1, 0)i.

Case a = (âˆ’2, 4, 8). We have g1 = Ïƒs31 s22 s33 and g2 = s1 Ï„ . Then H1 (Ga , Pic(X)âˆ— ) â‰ƒ
(Z/2)2 is generated by two cocycles which map to 0 in H1 (Ga , âˆ†X ).
Case a = (1, 2, âˆ’2) (respectively, a = (1, 8, âˆ’8)). We have g1 = Ïƒs2 s33 (respectively,
g1 = Ïƒs32 s3 ) and g2 = s3 Ï„ . A computation shows that H1 (Ga , Pic(X)âˆ— ) â‰ƒ Z/4 maps
surjectively onto H1 (Ga , âˆ†X ) â‰ƒ Z/2, which is generated by the cocycle sending g1
to (âˆ’2, 2) and g2 to 0. 

B

Computations for the supplement

Let a = (1, 2, âˆ’2) or (1, 8, âˆ’8). In view of Theorems 4.2 and 4.6 we can apply
Corollary 1.6 (b) with n = 2. Thus we need to compute the first hypercohomology
group of the finite group Ga,K with coefficients in the complex Pic(X)âˆ— â†’ T (XC )/16,
where K = Q and Q(i).
Hypercohomology functionality is currently not available in Magma and had to
be added. Our implementation constructs a part of the Cartanâ€“Eilenberg resolution
of the above complex and computes its first total cohomology. More precisely, let
Z1 (M) be the group of 1-cocycles of a Ga,K -module M. Consider the double complex
0O
Z1 (Pic(X)âˆ— )

h01

O

/

Z1 (T (XC )/16)
O

v00

Pic(X)âˆ—

v10
h00

/

T (XC )/16
/

0

where h01 is the map induced by h00 and the vertical maps are the differentials of
the standard resolutions sending m to gm âˆ’ m. Details of the calculations are as
follows. (Matrices representing linear maps are understood to act on the right.)
Case K = Q(i). One computes that Z1 (Pic(X)âˆ— ) is freely generated by 14 cocycles
and Z1 (T (XC )/16) is generated by two cocycles which map the generator Ïƒs2 s33 of
Ga,K to (4, 4) and to (âˆ’4, 0). Using (w1 , w2) and the above basis for Z1 (T (XC )/16),
one checks that v10 is given by
"
#
âˆ’1 âˆ’3
.
âˆ’2 9
Similarly, one easily finds matrices representing h01 and v00 . A computation gives
that Ker(h01 âˆ’v10 ) âˆ¼
= (Z/4)2 âŠ•Z14 and, after choosing generators x1 , x2 of the torsion
subgroup and linearly independent y1 , . . . , y14 suitably in this kernel, we find that
40

Im(v00 âŠ• h00 ) is generated by y1 + y2 + 2y3 , 2y1 + x1 , 2y2 + x1 , x2 , y4, . . . , y14 . Thus
the first hypercohomology is (Z/4)2 .
Case K = Q. Recall that Ga,Q is generated by g1 = Ïƒs2 s33 (or Ïƒs32 s3 ) and g2 = s3 Ï„ .
One computes that Z1 (Pic(X)âˆ— ) is freely generated by 17 cocycles and Z1 (T (XC )/16)
is generated by the two cocycles
g1 â†’
7
(4 0)
,
g2 â†’
7 (âˆ’1 1)

g1 7â†’ (âˆ’4 4)
.
g2 7â†’
0

Using (w1 , w2 ) and the above basis for Z1 (T (XC )/16), one checks that v10 is represented by
"
#
1 âˆ’1
.
âˆ’1 2
Similarly, one easily finds matrices representing h01 and v00 . A computation gives
that Ker(h01 âˆ’ v10 ) âˆ¼
= Z/4 âŠ• Z17 and, after choosing x of order 4 and linearly
independent y1 , . . . , y17 suitably, Im(v00 âŠ• Ï†) is generated by 2x, x + 4y1 , y2, . . . , y17 .
Thus the first hypercohomology is Z/8.

References
[ABB13] A. Auel, C. BoÌˆhning, and H.-C. Graf von Bothmer. The transcendental
lattice of the sextic Fermat surface. Math. Res. Lett. 20 (2013) 1017â€“1031. 3,
18
[BvH09] M. Borovoi and J. van Hamel. Extended Picard complexes and linear algebraic groups. J. reine angew. Math. 627 (2009) 53â€“82. 10
[Bri02] M. Bright. Computations on diagonal quartic surfaces. PhD thesis, University of Cambridge, 2002. 2, 5, 33, 39
[Bri06] M. Bright. Brauer groups of diagonal quartic surfaces. J. Symb. Comp. 41
(2006) 544â€“558. 2
[Bri11] M. Bright. The Brauerâ€“Manin obstruction on a general diagonal quartic
surface. Acta Arith. 147 (2011) 291â€“302. 2
[Bro82] K.S. Brown. Cohomology of groups. Springer-Verlag, 1982. 32
[CKS87] J.-L. Colliot-TheÌleÌ€ne, D. Kanevsky et J.-J. Sansuc. ArithmeÌtique des surfaces cubiques diagonales. Diophantine approximation and transcendence theory
(Bonn, 1985), pp. 1â€“108, Lecture Notes in Math. 1290, Springer-Verlag, 1987.
2
41

[CTS13] J.-L. Colliot-TheÌleÌ€ne et A.N. Skorobogatov. Descente galoisienne sur le
groupe de Brauer. J. reine angew. Math. 682 (2013) 141â€“165. 6, 9, 11
[CTS21] J.-L. Colliot-TheÌleÌ€ne and A.N. Skorobogatov. The Brauerâ€“Grothendieck
group. Ergebnisse der Mathematik und ihrer Grenzgebiete 71, Springer, 2021.
2, 12
[Cox89] D. Cox. Primes of the form x2 + ny 2 . Wiley, 1989. 25, 26
[Deg15] A. Degtyarev. Lines generate the Picard groups of certain Fermat surfaces.
J. Number Theory 147 (2015) 454â€“477. 6
[DS16] A. Degtyarev and I. Shimada. On the topology of projective subspaces in
complex Fermat varieties. J. Math. Soc. Japan 68 (2016), 975â€“996. 3, 19, 20
[Del79] P. Deligne. Valeurs de fonctions L et peÌriodes dâ€™inteÌgrales. Automorphic
forms, representations and L-functions (Corvallis, 1977), Part 2, pp. 313â€“346,
Proc. Sympos. Pure Math. 33, Amer. Math. Soc., 1979. 19, 25
[GH78] Ph. Griffiths and J. Harris. Principles of algebraic geometry. John Wiley &
Sons, 1978. 13
[Gro68] A. Grothendieck. Le groupe de Brauer, I, II, III. Dix exposeÌs sur la cohomologie des scheÌmas. North-Holland, 1968, pp. 46â€“188. 8, 12
[Gvi19] D. Gvirtz. Topics in the arithmetic of hypersurfaces and K3 surfaces. PhD
thesis, Imperial College London, 2019. 5
[GLN] D. Gvirtz, D. Loughran, and M. Nakahara. Quantitative arithmetic of diagonal degree 2 K3 surfaces. arXiv:1910.06257 5
[Hat02] A. Hatcher. Algebraic topology. Cambridge University Press, 2002. 13
[Huy16] D. Huybrechts. Lectures on K3 surfaces. Cambridge Studies in Advanced
Mathematics, Cambridge University Press, 2016. 27
[Ier10] E. Ieronymou. Diagonal quartic surfaces and transcendental elements of the
Brauer groups. J. Inst. Math. Jussieu 9 (2010) 769â€“798. 2, 5, 26, 29
[IS15] E. Ieronymou and A.N. Skorobogatov. Odd order Brauer-Manin obstruction
on diagonal quartic surfaces. Adv. Math. 270 (2015) 181â€“205. Corrigendum:
Adv. Math. 307 (2017) 1372â€“1377. 3, 4, 24
[ISZ11] E. Ieronymou, A.N. Skorobogatov and Yu.G. Zarhin. On the Brauer group
of diagonal quartic surfaces. J. London Math. Soc. 83 (2011) 659â€“672. 2, 4

42

[IR90] K. Ireland and M. Rosen. A classical introduction to modern number theory.
2nd ed. Graduate Texts in Mathematics, 84. Springer-Verlag 1990. 21, 24
[Lem00] F. Lemmermeyer. Reciprocity laws. Springer-Verlag, 2000. 25
[LN97] R. Lidl and H. Niederreiter. Finite fields. 2nd ed. Encyclopedia of Mathematics and its Applications, 20. Cambridge University Press, 1997. 21, 22
[Lo10] E. Looijenga. Fermat varieties and the periods of some hypersurfaces. Algebraic and arithmetic structures of moduli spaces (Sapporo, 2007), 47â€“67, Adv.
Stud. Pure Math. 58, Math. Soc. Japan, 2010. 3, 16, 17, 18
[Magma] W. Bosma, J. Cannon, and C. Playoust. The Magma algebra system. I
The user language. J. Symbolic Comput., 24 (1997), 235â€“265. 37
[Pha65] F. Pham. Formules de Picardâ€“Lefschetz geÌneÌraliseÌes et ramification des
inteÌgrales. Bull. Soc. Math. France 93 (1965) 333â€“367. 3, 15
[PS71] I.I. Piatetskii-Shapiro and I.R. Shafarevich. Torelliâ€™s theorem for algebraic
surfaces of type K3. Izv. Akad. Nauk SSSR Ser. Mat. 35 (1971) 530â€“572. 23
[PSD91] R.G.E. Pinch and H.P.F. Swinnerton-Dyer. Arithmetic of diagonal quartic surfaces. I. L-functions and arithmetic (Durham, 1989), 317â€“338, L.M.S.
Lecture Note Series 153, Cambridge University Press, 1991. 2, 3, 6, 23
[SS] I. Shimada and T. Shioda. On a smooth quartic surface containing 56 lines
which is isomorphic as a K3 surface to the Fermat quartic. Manuscripta math.
153 (2017) 279â€“297. 38
[Sh79] T. Shioda. The Hodge conjecture for Fermat varieties. Math. Ann. 245 (1979)
175â€“184. 3, 18
[Sko17] A.N. Skorobogatov. Cohomology and the Brauer group of double covers.
Brauer groups and obstruction problems: moduli spaces and arithmetic. A. Auel,
B. Hassett, A. VaÌrilly-Alvarado, and B. Viray eds., Progress in Mathematics
320, BirkhaÌˆuser, 2017. 5, 26, 29
[SZ08] A.N. Skorobogatov and Yu.G. Zarhin. A finiteness theorem for the Brauer
group of abelian varieties and K3 surfaces. J. Alg. Geom. 17 (2008) 481â€“502. 3
[SZ14] A.N. Skorobogatov and Yu.G. Zarhin. The Brauer group and the Brauerâ€“
Manin set of products of varieties. J. Eur. Math. Soc. 16 (2014) 749â€“768. 2,
12
[SD43] P.S. Dyer (H.P.F. Swinnerton-Dyer). A solution of A4 + B 4 = C 4 + D 4 . J.
London Math. Soc. 18 (1943) 2â€“4. 2
43

[SD68] H.P.F. Swinnerton-Dyer. A4 +B 4 = C 4 +D 4 revisited. J. London Math. Soc.
43 (1968) 149â€“151. 2
[SD00] P. Swinnerton-Dyer. Arithmetic of diagonal quartic surfaces. II. Proc. London Math. Soc. 80 (2000) 513â€“544. 2
[SD14] P. Swinnerton-Dyer. Diagonal hypersurfaces and the Blochâ€“Kato conjecture,
I. J. London Math. Soc. 90 (2014) 845â€“860. 2
[SD16] P. Swinnerton-Dyer. Curves of small genus on certain K3 surfaces. Math.
Proc. Cambridge Philos. Soc. 161 (2016) 103â€“106. 2
[SGA7] P. Deligne et N. Katz. Groupes de monodromie en geÌomeÌtrie algeÌbrique, II.
SeÌm. geÌomeÌtrie algeÌbrique du Bois-Marie 1967â€“69 (SGA 7 II). Lecture Notes
in Mathematics 340, Springer-Verlag, 1973. 3, 13, 14
[Tat94] J. Tate. Conjectures on algebraic cycles in â„“-adic cohomology. Proc. Symp.
Pure Math. 55, Part 1 (1994) 71â€“83. 2
[Ulm02] D. Ulmer. Elliptic curves with large rank over function fields. Ann. of Math.
155 (2002) 295â€“315. 3, 21
[Wei49] A. Weil. Numbers of solutions of equations in finite fields. Bull. Amer. Math.
Soc. 55 (1949) 497â€“508. 2, 3, 22, 23
[Wei52] A. Weil. Jacobi sums as â€œGroÌˆssencharaktereâ€. Trans. Amer. Math. Soc. 73
(1952) 487â€“495. 2, 3, 23
[Wes11] A.E. Western. Some criteria for the residues of eighth and other powers.
Proc. London Math. Soc. 9 (1911) 244â€“272. 25
Department of Mathematics, University College London, WC1E 6BT England, U.K.
d.gvirtz@ucl.ac.uk
Department of Mathematics, South Kensington Campus, Imperial College London,
SW7 2BZ England, U.K. â€“ and â€“ Institute for the Information Transmission Problems, Russian Academy of Sciences, 19 Bolshoi Karetnyi, Moscow, 127994 Russia
a.skorobogatov@imperial.ac.uk

44

