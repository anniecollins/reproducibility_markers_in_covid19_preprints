A geometric pathway to scalable quantum sensing
Mattias T. Johnsson, Nabomita Roy Mukty, Daniel Burgarth, Thomas Volz and Gavin K. Brennenâˆ—

arXiv:1908.01120v5 [quant-ph] 9 Nov 2020

Center for Engineered Quantum Systems, Dept. of Physics & Astronomy, Macquarie University, 2109 NSW, Australia
Entangled resources enable quantum sensing that achieves Heisenberg scaling, a quadratic improvement on the standard quantum limit, but preparing large N spin entangled states is challenging in the presence of decoherence. We present a quantum control strategy using highly nonlinear
geometric phase gates which can be used for generic state or unitary synthesis on the Dicke subspace with O(N ) or O(N 2 ) gates respectively. The method uses a dispersive coupling of the spins
to a common bosonic mode and does not require addressability, special detunings, or interactions
between the spins. By using amplitude amplification our control sequence for preparing states ideal
for metrology can be significantly simplified to O(N 5/4 ) geometric phase gates with parameters that
are more robust to mode decay. The geometrically closed path of the control operations ensures
the gates are insensitive to the initial state of the mode and the sequence has built-in dynamical
decoupling providing resilience to dephasing errors.

Introduction.â€” Quantum enhanced sensing offers the
possibility of using entanglement in an essential way to
measure fields with a precision superior to that which
can be obtained with unentangled resources [1â€“4]. Entangled resources allow the measurement sensitivity to
scale as 1/N with respect to the resources applied
âˆš (socalled Heisenberg scaling), compared to the 1/ N obtained otherwise (the standard quantum limit, or shotnoise limit) [4â€“6].
Creating large-scale entanglement in multipartite systems for the purposes of metrology is a difficult problem for a number of reasons. There is the difficulty in
precisely constructing the required quantum state using
realistic quantum operations, the need to protect that
quantum state from decoherence and loss [7], and the
problem of carrying out a number of quantum measurement operations on the state with precise control.
From a metrology perspective, there is also the issue
that many schemes claim to achieve Heisenberg limit by
virtue of quadratic scaling of the Fisher information of
the system [8]. While this ensures that there is an observable which has an uncertainty that scales as 1/N with
respect to some resource, it does not specify what that
observable is, or require it be a convenient experimentally measurable quantity. There have been attempts to
address these problems in various ways. For example,
to mitigate the decoherence issue, recent work has suggested using quantum error correction assisted metrology (see [9] and references therein) or phase protected
metrology [10]. Such workarounds require the ability to
perform complex quantum control in the former case or
engineered interactions in the latter.
Here we present a state preparation scheme and measurement protocol using geometric phase gates generalizing Ref. [11]. Our protocol addresses the issues of state
preparation, decoherence protection, and choice of measurement operator. It is relatively simple to engineer as
it involves only the coupling of an ensemble of qubits to
a common bosonic mode, e.g. a cavity or mechanical oscillation, as well as simple global control pulses on the

spins and mode. As such it is adaptable to a variety of
architectures at the forefront of quantum control including NV centres in diamond, trapped ion arrays, Rydberg
atoms, and superconducting qubits.
Unlike previous work our scheme does not require special engineering of the physical layout of the spins, special
detunings for adiabatic state preparation, addressability,
or direct interaction between the spins. Furthermore,
it exceeds the performance of spin squeezing protocols
because of the highly nonlinear nature of the geometric
phase gates used. Another advantage is that due to the
geometric nature of the gate, it is completely insensitive
to variations or uncertainties in the rate at which the
perimeter is traversed.
Furthermore, our protocol has dynamical decoupling
built in, providing resilience against dephasing during
the state preparation, which is the dominant source of
noise in many physical implementations. While dynamical decoupling has been considered [12] in the context
of the MÃ¸llmer-SÃ¸renson geometric gate [13], our scheme
extends this to a highly nonlinear geometric phase gate
and a full quantum state preparation algorithm.
Method.â€” We consider a collection of two-level
spin half systems, and define the collective raising
and
angular momentum operators as J + =
PN lowering
+
âˆ’
= (J + )â€  , and the components of the total
j=1 Ïƒj , J
angular momentum P
vector are J x = (J + + J âˆ’ )/2, J y =
+
âˆ’
z
(J âˆ’ J )/2i, J = j (|0ij h0| âˆ’ |1ij h1|)/2. Dicke states
are simultaneous eigenstates of angular momentum J and
J z : |J = N/2, J z = M i, M = âˆ’J, . . . , J.
Consider the measurement of a field which generates
a collective spin rotation about an axis perpendicular to
zÌ‚ given by U (Î·) = exp [iÎ·(J x sin Î´ + J y cos Î´)]. For a
measurement operator O on the system, the single shot
estimation of the parameter Î· has variance
(âˆ†Î·)2 =

(âˆ†O(Î·))2
.
|âˆ‚Î· hO(Î·)i|2

(1)

When the measured observable is O = J z 2 , the parame-

2
ter variance is [14]
(âˆ†Î·)2 = (âˆ†J x 2 )2 f (Î·) + 4hJ x 2 i âˆ’ 3hJ y 2 i âˆ’ 2hJ z 2 i

Ã— (1 + hJ x 2 i) + 6hJ z J x 2 J z i (4(hJ x 2 i âˆ’ hJ z 2 i)2 )âˆ’1

Assuming the number of spins n is even, we consider
N/2 sequential applications of the GPG (see also [11]):
N/2

W (`) =

UGP G (Î¸k , Ï†k (`), Ï‡)

k=1

z2 2

)
2
with f (Î·) = (âˆ†J(âˆ†J
x 2 )2 tan2 (Î·) + tan (Î·). When the initial
state is the Dicke state |J, 0i, the estimate angle satisfies
z2
(Î·)i
sin2 (Î·) = 8hJ
N (N +2) and the uncertainty in the measured
angle is minimized at Î·min = 0 such that the quantum
CrameÌr-Rao bound is saturated:

2
(âˆ†Î·) =
.
N (N + 2)
2

(2)

UGP G (Î¸, Ï†, Ï‡) = D(âˆ’Î²)R(Î¸J z )D(âˆ’Î±)R(âˆ’Î¸J z )
Ã— D(Î²)R(Î¸J z )D(Î±)R(âˆ’Î¸J z )
z

+Ï†)

.

=

(3)

where Ï† = arg(Î±) âˆ’ arg(Î²) and Ï‡ = |Î±Î²|.
The system and the mode are decoupled at the end
of GPG cycle. Also, if the mode begins in the vacuum
state, it ends in the vacuum state and the first operation R(âˆ’Î¸J z ) in Eq. (3) is not needed. In the GPG it is
necessary to evolve by both R(Î¸J z ) and R(âˆ’Î¸J z ). This
can be done by conjugating with a global flip of the spins
x
x
R(Î¸J z ) = eâˆ’iÏ€J R(âˆ’Î¸J z )eiÏ€J , implying that the GPG
can be generated regardless of the sign of the dispersive coupling strength g. Furthermore, because R(Â±Î¸J z )
commutes with H0 at all steps, this conjugation will cancel the free evolution accumulated during the GPG.

J
X

eâˆ’i2Ï‡

PN/2
k=1

sin(Î¸k M +Ï†k (`))

|J, M ihJ, M |,

M =âˆ’J

with ` = 0, . . . , N .
Î¸k =

Note it is not essential that we know the angle Î´ of the
field direction in the xÌ‚ âˆ’ yÌ‚ plane [15].
The best known quantum algorithm for deterministically preparing a Dicke state |J, M i requires O((N/2 +
M )N ) gates and has a circuit depth O(N ) [16]. This
works even for a linear nearest neighbour architecture,
but requires a universal gate set and full addressability.
Other proposals exist [17â€“20], but they all suffer from
drawbacks such as not scaling beyond a few spins, strong
adiabaticity or geometry, contraints, requiring large initial Fock states of motional modes, and couplings causing
transitions outside the Dicke space.
In our setup we assume N spins with homogeneous
energy splittings described by a free Hamiltonian H0 =
Ï‰0 J z which can be controlled by semi-classical fields performing global rotations generated by J x , J y . Additionally, we assume the ensemble is coupled to a single quantized bosonic mode aÌ‚. Our scheme requires a dispersive
coupling between the n spins and the bosonic mode of
the form V = gaâ€  aJ z .
The geometric phase gate (GPG) makes use of two basic operators [11, 21], the displacement operator D(Î±) =
â€ 
âˆ—
â€ 
z
eÎ±a âˆ’Î± a and the rotation operator R(Î¸J z ) = eiÎ¸a aJ
which perform a closed loop in the mode phase space

= eâˆ’i2Ï‡ sin(Î¸J

Y

2Ï€k
,
N +1

Ï†k (`) =

2Ï€k(N/2 âˆ’ `) Ï€
+ ,
N +1
2

Ï‡=

Ï€
,
N +1

gives W (`) = eâˆ’iÏ€|J,`âˆ’N/2ihJ,`âˆ’N/2| meaning it applies a
Ï€ phase shift on the symmetric state with ` excitations.
For N odd we can use N GPGs with the same angles
Î¸k , Ï†k (`) as above but with Ï‡ = 2(NÏ€+1) .
Given the control toolbox above of global rotations and the GPGs, one can synthesize an arbitrary
unitary P
operator on the Dicke subspace.
Writing
N
iÎ»k |Î»k ihÎ»k |
,
where
{|Î»
i}
form
an orU =
e
k
k=1
thonormal basis on the Dicke subspace, and Î»k âˆˆ R
(note since the global phase is irrelevant we have
set Î»2J+1 = 0). This unitary can be decomposed
QN âˆ’1
iÎ»k |J,âˆ’JihJ,âˆ’J| â€ 
as U =
K (Î»k )], where
k=1 [K(Î»k )e
K(Î»k ) is any unitary extension of the state synthesis mapping |J, âˆ’Ji â†’ |Î»k i. The phasing unitary
is the same as W (0) but with Ï‡ â†’ Î»k /(N + 1).
To construct K(Î»k ), we find the decomposition: KÌƒ =
QN âˆ’1
yÏ€
y
yÏ€
[ s=1 eiÎ²s J UGP G (Î¸s , Ï†s , Ï‡s )]eâˆ’iJ 2 UGP G ( Ï€2 , 0, Ï€4 )eiJ 2
gives very accurate results when optimized over the
4N âˆ’ 4 free parameters {Î²s , Î¸s , Ï†s , Ï‡s } [22]. The overall
complexity in GPG count using this approach is N for
state synthesis and 5N 2 /2 for unitary synthesis.
While the general state synthesis approach above can
be used for building Dicke states, the N âˆ’ 1 action angles {Ï‡s } that optimize state fidelity are O(1) and this
has implications for noise due to mode decay as described below. We now describe a way, based on amplitude amplification, to improve matters by only using the GPGs that appear in W (`) that have action
angles O(1/N ), and with the added advantage of providing an analytical solution to the Dicke state synthesis problem. Starting with all spins down, i.e. in
|J, âˆ’Ji, let the target state be |wi = |J, 0i. We will
make use of the operators Uw = eâˆ’iÏ€|wihw| = W (N/2)
y
y
and Us = eâˆ’iÏ€|sihs| = eiJ Ï€/2 W (0)eâˆ’iJ Ï€/2 . In total the
operators Uw and Us each use N/2 GPGs. The orbit
of the initial state |si under the operators Uw and Us ,
is restricted to a subspace spanned by the orthonor|siâˆ’|wihw|si
mal states |wi and |s0 i = âˆš
, exactly as in
2
1âˆ’|hw|si|

Groverâ€™s algorithm. The composite pulse is one Grover
step UG = Us Uw . Geometrically, relative to the state
|s0 i, the initial state |si is rotated by an angle Î´/2 toward |wi, where Î´ = 2 sinâˆ’1 (|hw|si|), and after each

3

(4)

The fidelity overlap of the output state Ï of the protocol
with the target state is F = Tr(|wihw|Ï). For the Grover
method it is easily calculated as
p
(5)
F = sin2 ((#G + 1/2)Î´) > 1 âˆ’ 2/Ï€N .
p
While the fidelity error falls off at least as fast as 2/Ï€N
for all N  1, if N is near a value where the argument
in Eq. (4) is a half integer, i.e. d32(2k + 1)4 /Ï€ 5 e, with
k âˆˆ Z, the error will be much lower. For example, at
N = (10, 70, 260, 700, 1552) the fidelity error is (1.84 Ã—
10âˆ’4 , 1.57 Ã— 10âˆ’5 , 1.68 Ã— 10âˆ’6 , 3.65 Ã— 10âˆ’8 , 1.92 Ã— 10âˆ’8 ).
The number of GPGs needed to prepare the Dicke state
by the Grover method is c Ã— N 5/4 with a constant c < 1.
The effectiveness of our scheme when used for metrology is shown in Figure 1, which shows the precision âˆ†Î·
obtainable as a function of N , compared to that obtained
from both the standard quantum limit and the ultimate
CrameÌr-Rao bound. It also shows the fidelity obtainable
as a function of the number of spins N . The achievable
fidelity is clearly optimized for specific spin values.
We have focused on preparing the state |J, 0i, but
with simple modifications our protocol can prepare any
Dicke state |J, M i. First use the initial state |si =
y
eiM J |J, âˆ’Ji, and second substitute the operators Uw =
y
y
W (M + N/2) and Us = eiM J W (0)eâˆ’iM J where M =
cosâˆ’1 (M/J). Now the relevant overlap is |hw|si| =
|dJM,âˆ’J (âˆ’M )|, and for J âˆ’ |M |  1, |dJM,âˆ’J (âˆ’)| â‰ˆ
âˆš
( Ï€J sin M )âˆ’1/2 [23], implying #G = O(N 1/4 ).
Finally, measurement of J z 2 could be done by again
coupling the spins to the bosonic mode but now with
a linear coupling Vm = gm J z (aâ€  + a) which generates
a mode displacement depending on the collective spin
projection. When the mode is in a number diagonal
state, e.g. a thermal state, with mean excitation number nÌ„, the measurement of nÌ‚ after a coupling time Ï„ is
hnÌ‚i = nÌ„ + (gm Ï„ )2 hJ z 2 i. If mode number and quadratic
spin operator measurements are difficult there are alternatives. One is estimation by a classical average over
2
Pp
, where M (k) is
p experiments: E[hJ z 2 i] = k=1 M (k)
p
the outcome of the kth measurement of J z [24]. Another is, after accumulating the signal, one could invert
the state preparation and measure |J, âˆ’JihJ, âˆ’J| which
gives the same precision scaling as Eq. (1), but doesnâ€™t
require number resolved excitation counts.
There will be errors due to decay of the bosonic mode
during the operations, as well as decoherence due to en-

0.100
0.050

0.500
0.500

SN Limit
SN Limit
SN Limit

0.100
0.100
0.050
0.995
0.050
F
1.000

Î”Î·Î”Î·

#G = bÏ€ 5/4 N 1/4 /29/4 c.

0.500

Î”Î·

Grover step is rotated a further angle Î´ toward the target. The optimal number
of kGrover iterations to reach
j
Ï€
the target is #G = 4|hw|si| where the relevant overp
lap is hw|si = dJâˆ’J,0 (Ï€/2) = 2âˆ’J (2J)!/J!. For J  1
we have hw|si â‰ˆ (Ï€J)âˆ’1/4 . Then the optimal number of
Grover steps is

0.010
0.005

CR Bound

0.990

0.010
1
2 3 4 5
0.010
0.005
0.980
2
4
6
0.005 N 1/4
5 10
0.985

7

6
8

8
10

CR Bound
CR Bound

50 100
500 1000
5 N10
50 100
500 1000
n
N n50 100
5 10
500 1000
Nn

FIG. 1. Measurement precision âˆ†Î· as a function of number of spins (log-log scale). Shown are the shot noise limit,
the quantum CrameÌr-Rao bound Eq. (2), and this protocol
(blue). Inset: Fidelity for sets of ensemble sizes using the
same number of Grover steps, which grow as N 1/4 .

vironmental coupling to the spins, which will degrade the
fidelity. We now address these.
Mode damping.â€” We treat the mode as an open quantum system with decay rate Îº. In order to disentangle the spins from the mode, the third and fourth
displacement stages of the k-th GPG should be modified to D(âˆ’Î±k ) â†’ D(âˆ’Î±k eâˆ’ÎºÎ¸k /g ) and D(âˆ’Î²k ) â†’
D(âˆ’Î²k eâˆ’ÎºÎ¸k /g ). For simplicity we choose |Î±k | = |Î²k |.
For P
an input spin state in the symmetric Dicke space
Ï = M,M 0 ÏM,M 0 |J, M ihJ, M 0 |, the process for the kâˆ’th
GPG with decay on the spins, including the modified displacement operations above, is [43]
P
(k)
0
E (k) (Ï) = UGP G (Î¸k , Ï†k , Ï‡k )
M,M 0 RM,M 0 ÏM,M .

â€ 
0
|J, M ihJ, M | Ã— UGP G (Î¸k , Ï†k , Ï‡k )
where Ï‡k = |Î±k |2 f (Î¸k ), f (Î¸k ) = (eâˆ’3Î¸k Îº/2g + eâˆ’Î¸k Îº/2g )/2
and Î“M,M 0 and âˆ†M,M 0 are given in the Supplementary
Material [26].
The full operation is a concatenation of these imperfect
processes E (k) (Ï), and we characterise its accuracy with
the process fidelity Fpro (E, U ), which measures how close
a quantum operation E is to the ideal operation U [28].
For each GPG we can readily find the lower bound on
the process fidelity (see Supplementary Material [26])
Fpro (E, UGPG ) > eâˆ’6Ï€Ï‡k Îº/f (Î¸k )g cos(Ï‡k 4Ï€Îº/f (Î¸k )g).
Note the scaling of the exponent with 1/N since the action angles Ï‡ are O(1/N ). For the composite phasing
map, numerically we find the tighter bound for the fi2
delity Fpro (E, W (`)) > eâˆ’Ï€ Îº/g which is notably independent of N .
Dephasing: We next address spin decoherence. We assume that amplitude damping due to spin relaxation is
small by the choice of encoding. This can be accommodated by choosing qubit states with very long decay times

4

g 2 |f (Ï‰)|2 â‰ˆ

(Ï‰/g)2 Ï€ 4 N 2 (N + 2)2
.
9(N + 1)2

(6)

105

g 2 | f(Ï‰) |2

either as a result of selection rules, or by being far detuned from fast spin exchange transitions. Hence we will
focus on dephasing. Due to the cyclic evolution during
each GPG, there is error tolerance to dephasing because
if the interaction strength between the system and environment is small compared to g, then the spin flip pulses
used between each pair of dispersive gates R(Î¸aâ€  a) will
echo out this noise to low order.
For a given input density matrix Ï(0), the output after a total time T has off-diagonal matrix elements that
0 2
decay as ÏM,M 0 (T ) = ÏM,M 0 (0)eâˆ’(M âˆ’M ) A(T ) . For the
global dephasing map the numbers M, M 0 âˆˆ [âˆ’N/2, N/2]
are in the collective Dicke basis, while for local dephasing
it is with respect to a local basis M, M 0 âˆˆ [âˆ’1/2, 1/2].
Our argument for suppression of dephasing works for
both cases. Global dephasing is the most deleterious
form of noise when the state has large support over coherences in the Dicke subspace, due to decay rates that scale
quadratically in the difference in M number. However, it
leaves the total Dicke space, and in particular the target
Dicke state, invariant. Local dephasing induces coupling
outside the Dicke space, but with a rate that is at most
linear in N .
Consider the evolution during the N/2 control pulses
to realize either of the phasing gates Us or Uw . Assuming
Gaussian bath statistics, the effective dephasing rate can
be written as the overlap of the noise spectrum S(Ï‰)
and the filter function |f (Ï‰)|2 [47, 48]. As shown in the
Supplementary material [26], for our pulse sequence to
lowest order in Ï‰/g we find

10

0.001

10-4

0.010

Ï‰/g

0.100

1

FIG. 2. Suppression of dephasing via dynamical decoupling
inherent in the sequence of GPGs used for each of the operators Us and Uw . Solid curves are filter functions using the
GPGs. Dashed curves are plots of Eq. (26), which is a good
approximation for Ï‰/g < 1/Ï€N . Short-dashed curves are the
bare case without decoupling. (Red, green, blue) curves correspond to n = (10, 100, 1000) spins.

0.20

SN Limit
0.10

0.05

CR Bound

0.02
10-8

Comparison with the case where no spin flips are applied
is plotted in Fig. 2 showing there is substantial decoupling from the dephasing environment when the spectral
density has dominant support in the range Ï‰ < g/2.
The freedom to apply the GPGs in any order allows
for further improvement. Consider coupling to a zero
temperature Ohmic bath with noise spectrum S(Ï‰) =
Î±Ï‰eâˆ’Ï‰/Ï‰c with cutoff frequency Ï‰c /g = 0.1. For N = 20,
the ratio of the effective decay rate for the linearly ordered sequence of GPGs above to that with no decoupling is A(T )/A0 (T ) = 0.0085. However, by sampling
over permutations of the ordering of GPGs we find a sequence [49] achieving A(T )/A0 (T ) = 0.0026. Examples
of the effectiveness of our decoupling protocol on sensitivity for various values of A(T ) are shown in Figure 3.
Effectiveness on the fidelities can be found in the Supplementary Material [26].
Error-tolerant states.â€” The state preparation method
we have described has inherent tolerance to decoherence.
However once the state is prepared further errors such as
qubit loss or dephasing could accumulate. Strategies to
address this by using superpositions of Dicke states were

0.001

10-7

10-6

Îº /g

10-5

10-4

0.001

g

FIG. 3. Precision obtained for 70 spins with a single measurement of J z 2 as a function of mode decay for various
global dephasing factors A(T ): no global dephasing (blue
line), A(T ) = 10âˆ’6 (blue dashed), A(T ) = 10âˆ’5 (blue dotdashed), A(T ) = 10âˆ’4 (blue dotted). These dephasings correspond to an underlying decoherence rate of Î³gdp = 10âˆ’4 g
accumulated over each phasing gate of duration T . For a zero
temperature Ohmic bath, the corresponding cuttoff frequencies are: Ï‰c /g = {0.003, 0.022, 0.094}. Black line: performance without dynamical decoupling with A0 (T ) = 0.0223.

recently proposed [44]. The states considered were
s 
n
n
knu
1 X
|J =
, M = kj âˆ’ Ji.
|Ï•u i = âˆš
2
j
2n j=0
The number of spins N = k Ã— n Ã— u, and the parameters u and n determine the robustness of the states
to some number of loss and dephasing errors respectively. A state performing well in the presence of one

5
erasure error is u = 1, n = 2,âˆšk = N/2, which can
be written |Ï•1 i = 21 (|J, âˆ’Ji + 2|J, 0i + |J, Ji) while
u = 2, n = 1, k = N/2 tolerates one dephasing error and
can be written |Ï•2 i = âˆš12 (|J, âˆ’Ji + |J, 0i). Both of these
states can be prepared using our protocol. The specific
steps are given in the Supplementary Material [26]. Superpositions of Dicke states also arise as code words of
so-called permutationally invariant quantum codes [46],
and of recently discovered codes which admit Gaussian
Clifford operations [34] which our method could also prepare.
Implementations.â€” The scheme we have presented is
amenable to a variety of architectures which allow collective dispersive couplings between spins and an oscillator. These include: trapped Rydberg atoms coupled
to an microwave cavity [35, 36], trapped ions coupled to
a common motional mode [37] or to an optical cavity
mode [38], superconducting qubits coupled to microwave
resonators [39], and NV centres in diamond coupled to a
microwave mode inside a superconducting transmission
line cavity [40].
One contender to test our scheme is Rydberg atoms
coupled to microwave cavities. Recently the dispersive
detection of small atomic Rydberg ensembles coupled to
a high-Q microwave cavity was reported [36]. Their numbers suggest a ratio of Îº/g â‰ˆ 0.8 (with Îº = 2Ï€ Ã— 11.8 kHz
and g = 2Ï€ Ã— 14.3 kHz). The collective coupling rate
observed was a few MHz, suggesting an additional pathway to improving Î³/g by orders of magnitude by encoding spins through collective subensembles. Consider
an encoding where each spin is composed of n physical spins with logical states |0i = |j = n/2, âˆ’ji and
|1i = |j = n/2, âˆ’j + 1i, i.e. the permutationally invariant states of zero or one excitation shared among the
n spins. If the spins within each logical qubit interact,
e.g. via dipole-dipole interactions, there will be a dipoleblockade to larger numbers of excitations. Hence collective rotations frequency-tuned to the transition energy
E1 âˆ’ E0 will be collective but only act on this qubit subspace.âˆšThe dispersive interaction strength is enhanced by
g â†’ g n, provided the number n is similar for all logical
spins. Using this kind of encoding, dispersive coupling
with strength g â‰ˆ 2Ï€ Ã— 2.2 MHz was obtained with NV
ensembles in diamond bonded onto a transmission line
resonator with quality factor Q â‰ˆ 4300 at the first harmonic frequency Ï‰1 = 2Ï€ Ã— 2.75 GHz. Microwave cavities with much higher quality factors, e.g. Q â‰ˆ 109 , have
been realized [42] which for the same dispersive coupling
could provide Îº/g â‰ˆ 10âˆ’6 .
We acknowledge helpful discussions with Jason
Twamley and Yingkai Ouyang. This research was funded
in part by the Australian Research Council Centre of Excellence for Engineered Quantum Systems (Project number CE170100009).

SUPPLEMENTAL INFORMATION
Gate fidelity with cavity decay

Cavity field decay at a rate Îº acts as a source of error
for the many body interactions which the cavity mode
mediates. Consider the the joint evolution of the spins
and the mode. The coupling of the mode to its environment is treated as irreversible and thus can be described
by the standard master equation in Lindblad form. The
equation of motion for the joint state is
ÏÌ‡(t) = L(Ï(t))
= âˆ’i[V, Ï(t)] +

Îº
(2aÏ(t)aâ€  âˆ’ aâ€  aÏ(t) âˆ’ Ï(t)aâ€  a).
2
(7)

The evolution due to decay conserves the quantum number J, and it will be convenient to compute the adjoint
action on on a joint state state of the spins and mode
0
with Heisenberg evolved operators eLt AM,M (0) where:
0

AM,M (t) â‰¡ |J, M ihJ, M 0 | âŠ— |Î±M ihÎ²M 0 |(t).
The solutions are easily verified to be given by
0

AM,M (t) =

âˆ
X
bnM M 0 (t) âˆ’(igM +Îº/2)aâ€  at
e
n!
n=0
0

n

Ã— an AM,M (0)(aâ€  ) e(igM

0

âˆ’Îº/2)aâ€  at

(8)

where
0

bM M 0 (t) =

Îº(1 âˆ’ eâˆ’[Îº+ig(M âˆ’M )]t )
.
Îº + ig(M âˆ’ M 0 )

(9)

The evolved state is then
Ï(t) = eLt Ï(0) =

X

0

ÏM,M 0 (0)AM,M (t).

M,,M 0

In order to evaluate the effect of cavity decay during
the the geometric phase gate, we are particularly inter0
ested in the case where initially AM,M (0) = |M ihM 0 | âŠ—
|Î±M ihÎ²M 0 |, with |Î±M i, |Î²M 0 i coherent states. This kind
of factorization is true at any stage of spin coupling to
the field. Using Eq. (8), the sum becomes an exponential
and the evolved state is
Ï(t) = eLt Ï(0)
X
=
edM,M 0 (t) ÏM,M 0 (0)|J, M ihJ, M 0 |
M,M 0

âŠ— |eâˆ’(igM +Îº/2)t Î±M iheâˆ’(igM

0

+Îº/2)t

Î²M 0 |,
(10)

where
âˆ’Îºt

âˆ—
2
2 1âˆ’e
dM,M 0 (t) = Î±M Î²M
0 bM,M 0 (t) âˆ’ (|Î±M | + |Î²M 0 | )
2

.
(11)

6
We ignore decay during the displacement stages of the
evolution (i.e. we assume these are done quickly relative
to the decay rate), and we assume that the system particles do not interact with the field during these steps. For
simplicity we evaluate the performance when the cavity
begins in the vacuum state, in which case there are seven
time steps to consider:

where
we
defined
RM,M 0
=
edM,M 0 (t2 )+dM,M 0 (t4 )+dM,M 0 (t6 ) and Ï‡ = |Î±Î²|(eâˆ’3ÎºÏ„1 /2 +
eâˆ’ÎºÏ„1 /2 )/2. This can be interpreted as coherent evolution
with an evolution operator
z

U = eâˆ’i2Ï‡ sin(Ï†+Î¸J ) ,

D(âˆ’Î²)eâˆ’iÏ„5 V D(âˆ’Î±)eiÏ„3 V D(Î²)eâˆ’iÏ„1 V D(Î±).
Let Ï„5 = Ï„3 = Ï„1 so that the periods of spin field coupling
are all equal in duration. In order that the field state
return to the vacuum at the end of the sequence, we
choose Î±0 = Î±âˆ’ÎºÏ„1 , Î² 0 = Î² âˆ’ÎºÏ„1 for the parameters of the
second two displacement operators. The total sequence
then yields the output state:
Ïout =

X

For simplicity, we assume |Î±| = |Î²|, g > 0 and write
Î¸ = gÏ„1 . The factor RM,M 0 that dictates the deviation
from perfect evolution can be written

ÏM,M 0 (0)RM,M 0 |J, M ihJ, M 0 | âŠ— |vacihvac|

M,M 0
âˆ’i2Ï‡(sin(Ï†+gÏ„1 M )âˆ’sin(Ï†+gÏ„1 M 0 ))

Ã—e

RM,M 0 = eâˆ’Î“M,M 0 eiâˆ†M,M 0

(13)

,
(12)

Î“M,M 0 =

where Î¸ = gÏ„1 , followed by further evolution diagonal in
the {M } basis and dephasing. Matrix elements diagonal
in M are invariant.

where Î“M,M 0 and âˆ†M,M 0 are real, and explicitly are

âˆ’i(Ï†+Î¸(M 0 +M âˆ’2i Îº ))
g

|Î±|2 (M âˆ’M 0 )e
2
2((M âˆ’M 0 )2 +( Îº
g) )



âˆ’ 4(M âˆ’ M 0 )ei(Î¸(M

+(âˆ’M 0 + M + i Îºg )e
+(âˆ’M 0 + M âˆ’ i Îºg )e
+e

3Î¸ Îº
g
2

+iÎ¸M

0

+M )+Ï†)

âˆ’ 4i Îºg e2iÎ¸M

0

+Î¸ Îº
g +iÏ†

1

+ (M 0 âˆ’ M + i Îºg )e 2 Î¸(2iM

3Î¸ Îº
iÎ¸M 0 +2iÎ¸M + 2g

+2iÏ†

3Î¸ Îº
2iÎ¸M 0 +iÎ¸M + 2g

+ (M 0 âˆ’ M âˆ’ i Îºg )e 2 Î¸(4iM

+2iÏ†

+ 4(M âˆ’ M 0 )ei(Ï†+Î¸(M

1

1

Îº

0

0

+4iM + Îº
g )+2iÏ†

+2iM + Îº
g )+2iÏ†

+M âˆ’2i Îº
g ))

0

0

1

Îº

+ e 2 Î¸( g +2iM ) (M 0 âˆ’ M + i Îºg )

(âˆ’M 0 + M + i Îºg ) + (M 0 âˆ’ M âˆ’ i Îºg )e 2 Î¸( g +2iM ) + (âˆ’M 0 + M âˆ’ i Îºg )e

Îº

3Î¸ Îº
g
2

+iÎ¸M 0

+4i Îºg e2iÎ¸M +Î¸ g +iÏ†

(14)
0

âˆ†M,M 0 =

0

3Î¸ Îº
g

2
i(Î¸(M +M )+2Ï†) âˆ’iÎ¸(M +M )âˆ’ 2 âˆ’iÏ†
)e
âˆ’ |Î±| (1+e
2
2((M âˆ’M 0 )2 +( Îº
g) )
 Îº
Î¸( g +iM )
e
(2M 2 âˆ’ (4M + i Îºg )M 0 + 2(M 0 )2 + iM Îºg + ( Îºg )2 ) âˆ’ (2M 2
0
Îº
eÎ¸( g +iM ) âˆ’ eiÎ¸M (2M 2 âˆ’ (4M + i Îºg )M 0 + 2(M 0 )2 + iM Îºg + 3( Îºg )2 )

0
+eiÎ¸M (2M 2 + (âˆ’4M + i Îºg )M 0 + 2(M 0 )2 âˆ’ iM Îºg + 3( Îºg )2 )

+ (âˆ’4M + i Îºg )M 0 + 2(M 0 )2 âˆ’ iM Îºg + ( Îºg )2 )

Notice, Î“M,M 0 = Î“M 0 ,M and Î“M,M = 0 and also âˆ†M,M 0 = âˆ’âˆ†M 0 ,M . An expansion up to first order in
simplified expressions:

|Î±|2 Îº
Î“M,M 0 = M âˆ’Mg 0 2 sin(Î¸M 0 + Ï†) âˆ’ Î¸M 0 (cos(Î¸M 0 + Ï†) + cos(Î¸M + Ï†) + 4) + Î¸M (cos(Î¸M 0 + Ï†))

âˆ’4(sin(Î¸(M âˆ’ M 0 ))) âˆ’ 2(sin(Î¸M + Ï†)) + Î¸M (cos(Î¸M + Ï†)) + 4Î¸M
âˆ†M,M 0 = |Î±|2 Î¸ Îºg (âˆ’ sin(Î¸M 0 ) + i(cos(Î¸M 0 )) + sin(Î¸M ) âˆ’ i(cos(Î¸M )))(cos(Î¸M 0 + Î¸M + Ï†)
âˆ’i(sin(Î¸M 0 + Î¸M + Ï†)))(i(sin(Î¸(M 0 + M ) + 2Ï†)) + cos(Î¸(M 0 + M ) + 2Ï†) + 1)

Now, one can check that the decoherence factors are

Îº
g

(15)
yields

(16)

(17)

bounded as follows: Î“M,M 0 â‰¤ |Î±|2 6Ï€Îº/g and |âˆ†M,M 0 | â‰¤

7
|Î±|2 4Ï€Îº/g.
In order to obtain a more rigorous process fidelity bound, we proceed as follows.
For an input
spin
state
in
the
symmetric
Dicke
space
Ï =
P
0
0 |J, M ihJ, M |, the process for the kâˆ’th
Ï
0
M,M
M,M
GPG with decay on the spins, including the modified
displacement operations above, is [43]
P
(k)
0
E (k) (Ï) = UGP G (Î¸k , Ï†k , Ï‡k )
M,M 0 RM,M 0 ÏM,M .

â€ 
0
|J, M ihJ, M | Ã— UGP G (Î¸k , Ï†k , Ï‡k )
(18)
where

space HS âŠ— HS 0 containing our system space and a copy
each with dimension D:

Ï‡k = |Î±k |2 (eâˆ’3Î¸k Îº/2g + eâˆ’Î¸k Îº/2g )/2

From the limits above, we readily find the process fidelity
bound

and

ÏE 0 = IS âŠ— ES0 0 (|Î¦+ iS,S 0 )
1 X
Î¥M,M 0 (`) |M iS hM 0 | âŠ— |M iS 0 hM 0 |.
=
D
0
M,M

Hence
Fpro (E, W (`)) =

1
(N + 1)2

2

(k)
RM,M 0

Fpro (E, UGPG ) > eâˆ’6Ï€|Î±|

âˆ’Î“M,M 0 (Î¸k ,Ï†k ,Î±k ) iâˆ†M,M 0 (Î¸k ,Ï†k ,Î±k )

=e

2Ï€
(N +

Î¥M,M 0 (`),

M,M 0 =âˆ’J

Îº/g

cos(|Î±|2 4Ï€Îº/g).

(21)

e

with the factors Î“M,M 0 and âˆ†M,M 0 given above. Now if
we adjust Î± such that on the k-th GPG, Ï‡k = Ï€/(N + 1),
then we have
|Î±k |2 =

J
X

1)(eâˆ’3Î¸k Îº/2g

+ eâˆ’Î¸k Îº/2g )

Finally we note that numerical simluation suggests a
tighter bound given by
Fpro (E, W (`)) > eâˆ’Ï€

2

Îº/g

.

(22)

Notably, this fidelity is independent of N .

.

Because the coherent and decoherent maps for different
GPGs commute, the entire sequence that phases a Dicke
state according to W (`) is:
E(Ï) = E (N/2)P
â—¦ Â· Â· Â· â—¦ E (1) (Ï)
= W (`) M,M 0 Î¥M,M 0 (`)ÏM,M 0 |J, M ihJ, M 0 |W (`)â€ 
(19)
This describes ideal evolution followed by a nonlinear dephasing map, where the decoherence factor is
QN/2 (k)
Î¥M,M 0 (`) =
k=1 RM,M 0
PN/2
= exp k=1 (âˆ’Î“M,M 0 (Î¸k , Ï†k (`), Î±k )
+iâˆ†M,M 0 (Î¸k , Ï†k (`), Î±k )) .

A loose upper bound on precision as function of
fidelity

The precision of the estimation parameter Î· is expressed as
(âˆ†Î·)2 = (âˆ†J x 2 )2 f (Î·) + 4hJ x 2 i âˆ’ 3hJ y 2 i âˆ’ 2hJ z 2 i

Ã— (1 + hJ x 2 i) + 6hJ z J x 2 J z i (4(hJ x 2 i âˆ’ hJ z 2 i)2 )âˆ’1
(23)

(20)

To check how the precision scales in relation to the
fidelity, F , we can calculate the precision assuming an
input density matrix, Ï = a|J, 0ihJ, 0| + b1, where |J, 0i
is our ideal Dicke state, 1 is the identity matrix of size
(N + 1) Ã— (N + 1) and a and b are related to fidelity as
a = (1 + 1/N )F âˆ’ 1/N and b = (1 âˆ’ F )/N . We choose
this form for the input density matrix so that applying a
global dephasing map to the output state of our protocol would make it diagonal in the |J, M i basis but keep
the population in |J, 0i constant. Assuming the diagonal matrix elements (except the |J, 0ihJ, 0| entry) are
equally weighted is a maximally unbiased assumption.
After calculating the variances and expectation values
of the angular momentum operators as they appear in
Equation (23), then taking the high fidelity limit F â†’ 1
and assuming large N , the precision is found to be
p
(24)
(âˆ†Î·)2 = 2/(N (N + 2)) + (1 âˆ’ F )/10,

Here we are computing the overlap of the JamiolkowskiChoi representations of the maps as states in the Hilbert

where 2/(N (N + 2)) is the CrameÌr-Rao bound. Numerically we find this approximate form is extremely good
for 1 âˆ’ F < 10âˆ’2 .

The process fidelity Fpro (E, U ) measures how close a
quantum operation E is to the ideal operation U as measured by some suitable metric. The fidelity measure we
use is the overlap between the induced JamiolkowskiChoi state representations of the operations. The process fidelity is readily computed using the fact that the
noise map E(ÏS (0)) commutes with the target unitary U .
Hence, we can compute the fidelity which measures how
close the noisy map E 0 (ÏS (0)) = U â€  E(ÏS (0))U is to the
ideal operation, i.e. the identity operation:
Fpro (E, U ) = Fpro (E 0 , I) =S,S 0 hÎ¦+ |ÏE 0 |Î¦+ iS,S 0 .
where
1 X
|J, M iS âŠ— |J, M iS 0 ,
|Î¦+ iS,S 0 = âˆš
D M

8
For our choice of the input density matrix, there appears to be a lower bound to the precision (as a function
of N ) that is set by the fidelity. If we would want the
overall expression to fall off as 1/N 2 , i.e to achieve the
Heisenberg scaling, then we would need the error 1 âˆ’ F
to scale as 1/N 4 . While this requirement is demanding
in terms of performance, it should be noted that we have
assumed that all the populations in |J, M i, M 6= 0 are
equal when in fact the non-zero terms in the output density matrix are much more concentrated near the target
state |J, 0i for our protocol. As the precision involves
4
terms like expectation values of J z , error terms with
support on states far away from |J, 0i will give large errors. Thus, we are overestimating the error in this case
and this should be viewed as a loose upper bound on the
precision.

and n(Ï‰k ) = (eÎ²Ï‰k âˆ’1)âˆ’1 is the thermal occupation number in bath mode k. The filter function is obtained
from
RT
the windowed Fourier transform f (w) = 0 C(t)eiÏ‰t ,
where C(t) is the time-dependent control pulse sequence.
In the present case C(t) is a unit sign function that flips
every time a collective spin flip is applied:
ï£±
N/2
(0)
(1)
(2)
(3)
ï£´
ï£² 1 t âˆˆ âˆªk=1 {[Tk , Tk ) âˆª [Tk , Tk )}
N/2
(1)
(2)
(3)
(4)
C(t) = âˆ’1 t âˆˆ âˆªk=1 {[Tk , Tk ) âˆª [Tk , Tk )}
ï£´
ï£³ 0
otherwise
Pkâˆ’1
(m)
where Tk
= mÎ¸k /g + 4 j=1 Î¸j /g are the flip times
with the duration between pulses growing linearly. The
angles are Î¸k = N2Ï€k
+1 and the total time is
(4)

T = TN/2 =
Dephasing rates and compensation via dynamical
decoupling

The explicit form of the filter function is
|f (Ï‰)|2 =

Due to the cyclic evolution during each GPG, there
is error tolerance to dephasing because if the interaction
strength between the system and environment is small
compared to g, then the spin flip pulses used between
each pair of dispersive gates R(Î¸aâ€  a) will echo out this
noise to low order.
For a given input density matrix Ï(0), the output after a total time T has off-diagonal matrix elements that
0 2
decay as ÏM,M 0 (T ) = ÏM,M 0 (0)eâˆ’(M âˆ’M ) A(T ) . For the
global dephasing map the numbers M, M 0 âˆˆ [âˆ’N/2, N/2]
are in the collective Dicke basis, while for local dephasing
it is with respect to a local basis M, M 0 âˆˆ [âˆ’1/2, 1/2].
Our argument for suppression of dephasing works for
both cases. Global dephasing is the most deleterious
form of noise when the state has large support over coherences in the Dicke subspace, due to decay rates that
scale quadratically in the difference in M number. However, it leaves the total Dicke space, and in particular the
target Dicke state, invariant. In contrast, local dephasing induces coupling outside the Dicke space, but with a
rate that is at most linear in N .
Consider the evolution during the N/2 control pulses
to realize either of the phasing gates Us or Uw . Assuming
Guassian bath statistics, the effective dephasing rate can
be written as the overlap of the noise spectrum S(Ï‰) and
the filter function |f (Ï‰)|2 (see e.g. [47, 48]):
Z âˆ
1
dÏ‰S(Ï‰)|f (Ï‰)|2 .
(25)
A(T ) =
2Ï€ 0
For an initial system-bath state Ï(0) = ÏS (0) âŠ—
QÏB (0)
with the bath in thermal equilibrium ÏB (0) = k (1 âˆ’
â€ 
eâˆ’Î²Ï‰k )eâˆ’Î²Ï‰k bk bk at inverse temperature Î² (kB â‰¡ 1), the
noise spectrum
is S(w) = 2Ï€(n(Ï‰) + 1/2)I(Ï‰), where
P
I(Ï‰) = k |gk |2 Î´(Ï‰ âˆ’ Ï‰k ) is the boson spectral density,

Ï€N (N + 2)
.
g(N + 1)

1
Ï‰2

PN/2

k=1 (e

(0)

iÏ‰Tk

(3)

(1)

(2)

âˆ’ 2eiÏ‰Tk + 2eiÏ‰Tk

(4)

2

âˆ’2eiÏ‰Tk + eiÏ‰Tk ) .
In comparison, consider evolution where no spin flips
are applied during the sequence, in which case the bare
functions are C (0) (t) = 1âˆ€t âˆˆ [0, T ), and |f (0) (Ï‰)|2 =
4 sin2 (T Ï‰/2)/Ï‰ 2 . Results are plotted in Fig. 3 in the
main paper and show there is substantial decoupling from
the dephasing environment when the spectral density has
dominant support in the range Ï‰ < g/2. For 2Ï€kÏ‰/g 
1, the summands in f (Ï‰) can be expanded in a Taylor
series in Ï‰/g and to lowest order we find
g 2 |f (Ï‰)|2 â‰ˆ

(Ï‰/g)2 Ï€ 4 N 2 (N + 2)2
.
9(N + 1)2

(26)

This approximation is valid for Ï‰/g < 1/Ï€N , and,
as shown in Fig. 3 in the main paper, for 1/Ï€N <
Ï‰/g < 1/2 the function is essentially flat with an average value g 2 |f (Ï‰)|2 â‰ˆ 3 independent of N . In the region 1/Ï€N < Ï‰/g < 1/2 the bare filter function is oscillatory and has an average g 2 |f (0) (Ï‰)|2 â‰ˆ 13.63, while
2
2
(N +2)2
for Ï‰/g < 1/Ï€N it asymptotes to Ï€ N
. Thus, in
(N +1)2
the region Ï‰/g < 1/Ï€N the ratio determining the reduc2
tion factor in the dephasing rate is |f|f(0)(Ï‰)|
= Ï€ 2 Ï‰ 2 /g 2 ,
(Ï‰)|2
while for Ï‰/g âˆˆ [1/Ï€N, 1/2], the reduction factor can
be approximated by

|f (Ï‰)|2
|f (0) (Ï‰)|2

â‰ˆ 0.22, provided the noise

spectrum is sufficiently flat there. The effectiveness of
this decoupling on precision and state precision fidelity
is shown in Figure 4.
Further, the aforementioned freedom to apply the
GPGs in any order allows room for further improvement.
For example, consider coupling to a zero temperature
Ohmic bath with noise spectrum S(Ï‰) = Î±Ï‰eâˆ’Ï‰/Ï‰c and

9
(a)

they suggest using superpositions of Dicke states as probe
states. The class of states considered there are
s 
n
n
knu
1 X
|J =
, M = kj âˆ’ Ji.
|Ï•u i = âˆš
j
2
2n j=0

0.20

SN Limit
0.10

0.05

CR Bound

0.02
10-8

(b)

10-7

10-6

1

10-5

10-4

0.001

g

0.100

1-F

0.010

0.001

10-4
10-5
10-8

10-7

10-6

Îº /g

10-5

10-4

0.001

g

FIG. 4. a) Precision obtained for 70 spins with a single
measurement of J z 2 as a function of mode decay for various global dephasing factors A(T ): no global dephasing (blue
line), A(T ) = 10âˆ’6 (blue dashed), A(T ) = 10âˆ’5 (blue dotdashed), A(T ) = 10âˆ’4 (blue dotted). These dephasings correspond to an underlying decoherence rate of Î³gdp = 10âˆ’4 g
accumulated over each phasing gate of duration T . For a zero
temperature Ohmic bath, the corresponding cuttoff frequencies are: Ï‰c /g = {0.003, 0.022, 0.094}. Black line: performance without dynamical decoupling with A0 (T ) = 0.0223.
e.g. if one were to switch the sign of the dispersive coupling
during each GPG rather than flipping the spins. (b) Fidelity
error for the same environments as above.

having cutoff frequency Ï‰c /g = 0.1. For N = 20, the
ratio of the effective decay rate for the linearly ordered
sequence of GPGs above to that with no decoupling is
A(T )/A0 (T ) = 0.0085. However, by sampling over permutations of the ordering of GPGs we find a sequence
[49] achieving A(T )/A0 (T ) = 0.0026.

Preparation of error-tolerant states

The state preparation method we have described so far
has some inherent tolerance to decoherence. However,
once the state is prepared, further errors could accumulate such as qubit loss or dephasing, while waiting for the
accumulation of the measurement signal. Some strategies
to address this were recently proposed in Ref. [44] where

Here the number of spins N = k Ã— n Ã— u, and the parameters u and n determine the robustness of the states
to some number of loss and dephasing errors respectively,
while k is a parameter to scale the number of qubits in the
superposition (larger k means better performance). The
case u = 1 tolerates erasure errors; specifically, the state
|Ï•1 i has a large quantum Fisher information obeying
Heisenberg scaling when the number of erasure errors is
less than n. We will consider the state performing well in
the presence of one erasure error: u = 1, n = 2, k = N/2,
which can be written
âˆš
1
(27)
|Ï•1 i = (|J, âˆ’Ji + 2|J, 0i + |J, Ji).
2
The case u = 2 tolerates a constant number of dephasing errors. We will focus on the state with u = 2, n =
1, k = N/2 which tolerates one dephasing error and can
be written
1
|Ï•2 i = âˆš (|J, âˆ’Ji + |J, 0i).
2

(28)

We now describe how to make these states using our
protocol. A key ingredient to prepare a superposition of
Dicke states is to perform a controlled state preparation.
If we introduce an ancilla spin A which can be allowed
to couple to the mode when the other spins do not (e.g.
by detuning the other spins far away from the dispersive
coupling regime), then a controlled displacements of the
mode can be done:
Î›(Î²) = |0iA h0| âŠ— 1 + |1iA h1| âŠ— D(Î²)
= D(Î²/2)R(Ï€|1iA h1|)D(âˆ’Î²/2)R(âˆ’Ï€|1iA h1|).
(29)
â€ 
Here R(Ï€|1iA h1|) = eiÏ€a a|1iA h1| , meaning only the ancilla state |1iA couples to the mode. Now replacing the
displacements D(Î²) and D(âˆ’Î²) with the controlled displacements Î›(Î²) and Î›(âˆ’Î²), the effect is a controlled
GPG (see also Ref [45]):
Î›(UGPG ) = |0iA h0| âŠ— 1 + |1iA h1| âŠ— UGPG .

(30)

Thus by simply replacing all instances of GPGs with controlled GPS we can achieve a controlled Grover step uniy
tary G. Note the unitary eiJ Ï€/2 conjugating W (0) in
Us does not need to be controlled, meaning the entire
#G
unitary UG
can be made into a controlled unitary
#G
Î›(UG
) = (|0iA h0| âŠ— 1 + |1iA h1| âŠ— UG )#G .

(31)

This is not quite enough. The state preparation of a
#G
Dicke states described above applies UG
to a particular

10
initial state, namely the spin coherent state |si. We will
also require a way to perform a controlled rotation on all
the spins of the form
Î›(eiJ

y

Ï€/2

) = |0iA h0| âŠ— 1 + |1iA h1| âŠ— eiJ

y

Ï€/2

.

1. Prepare the product state
2. Apply eâˆ’iJ

2

Îº/g

cos(|Î±|2 4Ï€Îº/g).

(33)

but no worse than the performance for state preparation
without ancilla.
The controlled operation is then
Î›(eiJ

y

Ï€/2

) = eâˆ’iJ

x

Ï€/2

Î›(UGPG (Î¸, 0, Ï€/4Î¸)eiJ

x

Ï€/2

.

We can now write the process to prepare the state |Ï•2 i:

|0iA
|0iâŠ—N

|0iA
|0iâŠ—N

âˆ—

HX
e

y
i J 2Ï€

ei

JxÏ€
2

â€¢
UGPG (Ï€, Ï€/2,

e

y
âˆ’i J 2 Ï€

x
âˆ’i J 2 Ï€

e

gavin.brennen@mq.edu.au
[1] W. Wasilewski, K. Jensen, H. Krauter, J. J. Renema,
M. V. Balabas, and E. S. Polzik, Phys. Rev. Lett. 104,
133601 (2010).
[2] J. Taylor et al., Nat. Phys. 4, 810 (2008).
[3] W. Wang et al., Nat. Comm. 10, 4382 (2019).
[4] V. Giovannetti, S. Lloyd and L. Maccone, Nat. Photonics
5, 222 (2011).
[5] V. Giovannetti, S. Lloyd and L. Maccone, Science 306,
1330 (2004).
[6] S. Pirandola, B. R. Bardhan, T. Gehring, C. Weedbrook,
and S. Lloyd, Nat. Photonics 12, 724 (2018).

Ï€/2

.

5. Apply the classically controlled product unitary
âŠ—N
Z(r) = Z (1âˆ’r)/2 . If we assume N/2 is odd then
1
Z(r) âˆš (|J, âˆ’Ji Â± |J, 0i) = |Ï•2 i.
2
To prepare the state |Ï•1 i a similar process can be
used. However, rather than the |0iA state being correlated with the product state |J, âˆ’Ji we want it correlated with the GHZ state âˆš12 (|J, âˆ’Ji + |J, Ji). Such
a state can be prepared using one additional controlled GPG gate. This follows from the observation
Jy Ï€
Jy Ï€
that ei 2 UGPG (Ï€, Ï€/2, Ï€8 )eâˆ’i 2 |J, âˆ’Ji = âˆš12 (|J, âˆ’Ji +
|J, Ji). These two processes are summarized by the following circuits:

eâˆ’i

JxÏ€
2

H

#G
UG

Z âŠ—N

â€¢

X
Ï€
8)

x

1
âˆš (|J, âˆ’Ji Â± |J, 0i)
2

â€¢

Ï€
UGPG (Î¸, 0, 2Î¸
)

Î›(UGPG (Î¸, 0, Ï€/4Î¸)eiJ

4. Measure the ancilla in the |Â±x iA basis. The outcomes r = Â±1 each occur with probability 1/2. The
conditional system state is

â€¢

H

Ï€/2

#G
3. Apply Î›(UG
). This involves N Ã— #G instances of
Î›(UGPG ) for varying parameters.

(32)

Without having direction interactions between the ancilla and the other spins it is not obvious how to do this.
However, it is possible to mediate the interaction with
the mode by choosing Ï† = 0 and Î¸  1 in one instance
of a controlled GPG. This will give Î›(UGPG (Î¸, 0, Ï€/4Î¸) â‰ˆ
z
|0iA h0| âŠ— 1 + |1iA h1| âŠ— eâˆ’iJ Ï€/2 where we have approxiz
z
mated sin(Î¸J ) â‰ˆ Î¸J . Note, in order for this to be valid
we require Î¸  1/N and consequently Ï‡ = |Î±|2  N ,
i.e. the area of the GPG in phase space needs to grow
with N , or the gate could be composed into N GPGs
each of area of O(1). This will consequently incur a loss
of fidelity due to mode decay
Fpro (E, UGPG ) > eâˆ’6Ï€|Î±|

x

âˆš1 (|0i + |1i)A âŠ— |J, âˆ’Ji.
2

UGPG (Î¸, 0,

|Ï•2 i

â€¢
Ï€
4Î¸ )

e

x
i J 2Ï€

#G
UG

H
Z âŠ—N

|Ï•1 i

[7] R. Demkowicz-DobrzanÌski, J. KolodynÌski and M. GutÌ§aÌ†
Nat. Comms. 3, 1063 EP (2012).
[8] M. Zwierz, C. A. PeÌrez-Delgado and P. Kok, Phys. Rev.
Lett. 105, 180402 (2010).
[9] S. Zhou, M. Zhang and L. Jiang, Nat. Comms. 9, 78
(2018).
[10] S. D. Bartlett, G. K. Brennen and A. Miyake, Quantum
Science and Technology 3, 014010 (2017).
[11] X. Wang and P. Zanardi, Phys. Rev. A 65, 032327 (2002).
[12] G. Xu and G. Long, Phys. Rev. A 90, 022323 (2014).
[13] A. SÃ¸rensen and K. MÃ¸lmer, Phys. Rev. Lett. 82, 1971
(1999).
[14] I. Apellaniz, B. LuÌˆcke, J. Peise, C. Klempt, and G. ToÌ,
New J. Phys. 17, 083027 (2015).
[15] This follows from U (Î·) = exp [iÎ·(J x sin Î´ + J y cos Î´)] =

11

[16]
[17]
[18]
[19]

[20]
[21]
[22]

[23]
[24]
[25]

[26]
[27]
[28]

[29]
[30]
[49]

[32]

exp(iÎ´J z ) exp(iÎ·J y ) exp(âˆ’iÎ´J z ), the fact our measurement observable is JË†z2 , and our initial state is |J, M = 0i.
A. BaÌˆrtschi and S. Eidenbenz,
Preprint at
https://arxiv.org/abs/1904.07358 (2019).
C. Wu et al., Phys. Rev. A 95, 013845 (2017).
K. D. B. Higgins et al., Nat. Comms. 5, 4705 EP (2014).
T. Keating, C. H. Baldwin, Y.-Y. Jau, J. Lee, G. W.
Biedermann and I. H. Deutsch, Phys. Rev. Lett. 117
213601 (2016).
D. B. Hume, C. W. Chou, T. Rosenband, and D. J.
Wineland, Phys. Rev. A 80 052302 (2009).
L. Jiang et al., Nat. Phys. 4, 482 EP (2008).
This was tried for up to N = 100 spins with the decomposition having fidelity error 1 âˆ’ |hÎ»|KÌƒ|J, âˆ’Ji|2 < 10âˆ’12
for synthesizing sampled random state vectors |Î»i.
D. J. Rowe, H. de Guise and B. C. Sanders, J. Math.
Phys. 42, 2315 (2001).
B. LuÌˆcke et al., Science 334, 773 (2011).
G. K. Brennen, K. Hammerer, L. Jiang, M. D. Lukin, and
P. Zoller, Preprint at https://arxiv.org/abs/0901.3920
(2009).
See Supplemental Material [url] for details, which includes Ref. [45].
Brennen, G. K., Pupillo, G., Rico, E., Stace, T. M. &
Vodola, D. Phys. Rev. Lett. 117, 240504 (2016).
M. Nielsen and I. L. Chuang Quantum Computation
and Quantum Information (Cambridge University Press,
2010).
G. S. Agarwal Physica Scripta 82, 038103 (2010).
Z.-Y. Wang and R.-B. Liu Quantum Error Correction pp.
351â€“375 (Cambridge University Press, 2013).
The ordering {8, 4, 5, 9, 3, 7, 6, 2, 10, 1} achieves this. Note
an exhaustive search over all 10! permutations was not
done.
Y. Ouyang, N. Shettell and D. Markham, Preprint at

https://arxiv.org/abs/1908.02378 (2019).
[33] H. Pollatsek and M. B. Ruskai, Linear Algebra and Applications, 392, 255 (2004).
[34] J.A. Gross, arXiv:2005.10910.
[35] C. Sayrin et al., Nature 477, 73 EP (2011).
[36] S. Garcia, M. Stammeier, J. Deiglmayr, F. Merkt, and
A. Wallraff, Phys. Rev. Lett. 123, 193201 (2019).
[37] J. S. Pedernales et al., Sci. Rep. 5, 15472 EP (2015).
[38] M. Lee et al., Phys. Rev. Lett. 122, 153603 (2019).
[39] C. Wang et al., Science 352, 1087 (2016).
[40] T. Astner et al. Phys. Rev. Lett. 118, 140502 (2017).
[41] S. J. Bosman, V. Singh, A. Bruno, and G. A. Steele,
Appl. Phys. Lett. 107, 192602 (2015).
[42] A.R. Castellia, L.A. Martinez, J.M. Pate, R.Y. Chiao,
and J.E. Sharping, J. Appl. Phys. 126, 173908 (2019).
[43] Brennen, G. K., Hammerer, K., Jiang, L., Lukin,
M. D. & Zoller, P. Global operations for protected
quantum memories in atomic spin lattices. Preprint at
https://arxiv.org/abs/0901.3920 (2009).
[44] Ouyang, Y., Shettell, N. & Markham, D. Robust quantum metrology with explicit symmetric states. Preprint
at https://arxiv.org/abs/1908.02378 (2019).
[45] Brennen, G. K., Pupillo, G., Rico, E., Stace, T. M. &
Vodola, D. Loops and strings in a superconducting lattice
gauge simulator. Phys. Rev. Lett. 117, 240504 (2016).
[46] Pollatsek, H. & Ruskai, M. B. Permutationally invariant
codes for quantum error correction. Linear Algebra and
Applications, 392, 255 (2004).
[47] Agarwal, G. S. Saving entanglement via a nonuniform
sequence of Ï€ pulses. Physica Scripta 82, 038103 (2010).
[48] Wang, Z.-Y. & Liu, R.-B. Quantum Error Correction pp.
351â€“375 (Cambridge University Press, 2013).
[49] The ordering {8, 4, 5, 9, 3, 7, 6, 2, 10, 1} achieves this. Note
an exhaustive search over all 10! permutations was not
done.

