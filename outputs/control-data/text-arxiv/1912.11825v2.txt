arXiv:1912.11825v2 [math.NT] 6 Mar 2020

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS OF
ORTHOGONAL SHIMURA VARIETIES
JAN HENDRIK BRUINIER AND SHAUL ZEMEL
Abstract. We determine the behavior of automorphic Green functions along the boundary components of toroidal compactifications of orthogonal Shimura varieties. We use this
analysis to define boundary components of special divisors and prove that the generating
series of the resulting special divisors on a toroidal compactification is modular.

1. Introduction
Orthogonal Shimura varieties that arise from even lattices of signature (n, 2) carry a
natural family of divisors that are called Heegner divisors, rational quadratic divisors,
or special divisors in the literature. In his seminal paper [Bo1], Borcherds constructed
meromorphic modular forms on these varieties, and then used them in the sequel [Bo2]
to establish the modularity of the generating series of these divisors in the first Chow
group of such a Shimura variety. This provided a new proof of the Gross-Kohnen-Zagier
theorem about the modularity of Heegner divisors on modular curves and a generalization
to orthogonal Shimura varieties of arbitrary dimension and level. Taking Chern classes one
obtains as a corollary also the modularity of the generating series of the cohomology classes
of special divisors, such as the celebrated Hirzebruch-Zagier theorem for Hilbert modular
surfaces [HZ] and particular cases of results of Kudla-Millson on cohomology classes of
special cycles on locally symmetric spaces associated with orthogonal groups [KM].
The modularity of generating series of special cycles plays a central role in the Kudla
program, see, e.g., [K1], [K2]. Once one knows modularity, the generating series can
be used to construct arithmetic analogues of the theta correspondence, relating Siegel
modular forms to classes of special cycles in (arithmetic) Chow groups. For applications
to intersection and height pairings one is interested in special cycles on smooth toroidal
compactifiations and corresponding modularity results, cf. Problem 3 of [K2]. The present
paper is a contribution in this direction.
In order to present the results in more detail, we need some notation. Let L be an
even lattice of signature (n, 2), and let Î“L be the stable special orthogonal group of L, see
(3.6). We write XL = Î“L \D for the associated connected complex Shimura variety. For
every element Âµ in the discriminant group âˆ†L = Lâˆ— /L of L and every positive number
2
m âˆˆ Âµ2 + Z there is a corresponding special divisor Z(m, Âµ) on XL . If ÏL denotes the Weil
representation associated with L, then Theorem 4.5 of [Bo2] states the following.
The first author is partially supported by DFG grant BR-2163/4-2 and the LOEWE research unit
USAG.
1

2

JAN H. BRUINIER AND SHAUL ZEMEL

Theorem 1.1. Let Z(0, 0) be any divisor on XL representing the line bundle of modular
forms of weight âˆ’1/2, and denote the image of Z(m, Âµ) in CH1 (XL ) âŠ— Q by [Z(m, Âµ)] for
any m and Âµ. Then the formal power series
X
X
[Z(m, Âµ)] Â· q m eÂµ
[Z(0, 0)]e0 +
Âµâˆˆâˆ†L 0<mâˆˆ Âµ2 +Z
2

is a modular form of weight 1+n/2 and representation ÏL with coefficients in CH1 (XL )âŠ—Q.
Note that Theorem 1.1 involves the representation ÏL , and not the complex conjugate
representation ÏL as in Theorem 4.5 of [Bo2], since we work here with the opposite signature
convention. The idea of the proof is that given a weakly holomorphic modular form f of
weight 1 âˆ’ n/2 and representation ÏL with integral principal part, there exists, according
to Theorem 13.3 of [Bo1], a Borcherds product Î¨f on XL that gives rise to a particular
relation among the special divisors in CH1 (XL ). The result can then be deduced by means
of an incarnation of Serre duality, which appears as Theorem 3.1 of [Bo2], and which is
stated here as Proposition 5.3.
The variety XL is typically non-compact. Following work of Satake [Sa], Baily and Borel
constructed in [BB] a canonical minimal compactification XLBB of XL . When n is larger
than the Witt rank of L, an appropriate equivalent of Theorem 1.1 holds also for the
closures of the divisors Z(m, Âµ) on XLBB . Indeed, meromorphic modular forms with respect
to Î“L , and in particular Borcherds products, are defined on XLBB , and the complement of
XL in XLBB has codimension larger than 1 by the assumption on the Witt rank. Hence
the divisor of any Borcherds product yields a relation among the special divisors, and the
result follows in the same manner.
The Baily-Borel compactification XLBB is typically highly singular at the boundary. In
order to work on a smooth compact variety, we shall consider toroidal compactifications
as constructed in [AMRT]. These are described explicitly in the orthogonal setting for
instance in [Fi], and we present the results here as well in a manner that is more suitable
for our purposes. However, the complement of XL inside a toroidal compactification XLtor is
a divisor, and it turns out that Theorem 1.1 does not extend to XLtor if one works with the
closures of the special divisors on XL . Instead, one has to add certain boundary divisors
with appropriate multiplicities, a phenomenon which was already observed for Hilbert
modular surfaces in [HZ] and for unitary Shimura varieties in [BHY] and [BHKRY]. Here
we define special divisors Z tor (m, Âµ) on XLtor which include suitable linear combinations of
the boundary divisors, and we prove an analogue of Theorem 1.1.
The idea of our approach is the following. For every Âµ âˆˆ âˆ†L and every positive number
2
m âˆˆ Âµ2 + Z there is a harmonic Mass form Fm,Âµ of weight 1 âˆ’ n/2 with representation
ÏL whose principal part is given by q âˆ’m (eÂµ + eâˆ’Âµ ). Its regularized theta lift against the
Siegel theta function Î˜L of L determines an automorphic Green function Î¦Lm,Âµ on XL with
a logarithmic singularity along Z(m, Âµ), see [Br1] and [BFu] for more details. We analyze
the behavior of this Green function towards each boundary component of XLtor . It turns
out that besides a term with log-log-growth, the Green function has logarithmic growth
along certain boundary divisors. Here the corresponding multiplicities are determined by

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

3

regularized theta lifts associated to lattices of signature (n âˆ’ 2, 0) and (n âˆ’ 1, 1) which are
obtained as quotients of L.
Every primitive rank 2 isotropic sublattice J âŠ† L determines a 1-dimensional Baily-Borel
boundary component and also a canonical boundary divisor BJ of XLtor . On the other hand,
the lattice D = (J âŠ¥ âˆ© L)/J is positive definite of signature (n âˆ’ 2, 0). There is a linear
D
map taking Fm,Âµ to a harmonic Maass form Fm,Âµ
with representation ÏD . We show in
Proposition 4.8 that Î¦Lm,Âµ has logarithmic growth along the divisor multJ (m, Âµ) Â· BJ , where
D
the multiplicity multJ (m, Âµ) is determined by the regularized theta lift of Fm,Âµ
against the
2m
theta function Î˜D of the lattice D, which in turn is given by nâˆ’2 times the representation
number of m by the coset of D arising from Âµ.
Every primitive rank 1 isotropic sublattice I âŠ† L determines a 0-dimensional BailyBorel boundary component, as well as a Lorentzian lattice K = (I âŠ¥ âˆ© L)/I of signature
(n âˆ’ 1, 1). In contrast to the canonical boundary divisor BJ from the previous paragraph,
the inverse image in XLtor depends on the choice of an admissible cone decomposition of the
rational closure of a cone C of negative norm vectors in KR . The lattice K and an oriented
primitive negative norm vector Ï‰ âˆˆ K âˆ© C that spans an inner ray in the associated cone
decomposition determine a boundary divisor BI,Ï‰ of XLtor . There is a linear map taking
K
Fm,Âµ to a harmonic Maass form Fm,Âµ
with representation ÏK . We show in Proposition 4.7
(or, more explicitly, in the special case presented in (4.21)) that Î¦Lm,Âµ has logarithmic
growth along the divisor multI,Ï‰ (m, Âµ) Â· BI,Ï‰ , where the multiplicity multI,Ï‰ (m, Âµ) is given
K
by the regularized theta lift of Fm,Âµ
against the Siegel theta function Î˜K of K, evaluated
at the special point associated with Ï‰ in the Grassmannian of K.
We define the special divisor Z tor (m, Âµ) âˆˆ Div(XLtor ) âŠ— R by the formula
X
XX
(1.1)
Z tor (m, Âµ) = Z(m, Âµ) +
multJ (m, Âµ) Â· BJ +
multI,Ï‰ (m, Âµ) Â· BI,Ï‰ .
JâŠ†L

IâŠ†L R+ Ï‰

Here J (resp. I) runs over a set of representatives of rank 2 (resp. rank 1) primitive isotropic
sublattices of L modulo Î“L , and given I, the index R+ Ï‰ runs over representatives for the
inner rays of the chosen admissible cone decomposition. Note that while the multiplicities
multJ (m, Âµ) are easily seen to be rational because of their description as representation
numbers, the multiplicities multI,Ï‰ (m, Âµ) seem to be real in general. Only certain linear
combinations of the latter quantities can be shown to be rational, cf. Theorem 5.2.
Our first main result, given in Theorem 4.13 below, states that 21 Î¦Lm,Âµ is a logarithmic
Green function for the divisor Z tor (m, Âµ) on XLtor with a term that is pre-log-log along the
boundary in the sense of [BBK]. In particular this means that if dc is the complementary
then we have the current equation
operator âˆ‚âˆ’âˆ‚
4Ï€i
(1.2)

ddc [ 12 Î¦Lm,Âµ ] + Î´Z tor (m,Âµ) = [Î· tor (m, Âµ)],

where Î· tor (m, Âµ) is the sum of a smooth 2-form on XLtor and the ddc -image of the pre-log-log
term.
Our second main result, Theorem 5.4, describes the generating series of these special
divisors.

4

JAN H. BRUINIER AND SHAUL ZEMEL

Theorem 1.2. Assume that n is larger than the Witt rank of L, set Z tor (0, 0) to be any
divisor on XLtor that represents the line bundle of modular forms of weight âˆ’1/2, and write
[Z tor (m, Âµ)] for the image of Z tor (m, Âµ) in CH1 (XLtor ) âŠ— R for every pair (m, Âµ). Then the
formal power series
X
X
[Z tor (m, Âµ)] Â· q m eÂµ
[Z tor (0, 0)]e0 +
Âµâˆˆâˆ†L 0<mâˆˆ Âµ2 +Z
2

is a modular form of weight 1+n/2 and representation ÏL with coefficients in CH1 (XLtor )âŠ—R.
Taking advantage of our analysis of the Green functions Î¦Lm,Âµ , this result can now be
proved in a similar way as Theorem 1.1. For every weakly holomorphic modular form
f of weight 1 âˆ’ n/2 and representation ÏL with integral principal part, we consider the
associated Borcherds product Î¨f , but now as a section of a line bundle over XLtor . Since
f can be (essentially) uniquely written as a linear combination of the harmonic Maass
forms Fm,Âµ , the logarithm of the Petersson metric of Î¨f decomposes as a corresponding
linear combination of the Green functions Î¦Lm,Âµ . This implies that the divisor of Î¨f on
XLtor includes the boundary components of XLtor with multiplicities compatible with (1.1).
Hence f gives rise to a relation among the divisors Z tor (m, Âµ), and the theorem follows
again by Serre duality. In fact, as we construct the divisors Z tor (m, Âµ) via their Green
functions, our argument can also prove modularity in Chow groups arising in arithmetic
settingsâ€”see Remark 5.5 below.
We remark that [P] proves a similar result on the moduli space of polarized K3 surfaces
in dimension 19, though this result does not involve the multiplicities multI,Ï‰ (m, Âµ) because
the toroidal compactification considered there is based on fans that have no internal rays.
This paper is divided into five sections, the first being the introduction. Section 2
reviews quickly the general theory of toroidal compactifications, while Section 3 presents
the explicit description of what happens in the orthogonal case. Section 4 investigates the
Green functions associated with special divisors, and explains the extensions of the Green
functions to toroidal compactifications. Finally, Section 5 recalls some results on Borcherds
products and shows how to modify the modularity theorem for special cycles on the open
variety to become suitable for the toroidal case.
We thank Max RoÌˆssler and Salim Tayou for helpful comments.
2. General Toroidal Compactifications
We skim here briefly, without any proofs, the general theory of toric varieties and toroidal
compactifications. More details on toric varieties can be found in [Fu] or in [CLS], and
the general construction of toroidal compactifications is available in [AMRT], [Nam], [Fi],
and others. The particular parts that will be of use to us are Proposition 2.5, Lemma 2.7,
Propositions 2.8 and 2.9, Definition 2.12, and Theorem 2.14.
2.1. Toric Varieties. There is a correspondence between algebraic tori of finite dimension
and lattices, namely free Abelian groups of finite rank. Given a lattice Î›, the corresponding

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

5

torus TÎ› is the one for which TÎ› (C) = Î›C /Î›. The dual lattice Î›âˆ— = Hom(Î›, Z) is identified
with Hom(TÎ› , Gm ) via


(2.1)
Î½ 7â†’ zÎ½ ,
zÎ½ : Î¶ âˆˆ TÎ› (C) = Î›C /Î› 7â†’ e (Î½, Î¶) ,

where we adopt the usual notation e(w) = e2Ï€iw for w âˆˆ C and the pairing (Î½, Î¶) in (2.1)
is the extension of the pairing between Î› and Î›âˆ— to elements from Î›C . The functions zÎ½
from (2.1) satisfy zÂµ+Î½ = zÂµ zÎ½ for Âµ and Î½ in Î›âˆ— , a relation that we henceforth implicitly
assume wherever we use this notation. It follows that as an algebraic variety we have
TÎ› = Spec C[zÎ½ | Î½ âˆˆ Î›âˆ— ].

A toric variety is an irreducible algebraic variety X containing a torus T as a dense
Zariski open subset, such that the action of T on itself extends to an action of T on all of X.
We shall only consider normal separated toric varieties in what follows, where a variety is
always understood to be locally of finite type. Recall that a rational polyhedral cone Ïƒ âŠ† Î›R
is a set generated by finitely many elements of Î›, with coefficients in R+ = {a âˆˆ R| a â‰¥ 0}.
The dual cone of Ïƒ is

Ïƒ âˆ— = Î½ âˆˆ Î›âˆ—R (Î½, Î») â‰¥ 0 for all Î» âˆˆ Ïƒ ,
which is a rational polyhedral cone in Î›âˆ—R . The cone Ïƒ is called strongly convex if it contains
no full lines. This is equivalent to Ïƒ âˆ— being of full dimension rk Î› in Î›âˆ—R . For any such cone
Ïƒ, the semigroup Ïƒ âˆ— âˆ© Î›âˆ— is finitely generated, and
XÎ›,Ïƒ = Spec C[zÎ½ | Î½ âˆˆ Ïƒ âˆ— âˆ© Î›âˆ— ]
is a normal irreducible affine algebraic variety, containing TÎ› (C) as the open acting torus.
We shall use the notation Ï„ â‰¤ Ïƒ for stating that Ï„ is a face of Ïƒ (in the usual polyhedral
sense). In this case XÎ›,Ï„ is an open TÎ› (C)-invariant subvariety of XÎ›,Ïƒ . General (normal
separated) toric varieties are then defined using the following notion.
Definition 2.1. A rational fan is a collection Î£ of strongly convex rational polyhedral
cones in Î›R , satisfying the following conditions:
(i) If Ïƒ âˆˆ Î£ and Ï„ â‰¤ Ïƒ then Ï„ âˆˆ Î£.
(ii) Given Ïƒ and Ï„ in Î£, we have Ïƒ âˆ© Ï„ â‰¤ Ïƒ and Ïƒ âˆ© Ï„ â‰¤ Ï„ .
The first main result in the theory of toric varieties is the following one.
Theorem 2.2. Every rational fan Î£ as in Definition 2.1 gives rise to a separated normal
toric variety XÎ›,Î£ , on which the acting torus is TÎ› . Conversely, every separated normal
toric variety arises, up to isomorphism, as XÎ›,Î£ from a lattice Î› and a fan Î£ satisfying
the conditions of Definition 2.1.
Theorem 2.2 indicates that properties of the toric varieties XÎ›,Ïƒ should be expressed as
properties of the defining fan Î£. We recall that the dimension of a cone Ïƒ is the dimension
of the real vector space RÏƒ = Ïƒ + (âˆ’Ïƒ).

6

JAN H. BRUINIER AND SHAUL ZEMEL

Definition 2.3. A cone Ïƒ, of some dimension 0 â‰¤ l â‰¤ rk Î›, is called simplicial if it can
be generated using precisely l elements of Î›. It is called smooth if these elements form a
basis over Z for the group Î› âˆ© RÏƒ. The fan Î£ from Definition 2.1 will be called simplicial
or smooth if every Ïƒ âˆˆ Î£ has the respective property.
We state the following relations between properties of Î£ and properties of XÎ›,Î£ , whose
proofs are rather simple and straightforward.
Proposition 2.4. The following assertions hold:
(i) The affine toric variety XÎ›,Ïƒ is smooth if and only if the cone Ïƒ is smooth in the
sense of Definition 2.3. The general toric variety XÎ›,Î£ is smooth if and only if the
fan Î£ is smooth.
(ii) If the cone Ïƒ is simplicial then XÎ›,Ïƒ has at most finite quotient singularities. If the
fan Î£ is simplicial then the toric variety XÎ›,Î£ has at most finite quotient singularities.
(iii) The toric variety XÎ›,Î£ is of finite type if and only if the fan Î£Sis finite.
(iv) The toric variety XÎ›,Î£ is proper if and only if Î£ is finite and ÏƒâˆˆÎ£ Ïƒ is all of Î›R .
We remark that while our main object of interest below will be smooth toroidal compactifications, which are obtained when the toric varieties appearing in the construction
below are smooth (as characterized in Proposition 2.4), this fact will play no role in any
of the following proofs. Our results are therefore equally valid for non-smooth toroidal
compactifications.
The orbits in the action of TÎ› on XÎ›,Î£ are in one-to-one correspondence with the cones
Ïƒ âˆˆ Î£. More explicitly, define the annihilator of Ïƒ to be

Ïƒ 0 = Î½ âˆˆ Î›R (Î½, Î») = 0 for all Î» âˆˆ Ïƒ = Ïƒ âˆ— âˆ© (âˆ’Ïƒ âˆ— ),
and then the orbit O(Ïƒ) associated with Ïƒ and the corresponding closure OÎ£ (Ïƒ) in XÎ›,Î£
are defined to be
[


(2.2)
O(Ïƒ) = ZXÎ›,Ïƒ zÎ½ Î½ âˆˆ (Ïƒ âˆ— âˆ© Î›âˆ— ) \ Ïƒ 0
and OÎ£ (Ïƒ) =
O(Î·).
Ïƒâ‰¤Î·

Here we have used, for an affine variety X, the notation ZX (S) for the set of common zeros
of a set S âŠ† C[X]. The dimension of both O(Ïƒ) and OÎ£ (Ïƒ) is rk Î› âˆ’ dim Ïƒ. The special
case of (2.2) concerning divisors is given by
DÏ = OÎ£ (Ï) âˆˆ Div(XÎ›,Î£ )

for a ray, i.e., a 1-dimensional cone Ï âˆˆ Î£, and the generic part O(Ï) = DÏ âˆ© XÎ›,Ï of DÏ is
smooth. Any such ray is R+ Ï‰ for a unique, well-defined primitive element Ï‰ âˆˆ Î›, and if we
take some element Îº âˆˆ Î›âˆ— with (Îº, Ï‰) = 1, which is possible by the primitivity of Ï‰, then
zÎº is a defining function for O(Ï) in XÎ›,Ï , hence a local defining function for DÏ in XÎ›,Î£ .
We deduce the following beautiful formula from [Fu] and others, which will be useful for
us in what follows.
Proposition 2.5. For Î½ âˆˆ Î›âˆ— and a ray Ï = R+ Ï‰ âˆˆ Î£ as above, the order ordDÏ (zÎ½ ) of
the function zÎ½ for Î½ âˆˆ Î›âˆ— along the the divisor DÏ is (Î½, Ï‰).

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

7

2.2. Toroidal Compactifications. The theory of toric varieties can be used to construct
interesting (e.g., smooth) compactifications of algebraic varieties arising as quotients of
Hermitian symmetric spaces by arithmetic groups. Indeed, let D be a simple Hermitian
symmetric space of non-compact type, and let G be the connected component of Aut(D).
The group G can be viewed as the connected component of the group of real points of a
simple algebraic group G. In case G is defined over Q, the group G contains arithmetic
subgroups, which are discrete and of finite co-volume in G. By fixing such a subgroup Î“,
the space X = Î“\D carries the structure of a complex algebraic variety, which is usually
defined over Q or over some number field (see, e.g., Theorem 2.6 below), but is not complete
in general.
Any compactification of X arises by adding appropriate boundary components to X.
The first, and most natural, way to do this is based on the boundary components of D
as a symmetric space. We denote the assertion that Î is a boundary component of D by
Î â‰¤ D, and the rational structure on G determines which boundary components of D are
rational (this is always the case for D itself). One therefore defines
[
D BB =
Î.
Îâ‰¤D, Î rational

The group Î“ acts on D BB , and we set
(2.3)

open

X BB = Î“\D BB âŠ‡ Î“\D = X.

The quotient X BB from (2.3), with the Bailyâ€“Borel topology and complex structure, is
called the Bailyâ€“Borel compactification of X. It is a normal projective variety, which
contains X as a Zariski dense open subset. The boundary components of X BB , which are
called cusps, are quotients of rational boundary components of D by arithmetic groups.
They are typically of high codimension and very singular. This compactification can also
be constructed and characterized by the following result of Baily, Borel, and Satake (see,
e.g., [Sa] and [BB]).
Theorem 2.6. The algebraic variety X BB from (2.3) can be obtained as the proj construction of the ring of holomorphic modular forms with respect to Î“ (hence it is projective and
defined over a number field). It is the minimal algebraic compactification of X.
The minimality in Theorem 2.6 means that any algebraic compactification of X carries
a unique map to X BB that restricts to the identity map on the open subset X of both
varieties.
Smooth compactifications of X can be constructed using the theory of toroidal compactifications, obtained by gluing to X open subsets of toric varieties. This theory is described
in detail in [AMRT] in general, and more explicitly for the symplectic case in [Nam]. We
will give the precise details for our case of interest, the orthogonal case, in Section 3 below,
slightly in parallel to [Fi], with a special case appearing also in Section 4.2 of [P]. For describing the general idea, recall that the minimality in Theorem 2.6 allows one to restrict
attention to the pre-image of a given cusp, and any cusp is the Î“-orbit of some rational

8

JAN H. BRUINIER AND SHAUL ZEMEL

boundary component Î â‰¤ D. Let P(Î) denote the connected component of the stabilizer
StG (Î), which is a parabolic subgroup of G, for which we now have the following result.
Lemma 2.7. The parabolic subgroup P(Î) lies in the split short exact sequence
1 â†’ W(Î) â†’ P(Î) â†’ Gh (Î) Ã— Gâ„“ (Î) Ã— M(Î) â†’ 1.

The unipotent radical W(Î) of P(Î) lies in the short exact sequence
0 â†’ U(Î) â†’ W(Î) â†’ V(Î) â†’ 0,

which does not split in general, where the center U(Î) of W(Î) and the quotient V(Î) are
isomorphic to real vector spaces, with dimR V(Î) even. The group Gh (Î) isthe connected
component of Aut(Î). The group Gâ„“ (Î) is a simple subgroup of GL U(Î) , whose symmetric space is a self-adjoint cone â„¦(Î) inside U(Î) which is usually non-Hermitian, and
M(Î) is a compact group.
We remark that some of the five components Gh (Î), Gâ„“ (Î), M(Î), U(Î), or V(Î) from
Lemma 2.7 may be trivial for some D and Î (see, e.g., Proposition 3.6 below). Note
that the center U(Î) of W(Î) is normal also in P(Î), and we denote the quotient group
P(Î)/U(Î) by P(Î).
The choice of Î also gives a presentation of D in a specific way, in correspondence with
the action of P(Î) as decomposed in Lemma 2.7.
Proposition 2.8. The choice of Î describes the Hermitian symmetric domain D as a
topologically trivial holomorphic fiber bundle
Ï€ e
(2.4)
U(Î) + iâ„¦(Î) â†’ D â†’ D(Î)

e
e
over a complex manifold D(Î),
in which the fiber of D over a point in D(Î)
is the image
of U(Î) + iâ„¦(Î) inside an affine space underlying the complexification U(Î)C of the real
vector space U(Î) from Lemma 2.7. Appropriately modifying the imaginary part of the
fiber of the first fibration yields a map Î¦ : D â†’ â„¦(Î), and with it a topologically trivial
affine vector bundle structure
(2.5)

Ï€Ã—Î¦ e
U(Î) â†’ D âˆ’â†’ D(Î)
Ã— â„¦(Î).

e
The manifold D(Î)
is an affine holomorphic vector bundle, whose underlying real structure
is a topologically trivial affine vector bundle
e
(2.6)
V(Î) â†’ D(Î)
â†’ Î,

e
in which the fiber V(Î)s of D(Î)
over s âˆˆ Î is the real affine space underlying V(Î), but
carrying a complex structure that depends holomorphically on s.

The action of the groups from Lemma 2.7 on the fibrations from Proposition 2.8 is as
follows.

Proposition 2.9. The center U(Î) of the unipotent radical W(Î) from Lemma 2.7 acts
additively on the affine fibers of the bundle from (2.5), or equivalently on the real part of
those from (2.4). The quotient V(Î) acts similarly on the fibers from (2.6), and the map

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

9

Î¦ from Proposition 2.8 is invariant under this action. In the resulting action of the Levi
quotient Gh (Î)Ã—Gâ„“ (Î)Ã—M(Î) from Lemma 2.7 on the quotient space ÎÃ—â„¦(Î), the groups
Gh (Î) and Gâ„“ (Î) act on their symmetric spaces Î and â„¦(Î) respectively, the latter one via
Î¦, and M(Î) acts trivially.
e
In particular, the description of D(Î)
in Proposition 2.8 is as a variation of Hodge
structure over Î. Proposition 2.9 shows that the fibers in (2.6) are principal homogeneous
spaces of V(Î), and those from (2.5) are principal homogeneous spaces of U(Î). The
boundary component Î is understood to lie â€œat âˆâ€, in the direction of the cone â„¦(Î).
Recalling that X = Î“\D for an arithmetic group Î“, we set
(2.7)
as well as
and
(2.8)

PZ (Î) = P(Î) âˆ© Î“,

WZ (Î) = W(Î) âˆ© Î“,

UZ (Î) = U(Î) âˆ© Î“

VZ (Î) = WZ (Î)/UZ (Î) âŠ† V(Î)
P Z (Î) = PZ (Î)/UZ (Î) âŠ† P(Î) = P(Î)/U(Î).

Now, the spaces U(Î) and U(Î)C are obtained from UZ (Î) by extending the scalars to R
and C respectively, and by Proposition 2.9, the group UZ (Î) âŠ† U(Î) acts on the real part
e
of the fibers of the bundle from (2.4). Hence UZ (Î)\D is also a fiber bundle over D(Î),
with the fibers being affine models of
(2.9)

[U(Î)/UZ (Î)] + iâ„¦(Î) âŠ† [U(Î)/UZ (Î)] + iU(Î) = U(Î)C /UZ (Î) = TUZ (Î) (C).

In these coordinates, the component Î of the set D BB from (2.3) lies at âˆ in the direction
of â„¦(Î). The idea is to extend the fibers TUZ (Î) to appropriate toric varieties, such that the
point s âˆˆ Î âŠ† D BB will be replaced by toroidal boundary components. This will make the
boundary not only a bundle over the boundary component Î of X BB itself, but also over
e
D(Î).
In order to do so while respecting the action of Î“, one observes that there is an open
subset â„¦N (Î) âŠ† â„¦(Î), which is invariant under the image of PZ (Î) in Gâ„“ (Î), which satisfies
(2.10)

â„¦N (Î) + â„¦(Î) âŠ† â„¦N (Î),

and such that if Î¾ âˆˆ D with Î¦(Î¾) âˆˆ â„¦N (Î) and A âˆˆ Î“ does not lie in PZ (Î) then
Î¦(AÎ¾) 6âˆˆ â„¦N (Î). This yields the following neighborhood of Î in D.

Lemma 2.10. The subset NÎ = Î¦âˆ’1 â„¦N (Î) of D is PZ (Î)-invariant, and any element
A âˆˆ Î“ which satisfies ANÎ âˆ© NÎ 6= âˆ… must be in PZ (Î).
Lemma 2.10 and (2.10) imply that that PZ (Î)\NÎ becomes a neighborhood of the corresponding cusp of X. It is clear from the definition of NÎ in Lemma 2.10 that the restriction
e
of the map Ï€ from (2.4) to NÎ still surjects onto the manifold D(Î)
from Proposition 2.8.
Dividing by the action of UZ (Î), or equivalently restricting (2.9), gives the fiber bundle
e
(2.11)
[U(Î)/UZ (Î)] + iâ„¦N (Î) â†’ UZ (Î)\NÎ â†’ D(Î),
with the fibers being smaller open subsets of TUZ (Î) (C).

10

JAN H. BRUINIER AND SHAUL ZEMEL

The toric variety extending TUZ (Î) will therefore have to be based on a fan Î£(Î) of cones
that are roughly contained in â„¦(Î) (this will be made more precise soon). But it will also
have to respect the action of the image of PZ (Î) in Gâ„“ (Î). In addition, consider a cusp Î¥
whose closure contains Î, a situation that we denote by Î â‰¤ Î¥. After embedding the Levi
quotients inside P(Î) and P(Î¥) one obtains the following result, appearing in Theorem 3
of Chapter 3 of [AMRT].
Lemma 2.11. Let Î and Î¥ be cusps of D, and assume that Î â‰¤ Î¥. We then have the
inclusion Gh (Î) âŠ† Gh (Î¥). One the other hand, we get U(Î¥) âŠ† U(Î) and Gâ„“ (Î¥) âŠ† Gâ„“ (Î)
in the other direction, with the latter embedding being not canonical, and the cone â„¦(Î¥)
is a rational boundary component of â„¦(Î). All the rational boundary components of â„¦(Î)
are â„¦(Î¥) for Î â‰¤ Î¥.

The exact properties of each fan Î£(Î), as well as of the collection of fans {Î£(Î)}Î , are
expressed in the following definition, taken from [AMRT] and [Nam].
Definition 2.12. For D, Î“, and Î as above we say that a fan Î£(Î) is an admissible cone
decomposition of (the closure of) â„¦(Î) if the following three conditions are satisfied:
S
S
(i) ÏƒâˆˆÎ£(Î) Ïƒ = Îâ‰¤Î¥ â„¦(Î¥). The union on the right hand side is the closure of â„¦(Î).
(ii) If Ïƒ âˆˆ Î£(Î) and B âˆˆ Gâ„“ (Î) is in the image of the group P Z (Î) from (2.8) then
BÏƒ âˆˆ Î£(Î), i.e., Î£(Î) is P Z (Î)-invariant.
(iii) The action of P Z (Î) on Î£(Î) has finitely many orbits.
For a collection {Î£(Î)}Îâ‰¤D of fans to be called admissible the following three following
must hold:
(i) Î£(Î) is an admissible cone
 decomposition
S of the closure of â„¦(Î) for every Î â‰¤ D.
(ii) If Î â‰¤ Î¥ then Î£(Î¥) = Ïƒ âˆˆ Î£(Î) Ïƒ âŠ† Î¥â‰¤Î¨ â„¦(Î¨) .

(iii) For Î â‰¤ D and A âˆˆ Î“ we have Î£(AÎ) = AÏƒ Ïƒ âˆˆ Î£(Î) .

For two cusps Î and Î¥ with Î â‰¤ Î¥, we consider â„¦(Î¥), as well as â„¦(Î¨) for every Î¥ â‰¤ Î¨,
as identified with its image as a boundary component of â„¦(Î) as in Lemma 2.11. Note that
in the second condition on Î£(Î) in Definition 2.12 we consider P Z (Î)-invariance, and not
the equivalent PZ (Î)-invariance, since we already divided by UZ (Î) in order to be able to
work with TUZ (Î) . This condition indicates that Î£(Î) will usually contain infinitely many
cones, since the image of P Z (Î) in Gâ„“ (Î) is typically infinite.
The existence of admissible cone decompositions for â„¦(Î), as well as admissible collections of fans {Î£(Î)}Îâ‰¤D , is not hard to prove: One way is by slightly modifying the
argument leading to the Main Theorem II at the end of Chapter 3 of [AMRT] (the assumption that Î“ is neat there poses no restriction, since any arithmetic group contains a
neat subgroup of finite index).
Given an admissible cone decomposition Î£(Î) for some Î, recall the fiber bundles from
(2.9) and (2.11), and that the fibers are open subsets of affine spaces over the torus
TUZ (Î) (C). Embedding this torus inside XUZ (Î),Î£(Î) , one gets a decomposition
i
[ h
o
o
(2.12)
[U(Î)/UZ (Î)] + iâ„¦(Î) =
[U(Î)/UZ (Î)] + iâ„¦(Î) âˆ© O(Ïƒ) ,
ÏƒâˆˆÎ£(Î)

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

11

where the set on the left hand side is the relative interior of the closure of the fiber
[U(Î)/UZ (Î)] + iâ„¦(Î) from (2.9) in XUZ (Î),Î£(Î) . It is clear that none of the sets in the union
from (2.12) is empty, that the intersection associated with any Ïƒ âˆˆ Î£(Î) that does not lie
in any Î£(Î¥) for a boundary component Î¥ 6= Î with Î â‰¤ Î¥ is the full orbit O(Ïƒ), and that
similar assertions holds for the fiber [U(Î)/UZ (Î)] + iâ„¦N (Î) from (2.11), with all the terms
in which Ïƒ 6= {0} being the same. Let now DÎ be the manifold having the fiber bundle
structure
i
[ h
o
e
(2.13)
[U(Î)/UZ (Î)] + iâ„¦(Î) âˆ© O(Ïƒ) â†’ DÎ â†’ D(Î).
ÏƒâˆˆÎ£(Î)

In particular DD in (2.13) is just D again. Since Î£(Î) is an admissible cone decomposition
in the sense of Definition 2.12, the action of P Z (Î)
 extends to DÎ , and the relative interior
o
PZ (Î)\NÎ of the closure of PZ (Î)\NÎ in P Z (Î) DÎ is


h
i
[

o
(2.14)
PZ (Î)\NÎ âˆª P Z (Î)
[U(Î)/UZ (Î)] + iâ„¦(Î) âˆ© O(Ïƒ)
.
{0}6=ÏƒâˆˆÎ£(Î)

The union in (2.14) is essentially a finite union of TUZ (Î) -orbits of positive codimension
(each one perhaps divided by the action of some finite group). A technical important
result, in which we denote the image of P Z (Î) in Gâ„“ (Î) by Î“â„“ (Î), is the following one.

Theorem 2.13. Cones in Î£(Î) that are not contained in Î£(Î¥) for any other cusp Î¥ with
Î â‰¤ Î¥ have finite stabilizers in Î“â„“ (Î). This group therefore operates properly discontinuously on the torus TUZ (Î) , hence also on the fibers from (2.11). Moreover, when Î£(Î) is an
admissible cone decomposition, this action extends to a properly discontinuous action on
XUZ (Î),Î£(Î) and on the fibers of DÎ from (2.13), taking boundary components to boundary
components.
Theorem 2.13 is complemented by an equivalent to part (iii) in Proposition 2.4, which
states that Î“â„“ (Î)\XUZ (Î),Î£(Î) is an open subset of a variety that is of finite type, because of
the finiteness of the number of orbits in Definition 2.12. We also deduce from that theorem
that if the cones in Î£(Î) are smooth as in Definition 2.3 then this quotient is smooth, up
to finite quotient singularities.
Assume now that the collection {Î£(Î)}Î is admissible as in Definition 2.12, and take
two cusps Î and Î¥ with Î â‰¤ Î¥. 
The first condition in that definition and Lemma 2.11
allow us to identify UZ (Î)/UZ (Î¥) DÎ¥ as an open subset of DÎ , and write
h
io
[

  n
o
(2.15) DÎ = UZ (Î)/UZ (Î¥) DÎ¥ âˆª
[U(Î)/UZ (Î)] + iâ„¦(Î) âˆ© O(Ïƒ) .
ÏƒâˆˆÎ£(Î)\Î£(Î¥)

Recall that W(Î¥) acts trivially on Î¥, so that it leaves all the boundary components of
Î¥ invariant, and in particular fixes Î. On the other hand, W(Î) acts trivially on â„¦(Î),
so that it fixes the boundary components of that cone that are described in Lemma 2.11,
including, in particular, â„¦(Î¥). We thus obtain the inclusions
(2.16)

UZ (Î¥) âŠ† UZ (Î) âŠ† WZ (Î) âŠ† PZ (Î¥) âˆ© PZ (Î) âŠ‡ WZ (Î¥),

12

JAN H. BRUINIER AND SHAUL ZEMEL

all of which holding also without the index Z. The inclusion from (2.15) thus yields
open 





PZ (Î¥) âˆ© PZ (Î) /UZ (Î¥) DÎ¥ âŠ† PZ (Î¥) âˆ© PZ (Î) /UZ (Î) DÎ ,

using which we can glue the appropriate neighborhoods of the cusps in the sets P Z (Î)\DÎ
and P Z (Î¥)\DÎ¥ properly when Î â‰¤ Î¥. Definition 2.12 also implies that if two rational
boundary components lie over the same cusp of X BB , which means that they are identified
via Î“, then their toroidal pre-images coincide. Then (2.14) and the defining properties of
the set NÎ from Lemma 2.10 form the basis for the main result in the theory of toroidal
compactifications, which we now state.
Theorem 2.14. Let D be a simple Hermitian symmetric space, let Î“ â‰¤ G = Aut(D)
be an arithmetic subgroup, and let {Î£(Î)}Îâ‰¤D be admissible as in Definition 2.12. Set
tor
X tor = X{Î£(Î)}
to be the variety obtained by gluing, for each Î â‰¤ D, the open subset
Îâ‰¤D
PZ (Î)\NÎ of X = Î“\D with its natural image in P Z (Î)\DÎ as in (2.14). Then X tor is
a compactification of X, which is a complete algebraic variety defined over the same field
as X. Assume, in addition, that every cone in every Î£(Î) is smooth as in Definition 2.3,
and that if Î¾ âˆˆ X tor is in the image of DÎ but not in DÎ¥ for any other Î â‰¤ Î¥ then the
stabilizer of Î¾ in P Z (Î) is trivial. In this case X tor is a smooth variety, hence a compact
complex manifold.
The main drawback of the construction from Theorem 2.14 is that it is not canonicalâ€”it
depends on the choice of the admissible cone decompositions Î£(Î) for Î â‰¤ D. However, we
shall assume that the choice of admissible cone decompositions is fixed from the beginning,
tor
and write just X tor in what follows, for avoiding the heavy notation X{Î£(Î)}
.
Î
Remark 2.15. We remark that a standard argument involving barycentric subdivisions
implies that every fan has a smooth refinement, and since for a Î“â„“ (Î)-invariant fan this
can be done in a Î“â„“ (Î)-equivariant manner, which also respects the relations between the
fans associated with different cusps as in Definition 2.12, admissible collections of smooth
admissible cone decompositions always exist. On the other hand, the condition about
triviality of stabilizers depend on the arithmetic group Î“, and indeed for some groups Î“
the open variety X from (2.3) may itself be not smooth. The latter issue can be resolved,
however, by taking a finite index subgroup of Î“ and the corresponding cover of X.
3. Compactifications of Grassmannian Quotients
This section describes the explicit form of the toroidal compactifications in the orthogonal case. The construction parallels [Fi] a bit, but with emphasis on the parts that are
required for our goals. The most important results here are the definition of the toroidal
divisors in (3.18), the explicit admissibility conditions in Corollary 3.21 and Lemma 3.24,
and the construction in Theorem 3.25.
3.1. Grassmannians with a Complex Structure. Let L be an even integral lattice
of signature (n, 2). We shall denote the image of two vectors Î» and Âµ in L under the
associated bilinear form by (Î», Âµ), and we shorthand (Î», Î») to Î»2 for every Î» âˆˆ L. The

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

13

2

quadratic form on L therefore sends Î» âˆˆ L to Î»2 . The group of automorphisms of the
real quadratic space LR is the Lie group O(LR ) âˆ¼
= O(n, 2), and we denote the connected
+
component of its identity by SO+ (LR ) âˆ¼
SO
(n,
2).
=
The symmetric space of O(LR ) and of SO+ (LR ) is isomorphic to the Grassmannian


(3.1)
Gr(L) = v âŠ† LR v < 0, dim v = 2} = v âŠ† LR v < 0, v âŠ¥ > 0}.

It is a real manifold of dimension 2n, but it carries a natural complex structure, derived
from the following description (see Section 13 of [Bo1], Section 3.2 of [Br1], Section 1.2
of [Ze1], Section 3.1 of [Fi], and others, but note that here we work with the opposite
signature). We set

(LC )0 = ZLC (ZL2 ) = ZL âˆˆ LC ZL2 = 0
to be the zero set of the quadratic form on LC , as well as

(3.2)
P = ZL âˆˆ (LC )0 (ZL , Z L ) < 0 ,
which is an open subset of (LC )0 . We have a natural map

(3.3)

P â†’ Gr(L),

ZL = XL + iYL 7â†’ v = RXL âŠ• RYL ,

which is clearly surjective. Moreover, the set P from (3.2) is the disjoint union P + âˆª P âˆ’ of
two connected components, distinguished by the orientation on the basis (XL , YL ) for the
space v from (3.3), and the restriction of the map from that equation to one component,
say P + , is still surjective. The natural action of O(LR ) on LC preserves P , the subgroup
SO+ (LR ) preserves the two components P + and P âˆ’ , and the map from (3.3) is O(LR )equivariant. In total, we get the following result.
Proposition 3.1. The Grassmannian Gr(L) from (3.1) is diffeomorphic to the image of
the connected component P + from (3.2) in the projective space P(LC ). This image is an
analytically open subset of the projective quadric P(LC )0 = ZP(LC ) (ZL2 ). Therefore Gr(L)
carries the structure of an n-dimensional complex manifold, on which SO+ (LR ) operates
holomorphically and transitively with compact stabilizers.
Following, e.g., the description in Section 2 of [BFr], one finds that the closure Gr(L) of
Gr(L) in P(LC )0 is obtained by adding appropriate boundary components to Gr(L), which
are associated with isotropic subspaces of LR . To understand them, we first observe that
the closure P + of P + in (LC )0 is

ZL = XL + iYL âˆˆ LC ZL2 = 0, (ZL , Z L ) â‰¤ 0, (XL , YL ) linearly dependent or oriented .

In the projective image we omit the point ZL = 0, and the boundary arises from the
complement of P + itself, so that the boundary of Gr(L) in ZP(LC ) (ZL2 ) is the projective
image of

(3.4)
0 6= ZL âˆˆ LC ZL2 = 0, (ZL , Z L ) = 0, (XL , YL ) linearly dependent or oriented .

Recalling the map from (3.3), taking a vector to the space spanned by its real and imaginary
part, we consider its behavior on the set from (3.4). Since now XL and YL are perpendicular
and isotropic, the space that they span, whose complexification is the span of ZL and Z L
over C, is isotropic. Its dimension cannot be 0 (since ZL = 0 is excluded in (3.4)), hence

14

JAN H. BRUINIER AND SHAUL ZEMEL

this space is either a line or a plane. It is a line if and only if XL and YL are linearly
dependent over R, or equivalently ZL and Z L are linearly dependent over C. Then all the
possible generators ZL of the complexification of this line have the same projective image.
The resulting point in (LC )0 is a 0-dimensional boundary component of Gr(L).
Otherwise the dimension is 2, and we choose a fixed oriented basis (z, w) for the resulting
isotropic plane. Since XL and YL are linearly independent, we find that ZL cannot be
spanned over C by w alone, and can therefore we be written as Î²(Ï„ w + z) for some complex
Î² 6= 0 and Ï„ = x + iy. Moreover, the linear independence shows that Ï„ 6âˆˆ R, and the
orientation implies that y > 0, i.e., Ï„ lies in the upper half-plane H = {Ï„ âˆˆ C| â„‘Ï„ > 0}. In
the projective image we may ignore only the factor Î², and hence the boundary component
of Gr(L) that is associated with our isotropic plane is the projective image of the set
(3.5)

{Ï„ w + z| Ï„ âˆˆ H},

which is 1-dimensional over C. Note that taking Ï„ to the boundary P1 (R) yields the 0dimensional boundary component of Gr(L) that is associated with a line that is contained in
our plane, namely the one spanned by Ï„ w + z for finite Ï„ âˆˆ R and by w for Ï„ = âˆ âˆˆ P1 (R).
We can summarize this in the following result.
Proposition 3.2. The boundary of Gr(L) inside the projective quadric from Proposition
3.1 consists of a 1-dimensional copy of H for every 2-dimensional isotropic subspace JR of
LR and a point for every isotropic line IR in LR . The latter boundary components exists in
any non-trivial case, i.e., wherever n â‰¥ 1, while the former ones are present only if n â‰¥ 2.
All these boundary components are mutually disjoint, and the point associated with IR lies
in the closure of the 1-dimensional component associated with JR if and only if IR âŠ† JR .

The last assertion of Proposition 3.2 is the incarnation of the statement, from [AMRT]
and others, that â€œa boundary component of a boundary component is a boundary componentâ€, in the orthogonal case. The reason for the notation IR for an isotropic line and JR
for an isotropic plane will become clear in the next subsection.
Recalling the rational structure arising from the fact that LR is the extension of scalars
of the lattice L to R, the find that the Bailyâ€“Borel space D BB is obtained by adding to
D = Gr(L) those boundary components from Proposition 3.2 that are associated with
isotropic subspaces of LR that arise as extensions of scalars from isotropic sublattices of L.
In addition, the lattice L has a dual lattice

Lâˆ— = Hom(L, Z) âˆ¼
= Î½ âˆˆ LR (Î½, L) âŠ† Z âŠ† LR ,

and we thus denote this subgroup of LR also by Lâˆ— . It contains L with finite index, and
the quotient âˆ†L = Lâˆ— /L is called the discriminant group of L. It carries the Q/Z-valued
2
quadratic form Âµ 7â†’ Âµ2 âˆˆ Q/Z and the non-degenerate Q/Z-valued bilinear form sending
Âµ and Î½ to (Âµ, Î½) âˆˆ Q/Z. The group O(L) of elements of O(LR ) that preserve L also
preserves Lâˆ— and thus acts on âˆ†L . We put SO+ (L) = O(L) âˆ© SO+ (LR ), and define its
discriminant kernel of L, sometimes called the stable special orthogonal group of L, by

(3.6)
Î“L = ker SO+ (L) â†’ Aut(âˆ†L ) .
This is the arithmetic subgroup that we will consider throughout the rest of this paper.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

15

3.2. Parabolic Subgroups of Orthogonal Groups. Given a boundary component of
Gr(L), the parabolic subgroup of SO+ (LR ) stabilizing this component is the stabilizer of the
corresponding isotropic subspace. There are (at most) two types of parabolic subgroups:
Ones that are associated with isotropic lines in LR , and ones that arise from isotropic
planes in LR . Having the rational structure, we work only with extensions of scalars of
primitive isotropic sublattices of L. Hence every rational isotropic line in LR is IR for a
primitive isotropic sublattice I of rank 1 in L, for which I = IR âˆ© L, and we set
(3.7)

ILâˆ— = IR âˆ© Lâˆ— ,

ILâŠ¥ = I âŠ¥ âˆ© L,

ILâŠ¥âˆ— = I âŠ¥ âˆ© Lâˆ— ,

and K = ILâŠ¥ /IL .

Then KR = IRâŠ¥ /IR is Lorentzian (of signature (n âˆ’ 1, 1) in our convention), in which K is
an even lattice, and one verifies that

Î· âˆˆ KR (Î·, K) âŠ† Z âˆ¼
= K âˆ— = Hom(K, Z) âˆ¼
= ILâŠ¥âˆ— /ILâˆ—
and the discriminant group of K is given by

âˆ†K = K âˆ— /K = ILâŠ¥âˆ— /(ILâŠ¥ + ILâˆ— ) = Lâˆ—I /(L + ILâˆ— ),
where Lâˆ—I stands for the subgroup

(3.8)
L + ILâŠ¥âˆ— = Âµ âˆˆ Lâˆ— âˆƒÎ½ âˆˆ L such that (Âµ, Î») = (Î½, Î») for all Î» âˆˆ I

of Lâˆ— . The lattice Lâˆ—I from (3.8) is the one denoted by Lâ€²0 (N) in [Br1].
We denote by PI,R the identity component of StSO+ (LR ) (IR ). A simple analysis of its
structure yields (see, e.g., [Nak], [Bo2], or [Ze5], among others) the following result.
+
Lemma 3.3. Consider the natural action of RÃ—
+ Ã— SO (KR ) on KR , in which the former
multiplier acts by ordinary scalar multiplication. Then there is a split exact sequence
+
0 â†’ (KR , +) â†’ PI,R â†’ RÃ—
+ Ã— SO (KR ) â†’ 1.

The rational isotropic planes in LR , which may exist only when n â‰¥ 2, are all of the
form JR , where J is a primitive isotropic sublattice of rank 2 in L. Then J = JR âˆ© L, and
as in (3.7) we define
(3.9)

JLâˆ— = JQ âˆ© Lâˆ— ,

JLâŠ¥ = J âŠ¥ âˆ© L,

JLâŠ¥âˆ— = J âŠ¥ âˆ© Lâˆ— ,

and D = JLâŠ¥ /JL .

Here D is an even lattice inside the positive definite n âˆ’ 2-dimensional space DR = JRâŠ¥ /JR ,
and we have descriptions of the dual lattice D âˆ— âŠ† DR , the discriminant group âˆ†D , and
the lattice Lâˆ—J , that are similar to those from I and K above, as in, e.g., (3.8). Since DR is
definite, the stabilizer StSO+ (LR ) (JR ) is connected, and we denote it by PJ,R . For presenting
its structure we recall the following definition.
Definition 3.4. The Heisenberg group H(DR ) associated with DR is the group DR Ã—DR Ã—R
with the product rule

(Î±, Î², t) Â· Î³, Î´, s) = (Î± + Î³, Î² + Î´, t + s + (Î±, Î´) âˆ’ (Î², Î³) .

It is a non-trivial central extension of DR Ã— DR by Z H(DR ) = {(0, 0, t)| t âˆˆ R} âˆ¼
= (R, +),
as expressed by the non-split short exact sequence

0 â†’ Z H(DR ) â†’ H(DR ) â†’ DR âŠ• DR â†’ 0.

16

JAN H. BRUINIER AND SHAUL ZEMEL

The group GL+
2 (R) Ã— SO(DR ) operates on H(DR ) via the formula
[M, Î³] : (Î±, Î², t) 7â†’ (aÎ³Î± + bÎ³Î², cÎ³Î± + dÎ³Î², det M Â· t),

where M = ac db . The action is compatible with the group structure on H(DR ). The
structure of PJ,R is now given (see, e.g., [K3] or [Ze5]) in the following lemma.
(3.10)

Lemma 3.5. After choosing an oriented basis (z, w) for JR , the action of GL+
2 (R)Ã—SO(DR )
on H(DR ) in (3.10) defines PJ,R via the split short exact sequence
1 â†’ H(DR ) â†’ PJ,R â†’ GL+
2 (R) Ã— SO(DR ) â†’ 1.

In correspondence with the general structure theorem from, e.g., Lemma 1.1 and Propositions 1.4 and 1.6 of [Ze5], the choice of the basis (z, w) for JR yields the isomorphisms
GL(JR ) âˆ¼
= GL2 (R),

HomR (DR , JR ) âˆ¼
= DR âŠ• DR ,

and

âˆ—
âˆ¼
Homas
R (JR , JR ) = R,

where for the middle one we also used the self-duality of DR .
In order to put these results in the framework of the theory of toroidal compactifications, we shall henceforth write Î for a 0-dimensional boundary component and Î¥ for a
1-dimensional boundary component. The symmetric space D is Gr(L), and its rational
completion is
[  [

BB
D = Gr(L) âˆª
ÎI âˆª
Î¥J ,
IâŠ†L

JâŠ†L

where I (resp. J) will always mean a primitive isotropic sublattice of L of rank 1 (resp.
2). Note that it is possible that the union over J here, and even the union over I, may
be empty even in cases where Proposition 3.2 does not imply its emptiness. On the other
hand, Meyerâ€™s Theorem (see, e.g., Corollary 2 on page 43 of [Se]) assures us that any
indefinite lattice of dimension at least 5 contains a non-zero isotropic vector. It follows
that if n â‰¥ 3 then rational 0-dimensional boundary components always exist, and when
n â‰¥ 5 we also have the existence of 1-dimensional such components.
Now, if Î = ÎI is the 0-dimensional boundary component of D BB âŠ† Gr(L) that is
associated with the rank 1 lattice I âŠ† L, then P(Î) is the group PI,R . We relate its
structure in Lemma 3.3 with the general structure from Proposition 2.7 as follows.

Proposition 3.6. The unipotent radical W(Î) of P(Î) = PI,R , as well as its center U(Î),
is the subgroup (KR , +) from Lemma 3.3. The quotient V(Î) is trivial, and so are the
group Gh (Î) = Aut(Î) and the compact group M(Î). The group Gâ„“ (Î) is the full quotient
+
RÃ—
+ Ã— SO (KR ), namely the full Levi subgroup.
Indeed, Î is a point, and the Levi subgroup from Lemma 3.3 has no compact factors,
yielding the triviality of Gh (Î) and M(Î).
For the explicit description of the fibrations from Proposition 2.8, choose an orientation
on I, and let z be the oriented generator of I. As presented in Section 13 of [Bo1], Section
3.2 of [Br1], Section 2.2 of [Ze1], or Section 1 of [Ze3], the condition of pairing to 1 with z
produces a section of the restriction of the projection from (3.3) to the component P + . The

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

17

orientation on elements v âˆˆ Gr(L) and on I given by the choices of P + and z determine a
cone C of negative norm vectors in the Lorentzian space KR , such that if


KR1 = Î¾ âˆˆ LR (Î¾, z) = 1 IR

is the affine model of KR arising from z, then our section defines a biholomorphic map
open


(3.11)
Gr(L) â†’ KR1 + iC âŠ† KR1 + iKR = KC1 = Î¾ âˆˆ LC (Î¾, z) = 1 IC .

The inverse of the map from (3.11), which implies that it is a biholomorphism, is easily
determined by the fact that different lifts to LC of an element of KC1 , which has a non-zero
pairing with the isotropic vector z, have different norms, and hence only one such lift is also
isotropic. The cone C and the complementary cone âˆ’C are self-adjoint in the terminology
of [AMRT] or [Nam], and the model KR1 + iC for Gr(L) from (3.11) is a tube domain. The
explicit description of the objects from Proposition 2.8 is now as follows.

e
Proposition 3.7. The basis Î and the fiber bundle D(Î)
are trivial, and D = Gr(L) is
isomorphic (as the fiber of a map to a point) to the affine tube domain KR1 +iC from (3.11).
The map Î¦ takes the element v âˆˆ Gr(L), whose image in P + under the section is ZL , to
the projection Y âˆˆ C of YL = â„‘ZL âˆˆ IRâŠ¥ in KR , and the cone â„¦(Î) is C.

In addition, U(Î) = KR acts additively on the real part of Gr(L) âˆ¼
= KR1 + iC from (3.11),
+
Ã—
and the quotient R+ Ã— SO (KR ) acts on its symmetric space, the cone C, via the map Î¦
described in Proposition 3.7, as Proposition 2.9 predicts.
We also need the intersections from (2.7), with Î“ being Î“L from (3.6). The following
result, in which Î“K is defined defined analogously to Î“L , was seen in [Bo1], [Br1], [Nak],
[Ze1], [Ze3], [Ze5], and others.
Proposition 3.8. The intersection PZ (Î) = PI,R âˆ© Î“L lies in a split short exact sequence
0 â†’ (K, +) â†’ PI,R âˆ© Î“L â†’ Î“K â†’ 1.

Hence WZ (Î) = UZ (Î) = K, the group PZ (Î) is the semi-direct product, and its image
Î“â„“ (Î) in Gâ„“ (Î) is Î“K .
As the action of UZ (Î) = K on Gr(L) âˆ¼
= KR1 + iC from (3.11) is additive on the real
part, we get that as the fiber over a point from Proposition 3.7 we have
(3.12)

open

K\ Gr(L) âˆ¼
= (KR1 /K) + iC âŠ† (KR1 /K) + iKR = KC1 /K = TK1 (C),

which is indeed a principal homogenous space over TK (C) = TUZ (Î) (C), as expected from
(2.9). In [Bo1], [Br1], [Ze1], [Ze3], and others, the affine tube domain from (3.11) is
replaced, via the choice of Î¶ âˆˆ Lâˆ— with (Î¶, z) = 1, by a subset of KC itself, and modulo K one
obtains a subset of TK (C) in (3.12). However, this is not necessary for most applications,
and we stay with our affine models, since they are more canonical. We summarize:
Corollary 3.9. The set UZ (Î)\D = K\ Gr(L) is isomorphic, as the fiber over the trivial
e
space D(Î),
to an open subset of a principal homogenous space over TK (C), with imaginary
part in the direction of C.

18

JAN H. BRUINIER AND SHAUL ZEMEL

We now compare the structure of the groups and fibrations that are associated with
a 1-dimensional boundary component to the components from Section 2. For a rank 2
primitive isotropic sublattice J âŠ† L, we denote the 1-dimensional boundary component
Î¥J of D BB âŠ† Gr(L) by Î¥, and then P(Î¥) is the group PJ,R considered in Lemma 3.5. For
putting this lemma in the framework of Proposition 2.7, recall that the action of GL+
2 (R)
on H and its factor of automorphy are defined as


aÏ„ + b
a b
,
and
j(M, Ï„ ) = cÏ„ + d
(3.13) M =
âˆˆ GL+
(R) : Ï„ âˆˆ H 7â†’ MÏ„ =
2
c d
cÏ„ + d
Ã—
respectively, and that GL+
2 (R) is the direct product of the connected component R+ of
+
Z GL2 (R) with SL2 (R). The decomposition of P(Î¥) is now as follows.

Proposition 3.10. The unipotent radical W(Î¥)
 of the group P(Î¥) = PJ,R is the Heisenberg group H(DR ), its center U(Î¥) is Z H(DR ) = R, and the quotient V(Î¥) is DR âŠ• DR .
Inside the Levi subgroup, Gh (Î¥) is SL2 (R), Gâ„“ (Î¥) is the group of RÃ—
+ of scalars, and M(Î¥)
is the compact group SO(DR ).
Take now, following Section 1 of [K3], an oriented Z-basis (z, w) for J from (3.9), and
lift Gr(L) into P + via the section of the map from (3.3) that is associated with z. Assume
that v âˆˆ Gr(L) is taken to ZL âˆˆ P + , and then the fact that YL2 < 0 for YL = â„‘ZL implies
that YL 6âˆˆ JRâŠ¥ and hence (YL , w) 6= 0. The orientation then implies that
x + iy = Ï„ = (ZL , w) âˆˆ H

(3.14)

(note that in spite of the similar notation, this is not the coordinate for the cusp Î¥ itself,
appearing in (3.5)). We now define, similarly to KR1 and KC1 from (3.11), the affine spaces




DR1,x = Î¾ âˆˆ LR (Î¾, z) = 1, (Î¾, w) = x JR , DR0,y = Î¾ âˆˆ LR (Î¾, z) = 0, (Î¾, w) = y JR ,
and the complexification



DC1,Ï„ = DR1,x + iDR0,y = Î¾ âˆˆ LC (Î¾, z) = 1, (Î¾, w) = Ï„ JC .

These are principal homogenous spaces over DR and an affine model of DC respectively.
The subgroups from Proposition 3.10 are given in [Fi] in terms of explicit matrices, under
the choice of a representing matrix for the quadratic form on L, but the more canonical
description of the fibrations from Proposition 2.8 uses the following presentation.
Lemma 3.11. With the choice of the basis (z, w) for J âŠ† JR , the action of W(Î¥) on LR
is as follows. First, the action of the element Î± âˆˆ R âˆ¼
= U(Î¥) on LR is defined by
Î± : Î» 7â†’ Î» âˆ’ Î±(Î», z)w + Î±(Î», w)z.

Consider now a pair (Âµ, Î½) âˆˆ DR âŠ• DR = V(Î¥), and let Î· denote an element of JRâŠ¥ and
Î» + JR denote the image of Î» âˆˆ LR in LR /JR . Then the action of (Âµ, Î½) is defined by the
formulas
Î· 7â†’ Î· âˆ’ (Î·, Âµ)w âˆ’ (Î·, Î½)z

and

Î» + JR 7â†’ Î» + (Î», w)Âµ + (Î», z)Î½ + JR .

Complexifying, and taking ZL and Ï„ are as in (3.14), we deduce that
Î± : ZL + Cz 7â†’ ZL âˆ’ Î±w + Cz,

and

(Âµ, Î½) : ZL + JR 7â†’ ZL + Ï„ Âµ + Î½ + JR .

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

19

Proof. In general, the unipotent radical W(Î¥) is defined as the kernel of the action of
P(Î¥) = PJ,R on JR via GL+ (JR ) âˆ¼
= GL+
2 (R) and on DR via SO(DR ) (see, e.g., [Ze5]).
Moreover, as dim JR > 1, the center U(Î¥) is the subgroup acting trivially on JRâŠ¥ , and in
dimension 2 the asserted action is the only orthogonal one fixing JRâŠ¥ pointwise (this is in
V2
âˆ—
correspondence with the space Homas
JR in the notation
R (JR , JR ) of [Ze5], or equivalently
of [L], being 1-dimensional). It follows that the quotient V(Î¥) has a well-defined action
on elements of JRâŠ¥ , which is given by subtracting elements of JR , but on general elements
of LR the action is only defined modulo JR (by subtracting elements of the quotient DR ).
With the appropriate normalization, the orthogonality condition yields again the required
formulas. For the last assertion we just consider the image of Î± modulo Cz, and substitute
the values (ZL , z) = 1 and (ZL , w) = Ï„ from (3.14). This proves the lemma.

The structure of D = Gr(L) that is associated with Î¥ in Proposition 2.8 can now be
described.
S
e
Proposition 3.12. The affine vector bundle D(Î¥)
from (2.6) is Ï„ âˆˆH DC1,Ï„ , with DC1,Ï„
e
as in (2.4),
being the fiber over Ï„ âˆˆ Î¥ âˆ¼
= H. The fiber of D over any point in D(Î¥),
is a translated upper half-plane. The cone â„¦(Î¥) is the ray R+ inside U(Î¥) = R, and if
2
v âˆˆ Gr(L) is represented by ZL âˆˆ P + and Ï„ is as in (3.14) then Î¦(v) = âˆ’ (â„‘Z2yL ) .
Proof. Lemma 3.11 shows that the fiber DC1,Ï„ over Ï„ âˆˆ Î¥ is a principal homogenous space
over V(Î¥), with the complex structure varying with Ï„ , as in (2.6). In addition, we have
e
seen that if v âˆˆ Gr(L) is sent to ZL âˆˆ P + then its image on D(Î¥)
is just ZL + JC âˆˆ DC1,Ï„ ,
for Ï„ from (3.14). Hence two images of our section that map to the same point in DC1,Ï„ can
only differ by complex multiples of w and z. But inverting the map from (3.11) shows that
the condition ZL2 = 0 determines the required multiple of z once that of w is chosen, so
that it remains to see which multiples of w satisfy the condition from (3.2). Write ZL as
XL + iYL as above, and as YL âŠ¥ z in the image of the section, the value of YL2 is evaluated
using only the multiple of w, and subtracting tw from YL subtracts 2yt from YL2 . Therefore
t must be bounded from below for obtaining section images from Gr(L), and there is no
restriction on the multiple of w subtracted from XL . The associated fiber is therefore an
affine
copy of H, and in particular it is non-empty, so that the map from Gr(L)
S translated
1,Ï„
to Ï„ âˆˆH DC is indeed surjective. As U(Î¥) is 1-dimensional, and the oriented cone â„¦(Î¥)
can only be the directed ray in U(Î¥), this is indeed as described in (2.4).
Now, Lemma 3.11 also shows that U(Î¥) acts transitively on the real parts of the fibers
Y2
of from (2.4), and the asserted Î¦-image âˆ’ 2yL was seen to be a translate of the imaginary
part of these fibers. Moreover, as this Î¦-image depends only on the imaginary part of ZL ,
the presentation from (2.5) also follows. In addition, our Î¦-image lies, by definition, in
the directed cone â„¦(Î¥) = RÃ—
+ inside U(Î¥) = R, and since Lemma 3.11 shows that both
Ï„ and z are invariant under W(Î¥), so is the value of Î¦. Now, the action of the Levi
e
quotient on D(Î¥)
over Î¥ and on â„¦(Î¥) via Î¦ is given in (3.10) via the interpretations
from Proposition 2.8, and if M âˆˆ GL+
2 (R) = Gh (Î¥) Ã— Gâ„“ (Î¥) and ZL is in the image of
the section and has projection in DC1,Ï„ for Ï„ from (3.14), then we have to divide the result

20

JAN H. BRUINIER AND SHAUL ZEMEL

by the factor of automorpy j(M, Ï„ ) from (3.13) in order to remain in the image of the
section. It follows that the action of Gh (Î¥) = SL2 (R) and M(Î¥) = SO(DR ) are trivial on
â„¦(Î¥), and that the group Gâ„“ (Î¥) = RÃ—
+ from Proposition 3.10 is indeed the automorphism
group of â„¦(Î¥), with trivial stabilizers. On the other hand, on Î¥ âˆ¼
= H the groups Gâ„“ (Î¥)
and M(Î¥) operate trivially, and the action of Gh (Î¥) is the natural one from (3.13). This
proves the proposition.

Note that [K3] and [Fi] essentially use a complement for JRâŠ¥ in LR , describing ZL as in
(4.18) below. However, we prefer the affine presentation from Proposition 3.12, since it is
more canonical and does not depend on the complement.
e
As a more geometric interpretation of the space D(Î¥)
we recall the following definition.

Definition 3.13. Over H lies Shimuraâ€™s variation of Hodge structure V1, which has dimension 2. Its fiber is C2 , and over Ï„ âˆˆ H it is defined by the vector Ï„1 having Hodge

weight (1, 0), while Ï„1 is of weight (0, 1). It is SL2 (R)-equivariant with respect to the
standard representation of that group on C2 , and has pure weight 1. If Ï€ : E â†’ H is the
universal elliptic curve over H then we have V1 âˆ¼
= R1 Ï€âˆ— C, and the integral structure on the
local system is based on the subgroup Z2 âŠ† C2 .

e
In terms of Definition 3.13, the short exact sequence form (2.6) describes the space D(Î¥),
âˆ¼
via Proposition 3.12, as an affine model of the vector bundle V1 âŠ— D over Î¥ = H.
As [Ze5] shows, the structure of the intersection PZ (Î¥) = PJ,R âˆ©Î“L can be rather delicate
in general (this point was overlooked in [Fi]). In order to avoid extra complications in our
description, we first recall that for any primitive sublattice M âŠ† L there is a unimodular
complement, namely a subgroup of Lâˆ— whose direct sum with M âŠ¥ âˆ©Lâˆ— yields the full lattice
Lâˆ— (the name arises from the fact that such a complement becomes naturally isomorphic to
Hom(M, Z), since M is primitive). We thus make the following hypothesis on the lattice
J from (3.9) for the rest of this section (the later results are independent of it).
Hypothesis 3.14. The lattice J has a unimodular complement JËœ that is isotropic and
whose intersection with the lattice Lâˆ—J defined as in (3.8) is contained in L, and the pairing
(Î», Âµ) is even for every Î» and Âµ in the definite lattice D = JLâŠ¥ /J from (3.9).
Note that our assumption on the pairing in D in Hypothesis 3.14 is stronger than D being
an even lattice (which is always the case when L is even), and is required for the assertion
about H(D) in Theorem 3.15 below (see Equation (14) of [Ze5]). It is always satisfied when
L is the rescaling by 2 of an integral lattice. The properties of the complement JËœ from
Hypothesis 3.14 are equivalent to the vanishing of the maps Î± and Î¹ from [Ze5]. Equation
(9) of [Ze5] then shows, after substituting Î± = 0 there, that




Ëœ âŠ¥ âˆ© Lâˆ— ,
Ëœ âŠ¥ âˆ© L and Lâˆ— = JLâˆ— âŠ• JËœ âŠ• (J âŠ• J)
L = J âŠ• (JËœ âˆ© Lâˆ— ) âŠ• (J âŠ• J)
J

Ëœ âŠ¥ âˆ© L (resp. (J âŠ• J)
Ëœ âŠ¥ âˆ© Lâˆ— ) mapping isomorphically onto D (resp. D âˆ— ). It is
with (J âŠ• J)
easy to see that a complement as in Hypothesis 3.14 always exists when L is the rescaling
of a maximal lattice, since a maximal lattice of Witt rank 2 always splits two hyperbolic
planes, but there are other examples of lattices where such complements exist. Note that a

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

21

similar condition for the rank 1 lattices I (which does not follow from that on the lattices
J, because a complement IËœ and the lattice Lâˆ—I from (3.8) are larger than those associated
with J) is not required, since Proposition 3.8 holds without any assumption on I.
As the basis (z, w) that we took for JR spans J over Z, the resulting isomorphism
+
between GL+
2 (R) and GL (JR ), appearing implicitly in Lemma 3.5, identifies SL2 (Z) with
SL(J). We define Î“J to be the congruence subgroup of SL2 (Z) that corresponds under this
isomorphism to

SL(JLâˆ— , J) = M âˆˆ SL(J) MÎ» âˆ’ Î» âˆˆ J for every Î» âˆˆ JLâˆ— .
We also define the integral Heisenberg group H(D) to be D Ã— D Ã— Z with the product rule
from Definition 3.4, and we get from [Ze5] the following result.

Theorem 3.15. The group H(D) is embedded in H(DR ) as the coordinates D Ã— D Ã— Z,
and one has the short exact sequence
1 â†’ H(D) â†’ PJ,R âˆ© Î“L â†’ Î“J Ã— Î“D â†’ 1,
which is split over Z, with the action from (3.10).
The groups with index Z here take the following form, in which we define uÎ¥ to be the
unique oriented primitive element of the cyclic group UZ (Î¥) that lies in the cone â„¦(Î¥).
Proposition 3.16. The integral unipotent radical WZ (Î¥) of PZ (Î¥) = PJ,R âˆ© Î“L is H(D),
its center UZ (Î¥) is cyclic and generated by uÎ¥ , and the quotient UZ (Î¥) is D âŠ• D. In
addition, the image Î“â„“ (Î¥) of PZ (Î¥) in Gâ„“ (Î¥) is trivial, in Gh (Î¥) is it Î“J , and in M(Î¥) it
is the finite group Î“D .
The cyclic group UZ (Î¥) from Proposition 3.16, oriented via â„¦(Î¥), is Homas (J âˆ— , J) in the
V
notation of [Ze5] and 2 J in the notation of [L]. The triviality of Î“â„“ (Î¥) implies that there
is no question of stabilizers in the fan Î£(Î¥). Recall that if Î“L is neat then neither Î“L nor
the group Î“K from Proposition 3.8 nor Î“J have non-trivial elements of finite order, and
the finite group Î“D is trivial. Dividing by the groups from Proposition 3.16 thus yields, by
Lemma 3.11 and Proposition 3.12, the following result.
e
Corollary 3.17. The fibers of UZ (Î¥)\D = ZuÎ¥ \ Gr(L) over the space D(Î¥)
from Proposition 3.12 are open subsets of affine models of the 1-dimensional torus TUZ (Î¥) (C). The space
WZ (Î¥)\ Gr(L) is a similar bundle over the universal family E âŠ— D over H from Definition
3.13. If Î“L is neat then the quotient PZ (Î¥)\ Gr(L) is also a bundle with the same fibers,
but now over the open Kugaâ€“Sato variety WJ defined by E âŠ— D over Î“J \H. The same
assertions hold if we replace Gr(L) by an open subset NÎ¥ as defined in Lemma 2.10.
As the exponential map of the corresponding normalized coordinate from H takes the
open subset of TU1Z (Î¥) (C) arising either from quotients of Gr(L) or of NÎ¥ onto a punctured
open disc in C, all the bundles from Corollary 3.17 are punctured disc bundles. We shall
indicate briefly what happens when Î“L is not neat, or when the conditions from Hypothesis
3.14 are not satisfied, after Proposition 3.19 below.

22

JAN H. BRUINIER AND SHAUL ZEMEL

3.3. The Toroidal Boundary Components. We begin by considering the toroidal
boundary components over 1-dimensional cusps. These boundary components are canonical, and their description does not require the gluing with the boundary components
lying over the 0-dimensional cusps. Indeed, we have seen in Propositions 3.16 and 3.12
that UZ (Î¥) has rank 1 and hence dim TUZ (Î¥) = 1, and the cone â„¦(Î¥) is a ray in U(Î¥).
There
is therefore only one possible cone decomposition: We must take Î£(Î¥) to be

â„¦(Î¥) âˆª {0}, {0} . It follows that if Î½Î¥ is the element of UZ (Î¥)âˆ— taking the generator
uÎ¥ from Proposition 3.16 to 1, then the toric variety XUZ (Î¥),Î£(Î¥) is Spec C[zÎ½Î¥ ] âˆ¼
= A1 ,
e
and the set DÎ¥ from (2.13) is the union of UZ (Î¥)\ Gr(L) and D(Î¥).
Note that the A1 â€²
coordinate zÎ½Î¥ is the coordinate denoted by q2 = e(Ï„2 ) in [K3], so that the equation zÎ½Î¥ = 0
for that boundary component, given in the proof of Proposition 2.5, is just q2 = 0 from
that reference. As Proposition 3.16 shows that PZ (Î¥) maps trivially to Gâ„“ (Î¥), no quotient
of the fiber XUZ (Î¥),Î£(Î¥) has to be taken in the construction of X tor . In particular, Theorem
2.13 becomes trivial for our Î¥.
Combining this information with Corollary 3.17 yields the form of DÎ¥ and its quotients.
The set NÎ¥ from Lemma 2.10 is defined by the Î¦-image being large enough in the 1dimensional ray â„¦(Î¥). We recall that (2.8) denotes the quotient PZ (Î¥)/UZ (Î¥) by P Z (Î¥),
that Lemma 2.10 defines the open subset NÎ¥ of D, and the notation for the relative interior
of the closure appearing in (2.12) and after it, and obtain the following description of the
o
sets DÎ¥ and UZ (Î¥)\NÎ¥ and their quotients in this case.
o

Lemma 3.18. The set DÎ¥ and the open subset UZ (Î¥)\NÎ¥ are full, non-punctured open
e
disc bundles over D(Î¥)
from Proposition 3.12, where the zero section of the disc defines
o
an analytic divisor O(Î¥). The quotient VZ (Î¥)\DÎ¥ and its open subset WZ (Î¥)\NÎ¥ are
similar disc bundles over the family E âŠ— D over H from Corollary 3.17. If Î“L is neat then
o
P Z (Î¥)\DÎ¥ , as well as the open subset PZ (Î¥)\NÎ¥ , are open disc bundles over the open
Kugaâ€“Sato variety WJ .
We deduce the following consequence (still under Hypothesis 3.14 and for neat Î“L ).

Proposition 3.19. The inverse image in P Z (Î¥) DÎ¥ of the image of Î¥ in PZ (Î¥)\D BB
has a smooth neighborhood that is biholomorphic to the product of WJ with a disc, in which
the boundary component itself is defined by the vanishing
of the disc coordinate. Therefore

to Î¥ one associates a canonical divisor in P Z (Î¥) DÎ¥ , which is isomorphic to WJ .
Proposition 3.19 follows immediately from the fact that the bundles in Lemma 3.18 are
trivial. We remark again that Lemma 3.18 and Proposition 3.19 do not depend on choices
of fans, since Î£(Î¥) is canonical.

Without Hypothesis 3.14, the form of the boundary divisor of P Z (Î¥) DÎ¥ can be significantly more complicatedâ€”the interested reader may consult Section 4 of [Ze5] for the
details. As mentioned above, Hypothesis 3.14 is only used for the simpler description of
the parts of Corollary 3.17, Lemma 3.18, and Proposition 3.19 involving the Kugaâ€“Sato
variety, and all the results that we present from now on are equally valid without it.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

23

Consider now a 0-dimensional cusp Î, associated with the rank 1 isotropic sublattice
I âŠ† L, with K as in (3.7). The toroidal boundary components lying over Î depend on
a choice of a fan Î£(Î), which has to be an admissible cone decomposition in the sense of
Definition 2.12. These components must lie, in correspondence with Corollary 3.9, in the
direction of â„¦(Î), which equals C by Proposition 3.7, but we shall also need to consider the
images â„¦(Î¥) for boundary components Î¥ of D BB with Î â‰¤ Î¥. These are Î¥ = D = Gr(L),
with â„¦(D) = {0}, and those components Î¥ associated with primitive isotropic rank 2
sublattices J âŠ† L such that I âŠ† J. Given such J, note that J âŠ† ILâŠ¥ , and the quotient J/I
is a rank 1 primitive isotropic sublattice of K, generating the isotropic line JR /IR âŠ† KR .
Assuming that the orientations and the bases are chosen appropriately, we get a generator
z for I, a generator Ï‰J,I for J/I that lies on the boundary of the cone C, and an element w
of J such that (z, w) is an oriented basis for J over Z and Ï‰J,I = âˆ’w + I. This extra sign
comes from the fact that w pairs positively with elements of C by (3.14), while the vector
Ï‰J,I , which lies in the closure of the cone C of negative norm vectors, pairs negatively with
elements of C.
Lemmas 3.3 and 3.5 and Propositions 3.8 and 3.16 allow us to neatly express the intersections P(Î) âˆ© P(Î¥) = PI,R âˆ© PJ,R and PZ (Î) âˆ© PZ (Î¥). In particular, the image of the
latter inside the Levi quotient from Lemma 3.3 is the stabilizer StÎ“K (J/I), for which an
analogue of Proposition 3.8 yields the split short exact sequence
(3.15)

0 â†’ (D, +) â†’ StÎ“K (J/I) â†’ Î“D â†’ 1.

with the quotient Î“D being trivial in case Î“L is neat. Moreover, the inclusions from Lemma
2.11 express themselves in the following relations, in which we note that the subgroup
{0} Ã— DR Ã— R of H(DR ), and its intersection {0} Ã— D Ã— Z with H(D), are Abelian.
Proposition 3.20. The image of U(Î) in the short exact sequence from Lemma 3.5 consists of the part {0} Ã— DR Ã— R of H(DR ), and of the upper triangular unipotent part of
SL2 (R). It is a direct sum of these two groups. After writing U(Î) = W(Î) âˆ¼
= (KR , +) as
in Proposition 3.6, we get
U(Î) âˆ© W(Î¥) = {0} Ã— DR Ã— R âˆ¼
= (JR /IR )âŠ¥
as well as

U(Î¥) = RuÎ¥ âˆ¼
= JR /IR = RÏ‰J,I .
Hence â„¦(Î¥) is the isotropic ray R+ Ï‰J,I on the boundary of â„¦(Î) = C. On the other
hand, Gh (Î) is the trivial subgroup of Gh (Î¥). Finally, the description of UZ (Î) = K from
Proposition 3.8 is obtained by replacing every R above by Z, and the spaces KR , DR , JR /IR ,
and (JR /IR )âŠ¥ by the lattices K, D, J/I, and (J/I)âŠ¥
K respectively.
The proof of Proposition 3.20 is a simple application of Lemma 3.11 and the action of
the unipotent part of Gh (Î¥) in Proposition 3.12. This also shows that the action of U(Î)
by translations of the real part in the model of Gr(L) as KR1 + iC from (3.11) becomes, in
the bundle structure appearing in Proposition 3.12, an additive action on the real parts of
e
the 1-dimensional fiber of Gr(L) over D(Î¥),
of the fibers of V1 âŠ— D, and of the variable
âˆ¼
Ï„ âˆˆ H = Î¥.

24

JAN H. BRUINIER AND SHAUL ZEMEL

As Proposition 3.8 shows that P Z (Î) is just Î“K , Proposition 3.20 yields the following
explicit description of the admissibility condition of Î£(Î) in Definition 2.12, for Î = ÎI .
Corollary 3.21. The fan Î£(Î) is an admissible cone decomposition as in Definition 2.12
if and only if the following two conditions are satisfied:
(i) We have
[

ÏƒâˆˆÎ£(Î)

Ïƒ = C âˆª {0} âˆª

[

Îâ‰¤Î¥



â„¦(Î¥) = C âˆª {0} âˆª

[

âŠ¥
IâŠ†JâŠ†IL


R+ Ï‰J,I ,

where Î¥ is always a 1-dimensional cusp and J is always a rank 2 primitive isotropic
sublattice of L.
(ii) Î£(Î) is Î“K -invariant, and the number of Î“K -orbits in Î£(Î) is finite.
For proving Corollary 3.21, it only remains to observe that every primitive isotropic
vector in K that lies in the closure of C must be the form Ï‰J,I for a 2-dimensional primitive
isotropic lattice J âŠ† L with I âŠ† J âŠ† ILâŠ¥ . Note that when V has Witt rank 1, there are no
1-dimensional boundary components Î¥ and K is anisotropic, which means that the union
S
ÏƒâˆˆÎ£(Î) Ïƒ from Corollary 3.21 is just C âˆª{0}. In any case, the action of Î“K sends boundary
components to boundary components.

Let thus Î£(Î) be admissible as in Corollary 3.21, and consider the toric variety XK,Î£(Î) .
The properly discontinuous action of Î“K on XK,Î£(Î) , predicted by Theorem 2.13, can be
verified directly. First, since the orthogonal complement in K of the generator of a ray
in C is positive definite, the stabilizer of every such ray in Î“K is finite, and the stabilizer
of any cone in Î£(Î) operates on the finitely many rays that generate it. This proves this
finiteness of the stabilizer of any cone Ïƒ containing a ray that lies inside C, and with it
the fact that the action of Î“K on the associated open subvariety XÏƒ of XK,Î£(Î) is properly
discontinuous. Next, consider the stabilizer StÎ“K (J/I) of the ray â„¦(Î¥) = R+ Ï‰J,I from
Proposition 3.20 for Î¥ with Î â‰¤ Î¥ that is associated with I â‰¤ J â‰¤ ILâŠ¥ . The action of
the infinite part (D, +) of that stabilizer, given in (3.15), does not leave any vector on
the boundary of C invariant, other than the multiples Ï‰J,I . Hence any cone of dimension
at least 2 in XK,Î£(Î) still has
 a finite stabilizer in Î“K , and the action of the larger group
PZ (Î¥) on the orbit O â„¦(Î¥) was already verified to be properly discontinuous, essentially
in Lemma 3.18. It particular, if Î“L is neat then all of these stabilizers are trivial.
Substituting (3.12) into (2.12) shows that for (KR1 /K) + iC âŠ† XK,Î£(Î) we have

[ 
o
o
1
1
(3.16)
(KR /K) + iC =
(KR /K) + iC âˆ© O(Ïƒ) ,
ÏƒâˆˆÎ£(Î)

where for every Ïƒ âˆˆ Î£(Î) that is neither {0} nor R+ Ï‰J,I for some J, the intersection is all
e
of O(Ïƒ). This is also the form of DÎ from (2.13), by the triviality of D(Î)
from Proposition
3.7. The most natural way of defining â„¦N (Î) âŠ† â„¦(Î) = C for the set NÎ from Lemma
2.10 is simply by requiring that |Y 2 | be large enough. Using (3.16) and Proposition 3.8,

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

25

o

we deduce from (2.14) that the subset PZ (Î)\NÎ of Î“K \XK,Î£(Î) is

io
[
 n /h
(3.17)
PZ (Î)\NÎ âˆª Î“K
[(KR1 /K) + iC] âˆ© O(Ïƒ)
,
{0}6=ÏƒâˆˆÎ£(Î)

with the union consisting of finitely many orbits.
One can also visualize (2.15) in our case: Since the comparison of any boundary component with D itself is immediate in general, the only case to consider is where dim Î = 0,
dim Î¥ = 1, and
 Î â‰¤ Î¥. Expressing DÎ as in (3.16), we then have to verify that
UZ (Î)/UZ (Î¥) DÎ¥ is the intersection of DÎ with the affine 
toric subvariety XK,â„¦(Î¥) of
XK,Î£(Î) . But indeed, Lemma 3.18 shows that UZ (Î)/UZ (Î¥) DÎ¥ is a disc bundle over

e
UZ (Î)/UZ (Î¥) D(Î¥),
which by Proposition 3.20 is itself fibered over the punctured disc

1
StÎ“J ( 0 \H, with the fibers being affine models of DC /D = TD (C). But extending the
disc in the fibers from Lemma 3.18 to C and the punctured disc in the base space to CÃ—
yields an affine structure of TK , with the completion of the disc corresponding to the coâˆ—
ordinates zÎ½ for those Î½ âˆˆ K
having a positive pairing with uÎ¥ = Ï‰J,I being allowed to
vanish. Hence UZ (Î)/UZ (Î¥) DÎ¥ is indeed the desired open subset of XK,â„¦(Î¥).
As the set from (3.17) maps isomorphically onto a neighborhood of Î in PZ (Î¥)\D BB ,
we apply (2.15) and deduce the following complement of Proposition 3.19.
fib
the complement in XK,Î£(Î) of the union
Proposition 3.22. Denote by XK,Î£(Î)
[
TK âˆª
O(R+ Ï‰J,I ),
âŠ¥
IâŠ†JâŠ†IL

with J as usual. It is a closed Î“K -invariant subset of XK,Î£(Î) , which is contained in DÎ .
fib
Then the inverse image in Î“K \XK,Î£(Î) of the image of Î in PZ (Î)\D BB is just Î“K \XK,Î£(Î)
.
It is a closed subset of Î“K \XK,Î£(Î) with a finite stratification, in which each stratum is the
quotient of a toric TK -orbit modulo a finite group. If Î“L is neat and Î£(Î) is smooth as in
Definition 2.3, then this inverse image has a smooth neighborhood in Î“K \XK,Î£(Î).
We shall need the divisors that are contained in the inverse image from Proposition 3.22.
Corollary 3.23. There are finitely many Î“K -orbits of rays Ï = R+ Ï‰ in Î£(Î), with primitive Ï‰ âˆˆ K, that are not of the form â„¦(Î¥) for a 1-dimensional boundary component
Î¥ with Î â‰¤ Î¥. The vector Ï‰ âˆˆ K âˆ© C satisfies Ï‰ 2 = âˆ’2NÏ‰ for some positive integer
NÏ‰ , which is constant on Î“K -orbits. Therefore the boundary from Proposition 3.22 contains finitely many irreducible divisors, each of which is the image of a divisor of the form
DÏ = OÎ£(Î) (R+ Ï‰), and to such a divisor is attached the associated integer NÏ‰ .
It may happen that for some cusp Î, the set of divisors from Corollary 3.23 will be
empty: See the end of Section 2 of [Nam] for an example (recall that the group Sp4 from
that reference is isogenous to SO+ (2, 3)), as well as the case considered in [P]. In such a
case the inverse image from Proposition 3.22 has codimension 2 in Î“K \XK,Î£(Î) .
We need to see when is our collection of fans admissible as well. The corresponding
condition from Definition 2.12 is simpler in our case than in general.

26

JAN H. BRUINIER AND SHAUL ZEMEL

Lemma 3.24. For admissibility of the set of fans {Î£(Î)}Î , it suffices that for two 0dimensional
 cusps that are related by Î“L , say Î and AÎ for A âˆˆ Î“L , we have the equality
Î£(AÎ) = AÏƒ Ïƒ âˆˆ Î£(Î) .

Indeed, the fans Î£(Î¥) = â„¦(Î¥), {0} for 1-dimensional boundary components Î¥ are
canonical, which in particular implies their Î“L -invariance, and they are included in Î£(Î)
wherever Î â‰¤ Î¥ in Corollary 3.21.
Since our arithmetic group depends on the choice of L, our open Shimura variety and
its Bailyâ€“Borel compactification from (2.3) are now
open

XL = Î“L \D = Î“L \ Gr(L) âŠ† XLBB = Î“L \D BB .

The toroidal compactification XLtor of XL , and the map onto XLBB = Î“L \D BB , are therefore
constructed, via Theorem 2.14, as follows.
Theorem 3.25. Let {Î£(Î)}Îâ‰¤D be an admissible collection of fans as in Definition 2.12,
or equivalently in Corollary 3.21 and Lemma 3.24. Then XL and the neighborhoods from
Lemma 3.18 and (3.17) glue together to a normal compact complex space, which is the set
tor
of complex points of a complete algebraic variety XLtor = X{Î£(Î)}
over C. It is smooth if
Î
Î“L is neat and each fan Î£(Î) is smooth in the sense of Definition 2.3
Note that if Î“L is not neat, finite quotient singularities may appear at every part of XLtor .
Let J and Î¥ be as in Proposition 3.19, and recall that the boundary divisor O(Î¥) of
o
DÎ¥ has the neighborhood UZ (Î¥)\NÎ¥ from
Lemma 3.18. Dividing by P Z (Î¥), we get the

o
neighborhood PZ (Î¥)\NÎ¥ inside P Z (Î¥) DÎ¥ , which embeds as an open subset of XLtor . We
denote the maps
o

Ï€Î¥ : UZ (Î¥)\NÎ¥ Ö‰ PZ (Î¥)\NÎ¥

o

and

o open

Î¹Î¥ : PZ (Î¥)\NÎ¥ Ö’â†’ XLtor .

In addition, if I, K, Î, and Î£(Î) are as above, then dividing the neighborhood NÎ from
o
Lemma 2.10 by UZ (Î) = K from Proposition 3.8 gives an open neighborhood UZ (Î)\NÎ of
fib
the fiber XK,Î£(Î)
from Proposition 3.22 inside XK,Î£(Î) , and dividing further by P Z (Î) = Î“K
o

gives the open subset PZ (Î)\NÎ of Î“K \XK,Î£(Î) . Also here we set the notation
o

Ï€Î : UZ (Î)\NÎ Ö‰ PZ (Î)\NÎ

o

and

o open

Î¹Î : PZ (Î)\NÎ â†’ XLtor .

Note that both Î¹Î¥ and Î¹Î have open images in XLtor , but while Î¹Î¥ is a homeomorphism onto
its image (whence the notation there), Î¹Î is not because the orbits O(R+ Ï‰J,I ) are divided
by WZ (Î¥)/UZ (Î) âˆ¼
= D. Taking Ï‰ and Ï to be as in Corollary 3.23, we define the irreducible
toroidal divisors

BI,Ï‰ = (Î¹Î â—¦ Ï€Î )(DÏ ) = (Î¹Î â—¦ Ï€Î ) OÎ£(Î) (R+ Ï‰) ,
(3.18)

BJ = (Î¹Î¥ â—¦ Ï€Î¥ ) O(Î¥) .

Then the boundary of XLtor consists of a finite number of such divisors: One divisor BJ
for every J in a set of representatives for the Î“L -orbits of isotropic sublattices of rank 2 in
L, and one divisor BI,Ï‰ for every I in a similar set of representatives having rank 1, and

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

27

for Ï‰ in a set of representatives for the Î“K -orbits of primitive elements generating internal
rays in the fan corresponding to I, where K = ILâŠ¥ /I. Clearly the image in XLtor of each
divisor does not depend on the representatives J or I and Ï‰, and in the latter case the
value âˆ’2NÏ‰ of Ï‰ 2 is also independent of the representative. We conclude by recalling that
the divisor BI,Ï‰ from (3.18) contains also the Î¹Î -images of orbits O(Ïƒ) for Ïƒ âˆˆ Î£(Î) with
Ï â‰¤ Ïƒ, and as for BJ , wherever Î â‰¤ Î¥ and Ïƒ âˆˆ Î£(Î) contains â„¦(Î¥) as a face, this divisor
BJ contains Î¹Î O(Ïƒ) as well.

Remark 3.26. The choice of the lattice L determined the group Î“L from (3.6) to be the
arithmetic group by which we divide D = Gr(L) for obtaining XL . In some situations
in may be useful to consider covers of XL obtained by dividing by (normal) congruence
subgroups of Î“L , especially when Î“L is not neat and one wishes to avoid the resulting finite
quotient singularities in XL . All of these constructions carry over to such covers, yielding
compactifications of them, but as results like Proposition 3.8 or Theorem 3.15 no longer
necessarily hold for intersections with subgroups of Î“L , the precise analysis of the partial
quotients with which we work in our investigation may become more difficult.
4. Green Functions for Special Divisors
In this section we introduce the special divisors on XL and their Green functions, and
investigate their extensions to the toroidal compactification XLtor .
4.1. Special Divisors and Theta Lifts of Harmonic Maass Forms. Given an element
Î» âˆˆ Lâˆ— with Î»2 > 0, the set

(4.1)
Î»âŠ¥ = v âˆˆ Gr(L) v âŠ¥ Î» ,

whose pre-image in P + is {ZL âˆˆ P + | (ZL , Î») = 0 , is a sub-Grassmannian of complex
codimension 1 in Gr(L), hence an analytic divisor. We shall be interested in the following
combinations of the divisors from (4.1), which are called special divisors.
Definition 4.1. For an element Âµ âˆˆ âˆ†L and an number 0 < m âˆˆ
special divisor of discriminant (m, Âµ) on XL to be
 X
Î»âŠ¥ .
Z(m, Âµ) = Î“L

Âµ2
2

+ Z we define the

Î»âˆˆÂµ+L
Î»2 =2m

tor
We shall use Z(m, Âµ) also for the closure of this divisor in XLBB , in XLtor = X{Î£(Î)}
, or in
Î
any analytic manifold containing a quotient of Gr(L) as a dense open subset.

Since the number of Î“L -orbits associated with any m and Âµ in Definition 4.1 is finite,
Z(m, Âµ) is an algebraic divisor on XL . The multiplicities of the irreducible components of
Z(m, Âµ) are 2 if 2Âµ = 0 âˆˆ âˆ†L , and 1 otherwise.
Recall now the factor of automorphy from (3.13), and let

Mp2 (Z) = (M, Ï•) M âˆˆ SL2 (Z), Ï• : H â†’ C, Ï•2 (Ï„ ) = j(M, Ï„ )

28

JAN H. BRUINIER AND SHAUL ZEMEL

be the metaplectic extension of SL2 (Z), with the product (M, Ï•)(N, Ïˆ) = (MN, (Ï•â—¦N)Â·Ïˆ).
It is generated by the elements


 


1 1
0 âˆ’1 âˆš
T =
,1
and
S=
, Ï„ .
0 1
1 0
Consider our even lattice L, of signature (n, 2), and let {eÂµ }Âµâˆˆâˆ†L denote the canonical basis
of the group ring C[âˆ†L ]. We denote by ÏL the Weil representation of Mp2 (Z) on C[âˆ†L ],
normalized as in [Bo1], [Br1], or [Ze1]. The dual representation Ïâˆ—L of ÏL is canonically
isomorphic to the complex conjugate representation ÏL .
Let k âˆˆ 21 Z be a weight, and denote the weight k hyperbolic Laplacian, in the variable
Ï„ = x + iy âˆˆ H, by
âˆ†k = âˆ’y 2 (âˆ‚x2 + âˆ‚y2 ) + ky(âˆ‚y âˆ’ iâˆ‚x ) = âˆ’Î¾2âˆ’k Î¾k ,
where Î¾k is the operator from [BFu] which is defined by Î¾k f = 2iy k âˆ‚Ï„ f . Recall that
a harmonic Maass form of weight k and representation ÏL is a real-analytic function
f : H â†’ C[âˆ†L ] satisfying the functional equation
f (AÏ„ ) = Ï•(Ï„ )2k ÏL (A, Ï•)f (Ï„ )

(4.2)

for every (A, Ï•) âˆˆ Mp2 (Z) and Ï„ âˆˆ H, the differential equation âˆ†k f = 0, and such that
the growth of f towards the cusp âˆ is at most linear exponential. The Î¾k -image of such a
modular form is a weakly holomorphic modular form of weight 2 âˆ’ k and representation ÏL
(i.e., it is holomorphic on H, with at most a pole at âˆ, and satisfies the functional equation
from (4.2) with 2k replaced by 4 âˆ’ 2k and ÏL replaced by ÏL ), see [BFu]. We denote by
Mk! (ÏL ) the space of weakly holomorphic modular forms of weight k and representation ÏL ,
by Mk (ÏL ) the subspace consisting of holomorphic modular forms, by S2âˆ’k (ÏL ) the space
of cusp forms of weight 2 âˆ’ k and representation ÏL , and by Hk (ÏL ) the space of harmonic
Maass form of weight k and representation ÏL whose Î¾k -image is cuspidal. Corollary 3.8 of
[BFu] provides us with the exactness of the sequence
Î¾

k
S2âˆ’k (ÏL ) â†’ 0.
0 â†’ Mk! (ÏL ) â†’ Hk (ÏL ) â†’

The modularity condition with respect to T implies that F âˆˆ Hk (ÏL ) admits the Fourier
expansion
X
X
X X
c+ (Î´, l)q l eÎ´ +
câˆ’ (Î´, l)Î“(1 âˆ’ k, 4Ï€|n|y)q leÎ´ ,
(4.3)
F (Ï„ ) =
Î´âˆˆâˆ†L lâˆˆâˆ’ Î´2 +Z
2

Î´âˆˆâˆ†L 0>lâˆˆâˆ’ Î´2 +Z
2

Râˆ
with q = e(Ï„ ) as usual, such that c+ (Î´, l) = 0 for l â‰ª 0, and where Î“(s, x) = x ts eâˆ’t dtt
is the incomplete Gamma function. We denote by F + (Ï„ ) the first sum in (4.3), called the
holomorphic part of F (Ï„ ), and the second sum, which is the non-holomorphic part of F (Ï„ ),
by F âˆ’ (Ï„ ). Moreover, restricting the sum defining the holomorphic part F + (Ï„ ) to include
only the indices l < 0 yields the (finite) principal part of F . Proposition 3.11 of [BFu] then
yields the following result.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

29

2

Proposition 4.2. For every Âµ âˆˆ âˆ†L and 0 < m âˆˆ Âµ2 + Z there is a harmonic Maass form
Fm,Âµ âˆˆ H1âˆ’ n2 (ÏL ), which is unique up to an element of M1âˆ’ n2 (ÏL ), whose principal part is
q âˆ’m (eÂµ + eâˆ’Âµ ).
We remark that when n â‰¥ 3, where the harmonic Maass form Fm,Âµ from Proposition 4.2
is uniquely defined, it is alternatively constructed in [Br1] as a PoincareÌ series. When n = 2
it is unique up to a ÏL -invariant vector, and when n = 1 up to a larger degree of freedom,
and the Hecke trick extends PoincareÌ series also to these cases, with some particular choice
of the element from M1âˆ’ n2 (ÏL ). In correspondence with the notation from [Br1] and [BFu],
the specialization of (4.3) when F = Fm,Âµ expands Fm,Âµ (Ï„ ) as
(4.4)
X
X
X
X
l
l
b+
bâˆ’
q âˆ’m (eÂµ + eâˆ’Âµ ) +
m,Âµ (Î´, l)q eÎ´ +
m,Âµ (Î´, l)Î“(1 âˆ’ k, 4Ï€|l|y)q eÎ´ .
Î´âˆˆâˆ†L 0>lâˆˆâˆ’ Î´2 +Z
2

Î´âˆˆâˆ†L 0â‰¤lâˆˆâˆ’ Î´2 +Z
2

The coefficients bÂ±
m,Âµ (Î´, l) are evaluated in Proposition 1.10 of [Br1], and they are real
numbers. This is true, by the Hecke trick, also when n = 2 and l 6= 0, and we assume that
b+
m,Âµ (Î´, 0) âˆˆ R as well in this case. While some of the results below hold equally well for
n = 1, the fact that Fm,Âµ can be far from unique in this case can create some complications.
On the other hand, the boundary components are just the classical 0-dimensional cusps in
this case, and the theta lifts are investigated in detail in [BO], so that we do not lose much
by restricting attention to n â‰¥ 2.
Given Ï„ = x + iy âˆˆ H and v âˆˆ Gr(L), we recall the Siegel theta function

X  Î»2
2
e Ï„ v2âŠ¥ + Ï„ Î»2v eÎ»+L ,
(4.5)
Î˜L (Ï„, v) = y
Î»âˆˆLâˆ—

where Î»v and Î»vâŠ¥ are the projections of Î» onto the corresponding subspaces of LR . Theorem 4.1 of [Bo1] implies that the function Ï„ 7â†’ Î˜L (Ï„, v) is modular of weight n2 âˆ’ 1 and
representation
ÏL for any
P
Pfixed v âˆˆ Gr(L). WePrecall the pairing sending two vectors
a = Î´âˆˆâˆ†L aÎ´ eÎ´ and b = Î´âˆˆâˆ†L bÎ´ eÎ´ to ha, biL = Î´âˆˆâˆ†L aÎ´ bÎ´ , and consider the regularized
theta lift
Z reg
L
(4.6)
Î¦m,Âµ (v) =
hÎ˜L (Ï„, v), Fm,Âµ (Ï„ )iL dÂµ(Ï„ )
Mp2 (Z)\H

of the function Fm,Âµ from Proposition 4.2, where dÂµ(Ï„ ) = dxy2dy is the invariant measure on
H, with the regularization defined either in [Bo1] or in [Br1], and where we can replace v by
the complex variable from Proposition 3.1. Proposition 2.11 of the latter reference implies
that the difference between the two regularizations is only in the value of the constant Cm,Âµ
below, and is therefore irrelevant to our purposes. Recall the decomposition of the exterior
derivative d as âˆ‚ + âˆ‚, as well as the complementary operator dc = âˆ‚âˆ’âˆ‚
, so that ddc = 2Ï€i âˆ‚âˆ‚.
4Ï€i
In addition, if Z is a divisor on XL then we denote by Î´Z the current on XL that takes
R an
element Î· of the space Ac2nâˆ’2 (XL ) of compactly supported (2n âˆ’ 2)-forms on XL to Z Î·.
Some important properties of the theta lift Î¦Lm,Âµ are given in the following theorem.

30

JAN H. BRUINIER AND SHAUL ZEMEL

Theorem 4.3. The invariant Laplace operator on Gr(L), normalized as in [Br1], takes
1 L
the theta lift Î¦Lm,Âµ from (4.6) to n4 b+
m,Âµ (0, 0). Moreover, the function 2 Î¦m,Âµ is smooth on
XL \Z(m, Âµ) with a logarithmic singularity along Z(m, Âµ). The function 21 Î¦Lm,Âµ also satisfies
the current equation
ddc [ 21 Î¦Lm,Âµ ] + Î´Z(m,Âµ) = [Î·(m, Âµ)]
as currents on Ac2nâˆ’2 (XL ), where Î·(m, Âµ) is a smooth harmonic 2-form representing the
Chern class of the line bundle that is associated with Z(m, Âµ) on XL .
The first assertion in Theorem 4.3 is Theorem 4.7 of [Br1] (see [Ze1] for analogues of
this statement, without contributions from the constant terms, in some different weights).
For the other assertions we refer to Theorem 2.11 of [Br1] and Theorem 7.3 of [BFu].
In particular, 21 Î¦Lm,Âµ is a logarithmic Green function for Z(m, Âµ) on XL in the sense of
Arakelov geometry, see Section 1.2.4 of [GS] and Section 5.6 of [BKK]. We remark that [OT]
presents a different approach for the construction of such automorphic Green functions,
using spherical functions for symmetric pairs and PoincareÌ series constructions.
4.2. Green Functions Near the Toroidal Boundary. We will now investigate the
growth behavior of Î¦Lm,Âµ along the boundary of the toroidal compactifiation XLtor .
For expressing Î¦Lm,Âµ near the boundary we shall need some notation. First, for the
non-triviality of the boundary of D BB there must exist an isotropic sublattice I of rank 1
in L, with an oriented generator z and an associated 0-dimensional boundary component
Î âˆˆ D BB , and we take K to be as in (3.7) and IËœ âŠ† Lâˆ— to be a unimodular complement for
I, with an oriented generator Î¶ pairing to 1 with z. Subtracting the image of Î¶ transforms
the affine tube domain model KR1 + iC from (3.11) into the open subset KR + iC of KC ,
âˆ—
so that the pairing of an element Z of the
âˆš latter space Ywith some element Î· âˆˆ K is welldefined. Given Y âˆˆ C, we write |Y | for âˆ’Y 2 , so that |Y | represents a normalized oriented
generator of a negative definite subspace in KR . Observe that Î¶ âˆˆ Lâˆ— has well-defined Q/Zpairings with elements of âˆ†L , and recalling the lattice Lâˆ—I from Equation (3.8), we define
the projection
(4.7)

pK : ILâŠ¥âˆ— /ILâŠ¥ = Lâˆ—I /L â†’ âˆ†K ,

pK Î´ = Î´ + ILâˆ— /I.

Now, if Âµ âˆˆ ILâŠ¥âˆ— /ILâŠ¥ and Î½ âˆˆ ILâŠ¥âˆ— âˆ© (Âµ + L) with Î½ 2 = 2m then the closure of the analytic
divisor Î½ âŠ¥ from (4.1) in D BB contains Î. Moreover, there are finitely many Î“L -orbits of
such divisors Î½ âŠ¥ , which form a hyperplane arrangement in the terminology of [L]. Omitting
the intersection of their imaginary parts with the cone C produces a disjoint union of open
subsets of C that are called Weyl chambers. By a slight abuse of terminology we also call
a Weyl chamber the subset KR1 + iW of KR1 + iC for a Weyl chamber W in C, and we recall
that these Weyl chambers are associated with m and Âµ, or equivalently with the form Fm,Âµ .
The theta lift Î¦Lm,Âµ from (4.6) is described explicitly in the formula preceding Definition 3.11 of [Br1], which we now put in our notation and conventions. We recall that
Z âˆ
dt
2
VÎº (A, B) =
Î“(1 âˆ’ Îº, A2 t)eâˆ’B tâˆ’1/t 3/2
t
0

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

31
âˆš

2

2

is the special function from Equation (3.25) of [Br1], which decays as CÎµ eâˆ’2(1âˆ’Îµ) A +B as
K
A2 + B 2 â†’ âˆ. Considering the function denoted by Fm,Âµ
in the language of [Bo1] and
L
by â†“K (Fm,Âµ ) using the operators from [Br2], it is used for defining the theta lift Î¦K
m,pK Âµ
similarly to (4.6), and we describe it in Proposition 4.6 below.
Proposition 4.4. Let ZL âˆˆ P+ be such that (ZL , z) = 1 and the image Y of â„‘ZL in
C âŠ† KR lies in a Weyl chamber W that is associated with Fm,Âµ and satisfies |Y 2 | > 2m.
Then there is a constant Cm,Âµ such that the equality


Y
|Y | K
L
2
Î¦m,Âµ (ZL ) = âˆš Î¦m,pK Âµ
+ Cm,Âµ âˆ’ b+
m,Âµ (0, 0) log |Y |+
|Y |
2
X
X



Î½2
b+
log 1 âˆ’ e (Î½, ZL ) âˆ’ 4
âˆ’4
m,Âµ Î½ + L, âˆ’ 2 log 1 âˆ’ e (Î½, ZL ) +
âŠ¥ âˆ©(Â±Âµ+L)]/I
Î½âˆˆ[IL
âˆ—
Î½ 2 =2m
(Î½+IR ,W )>0

âŠ¥ /I
Î½âˆˆIL
âˆ—
2
Î½ â‰¤0
(Î½+IR ,W )>0


âˆ
X


e
h(Î½,
â„œZ
)
2 X âˆ’
2
L
V1+ n2 Ï€h|Î½| Â· |Y |, Ï€h(Î½, Y )
+âˆš
bm,Âµ Î½ + L, âˆ’ Î½2
h
Ï€
âŠ¥
h=1
Î½âˆˆILâˆ— /I
Î½ 2 >0

holds, where the first term and the first sum do not appear if Âµ 6âˆˆ ILâŠ¥âˆ— /ILâŠ¥ .
Proof. Let Z = X +iY âˆˆ KR +iC be the coordinate ZL âˆ’Î¶ +IC correspondingto ZL . Then
the formula from [Br1] in question involves expressions like e (Î´, Î¶) + (Î», Z) for Î» âˆˆ K âˆ—
and Î´ âˆˆ Lâˆ—I /L with pK Î´ = Î» + K. The expression for Z and the fact that Î» is of the form
2
2
Î½ + ILâˆ— for some Î½ âˆˆ ILâŠ¥âˆ— imply that Î½2 = Î»2 and (Î», Z) is the same as (Î½, ZL âˆ’ Î¶). In
addition, the choice of Î´ determines Î½ up to I rather than up to ILâˆ— , and the pairing (Î´, Î¶)

is then the image in Q/Z of (Î½, Î¶), so that the expression in question is just e (Î½, ZL ) ,
which is defined for Î½ âˆˆ ILâŠ¥âˆ— /I. Substituting all this, and normalizing according to our
convention for the signature, gives the desired result. This proves the proposition.

The constant Cm,Âµ from Proposition 4.4 is given, in the regularization from [Br1], by
X

+â€²
b+
b+
m,Âµ (0, 0)(log 2Ï€ âˆ’ Î³) + bm,Âµ (0, 0) âˆ’ 2
m,Âµ (â„“, 0) log 1 âˆ’ e (â„“, Î¶) ,
06=â„“âˆˆILâˆ— /I
â€²

where Î³ is the Euler-Mascheroni constant and b+
m,Âµ (0, 0) is the derivative with respect to
the spectral parameter (see Theorem 3.9 of [Br1]). Note that by Proposition 2.11 of [Br1],
this derivative does not appear in Cm,Âµ when one works with the regularization from [Bo1].
The proof of Proposition 4.4 also shows that the exponents in the formula for Cm,Âµ do not
depend on the choice of Î¶ and IËœ as well.
As we are interested in the behavior near toroidal boundary divisors, we first need to
divide by UZ (Î) = K and consider Î¦Lm,Âµ as a function on the subset (KR1 /K) + iC of the
principal homogenous space TK1 (C) from (3.12). This is done as follows.

32

JAN H. BRUINIER AND SHAUL ZEMEL

Lemma 4.5. The expression from Proposition 4.4 is invariant under the action of K by
translations on the real part, and thus represents the value Î¦Lm,Âµ (ZL + K) with the variable
ZL + K âˆˆ (KR1 /K) + iC âŠ† TK1 (C) as well.
The Grassmannian Gr(K) that is associated with the Lorentzian lattice K, of signature
(nâˆ’1, 1), is defined as in (3.1), but with the dimension of the negative definite subspaces of
KR being 1. As each such subspace is generated by a unique element u1 âˆˆ C with u21 = âˆ’1,
we can define the Siegel theta function Î˜K as in (4.5), but with the Grassmannian variable
âˆš
v replaced by such a vector u1 and y replaced by y. The function Ï„ 7â†’ Î˜K (Ï„, u1 ) is then
modular of the same weight n2 âˆ’ 1 and representation ÏK for every such u1 . The theta lift
Î¦K
m,pK Âµ , evaluated at u1 , is defined like in (4.6), but with L replaced by K, v replaced by
u1 , and â†“LK (Fm,Âµ ) instead of Fm,Âµ itself. Recalling that when n â‰¥ 3 the latter function is
defined as a PoincareÌ series, we deduce that â†“LK (Fm,Âµ ) = 0 when Âµ 6âˆˆ ILâŠ¥âˆ— /ILâŠ¥ , and with it
Î¦K
m,pK Âµ vanishes as well. A similar argument will show that if n â‰¤ 2 then perhaps some
function remains from lifting an element of M1âˆ’ n2 (ÏL ).
For evaluating the first term in Proposition 4.4, we assume that L has Witt rank 2
and hence K is also isotropic, and we choose an isotropic sublattice of K, which is of the
form J/I for an isotropic sublattice J of rank 2 in L. We extend the basis z of I to an
oriented basis (z, w) for J, so that the image of w in K, which we shall also denote by w,
is a generator for J/I whose additive inverse lies on the boundary of C. A unimodular
complement JËœ is spanned by the dual basis, which we can write, if IËœ is chosen appropriately,
as consisting of Î¶ âˆˆ IËœ from above and another element Ï… âˆˆ JËœ âˆ© ILâŠ¥âˆ— pairing to 1 with w.
We would like to express Î¦K
m,pK Âµ via Equation (3.11) of [Br1], up to a small correction as
âŠ¥
follows. we define pD : JLâˆ— /JLâŠ¥ = Lâˆ—J /L â†’ âˆ†D for D as in (3.9) analogously to (4.7), and
recall that B2 is the second Bernoulli function, which is 1-periodic and defined by
B2 (x) = x2 âˆ’ x +

1
6

for 0 â‰¤ x â‰¤ 1.

Since D is positive definite, its associated Grassmannian from (3.1) is trivial, and the
theta function from (4.5) has just the variable Ï„ , in which it is a holomorphic modular
form of the weight n2 âˆ’ 1 and representation ÏD (see (4.24) below). Then the analogue
of (4.6) defines Î¦D
m,pD Âµ as the regularized integral of a non-holomorphic modular function
on Mp2 (Z)\H arising from Î˜D and â†“LD (Fm,Âµ ), which vanishes by the same argument if
n â‰¥ 3 and Âµ 6âˆˆ JLâŠ¥âˆ— /JLâˆ— . Let Kn/2 denote the modified Bessel function of the third kind
with the parameter n2 , recall that the pairing (w, Y ), which is well-defined for Y âˆˆ KR
because w âˆˆ I âŠ¥ , is positive by the orientation on J/I and C, and we obtain the following
expression.
Proposition 4.6. If Âµ âˆˆ ILâŠ¥âˆ— /ILâŠ¥ and the inequality (w, Y ) <

|Y | K
Y
âˆš Î¦
in Proposition 4.4 equals
m,p
Âµ
|Y |
K
2

|Y |
âˆš
2 m

X

|Y 2 |
b+
Î¦D
m,Âµ (â„“, 0)B2 (â„“, Ï…) +4Ï€(w, Y )
m,pD Âµ +4Ï€(w, Y )
2(w, Y )
â„“âˆˆJLâˆ— /J

holds, then the first term
X

âŠ¥ âˆ©(Âµ+L)]/J
Î»âˆˆ[JL
âˆ—
Î»2 =2m

B2




(Î», Y )
+
(w, Y )

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

4(w, Y )
+
Ï€

X

bâˆ’
m,Âµ

âŠ¥ /J
06=Î»âˆˆJL
âˆ—

Î»+L, âˆ’

Î»2
2

âˆ
X
h=1



Ï€h|Î»| Â· |Y |
(w, Y )

33

n/2 



2Ï€h|Î»| Â· |Y |
(Î», Y )
Kn/2
,
e h
(w, Y )
(w, Y )

where the third term also appears only when Âµ âˆˆ JLâŠ¥âˆ— /JLâˆ— .

Proof. We know that Âµ âˆˆ ILâŠ¥âˆ— /ILâŠ¥ , and we take some element u1 âˆˆ C with u21 = âˆ’1 and
(w, u1) < 2âˆš1m , which allows us to express Î¦K
m,pK Âµ (u1 ) via Proposition 3.1 and Equation
(3.3) of [Br1]. This formula involves arguments like (Î², ÂµÌƒ) + (Î±, Ï…), with Î² âˆˆ D âˆ— and
Î± âˆˆ âˆ†K that is perpendicular to the image of JLâˆ— in âˆ†K and whose image in âˆ†D is Î² + D,
u1
w
âŠ¥
and where ÂµÌƒ is the vector (w,u
âˆ’ Ï… + 2(w,u
2 in (J/I)R âŠ† KR in our signature convention.
1)
1)
Each such Î± is the image of several elements Î´ âˆˆ JLâŠ¥âˆ— /JLâŠ¥ with pD Î´ = Î² + D, for each such
Î´ we can write (Î±, Ï…) as (Î´, Ï…), and for the Fourier coefficients we recall that â†“LK (Fm,Âµ )(Ï„ )
expands as the principal part q âˆ’m (epK Âµ + eâˆ’pK Âµ ) plus
X
X
X
X
X
X
l
l
b+
bâˆ’
m,Âµ (Î´, l)q eÎ± +
m,Âµ (Î´, l)Î“(1 âˆ’ k, 4Ï€|l|y)q eÎ± .
Î±âˆˆâˆ†K 0â‰¤lâˆˆâˆ’ Î±2 +Z Î´âˆˆI âŠ¥âˆ— /I âŠ¥
L
L
2
pK Î´=Î±

Î±âˆˆâˆ†K 0>lâˆˆâˆ’ Î±2 +Z Î´âˆˆI âŠ¥âˆ— /I âŠ¥
L
L
2
pK Î´=Î±

We can thus work with pairs (Î², Î´) for such Î² and Î´, which are in correspondence with
elements Î» âˆˆ JLâŠ¥âˆ— /J like in the proof of Proposition 4.4. The pairing of the K âˆ— -image such
an element, which is its class in JLâŠ¥âˆ— /(J + ILâˆ— ), with w âˆˆ J/I is 0, and its pairing with u1 is
2
2
well-defined up to integral multiples of (w, u1). Since we have (Î², ÂµÌƒ) = (Î», ÂµÌƒ) and Î²2 = Î»2 ,
and (Î´, Ï…) is the image of (Î», Ï…) in Q/Z once again, it follows that the argument in question
is just (Î», ÂµÌƒ + Ï…). By the formula for ÂµÌƒ and the vanishing of (Î», w), this is the same as
(Î»,u1 )
, which is indeed defined up to integers and is substituted into 1-periodic functions.
(w,u1 )
Recalling that in the first term in Proposition 4.4 we have k = 1 âˆ’ n2 and the coefficient
|Y |
âˆš , and that the variable u1 = Y satisfies the inequality (u1 , w) < âˆš1
from Proposition
|Y |
2 m
2
3.1 of [Br1] by our assumption on Y , this proves the proposition.

4.3. Determining the Growth Towards the Boundary. As mentioned above, we need
to see how automorphic Green functions behave near a boundary component. Lemma
4.5 already allows us to work in TK1 , and we consider the rank 1 isotropic lattice I, the
associated 0-dimensional boundary component Î of D BB , the lattice K from (3.7), and the
cone C. We take a cone Ïƒ âˆˆ Î£(Î) that does not come from Î£(Î¥) for any 1-dimensional
cusp Î â‰¤ Î¥, i.e., such that O(Ïƒ) âŠ† DÎ maps to Î âˆˆ D BB , and we denote the primitive
elements of K that span Ïƒ as a cone by Ï‰j with 1 â‰¤ j â‰¤ d.
Some of the ray generators Ï‰j of Ïƒ lie in C, while some others can be of the form Ï‰J,I
for some primitive isotropic rank 2 lattice I âŠ† J âŠ† ILâŠ¥ . We order the indices such that
there is some 0 â‰¤ e â‰¤ d such that Ï‰j is Ï‰Jj ,I for such a lattice Jj when 1 â‰¤ j â‰¤ d, while if
e + 1 â‰¤ j â‰¤ d then Ï‰j is a primitive element of K âˆ© C. We take some small 0 < Îµ < 1, we
consider the open trimmed cone

X
d
d
X
Îµ
bj > Îµ ,
Ïƒ =
bj Ï‰j âˆˆ Ïƒ bj > 0 for every 1 â‰¤ j â‰¤ d and
j=1

j=1

34

JAN H. BRUINIER AND SHAUL ZEMEL

and we decompose
(4.8)

Îµ

Ïƒ =

e
[

ÏƒkÎµ

k=1

âˆª

Ïƒ0Îµ

=

d
e X
[

k=1

j=1

bj Ï‰j âˆˆ Ïƒ

Îµ

X
j6=k

bj < Îµbk



h
i
S
Îµ/2
âˆª Ïƒ Îµ \ ek=1 Ïƒk

as the union of sets that are open in Ïƒ, where our condition that Îµ < 1 implies that the only
non-trivial intersections can be between ÏƒkÎµ with k â‰¥ 1 and Ïƒ0Îµ . Note that our assumption
on Ïƒ precisely excludes the case where d = e = 1, so that Ïƒ0Îµ 6= âˆ…, and it is clear that when
Ïƒ âŠ† C âˆª {0}, i.e., when e = 0, the set Ïƒ0Îµ is just the full trimmed cone Ïƒ Îµ .
Let Îº be a subspace of KR of dimension dim Ïƒ that is defined over Q such that the
pairing between Îº and RÏƒ is non-degenerate. It will be notationally convenient to assume
that Îº contains vectors of negative norm, and therefore its orthogonal complement ÎºâŠ¥ is
positive definite (or trivial if dim Ïƒ = n). This yields decompositions
âŠ¥
âŠ¥
KR = ÎºâŠ¥ âŠ• RÏƒ, KC = ÎºâŠ¥
C âŠ• CÏƒ, and TK (C) = KC /K = [ÎºC /(Îº âˆ© K)] âŠ• [CÏƒ/(Ïƒ âˆ© K)],

where allowing the real parts to be affine yields decompositions also for KC1 and the affine
model TK1 (C) from (3.12). For an element Z + K âˆˆ TK (C) we denote the projections onto
the parts from these decompositions as ZÎºâŠ¥ and ZÏƒ , so that the imaginary part Y âˆˆ KR
is YÎºâŠ¥ + YÏƒ accordingly, and similarly for the affine variable ZL + K âˆˆ TK1 (C). Note that
while at this point is seems natural to take Îº = RÏƒ, which makes these decompositions
orthogonal, see the proof of Corollary 4.9 below for the reason why we allow a more
general space Îº here and decompositions that are not orthogonal. The additional boundary
components O(Ï„ ) of the open subset XK,Ïƒ of XK,Î£(Î) , where {0} =
6 Ï„ âˆˆ Î£(Î) is a face of Ïƒ,
are obtained by considering points Z +K in which the coordinates of YÏƒ that are associated
with Ï„ are infinite, and the corresponding coordinates of â„œZÏƒ disappear.
Now, adding to Ïƒ boundary points in which some of the coefficients of the generators
Ï‰j may attain the value +âˆ yields a compact set, which we denote by ÏƒÌ„. Thus extending
the range of YÏƒ to ÏƒÌ„ makes it defined on all of XK,Ïƒ . For small Îµ > 0 we write ÏƒÌ„ Îµ for
Ïƒ Îµ âˆª (ÏƒÌ„ \ Ïƒ), and for every 0 â‰¤ k â‰¤ e we denote by ÏƒÌ„kÎµ the relative interior of the closure of
the set ÏƒkÎµ from (4.8) in ÏƒÌ„ Îµ . Recall that the open subset DÎ of XK,Î£(Î) can be written as
in (3.16), and set

Îµ
DÎ,Ïƒ = DÎ âˆ© XK,Ïƒ and DÎ,Ïƒ
= ZL + K âˆˆ DÎ,Ïƒ (â„‘ZL )Ïƒ âˆˆ ÏƒÌ„ Îµ ,
Îµ
where the full orbit O(Ïƒ) is contained in DÎ,Ïƒ
. Recall that if {0} =
6 Ï„ â‰¤ Ïƒ is not of the
form â„¦(Î¥) âˆª {0} for some Î¥ then O(Ï„ ) âŠ† DÎ,Ïƒ , while if Ï„ 6= Ïƒ then some points of O(Ï„ )
Îµ
will not lie in DÎ,Ïƒ
. On the other hand, all the points in O(Ï„ ) for such Ï„ will be covered
Îµ
when we work in DÎ,Ï„
. The decomposition from (4.8) allows us to write

(4.9)

Îµ
DÎ,Ïƒ

=

e
[

k=0

Îµ,k
DÎ,Ïƒ

e
[

Îµ
=
ZL + K âˆˆ DÎ,Ïƒ
(â„‘ZL )Ïƒ âˆˆ ÏƒÌ„kÎµ .
k=0

Îµ
Recall that if Y is the imaginary part of an element of DÎ,Ïƒ
then YÏƒ âˆˆ C and hence YÏƒ2 < 0,
with |YÏƒ2 | being very small only when YÏƒ is close either to 0 or to R+ Ï‰k for some 1 â‰¤ k â‰¤ e.
We can now prove the following result.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

35

Proposition 4.7. For every compact subset M of ÎºâŠ¥ there exists
Pd some R > 0 such that
Îµ,0
the following holds: Write Y = â„‘(ZL ) for ZL + K âˆˆ DÎ,Ïƒ as j=1 bj Ï‰j + YÎºâŠ¥ with bj â‰¥ 0
P
for 1 â‰¤ j â‰¤ d and dj=1 bj > Îµ. Then when YÎºâŠ¥ âˆˆ M and bj > R for some 1 â‰¤ j â‰¤ d, the
function Î¦Lm,Âµ (ZL + K) equals


YÏƒ
|YÏƒ | K
2
2
âˆš Î¦m,pK Âµ
(4.10)
âˆ’ b+
m,Âµ (0, 0) log |YÏƒ | âˆ’ 2 log |Ï†|
|Y
|
2
Ïƒ
plus a smooth remainder, where Ï† is a holomorphic function defining the divisor Z(m, Âµ).
Proof. The element Y = â„‘ZL âˆˆ C satisfies

(4.11)

|Y 2 | = âˆ’Y 2 = âˆ’(YÏƒ + YÎºâŠ¥ )2 = |YÏƒ2 | âˆ’ 2(YÏƒ , YÎºâŠ¥ ) âˆ’ YÎº2âŠ¥ .

Since the quadratic form YÏƒ2 is bounded away from 0 on Ïƒ0Îµ , we deduce that |YÏƒ2 | is comparable on Ïƒ0Îµ with any positive definite quadratic form Q on Ïƒ, in the sense that there
exist constants 0 < câˆ’ < c+ such that câˆ’ Q(YÏƒ ) â‰¤ |YÏƒ2 | â‰¤ c+ Q(YÏƒ ) for every YÏƒ in this set.
Recalling that YÎºâŠ¥ is confined to the compact set M, we deduce that the first summand
in (4.11) grows quadratically with each bj , while the second summand is linear in these
parameters with bounded coefficients, and the third one is bounded. It follows that when
at least one of the parameters bj , 1 â‰¤ j â‰¤ d is large enough, the inequality |Y 2 | > 2m
is satisfied, and we can evaluate Î¦Lm,Âµ (ZL + K), via Lemma 4.5, as the expression from
Proposition 4.4, where W is an appropriate Weyl chamber. Applying the logarithm to
(4.11) produces


YÎº2âŠ¥
2(YÏƒ , YÎºâŠ¥ )
2
2
log |Y | = log |YÏƒ | + log 1 âˆ’
âˆ’ 2 ,
|YÏƒ2 |
|YÏƒ |
2
yielding the term involving log |YÏƒ | and a function that is smooth on our domain of consideration by our analysis of the terms in (4.11).
Next, the expressions involving V1+ n2 in Proposition 4.4 are smooth on K\ Gr(L) and
Îµ,0
decay with each bj , and are thus smooth on all of DÎ,Ïƒ
, and even on the whole set DÎ,Ïƒ .
As for the penultimate term in that proposition, recall that if Î½ âˆˆ ILâŠ¥âˆ— with Î½ 2 â‰¤ 0 then
the condition (Î½ + IR , W ) > 0 for any Weyl chamber in C is equivalent to Î½ + IR lying
in the closure of the cone âˆ’C, independently of W , and for these elements the imaginary
part of (Î½, ZL ) grows linearly with every bj , 1 â‰¤ j â‰¤ d. It follows that all the summands in
that term are smooth on DÎ,Ïƒ as well. Comparing the remaining terms from Proposition
4.4 with the first asserted term in (4.10) and assuming that Y lies in the closure of a Weyl
chamber W shows that the parts of the remainder that we still have to investigate are




X

Y
|Y | K
|YÏƒ | K
YÏƒ
(4.12) âˆš Î¦m,pK Âµ
log 1 âˆ’ e (Î½, ZL ) .
âˆ’ âˆš Î¦m,pK Âµ
âˆ’4
|Y |
|YÏƒ |
2
2
âŠ¥
Î½âˆˆ[ILâˆ— âˆ©(Â±Âµ+L)]/I
Î½ 2 =2m
(Î½+IR ,W )>0

For investigating the difference between the first two terms in (4.12), we recall from [Br1]
that Î¦K
m,pK Âµ is the restriction to norm âˆ’1 vectors of C of the sum of a smooth function
eK
and a continuous piecewise linear function. If we define the function Î¦
m,pK Âµ to take Y âˆˆ C

36

JAN H. BRUINIER AND SHAUL ZEMEL



eK
, then Î¦
m,pK Âµ is also a similar sum. Take now a Weyl chamber W that
e K,W be the smooth extension to C of the restriction
contains YÏƒ in its closure, and let Î¦
m,pK Âµ
K
e K,W (YÏƒ ),
e
of Î¦m,pK Âµ to W . It follows that the second term in (4.12) can be written as âˆš12 Î¦
m,pK Âµ
which is independent of the choice of W by continuity, but it may be that different choices
of Y will land in other Weyl chambers. To take care of this we recall that Theorem 2.12
of [Br1], or equivalently Corollary 6.4 of [Bo1], shows that given
âˆš another Weyl chamber
K,WÌƒ
K,W
e
e
WÌƒ , the function Î¦m,pK Âµ is obtained from Î¦m,pK Âµ by adding âˆ’8 2Ï€ times the sum of the
expressions (Î½ + IR , Y ) for

(4.13)
Î½ âˆˆ [ILâŠ¥âˆ— âˆ© (Â±Âµ + L)]/I Î½ 2 = 2m, (Î½ + IR , W ) < 0, (Î½ + IR , WÌƒ ) > 0 .
to |Y |Î¦K
m,pK Âµ

Y
|Y |

Note the negative sign arising from our signature convention, and that the elements Î½ that
have to be inverted in the last term in (4.12) when Y moves from W to WÌƒ are also precisely
those lying in the set from (4.13).
Consider first the situation in which the Weyl chamber WÌƒ is separated from W by a
single element Î» âˆˆ ILâŠ¥âˆ— âˆ© (Âµ + L) with Î»2 = 2m, whose K âˆ— -image pairs positively with WÌƒ
and negatively with W . Then the set from (4.13) is {Î»}, and the value of (4.12) on WÌƒ is
therefore the value on W plus


âˆ’8Ï€(Î» + I, Y ) âˆ’ 4 log 1 âˆ’ e (Î», ZL ) + 4 log 1 âˆ’ e (âˆ’Î», ZL ) = 0.
Since every two Weyl chambers are separated by a finite number of walls, it follows that
e K,W
e K,WÌƒ (Y )
âˆš1 Î¦
if we replace the first term from (4.12), which reduces to âˆš12 Î¦
m,pK Âµ (Y ), by
2 m,pK Âµ

for some Weyl chamber WÌƒ , and the inequality that is imposed in the third term there is
(Î½ + IR , WÌƒ ) > 0, then the total expression is independent of WÌƒ .
We therefore choose WÌƒ to be the Weyl chamber W which we have used for the second
term. The difference of between the first two terms in the resulting form of (4.12) can then
be written as





|YÏƒ | e K,W
YÏƒ
Y
K,W
e
âˆš Î¦m,pK Âµ
âˆ’ Î¦m,pK Âµ
,
|YÏƒ |
|YÏƒ |
2
e K,W
where now Î¦
m,p Âµ is a smooth function. We can thus apply Taylorâ€™s theorem, noting that
K

Y

the difference between the arguments is |YÎºÏƒâŠ¥| . As the set of norm âˆ’1 vectors inside the
closure of Ïƒ0Îµ in C is compact, and the point |YYÏƒÏƒ | around which we expand lies in that
Îµ,0
set, the coefficients of this expansion are smooth and bounded on all of DÎ,Ïƒ
. Combining
Y

the external coefficient with the denominator of the Taylor variable |YÎºÏƒâŠ¥| , we deduce that
this difference is indeed smooth on that set. The fact that every element of DÎ,Ïƒ can be
perpendicular to only finitely many Î½ âˆˆ [ILâŠ¥âˆ— âˆ© (Â±Âµ + L)]/I with Î½ 2 = 2m implies that
the sum in the third term of (4.12), in which the condition (Î½ + IR , W ) > 0 is imposed
Îµ,0
throughout our subset of DÎ,Ïƒ
, is indeed âˆ’2 times the logarithm of the square of the
absolute value of a holomorphic defining function for the divisor Z(m, Âµ) there. This
completes the proof of the proposition.


SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

37

The fact that the values from (4.12), and hence of Î¦Lm,Âµ , were seen in the proof of Proposition 4.7 to be independent of the choice of the Weyl chamber W , is in correspondence
with the singularities of this function being logarithmic along 1-codimensional complex
subvarieties, and not along 1-codimensional real submanifolds such as walls between Weyl
chambers. Recalling that if all the rays of Ïƒ are generated by elements of C then Ïƒ0Îµ = Ïƒ Îµ
Îµ,0
Îµ
in (4.8) and hence DÎ,Ïƒ
= DÎ,Ïƒ
in (4.9), Proposition 4.7 describes the behavior of Î¦Lm,Âµ in
Îµ
all of the vectors of DÎ,Ïƒ with large enough imaginary part, and in particular on all the
boundary points there. It therefore gives the complete description near the boundary in
case L has Witt rank 1. We also remark that when dim Ïƒ = n we have ÎºâŠ¥ = 0 and YÏƒ = Y ,
and the expression with Y instead of YÏƒ throughout is also valid in Proposition 4.7, and
even with a shorter proof. However, YÏƒ grasps the important part of Y near the boundary
Îµ,0
of DÎ,Ïƒ
, and will be more convenient for our consequences below.
Assuming now that the Witt rank of L is 2, take a primitive isotropic lattice I âŠ† J âŠ† ILâŠ¥
of rank 2 for our rank 1 primitive isotropic lattice I, with the associated 0-dimensional
cusp Î, 1-dimensional cusp Î¥ with Î â‰¤ Î¥, and the lattice K from (3.7). Let Ï be the ray
â„¦(Î¥) âˆª {0} = R+ Ï‰J,I , considered as an external ray that lies in Î£(Î), and note that the
natural extension of (4.8) to the case where Ïƒ = Ï is with ÏÎµ1 = ÏÎµ and ÏÎµ0 = âˆ…. Consider
Ï 6= Ïƒ âˆˆ Î£(Î) with Ï â‰¤ Ïƒ, and let k â‰¥ 1 be the index such that Ï‰k = Ï‰J,I . Recall that if
UZ (Î¥) is the cyclic group associated with the 1-dimensional cusp Î¥ then in the coordinates
from (3.11) it corresponds to translations by J/I = ZÏ‰J,I , and that the quotient of the set
DÎ¥ by K/ZÏ‰J,I is an open subset of DÎ,Ïƒ . We now turn to investigating Î¦Lm,Âµ on the set
Îµ,k
Îµ
DÎ¥
defined analogously to the one on the right hand side of (4.9), as well as on DÎ,Ïƒ
.
To do so we choose an oriented basis (z, w) for J such that I = Zz as always, and recall
that Ï‰k = Ï‰J,I = âˆ’w + I in this case. Moreover, note that if Îµ is small enough then any
Weyl chamber W that has a non-trivial intersection with ÏƒkÎµ for our Ïƒ and k must contain
Ï‰k = Ï‰J,I in its closure, and this is clearly the case also when Ïƒ = Ï and Ïƒ1Îµ = ÏÎµ . We
take some 1-dimensional rational negative definite vector space ÎºJ , that is therefore not
perpendicular to Ï‰J,I , where for our given Ïƒ, for which we already chose Îº above in a way
that it contains negative norm vectors, we assume that ÎºJ âŠ† Îº. It follows that each vector
Y âˆˆ C can be written as tÏ‰J,I + YÎºâŠ¥J where YÎºâŠ¥J lies in a positive definite subspace of KR ,
and since ÎºJ âŠ† Îº and hence ÎºâŠ¥ âŠ† ÎºâŠ¥
.
J we can also write YÏƒ as tÏ‰J,I + YÏƒ,ÎºâŠ¥
J
Proposition 4.8. Consider an element ZL + ZÏ‰J,I âˆˆ DÎ¥ , and express Y = â„‘ZL as
tÏ‰J,I + YÎºâŠ¥J . Then given a compact subset M âŠ† ÎºâŠ¥
J , there is a number T > 0 such that
L
wherever YÎºâŠ¥J âˆˆ M and t > T the value of Î¦m,Âµ (ZL + ZÏ‰J,I ) is
(4.14)

2
+
tÎ¦D
m,pD Âµ âˆ’ bm,Âµ (0, 0) log t âˆ’ 2 log |Ï†|

plus a smooth function. In addition, consider the cone Ïƒ with the space Îº containing ÎºJ .
Here a compact subset M âŠ† ÎºâŠ¥ and the parameter Îµ determine a number T > 0 such
Îµ,k
that if ZL + K âˆˆ DÎ,Ïƒ
satisfies YÎºâŠ¥ âˆˆ M and t > T then Î¦Lm,Âµ (ZL + K) can again be
described using (4.10), where the difference between the first terms there and that of (4.14)
is bounded by a constant multiple of Îµt and the difference between the second respective

38

JAN H. BRUINIER AND SHAUL ZEMEL

Îµ,k
terms is smooth in internal points of DÎ,Ïƒ
and grows like b+
m,Âµ (0, 0) log t towards non-trivial
boundary components there.

Proof. The isotropy of Ï‰J,I and its relation with w imply that our analog of (4.11) is
(4.15) |Y 2 | = âˆ’Y 2 = âˆ’2t(Ï‰J,I , YÎºâŠ¥J ) âˆ’ YÎº2âŠ¥ = 2t(w, YÎºâŠ¥J ) âˆ’ YÎº2âŠ¥ ,
J

J

and (w, Y ) = (w, YÎºâŠ¥J ).

Since YÎºâŠ¥J is taken from M, the two expressions (w, YÎºâŠ¥J ) and YÎº2âŠ¥ from (4.15) are bounded,
J
where the former is bounded away from 0 from below because (w, Y ) > 0 for every Y âˆˆ C.
It follows that when t is large enough, the inequality |Y 2 | > 2m is satisfied regardless of
YÎºâŠ¥J , and we can use the expression from Proposition 4.4, recalling that the Weyl chamber
W in which we do the evaluation must contain Ï‰J,I = âˆ’w + I in its closure. Moreover,
since the expressions (w, YÎºâŠ¥J )2 and YÎº2âŠ¥ are positive definite quadratic forms on ÎºâŠ¥
J , they
J
are comparable as described in the proof of Proposition 4.7. In addition, recall that if
Ïƒ = Ï then YÎºâŠ¥J âˆˆ M and if Ïƒ 6= Ï then YÎºâŠ¥ âˆˆ M and YÏƒ âˆˆ ÏƒkÎµ , and in the latter case if we
P
write YÏƒ as dj=1 bj Ï‰j then the coefficient bk is t plus a linear combination of the other bj s.
It follows that in the first case (w, YÎºâŠ¥J ) is bounded, and in the second case it is the sum of
the bounded expression (w, YÎºâŠ¥ ) and (w, YÏƒ,ÎºâŠ¥J ), where the latter is positive and bounded
by some multiple of Îµt by the definition of ÏƒkÎµ in (4.8).
Now, the logarithm of the expression from (4.15) is

YÎº2âŠ¥ 
2
J
log |Y | = log t + log(w, YÎºâŠ¥J ) + log 2 âˆ’
,
t(w, YÎºâŠ¥J )
Îµ,k
where the second and third logarithms are smooth on DÎ¥ . On the other hand, on DÎ,Ïƒ
we
2
can express |YÏƒ | like in (4.15) but with YÎºâŠ¥J replaced by YÏƒ,ÎºâŠ¥J , and as our second logarithm is
log(w, YÏƒ,ÎºâŠ¥J ) plus a smooth function and both the third logarithm and its YÏƒ,ÎºâŠ¥J -counterpart
are smooth, we indeed get the second term of (4.10) up to smooth functions. Since the
difference from the second term of (4.14) is log(w, YÏƒ,ÎºâŠ¥J ) plus a smooth expression, and
Îµ,k
the argument of the logarithm is bounded by a multiple of Îµt for elements of DÎ,Ïƒ
, the
description of the difference of the second terms is established. The smoothness of the
terms with V1+ n2 throughout is proved like in Proposition 4.7, and our property of W
implies that (Î½ + IR , w) â‰¥ 0 for every vector Î½ that appears in Proposition 4.4. As â„‘(Î½, ZL )
becomes now t(Î½, Ï‰J,I ) + (Î½, YÎºâŠ¥J ) and our analysis implies that the second summand is
smaller than the first one, we see that all the summands in which (Î½, Ï‰J,I ) > 0, which do
not depend on the choice of the Weyl chamber W , produce smooth and decaying functions
Îµ,k
on our domain in DÎ¥ and on the one in DÎ,Ïƒ
. This covers all the elements in the third
term of that proposition, namely those arising from elements of ILâŠ¥âˆ— with K âˆ— -images in the
closure of âˆ’C, except Î½ âˆˆ JLâˆ— /I with JLâˆ— from (3.9) that project modulo ILâˆ— onto positive
multiples of w. But the latter summands produce products of constant coefficients of Fm,Âµ
and log 1 âˆ’ e h(w, ZL ) for positive h âˆˆ Q with bounded denominators, which are also
Îµ,k
smooth functions of ZL + ZÏ‰J,I âˆˆ DÎ¥ as well as of ZL + K âˆˆ DÎ,Ïƒ
.

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

39

The remaining summands, which correspond to Î½ âˆˆ JLâŠ¥âˆ— /I, can be partitioned according
to their D âˆ— -images, which are the finitely many elements of norm 2m in pD Âµ âˆª âˆ’pD Âµ âŠ† D âˆ— .
Moreover, since each Î½ is already an I-coset, elements that lie in each class, e.g., the class
associated with Î² âˆˆ pD Âµ + D, differ by integral multiples of w. Assume, for the moment,
that ZL + ZÏ‰J,I or ZL + K is not a boundary point, so that (w, ZL ) is Ï„ = x+ iy as in (3.14)
and hence (w, Y ) = y > 0. Then the condition (Î½ + IR , W ) > 0 determines â€œone halfâ€ of
this class, which we write as Î½Î²,W + Nw for the unique element Î½Î²,W âˆˆ JLâŠ¥âˆ— /I that satisfies
Î½Î²,W + J/I = Î² as well
as 0 < (Î½Î²,W , Y ) â‰¤ y and therefore (Î½ âˆ’ w, Y ) â‰¤ 0. By writing

Î±Î²,W = e (Î½Î²,W , ZL ) and recalling that (Î½Î²,W , w + I) = 0 we obtain an element of C that
depends on ZL but not on t and satisfies |q| â‰¤ |Î±Î²,W | < 1, where the equality |Î±Î²,W | = |q|
occurs P
if and only if (Î½Î²,W âˆ’ w, Y ) = 0. The contribution of the class associated with Î² is
l
thus 4 âˆ
l=0 log |1 âˆ’ Î±Î²,W q |, which is independent of t since so are Î±Î²,W and q. It is now
clear that Î½âˆ’Î²,W is 2w âˆ’ Î½Î²,W when (Î½Î²,W , Y ) = y and w âˆ’ Î½Î²,W otherwise, and therefore
q2
q
Î±âˆ’Î²,W equals Î±Î²,W
in case |Î±Î²,W | = |q| and Î±Î²,W
when |Î±Î²,W | > |q|, but as the set for which
q
throughout without affecting
|Î±Î²,W | = q for some Î² has measure 0, we can write just Î±Î²,W
our investigation.
Next, the linear growth of |Y 2 | from (4.15) with t while (w, Y ) = y is independent of
2
2
Ïƒ|
t implies that for large enough t we have |Y4m| > (w, Y )2 as well as |Y4m
> (w, YÏƒ )2 . We
can therefore use Proposition 4.6 for expressing the first term from Proposition 4.4, as well
as the asserted first term in (4.14). The smoothness and decay of the Bessel K-function
|YÏƒ |
|Y |
and (w,Y
from above to show that the last summand in
combine with the growth of (w,Y
)
Ïƒ)
Îµ,k
each of these expansions is also smooth on DÎ¥ or on DÎ,Ïƒ
. The second term there is (w, Y )
times a constant, which is smooth on DÎ¥ when Ïƒ = Ï and whose difference from the same
Îµ,k
constant times (w, YÏƒ ) is smooth on DÎ,Ïƒ
. Note that this part of the first term of (4.14) is

(w, YÏƒ,ÎºâŠ¥J ) times a constant. As

Î¦D
m,pD Âµ

is a constant, (4.15) and the boundedness of

Y 2âŠ¥
Îº
J

2(w,YÎºâŠ¥ )
J

on M when Ïƒ = Ï implies that the first term in that proposition yields the first asserted
|Y 2 |
Îµ,k
term up to smooth functions. As for DÎ,Ïƒ
when Ïƒ 6= Ï, we have to compare 2(w,Y
with
)
|YÏƒ2 |
,
2(w,YÏƒ )

both of which we express via (4.15), and applying an equality like (4.11) evaluates
this difference as
"
#
2
2
YÏƒ,Îº
YÏƒ,Îº
YÎº2âŠ¥
(w, YÏƒ,ÎºâŠ¥J ) 2(YÏƒ,ÎºâŠ¥J , YÎºâŠ¥ ) + YÎº2âŠ¥
âŠ¥
âŠ¥ (w, YÎºâŠ¥ )
J
J
J
J
âˆ’
=
âˆ’
,
2(w, YÎºâŠ¥J ) 2(w, YÏƒ,ÎºâŠ¥J )
(w, YÎºâŠ¥J )
2(w, YÏƒ,ÎºâŠ¥J )
2(w, YÏƒ,ÎºâŠ¥J )2
(w,Y

)

where the external multiplier is the inverse of 1âˆ’ (w,Y ÎºâŠ¥âŠ¥ ) , the first summand is the quotient
Ïƒ,Îº
J

of two linear forms on ÏƒR âˆ© ÎºâŠ¥
J , the second one is a quotient of two quadratic forms on
that space, and the coefficients come from the element YÎºâŠ¥ of the compact set M. This
Îµ,k
difference is therefore smooth on our subset of DÎ,Ïƒ
, and note that the second term on the
left hand side is (w, YÏƒ,ÎºâŠ¥J ) times the quotient of the two quadratic forms.

40

JAN H. BRUINIER AND SHAUL ZEMEL

Recalling that the set [JLâŠ¥âˆ— âˆ© (Âµ + L)]/J projects bijectively onto pD Âµ + D, it remains to
consider the expression
#
"


âˆ
âˆ
l+1
X
X
X
q
(Î², Y )
.
âˆ’4
log |1âˆ’Î±Î²,W q l |âˆ’4
log 1âˆ’
(4.16)
4Ï€(w, Y )B2
(w,
Y
)
Î±
Î²,W
âŠ¥
l=0
l=0
Î²âˆˆ[JLâˆ— âˆ©(Âµ+L)]/J
Î² 2 =2m

When 2Âµ = 0 in âˆ†L , so that pD Âµ and âˆ’pD Âµ is the same coset, the divisor Z(m, Âµ) contains
each Î»âŠ¥ with multiplicity 2, and therefore the sum in (4.16) describes the remaining terms
also in this case. Moreover, the set of lifts of the set of classes Î² âˆˆ pD Âµ + D with Î² 2 = 2m
is the product over these Î²s of the sets {Î½Î² âˆˆ JLâŠ¥âˆ— /I| Î½Î² + J/I = Î²}, and sending a Weyl
chamber W containing Ï‰J,I in its closure to the element {Î½Î²,W }Î² of the latter set produces
a bijective map. Hence if Y lies in the closure of some Weyl chamber W then we can
(Î½Î²,W ,Y )
write the argument of B2 in (4.16) as 0 < (w,Y
< 1, and we can also substitute it
)
inside the corresponding Bernoulli polynomial B2 (x) = x2 âˆ’ x + 16 . Consider now a wall
between two such Weyl chambers, say the one corresponding to some Î» âˆˆ JLâŠ¥âˆ— âˆ© (Âµ + L)
with Î»2 = 2m, and let W be the one in which (Î» + IR , W ) < 0, while WÌƒ is the second
one, with (Î» + IR , WÌƒ ) > 0. Then the vector Î½Î²,W is the same on W and WÌƒ for every
Î² 6= Î» + J and all the associated terms in (4.16) are smooth also near that wall, while we
(Î½
)
WÌƒ ,Y )
have Î½Î»+J,WÌƒ = Î»+I and Î½Î»+J,W = Î»+w +I. It follows that if we denote Î»+J,
= (Î»+I,Y
(w,Y )
(w,Y )

by x and set Î± = e (Î» + I, ZL ) then on WÌƒ the summand associated with Î² involves B2 (x)
and the parameter Î±Î»+J,WÌƒ = Î± in the two sums over l, while on W we have an argument

)
=
x
+
1
in
B
as
well
as
Î±
=
e
(Î»
+
w
+
I,
Z
)
= qÎ± in the sums.
of (Î»+w+I,Y
2
Î»+J,W
L
(w,Y )
Therefore the summand associated with l on W in the first sum in (4.16) with Î² = Î» + J
is the one associated with l + 1 on WÌƒ , while the summand corresponding to l in the second
sum on WÌƒ there is the one corresponding to l + 1 on W . Since the formula for B2 shows
that B2 (x + 1) = B2 (x) + 2x, we deduce that when we move from W to WÌƒ , the expression
from (4.16) collects an additional value of
âˆ’8Ï€(w, Y ) Â·

(Î» + I, Y )
1
= âˆ’8Ï€(Î» + I, Y ) âˆ’ 4 log |Î±|,
âˆ’ 4 log |1 âˆ’ Î±| + 4 log 1 âˆ’
(w, Y )
Î±

which vanishes by our value of Î±.
We may therefore make one choice of a Weyl chamber W , with the corresponding vector
Î½Î²,W for each Î², and what
 we proved shows that replacing B2 by B2 , (Î², Y ) by (Î½Î²,W , Y ),
and Î±Î²,W by e (Î½Î²,W , ZL ) in (4.16) would give us the correct value for Y , regardless of the
Weyl chamber near Ï‰J,I in which Y lies, and the same applies for the value arising from
YÏƒ . But for every such Î² we have Î½Î²,W âˆˆ JLâŠ¥âˆ— /I, so that we can replace Y by YÎºâŠ¥J like with
w in (4.15) as well as YÏƒ by YÏƒ,ÎºâŠ¥J , and we consider the difference between the expressions
with Y and with YÏƒ . Recalling the formula for B2 , this difference is
"
#
(w, YÏƒ,ÎºâŠ¥J ) 2(Î½Î²,W , YÏƒ,ÎºâŠ¥J )(Î½Î²,W , YÎºâŠ¥ ) + (Î½Î²,W , YÎºâŠ¥ )2 (Î½Î²,W , YÏƒ,ÎºâŠ¥J )2 (w, YÎºâŠ¥J )
âˆ’
(w, YÎºâŠ¥J )
2(w, YÏƒ,ÎºâŠ¥J )
2(w, YÏƒ,ÎºâŠ¥J )2

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS
(w,Y

41

)

plus the linear form âˆ’(Î½Î²,W , YÎºâŠ¥ ) + 6ÎºâŠ¥ evaluated on YÎºâŠ¥ âˆˆ M which is smooth and
bounded as before. Moreover, as each argument of B2 in the expression with YÏƒ is the
quotient of two linear forms on linear forms on ÏƒR âˆ© ÎºâŠ¥
J with the denominator never vanishing, this argument is bounded and hence so is its value under B2 . As the remaining
part of the smooth form of (4.16) is precisely âˆ’2 times the logarithm of the square of the
Îµ,k
absolute value of a holomorphic function that defines Z(m, Âµ) on DÎ¥ and on DÎ,Ïƒ
, this
proves the desired expression. We have also obtained that the difference between the first
terms of (4.10) and (4.14) is a bounded multiple of (w, YÏƒ,ÎºâŠ¥J ) plus a smooth function, which
Îµ,k
establishes the bound on that difference on DÎ,Ïƒ
because the latter pairing is a bounded
multiple of Îµt on that space. This completes the proof of the proposition.

We would like to view the function Î¦Lm,Âµ in the setting of [BBK]. As this paper concerns
smooth varieties, we shall consider smooth toroidal compactifications. The fact that XL
itself may be not smooth can be dealt with by taking covers as in Remark 3.26. For
smoothness at the boundary, we take a refinement as in Remark 2.15, and the resulting
variety XLtor is then smooth up to finite quotient singularities from Î“L , with the toroidal
boundary being a divisor with normal crossings. In this case our main result about Î¦Lm,Âµ ,
namely Theorem 4.13 below, can also be described using terminology from [BBK]â€”see
Remark 4.14 below.
Indeed, there are some simplifications when a fan Ïƒ âˆˆ Î£(Î) is smooth in the sense of
Definition 2.3. As the vectors Ï‰j , 1 â‰¤ j â‰¤ d generate over Z the primitive sublattice
K âˆ© RÏƒ of K, we can take elements Îºi âˆˆ K âˆ— with 1 â‰¤ i â‰¤ d such that (Îºi , Ï‰j ) is the
Kronecker Î´-symbol Î´ij , and such that the space Îº âŠ† KR that they span contains negative
norm vectors. Note that we cannot always take such a dual Z-basis inside RÏƒ, which is why
Îº can be a different rational subspace of KR . We consider ÎºâŠ¥ âŠ† KR and the projections as
before, and then in our decomposition of Z âˆˆ TK (C) as ZÏƒ + ZÎºâŠ¥ we have
(4.17)

ZÎº âŠ¥ âˆˆ

âŠ¥
[ÎºâŠ¥
C /(Îº

âˆ© K)] and ZÏƒ =

d
X
j=1

cj Ï‰j âˆˆ [CÏƒ/(Ïƒ âˆ© K)]

with uniquely defined cj âˆˆ C/Z for 1 â‰¤ j â‰¤ d, and we write each such cj as aj + ibj with
aj âˆˆ R/Z and bj âˆˆ R. The smoothness condition is required for the vectors {Ï‰j }dj=1 to
span [CÏƒ/(Ïƒ âˆ© K)] with free coefficients from C/Z, without additional quotients. Similarly,
assume that I âŠ† J âŠ† ILâŠ¥ with D from (3.9) and Î¥ as before, and take some basis (z, w)
for J with z âˆˆ I as well as a basis (Î¶, Ï…) for some unimodular complement JËœ for J in K âˆ—
that is dual to (z, w). Then if Ïƒ contains the ray Ï = R+ Ï‰J,I = â„¦(Î¥) âˆª {0}, or when Ïƒ = Ï
and we work in DÎ¥ , then the dual basis (Î¶, Ï…) produces, as in [K3], the coordinates
Z 2 +(Î¶+Ï„ Ï…)2 
(4.18)
ZL = Î¶ + Ï„ Ï… + Z0 âˆ’ Î·w + Î·Ï„ âˆ’ 0 2
z

for ZL âˆˆ P+ that lies in the image of the section associated with z, where Ï„ âˆˆ H is the
coordinate from (3.14), Z0 = X0 + iY0 âˆˆ DC , and Î· = s + it âˆˆ C is another coordinate,
Y2
which satisfies t > 2y0 for â„‘ZL to be of negative norm (this also gives a more explicit,
though less canonical, description of Proposition 3.12). The cyclic group UZ (Î¥) operates

42

JAN H. BRUINIER AND SHAUL ZEMEL

as translations of the real part of Ïƒ by integers, and we denote, following [K3], the resulting
coordinate e(Î·) on UZ (Î¥)\ Gr(L) by q2 . Considering the imaginary part Y of Z or of ZL , if
P
Z is presented as in (4.17) then YÏƒ can be written uniquely as dj=1 bj Ï‰j , while for ZL as in
(4.18) we can write Y as yÏ… + Y0 âˆ’ tw, or equivalently yÏ… + Y0 + tÏ‰J,I , with Y0 = â„‘Z0 âˆˆ DR .
We recall from (2.1) that the function zÎºj on DÎ,Ïƒ âŠ† XK,Ïƒ is just e(cj ) for ZL as in (4.17),
and from Lemma 3.18 that q2 = e(Î·) is the local defining equation zÎ½Î¥ for the complement
of UZ (Î¥)\ Gr(L) in DÎ¥ , and we deduce that
(4.19)

bj = â„‘cj =

1
1
log
for 1 â‰¤ j â‰¤ d,
2Ï€
|zÎºj |

and t = â„‘Î· =

1
1
log
.
2Ï€
|q2 |

We remark again that if Ï â‰¤ Ïƒ for Ïƒ 6= Ï, with Ï‰J,I = Ï‰k for 1 â‰¤ k â‰¤ d, then the two
descriptions from (4.19) are related via the fact that t âˆ’ bk is a linear combination of
{bj }j6=k , so that q2 = zÎ½Î¥ is zÎºk times a toric function that is defined and does not vanish
on the boundary of DÎ¥ .
We can now state and prove the relation to [BBK] in the smooth case.
Corollary 4.9. If XLtor is smooth then the function Î¦Lm,Âµ is pre-log along Z(m, Âµ) and
along the boundary divisor XLtor \ XL in the sense of Definition 1.5 of [BBK], and has a
component that is pre-log-log along the boundary.
Proof. Recalling that XLtor is covered by the images of the sets of the form DÎ,Ïƒ or DÎ¥ ,
it suffices to consider the behavior of Î¦Lm,Âµ on these sets. We use the description from
P
Propositions 4.7 and 4.8, in which we substitute the expression for YÏƒ as dj=1 bj Ï‰j into
(4.10), and apply (4.19) for the coordinates bj there as well as for the coordinate t in (4.14).
Îµ,0
Now, in the closure of DÎ,Ïƒ
the argument of Î¦K
m,pK Âµ in (4.10) lies in a compact subset of C
and is thus bounded, and |YÏƒ | is the square root of
(4.20)

|YÏƒ2 |

=

âˆ’YÏƒ2

=âˆ’

d X
d
X
i=1

d X
d
X
(Ï‰i , Ï‰j )
1
1
(Ï‰i , Ï‰j )bi bj =
log
log
,
2
4Ï€
|zÎºi |
|zÎºj |
j=1
i=1 j=1

with all the coefficients âˆ’(Ï‰i , Ï‰j ) being strictly positive. Noting that (4.20) reduces to
Pd
|Ï‰1 |2
2 1
2 1
when
d
=
1
and
is
bounded
by
a
multiple
of
log
2
j=1 log |zÎºj | in general, and
4Ï€
|zÎº1 |
that the smoothness of Ïƒ implies that the zÎºj s are adapted to the boundary divisor of
XK,Ïƒ , this gives the log-growth from Definition 1.4 of [BBK] (with M = 1) of the first
term in (4.10) as well as the log-log-growth from Definition 1.2 of that reference (with
M = 2) of the second term there, and the third term clearly has the log-growth along
Z(m, Âµ) (again with M = 1). The fact that the second term satisfies the condition to
be pre-log-log from Definition 1.3 there is now clear, and recalling that by appropriately
normalizing the defining function Ï† of Z(m, Âµ) we can replace Î¦K
m,pK Âµ by its smooth analog
K,W
Î¦m,pK Âµ associated with a Weyl chamber W in C, the conditions for pre-log in Definition
1.5 of that reference are seen to be satisfied by the first and third terms of that equation.
In addition, substituting the value of t from (4.19) into (4.14) immediately establishes
the required properties of Î¦Lm,Âµ along DÎ¥ , and the bounds from Proposition 4.8 on the

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

43

Îµ,k
difference between (4.10) and (4.14) on DÎ,Ïƒ
combine with this value of t to establish the
desired properties also on this set. This completes the proof of the corollary.


In fact, the proof of Corollary 4.9 establishes the linear logarithmic growth of Î¦Lm,Âµ and
the log-log-growth of the corresponding term also when XLtor is not smooth, but expressing
this in coordinates becomes more complicated.
For the next important property of Î¦Lm,Âµ we shall need the following technical lemma.
Lemma 4.10. Take 1 â‰¤ d âˆˆ N, d < Î± âˆˆ R, and Îµj > 0 for every 1 â‰¤ j â‰¤ d. We then have
Q
Z Îµ1
Z Îµd
Z Îµ1
Z Îµd
log log dj=1 rj Â· dr
dr
Â·Â·Â·
< âˆ and
< âˆ,
Â·Â·Â·
Qd
Qd
Î± Qd
Î± Qd
r
Â·
log
r
r
Â·
log
r
0
0
0
0
j
j
j
j
j=1
j=1
j=1
j=1
where dr is the standard Lebesgue measure on Rd .

Proof. The case d = 1 is verified by a simple evaluation of primitive functions. If d > 1
a change of variable involving replacing one variable by the product of all of them easily
transforms the integral to a combination of ones with d âˆ’ 1 variables. A simple induction
thus yields the desired result.

We can now prove the following result, which holds also in the non-smooth setting.
Îµ,0
Proposition 4.11. If n â‰¥ 2 then Î¦Lm,Âµ is locally integrable on any set of the form DÎ,Ïƒ
.
Îµ,k
In case n â‰¥ 3 it is also locally integrable on each DÎ¥ and on every DÎ,Ïƒ with k â‰¥ 1.

Proof. We recall from Section 4.1 of [Br1] that the invariant measure on Gr(L) presented as
in (3.11), as well as on its quotient modulo K, is a multiple of dXdY
. The local integrability
|Y 2 |n
L
of Î¦m,Âµ on the open subset K\ Gr(L) follows from the fact that there it is smooth up to
logarithmic singularities. In addition, since all the boundaries in question have measure 0,
the local integrability does not depend on the choice of the toroidal compactification, and
it therefore suffices to consider the case where each fan Î£(Î) is smooth as in Definition
2.3, where we can use the expressions from the proof of Corollary 4.9.
Îµ,0
Consider next a point in Î¾ âˆˆ DÎ,Ïƒ
for some non-trivial cone Ïƒ âˆˆ Î£(Î), which is therefore
not an external ray in C, and the argument preceding (4.8) shows that it suffices to consider
Î¾ âˆˆ O(Ïƒ). Our choice of the space Îº as above allows us to take a neighborhood of Î¾ which
âŠ¥
is the product of a neighborhood of the projection Î¾ÎºâŠ¥ in ÎºâŠ¥
C /(Îº âˆ© K) and a neighborhood
of Î¾Ïƒ in the completion of CÏƒ/(Ïƒ âˆ© K), with both having compact closures in the respective
spaces. The smoothness of Ïƒ allows one to use the coordinates from (4.17), and the relation
between cj = aj + ibj and zÎºj , which is visible in (4.19), implies that each factor daj dbj
in dXdY becomes

1
4Ï€ 2

times

dzÎºj dzÎºj
.
âˆ’2i|zÎºj |2

The coordinates arising from Î¾ÎºâŠ¥ can be expressed

similarly, thus giving a smooth bounded (2n âˆ’ 2d)-form on our neighborhood, because the
Îµ,0
coordinates that do not come from Ïƒ do not vanish on DÎ,Ïƒ
. We can also assume that
the neighborhood of Î¾Ïƒ , on which all the zÎºj s vanish, is a product of balls, one for each
coordinate, and when we consider
jth multiplier in polar coordinates, we see that the
Qd the
drj dÎ¸j
1
2d-form daj dbj is (4Ï€2 )d times j=1 rj , with 0 â‰¤ Î¸j < 2Ï€ and 0 < rj < Îµj for every j. As

44

JAN H. BRUINIER AND SHAUL ZEMEL

for the denominator |Y 2 |n , the proof of Proposition 4.7 allows us to write it as |YÏƒ2 |n times
a function that is smooth and bounded on our neighborhood of Î¾, and since (4.20) shows
that the latter expression is quadratic in log |zÎº1 | = log r1j with 1 â‰¤ j â‰¤ d and positive
j
wherever each one of them is positive, it is comparable with any other quadratic form with
Pd
1 2
, in these expressions. Altogether, we have written
these properties, such as
j=1 log rj
Q
Q
dr
our invariant measure on neighborhoods of points in O(Ïƒ) as dj=1 rjj times logâˆ’2n dj=1 r1j
Q
on dj=1[0, Îµj ), times a smooth and bounded (2n âˆ’ d)-form with no singularities.
We therefore need to establish the integrability of Î¦Lm,Âµ in this neighborhood with respect
to this measure, and we express it via (4.10). For the smooth part of this function, as well
as the term with log |Ï†|, it suffices to consider the integrability of the measure itself, which
now follows from the case of the first integral with Î± = 2n â‰¥ 2d > d in Lemma 4.10. The
integral of the second term of (4.10) is just the second integral in Lemma 4.10 with Î± = 2n,
eK
while in the first term, the fact that the argument of Î¦
m,pK Âµ lies in a compact subset of C
Îµ,0
when ZL âˆˆ DÎ,Ïƒ yields the boundedness of that multiplier. Since the multiplier |YÏƒ | simply
replaces the power 2n in the denominator by 2n âˆ’ 1, and we have 2n âˆ’ 1 â‰¥ d + n âˆ’ 1 > d
because n â‰¥ 2, Lemma 4.10 establishes the integrability of this term as well. This proves
the first assertion.
Îµ,k
For the second one we take a boundary point Î¾ of either DÎ¥ or DÎ,Ïƒ
for a cone Ïƒ âˆˆ Î£(Î)
with Ï = R+ Ï‰J,I = â„¦(Î¥) âˆª {0} â‰¤ Ïƒ and Ïƒ 6= Ï, where in the latter case we can again
assume that Î¾ âˆˆ O(Ïƒ). Recalling the coordinate Î· = s + it from (4.18), the same argument
shows that on a similar product neighborhood, the part dXdY of the invariant measure
Q
dr
is again dj=1 rjj times a smooth (2n âˆ’ d)-form with no singularities, where r = rk = |q2 |
and the other rj s come from the other rays of Ïƒ in case Ïƒ 6= Ï. We now express |Y 2 |
as in (4.15), and the proof of Proposition 4.8 shows that if Ïƒ = Ï then it is a smooth
and bounded function times log 1r while when Ïƒ 6= Ï it can be written as a smooth and
bounded function times t(w, YÏƒ,ÎºâŠ¥J ). As the second multiplier is a linear form with positive
P
coefficients in log r1j with j 6= k, it is a smooth function times the linear form j6=k log r1j ,
Q
dr
and our invariant measure here is the product of logâˆ’n 1r Â· drr on [0, Îµ) for Îµ = Îµk , of dj=1 rjj
Q
Q
times logâˆ’n j6=k r1j on j6=k [0, Îµj ) when Ïƒ 6= Ï, and of a smooth, bounded, non-singular
(2n âˆ’ d)-form.
For the function Î¦Lm,Âµ we now use the expression from (4.14), and recall from Proposition
4.8 that while when Ïƒ 6= Ï we still need to use (4.10), the difference is bounded by a constant
times t and can thus be considered like the first term in (4.14). Since the only parameter
appearing in (4.14) is t, or equivalently log 1r via (4.19), the integrability of the (d âˆ’1)-form
arising from rj with j 6= k follows from Lemma 4.10 because n â‰¥ d and the dimension here
is d âˆ’ 1. The integrability of the smooth part of Î¦Lm,Âµ and of log |Ï†|, follow from the case
d = 1 and Î± = n â‰¥ 2 in the first integral in Lemma 4.10, and that of the second term from
the second integral with d = 1 and Î± = n there. As for the first term we obtain the first
integral with d = 1 and Î± = n âˆ’ 1, and that lemma is again applicable since we assume
that n â‰¥ 3, the second assertion is also established. This proves the proposition.


SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

45

Note that Proposition 4.7 becomes simpler when d = 1. Then Ïƒ âˆˆ Î£(Î) is the ray
Ï = R+ Ï‰ with Ï‰ primitive in K âˆ© C, the boundary points lie in O(Ï) âŠ† XK,Ï, and if
Îº âˆˆ K âˆ— satisfies (Îº, Ï‰) = 1 then Proposition 2.5 implies that the function zÎº is the defining
equation for O(Ï) in XK,Ï. Then the vector YÏƒ appearing in (4.10) is just bÏ‰ with b = b1 ,
Îµ,0
so that |YÏƒ | = b|Ï‰|, and it is clear that DÎ,Ï
= DÎ,Ï because Ï has no faces that are rays
lying on the boundary of C. This reduces (4.10) to
 
Ï‰
b|Ï‰| K
2
âˆš Î¦m,pK Âµ
(4.21)
âˆ’ 2b+
m,Âµ (0, 0) log b âˆ’ 2 log |Ï†|
|Ï‰|
2

up to an additive constant, and we also recall that O(Ïƒ) and the subset O(Î¥) âŠ† DÎ¥ from
Lemma 3.18 map onto the generic part of the divisors BI,Ï‰ and BJ from (3.18) respectively.
Combining these observations with (4.19), we make the following definition.

Definition 4.12. For a rank 1 primitive isotropic sublattice I of L, with the associated
lattice K from (3.7) and cone C as in (3.11), and a primitive element Ï‰ âˆˆ K âˆ© C, we define
the multiplicity
 
|Ï‰| K
Ï‰
multI,Ï‰ (m, Âµ) = âˆš Î¦m,pK Âµ
.
|Ï‰|
8 2Ï€
Given a rank 2 primitive isotropic sublattice J in L, set D to be as in (3.9), and we set
1 D
multJ (m, Âµ) =
Î¦
.
8Ï€ m,pD Âµ
In fact, Proposition 4.15 below will show that the multiplicities multJ (m, Âµ) from Definition 4.12 are always rational numbers. On the other hand, the multiplicities multI,Ï‰ (m, Âµ)
are real numbers, about the rationality of which we have no information in general.
tor
Consider again the variety XLtor = X{Î£(Î)}
from Theorem 3.25, which is defined by a
Î
collection of fans {Î£(Î)}Î that satisfies the admissibility conditions from Corollary 3.21
and Lemma 3.24 with respect to Î“L . Using Definition 4.12, the required extension of
Theorem 4.3 can now be established.
2

Theorem 4.13. For every pair (m, Âµ) with Âµ âˆˆ âˆ†L and 0 < m âˆˆ Âµ2 + Z we define, as in
(1.1), the divisor Z tor (m, Âµ) âˆˆ Div(XLtor ) âŠ— R by
X X
X
multI,Ï‰ (m, Âµ) Â· BI,Ï‰ .
multJ (m, Âµ) Â· BJ +
Z tor (m, Âµ) = Z(m, Âµ) +
JâŠ†L
ÂµâŠ¥JLâˆ— /J

IâŠ†L R+ Ï‰
ÂµâŠ¥ILâˆ— /I

Here J (resp. I) runs over a set of representatives of rank 2 (resp. rank 1) primitive
isotropic sublattices of L modulo Î“L and given I, the index R+ Ï‰ runs over representatives
for the inner rays in Î£(Î) with Î = ÎI , and the coefficients multJ (m, Âµ) and multI,Ï‰ (m, Âµ)
are the ones from Definition 4.12. Assuming that n is larger than the Witt rank of L,
the function 12 Î¦Lm,Âµ is integrable on XLtor , grows logarithmically along the divisor Z tor (m, Âµ)
with a term with log-log-growth along the boundary, and satisfies the ddc -equation (1.2).
Proof. First, as the invariant measure is smooth on XL and our function has only the
logarithmic singularities along Z(m, Âµ), it is locally integrable on XL , which also covers

46

JAN H. BRUINIER AND SHAUL ZEMEL

the case where L has Witt rank 0 since then there is no boundary. For the local integrability
at boundary points, we recall that for each such point one of the maps Î¹Î and Î¹Î¥ appearing
in (3.18) is local homeomorphism, so that it suffices to consider local integrability on the
sets DÎ,Ïƒ or DÎ¥ . Now, if L has Witt rank 1 then there are no rays of the form R+ Ï‰J,I ,
Îµ,0
so that DÎ,Ïƒ
= DÎ,Ïƒ for every Ïƒ âˆˆ Ïƒ(Î), and as the boundary of XLtor is then covered by
such sets, the assumption that n â‰¥ 2 yields the desired local integrability by Proposition
4.11. On the other hand, when L has Witt rank 2 then n â‰¥ 3, and we also have local
integrability on the remaining covering sets DÎ¥ by the same proposition. This proves the
local integrability of 21 Î¦Lm,Âµ on XLtor , and the global one follows from compactness.
Now, the assertion about the growth of 12 Î¦Lm,Âµ was established in Corollary 4.9, and the
integrability just proved allows us to substitute 12 Î¦Lm,Âµ inside current equations. Moreover,
the fact that the logarithmic growth is linear, namely we had M = 1 in the proof of
Corollary 4.9 in the notation of Definition 1.4 of [BBK], implies that it satisfies the desired
ddc -equation from (1.2) for some divisor on XLtor . Since the required properties of Î·(m, Âµ)
are also clear, all that remains it to determine this divisor to be Z tor (m, Âµ).
Consider first a divisor of the form BI,Ï‰ for some primitive vector Ï‰ âˆˆ K âˆ© C, which
exists only if n â‰¥ 2 in our assumption, and for which we denote Ï = R+ Ï‰ âˆˆ Î£(Î). Then
the case d = 1 of Proposition 4.7 discussed above evaluates Î¦Lm,Âµ on DÎ,Ï as (4.21) plus a
smooth function. Substituting (4.19), dividing by 2, and recalling the behavior of âˆ’ log of
the square of the absolute value of a coordinate under ddc , establishes the equality
ddc [ 12 Î¦Lm,Âµ ] + Î´ZI,Ï‰ (m,Âµ) = [Î·I,Ï‰ (m, Âµ)]
as currents on Ac2nâˆ’2 (DÎ,Ï ), where Î·I,Ï‰ (m, Âµ) is the sum of a smooth 2-form on DÎ,Ï and a
multiple of ddc log log |z1Îº | , and
 
|Ï‰| K
Ï‰
(4.22)
ZI,Ï‰ (m, Âµ) = Z(m, Âµ) + âˆš Î¦m,pK Âµ
Â· O(Ï),
|Ï‰|
8 2Ï€

where O(Ï) is the pullback of BI,Ï‰ to DÎ,Ï âŠ† DÎ via Î¹Î â—¦ Ï€Î .
We now turn to the divisors BJ under the assumption that n â‰¥ 3, where Proposition
4.8 describes Î¦Lm,Âµ on DÎ¥ via (4.14) up to a smooth function. We again substitute (4.19)
and divide by 2, and we recall from Proposition 3.19 that the divisor O(Î¥) inside DÎ¥ is
characterized by the vanishing of q2 . The same argument now produces the equality
ddc [ 21 Î¦Lm,Âµ ] + Î´ZJ (m,Âµ) = [Î·J (m, Âµ)]

on Ac2nâˆ’2 (DÎ¥ ), in which Î·J (m, Âµ) is the sum of a smooth 2-form on DÎ¥ and a multiple of
ddc log log |q12 | , and
Î¦D
m,pD Âµ
Â· O(Î¥),
8Ï€
with O(Î¥) being the pullback of BJ to DÎ¥ under Î¹Î¥ â—¦ Ï€Î¥
Now, the union of XL and the generic parts of the toroidal divisors has a complement in
tor
XL whose complex codimension there is 2, and therefore the restriction map from divisors
on XLtor to divisors on this open subvariety is surjective. It follows that the divisor on XLtor

(4.23)

ZJ (m, Âµ) = Z(m, Âµ) +

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

47

which appears in the global ddc -equation for 12 Î¦Lm,Âµ has to have the pullback from (4.22) to
DÎ,R+ Ï‰ for every I and Ï‰, as well as the pullback given in (4.23) to DÎ¥ for every J. Since
Definition 4.12 implies that the only divisor having this property is Z tor (m, Âµ), we have also
established (1.2) with the correct divisor. This completes the proof of the theorem.

Note that in the case n = 1 in Theorem 4.13 the assumption about the Witt rank of L
implies that there are no cusps, but this case is therefore covered in Theorem 4.3.
Remark 4.14. When XLtor is smooth, the result of Theorem 4.13 means that 12 Î¦Lm,Âµ is an
integrable logarithmic Green function for Z tor (m, Âµ) on XLtor with additional log-log-growth
along the boundary divisor in the sense of Definition 1.12 of [BBK].
4.4. Explicit Formulas for the Multiplicities. The multiplicities multJ (m, Âµ) and
multI,Ï‰ (m, Âµ) are given in Definition 4.12 as regularized theta lifts. However, it can be
useful to have more explicit expressions for the values of these multiplicities.
We begin by assuming that n â‰¥ 2 and considering the divisor BJ that is associated
via (3.18) with the rank 2 isotropic sublattice J of L, where D is the positive definite
lattice from (3.9) as usual. Note that Î“L preserves the condition Âµ âˆˆ JLâŠ¥âˆ— /JLâŠ¥ âŠ† âˆ†L (by
definition) and the isomorphism class of D, so that the expressions below are independent
of the choice of the lattice J that represents BJ . Specializing (4.5) to the definite lattice
D, and recalling the operator â†‘LD from above, we obtain
(4.24)
X 2
X
2
Î˜D (Ï„ ) =
q Î² /2 eÎ²+D âˆˆ M n2 âˆ’1 (ÏD ) and â†‘LD (Î˜D )(Ï„ ) =
q Î² /2 eÎ²+L âˆˆ M n2 âˆ’1 (ÏL ).
Î²âˆˆD âˆ—

We set Ïƒ1 (n) =

P

âŠ¥ /J
Î²âˆˆJL
âˆ—

d|n

d for 1 â‰¤ n âˆˆ N, denote by
E2âˆ— (Ï„ )

âˆ
X
3
3
= E2 (Ï„ ) âˆ’
= 1 âˆ’ 24
Ïƒ1 (n)q n âˆ’
Ï€y
Ï€y
n=1

the nearly holomorphic Eisenstein series of weight 2 (with E2 being the weight 2 holomorphic quasi-modular Eisenstein series), and introduce the notation CT(G) for the constant
term of a Laurent series G in the variable q. Recalling that the arrow operators commute
with differential operators and are dual with respect to the pairings via
X
X
bÎ´ eÎ´ ,
aÎ± eÎ± and b =
(4.25)
ha, â†“LD biD = hâ†‘LD a, biL
for
a=
Î±âˆˆâˆ†D

Î´âˆˆâˆ†L

and observing that when n = 2 and L has Witt rank 2 the lattice D is trivial and Î˜D
from (4.24) is just the constant function 1, Theorem 4.4.1 of [BHY] evaluates the theta lift
Î¦D
m,pD Âµ as follows.
Proposition 4.15. The number Î¦D
6 JLâŠ¥âˆ— /JLâŠ¥ , and if Âµ âˆˆ JLâŠ¥âˆ— /JLâŠ¥
m,pD Âµ vanishes when Âµ âˆˆ
then we have
ï£±


ï£² 8Ï€ CT q d â†‘L (Î˜ ), F +
nâ‰¥3
D
m,Âµ L
nâˆ’2
dq D
Î¦D

m,pD Âµ =
ï£³ Ï€ CT E hâ†‘L (1), F + i
n = 2.
2 D
m,Âµ L
3

48

JAN H. BRUINIER AND SHAUL ZEMEL

We remark that the value of Î¦D
m,pD Âµ for n â‰¥ 3 in Proposition 4.15 also equals, by
modifying the proof of Theorem 9.2 of [Bo1] as in Proposition 4.19 below, to the expression
 Ï€

Ï€
+
CT E2 Â· hâ†‘LD (Î˜D ), Fm,Âµ
iL âˆ’ E2âˆ— â†‘LD (Î˜D ), Î¾1âˆ’ n2 Fm,Âµ Pet ,
(4.26)
3
3
where the latter pairing is the Petersson inner product of the nearly holomorphic modular
form E2âˆ— â†‘LD (Î˜D ) and the cusp form Î¾1âˆ’ n2 Fm,Âµ , both of weight 1 + n2 and representation
ÏL . This gives back the expression for n = 2 in Proposition 4.15, since as in the proof of
Theorem 4.4.1 of [BHY], the Petersson inner product there vanishes when Î˜D reduces to
d
a constant. In addition, since q dq
â†‘LD (Î˜D ) is holomorphic in q with integral coefficients
1
Î¦D
and without a constant term, the value of the multiplicity multJ (m, Âµ) = 8Ï€
m,pD Âµ from
L
Definition 4.12, with n â‰¥ 3, is rational. More explicitly, the symmetry of â†‘D (Î˜D ) and the
+
simple principal part of Fm,Âµ
reduce its value to
2m
{Î² âˆˆ pD Âµ| Î² 2 = 2m} .
nâˆ’2
This is not necessarily true for n = 2, where the latter expression vanishes by the triviality
of D, since when L has Witt rank 2 multiples of â†‘LD (1) are ÏL -invariant vectors by which
+
modifying Fm,Âµ
can affect the value from Proposition 4.15.

Ï‰
We now turn to the evaluation of Î¦K
m,pK Âµ |Ï‰| for a primitive vector Ï‰ âˆˆ K âˆ©C, for which
Ï‰ 2 = âˆ’2NÏ‰ as usual, and we write N for NÏ‰ for short. Recall that this expression is a
theta lift like in (4.6), where the theta function Î˜K is defined as in (4.5) with the negative
definite subspace of KR that is spanned by Ï‰. Denote the orthogonal complement of Ï‰ in
âŠ¥
K by Ï‰K
and in KR by just Ï‰ âŠ¥ , and define the ÏK âŠ— ÏN -valued function
 Î»2 
X
X
(4.27)
Î˜K,Ï‰ (Ï„ ) =
e Ï„ Ï‰2âŠ¥ eÎ»+K âŠ— er .
râˆˆZ/2N Z

Î»âˆˆK âˆ— /ZÏ‰
(Î»,Ï‰)â‰¡âˆ’r (mod 2N )

Let Î›N be the 1-dimensional lattice spanned by a vector of norm 2N, so that its discriminant âˆ†N = âˆ†Î›N is cyclic of order 2N, and we denote by ÏN the Weil representation ÏÎ›N
and by Î˜N the theta function Î˜Î›N âˆˆ M 1 (ÏN ), which is defined by
2

âˆ
X 2
X  X
l /4N
l2 /2N
er .
q
el+2N Z =
q
(4.28)
Î˜Î›N (Ï„ ) =
l=âˆ’âˆ

râˆˆZ/2N Z

lâ‰¡r

(4N )

If Î˜N is the complex conjugate of the function from (4.28), and hÂ·, Â·iN is the pairing
associated with the lattice Î›N , then we obtain the following decomposition.
Lemma 4.16. We have the equality
 âˆš
Ï‰
Î˜K Ï„, |Ï‰|
= y Î˜K,Ï‰ (Ï„ ), Î˜N (Ï„ )

N

.

Proof. We partition the elements Î» âˆˆ K âˆ— in the sum from (4.5) according to their pairing
with Ï‰ âˆˆ K, and observe that if an element Î» âˆˆ K âˆ— satisfies (Î», Ï‰) = âˆ’l then the projection
l2
lÏ‰
and hence Î»2RÏ‰ = âˆ’ 4N
. Note that if two elements of K âˆ— lie in the same coset of
Î»RÏ‰ is 2N

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

49

âŠ¥
âˆ†K and have the same pairing with Ï‰ then their difference lies in Ï‰K
, and that for every
Î± âˆˆ âˆ†K and two integers h and l we have


Î» âˆˆ K + Î± (Î», Ï‰) = âˆ’l + hÏ‰ = Î» âˆˆ K + Î± (Î», Ï‰) = âˆ’l âˆ’ 2hN .

Moreover, since hÏ‰ âˆˆ K âˆ© RÏ‰ this operation of adding hÏ‰ does not affect the respective

Î»2
Ï‰
expression Ï‰2âŠ¥ . Substituting this into the definition of Î˜K Ï„, |Ï‰|
in the equivalent of (4.5),
we find that
 Î»2 
X
X
 âˆš X

Ï‰
l2
Î˜K Ï„, |Ï‰| = y
e âˆ’ 4N Ï„
e Ï„ Ï‰2âŠ¥ eÎ»+K ,
râˆˆZ/2N Z lâˆˆr+2N Z

Î»âˆˆK âˆ— /ZÏ‰
(Î»,Ï‰)â‰¡âˆ’r (mod 2N )

which is easily seen to be the desired expression. This proves the lemma.



It is good to know that the theta function from (4.27) also has the appropriate modularity
property.
Lemma 4.17. The function Î˜K,Ï‰ from (4.27) is modular of weight
ÏK âŠ— ÏN with respect to the full group Mp2 (Z).

nâˆ’1
2

and representation

We omit the details of the proof of Lemma 4.17, and just remark that if K factors as
âŠ• ZÏ‰ then a rather straightforward decomposition yields the desired result, and in
general we have to use an operator like â†‘K
âŠ¥ âŠ•ZÏ‰ , tensored with Î›N .
Ï‰K

Ï‰
are evaluated, in a slightly different context, in TheoExpressions like Î¦K
m,pK Âµ |Ï‰|
rem 10.6
of [Bo1], which uses the incorrect Lemma 9.5 of that reference. Explicit pre-images
âˆš
N
of âˆ’ 8Ï€ Î˜N under the operator Î¾3/2 are constructed in Theorem 4.3 of [BS] as follows.
âŠ¥
Ï‰K

Theorem 4.18. For every natural N thereâˆš exists a harmonic Maass form GN of weight
3
and representation ÏN , with Î¾3/2 GN = âˆ’ 8Ï€N Î˜N , and such that its holomorphic part G+
N
2
has rational Fourier coefficients with bounded denominators.
!
It is clear that GN is unique only up to adding elements of M3/2
(ÏN ) with rational Fourier
coefficients, but
 our results below will be independent of the choice of GN . The evaluation
Ï‰
of Î¦K
m,pK Âµ |Ï‰| can now be carried out as follows.

Ï‰
Proposition 4.19. The value of Î¦K
m,pK Âµ |Ï‰| is


reg
8Ï€
8Ï€
+
N
N
n
âˆ’ âˆš CT hâ†‘LâŠ•Î›
â†‘LâŠ•Î›
KâŠ•Î›N (Î˜K,Ï‰ ), GN iN , Fm,Âµ L + âˆš
KâŠ•Î›N (Î˜K,Ï‰ ), GN N , Î¾1âˆ’ 2 Fm,Âµ Pet ,
N
N
where the second term is the regularized Petersson inner product of these modular forms.

Proof. We follow the proof of Theorem
 10.6 of [Bo1]. As in (4.6), we need the regularized
integral of Î˜K (Ï„, RÏ‰), â†“LK Fm,Âµ (Ï„ ) K dÂµ(Ï„ ), and Lemma 4.16 presents this theta function
âˆš
as y times the pairing Î˜K,Ï‰ (Ï„ ), Î˜N (Ï„ ) N of the holomorphic theta function Î˜K,Ï‰ and
the anti-holomorphic theta function Î˜N . Via (4.25) we can express this measure as
D
E


N
â†‘LK hÎ˜K,Ï‰ (Ï„ ), Î˜N (Ï„ )iN , Fm,Âµ (Ï„ ) L =
Î˜
(Ï„
)
,
Î˜
(Ï„
)
â†‘LâŠ•Î›
,
F
(Ï„
)
K,Ï‰
N
m,Âµ
KâŠ•Î›N
N
L

50

JAN H. BRUINIER AND SHAUL ZEMEL

times y âˆ’3/2 dxdy. Theorem 4.18 allows us to write the non-holomorphic multiplier Î˜N y âˆ’3/2
âˆš âˆ‚Ï„ GN , and if we assume for the moment that Fm,Âµ is holomorphic on H then the
as 16Ï€i
N
differential 2-form that we have in the integrand is the exact Mp2 (Z)-invariant form


E

8Ï€ D LâŠ•Î›N
â†‘KâŠ•Î›N Î˜K,Ï‰ (Ï„ ) , GN (Ï„ ) N , Fm,Âµ (Ï„ ) dÏ„ .
(4.29)
d âˆš
L
N
Now, the integral from (4.6) can be carried out over the fundamental domain

F = Ï„ = x + iy âˆˆ H |x| â‰¤ 21 , |Ï„ | â‰¥ 1

of Mp2 (Z), and in the regularization of this divergent integral, we evaluate the integral on
FR = {Ï„ âˆˆ F | y â‰¤ R} for large R, and take the limit R â†’ âˆ. We can thus apply Stokesâ€™
Theorem for the integral over FR , and the Mp2 (Z)-invariance of the 1-form appearing as
the argument of d on the right hand side of (4.29) implies that on the integrals on the
boundary parts of FR that are
 also part of the boundary of F cancel. All that remains
1 1
is the integral along âˆ’ 2 , 2 + iR oriented negatively, which produces the constant term
of the Fourier expansion of the differential form in question, at y = R. The part arising
âˆ’
l
from G+
N yields the first asserted term, and since the Fourier coefficients of GN multiply q
for negative l by decreasing functions of y, the contribution from this part vanishes at the
limit R â†’ âˆ.
However, as Fm,Âµ is not holomorphic, the formula from (4.29) has to be corrected by
subtracting the 2-form
E

16Ï€i D LâŠ•Î›N
âˆš
â†‘KâŠ•Î›N Î˜K,Ï‰ (Ï„ ) , GN (Ï„ ) N , âˆ‚Ï„ Fm,Âµ (Ï„ ) dxdy,
L
N
and the relation between Î¾1âˆ’ n2 and âˆ‚Ï„ allows us to write
i n
âˆ‚Ï„ Fm,Âµ = y 2 âˆ’1 Î¾1âˆ’ n2 Fm,Âµ .
2
Hence the additional term yields the asserted regularized Petersson inner product. This
completes the proof of the proposition.

5. Modularity of Heegner divisors

Here we consider some basic parts from the theory of Borcherds products, and show how
to modify them in order to prove our main result, Theorem 5.4, which is the modularity
of the appropriately modified divisors from Theorem 4.13 in the Chow group of XLtor .
Consider again the Grassmannian Gr(L) that is associated via (3.1) to the even lattice
L. Recall that the map from (3.3) describes the chosen component P + of the set P from
(3.2) as a CÃ— -bundle over Gr(L), and we define an automorphic form of weight m on Gr(L)
with respect to Î“L to be a function from P + to C that is Î“L -invariant and homogenous of
degree âˆ’m. Given an oriented sublattice I of rank 1 in L, one can identify Gr(L) with
the affine tube domain KR1 + iC from (3.11), and choosing a complement for ILâŠ¥âˆ— in Lâˆ—
maps this affine tube domain onto the linear one KR + iC âŠ† KC . Combining these maps
with the section from Gr(L) to P + , one identifies an automorphic form of weight m on
Gr(L) with a function on KR + iC âŠ† KC which transforms under Î“L with the mth power

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

51

of an appropriate factor of automorphy. In any case, we are interested here only in such
automorphic forms that are meromorphic.
An important class of meromorphic automorphic forms on XL is given by Borcherds
products, see Theorem 13.3 of [Bo1]. The result is as follows.
!
Theorem 5.1. Let F âˆˆ M1âˆ’n/2
(ÏL ) be given, with a Fourier expansion as in the holomorphic part of (4.3), and assume that c+ (Î´, l) âˆˆ Z if l < 0. Then there exists a meromorphic
automorphic form Î¨ on Gr(L) of weight c+ (0, 0)/2 and some multiplier system Ï‡ of finite
order with respect to Î“L , whose divisor of XL is given by
X
1 X
divXL (Î¨) =
c+ (Âµ, âˆ’m)Z(m, Âµ).
2 Âµâˆˆâˆ†
2
L

0<mâˆˆÂµ /2+Z

The proof of Theorem 5.1 is based on the fact that the theta lift of F , given in (4.6) with
Fm,Âµ replaced by F , is, up to an additive constant, 2 times the logarithm of the Petersson
metric of a meromorphic function Î¨ on Gr(L) with the asserted divisor, which is then
shown to be automorphic. By the theory of Bailyâ€“Borel, the power of Î¨ for which the
multiplier system Ï‡ becomes trivial is defined on the Bailyâ€“Borel compactification XLBB ,
and hence its pullback is defined also on XLtor . We can thus determine its divisor on XLtor .
Theorem 5.2. Assume that n â‰¥ 3 or that n = 2 and C[âˆ†L ] contains no ÏL -invariant
!
vectors, take F âˆˆ M1âˆ’
n (ÏL ) that satisfies the condition of Theorem 5.1, and let Î¨ be the
2
associated Borcherds product. If the character Ï‡ of Î¨ is trivial, then the divisor of Î¨ on
XLtor is given by
X
1 X
c+ (Âµ, âˆ’m)Z tor (m, Âµ).
divXLtor (Î¨) =
2 Âµâˆˆâˆ†
2
L

0<mâˆˆÂµ /2+Z

The difference between this divisor and the closure of divXL (Î¨) from Theorem 5.1 is


XX

1 X
+
N
CT E2 Â· hâ†‘LD (Î˜D ), F iL Â· BJ âˆ’
CT hâ†‘LâŠ•Î›
Â· BI,Ï‰ ,
(Î˜
),
G
i
,
F
K,Ï‰
KâŠ•Î›N
N N
L
24 J
I R Ï‰
+

where J, D, I, K, Ï‰, and N are as in Theorem 4.13, and the coefficients are rational.

Proof. Recalling that our assumptions on n and ÏL imply that the harmonic Maass form
of weight 1 âˆ’ n2 and representation ÏL with a given principal part is unique, we deduce that
if F âˆˆ H1âˆ’ n2 (ÏL ) has the Fourier expansion (4.3) and n â‰¥ 3 then
X
1 X
(5.1)
F =
c+ (Âµ, âˆ’m)Fm,Âµ .
2 Âµâˆˆâˆ†
2
L

0<mâˆˆ Âµ2 +Z

The linearity of the regularized theta integral (4.6) thus implies that the Petersson metric
of Î¨ is given by
X
1 X
c+ (Âµ, âˆ’m)Î¦Lm,Âµ .
âˆ’ log kÎ¨k2 =
2 Âµâˆˆâˆ†
2
L

0<mâˆˆ Âµ2 +Z

52

JAN H. BRUINIER AND SHAUL ZEMEL

Consequently, the divisor of F on XLtor is given by the corresponding linear combination of
the divisors Z tor (m, Âµ) of the Green functions. Hence the assertion about the divisor of Î¨
follows from Theorem 4.13.
The difference between the divisors on XLtor and on XL is the sum of the parts of the divisors Z tor (m, Âµ) that are supported on the boundary divisors. The multiplicity of each such
boundary divisor is the linear combination of the corresponding multiplicities multJ (m, Âµ)
or multI,Ï‰ (m, Âµ) from Definition 4.12, according to the coefficients from (5.1). But the
formulas for these multiplicities, given in (4.26) and in Proposition 4.19 respectively, are
linear in F , and we can thus just substitute F instead of Fm,Âµ there. But since F is weakly
holomorphic, we have F + = F and the terms involving Î¾1âˆ’ n2 F vanish, and we remain
with the asserted multiplicities. Finally, as the principal part of F determines F and has
rational Fourier coefficients, it is therefore invariant under Aut(C/Q), and therefore so is
F itself and all of its coefficients are rational (see [McG]). Since Theorem 4.18 provides the
same property for GN , and it is clear that E2 and the theta functions share this property, it
follows that the asserted multiplicities are rational as desired. This proves the theorem. 
When n â‰¥ 3 we could have
also written the multiplicity of BJ in Theorem 5.2 as

d
L
CT q dq â†‘D (Î˜D ), F L . We remark that the multiplicity of BI,Ï‰ does not depend
on the choice of the function GN from Theorem 4.18, since this function pairs with the
weakly holomorphic modular form hÎ˜K,Ï‰ , â†“LK (F )iK of weight 12 , and Proposition 3.5 of
[BFu] shows that this constant term can be evaluated only using Î¾3/2 GN . We also remark
that a bit of additional analysis shows that the results of Theorem 5.2 hold also without
the assumption on ÏL when n = 2, and even when n = 1, provided that F is taken to have
rational Fourier coefficients for the rationality of the multiplicities to remain valid.
Theorem 5.2 yields new proofs of some known results from the literature. First, for describing the behavior of Î¨ near a 0-dimensional cusp Î = ÎI , we express the corresponding
lift Î¦ from (4.6) as in Proposition 4.4, where the parts involving the functions V1+ n2 vanish

and all the terms of the form log 1 âˆ’ e (Î½, ZL ) give the logarithm of the expansion of Î¨
as a Borcherds product. The first term Î¦K , the theta lift of â†“LK (F ) with respect to the
lattice K, is a continuous piecewise
linear function of Y , which is given, in a Weyl chamber
âˆš
W associated with F , by 8 2Ï€ times the pairing of Y with a vector Ï âˆˆ KQ that is called
the Weyl vector associated
with L, I, F , and W . Hence the product expansion of Î¨ is

multiplied by e (Z, Ï) in the variable Z = X + iY in the linear tube domain KR + iC
as well as on the corresponding subset of the torus TK , and if Ï âˆˆ K âˆ— then this function
is just the toric function zÏ . The order of Î¨ along BI,Ï‰ for primitive Ï‰ âˆˆ K âˆ© C with
R+ Ï‰ âˆˆ Î£(Î) is thus the order of zÏ , so that Proposition 2.5 reproduces the corrected result
of Theorem 10.6 of [Bo1]. Similarly, by considering the order of Î¨ along BJ , Equation
(4.27) of [K3] shows that we have reproduced also the parts of Theorem 2.1 and Corollary
2.3 of that reference involving
Pâˆthe power of l the coordinate q2 defining this divisor. We
also remark that combining l=0 log |1 âˆ’ Î±q | from the proof of Proposition 4.8 with the
summands arising from Zw âˆ’ Î½ yields, by the Jacobi triple product identity, the logarithm
of the absolute value of the quotients Î¸/Î· of the translated classical theta function over the
Dedekind eta function appearing in the expansions from [K3].
1
nâˆ’2

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

53

We now recall Borcherdsâ€™ modularity criterion, see Theorem 3.1 of [Bo2]. The rationality
statement appearing here is a consequence of the main result of [McG].
Proposition 5.3. Let a(Âµ, m) for Âµ âˆˆ âˆ†L and 0 â‰¤ m âˆˆ
complex vector space Y , and let
X
X
a(Âµ, m) Â· q m eÂµ

Âµ2
2

+ Z be elements of some

Âµâˆˆâˆ†L 0â‰¤mâˆˆ Âµ2 +Z
2

be the resulting formal ÏL (T )-invariant power series with values in Y âŠ—C C[âˆ†L ]. Assume
that the coefficients a(Âµ, m) have the symmetry property that is required for this series to
be invariant under the action of the center of Mp2 (Z) with weight 2 âˆ’ k and representation
ÏL . Then this power series belongs to Y âŠ—C M2âˆ’k (ÏL ) if and only if its pairing
P with every
F âˆˆ Mk! (ÏL ) vanishes, that is, denoting the Fourier expansion by F (Ï„ ) = Î´,l c(Î´, l)q l eÎ´ ,
we have the equality
X X
c(Âµ, âˆ’l)a(Âµ, l) = 0 âˆˆ Y.
Âµâˆˆâˆ†L lâˆˆ Âµ2 +Z
2

In addition, having these relations only for those elements F âˆˆ Mk! (ÏL ) whose Fourier
coefficients are integral suffices for the series to be in Y âŠ—C M2âˆ’k (ÏL ).
Our second main result, Theorem 1.2 from the introduction, is now as follows.
Theorem 5.4. Assume that n is larger than the Witt rank of L, set Z tor (0, 0) to be any
divisor on XLtor that represents the line bundle of modular forms of weight âˆ’1/2, and write
[Z tor (m, Âµ)] for the image of Z tor (m, Âµ) in CH1 (XLtor ) âŠ— R for every pair (m, Âµ). Then the
formal power series
X X
[Z tor (m, Âµ)] Â· q m eÂµ
Âµâˆˆâˆ†L mâˆˆ Âµ2 +Z
2

is a modular form of weight 1+n/2 and representation ÏL with coefficients in CH1 (XLtor )âŠ—R.
!
Proof. If F âˆˆ M1âˆ’
n (ÏL ) has the Fourier expansion from (4.3), and if cÂµ (n) âˆˆ Z wherever
2
n < 0, then by Theorem 5.2 we get the identity
X X
cÂµ (âˆ’m)Z tor (m, Âµ) = 0
Âµâˆˆâˆ†L mâˆˆ Âµ2 +Z
2

in CH1 (XLtor ) âŠ— R. The result thus follows from Proposition 5.3 as in [Bo2], with the
rationality statement allowing one to omit the Galois action appearing in that reference.
This proves the theorem.

Remark 5.5. According to Theorem 4.13, the pairs (Z tor (m, Âµ), 21 Î¦Lm,Âµ ) define classes in
c 1 (X tor , Dpre) of X tor over C in the sense of Definition 1.15
the arithmetic Chow group CH
L
L
of [BBK]. The same argument as in the proof of Theorem 5.4 shows that the generating
series of these classes is modular with values in that arithmetic Chow group.

54

JAN H. BRUINIER AND SHAUL ZEMEL

References
[AMRT]

Ash, A., Mumford, D., Rapoport, M., Tai, Y. S. Smooth Compactifications of Locally
Symmetric Varieties, Lie Groups, History, Frontiers and Applications IV, Math. Sci. Press,
Brookline, MA, iv+335pp (1975).
[BB]
Baily, W. L., Borel, A., Compactification of Arithmetic Quotients of Bounded Symmetric Domains, Ann. of Math., vol 84 issue 3, 442â€“528 (1966).
[Bo1]
Borcherds, R. E., Automorphic Forms with Singularities on Grassmannians, Invent.
Math., vol. 132, 491â€“562 (1998).
[Bo2]
Borcherds, R. E., The Grossâ€“Kohnenâ€“Zagier Theorem in Higher Dimensions, Duke
Math J., vol 97 no. 2, 219â€“233 (1999). Correction: Duke Math J., vol 105 no. 1, 183â€“184 (2000).
[Br1]
Bruinier, J. H., Borcherds Products on O(2, l) and Chern Classes of Heegner Divisors, Lecture Notes in Mathematics 1780, Springerâ€“Verlag (2002).
[Br2]
Bruinier, J. H., On the Converse Theorem for Borcherds Products, J. Alg., vol 397,
315â€“342 (2014).
[BBK]
Bruinier, J. H., Burgos Gil, J.-I., KuÌˆhn, U., Borcherds Products and Arithmetic Intersection Theory on Hilbert Modular Surfaces, Duke Math J., vol 139 no. 1, 1â€“88
(2007).
[BFr]
Bruinier, J. H., Freitag, E., Local Borcherds Products, Ann. Inst. Fourier, vol 51, 1â€“26
(2001).
[BFu]
Bruinier, J. H., Funke, J., On Two Geometric Theta Lifts, Duke Math J., vol 125 no. 1,
45â€“90 (2004).
[BHY]
Bruinier, J. H., Howard, B., Yang, T., Heights of Kudlaâ€“Rapoport Divisors and Derivatives of L-Functions, Invent. Math., vol 201 no. 1, 1â€“95 (2015).
[BHKRY] Bruinier, J. H., Howard, B., Kudla, S., Rapoport, M., Yang, T., Modularity of generating series of divisors on unitary Shimura varieties, preprint (2017). arXiv:1702.07812
[math.NT]
[BK]
Bruinier, J. H., KuÌˆhn, U., Integrals of Automorphic Greenâ€™s Functions Associated
to Heegner Divisors, Int. Math. Res. Not., vol 2003, 1687â€“1729 (2003).
[BO]
Bruinier, J. H., Ono, K., Heeger Divisors, L-Functions, and Harmonic Weak Maass
Forms, Ann. of Math., vol 172, 2135â€“2181 (2010).
[BS]
Bruinier, J. H., Schwagenscheidt, M., Algebraic Formulas for the Coefficients of
Mock Theta Functions and Weyl Vectors of Borcherds Products, J. Algebra, vol
478, 38â€“57 (2017).
[BKK]
Burgos Gil, J.-I., Kramer, J., KuÌˆhn, U., Cohomological Arithmetic Chow Rings, J. Inst.
Math. Jussieu., vol 6, 1178 (2007).
[CLS]
Cox, D. A., Little, J., Schenck, H., Toric Varieties, Graduate Texts in Mathematics 124,
AMS, (2012)
[Fi]
Fiori, A., Toroidal Compactifications and Dimension Formulas for Spaces
of Modular Forms for Orthogonal Shimura Varieties, pre-print. arXiv link:
https://arxiv.org/abs/1610.04865.
[Fu]
Fulton, W., Introduction to Toric Varieties, Princeton University Press, Princeton, NJ
(1993)
[GS]
Gillet, H., SouleÌ, C., Arithmetic Intersection Theory, Publ. Math. IHES, vol 72, 94-174
(1990).
[GKZ]
Gross, B., Kohnen, W., Zagier, D., Heegner Points and Derivatives of L-Series, II,
Math. Ann., vol 278 no. 1â€“4, 497â€“562 (1987).
[HZ]
Hirzebruch, F., Zagier, D., Intersection Numbers of Curves on Hilbert Modular
Surfaces and Modular Forms of Nebentypus, Invent. Math., vol. 36, 57â€“114 (1976).

SPECIAL CYCLES ON TOROIDAL COMPACTIFICATIONS

[H]
[HMP]
[K1]
[K2]

[K3]

[KM]

[L]
[McG]
[Nak]
[Nam]
[OT]
[P]
[Sa]
[Se]
[Ze1]
[Ze2]
[Ze3]

[Ze4]
[Ze5]

55

Hofmann, E., Local Borcherds Products for Unitary Groups, Nagoya Math. J., vol
234, 139â€“169 (2019).
Howard, B., Madapusi Pera, K., Arithmetic of Borcherds Products, pre-print,
https://arxiv.org/abs/1710.00347.
S. Kudla, Central Derivatives of Eisenstein Series and Height Pairings, Ann. of
Math. 2, vol 146 issue 2, 545â€“646 (1997).
S. Kudla, Special Cycles and Derivatives of Eisenstein Series, in Heegner Points and
Rankin L-series, Math. Sci. Res. Inst. Publ., vol 49, Cambridge University Press, Cambridge
(2004).
Kudla, S. S., Another Product for a Borcherds Form, in Advances in the Theory of Automorphic Forms and Their L-functions, ed. D. Jiang, F. Shahidi and D. Soudry, Contemporary
Math. 664, AMS, 261-294 (2016).
Kudla, S., Millson, J., Intersection numbers of cycles on locally symmetric spaces
and Fourier coefficients of holomorphic modular forms in several complex variables, IHES Publi. Math. vol. 71, 121â€“172 (1990).
Looijenga, E., Compactifications Defined by Arrangements II: Locally Symmetric
Varieties of Type IV, Duke Math. J., vol 119, 527-588 (2003).
McGraw, W. J., Rationality of Vector Valued Modular Forms Associated to the
Weil Representation, Math. Annalen, vol. 326, 105â€“122 (2003).
Nakajima, S., On Invariant Differential Operators on Bounded Symmetric Domains of Type IV, Proc. Japan Acad., vol 58 issue A, 235238 (1982).
Namikawa, Y., Toroidal compactification of Siegel spaces, Lecture Notes in Mathematics 812, Springerâ€“Verlag, Berlin (1980).
Oda, T., Tsuzuki, M., Automorphic Green Functions Associated with the Secondary
Spherical Functions, Publ. Res. Inst. Math. Sci., vol 39, 451â€“533 (2003).
Peterson, A., Modular Forms on the Moduli Space of Polarised K3 Surfaces, preprint, arXiv link: https://arxiv.org/abs/1511.06887 (2015).
Satake, I., On Compactifications of the Quotient Spaces for Arithmetically Defined Discontinuous Groups, Ann. of Math., vol 72 issue 2, 555â€“580 (1960).
Serre, J.-P., A Course in Arithmetic, Graduate Texts in Mathematics 7, Springer-Verlag,
New York (1973).
Zemel, S., A Grossâ€“Kohnenâ€“Zagier Type Theorem for Higher-Codimensional Heegner Cycles, Res. Number Theory, vol 1:23, 1â€“44 (2015).
Zemel, S. Regularized pairings of meromorphic modular forms and theta lifts, J.
Number Theory, vol 162, 275-311 (2016).
Zemel, S., Weight Changing Operators for Automorphic Forms on Grassmannians
and Differential Properties of Certain Theta Lifts, Nagoya Math. J., vol 228, 186â€“
221 (2017).
Zemel, S., Normalizers of Congruence Groups in SL2 (R) and Automorphisms of
Lattices, Int. J. Number Theory, vol 13 issue 7, 1275-1300 (2017).
Zemel, S., The Integral Structure of Parabolic Subgroups of Orthogonal Groups,
submitted. https://arxiv.org/abs/1902.08264

Fachbereich Mathematik, Technische UniversitaÌˆt Darmstadt, Schlossgartenstrasse 7,
Dâ€“64289 Darmstadt, Germany
E-mail address: bruinier@mathematik.tu-darmstadt.de
Einstein Institute of Mathematics, the Hebrew University of Jerusalem, Edmund Safra
Campus, Jerusalem 91904, Israel
E-mail address:
zemels@math.huji.ac.il

