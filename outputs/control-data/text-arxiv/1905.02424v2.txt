Equal-Subset-Sum Faster Than the Meet-in-the-Middle

arXiv:1905.02424v2 [cs.DS] 3 Jul 2019

Marcin Muchaâˆ—

Jesper Nederlofâ€ 

Jakub Pawlewiczâ€¡

Karol WÄ™grzyckiÂ§

In the Equal-Subset-Sum problem, we are given a set S of n integers and the problem is
to decide if there exist two disjoint nonempty subsets A, B âŠ† S, whose elements sum up to the
same value. The problem is NP-complete. The state-of-the-art algorithm runs in Oâˆ— (3n/2 ) â‰¤
Oâˆ— (1.7321n ) time and is based on the meet-in-the-middle technique. In this paper, we improve
upon this algorithm and give Oâˆ— (1.7088n ) worst case Monte Carlo algorithm. This answers a
question suggested by Woeginger in his inspirational survey.
Additionally, we analyse the polynomial space algorithm for Equal-Subset-Sum. A naive
polynomial space algorithm for Equal-Subset-Sum runs in Oâˆ— (3n ) time. With read-only access
to the exponentially many random bits, we show a randomized algorithm running in Oâˆ— (2.6817n )
time and polynomial space.

âˆ—

Institute of Informatics, University of Warsaw, Poland, mucha@mimuw.edu.pl. Supported by project TOTAL that
has received funding from the European Research Council (ERC) under the European Unionâ€™s Horizon 2020 research
and innovation programme (grant agreement No 677651).
â€ 
Eindhoven University of Technology, The Netherlands, j.nederlof@tue.nl. Supported by the Netherlands Organization for Scientific Research under project no. 024.002.003 and the European Research Council under project
no. 617951.
â€¡
Institute of Informatics, University of Warsaw, Poland, pan@mimuw.edu.pl.
Â§
Institute of Informatics, University of Warsaw, Poland, k.wegrzycki@mimuw.edu.pl. Supported by the grants
2016/21/N/ST6/01468 and 2018/28/T/ST6/00084 of the Polish National Science Center and project TOTAL that
has received funding from the European Research Council (ERC) under the European Unionâ€™s Horizon 2020 research
and innovation programme (grant agreement No 677651).

1

Introduction

In the Subset-Sum problem, we are given as input a set S of n integers a1 , . . . , an and a target
t. The task is to decide if there exists a subset of S, such that a total sum of the numbers in this
subset is equal to t. This can be formulated in the following form:
n
X

xi ai = t

i=1

and the task is to ï¬nd xi âˆˆ {0, 1}. Subset-Sum is one of the fundamental NP-complete
problems. Study on the exact complexity of Subset-Sum led to the discovery of one of the most
fundamental algorithmic tool: meet-in-the-middle. Horowitz and Sahni [24] used this technique to
give a Oâˆ— (2n/2 ) algorithm for Subset-Sum in the following way: First, rewrite the Subset-Sum
equation:
âŒŠn/2âŒ‹

X
i=1

xi ai = t âˆ’

n
X

x i ai .

âŒŠn/2âŒ‹+1

Then enumerate all O(2n/2 ) possible values of the left side L(x1 , . . . , xâŒŠn/2âŒ‹ ) and O(2n/2 ) possible
values of the right side R(xâŒŠn/2âŒ‹+1 , . . . , xn ). After that, it remains to look for the value that occurs
in both L and R, i.e., meeting the tables L and R. One can do that eï¬ƒciently by sorting (see [24]
for details). To summarize, meet-in-the-middle technique is based on rewriting the formula as an
equation between two functions and eï¬ƒciently seeking any value that occurs in both of their images.
Later, Schroeppel and Shamir [38] observed that space usage of meet-in-the-middle can be
improved to Oâˆ— (2n/4 ) by using space-eï¬ƒcient algorithm for 4-SUM. However, the time complexity
remains unchallenged and one of the most prominent open problem in the area of exact algorithms
is to improve upon meet-in-the-middle for Subset-Sum:
Open Question 1. Can Subset-Sum be solved in Oâˆ— (2(0.5âˆ’Î´)n ) time for some constant Î´ > 0?
In this paper, we consider the Equal-Subset-Sum problem. We are given a set S of n integers
and the task is to decide if there exist two disjoint nonempty subsets A, B âŠ† S, whose elements
sum up to the same value. Similarly to Subset-Sum, this problem is NP-complete [44]. In the
inspirational survey, Woeginger [43] noticed Equal-Subset-Sum can be solved by using meet-inthe-middle and asked if it can be improved: 1
Open Question 2 (c.f., [42],[43]). Can we improve upon the meet-in-the-middle algorithm for
Equal-Subset-Sum?
The folklore meet-in-the-middle algorithm for Equal-Subset-Sum (that we will present in the
next paragraph) works in Oâˆ— (3n/2 ) time.
Folklore algorithm for Equal-Subset-Sum First, we arbitrarily partition S into S1 =
{a1 , . . . , aâŒŠn/2âŒ‹ } and S2 = {aâŒŠn/2âŒ‹+1 , . . . , an }. Recall that in Equal-Subset-Sum we seek two
subsets A, B âŠ† S, such that A âˆ© B = âˆ… and Î£(A) = Î£(B). We can write the solution as 4 subsets:
A1 = Aâˆ©S1 , A2 = Aâˆ©S2 , B1 = B âˆ©S1 and B2 = B âˆ©S2 , such that: Î£(A1 )+Î£(A2 ) = Î£(B1 )+Î£(B2 ).
In particular, it means that: Î£(A1 ) âˆ’ Î£(B1 ) = Î£(B2 ) âˆ’ Î£(A2 ). So, the problem reduces to ï¬nding
two vectors x âˆˆ {âˆ’1, 0, 1}âŒŠn/2âŒ‹ and y âˆˆ {âˆ’1, 0, 1}âŒˆn/2âŒ‰ , such that:
1

[42, 43] noticed that 4-SUM gives Oâˆ— (2n ) algorithm, but it actually gives a Oâˆ— (3n/2 ) algorithm, see Appendix C.

1

âŒŠn/2âŒ‹

X
i=1

xi ai =

âŒˆn/2âŒ‰

X

yi ai+âŒŠn/2âŒ‹ .

i=1

We can do this in Oâˆ— (3n/2 ) time as follows. First, enumerate and store all 3âŒŠn/2âŒ‹ possible values
of the left side of the equation and all 3âŒˆn/2âŒ‰ possible values of the right side of the equation. Then
look for a value that occurs in both tables (collision) in time Oâˆ— (3n/2 ) by sorting the values. The
total running time is therefore Oâˆ— (3n/2 ). Analogously to Subset-Sum, one can improve the space
usage of the above algorithm to Oâˆ— (3n/4 ) (see Appendix C).
A common pattern seems unavoidable in algorithms for Subset-Sum and Equal-SubsetSum: we have to go through all possible values of the left and the right side of the equation. This
enumeration dominates the time used to solve the problem. So, it was conceivable that perhaps
no improvement for Equal-Subset-Sum could be obtained unless we improve an algorithm for
Subset-Sum ï¬rst [42, 43].

1.1

Our Contribution

While the meet-in-the-middle algorithm remains unchallenged for Subset-Sum, we show that,
surprisingly, we can improve the algorithm for Equal-Subset-Sum. The main result of this paper
is the following theorem.
Theorem 1.1. Equal-Subset-Sum can be solved in Oâˆ— (1.7088n ) time with high probability.
This positively answers Open Question 2. To prove this result we observe that the worst case for
the meet-in-the-middle algorithm is that of a balanced solution, i.e., when |A| = |B| = |S \(AâˆªB)| â‰ˆ
n/3. We propose a substantially diï¬€erent algorithm, that runs in Oâˆ— (22/3n ) time for that case. The
crucial insight of the new approach is the fact that when |A| â‰ˆ |B| â‰ˆ n/3, then there is an abundance
of pairs X, Y âŠ† S, X 6= Y with Î£(X) = Î£(Y ). We use the representation technique to exploit this.
Interestingly, that technique was initially developed to solve the average case Subset-Sum [9, 25].
Our second result is an improved algorithm for Equal-Subset-Sum running in polynomial
space. The naive algorithm in polynomial space works in Oâˆ— (3n ) time by enumerating all possible
disjoint pairs of subsets of S. This algorithm is analogous to the Oâˆ— (2n ) polynomial space algorithm
for Subset-Sum. Recently, Bansal et al. [6] proposed a Oâˆ— (20.86n ) algorithm for Subset-Sum on
the machine that has access to the exponential number of random bits. We show that a similar idea
can be used for Equal-Subset-Sum.
Theorem 1.2. There exists a Monte Carlo algorithm which solves Equal-Subset-Sum in polynomial space and time Oâˆ— (2.6817n ). The algorithm assumes random read-only access to exponentially
many random bits.
This result is interesting for two reasons. First, Bansal et al. [6] require nontrivial results in
information theory. Our algorithm is relatively simple and does not need such techniques. Second,
the approach of Bansal et al. [6] developed for Subset-Sum has a barrier, i.e., signiï¬cantly new
ideas must be introduced to get an algorithm running faster than Oâˆ— (20.75n ). In our case, this
corresponds to the algorithm running in Oâˆ— (21.5n ) â‰¤ Oâˆ— (2.8285n ) time and polynomial space (for
elaboration see Section 4). We show that relatively simple observations about Equal-Subset-Sum
enable us to give a slightly faster algorithm in polynomial space.

2

1.2

Related Work

The Equal-Subset-Sum was introduced by Woeginger and Yu [44] who showed that the problem
is NP-complete. This reduction automatically excludes 2o(n) algorithms for Equal-Subset-Sum
assuming ETH (see Appendix B), hence for this problem we aspire to optimize the constant in the
exponent. The best known constant comes from the meet-in-the-middle algorithm. Woeginger [43]
asked if this algorithm for Equal-Subset-Sum can be improved.
Exact algorithms for Subset-Sum: Nederlof et al. [35] proved that in the exact setting Knapsack and Subset-Sum problems are equivalent.
Schroeppel and Shamir [38] showed that the meet-in-the-middle algorithm admits a time-space
tradeoï¬€, i.e., T S 2 â‰¤ Oâˆ— (2n ), where T is the running time of the algorithm and S â‰¤ Oâˆ— (2n/2 ) is
the space of an algorithm. This tradeoï¬€ was improved by Austrin et al. [2] for almost all tradeoï¬€
parameters.
Austrin et al. [3] considered Subset-Sum parametrized by the maximum bin size Î² and obtained
algorithm running in time Oâˆ— (20.3399n Î² 4 ). Subsequently, Austrin et al. [4] showed that one can get
a faster algorithm for Subset-Sum than meet-in-the-middle if Î² â‰¤ 2(0.5âˆ’Îµ)n or Î² â‰¥ 20.661n . In this
paper, we use the hash function that is based on their ideas. Moreover, the ideas in [3, 4] were used
in the recent breakthrough polynomial space algorithm [6] running in Oâˆ— (20.86n ) time.
From the pseudopolynomial algorithms perspective Knapsack and Subset-Sum admit O(nt)
algorithm, where t is a value of a target. Recently, for Subset-Sum the pseudopolynomial algorithm
e
e âˆšnt) time by Koiliaris and Xu [29] and randomized O(n+t)
was improved to run in deterministic O(
time by Bringmann [11] (and simpliï¬ed, see [27, 30]). However, these algorithms have a drawback
of running in pseudopolynomial space Oâˆ— (t). Surprisingly, Lokshtanov and Nederlof [32] presented
e 3 t) and space O(n
e 2 ) which was later improved to O(nt)
e
an algorithm running in time O(n
time and
e
O(n log t) space assuming the Extended Riemann Hypothesis [11].
0.99 ) exists for Subsete
From a lower bounds perspective, no algorithm working in O(poly(n)t
Sum assuming SETH or SetCover conjecture [18, 1].
Approximation: Woeginger and Yu [44] presented the approximation algorithm for EqualSubset-Sum with the worst case ratio of 1.324. Bazgan et al. [7] considered a diï¬€erent formulation
of approximation for Equal-Subset-Sum and showed an FPTAS for it.
Cryptography and the average case complexity: In 1978 Knapsack problems were introduced into cryptography by Merkle and Hellman [34]. They introduced a Knapsack based public
key cryptosystem. Subsequently, their scheme was broken by using lattice reduction [39]. After
that, many knapsack cryptosystems were broken with low-density attacks [31, 17].
More recently, Impagliazzo and Naor [26] introduced a cryptographic
is provably
P scheme that
â†’
âˆ’
â†’
âˆ’
l(n)
as secure as Subset-Sum. They proposed a function f ( a , S) = a , iâˆˆS ai (mod 2 ), i.e., the
â†’
function which concatenates âˆ’
a with the sum of the ai â€™s for i âˆˆ S. Function f is a mapping of an
â†’
n bit string S to an l(n) bit string and âˆ’
a are a ï¬xed parameter. Our algorithms can be thought of
as an attempt to ï¬nd a collision of such a function in the worst case.
However, in the average case more eï¬ƒcient algorithms are known. Wagner [41] showed that
when solving problems involving sums of elements from lists, one can obtain faster algorithms when
there are many possible solutions. In the breakthrough paper, Howgrave-Graham and Joux [25] gave
Oâˆ— (20.337n ) algorithm for an average case Subset-Sum. It was subsequently improved by Becker
et al. [9] who gave an algorithm running in Oâˆ— (20.291n ). These papers introduced a representation
technique that is a crucial ingredient in our proofs.
3

Total search problems: The Number Balancing problem is: given
P n realPnumbers a1 , . . . , an âˆˆ
[0, 1], ï¬nd two disjoint subsets I, J âŠ† [n], such that the diï¬€erence | iâˆˆI ai âˆ’ jâˆˆJ aj | is minimized.
The pigeonhole principle and
the Chebyshevâ€™s inequality guarantee that there exists a solution
âˆš
n
with diï¬€erence at most O( 2n ). Karmarkar and Karp [28] showed that in polynomial time one can
produce a solution with diï¬€erence at most nâˆ’Î˜(log n) , but since then no further improvement is
known.
Papadimitriou [36] considered the problem Equal Sums: given n positive integers such that their
total sum is less than 2n âˆ’ 1, ï¬nd two subsets with the same sum. By the pigeonhole principle the
solution always exists, hence the decision version of this problem is obviously in P. However the
hard part is to actually ï¬nd a solution. Equal Sums is in class PPP but it remains open to show
that it is PPP-complete. Recently, this question gained some momentum. Hoberg et al. [23] showed
that Number Balancing is as hard as Minkowski. Ban et al. [5] showed the reduction from Equal
Sums to Minkowski and conjectured that Minkowski is complete for the class PPP. Very recently,
Sotiraki et al. [40] identiï¬ed the ï¬rst natural problem complete for PPP.
In Appendix E we show that our techniques can also be used to solve Number Balancing for
integers in Oâˆ— (1.7088n ) time.
Combinatorial Number Theory: If Î£(S) < 2n âˆ’ 1, then by the pigeonhole principle the answer to the decision version of Equal-Subset-Sum on S is always YES. In 1931 Paul ErdÅ‘s was
interested in the smallest maximum value of S, such that the answer to Equal-Subset-Sum on S
is NO, i.e., he considered the function:
f (n) = min{max{S} | all subsets of S are distinct, |S| = n, S âŠ† N}
âˆš
and showed f (n) > 2n /(10 n) [19]. The ï¬rst nontrivial upper bound on f was f (n) â‰¤ 2nâˆ’2 (for
suï¬ƒciently large n) [16]. Subsequently, Lunnon [33] proved that f (n) â‰¤ 0.2246 Â· 2n and Bohman
[10] showed f (n) â‰¤ 0.22002 Â· 2n . ErdÅ‘s [20] oï¬€ered 500 dollars for proof or disproof of conjecture
that f (n) â‰¥ c2n for some constant c.
Other Variants: Equal-Subset-Sum has some connections to the study of the structure of
DNA molecules [14, 15, 12]. Cieliebak et al. [13] considered k-Equal-Subset-Sum, in which we
need to ï¬nd k disjoint subsets of a given set with the same sum. They obtained several algorithms
that depend on certain restrictions of the sets (e.g., small cardinality of a solution). In the following
work, Cieliebak et al. [15] considered other variants of Equal-Subset-Sum and proved their NPhardness.

2

Preliminaries

e
Throughout the paper we use the Oâˆ— notation to hide factors polynomial in the input size and the O
notation to hide factors logarithmic in the input size. We also use [n] to denoteP
the set {1, . . . , n}.
If S = {a1 , .P
. . , an } is a set of integers and X âŠ† {1, . . . , n}, then Î£S (X) :=
iâˆˆX ai . Also, we
use Î£(S) = sâˆˆS s to denote the sum of the elements of the set. We use the binomial coeï¬ƒcient

notation for sets, i.e., for a set S the symbol Sk = {X âŠ† S | |S| = k} is the set of all subsets of the
set S of size exactly k.
We may assume that the input to Equal-Subset-Sum has the following properties:
â€¢ the input set S = {a1 , . . . , an } consists of positive integers,
4

â€¢

Pn

i=1 ai

< 2Ï„ n for a constant Ï„ < 10,

â€¢ integer n is a multiple of 12.
These are standard assumptions for Subset-Sum (e.g., [3, 22]). For completeness, in Appendix A we prove how to apply reductions to Equal-Subset-Sum to ensure these properties.
We need the following theorem concerning the density of prime numbers [21, p. 371, Eq.
(22.19.3)].
Lemma 2.1. For a large enough integer b, there exist at least 2b /b prime numbers in the interval
[2b , 2b+1 ].
The binary entropy function is h(Î±) = âˆ’Î± log2 Î± âˆ’ (1 âˆ’ Î±) log 2 (1 âˆ’ Î±) for Î± âˆˆ (0, 1) and
h(0) = h(1) = 0. For all integers n â‰¥ 1 and Î± âˆˆ [0, 1] such
that Ïƒn is an integer, we have the
n
following upper bound on the binomial coeï¬ƒcient [37]: Î±n â‰¤ 2h(Î±)n . We also need a standard
p
bound on binary entropy function h(x) â‰¤ 2 x(1 âˆ’ x).
Throughout this paper all logarithms are base 2.

3

Faster Exponential Space Algorithm

In this section, we improve upon the meet-in-the-middle algorithm for Equal-Subset-Sum.
Theorem 3.1. Equal-Subset-Sum can be solved in Oâˆ— (1.7088n ) time with high probability.
Theorem 3.1 is proved by using two diï¬€erent algorithms for Equal-Subset-Sum. To bound
the trade-oï¬€ between these algorithms we introduce the concept of a minimum solution.
Definition 3.2 (Minimum Solution). For a set S of positive integers we say that a solution A, B âŠ† S
is a minimum solution if its size |A| + |B| is smallest possible.
We now assume that the size of the minimum solution has even size for simplicity of presentation.
The algorithm and analysis for the case of odd-sized minimum solution is similar, but somewhat
more messy due to all the ï¬‚oors and ceilings one needs to take care of.
In Section 3.1 we prove that the meet-in-the-middle approach for Equal-Subset-Sum already
gives algorithm running in time Oâˆ— ((3 âˆ’ Îµ)n/2 ) if the minimum solution A, B is unbalanced, i.e.,
â€²
â€²
||A âˆª B| âˆ’ 2n
3 | > Îµ n for some Îµ > 0 depending on Îµ. Subsequently, in Section 3.2 we propose
an algorithm for balanced instances, i.e., when the size of a minimum solution is close to 2/3. In
2
particular, we show how to detect sets A, B with Î£(A) = Î£(B) and |A| â‰ˆ |B| â‰ˆ n3 , with an Oâˆ— (2 3 n )
time algorithm. By bounding trade-oï¬€ between the algorithms from Section 3.1 and Section 3.2 we
prove Theorem 3.1 and bound the running time numerically.

3.1

Equal-Subset-Sum for unbalanced solutions via meet-in-the-middle

Theorem 3.3. If S is a set of n integers
with a minimum solution of size â„“, then Equal-Subset-Sum
 â„“/2
2
) time with high probability.
with input S can be solved in Oâˆ— ( n/2
â„“/2
Proof of Theorem 3.3. Algorithm 1 uses the meet-in-the-middle approach restricted to solutions of
size â„“. We will show that this algorithm solves Equal-Subset-Sum in the claimed running time.
The algorithm starts by randomly partitioning the set S into two equally sized sets S1 , S2 . Let
A, B be a ï¬xed minimum solution of size |A âˆª B| = â„“. We will later show that with â„¦(1/poly(n))
5

Algorithm 1 UnbalancedEqualSubsetSum(S, â„“)
1: Randomly split S into two disjoint S1 , S2 âŠ† S, such that |S1 | = |S2 | = n/2
2: Enumerate C1 = {Î£(A1 ) âˆ’ Î£(B1 ) | A1 , B1 âŠ† S1 , A1 âˆ© B1 = âˆ…, |A1 | + |B1 | = â„“/2}
3: Enumerate C2 = {Î£(A2 ) âˆ’ Î£(B2 ) | A2 , B2 âŠ† S2 , A2 âˆ© B2 = âˆ…, |A2 | + |B2 | = â„“/2}
4: if âˆƒx1 âˆˆ C1 , x2 âˆˆ C2 such that x1 + x2 = 0 then
5:
Let A1 , B1 âŠ† S1 be such that x1 = Î£(A1 ) âˆ’ Î£(B1 )
6:
Let A2 , B2 âŠ† S2 be such that x2 = Î£(A2 ) âˆ’ Î£(B2 )
7:
return (A1 âˆª A2 , B1 âˆª B2 )
8: end if
9: return NO
probability |(A âˆª B) âˆ© S1 | = |(A âˆª B) âˆ© S2 | = â„“/2. We assume this is indeed the case and proceed
with meet-in-the-middle. For S1 we will list all A1 , B1 that could possibly be equal to S1 âˆ© A and
S1 âˆ© B, i.e. disjoint and with total size â„“/2. We compute x = Î£(A1 ) âˆ’ Î£(B1 ) and store all these in
C1 . We proceed analogously for S2 .
We then look for x1 âˆˆ C1 and x2 âˆˆ C2 such that x1 + x2 = 0. If we ï¬nd it then we identify the
sets A1 and B1 that correspond to x1 and sets A2 and B2 that correspond to x2 (the easiest way to
do that is to store with each element of C1 and C2 the corresponding pair of sets when generating
them). Finally we return (A1 âˆª A2 , B1 âˆª B2 ).
Probability of a good split: We now lower-bound the probability of S1 and S2 splitting
A âˆª B
n
â„“ 
nâˆ’â„“
in half. There are n/2
possible equally sized partitions. Among these there are â„“/2
(nâˆ’â„“)/2
partitions that split A âˆª B in half. The probability that a random partition splits A and B in half
is:
â„“ 
nâˆ’â„“ 
1
2â„“ 2nâˆ’â„“
â„“/2 (nâˆ’â„“)/2
=
â‰¥
n 
2 2n
(n
+
1)
(n
+
1)2
n/2

n
2n
because n+1
â‰¤ n/2
â‰¤ 2n .
Running time: To enumerate C1 and C2 we need Oâˆ— (

n/2 â„“/2
2 )
â„“/2

time, because ï¬rst we guess set

S1 âˆ© (A âˆª B) of size â„“/2 and then split between A and B in at most 2â„“/2 ways. We then check the
existence of x1 âˆˆ C1 and x2 âˆˆ C2 such that x1 + x2 = 0 in Oâˆ— ((|C1 | + |C2 |) log (|C1 | + |C2 |)) time
by sorting.
We can amplify the probability of a good split to O(1) by repeating the whole algorithm polynomially many times.
Correctness: With probability â„¦(1/poly(n)) we divide the A âˆª B equally between S1 and S2 . If
that happens the set C1 contains x1 such that x1 = Î£(Aâˆ©S1 )âˆ’Î£(B âˆ©S1 ) and the set C2 contains x2
that x2 = Î£(Aâˆ©S2 )âˆ’Î£(B âˆ©S2 ). Note that x1 +x2 = Î£(Aâˆ©S1 )+Î£(Aâˆ©S2 )âˆ’Î£(B âˆ©S1 )âˆ’Î£(B âˆ©S2 ) =
Î£(A) âˆ’ Î£(B) which is 0, since A, B is a solution. Therefore Algorithm 1 ï¬nds a solution of size â„“
(but of course, it could be diï¬€erent from A,B).

3.2

Equal-Subset-Sum for balanced solutions

Theorem 3.4. Given a set S of n integers with a minimum solution size â„“ âˆˆ ( 12 n, (1 âˆ’ Îµ)n] for
some constant Îµ > 0, Equal-Subset-Sum can be solved in time Oâˆ— (2â„“ ) w.h.p.
6

We use Algorithm 2 to prove Theorem 3.4. In this algorithm, we ï¬rst pick a random prime p
in the range [2nâˆ’â„“ , 2nâˆ’â„“+1 ], as well as an integer t chosen uniformly at random from [1, 2nâˆ’â„“ ]. We
then compute the set C = {X âŠ† S | Î£(X) â‰¡p t}. In the analysis, we argue that with â„¦(1/poly(n))
probability C contains two diï¬€erent subsets X, Y of S with Î£(X) = Î£(Y ). To identify such pair it
is enough to sort the set |C| in time O(|C| log |C|), and then scan it. We return X \ Y and Y \ X
to guarantee that the returned sets are disjoint.
Algorithm 2 BalancedEqualSubsetSum(a1 , . . . , an , â„“)
1:
2:
3:
4:
5:
6:

Pick a random prime p in [2nâˆ’â„“ , 2nâˆ’â„“+1 ]
Pick a random number t in [1, 2nâˆ’â„“ ]
Let C = {X âŠ† S | Î£(X) â‰¡p t} be the set of candidates
with probability â„¦(1/poly(n)).
Enumerate and store all elements of C
Find X, Y âˆˆ C, such that Î£(X) = Î£(Y )
return (X \ Y, Y \ X)

âŠ² C contains two sets with equal sum
âŠ² In time Oâˆ— (|C| + 2n/2 )
âŠ² In time Oâˆ— (|C|)

We now analyse the correctness of Algorithm 2. Later, we will give a bound on the running time
and conclude the proof Theorem 3.4. First, observe the following:
Lemma 3.5. Let S be a set of n positive integers with minimum solution size of â„“. Let
Î¨ = {Î£(X) | X âŠ† S and âˆƒY âŠ† S such that X 6= Y and Î£(X) = Î£(Y )} .

(1)

If â„“ > n2 , then |Î¨| â‰¥ 2nâˆ’â„“ (note that all elements in Î¨ are different).
A

X

B

S
Figure 1: Scheme presents the set S of positive integers and two disjoint subsets A, B âŠ† S. The
point is that if Î£(A) = Î£(B) then for any subset X âŠ† S \ (A âˆª B) we have a guarantee that
Î£(A âˆª X) = Î£(B âˆª X).
Proof. Let A, B âŠ† S be a ï¬xed minimum solution to S. We know that â„“ = |A âˆª B|, Î£(A) = Î£(B)
and A âˆ© B = âˆ…. With this in hand we construct set Î¨ of 2nâˆ’â„“ pairs of diï¬€erent X, Y âŠ† S with
Î£(X) = Î£(Y ).
Consider set Z = S \ (A âˆª B). By the bound on the size of A and B we know that |Z| = n âˆ’ â„“.
Now we construct our candidate pairs as follows: take any subset Z â€² âŠ† Z and note that X âˆª Z â€²
and Y âˆª Z â€² satisfy Î£(X âˆª Z â€² ) = Î£(Y âˆª Z â€² ). There are 2|Z| possible subsets of set Z and the claim
follows.
Now we will prove that if â„“ > n2 then all subsets of Z have a diï¬€erent sum. Assume for a
contradiction that there exist Z1 , Z2 âŠ† Z, such that Î£(Z1 ) = Î£(Z2 ) and Z1 6= Z2 . Then Z1 \ Z2 and
Z2 \ Z1 would give a solution smaller than A, B, because |Z| < â„“. This contradicts the assumption
about the minimality of A, B. It follows that if â„“ > 12 n then all constructed pairs have a diï¬€erent
sum.

7

Now, we consider the hashing function ht,p (x) = x + t (mod p). We prove that if the set Î¨ (see
Equation 1) is suï¬ƒciently large, then for a random choice of t, at least one element of set Î¨ is in
the congruence class t.
Lemma 3.6. Let S be the set of n positive integers bounded by 2O(n) with minimum solution
of size â„“ and â„“ > n2 . For a random prime p âˆˆ [2nâˆ’â„“ , 2nâˆ’â„“+1 ] and a random t âˆˆ [1, 2nâˆ’â„“ ] let
Ct,p = {X âŠ† S | Î£(X) â‰¡p t }. Then,
i
h
Pt,p âˆƒX, Y âˆˆ Ct,p Î£(X) = Î£(Y ), X 6= Y â‰¥ â„¦(1/n2 ).

Proof. Let Î¨ be the set deï¬ned in (1). So Î¨ âŠ† {1, . . . , 2O(n) }, and |Î¨| â‰¥ 2nâˆ’â„“ . It is suï¬ƒcient to
bound the probability, that there exists an element a âˆˆ Î¨ such a â‰¡p t. Let a1 , a2 âˆˆ Î¨ be two
distinct elements.
Pp [a1 â‰¡p a2 ] = Pp [p divides |a1 âˆ’ a2 |] â‰¤ O(n(n âˆ’ â„“)/2nâˆ’â„“ ).
This is because |a1 âˆ’ a2 | can only have O(n) prime divisors, and we are sampling p from the set
of at least 2nâˆ’â„“ /(n âˆ’ â„“) primes by Lemma 2.1. Let k be the number of pairs a1 , a2 âˆˆ Î¨ such that
2
a1 â‰¡p a2 . We have E [k] â‰¤ O(|Î¨| + (|Î¨|n)2 /2nâˆ’â„“ ). We know that |Î¨| â‰¥ 2nâˆ’â„“ , so 2|Î¨|
nâˆ’â„“ â‰¥ |Î¨| which
means that E [k] â‰¤ O((|Î¨|n)2 /2nâˆ’â„“ ). Hence, by Markovâ€™s inequality k is at most O((|Î¨|n)2 /2nâˆ’â„“ )
with at least constant probability. If this does indeed happen, then


|Î¨|2
|Î¨|2
|{a (mod p) | a âˆˆ Î¨}| â‰¥
â‰¥â„¦
â‰¥ â„¦(2nâˆ’â„“ /n2 ),
k
(|Î¨|n)2 /2nâˆ’â„“
and the probability that t chosen uniformly at random from [1, 2nâˆ’â„“ ] will be among one of the
elements of set {a (mod p) | a âˆˆ Î¨} is |{a (mod p) | a âˆˆ Î¨}|/2nâˆ’â„“ â‰¥ â„¦(1/n2 ).
Proof of correctness of Algorithm 2. By Lemma 3.6, after choosing a random prime p and random
number t âˆˆ [1, 2nâˆ’â„“ ] the set C = {X âŠ† S | Î£(X) â‰¡p t} contains at least two subsets X, Y âŠ† S,
such that Î£(X) = Î£(Y ) with probability â„¦(1/poly(n)). Algorithm 2 computes the set C and ï¬nds
X â€² , Y â€² âŠ† S, such that Î£(X â€² ) = Î£(Y â€² ). Then it returns the solution X â€² \ Y â€² , Y â€² \ X â€² .
Now we focus on bounding the running time of Algorithm 2. We start by bounding the size of
the candidate set C.
Claim 3.7. Let S be the set of n non-negative integers bounded by 2O(n) with a minimum solution
of size â„“ such that â„“ â‰¤ (1 âˆ’ Îµ)n for some constant Îµ > 0 (think of Îµ = 1/100). For a random prime
p âˆˆ [2nâˆ’â„“ , 2nâˆ’â„“+1 ] and a random number t âˆˆ [1, 2nâˆ’â„“ ] let Ct,p = {X âŠ† S | Î£(X) â‰¡p t }. Then
E [|Ct,p |] â‰¤ Oâˆ— (2â„“ )
Proof. By the linearity of expectations:
E [|Ct,p |] =

X

XâŠ†S

Pt,p [p divides Î£(X) âˆ’ t]

For the remaining part of the proof we focus on showing Pt,p [p divides Î£(X) âˆ’ t] â‰¤ Oâˆ— (2â„“âˆ’n )
for a ï¬xed X âŠ† S. It automatically ï¬nishes the proof, because there are 2n possible subsets X.
8

We split the terms into two cases. If Î£(X) = t, then p divides Î£(X) âˆ’ t with probability 1.
1
) because t is a random number
However, for a ï¬xed X âŠ† S, the probability that Î£(X) = t is O( 2nâˆ’â„“
nâˆ’â„“
nâˆ’â„“
from [1, 2 ] and p â‰¥ 2 .
On the other hand, if Î£(X) 6= t, then by the assumption, the set S consists of non-negative
integers bounded by 2Ï„ n for some constant Ï„ > 0. In particular, |Î£(X) âˆ’ t| â‰¤ 2Ï„ n . This means that
Ï„n
â‰¤ Ï„Îµ = O(1) prime factors of size at least 2nâˆ’â„“ . Any prime number p
|Î£(X) âˆ’ t| has at most nâˆ’â„“
that divides Î£(X) âˆ’ t must therefore be one of these numbers. By Lemma 2.1 there are at least
2nâˆ’â„“ /(n âˆ’ â„“) prime numbers in range [2nâˆ’â„“ , 2nâˆ’â„“+1 ]. Hence, for a ï¬xed X âŠ† S the probability that
p divides Î£(X) âˆ’ t is bounded by O(n2â„“âˆ’n ).


Lemma 3.8. The set Ct,p can be enumerated in time Oâˆ— max |Ct,p |, 2n/2 .
The proof of the above lemma is based on Schroeppel and Shamir [38] algorithm for SubsetSum. For a full proof of Lemma 3.8 see, e.g., Section 3.2 of [9]. Observe, that for our purposes the
running time is dominated by Oâˆ— (|Ct,p |).

Proof of the running time of Algorithm 2. To enumerate the set Ct,p we need Oâˆ— (|C| + 2n/2 ) time
(see Lemma 3.8). To ï¬nd two subsets X, Y âˆˆ C, such that Î£(X) = Î£(Y ) we need Oâˆ— (|C| log |C|)
time: we sort C and scan it.
The prime number p is at most 2nâˆ’â„“+1 and the expected size of C is Oâˆ— (2â„“ ). Because we assumed
that â„“ > n2 the expected running time is Oâˆ— (2â„“ ) (we can terminate algorithm when it exceeds Oâˆ— (2â„“ )
to Monte Carlo guarantees). The probability of success is â„¦(1/poly(n)). We can amplify it with
polynomial overhead to any constant by repetition.
This concludes the proof of Theorem 3.4.

3.3

Trade-off for Equal-Subset-Sum

In this section, we will proof the Theorem 3.1 by combining Theorem 3.4 and Theorem 3.3.
Proof of Theorem 3.1. Both Theorem 3.4 and Theorem 3.3 solve Equal-Subset-Sum. Hence, we
can focus on bounding the running time. By the trade-oï¬€ between Theorem 3.4 (which works for
â„“ âˆˆ ( n2 , (1 âˆ’ Îµ)n) and Theorem 3.3 the running time is:








n/2 â„“/2
n/2 â„“/2 â„“
âˆ—
O
max
2
+
max
min
2 ,2
â„“/2
â„“/2
â„“âˆˆ[1,n/2]âˆª[(1âˆ’Îµ)n,n]
â„“âˆˆ(n/2,(1âˆ’Îµ)n)
For simplicity of analysis we bounded the sums by the maximum (note that Oâˆ— notation hides
polynomial factors). When â„“ â‰¤ n/2, the running time is maximized for â„“ = n/2, because (let
â„“ = Î±n):




 n
n/2 â„“/2
âˆ—
O
2
= Oâˆ— 2 2 (h(Î±)+Î±)
â„“/2

and the entropy function h(x) is increasing in range [0, 0.5). For â„“ = n2 the running time is
Oâˆ— (20.75n ) â‰¤ Oâˆ— (1.682n ). Similarly, p
we get a running time superior to the claimed one when
â„“ âˆˆ [(1 âˆ’ Îµ)n, n]. Note that h(x) â‰¤ âˆš
2 x(1 âˆ’ x), which means that the running time is bounded
n
n
by Oâˆ— (2 2 (h(1âˆ’Îµ)+(1âˆ’Îµ)) ) â‰¤ Oâˆ— (2 2 (1+2 Îµ) ) which is smaller than our running time for a suï¬ƒciently
small constant Îµ.
Finally, when â„“ âˆˆ [n/2, (1 âˆ’ Îµ)n] we upper bound the running time by the:
9

Oâˆ—



max

â„“âˆˆ[n/2,(1âˆ’Îµ)n)

oo
n
n n
.
min 2 2 (h(Î±)+Î±) , 2Î±n

The above expression is maximized when h(Î±) = Î±. By numeric calculations Î± < 0.77291, which
gives the ï¬nal running time Oâˆ— (2Î±n ) â‰¤ Oâˆ— (1.7088n ).

4

Polynomial Space Algorithm

The naive algorithm for Equal-Subset-Sum in polynomial space works in Oâˆ— (3n ) time. We are
given a set S. We guess a set A âŠ† S and then guess a set B âŠ† S \ A. Finally, we check if
Î£(A) = Î£(B). The running time is:
 

|S|
|S| âˆ’ |A|
âˆ—
O
â‰¤ Oâˆ— (3n ).
|A|
|B|
Known techniques for Subset-Sum allow us to get an algorithm running in Oâˆ— (21.5n ) and
polynomial space.

Theorem 4.1. There exists a Monte Carlo algorithm which solves Equal-Subset-Sum in polynomial space and Oâˆ— (21.5n ) â‰¤ Oâˆ— (2.8285n ) time. The algorithm assumes random read-only access
to exponentially many random bits.
A crucial ingredient of Theorem 4.1 is a nontrivial result for the Element Distinctness problem [6,
8]. In this problem, one is given read-only access to the elements of a list x âˆˆ [m]n and the task is
to ï¬nd two diï¬€erent elements of the same value. The problem can be naively solved in O(n2 ) time
e
and O(1) space by brute force. Also by sorting, we can solve Element Distinctness in O(n)
time
3/2
e
e
and O(n)
space. Beame et al. [8] showed that the problem can be solved in O(n
) randomized
e
time and O(1)
space. The algorithm assumes access to a random hash function f : [m] â†’ [n].

Proof of Theorem 4.1. We can guarantee random access to the list L = 2S of all subsets of the set
S = {a1 , . . . , an } on the ï¬‚y. Namely, for a pointer x âˆˆ {0, 1}n we can return an element of the list
L that corresponds to x in Oâˆ— (1) time by choosing elements ai for which xi = 1. More precisely:
L(x1 , . . . , xn ) = {ai | i âˆˆ [n], xi = 1}.
Now to decide Equal-Subset-Sum on set S we execute the Element Distinctness algorithm
on the list L of sums of subsets. The list has size 2n , hence the algorithm runs in Oâˆ— (21.5n ) time.
Element Distinctness uses only polylogarithmic space in the size of the input, hence our algorithm
uses polynomial space.
Quite unexpectedly we can still improve upon this algorithm.

4.1

Improved Polynomial Space Algorithm

In this section, we show an improved algorithm.
Theorem 4.2. There exists a Monte Carlo algorithm which solves Equal-Subset-Sum in polynomial space and time Oâˆ— (2.6817n ). The algorithm assumes random read-only access to exponentially
many random bits.

10

Similarly to the exponential space algorithm for Equal-Subset-Sum, we will combine two
algorithms. We start with a generalization of Theorem 4.1 parametrized by the size of the solution.
Lemma 4.3. Let S be a set of n positive integers, A, B âŠ† S be the solution to Equal-Subset-Sum
(denote a = |A| and b = |B|). There exists a Monte Carlo algorithm which solves Equal-SubsetSum in polynomial space and time
   1.5 !
n
n
âˆ—
O
.
+
a
b
The algorithm assumes random read-only access to exponentially many random bits.
Proof. The proof is just a repetition of the proof
of Theorem 4.1 for a ï¬xed sizes of solutions. Our

S
S
list L will consists of all subsets a and b . Then we run Element Distinctness algorithm, ï¬nd
any sets A, B âˆˆ L such that Î£(A) = Î£(B) and return A \ B, B \ A to make them disjoint.
e 1.5 ) and polylog(n)
The running time follows because Element Distinctness runs in time O(n
space.

Note that the runtime of Lemma 4.3 is maximized when |A| = |B| = n/2. The next algorithm
gives improvement in that case.
Lemma 4.4. Let S be a set of n positive integers, A, B âŠ† S be the solution to Equal-Subset-Sum
(denote a = |A| and b = |B|). There exists a Monte Carlo algorithm which solves Equal-SubsetSum in polynomial space and time

 
 

n 0.75(nâˆ’a) n 0.75(nâˆ’b)
âˆ—
O min
2
,
2
.
a
b
The algorithm assumes random read-only access to exponentially many random bits.

Proof of Lemma 4.4. Without loss of generality, we focus on the case a â‰¤ b. First we guess a
solution set A âŠ† S. We answer YES if we ï¬nd set B âŠ† S \ A such that Î£(A) = Î£(B) or ï¬nd two
disjoint subsets with equal sum in S \ A. We show that we can do it in Oâˆ— (20.75(|S\A|) ) time and
polynomial space which ï¬nishes the proof.
First, we arbitrarily partition set S \ A into two equally sized sets S1 and S2 . Then we create
a list L1 = [Î£(X) | X âŠ† S1 ] and list L2 = [Î£(A) âˆ’ Î£(X) | X âŠ† S2 ]. We do not construct them
explicitly because it would take exponential space. Instead we provide a read-only access to them
(with the counter technique). We run Element Distinctness on concatenation of L1 and L2 . If
element distinctness found x âˆˆ L1 and y âˆˆ L2 such that x = y, then we backtrack and look for
X âŠ† S1 , such that Î£(X) = x and Y âŠ† S2 , such that Î£(Y ) = Î£(A) âˆ’ y and return (A, X âˆª Y ) which
is a good solution, because Î£(Y ) + Î£(X) = Î£(A).
In the remaining case, i.e. when Element Distinctness ï¬nds a duplicate only in one of the lists
then, we get a feasible solution as well. Namely, assume that Element Distinctness ï¬nds x, y âˆˆ L1
such that x = y (the case when x, y âˆˆ L2 is analogous). Then we backtrack and look for two
corresponding sets X, Y âŠ† L1 such that X 6= Y and Î£(X) = Î£(Y ) = x. Finally we return
(X \ Y, Y \ X).
For the running time, note that the size of the list |L1 | = |L2 | = 20.5|S\A| . Hence Element
Distinctness runs in time Oâˆ— ((|L1 | + |L2 |)1.5 ) = Oâˆ— (20.75(nâˆ’a) ). The backtracking takes time
Oâˆ— (|L1 | + |L2 |) and polynomial space because we scan through all subsets of S1 and all subsets
of S2 and look for a set with sum equal to the known value.

11

Proof of Theorem 4.2. By trade-oï¬€ between Lemma 4.4 and Lemma 4.3 we get the following running
time:
(
(   
))!
 
1.5  
n
n
n
n
max
min
Oâˆ—
,
+
20.75(nâˆ’a) ,
20.75(nâˆ’b)
1â‰¤a,bâ‰¤n
a
a
b
b
By symmetry this expression is maximized when a = b. Now we will write the exponents by
using entropy function (let a = Î±n):

oo
n
n
âˆ—
1.5h(Î±)n (h(Î±)+0.75(1âˆ’Î±))n
O
,2
max min 2
Î±âˆˆ[0,1]

The expression is maximized when 1.5h(Î±) = h(Î±) + 0.75(1 âˆ’ Î±), By numerical computations
Î± < 0.36751, which means that the running time is Oâˆ— (21.42312n ) â‰¤ Oâˆ— (2.6817n ).

5

Conclusion and Open Problems

In this paper, we break two natural barriers for Equal-Subset-Sum: we propose an improvement
upon the meet-in-the-middle algorithm and upon the polynomial space algorithm. Our techniques
have additional applications in the problem of ï¬nding collision of hash function in cryptography
and the number balancing problem (see Appendix E).
We believe that our algorithms can potentially be improved with more involved techniques.
However, getting close to the running time of Subset-Sum seems ambitious. In Appendix B we
show that a faster algorithm than Oâˆ— (1.1893n ) for Equal-Subset-Sum would yield a faster than
Oâˆ— (2n/2 ) algorithm for Subset-Sum. It is quite far from our bound Oâˆ— (1.7088n ). The main open
problem is therefore to close the gap between upper and lower bounds for Equal-Subset-Sum.

6

Acknowledgment

The authors would like to thank anonymous reviewers for their remarks and suggestions. This
research has been initiated during Parameterized Algorithms Retreat of University of Warsaw 2019,
Karpacz, 25.02-01.03.2019.

References
[1] A. Abboud, K. Bringmann, D. Hermelin, and D. Shabtay. Seth-based lower bounds for subset
sum and bicriteria path. In T. M. Chan, editor, Proceedings of the Thirtieth Annual ACMSIAM Symposium on Discrete Algorithms, SODA 2019, San Diego, California, USA, January
6-9, 2019, pages 41â€“57. SIAM, 2019.
[2] P. Austrin, P. Kaski, M. Koivisto, and J. MÃ¤Ã¤ttÃ¤. Space-time tradeoï¬€s for subset sum: An
improved worst case algorithm. In F. V. Fomin, R. Freivalds, M. Z. Kwiatkowska, and D. Peleg, editors, Automata, Languages, and Programming - 40th International Colloquium, ICALP
2013, Riga, Latvia, July 8-12, 2013, Proceedings, Part I, volume 7965 of Lecture Notes in
Computer Science, pages 45â€“56. Springer, 2013.

12

[3] P. Austrin, P. Kaski, M. Koivisto, and J. Nederlof. Subset sum in the absence of concentration.
In E. W. Mayr and N. Ollinger, editors, 32nd International Symposium on Theoretical Aspects
of Computer Science, STACS 2015, March 4-7, 2015, Garching, Germany, volume 30 of LIPIcs,
pages 48â€“61. Schloss Dagstuhl - Leibniz-Zentrum fuer Informatik, 2015.
[4] P. Austrin, P. Kaski, M. Koivisto, and J. Nederlof. Dense subset sum may be the hardest.
In N. Ollinger and H. Vollmer, editors, 33rd Symposium on Theoretical Aspects of Computer
Science, STACS 2016, February 17-20, 2016, OrlÃ©ans, France, volume 47 of LIPIcs, pages
13:1â€“13:14. Schloss Dagstuhl - Leibniz-Zentrum fuer Informatik, 2016.
[5] F. Ban, K. Jain, C. H. Papadimitriou, C. Psomas, and A. Rubinstein. Reductions in PPP. Inf.
Process. Lett., 145:48â€“52, 2019.
[6] N. Bansal, S. Garg, J. Nederlof, and N. Vyas. Faster space-eï¬ƒcient algorithms for subset sum
and k-sum. In H. Hatami, P. McKenzie, and V. King, editors, Proceedings of the 49th Annual
ACM SIGACT Symposium on Theory of Computing, STOC 2017, Montreal, QC, Canada,
June 19-23, 2017, pages 198â€“209. ACM, 2017.
[7] C. Bazgan, M. Santha, and Zs. Tuza. Eï¬ƒcient approximation algorithms for the subset-sums
equality problem. In International Colloquium on Automata, Languages, and Programming,
pages 387â€“396. Springer, 1998.
[8] P. Beame, R. Cliï¬€ord, and W. Machmouchi. Element distinctness, frequency moments, and
sliding windows. In 54th Annual IEEE Symposium on Foundations of Computer Science, FOCS
2013, 26-29 October, 2013, Berkeley, CA, USA, pages 290â€“299. IEEE Computer Society, 2013.
[9] A. Becker, J. Coron, and A. Joux. Improved generic algorithms for hard knapsacks. In K. G.
Paterson, editor, Advances in Cryptology - EUROCRYPT 2011 - 30th Annual International
Conference on the Theory and Applications of Cryptographic Techniques, Tallinn, Estonia,
May 15-19, 2011. Proceedings, volume 6632 of Lecture Notes in Computer Science, pages 364â€“
385. Springer, 2011.
[10] T. Bohman. A sum packing problem of ErdÅ‘s and the Conway-Guy sequence. Proceedings of
the American Mathematical Society, 124(12):3627â€“3636, 1996.
[11] K. Bringmann. A near-linear pseudopolynomial time algorithm for subset sum. In Proceedings
of the Twenty-Eighth Annual ACM-SIAM Symposium on Discrete Algorithms, SODA â€™17, pages
1073â€“1084, Philadelphia, PA, USA, 2017. Society for Industrial and Applied Mathematics.
[12] M. Cieliebak. Algorithms and hardness results for DNA physical mapping, protein identification,
and related combinatorial problems. PhD thesis, ETH ZÃ¼rich, 2003.
[13] M. Cieliebak, S. Eidenbenz, and A. Pagourtzis. Composing equipotent teams. In International
Symposium on Fundamentals of Computation Theory, pages 98â€“108. Springer, 2003.
[14] M. Cieliebak, S. Eidenbenz, and P. Penna. Noisy data make the partial digest problem np-hard.
In International Workshop on Algorithms in Bioinformatics, pages 111â€“123. Springer, 2003.
[15] M. Cieliebak, S. Eidenbenz, A. Pagourtzis, and K. Schlude. On the complexity of variations of
equal sum subsets. Nord. J. Comput., 14(3):151â€“172, 2008.
[16] J. H. Conway and R. K. Guy. Sets of natural numbers with distinct subset sums. Notices
Amer. Math. Soc, 15:345, 1968.
13

[17] M. J. Coster, A. Joux, B. A. LaMacchia, A. M. Odlyzko, C. Schnorr, and J. Stern. Improved
low-density subset sum algorithms. Computational Complexity, 2:111â€“128, 1992.
[18] M. Cygan, H. Dell, D. Lokshtanov, D. Marx, J. Nederlof, Y. Okamoto, R. Paturi, S. Saurabh,
and M. WahlstrÃ¶m. On problems as hard as CNF-SAT. In Proceedings of the 27th Conference
on Computational Complexity, CCC 2012, Porto, Portugal, June 26-29, 2012, pages 74â€“84.
IEEE Computer Society, 2012.
[19] P. ErdÅ‘s. Problems and results in additive number theory. Journal London Wash. Soc, 16:
212â€“215, 1941.
[20] P. ErdÅ‘s. A survey of problems in combinatorial number theory. Annals of Discrete Mathematics, 6:89â€“115, 1980.
[21] G. H. Hardy, E. M. Wright, et al. An introduction to the theory of numbers. Oxford university
press, 1979.
[22] D. Harnik and M. Naor. On the compressibility of NP instances and cryptographic applications.
SIAM J. Comput., 39(5):1667â€“1713, 2010.
[23] R. Hoberg, H. Ramadas, T. Rothvoss, and X. Yang. Number balancing is as hard as Minkowskiâ€™s
theorem and shortest vector. 10328:254â€“266, 2017.
[24] E. Horowitz and S. Sahni. Computing partitions with applications to the knapsack problem.
J. ACM, 21(2):277â€“292, 1974.
[25] N. Howgrave-Graham and A. Joux. New generic algorithms for hard knapsacks. In H. Gilbert,
editor, Advances in Cryptology - EUROCRYPT 2010, 29th Annual International Conference on
the Theory and Applications of Cryptographic Techniques, Monaco / French Riviera, May 30 June 3, 2010. Proceedings, volume 6110 of Lecture Notes in Computer Science, pages 235â€“256.
Springer, 2010.
[26] R. Impagliazzo and M. Naor. Eï¬ƒcient cryptographic schemes provably as secure as subset sum.
J. Cryptology, 9(4):199â€“216, 1996.
[27] C. Jin and H. Wu. A simple near-linear pseudopolynomial time randomized algorithm for
subset sum. In J. T. Fineman and M. Mitzenmacher, editors, 2nd Symposium on Simplicity
in Algorithms, SOSA@SODA 2019, January 8-9, 2019 - San Diego, CA, USA, volume 69 of
OASICS, pages 17:1â€“17:6. Schloss Dagstuhl - Leibniz-Zentrum fuer Informatik, 2019.
[28] N. Karmarkar and R. M. Karp. An eï¬ƒcient approximation scheme for the one-dimensional binpacking problem. In 23rd Annual Symposium on Foundations of Computer Science, Chicago,
Illinois, USA, 3-5 November 1982, pages 312â€“320. IEEE Computer Society, 1982.
[29] K. Koiliaris and C. Xu. A faster pseudopolynomial time algorithm for subset sum. In Proceedings of the Twenty-Eighth Annual ACM-SIAM Symposium on Discrete Algorithms, SODA â€™17,
pages 1062â€“1072, Philadelphia, PA, USA, 2017. Society for Industrial and Applied Mathematics.
[30] K. Koiliaris and C. Xu. Subset sum made simple. CoRR, abs/1807.08248, 2018.
[31] J. C. Lagarias and A. M. Odlyzko. Solving low-density subset sum problems. J. ACM, 32(1):
229â€“246, 1985.
14

[32] D. Lokshtanov and J. Nederlof. Saving space by algebraization. In L. J. Schulman, editor,
Proceedings of the 42nd ACM Symposium on Theory of Computing, STOC 2010, Cambridge,
Massachusetts, USA, 5-8 June 2010, pages 321â€“330. ACM, 2010.
[33] W. F. Lunnon. Integer sets with distinct subset-sums. Mathematics of Computation, 50(181):
297â€“320, 1988.
[34] R. C. Merkle and M. E. Hellman. Hiding information and signatures in trapdoor knapsacks.
IEEE Trans. Information Theory, 24(5):525â€“530, 1978.
[35] J. Nederlof, E. J. van Leeuwen, and R. van der Zwaan. Reducing a target interval to a few
exact queries. In B. Rovan, V. Sassone, and P. Widmayer, editors, Mathematical Foundations
of Computer Science 2012 - 37th International Symposium, MFCS 2012, Bratislava, Slovakia,
August 27-31, 2012. Proceedings, volume 7464 of Lecture Notes in Computer Science, pages
718â€“727. Springer, 2012.
[36] C. H. Papadimitriou. On the complexity of the parity argument and other ineï¬ƒcient proofs of
existence. J. Comput. Syst. Sci., 48(3):498â€“532, 1994.
[37] H. Robbins. A remark on Stirlingâ€™s formula. The American mathematical monthly, 62(1):26â€“29,
1955.
[38] R. Schroeppel and A. Shamir. A t=o(2n/2 ), s=o(2n/4 ) algorithm for certain np-complete
problems. SIAM J. Comput., 10(3):456â€“464, 1981.
[39] A. Shamir. A polynomial-time algorithm for breaking the basic merkle-hellman cryptosystem.
IEEE Trans. Information Theory, 30(5):699â€“704, 1984.
[40] K. Sotiraki, M. Zampetakis, and G. Zirdelis. Ppp-completeness with connections to cryptography. In M. Thorup, editor, 59th IEEE Annual Symposium on Foundations of Computer Science,
FOCS 2018, Paris, France, October 7-9, 2018, pages 148â€“158. IEEE Computer Society, 2018.
[41] D. A. Wagner. A generalized birthday problem. In M. Yung, editor, Advances in Cryptology CRYPTO 2002, 22nd Annual International Cryptology Conference, Santa Barbara, California,
USA, August 18-22, 2002, Proceedings, volume 2442 of Lecture Notes in Computer Science,
pages 288â€“303. Springer, 2002.
[42] G. J. Woeginger. Space and time complexity of exact algorithms: Some open problems (invited
talk). In R. G. Downey, M. R. Fellows, and F. K. H. A. Dehne, editors, Parameterized and
Exact Computation, First International Workshop, IWPEC 2004, Bergen, Norway, September
14-17, 2004, Proceedings, volume 3162 of Lecture Notes in Computer Science, pages 281â€“290.
Springer, 2004.
[43] G. J. Woeginger. Open problems around exact algorithms. Discrete Applied Mathematics, 156
(3):397â€“405, 2008.
[44] G. J. Woeginger and Z. Yu. On the equal-subset-sum problem. Inf. Process. Lett., 42(6):
299â€“302, 1992.

15

A

Preprocessing and Randomized Compression for Equal-SubsetSum

We will repeat the arguments from [22]. Similar arguments are also present in [3, 4].
Theorem A.1. Given set S of n integers a1 , . . . , an âˆˆ {âˆ’2m , . . . , 2m } (with m â‰« n). In O(poly(n, m))
time we can construct a set S â€² that consists of n positive integers in {1, . . . , 28n } such that:
âˆƒX, Y âŠ† S, such that Î£(X) = Î£(Y ) iff âˆƒX â€² , Y â€² âŠ† S â€² such that Î£(X â€² ) = Î£(Y â€² )

with probability at least 1âˆ’2âˆ’n or we will solve Equal-Subset-Sum on that instance in polynomial
time.
Proof. If 0 âˆˆ S, then we immediately answer YES, because sets A = {0} and B = âˆ… are a proper
solution to Equal-Subset-Sum. If m â‰¥ 2n , then the algorithm running in time O(m4n ) â‰¥ O(m3 )
runs in polynomial time of the instance size. Hence we can assume that m < 2n and 0 âˆˆ
/ S.
7n
8n
Pick a random prime p âˆˆ [2 , 2 ]. We will transform our original instance S into an instance
S â€² in the following way:
aâ€²i â‰¡ ai (mod p)

for all i âˆˆ [n]. In particular it means that all numbers in S â€² are positive and smaller than 28n .
Observe, that if there is a solution for Equal-Subset-Sum on instance S, then the same set of
indices is also a solution for Equal-Subset-Sum on instance S â€² . On the other hand, we want to
show that if an answer to Equal-Subset-Sum on original instance S was NO, then for all pairs of
subsets A, B âŠ† S â€² it will hold that Î£(A) P
6= Î£(B). P
P
P
â€²
â€²
For some I, J âŠ† [n], in order
iâˆˆI ai =
jâˆˆJ aj , while
iâˆˆI ai 6=
jâˆˆJ aj , it must be
Pto get P
that p is a divisor of D(I, J) = iâˆˆI ai âˆ’ jâˆˆJ aj . We will call such prime numbers bad.
There are 22n possible pairs of I, J âŠ† [n]. For a ï¬xed I, J âŠ† [n] there are at most log (n2m ) bad
primes (because D(I, J) â‰¤ n2m ). Hence there are at most:
22n log (n2m ) â‰¤ 22n (m + log n) â‰¤ 24n
possible bad primes. By Lemma 2.1, the prime number p is taken from the range containing at
least 27n primes. Therefore, for every I, J âŠ† [n] it holds that:
ï£®
ï£¹
X
X
Pp ï£°
aâ€²i =
aâ€²j ï£» â‰¤ 2âˆ’3n .
iâˆˆI

jâˆˆJ

By talking union bound over all possible 22n pairs of I, J âŠ† [n] the probability of error is bounded
by 2âˆ’n .

What is left to prove, is that we can assume, that n is divisible by 12. By the above Lemma we
know that S consists of only positive numbers. Let M be Î£(S) + 1. Observe that we can always
add numbers from set Z = {M, 2M, 4M, 8M . . . , } and the answer to Equal-Subset-Sum on the
modiï¬ed instance will not change because numbers in Z always have a diï¬€erent sum. Moreover,
none of the subset of S can be used with numbers from Z, because Î£(S) < M . Hence we can always
guarantee that n is divisible by 12 by adding appropriate amount of numbers from Z. Namely, note
that if n â‰¡ k (mod 12), for some k 6= 0, then we can add k numbers to the original instance S and
the answer to the Equal-Subset-Sum will not change.
16

B

Sharper Reduction from Subset-Sum

In this section, we show a direct reduction from Subset-Sum. As far as we know, it is slightly
sharper than currently known reduction [44] (in terms of constants in the exponent).
Theorem B.1. If Equal-Subset-Sum can be solved in time Oâˆ— ((2 âˆ’ Îµ)0.25n ) for some Îµ > 0 then
Subset-Sum can be solved in time Oâˆ— ((2 âˆ’ Îµâ€² )0.5n ) for some constant Îµâ€² > 0.
Proof. Assume that we have a black-box access to the algorithm for Equal-Subset-Sum running
in time Oâˆ— ((2 âˆ’ Îµ)0.25n ) for some Îµ > 0. We will show how to use it to get an algorithm for
Subset-Sum running in time Oâˆ— ((2 âˆ’ Îµ)0.5n ).
Given an instance S, t of Subset-Sum such that S = {a1 , . . . , an }, we will construct an equivalent instance S â€² of Equal-Subset-Sum such that S â€² = {s1 , . . . , s2n+1 }. Note, that for the running
time this will be enough. The construction is as follows:
â€¢ for 1 â‰¤ i â‰¤ n, let si = ai Â· 10n+1 + 2 Â· 10i ,
â€¢ for 1 â‰¤ i â‰¤ n, let si+n = 1 Â· 10i ,
P
â€¢ let s2n+1 = t Â· 10n+1 + ni=1 1 Â· 10i .

First let us prove that if (S, t) is a YES instance of Subset-Sum
then S â€² is a YES instance
P
for Equal-Subset-Sum. Namely let X âŠ† [n], such that iâˆˆX ai = t. Then, sets A = {si | i âˆˆ
X} âˆª {si+n | i âˆˆ
/ X} andP
B = {si+n
P | i âˆˆ X} âˆª {s2n+1 } are a good solution to Equal-Subset-Sum
on instance S â€² , because (A) = (B) and A âˆ© B = âˆ….
Now for other direction, we will prove that if S â€² is a YES instance of Equal-Subset-Sum then
(S, t) is a YES instance of Subset-Sum. Assume that S â€² is a YES instance and a pair A, B âŠ† S â€²
is a correct solution. Observe that if for some i â‰¤ n element si âˆˆ A then s2n+1 âˆˆ B. It is because
the sets A, B have an equal sum and only elements si , si+n , s2n+1 have something nonzero at the
i-th decimal place. Moreover all smaller decimal places of all numbers sum up to something smaller
than 10i and therefore cannot interfere with the place 10i .
Finally observe, that numbers si+n for i âˆˆ [n] cannot produce a YES instance on their own.
Hence sets A âˆª B contain at least one number si for i âˆˆ [n]. WLOG let A be the set that contains
such an si . ThenP
set B has to contain
s2n+1 . It means that set B cannot contain any siPfor i âˆˆ [n].
P
In particular (A)/10n+1 = (B)/10n+1
si for i âˆˆ [n] contribute to (A)/10n+1
P. Only numbers
n+1 . Hence there exists a subset Z âŠ† S, such
and only
P number s2n+1 contributes to the (B)/10
that (Z) = t.

C

Folklore Equal-Subset-Sum by 4-SUM with better memory

Theorem C.1. Equal-Subset-Sum can be solved in deterministic Oâˆ— (3n/2 ) time and Oâˆ— (3n/4 )
space.
Proof. First, we arbitrarily partition S into S1 = {a1 , . . . , an/4 }, S2 = {an/4+1 , . . . , an/2 } S3 =
{an/2+1 , . . . , a3n/4 } and S4 = {a3n/4+1 , . . . , an }. Denote the vectors that correspond to these sets
by a1 , . . . , a4 âˆˆ Zn/4 , i.e.,
ai = (a(iâˆ’1)n/4+1 , a(iâˆ’1)n/4+2 , . . . , ain/4 ) for i âˆˆ {1, 2, 3, 4}.
Recall that in Equal-Subset-Sum we were looking for two subsets A, B âŠ† S, such that Aâˆ©B =
âˆ… and Î£(A) = Î£(B). We can split the solution to 8 subsets:
17

Ai := Si âˆ© A and Bi := Si âˆ© B for i âˆˆ {1, 2, 3, 4}.
Then, the equation for the solution is:
Î£(A1 ) + Î£(A2 ) + Î£(A3 ) + Î£(A4 ) = Î£(B1 ) + Î£(B2 ) + Î£(B3 ) + Î£(B4 ).
We can rewrite it as:
(Î£(A1 ) âˆ’ Î£(B1 )) + (Î£(A2 ) âˆ’ Î£(B2 )) + (Î£(A3 ) âˆ’ Î£(B3 )) + (Î£(A4 ) âˆ’ Î£(B4 )) = 0
Observe, that by deï¬nition Ai âˆ© Bi = âˆ… for all i âˆˆ {1, 2, 3, 4}. So the problem reduces to ï¬nding
4 vectors x1 , x2 , x3 , x4 âˆˆ {âˆ’1, 0, 1}n/4 , such that:
a1 Â· x1 + a2 Â· x2 + a3 Â· x3 + a4 Â· x4 = 0.

(2)

because a term Î£(Ai ) âˆ’ Î£(Bi ) corresponds to ai Â· xi (1â€™s from xi correspond to the elements of
Ai and âˆ’1â€™s from xi correspond to the elements of Bi ).
Now, the algorithm is as follows. First enumerate all possible values of ai Â·xi for all i âˆˆ {1, 2, 3, 4}
and store them in a table Ti . Along the way of value of ai Â· xi we store corresponding vector
x. Note, that |Ti | = Oâˆ— (3n/4 ). Now run 4-SUM on input tables Ti for i âˆˆ {1, 2, 3, 4}, ï¬nd xi
such that Equation (2) is satisï¬ed. Then we ï¬nd the corresponding sets Ai and Bi and return
(A1 âˆª A2 âˆª A3 âˆª A4 , B1 âˆª B2 âˆª B3 âˆª B4 ). The 4-SUM ï¬nds vectors that sum to 0 from 4 diï¬€erent
input sets. Because we enumerated all possibilities the correctness follows.
e 2 ) time and O(|I|)
e
4-SUM runs in O(|I|
space where |I| is the size of the input instance. In our
âˆ—
n/4
case |I| = O (3 ) and the running time and space complexity of the algorithm follows.

D

Time-Space Tradeoff for Equal-Subset-Sum

Schroeppel and Shamir [38] gave a time-space tradeoï¬€ for Subset-Sum, such that T S 2 â‰¤ Oâˆ— (2n )
where T is a running time and S is the space of the algorithm for Subset-Sum and S â‰¤ Oâˆ— (2n/4 ).
In this section we observe that similar relation is true for Equal-Subset-Sum:
Theorem D.1. For all S â‰¤ Oâˆ— (3n/4 ), Equal-Subset-Sum can be solved in space S and time
n
T â‰¤ Oâˆ— ( S3 2 ).
Proof. Let S be the input instance of Equal-Subset-Sum and Î² âˆˆ [0, 1] be our trade-oï¬€ parameter.
By A, B we will denote a solution to Equal-Subset-Sum, i.e., Î£(A) = Î£(B) and A âˆ© B = âˆ….
Intuitively, for Î² = 1 we will use a polyspace algorithm running in time Oâˆ— (3n ) and for Î² = 0
we will use a meet in the middle algorithm running in Oâˆ— (3n/2 time and Oâˆ— (3n/4 ) space. First we
arbitrarily choose a set X of Î²n elements of S. Then we guess set A âˆ© X and set B âˆ© X. Finally
we execute Equal-Subset-Sum meet-in-the-middle algorithm for an instance (S \ X) âˆª {Î£(A âˆ©
X), Î£(B âˆ© X)} of n(1 âˆ’ Î²) + 2 elements. The correctness follows because we checked all possible
splits of X into sets A and B and put them into the solution. We did not increase possible solutions
hence if the answer to Equal-Subset-Sum was NO then we will always answer NO. Similarly if
the answer was YES, and the sets A, B âŠ† S are a good solution, then for correctly guess A âˆ© X and
B âˆ© X the constructed instance is a YES instance.
The algorithm runs in time T (n, Î²) = Oâˆ— (3Î²n Â· T (n(1 âˆ’ Î²)) â‰¤ Oâˆ— (3Î²n 3(1âˆ’Î²)n/2 ) and space
S(n, Î²) = Oâˆ— (S((1 âˆ’ Î²)n) â‰¤ Oâˆ— (3(1âˆ’Î²)n/4 ) (see Appendix C). It follows that:
T (n, Î²)S(n, Î²)2 â‰¤ Oâˆ— (3n )
18

Which gives us the ï¬nal time-space tradeoï¬€.

E

Exact algorithm for Number Balancing

Recall, that in the Number Balancing problem you are given n real numbers
an âˆˆ [0, 1].
P a1 , . . . , P
The task is to ï¬nd two disjoint subsets I, J âŠ† [n], such that the diï¬€erence | iâˆˆI ai âˆ’ jâˆˆJ aj | is
minimized. In this Section we show that our techniques transfer to the exact algorithm for Number
Balancing. To alleviate problems with the deï¬nition of the computational model for real numbers,
we will be solving the following problem:
Definition E.1 (Integer Number Balancing). In the Integer Number Balancing problem, we are
given a set S of n integers a1 , . . . , an âˆˆ {0, . . . , 2O(n) }. The task is to find two disjoint subsets
P
P
I, J âŠ† [n], such that the difference
iâˆˆI ai âˆ’
jâˆˆJ aj is minimized.

Note, that Karmarkar and Karp [28] deï¬ned Number Balancing for reals because they were
interested in approximation algorithms. For our purposes it is convenient to assume that numbers
are given as integers bounded by 2O(n) . For unbounded integers, some additional factors due to the
arithmetic operations may occur.
Theorem E.2. Integer Number Balancing can be solved in Oâˆ— (1.7088n ) time with high probability.
It is convenient to work with the following decision version of the problem:

Definition E.3 (Integer Number Balancing, decision version). In the decision version of Integer
Number Balancing, we are given a set S of n integers a1 , . . . , an âˆˆ {0, . . . , 2O(n) } and integer Îº. The
P
P
task is decide if there exist two disjoint subsets I, J âŠ† [n], such that
iâˆˆI ai âˆ’
jâˆˆJ aj âˆˆ [0, Îº].
The above decision version and minimization version are equivalent up to polynomial factors:
we use a binary search to for the smallest Îº, for which answer to the decision version of Integer
Number Balancing is YES. The target Îº âˆˆ [0, 2O(n) ] so we need at most polynomial number of calls
to the oracle.

E.1

Proof of Theorem E.2

First we observe, that our techniques also work for the generalization of Equal-Subset-Sum.
Definition E.4 (Target Equal-Subset-Sum problem). In the Target Equal-Subset-Sum problem, we are given a set S of n integers and integer Îº. The task is to decide if there exist two disjoint
nonempty subsets A, B âŠ† S, such that |Î£(A) âˆ’ Î£(B)| = Îº.
Theorem E.5. Target Equal-Subset-Sum problem in Oâˆ— (1.7088n ) time with high probability.
We give a sketch of the proof in Section E.2.
Now, we use an algorithm for Target Equal-Subset-Sum to give an algorithm for Integer
Number Balancing. The observation is that decision version of Integer Number Balancing (see
Deï¬nition E.3) asks if there exist two subsets X, Y âŠ† S such that |Î£(X) âˆ’ Î£(Y )| âˆˆ [0, Îº]. However
Theorem E.5 gives us an access to the oracle that determines if there exist two subsets X, Y âŠ† S,
such that |Î£(X) âˆ’ Î£(Y )| = Îº. The following Lemma gives us tool for such a reduction:

19

Lemma E.6 (Shrinking Intervals, Theorem 1 from [35]). Let U be a set of cardinality n, let Ï‰ :
U â†’ {âˆ’W, . . . , W } be a weight function, and let l < u be integers with u âˆ’ l > 1. Then, there is
a polynomial-time algorithm that returns a set of pairs â„¦ = {(Ï‰1 , v1 ), . . . , (Ï‰T , vT )} with Ï‰i : U â†’
{âˆ’W, . . . , W } and integers v1 , . . . , vT âˆˆ {âˆ’W, . . . , W }, such that:
â€¢ T is at most O(n log (u âˆ’ l)), and:
â€¢ for every set X âŠ† U it holds that Ï‰(X) âˆˆ [l, u] if and only if there exist an index i âˆˆ [T ] such
that Ï‰i (X) = vi .
Note, that the corresponding Theorem in [35] was stated for weight function Ï‰ : U â†’ {0, . . . , W }.
However, the proof in [35] does not need that assumption. For clarity, in [35] weight functions
Ï‰
Pi : U â†’ {âˆ’W, . . . , W } are of the following form: for set X âŠ† U the function is always Ï‰i (X) =
xâˆˆX wx for some weights wi âˆˆ Z.
With Lemma E.6 in hand we can now prove Theorem E.2.
Proof of Theorem E.2. Let S be the set of n integers {a1 , . . . , an } as in Deï¬nition E.3 and a target
Îº. Let U = {âˆ’n, . . . , âˆ’1} âˆª {1, . . . , n}. For z âˆˆ Z, let sgn(z) be sign function, i.e., sgn(z) = âˆ’1
when
z < 0, sgn(0) = 0 and sgn(z) = 1 when z > 0. Moreover, for any X âŠ† U let Ï‰(X) =
P
xâˆˆX sgn(x)a|x| .
We are given black-box access to the Theorem E.5, i.e., for a given set S â€² of integers we can decide
if there exist two subsets X, Y âŠ† S â€² , such that |Î£(X) âˆ’ Î£(Y )| = Îº in time Oâˆ— (1.7088n ). We show
that we can solve Integer Number Balancing by using polynomial number of calls to Theorem E.5.
First, observe that universe set U and the weight function Ï‰(X) satisfy the conditions of
Lemma E.6. Moreover, let u = Îº and l = âˆ’Îº. Lemma E.6 works in polynomial time and outputs pairs P = {(Ï‰1 , v1 ), . . . , (Ï‰T , vT )}. Now, the answer to the decision version of Integer Number
Balancing on S is YES iï¬€ there exists index i âˆˆ [T ] such that an answer to Target Equal-SubsetSum on instance (Ï‰i , vi ) is YES by Lemma E.6.
For the running time observe, that the numbers are bounded by 2O(n) , so T = O(poly(n)).
Hence, we execute polynomial number of calls to Theorem E.5 and the running time follows.

E.2

Proof of Theorem E.5

What is left is to sketch that our techniques also apply to a more general version of the problem.
We are given a set S of n integers and a target Îº. We need to ï¬nd X, Y âŠ† S, such that
Î£(X) âˆ’ Î£(Y ) = Îº. First of all the deï¬nition of minimum solution for a target easily generalizes,
i.e., we say that a solution A, B âŠ† S such that Î£(A) âˆ’ Î£(B) = Îº is a minimum solution if its size
|A| + |B| is smallest possible.
Note, that the meet-in-the-middle algorithm for Equal-Subset-Sum works for Target EqualSubset-Sum (see Theorem 3.3 and Algorithm 1). The only diï¬€erence is that in Algorithm 1, we
need to determine if there exist x1 âˆˆ C1 , x2 âˆˆ C2 such that x1 + x2 = Îº. The running time and
analysis is exactly the same in that case.
The main diï¬€erence comes in the analysis of balanced case, i.e., Theorem 3.4. In that case we
need to enumerate two sets Ct,p and Ctâˆ’Îº,p (see Algorithm 3)
What is left is to show, that Algorithm 3 has the running time Oâˆ— (2â„“ ) and ï¬nds a solution to
Target Equal-Subset-Sum with probability â„¦(1/poly(n)). The rest of the proof and analysis is
exactly the same as the proof of Theorem 3.4.
For the running time, note that E [|C1 |] â‰¤ Oâˆ— (2â„“ ) and E [|C2 |] â‰¤ Oâˆ— (2â„“ ) because these sets are
chosen in exactly the same way as set C in Lemma 3.7. Moreover, we can enumerate both of them
20

Algorithm 3 BalancedEqualSubsetSumTarget(a1 , . . . , an , â„“, Îº)
1:
2:
3:
4:
5:
6:
7:

Pick a random prime p in [2nâˆ’â„“ , 2nâˆ’â„“+1 ]
Pick a random number t âˆˆ [1, 2nâˆ’â„“ ]
Let C1 = {X âŠ† S | Î£(X) â‰¡p t}
Let C2 = {X âŠ† S | Î£(X) â‰¡p t âˆ’ Îº}
Enumerate and store all elements of C1 and C2
Find X âˆˆ C1 and Y âˆˆ C2 , such that Î£(X) âˆ’ Î£(Y ) = Îº
return (X \ Y, Y \ X)

âŠ² In time Oâˆ— (|C1 | + |C2 | + 2n/2 )
âŠ² In time Oâˆ— (|C1 | + |C2 |)

in time Oâˆ— (|C1 | + |C2 | + 2n/2 ) â‰¤ Oâˆ— (2â„“ ) by using Lemma 3.8 (recall that â„“ > n/2). Finally we can
ï¬nd X âˆˆ C1 and Y âˆˆ C2 , such that Î£(X) âˆ’ Î£(Y ) = Îº (if such X, Y exist) in time Oâˆ— (2â„“ ) by solving
2SUM. Hence, the running time of Algorithm 3 is Oâˆ— (2â„“ ).
For the correctness, observe that an analog of Lemma 3.5 holds:
Lemma E.7. Let S be a set of n positive integers with minimum solution size of â„“. Let
Î¨ = {Î£(X) | âˆƒY âŠ† S such that X 6= Y and Î£(X) âˆ’ Î£(Y ) = Îº} .

(3)

If â„“ > n2 , then |Î¨| â‰¥ 2nâˆ’â„“ (note that all elements in Î¨ are different).

Proof of Lemma E.7. Similarly to the proof of Lemma E.7 we assume, that there exist A, B âŠ† S,
such that Aâˆ©B = âˆ…, |A|+|B| = â„“ and Î£(A)âˆ’Î£(B) = t. Then we construct our set Î¨ be considering
every subset Z âŠ† S \ (A âˆª B) and observing that:
â€¢ Î£(A âˆª Z) âˆ’ Î£(B âˆª Z) = Îº, and
â€¢ there are 2nâˆ’â„“ possible choices of set Z, and
â€¢ by the minimality of A, B all sets Z have a diï¬€erent sum.

And with that Lemma in hand we can prove the analogous to Lemma 3.6.
Lemma E.8. Let S be the set of n positive integers bounded by 2O(n) with minimum solution A, B,
Î£(A) âˆ’ Î£(B) = Îº of size â„“ and â„“ > n2 . For a random prime p âˆˆ [2nâˆ’â„“ , 2nâˆ’â„“+1 ] and a random
t âˆˆ [1, 2nâˆ’â„“ ] let Ct,p = {X âŠ† S | Î£(X) â‰¡p t }. Then,
i
h
Pt,p âˆƒX âŠ† Ct,p , Y âŠ† Ctâˆ’Îº,p Î£(X) âˆ’ Î£(Y ) = Îº, X 6= Y â‰¥ â„¦(1/n2 ).

Proof of Lemma E.8. Recall Î¨ from Lemma E.7. Note, that it is suï¬ƒcient to show that there exist
an element a âˆˆ Î¨, such that a â‰¡p t with constant probability. Namely, if that is true, then a âˆˆ Ct,p
and by the deï¬nition of Î¨, there exists set B âŠ† S, such that a âˆ’ Î£(B) = Îº. Hence, Î£(B) âˆˆ Ctâˆ’Îº,p
and the claim follows.
The rest of the proof, i.e., showing that a â‰¡p t with constant probability is analogous to the
proof of Lemma 3.6.
With that in hand the correctness is analogous to the proof of correctness of Theorem 3.4.

21

