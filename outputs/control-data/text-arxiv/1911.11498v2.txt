Astronomy & Astrophysics manuscript no. main
October 28, 2020

Â©ESO 2020

Collapse of spherical overdensities in superfluid models of dark
matter
S. T. H. Hartman, H. A. Winther, and D. F. Mota
Institute of Theoretical Astrophysics, University of Oslo, PO Box 1029, Blindern 0315, Oslo, Norway
Received ; accepted

arXiv:1911.11498v2 [astro-ph.CO] 27 Oct 2020

ABSTRACT
Aims. We intend to understand cosmological structure formation within the framework of superfluid models of dark matter with finite

temperatures. Of particular interest is the evolution of small-scale structures where the pressure and superfluid properties of the dark
matter fluid are prominent. We compare the growth of structures in these models with the standard cold dark matter paradigm and
non-superfluid dark matter.
Methods. The equations for superfluid hydrodynamics were computed numerically in an expanding Î›CDM background with spherical symmetry; the effect of various superfluid fractions, temperatures, interactions, and masses on the collapse of structures was taken
into consideration. We derived the linear perturbation of the superfluid equations, giving further insights into the dynamics of the
superfluid collapse.
Results. We found that while a conventional dark matter fluid with self-interactions and finite temperatures experiences a suppression
in the growth of structures on smaller scales, as expected due to the presence of pressure terms, a superfluid can collapse much more
efficiently than was naively expected due to its ability to suppress the growth of entropy perturbations and thus gradients in the thermal
pressure. We also found that the cores of the dark matter halos initially become more superfluid during the collapse, but eventually
reach a point where the superfluid fraction falls sharply. The formation of superfluid dark matter halos surrounded by a normal fluid
dark matter background is therefore disfavored by the present work.
Key words. cosmology: theory - dark matter - large-scale structure of Universe

1. Introduction
A universe with cold dark matter (CDM), a cosmological constant (Î›), and inflationary initial conditions forms the foundation of the standard Î›CDM paradigm that has proven successful
at explaining a wide range of observables, such as the expansion
history of the universe, the cosmic microwave background, formation of large-scale structure, the matter power spectra, and the
abundance of light elements (Tegmark et al. 2004; Planck Collaboration et al. 2016; Cyburt et al. 2016). Nonetheless, it is a
phenomenological model that is ignorant of the origin of the cosmological constant and the identity of dark matter (DM), which
remain two of the greatest mysteries in fundamental physics today.
A number of challenges to Î›CDM have emerged as both observations and numerical simulations become increasingly more
precise, especially on small scales. The cores of DM halos predicted from N-body simulations are denser and more cuspy than
observed, and the number of dwarf galaxies in the Local Group is
far smaller than expected from pure Î›CDM simulations. These
issues are known as the too-big-to-fail, cusp-core, and missing
satellite problems (see e.g., Del Popolo & Le Delliou (2017)
and Bullock & Boylan-Kolchin (2017) and references therein).
Another puzzling phenomenology on the scale of galaxies is
the empirical baryonic Tully-Fisher relation (BTFR) (McGaugh
et al. 2000; McGaugh 2005; Lelli et al. 2015). This relates the
baryonic mass of galaxies Mb with the asymptotic circular velocity vc through Mb âˆ¼ v4c and holds for many orders of magnitude
with remarkably small scatter. The Î›CDM prediction for this relation is M âˆ¼ v3c with the total mass M from both baryons and

DM (McGaugh 2012). It is the latter that dominates the gravitational pull in galaxies, which only adds to the strangeness of the
BTFR.
Solutions to these problems within the framework of Î›CDM
have been proposed by including baryonic physics (SantosSantos et al. 2015; Sales et al. 2016; Zhu et al. 2016; Sawala
et al. 2016), but it is unclear if they can completely cure the ails
of Î›CDM. These processes are not yet fully understood and are
difficult to model in simulations of galaxy formation, and their
stochastic nature makes it even more puzzling as to how they can
be responsible for the tight correlation in scaling relations, such
as the BTFR.
An alternative possibility is that the mismatch between observations and simulations is an indication of physics beyond
the standard model, either through modified theories of gravity,
the particle nature of DM, or both. An example of such a model
is modified Newtonian dynamics (MOND) (Milgrom 1983a,b,c;
Famaey & McGaugh 2012), in which the Newtonian law of gravity in low-acceleration regions is modified to explain the rotation
curves of galaxies without the need of resorting to DM. One of
its most appealing features is that the BTFR and its small scatter is a direct consequence of it. However, MOND and its relativistic extensions face challenges of their own on extragalactic
scales where the CDM paradigm is successful (Zuntz et al. 2010;
Dodelson 2011; Angus et al. 2013, 2014). This has, somewhat
ironically, motivated extended models of DM where MOND is
an emergent fifth force on small scales (Berezhiani & Khoury
2015; Khoury 2016). This is achieved by DM undergoing BoseEinstein condensation on galactic scales and adding a coupling
designed to give a MONDian long-range force between baryons
Article number, page 1 of 11

A&A proofs: manuscript no. main

mediated by phonons in the superfluid cores of galaxies. Outside
galaxies, the DM fluid ceases to be superfluid, and the extra force
disappears, preserving the success of CDM on large scales.
Superfluid dark matter (SFDM) models are also interesting
on more general grounds. From condensed matter physics, we
know that self-interacting boson gases can become superfluid
given sufficiently high densities and low temperatures. In the
weakly interacting Bose gas, the critical temperature that marks
the onset of superfluidity depends almost solely on the particle
mass and number density. We can therefore expect boson DM
candidates with self-interactions to exhibit superfluid behavior
in certain mass ranges.
Observations of the large-scale structure of the universe
strongly favor cold and collisionless DM, but for SFDM this is
no longer the case since the transition in and out of the superfluid
phase requires both self-interactions and finite temperatures. We
must therefore be wary of how structure forms in SFDM. Studies
of other DM models with pressure-like terms, such as fuzzy dark
matter (Hu et al. 2000; Schive et al. 2014; Schwabe et al. 2016;
Mocz et al. 2017) and self-interacting dark matter (Spergel &
Steinhardt 2000; Elbert et al. 2015; Tulin & Yu 2018), find they
can help remove the surplus of small-scale structure in Î›CDM.
So far, there has been little work done on structure formation in
SFDM and how it differs from conventional DM fluids. In this
paper, we aim to provide preliminary answers to these questions
by considering the spherical collapse of SFDM.
The paper is organized as follows: in Section 2, the equations for superfluid hydrodynamics used to describe the collapse
of SFDM are introduced, as well as the critical temperature and
the critical velocity, which are important for the superfluid phenomenology. The linear expansion of the superfluid equations
was derived to better understand how superfluidity changes the
behavior of the DM fluid. In Section 3, the results are presented
and discussed, and we draw our conclusions in Section 4.

This set of equations describes the evolution of the fluid mass
density Ï, entropy density S , superfluid velocity u s , momentum
density j, and energy density E under the influence of the gravitational potential Î¦ sourced by matter and a cosmological constant,
âˆ‡2 Î¦ = 4Ï€G(Ï âˆ’ 2ÏÎ› ).

(6)

Equations (2) and (5) are degenerate in our set of equations if the
solution is free of shocks, otherwise entropy is generated. The
former is used in this work, but both are given for completeness.
A superfluid differs from a classical fluid in that it consists
of two fluid components; the "superfluid" with density Ï s and
velocity u s , and the "normal fluid" with density Ïn and velocity un . The sum of the two component densities gives the total fluid density Ï = Ïn + Ï s , and likewise for momentum,
j = Ïn un + Ï s u s . However, only the normal fluid transports
entropy and thermal energy, as can be seen from Eqs. (2) and
(5), and the superfluid velocity evolves according to its own potential given in Eq. (3), where the chemical potential is Âµ =
[P + U âˆ’ S T âˆ’ 12 Ïn (u s âˆ’ un )2 ]/Ï. Since there are two fluid components with separate velocity fields a superfluid can have two
sound modes. One is called first sound and is associated with
density perturbations, which we are familiar with from regular
hydrodynamics. The other is called second sound and is associated with temperature perturbations. This is made possible by
the fact that only the normal component carries entropy, hence
the normal and superfluid components can oscillate in such a
way that perturbations in temperature, and not density, are propagated through the fluid. As we will see it is this property that
is responsible for difference in collapse of superfluid and nonsuperfluid DM.
The remaining variables in the above set of equations are
pressure P, internal energy density U, and temperature T . In the
limit Ï s = 0, they reduce to the Euler equations of fluid dynamics.

2. Method
2.2. Critical temperature and velocity, and equation of state

2.1. Superfluid hydrodynamics

To describe a finite-temperature superfluid, we employed the superfluid hydrodynamic equations (Taylor & Griffin 2005; Chapman et al. 2014), which in proper coordinates and physical variables are;
âˆ‚Ï
+ âˆ‡ Â· j = 0,
âˆ‚t

(1)

âˆ‚S
+ âˆ‡ Â· (S un ) = 0,
âˆ‚t

(2)

âˆ‚u s
1
+ âˆ‡(Âµ + u2s ) = âˆ’âˆ‡Î¦,
âˆ‚t
2

(3)

âˆ‚j
+ âˆ‡P + Ï s (u s Â· âˆ‡)u s + Ïn (un Â· âˆ‡)un
âˆ‚t
+ u s [âˆ‡ Â· (Ï s u s )] + un [âˆ‡ Â· (Ïn un )] = âˆ’Ïâˆ‡Î¦,
h
âˆ‚E
1
1
+ âˆ‡ Â· (U + Ïn u2n + P)un + Ï s u2s u s
âˆ‚t
2
2
i
+ ÂµÏ s (u s âˆ’ un ) = âˆ’ j Â· âˆ‡Î¦.
Article number, page 2 of 11

(4)

When a boson gas is cooled below a critical temperature T c ,
the particles begin accumulating in the quantum ground state of
the system and form a Bose-Einstein condensate (BEC). In the
three-dimensional homogeneous and ideal Bose gas this critical
temperature is
!2/3
2Ï€~2
Ï
T c = 5/3
,
(7)
m kB Î¶(3/2)
where Î¶(x) is the Riemann Zeta-function. This result holds approximately for weakly interacting gases as well (Sharma et al.
2019), apart from a small interaction-dependent shift (Andersen
2004) that we neglect.
The formation of a BEC does not automatically imply a superfluid. A further criterion must be satisfied as realized by Landau (1941). He assumed that if dissipation and heating happens
through the creation of elementary excitations in the fluid, and
if these excitations can no longer spontaneously appear the fluid
will become superfluid. This gives the so-called Landau criterion
and requires the relative motion w = u s âˆ’ un to be smaller than
the critical velocity vc ,
w < vc = min
p

(5)

( p)
,
p

(8)

where ( p) is the energy of an elementary excitation with momentum p. Clearly, we must have vc > 0, otherwise any motion

S. T. H. Hartman et al.: Collapse of spherical overdensities in superfluid models of dark matter

fs

1.0
fs, ap. = 1 (T/Tc)3/2
g2 = 1 eV 2
g2 = 10 2 eV 2
g2 = 10 4 eV 2

0.5
0.0
10

2

10

2

10 1
T/Tc

100

1

0.3
fs, ap. fs
fs, ap. + fs

will destroy the superflow, and it no longer makes sense to refer to it as a superfluid. An ideal Bose gas can therefore not be
superfluid since the elementary excitations are (p) = p2 /2m so
that vc = 0. In an interacting Bose gas, on the other hand, the
condensation of the gas makes the energy spectrum phonon-like
at small momenta, ( p) = c s p. The critical velocity is in this case
finite, vc = c s , and we get superfluidity.
As w approaches and exceeds the critical velocity, the superfluid flow begins to decay. This happens because a tangle of
superfluid vortices, so-called quantum turbulence, forms and interacts with the excitations that make up the normal fluid, resulting in a dissipative mutual friction between the normal and superfluid components (Skrbek 2011; Skrbek & Sreenivasan 2012;
Barenghi et al. 2014). This effect is not included in the equations for superfluid hydrodynamics and must be added through
additional terms. However, this would require us to assume the
dependence of this force on the fluid variables and specify the
extra parameters introduced to our model (for examples of this
in numerical studies of superfluid helium, see Doi et al. (2008),
Darve et al. (2012), and Soulaine et al. (2017)). To capture the
basic consequence of Landauâ€™s criterion relevant for this work,
which is that the counterflow w is limited by the critical velocity,
we instead assume the mutual friction only takes place once the
critical velocity is exceeded, and that the complicated processes
taking place happen on time and length scales much shorter than
we are considering. The mutual friction is therefore effectively
instantaneous, and since it is dissipative, there is a conversion of
kinetic energy into internal energy, heating the fluid and generating entropy. Stated more precisely, we enforce the superfluid
critical velocity at every position in our numerical scheme by
converting kinetic energy of the two fluid components (while
conserving the total momentum) into internal energy and generated entropy so that w < vc is always satisfied. See Appendix
B.3 for further details.
We must also specify the equation of state (EOS) that defines how the thermodynamic quantities depend on the temperature and particle density. In superfluids, the EOS is also a function of the counterflow w (Landau & Lifshitz 1987; Khalatnikov
2000), but we neglected this dependence and used the EOS corresponding to the w = 0 limit. While this work is motivated
by the superfluid DM model presented by Berezhiani & Khoury
(2015), it lacks a complete EOS at finite temperatures. We therefore employed the weakly interacting Bose gas with effective
repulsive two- and three-body contact interactions as described
by Sharma et al. (2019), where the three-body case corresponds
most closely to the model by Berezhiani & Khoury (2015). Effective contact interactions can describe the s-wave scattering
limit of more complicated interactions through the Born approximation, which makes this class of models a more general description of superfluids (Pethick & Smith 2008). The coupling
term between the DM fluid and baryons that gives rise to the
emergent fifth force is not included in this work. For computational speed, we approximated the EOS in the sub-T c regime
by an ideal Bose gas with contributions from interactions at
zero temperature. Notably, the superfluid fraction is approximated as the fraction of condensed particles in an ideal BEC,
f s = Ï s /Ï = 1 âˆ’ (T/T c )3/2 . This might appear paradoxical since
we already stated that an ideal Bose gas cannot be superfluid, but
in the weakly interacting gas these quantities can be seen from
Fig. 1 to be closely related. For strong interactions, the superfluid fraction can approach unity while the condensate fraction
remains small, which is the case in superfluid 4 He (Glyde 2013),
but this scenario is outside the scope of this paper. See Appendix
A for further details on the EOS.

0.2
0.1
0.0
10

100

Fig. 1. Superfluid fraction f s for the two-body interacting Bose gas calculated by Sharma et al. (2019) with Ï = 108 Ïc0 and m = 1 eV compared to the approximation f s,ap. = 1 âˆ’ (T/T c )3/2 . For sufficiently weak
interactions, f s can be approximated by the condensate fraction in an
ideal Bose gas.

2.3. Super-comoving variables

Since we are interested in the evolution of the superfluid in an
expanding space, we introduce the peculiar velocity v = u âˆ’ Hr
and super-comoving variables (Martel & Shapiro 1998), denoted
by a tilde-sign, to rewrite the hydrodynamic equations in a more
convenient form1 :
âˆ‚ÏÌƒ Ëœ
+ âˆ‡ Â· jÌƒ = 0,
âˆ‚tËœ

(9)

âˆ‚SÌƒ
Ëœ Â· (SÌƒ vÌƒn ) = 0,
+âˆ‡
âˆ‚tËœ

(10)

1
âˆ‚vÌƒ s Ëœ
Ëœ Ï†Ìƒ,
+ âˆ‡(ÂµÌƒ + vÌƒ2s ) = âˆ’âˆ‡
âˆ‚tËœ
2

(11)

âˆ‚ jÌƒ Ëœ
Ëœ s + ÏÌƒn (vÌƒn Â· âˆ‡)vÌƒ
Ëœ n
+ âˆ‡PÌƒ + ÏÌƒ s (vÌƒ s Â· âˆ‡)vÌƒ
âˆ‚tËœ
Ëœ Â· (ÏÌƒ s vÌƒ s )] + vÌƒn [âˆ‡
Ëœ Â· (ÏÌƒn vÌƒn )] = âˆ’ÏÌƒâˆ‡
Ëœ Ï†Ìƒ,
+ vÌƒ s [âˆ‡

(12)

âˆ‚EÌƒ Ëœ h
1
1
+ âˆ‡ Â· (UÌƒ + ÏÌƒn vÌƒ2n + PÌƒ)vÌƒn + ÏÌƒ s vÌƒ2s vÌƒ s
âˆ‚tËœ
2
2
i
Ëœ Ï†Ìƒ.
+ ÂµÌƒÏÌƒ s (vÌƒ s âˆ’ vÌƒn ) = âˆ’HÌƒ(3PÌƒ âˆ’ 2UÌƒ) âˆ’ jÌƒ Â· âˆ‡

(13)

The super-comoving quantities are re-scaled to reduce the
dependence on the scale factor a, with the variables defined as
before: jÌƒ = ÏÌƒn vÌƒn + ÏÌƒ s vÌƒ s and EÌƒ = UÌƒ + 12 ÏÌƒn vÌƒ2n + 12 ÏÌƒ s vÌƒ2s . The only
real difference is the peculiar gravitational potential Ï†Ìƒ that is now
given by (in a flat universe with matter and a cosmological constant)
âˆ‡Ëœ 2 Ï†Ìƒ = 6a (ÏÌƒ âˆ’ 1) .

(14)

HÌƒ is the super-comoving Hubble parameter.
1
The temperature and entropy in super-comoving variables are not
given in Martel & Shapiro (1998) (MS). We define them here as TÌƒ =
a2 T/T âˆ— and SÌƒ = a3 S /S âˆ— , where T âˆ— is a free parameter, S âˆ— = Ïâˆ— v2âˆ— /T âˆ— ,
with Ïâˆ— and vâˆ— given in MS.

Article number, page 3 of 11

A&A proofs: manuscript no. main

2.4. Linear perturbation expansion

The superfluid hydrodynamic equations at linear order can tell
us a lot about the collapse of a superfluid, in particular how it
will differ from CDM and non-superfluid thermal DM. The fluid
variables are expanded around their background values, ÏÌƒ = ÏÌƒ0 +
Î´ÏÌƒ, SÌƒ = SÌƒ 0 +Î´SËœ, etc. The peculiar background velocities are zero,
so vÌƒ s = Î´vÌƒ s , vÌƒn = Î´vÌƒn , and jÌƒ = Î´ jÌƒ. We also have âˆ‡Ëœ 2 Î´Ï†Ìƒ = 6aÎ´ÏÌƒ.
This gives the following linear equations;

behavior is the superfluid componentâ€™s attraction to higher temperatures. The normal component tends to transport mass and
entropy from hot to cold regions, while the superfluid tends to
flow in the opposite direction and balance the mass-loss due to
the normal component, resulting in a thermal flux that can be
large compared to the net mass flux. This effect, called thermal
counterflow, makes superfluids very efficient at conducting heat.

3. Results and discussion
âˆ‚Î´ÏÌƒ Ëœ
+ âˆ‡ Â· Î´ jÌƒ = 0,
âˆ‚tËœ

(15)

âˆ‚Î´SÌƒ
Ëœ Â· Î´vÌƒn = 0,
+ SÌƒ 0 âˆ‡
âˆ‚tËœ

(16)

âˆ‚Î´vÌƒ s Ëœ
+ âˆ‡(Î´ÂµÌƒ + Î´Ï†Ìƒ) = 0,
âˆ‚tËœ

(17)

âˆ‚Î´ jÌƒ Ëœ
Ëœ Ï†Ìƒ = 0.
+ âˆ‡Î´PÌƒ + ÏËœ0 âˆ‡Î´
âˆ‚tËœ

(18)

These can be combined into two coupled equations for Î´ÏÌƒ and
Î´SÌƒ in kÌƒ-space;
"
!
#
!
âˆ‚2 Î´ÏÌƒkÌƒ
âˆ‚PÌƒ
âˆ‚PÌƒ
2
+
kÌƒ
âˆ’
6a
ÏÌƒ
Î´
ÏÌƒ
+
kÌƒ2 Î´SÌƒ kÌƒ = 0,
(19)
0
kÌƒ
âˆ‚ÏÌƒ 0
âˆ‚tËœ2
âˆ‚SÌƒ 0
âˆ‚2 Î´SÌƒ kÌƒ
+ SÌƒ 0
âˆ‚tËœ2

!
! )
#
SÌƒ 0 ÏÌƒ s0 âˆ‚TÌƒ
1 âˆ‚PÌƒ
+
kÌƒ2 âˆ’ 6a Î´ÏÌƒkÌƒ
ÏÌƒ0 âˆ‚ÏÌƒ 0 ÏÌƒ0 ÏÌƒn0 âˆ‚ÏÌƒ 0
"
!
! #
SÌƒ 0 ÏÌƒ s0 âˆ‚TÌƒ
1 âˆ‚PÌƒ
+ SÌƒ 0
+
kÌƒ2 Î´SÌƒ kÌƒ = 0,
ÏÌƒ0 âˆ‚SÌƒ 0 ÏÌƒ0 ÏÌƒn0 âˆ‚SÌƒ 0
"(

(20)

where the subscript "0" indicates the background values.
We would like to enforce the critical velocity in the linear
approach, though we cannot do it in the same way as for the full
hydrodynamic equations. Since the effect of the critical velocity
is to essentially restrict the two-fluid nature of the superfluid,
forcing the whole fluid to evolve like a normal fluid, we can, as a
rough approximation, set Ï s = 0 and Ïn = Ï once wÌƒkÌƒ â‰¥ vÌƒc , where
wÌƒkÌƒ is the relative velocity of mode kÌƒ and evolves at linear order
according to
"
!
!
#
âˆ‚wÌƒkÌƒ
SÌƒ 0 âˆ‚TÌƒ
âˆ‚TÌƒ
= kÌƒ
Î´ÏÌƒ +
(21)
Î´SÌƒ kÌƒ .
âˆ‚tËœ
ÏÌƒn0 âˆ‚ÏÌƒ 0 kÌƒ
âˆ‚SÌƒ 0
This approximation is further justified by the fact that the critical
velocity decreases with the DM density. Once w reaches vc , it
only becomes smaller in the linear regime, forcing the superfluid
to behave even more like a normal fluid.
A few qualitative statements can be made from Eqs. (19) and
(20). Both mass density and entropy perturbations grow due to
gravity, but this growth is slowed by pressure terms that are scale
dependent through the kÌƒ2 factor, as expected in a self-gravitating
fluid with nonzero pressure. In a superfluid, however, there are
additional effective pressure terms that suppress the growth of
entropy perturbations, and hence thermal pressure, that are absent in conventional fluids. This in turn allows the mass density
perturbations to collapse more efficiently, even though the DM
fluid may have relatively high temperatures. The reason for this
Article number, page 4 of 11

The hydrodynamic equations were integrated numerically using
a modified first-order FORCE scheme (see Toro (2006) and Appendix B for further details) for a spherically symmetric system
2
with an initial density contrast of the form Î´ÏÌƒ/ÏÌƒ0 = âˆ†0 eâˆ’(rÌƒ/LÌƒ)
and Î´SÌƒ = 0, where LÌƒ is the size of the overdensity. The initial state is at approximately the same T/T c , and hence the
same mixing fraction of the normal and superfluid components,
throughout the system. A flat Î›CDM background cosmology
with â„¦m0 = 0.3, â„¦Î›0 = 0.7, and h = 0.7 was used, and the
integration started at redshift z = 1000 with âˆ†0 = 5 Ã— 10âˆ’3 . An
example of a collapsing SFDM halo at various redshifts can be
seen in Fig. 2, illustrating that as the halo collapses, a thermal
counterflow carrying entropy away from the halo center develops, slowing down the growth of entropy until the critical velocity is reached and the fluid starts heating up.
3.1. Growth of structure

In Fig. 3, Fig. 4, and Fig. 5, the redshift when the central density
contrast reaches 200 is shown for various parameters for both the
superfluid and non-superfluid (a conventional fluid with Ï s = 0,
Ïn = Ï, and the same EOS) cases. While the growth of structure
is slower compared to CDM, the SFDM halos collapse more efficiently than their non-superfluid counterparts as the interaction
strength is increased until a maximum is reached, after which
the growth of structure in both super-and non-superfluid DM is
suppressed. This is counter to what one would intuitively expect, since an increase in interactions also means an increase in
pressure. It can, however, be understood as follows: for small interactions, the superfluid behaves nearly the same as a normal
âˆš
fluid because the critical velocity, which scales as vc âˆ¼ gi , is
reached very early. When this happens, the flow of the normal
and superfluid components become "locked" to one another, unable to efficiently conduct heat away from the halo core. As the
interaction increases, the thermal counterflow can both be larger
and last longer, resulting in an increased suppression of thermal
gradients and thus allows for a faster collapse. For sufficiently
large interactions, the collapse is instead suppressed due to large
zero-temperature pressure gradients that the superfluid is unable
to wash out.
Most production of entropy due to mutual friction as the Landau criterion is broken takes place away from the center of the
halo. The resulting extra thermal pressure acting on the interior
causes the central density contrast to grow slightly faster and can
best be seen by the gap between collapse times of the superfluid
and non-superfluid cases at low g2 . If entropy was not produced,
this gap would vanish.
3.2. Dependence on equation of state

The Bose gas with two-body interactions is compared with threebody interactions in Fig. 6. The same qualitative behavior is
present in both cases and is expected to be a general feature re-

S. T. H. Hartman et al.: Collapse of spherical overdensities in superfluid models of dark matter

0.8

10

2

10

5

10

8

0.7
z = 1000.0
z = 100.0
z = 10.0

10

101

100

1

0.6

z = 5.0
z = 1.0
z = 0.6
102

103

s/s0

101
10

2

10

5

10

8

0.4
0.3
CDM
L = 200 kpc
L = 100 kpc
L = 50 kpc

0.1

10

101

100

1

102

0.0
10

103

15

0.12

101

100

1

102

103

10

11

10
10 9
g2 [eV 2]

7

10

5

10

3

0.7

1.0
10

101
r [kpc]

100

1

102

103

z( / 0 = 200)

0.6

0.0
0.5

0.5
0.4
0.3
CDM
T/Tc = 0.15
T/Tc = 0.1
T/Tc = 0.05

0.2
Fig. 2. Profiles of a collapsing SFDM halo with an initial Gaussian density contrast, m = 30 eV, g = 10âˆ’5 eVâˆ’2 , L = 100 kpc, and T/T c = 0.1.
A thermal counterflow develops and the growth of entropy perturbations
is at first suppressed. This also gives a slight decrease in the ratio T/T c ,
and hence the superfluid fraction, since f s = Ï s /Ï = 1âˆ’(T/T c )3/2 . As the
critical velocity is reached, entropy is generated, and T/T c increases.

0.1
0.0
10

15

10

13

10

11

10
10 9
g2 [eV 2]

7

10

5

10

3

Fig. 5. Comparison of redshifts when the central density contrast
reaches 200 as function of the interaction strength for various temperatures, with m = 50 eV and L = 100 kpc. Both the superfluid case
(solid lines) and the corresponding non-superfluid case (striped lines)
are shown.

0.8
0.7
0.6
z( / 0 = 200)

13

0.8

0.5

0.5
0.4
0.3
CDM
m = 30 eV
m = 40 eV
m = 50 eV

0.2
0.1
0.0
10

10

Fig. 4. Comparison of redshifts when the central density contrast
reaches 200 as function of the interaction strength for various scales,
with T/T c = 0.1 and m = 50 eV. Both the superfluid case (solid lines)
and the corresponding non-superfluid case (striped lines) are shown.

0.10
10
1.0
w/vc

0.5

0.2

0.14
T/Tc

z( / 0 = 200)

/

0

101

15

10

13

10

11

10
10 9
g2 [eV 2]

7

10

5

10

3

Fig. 3. Comparison of redshifts when the central density contrast
reaches 200 as function of the interaction strength for various particle
masses, with T/T c = 0.1 and L = 100 kpc. Both the superfluid case
(solid lines) and the corresponding non-superfluid case (striped lines)
are shown. For constant T/T c , the temperature is increased for decreasing mass, since T c âˆ¼ mâˆ’5/3 . The comparison of the collapse for various
masses is therefore not done at the same temperature, but instead at a
similar place in the superfluid phase.

gardless of the EOS used, as long as there is superfluidity. In the
linear expansion of the superfluid equations, Eqs. (19) and (20),
the additional effective pressure terms due to a superfluid component require only the temperature to be dependent on mass density or entropy. Indeed, the approximated two-body and threebody EOS used in this work both have a temperature profile that
is independent of mass density for T < T c , so that one of the
effective pressure terms in Eq. (20) is absent. For EOS where the
temperature is dependent on both the mass density and entropy,
the collapse of SFDM may be even more efficient.
3.3. Effect of small-scale and nonradial motion

In this work, we assumed perfect radial infall of DM. The relative velocity w is simply the difference between the radial velocities of the two fluid components. In a real system, there is
expected to be additional small-scale motion in all directions,
such as turbulence that our simplified model averages over. The
superfluid critical velocity may therefore be exceeded on small
scales, while the large-scale radial average only appears to have
Article number, page 5 of 11

A&A proofs: manuscript no. main

0.8
0.7
0.6

1.050

0.5
0.4
0.3

1.000
0.975
0.950

0.1

0.925
15

10

13

10

11

10 7
10 9
g2 [eV 2], g3 [eV 5]

10

5

10

3

Fig. 6. Comparison of redshifts when the central density contrast
reaches 200 for two-body and three-body interactions as function of
the interaction strengths g2 and g3 , respectively, with m = 30 eV,
L =âˆš100 kpc, and T/T c = 0.1. The three-body interaction is multiplied
by 10 Ã— 10âˆ’4 to make the comparison clearer. Both the superfluid case
(solid lines) and the non-superfluid (striped lines) are shown.

0.8

CDM
vc
0.5 vc
0.1 vc
0.01 vc

0.7
0.6
z( / 0 = 200)

1.025

0.2
0.0
10

0.5
0.4
0.3
0.2
0.1
0.0
10

15

10

13

m = 5 eV, T/Tc = 0.02
m = 50 eV, T/Tc = 0.1
m = 500 eV, T/Tc = 0.5

1.075

T/Tc
T/Tc(z = 1000)

z( / 0 = 200)

1.100

CDM
2-body
3-body

10

11

10
10 9
g2 [eV 2]

7

10

5

10

3

Fig. 7. Comparison of redshifts when the central density contrast
reaches 200 for various effective critical velocities as function of the
interaction strength, with m = 30 eV, T/T c = 0.1, and L = 100 kpc.
Both the superfluid case (solid lines) and the non-superfluid (striped
line) are shown.

w < vc . In this case, the superfluid would behave like a conventional fluid at much smaller w. In other words, there is an
effective superfluid critical velocity veff
c < vc that is a decreasing function of the local turbulence. This leads to a difference in
collapse times of halos with different amounts of turbulence, the
turbulent ones collapsing at a slower rate, as seen in Fig. 7.
3.4. Evolution of superfluid fraction

In a conventional fluid, the entropy and mass density collapses
at the same rate so that the ratio T/T c is constant. A fluid that is
initially in the normal phase will therefore remain so. A collapsing superfluid, on the other hand, experiences an increase in the
superfluid fraction due to thermal counterflow until the critical
velocity is reached. At this point, entropy is generated causing
T/T c to rise, and thus the superfluid fraction to fall; though it
takes time for the full effect of this to propagate to the center of
the halo, as shown in Fig. 2 and Fig. 8. It may be, however, that
Article number, page 6 of 11

0.900 0
10

101

z+1

102

103

Fig. 8. Evolution of T/T c in the halo center during collapse for various
masses and initial temperatures with g = 10âˆ’5 eVâˆ’2 and L = 100 kpc.
Both the evolution with entropy production (solid lines) and without
(striped lines) are shown until the overdensity reach 105 . The two cases
differ only in the end stage of the collapse, well after the critical velocity
is first reached, indicated by the colored vertical lines.

Eqs. (1)-(5) do not properly describe super-critical flow, and too
much entropy is generated in our numerical scheme for enforcing the critical velocity. The evolution of T/T c when no entropy
is generated is therefore also shown in Fig. 8 as the opposite
extreme. This case behaves similarly until near the end of the
collapse, where T/T c rises only modestly. Profiles are shown in
Fig. 9, which corresponds to Fig. 2 with no production of entropy.
The decrease in T/T c during collapse becomes smaller as the
temperature approaches T c , where the superfluid fraction goes
to zero and thermal counterflow becomes inefficient. The formation of DM halos with much higher superfluid fractions than
the background, as required in the emergent MOND scenario of
Berezhiani & Khoury (2015), therefore appears unlikely through
collapse alone. Additional cooling mechanisms during or after
collapse are necessary.
3.5. Dark matter self-interaction constraints

The distribution of DM, gas, and stellar mass in cluster collisions provides constraints on the cross-section of DM selfinteractions, Ïƒ/m < 0.5 cm2 /g (Harvey et al. 2015). In terms of
the two-body interaction strength, this corresponds to (Pitaevskii
& Stringari 2016)
!1/2
âˆš
~2
1 eV
g2 = 4Ï€Ïƒ < 5 Ã— 10âˆ’12
eVâˆ’2 .
(22)
m
m
The values of g2 in the above results do not generally satisfy this
constraint, but we chose to relax it since we do not know how
it translates to SFDM. In any case, the above features were also
found for smaller g2 using perturbation theory (while simultaneously lowering m and T/T c ) that do satisfy the constraints, as is
exemplified in Fig. 10.

4. Conclusions
When superfluid behavior is included in a finite-temperature DM
fluid, the formation of structure is found to be much more efficient in certain regions of parameter space than one would,
naively, expect, through it is still slower compared to CDM. The

T/Tc

s/s0

104
101
10 2
10 5
10 8
10
104
101
10 2
10 5
10 8
10

2.00

z = 1000.0
z = 100.0
z = 10.0
1

z = 5.0
z = 1.0
z = 0.6

100

1.50

z = 0.5
z = 0.46

101

102

103

w/vc

1.00
0.75
0.25

1

100

101

102

103

1

100

101

102

103

0.5
0.0
0.5
1.0
10

1.25

0.50

0.100
0.099
0.098
0.097
10
1.0

CDM
m = 7 Ã— 10 4 eV
m = 10 3 eV
m = 2 Ã— 10 3 eV

1.75

z( / 0 = 1)

/

0

S. T. H. Hartman et al.: Collapse of spherical overdensities in superfluid models of dark matter

1

100

101
r [kpc]

102

103

Fig. 9. Profiles of a collapsing SFDM halo where no entropy is produced
as w = vv with an initial gaussian density contrast, m = 30 eV, g =
10âˆ’5 eVâˆ’2 , L = 100 kpc, and T/T c = 0.1.

effect of thermal counterflow is most prominent when the thermal suppression is large, such as at small scales and relatively
high temperatures. The increased collapse efficiency is also expected to be a general feature of SFDM regardless of the EOS
used, though the specific model in question will certainly affect the finer details through the dependence of entropy, pressure, and critical velocity on temperature, mass density, and the
model parameters. The toy models used in this work were motivated by condensed matter physics, but suffer some severe limitations at high redshifts. Both are derived under the assumption
that the interactions are weak and the number density is not too
large, which is invalid at very early times. Furthermore, the zerotemperature pressure depends on the number density through n2
and n3 , resulting in very high pressures at high redshifts that
might wash out the initial perturbations set up by inflation. The
generalization of this work to more exotic DM fluids and adding
interactions between DM and baryons, which has recently been
considered in the literature, is therefore of interest in the further
study of SFDM models. It may also be of interest to study the
case when thermal equilibrium is not always assumed so that the
DM fluid can fall in and out of equilibrium and superfluidity can
vanish and reappear.
Superfluid models of DM involve processes that require the
superfluid hydrodynamic equations to be properly described.
Throughout this work, spherical symmetry was assumed, but
nonradial and turbulent motion is expected to have a significant
impact on the superfluid dynamics, especially through the critical velocity, which is broken at smaller radial thermal counter-

0.00
10

24

10

22

10

20

10

18

g2

10

16

10

14

10

12

10

10

Fig. 10. Redshifts when the linear density contrast for the mode k =
2/100 kpcâˆ’1 with T/T c = 2 Ã— 10âˆ’6 reaches unity for various masses
and interaction strengths. Both the superfluid case (solid lines) and the
corresponding non-superfluid case (striped lines) are shown, illustrating that the same features can be found for a choice of parameters
that satisfy the constraint from cluster collisions on DM mass and selfinteraction.

flows. It is also important to understand the effect of mergers in
SFDM. Large-scale and high-resolution simulations will therefore be essential for the further study of structure formation. The
main challenge in this line of inquiry may be developing numerical schemes that are faster and more accurate than the modified
first-order FORCE scheme used in this work that can capture the
small-scale motion of the superfluid and its effect on structure
formation.
Acknowledgements. We thank the Research Council of Norway for their support. We are grateful for the helpful comments and suggestions made by the
anonymous referee.

References
Andersen, J. O. 2004, Rev. Mod. Phys., 76, 599
Angus, G., Diaferio, A., Famaey, B., Gentile, G., & van der Heyden, K. 2014,
Journal of Cosmology and Astroparticle Physics, 2014, 079
Angus, G. W., Diaferio, A., Famaey, B., & van der Heyden, K. J. 2013, Monthly
Notices of the Royal Astronomical Society, 436, 202
Barenghi, C. F., Skrbek, L., & Sreenivasan, K. R. 2014, Proceedings of the National Academy of Sciences, 111, 4647
Berezhiani, L. & Khoury, J. 2015, Phys. Rev. D, 92, 103510
Bullock, J. S. & Boylan-Kolchin, M. 2017, Annual Review of Astronomy and
Astrophysics, 55, 343
Chapman, S., Hoyos, C., & Oz, Y. 2014, Journal of High Energy Physics, 2014,
27
Cyburt, R. H., Fields, B. D., Olive, K. A., & Yeh, T.-H. 2016, Rev. Mod. Phys.,
88, 015004
Darve, C., Bottura, L., Patankar, N. A., & Van Sciver, S. 2012, AIP Conference
Proceedings, 1434, 247
Del Popolo, A. & Le Delliou, M. 2017, Galaxies, 5
Dodelson, S. 2011, International Journal of Modern Physics D, 20, 2749
Doi, D., Shirai, Y., & Shiotsu, M. 2008, AIP Conference Proceedings, 985, 648
Elbert, O. D., Bullock, J. S., Garrison-Kimmel, S., et al. 2015, Monthly Notices
of the Royal Astronomical Society, 453, 29
Famaey, B. & McGaugh, S. S. 2012, Living Reviews in Relativity, 15, 10
Glyde, H. R. 2013, Journal of Low Temperature Physics, 172, 364
Harvey, D., Massey, R., Kitching, T., Taylor, A., & Tittley, E. 2015, Science, 347,
1462
Hu, W., Barkana, R., & Gruzinov, A. 2000, Phys. Rev. Lett., 85, 1158
Khalatnikov, I. M. 2000, An Introduction To The Theory Of Superfluidity, 1st
edn. (Westview Press)
Khoury, J. 2016, Phys. Rev. D, 93, 103533
Landau, L. 1941, Phys. Rev., 60, 356

Article number, page 7 of 11

A&A proofs: manuscript no. main
Landau, L. D. & Lifshitz, E. M. 1987, Course of theoretical physics / by L. D.
Landau and E. M. Lifshitz, Vol. 6, 2nd edn. (Butterworth-Heinemann)
Lelli, F., McGaugh, S. S., & Schombert, J. M. 2015, The Astrophysical Journal,
816, L14
Martel, H. & Shapiro, P. R. 1998, Mon. Not. R. Astron. Soc, 297, 467
McGaugh, S. S. 2005, The Astrophysical Journal, 632, 859
McGaugh, S. S. 2012, The Astronomical Journal, 143, 40
McGaugh, S. S., Schombert, J. M., Bothun, G. D., & de Blok, W. J. G. 2000, The
Astrophysical Journal, 533, L99
Milgrom, M. 1983a, ApJ, 270, 371
Milgrom, M. 1983b, ApJ, 270, 384
Milgrom, M. 1983c, ApJ, 270, 365
Mocz, P., Vogelsberger, M., Robles, V. H., et al. 2017, Monthly Notices of the
Royal Astronomical Society, 471, 4559
Pethick, C. J. & Smith, H. 2008, Boseâ€“Einstein Condensation in Dilute Gases,
2nd edn. (Cambridge University Press)
Pitaevskii, L. P. & Stringari, S. 2016, Bose-Einstein Condensation and Superfluidity (Great Clarendon Street, Oxford, United Kingdom: Oxford University
Press)
Planck Collaboration, Ade, P. A. R., Aghanim, N., et al. 2016, A&A, 594, A13
Sales, L. V., Navarro, J. F., Oman, K., et al. 2016, Monthly Notices of the Royal
Astronomical Society, 464, 2419
Santos-Santos, I. M., Brook, C. B., Stinson, G., et al. 2015, Monthly Notices of
the Royal Astronomical Society, 455, 476
Sawala, T., Frenk, C. S., Fattahi, A., et al. 2016, Monthly Notices of the Royal
Astronomical Society, 457, 1931
Schive, H.-Y., Chiueh, T., & Broadhurst, T. 2014, Nature Physics, 10, 496
Schwabe, B., Niemeyer, J. C., & Engels, J. F. 2016, Phys. Rev. D, 94, 043513
Sharma, A., Khoury, J., & Lubensky, T. 2019, Journal of Cosmology and Astroparticle Physics, 2019, 054
Skrbek, L. 2011, Journal of Physics: Conference Series, 318, 012004
Skrbek, L. & Sreenivasan, K. R. 2012, Physics of Fluids, 24, 011301
Soulaine, C., Quintard, M., Baudouy, B., & Van Weelderen, R. 2017, Physical
Review Letters, 118, 074506
Spergel, D. N. & Steinhardt, P. J. 2000, Phys. Rev. Lett., 84, 3760
Taylor, E. & Griffin, A. 2005, Phys. Rev. A, 72, 8739
Tegmark, M., Blanton, M. R., Strauss, M. A., et al. 2004, The Astrophysical
Journal, 606, 702
Toro, E. 2006, Applied Numerical Mathematics, 56, 1464
Tulin, S. & Yu, H.-B. 2018, Physics Reports, 730, 1 , dark matter self-interactions
and small scale structure
Zhu, Q., Marinacci, F., Maji, M., et al. 2016, Monthly Notices of the Royal Astronomical Society, 458, 1559
Zuntz, J., Zlosnik, T. G., Bourliot, F., Ferreira, P. G., & Starkman, G. D. 2010,
Phys. Rev. D, 81, 104015

Article number, page 8 of 11

S. T. H. Hartman et al.: Collapse of spherical overdensities in superfluid models of dark matter

Appendix A: equation of state

Appendix A.2: T â‰¤ T c

An EOS for a weakly interacting Bose gas valid at all temperatures was recently proposed by Sharma et al. (2019) for twobody and three-body interactions. Since we do not know the true
EOS of DM and must resort to toy models, we instead approximated the EOS by using an ideal Bose gas with zero-temperature
contributions from weak interactions. At very low temperatures,
this approximation breaks down as the interactions become increasingly important, but we generally remain well above this
regime.
An important quantity is the critical temperature T c , above
which the fluid behaves as a normal fluid, while below the fluid
condenses into a BEC and becomes superfluid;
!2/3
!2/3
2Ï€~2
2Ï€~2
Ï
n
Tc =
= 5/3
,
(A.1)
mkB Î¶(3/2)
m kB Î¶(3/2)

The EOS below the critical temperature is given by the ideal
Bose gas plus some zero-temperature contributions due to interactions;
ï£±


ï£´
1
m 3/2
2
ï£´
ï£´
(kB T )5/2 , two-body
ï£² 2 g2 n + Î¶(5/2) 2Ï€~2
P=ï£´
(A.8)


ï£´
m 3/2
ï£´
ï£³ 32 g3 n3 + Î¶(5/2) 2Ï€~
(kB T )5/2 , three-body,
2

where n = Ï/m is the particle number density.
As an estimate for the superfluid fraction f s = Ï s /Ï we use
the fraction of particles in the BEC in an ideal Bose gas;
ï£±
 3/2
ï£´
ï£´
ï£² 1 âˆ’ TTc
,
T â‰¤ Tc
fs = ï£´
(A.2)
ï£´
ï£³ 0,
T > Tc.
For the other thermodynamic quantities, such as pressure,
entropy, etc., we must consider them above and below T c separately. Both two-body and three-body interactions are given, parameterized by g2 and g3 , respectively.
Appendix A.1: T > T c

The pressure is given by
ï£±
ï£´
ï£´
ï£²
P=ï£´
ï£´
ï£³

g2 n2 +

âˆš

4g3 n3 +

2Î“(5/2)(kB T )5/2 m3/2
Li5/2 eÎ²(Âµâˆ’2g2 n) , two-body
3Ï€2 ~3
âˆš


5/2 3/2
2
2Î“(5/2)(kB T ) m
Li5/2 eÎ²(Âµâˆ’6g3 n ) , three-body,
3Ï€2 ~3





(A.3)
where Î“(x) is the gamma function, Liz (x) is the polylogarithmic
function, Î² = 1/kB T , and the chemical potential Âµ is determined
by the equation for the number density
ï£±
ï£´
ï£´
ï£²
n=ï£´
ï£´
ï£³

âˆš
2Î“(5/2)
3/2 3/2
m Li3/2
2 3 (kB T )
âˆš3Ï€ ~
2Î“(5/2)
3/2 3/2
(kB T ) m Li3/2
3Ï€2 ~3


eÎ²(Âµâˆ’2g2 n) , two-body


2
eÎ²(Âµâˆ’6g3 n ) , three-body.


(A.4)
The entropy is
( 5P
2 T âˆ’ nÎ²(Âµ âˆ’ 2g2 n), two-body
S =
5P
2
2 T âˆ’ nÎ²(Âµ âˆ’ 6g3 n ), three-body,

(A.5)

and the internal energy is
U = S T âˆ’ P + Âµn.

(A.6)

The sound speed used when determining the time-stepping
in the numerical scheme was
r
5 kB T
cs =
.
(A.7)
3 m
In the limit of very high temperature, these reduce to the classical ideal gas.

S =

 m 3/2
5
Î¶(5/2)
kB5/2 T 3/2 , two-and three-body,
2
2Ï€~2
(

Âµ=

g2 n, two-body
g3 n2 , three-body,

(A.9)

(A.10)

and the internal energy is again given by Eq. (A.6). The fastest
sound speed was approximated using
s
Î¶(5/2) 5 kB T
cs =
,
(A.11)
Î¶(3/2) 3 m
and the critical velocity given by
ï£± q

ï£´
g2 n 
ï£´
3/2
ï£´
ï£´
ï£² q m 1 âˆ’ (T/T c ) , two-body
vc = ï£´
ï£´


ï£´
2g3 n2 
ï£´
ï£³
1 âˆ’ (T/T c )3/2 1 + 2(T/T c )3/2 , three-body.
m
(A.12)
There is a small discontinuity at the critical temperature, with
Âµ = 2ng2 above and Âµ = ng2 below for the two-body interaction
(and a similar jump in zero-temperature pressure and internal
energy). There should be a crossover region as the condensate
fraction increases, but during this crossover the thermal contributions dominates and the discontinuity is negligible.

Appendix B: numerical scheme
In this work, we employed a modified first-order FORCE scheme
(Toro 2006)â€”an incomplete Riemann solverâ€”for the superfluid
hydrodynamic equations with source terms due to gravity and
from using spherical coordinates. The source terms were evaluated at two stages during each time-step: once before the advection step, and once after, at which point the average of the two
evaluations was added to the solution. Gravity was also evaluated
with half a time-step when computing fluxes during the advection step. Finally, we enforced the critical velocity, which was
done in three stages; once when computing fluxes, once after the
fluxes from the advection step were applied, and a final time after the source terms were applied. Further details are presented
below.
For spherical collapse, this scheme was found to be sufficient since the solutions are mostly smooth, evolve slowly, and
are one-dimensional. For more complex and higher dimensional
cases where shock fronts arise and the solutions undergo fast
changes, this scheme is expected to perform suboptimally, primarily because it is first-order. There is a well-known way to increase the order and thus accuracy of the scheme through slope
reconstruction and slope limiters. However, instabilities arose
when the superfluid component was included, and adding further restrictions to the reconstructed slopes with modified slope
limiters failed to fix this. Slope reconstruction was therefore not
used.
Article number, page 9 of 11

A&A proofs: manuscript no. main

Appendix B.1: first-order FORCE scheme

The FORCE scheme is a variant of Godunovâ€™s method for solving partial differential equations. In this method, the domain is
divided into finite-volume elements, or cells, and the Riemann
problem at each cell interface is solved. The Riemann problem is
the initial value problem with two piece-wise constant initial regions connected by a discontinuity, then asking how this evolves
in time and what the net flux across the interface is. The scheme
for computing or approximating this flux is called a Riemann
solver and is what characterizes the different ways of implementing Godunovâ€™s method.
To see how this works, one can consider the m-component
state vector U that obeys the one-dimensional conservative equation
âˆ‚t U + âˆ‚ x F(U) = 0,

(B.1)

where F is the flux. By integrating over the time interval [t , t
and cell-volume [xiâˆ’1/2 , xi+1/2 ], we get
n

Uin+1 = Uin âˆ’

âˆ†t
[Fiâˆ’1/2 âˆ’ Fi+1/2 ],
âˆ†x

n+1

]

(B.2)

where
xi+1/2

1
âˆ†x

Z

Fi+1/2 =

1
âˆ†t

Uin =

U(x, tn )dx,

(B.3)

xiâˆ’1/2

Z

tn+1

F(xi+1/2 , t)dt.

(B.4)

tn

In the first-order Godunov scheme, the state U is assumed to be
piece-wise constant in each cell, given by the cell average Uin .
To compute Fi+1/2, the states on the left and right sides of the
n
interface is used, Ui+1/2,L = Uin and Ui+1/2,R = Ui+1
, and the
corresponding Riemann problem is solved or approximated. The
time-step is chosen so that no signal in the domain travels further
than one cell length âˆ†x. This is given by a Courant-FriedrichLewy (CFL) type condition
s
âˆ†ts = CCFL

âˆ†x
,
vmax

The FORCE scheme approximates the interface flux F
(given the left and right states UL and UR ) as the average of the
Lax-Friedrichs flux and the two-step Lax-Wendroff flux;
FFORCE =

1 LF
[F + FLW ],
2

1
1 âˆ†x
[F(UL ) + F(UR )] âˆ’
[UR âˆ’ UL ],
2
2 âˆ†t
LW
= F(U ),
1
1 âˆ†t
= [UL + UR ] âˆ’
[F(UR ) âˆ’ F(UL )].
2
2 âˆ†x

FLF =
FLW
ULW

We modified this by enforcing the critical velocity on the intermediate state ULW before computing the flux FLW .
Appendix B.2: sources

Gravity and extra terms when using spherical coordinates and
super-comoving variables appear as source terms S in the superfluid equations. Continuing with the above example, we have
âˆ‚t U + âˆ‚ x F(U) = S.

(B.10)

To modify our Godunov scheme to incorporate the sources in the
flux, we did the following: at the beginning of each time-step, we
had the states Uin . To do the advection (the Godunov step), we
input the left and right states at each boundary i + 1/2; Ui+1/2,L =
Ui , Ui+1/2,R = Ui+1 . But before we computed the interface flux,
we applied half a time-step of the source due to gravity,

1 
âˆ—
Ui+1/2,L
= Ui+1/2,L + âˆ†t Sni+1/2,L
,
grav
2

1 
âˆ—
Ui+1/2,L
,
(B.11)
= Ui+1/2,R + âˆ†t Sni+1/2,R
grav
2
where Sni+1/2,L and Sni+1/2,R are the left and right values for the
sources. In this work, we computed these using the average gravitational acceleration (âˆ‡Î¦)ni+1/2,L/R = 21 [(âˆ‡Î¦)ni + (âˆ‡Î¦)ni+1 ], and
âˆ—
the left and right states Ui+1/2,L/R . We then used Ui+1/2,L
and
âˆ—
Ui+1/2,R as the input states in the Godunov scheme to get Fi+1/2 ,
and updated the state vectors from the previous time-step:

(B.5)

s
where vmax is the maximum signal speed in the domain, and CCFL

(B.9)

Uin+1,âˆ— = Uin âˆ’

âˆ†t
[Fiâˆ’1/2 âˆ’ Fi+1/2 ].
âˆ†x

(B.12)

is a number less than one that controls how far across a cell the
fastest signal is allowed to move during each time-step. In simulations with gravity and expansion, additional constraints need
to be added to the time-stepping. For gravity, the free-fall distance in each cell, with acceleration g, must be smaller than the
cell lengths,
s
2âˆ†x
ff
âˆ†tff = CCFL
,
(B.6)
g

This modification to the Godunov scheme was to include the
effect of gravity on the flux, but explicitly adding the sources to
the solution remains to be done. For this, we used the average
before and after the advection step;

and for expansion, the relative change in the scale factor is restricted:

ff
Here, CCFL
and CCFL are also numbers less than one. In this
exp
s
ff
work, we used CCFL
= 0.5, CCFL
= 0.5, and CCFL = 0.01. The
final value for the time-step is the smallest of the above,

The critical velocity was enforced by iteratively converting kinetic energy into internal energy and generated entropy in all
cells until w < vc . The scheme works as follows: we consider a
cell with the state vector Ul , where l denotes the current step in
the iterative scheme to enforce vc , and l = 0 is the initial state.
From this we get the fluid variables of the cell, vls , vln , S l , etc. If
wl < vlc , the Landau criterion is satisfied and we do nothing. If
instead wl > vlc , we apply a small change âˆ†vls to vls to update it
to l + 1 and decrease w,

âˆ†t = min[âˆ†ts , âˆ†tff , âˆ†texp ].

l
l
vl+1
s = v s + âˆ†v s .

exp

âˆ†texp = CCFL

1
.
H

(B.7)
exp

Article number, page 10 of 11

(B.8)

1
].
Uin+1 = Uin+1,âˆ— + âˆ†t [Sni + Sn+1,âˆ—
i
2

(B.13)

Appendix B.3: enforcing critical velocity

(B.14)

S. T. H. Hartman et al.: Collapse of spherical overdensities in superfluid models of dark matter

By keeping j constant and assuming that the change in the superfluid fraction is negligible compared to the change in velocity,
we get
âˆ†vln = âˆ’

Ïls l
âˆ†v s .
Ïln

(B.15)

Using conservation of energy the change in internal energy is
equal to the change in kinetic energy;
!
1
1
l
âˆ†U l = âˆ’âˆ†Ekin
= âˆ’âˆ† Ïln |vln |2 + Ïls |vls |2
2
2
= âˆ’Ïls (vls âˆ’ vln ) Â· âˆ†vls .

(B.16)

The change in entropy is âˆ†S l = âˆ†Ql /T l , where âˆ†Ql is the heating of the fluid, which in this case is just the change in internal
energy:
âˆ†S l =

Ïl (vl âˆ’ vl ) Â· âˆ†vls
âˆ†Ql âˆ†U l
= l = âˆ’ s s ln
.
l
T
T
T

(B.17)

The updated entropy is
S l+1 = S l + âˆ†S l .

(B.18)

We arrive at the state vector Ul+1 and repeat the above process
until w < vc . The only part that needs to be specified is âˆ†vls ,
which was chosen as
âˆ†vls = âˆ’C(wl ) wÌ‚l ,

(B.19)

where
C(w) = [10âˆ’2 , 10âˆ’5 ]w.

(B.20)

The numerical factor in Eq. (B.20) was tuned to give as smooth
w-profile as possible while keeping the scheme from becoming
too slow.

Article number, page 11 of 11

