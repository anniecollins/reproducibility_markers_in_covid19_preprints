arXiv:1911.09640v3 [math.CO] 29 Jun 2020

A RANDOMIZED CONSTRUCTION OF HIGH GIRTH REGULAR
GRAPHS
NATI LINIAL AND MICHAEL SIMKIN
Abstract. We describe a new random greedy algorithm for generating regular
graphs of high girth: Let k â‰¥ 3 and c âˆˆ (0, 1) be fixed. Let n âˆˆ N be even and
set g = c logkâˆ’1 (n). Begin with a Hamilton cycle G on n vertices. As long as the
smallest degree Î´(G) < k, choose, uniformly at random, two vertices u, v âˆˆ V (G) of
degree Î´(G) whose distance is at least g âˆ’ 1. If there are no such vertex pairs, abort.
Otherwise, add the edge uv to E(G).
We show that with high probability this algorithm yields a k-regular graph with
girth at least g. Our analysis also implies that there are (â„¦(n))kn/2 labeled k-regular
n-vertex graphs with girth at least g.

1. Introduction
The girth of a graph is the length of its shortest cycle. It is a classical challenge to
determine g(k, n), the largest possible girth of k-regular graphs with n vertices. Here
we only concern ourselves with fixed k â‰¥ 3 and large n. Mooreâ€™s bound says that
g(k, n) â‰¤ (1 Â± o (1)) Â· 2 logkâˆ’1 (n). Although the argument is very simple, this remains
our best asymptotic upper bound.
The study of high-girth graphs has a long history. Using a combinatorial argument,
ErdoÌ‹s and Sachs [12] proved in 1963 that g(k, n) â‰¥ (1 Â± o (1)) logkâˆ’1 (n). Twenty
years later, Biggs and Hoare [3] gave an algebraic construction of a family of cubic
graphs later shown [36] to have girth at least (1 âˆ’ o (1)) 43 log2 (n). Then, for k an
odd prime plus one, Lubotzky, Phillips, and Sarnak [27] constructed their celebrated
Ramanujan graphs, with girth (1 Â± o (1)) 43 logkâˆ’1 (n). As observed in [21, Introduction],
this implies that g(k, n) â‰¥ (1 âˆ’ o(1))c(k) log kâˆ’1 (n), where c(k) > 1 for every k â‰¥ 3,
and limkâ†’âˆ c(k) = 4/3. Cayley graphs attaining this bound were found by Dahan [11].
Along the way, advances by Chiu [10], Morgenstern [29], and Lazebnik, Ustimenko, and
Woldar [26] broadened the range of degrees for which similar constructions are known.
We further refer the reader to Biggsâ€™s survey [4] of the best known constructions for
cubic graphs.
In contrast, and notwithstanding considerable research efforts, the ErdoÌ‹s-Sachs bound
remains the best asymptotic lower bound on g(k, n) that is derived by combinatorial
and probabilistic techniques. This is one of very few examples where explicit algebraic
constructions beat the probabilistic method. We believe that the road to constructing
high-girth graphs using such methods goes via better understanding of the large-scale
geometry of graphs. In our open problem section we mention several additional mysteries in this domain.
Supported by Israel Science Foundation grant 659/18.
1

Here we describe a random greedy algorithm to construct regular high-girth graphs.
In recent years, random greedy algorithms have become a powerful tool for constructing
constrained combinatorial structures. Thus, Glock, KuÌˆhn, Lo, and Osthus [19], and
independently Bohman and Warnke [6], used this method to prove the existence of
approximate Steiner triple systems that are locally sparse. This methodology has also
played prominent roles in the proofs by Keevash [22] and Glock, KuÌˆhn, Lo, and Osthus
[18] of the existence of combinatorial designs.
Random greedy algorithms have also been studied in their own right. For example,
in the â€œtriangle-freeâ€ graph process (e.g., [13, 5]), edges are randomly added to a graph
one by one and subject to the constraint that no triangle is created. Similarly, various
authors studied â€œH-freeâ€ processes for other fixed graphs H, including stars [33] and
cycles [30, 7, 31, 34, 32]. In another relevant paper Krivelevich, Kwan, Loh, and
Sudakov [24] studied the process where edges are randomly added to a graph as long
as the matching number remains below a fixed value which may depend on the number
of vertices. This is indeed just a tiny sample of a rich and beautiful body of literature.
Here is a simple method to generate random k-regular graphs on n vertices: Start
with a Hamilton cycle, and repeatedly add perfect matchings uniformly at random
until the desired degree is attained. Since the present paragraph is intended only as
background, we do not go into detail, and do not dwell on how to avoid double edges.
We consider here a sequential variant of this algorithm, which produces graphs of girth
at least g. Let G = (V, E) be a graph on n vertices with all vertex degrees at most
k (in our main application, G is a Hamilton cycle, and k â‰¥ 3). Let g â‰¤ n. Set
G0 = G = (V, E0 ). We obtain Gt+1 = (V, Et+1 ) from Gt as follows:
â€¢ If Gt is k-regular, set Gt+1 = Gt .
â€¢ Otherwise:
â€“ Let d < k be the smallest vertex degree in Gt , and let Wt be the set of
unsaturated vertices in Gt , i.e., those with degree d.
â€“ We say that u, v âˆˆ Wt is an available pair of vertices if their distance in
Gt is at least g âˆ’ 1. Let At be the set of available pairs, and let Ht be the
graph (Wt , At ).
â€“ If At = âˆ…, set Gt+1 = Gt .
â€“ Otherwise, choose et+1 âˆˆ At uniformly at random, and set Et+1 = Et âˆª
{et+1 }.
We call this the (G, g, k)-high-girth-process. We say that the process saturates
if for some t, Gt is k-regular. We note that in this case girth(Gt ) â‰¥ min {g, girth(G)}.
Our main result is that with proper choice of parameters, this algorithm yields highgirth regular graphs.
Theorem 1.1. Let 1 > c > 0, k â‰¥ 3 an integer, and n an even integer. Let g = g(n) â‰¤
c logkâˆ’1 (n), and G be a Hamilton cycle on n vertices. Then, w.h.p.1, the (G, g, k)-highgirth-process saturates.
A byproduct of the analysis of this algorithm is a lower bound on the number of
high-girth regular graphs.
1We say that a sequence of events occurs with high probability (w.h.p.) if the probabilities of
their occurrence tend to 1.
2

Theorem 1.2. Let 1 > c > 0, k â‰¥ 3 an integer, and n an even integer. There are at
least (â„¦(n))kn/2 labeled k-regular graphs G on n vertices with girth(G) â‰¥ c logkâˆ’1 (n).
Remark 1.3. We do not give Theorem 1.2 in the best form known to us, since we believe
this is in any rate far from the truth.
We also mention that for c < 1/2, a remarkably accurate enumeration is given by
McKay, Wormald, and Wysocka [28, Corollary 2] who studied the distribution of the
number of cycles in random regular graphs. However, they do not give a construction,
and their method applies only when c < 1/2.
Theorem 1.2 illustrates one advantage of probabilistic constructions over algebraic
ones: While the latter achieve higher girth, they are sporadic and provide only a
small supply of examples. Similarly, purely deterministic constructions (such as ErdoÌ‹s
and Sachsâ€™s) tend to be restrictive and difficult to analyze. In contrast, probabilistic
techniques provide a viewpoint from which to study a very large family of high-girth
graphs.
In comparison with other results in the literature, ours is the first probabilistic
algorithm that constructs graphs with unbounded girth that are also regular. For
constant g, Osthus and Taraz [30, Corollary 4] determined (up to polylog factors) the
final number of edges in the H-free process, where H is the collection of all cycles shorter
than g. Bayati, Montanari, and Saberi [1] studied a similar sequential process which
samples uniformly from
 the family of girth-g graphs with m edges, where g is a constant
1+Î±(g)
and m = O n
, for some non-negative function Î±. Chandran [9] considered a
(deterministic) greedy algorithm to construct graphs with girth (1 + o (1)) logk (n) and
average degree k. However, none of these constructions produce regular graphs. Closer
to the algebraic end of the spectrum, Gamburd, Hoory, Shahshahani, Shalev, and ViraÌg
[16] showed that for various families of groups, random k-regular Cayley graphs have
unbounded girth that in some cases is as high as (1 âˆ’ o(1)) log kâˆ’1 (n).
The rest of this paper is organized as follows. The remainder of this section introduces some notations. In Section 2 we prove Theorem 1.1, modulo two technical claims
which are proved in Sections 3 and 4. We prove Theorem 1.2 in Section 5. We close
with some remarks and open problems in Section 6.
1.1. Notation. The vertex and edge sets of a graph G are denoted by V (G), resp.
E(G). We write e(G) = |E(G)|. The neighbor set of vertex v âˆˆ V (G) is denoted
Î“G (v). The distance between u, v âˆˆ V (G) is denoted Î´G (u, v). The graph of G induced
by U âŠ† V (G) is denoted G[U ].
The set {1, 2, . . . , a} is denoted by [a]. Also, [a]0 := {0, 1, 2, . . . , a}, and N0 :=
N âˆª {0}. For x, y âˆˆ R, we write x Â± y to indicate an unspecified number in the interval
[x âˆ’ |y|, x + |y|].
2. Constructing high-girth graphs: proof of Theorem 1.1
Let Gâ€²0 , Gâ€²1 , . . . be a (Gâ€² , g, k)-high-girth-process, where Gâ€² is a Hamilton cycle, and
c, k, n and g â‰¤ c logkâˆ’1 (n) are as in the theorem. We argue by induction on k,
starting with k = 3. Now, suppose Theorem 1.1 holds for k âˆ’ 1 â‰¥ 3. Then, since
3

g â‰¤ c logkâˆ’1 (n) < c logkâˆ’2 (n), it follows by induction that w.h.p. Gâ€²(kâˆ’2)n/2 is (k âˆ’ 1)regular. It is thus sufficient to prove the following proposition (which covers both the
base case and the inductive step).
Proposition 2.1. Let G be a (k âˆ’ 1)-regular graph on n vertices, with n even and
k â‰¥ 3. Let c < 1 and let g â‰¤ c logkâˆ’1 (n). Then, w.h.p., the (G, g, k)-high-girth-process
saturates.
Let G0 , G1 , . . . be a (G, g, k)-high-girth-process, and let e1 , e2 , . . . be the edges added
to the graph at each step. Clearly, a necessary and sufficient condition for the process
to saturate is that |Et | = (k âˆ’ 1)n/2 + t for every 0 â‰¤ t â‰¤ n/2. We say that the process
freezes at time t if t is the smallest integer such that Et = Et+1 . We denote this
time by Tf reeze (so that the process saturates if and only if Tf reeze = n/2).
Our proof deals separately with two phases of the process. In Section 2.1 we show
that in the first phase it holds with certainty that almost all vertices saturate, and Ht
is almost complete.
We begin Section 2.2 by observing that in the special case where c < 1/3, the analysis
in Section 2.1 suffices to conclude that the process saturates w.h.p. The remainder of
Section 2.2 is devoted to the more involved, â€œnibblingâ€-based analysis of the second
phase. We divide the remainder of the process into a bounded number of steps. We
show that in each step, the number of unsaturated vertices is reduced by a polynomial
factor, and that certain pseudorandomness conditions are preserved from step to step.
We then argue that w.h.p. the graph obtained at the end of the penultimate step has
a combinatorial property that implies the process saturates with certainty.
2.1. The early evolution of the process. Let 0 < Îµ < 1 âˆ’ c, and let

1
n âˆ’ nc+Îµ .
T =
2
The following observation follows from the Moore bound.
Observation 2.2. Let H be a graph with maximal degree at most k, and let â„“ âˆˆ N. For
every v âˆˆ V (H) there are at most k Â· (k âˆ’ 1)â„“âˆ’1 vertices at distance â„“ from v, and at
most 2k Â· (k âˆ’ 1)â„“ vertices at distance at most â„“ from v.
We next use this observation to show that for n sufficiently large Tf reeze â‰¥ T with
certainty, and for every t â‰¤ T , the graph Ht is nearly complete.
Lemma 2.3. There exists an integer n0 = n0 (c, Îµ) such that for all n â‰¥ n0 and every
t â‰¤ T it holds with certainty that:
(a)
(b)
(c)
(d)

All vertex degrees in Ht = (Wt , At ) are at least |Wt | âˆ’ O(nc ).
|At | = 12 |Wt |2 (1 âˆ’ O(nc /|Wt |)).
|Wt | = n âˆ’ 2t, and hence
Tf reeze â‰¥ T .

Proof. The two vertices of every edge in Et \ E0 have degree k, and every vertex of
degree k is in exactly one edge from Et \ E0 . Therefore: |Wt | = n âˆ’ 2|Et \ E0 | â‰¥ n âˆ’ 2t,
with equality if and only if t â‰¤ Tf reeze .
4

Let v âˆˆ Wt . By Observation 2.2, there are O(nc ) vertices in Gt with distance at
most g âˆ’ 2 to v. In Ht , v is adjacent to all other vertices in Wt . Therefore dHt (v) â‰¥
|Wt | âˆ’ O(nc ), as claimed. Hence,
1
1 X
dHt (v) = (1 âˆ’ O(nc /|Wt |)) |Wt |2 ,
|At | =
2
2
vâˆˆWt

as desired.
Finally, Tf reeze â‰¥ T as long as AT 6= âˆ…. As observed:
|WT | â‰¥ n âˆ’ 2T = nc+Îµ .

Hence, by (b):

 c 


1
n
2
|AT | = |WT | 1 âˆ’ O
= â„¦ n2(c+Îµ) .
2
|WT |

Thus, if n is large enough, then AT is nonempty with certainty, implying (c), (d).



The set Bt of forbidden edges is comprised of those pairs u, v âˆˆ Wt with uv âˆˆ
/ At .
We will show that for t â‰¥ T w.h.p. the number of forbidden edges in Gt does not exceed
the bound given by the following heuristic argument. Let u âˆˆ Wt . By Observation 2.2,
at most nc vertices v âˆˆ V satisfy Î´Gt (u, v) â‰¤ g âˆ’ 2. So, if v is chosen randomly
from V , then P[v âˆˆ Wt ] = |Wt |/n and P[Î´Gt (u, v) â‰¤ g âˆ’ 2] â‰¤ nc /n. Had these events
been independent, we expect there to p
be at most |Wt |2 nc /n pairs u, v âˆˆ Wt with
Î´H (u, v) â‰¤ g âˆ’ 2. Hence, when |Wt | â‰ª n/nc , we expect that Bt = âˆ…. We now show
that the latter condition implies that the process saturates with certainty.
Definition 2.4. Let G = (V, E) be a graph with all degrees either k âˆ’ 1 or k. We say
that G is safe if every two vertices of degree k âˆ’ 1 are at distance â‰¥ g âˆ’ 1.
Clearly Gt is safe if and only if Bt = âˆ….
Lemma 2.5. If for some t, Gt is safe, then the process saturates with certainty.
Proof. We first observe that if Gt is safe then Ht is the complete graph on Wt . Thus,
it is enough to show that if t < n/2, then At 6= âˆ… and Gt+1 is also safe. Suppose, for a
contradiction, that et+1 = uv for some u, v âˆˆ Wt , and that Gt+1 is not safe. Namely,
there exist two vertices a, b âˆˆ Wt+1 such that Î´Gt+1 (a, b) â‰¤ g âˆ’ 2. Let P be a shortest
ab-path in Gt+1 . By assumption, its length is at most g âˆ’ 2. But Gt is safe, whence
Î´Gt (a, b) â‰¥ g âˆ’ 1, so that necessarily uv âˆˆ P . It follows that in Gt there is a path of
length â‰¤ g âˆ’ 2 from one of the vertices a, b to one of u, v contrary to the assumption
that Gt is safe.

Here is the main technical ingredient in the analysis of the first T steps in the process.
An edge uv is a chord if it is not in the initial graph G. E.g., all edges chosen by the
process are chords.
Claim 2.6. Let a, b â‰¤ log2 (n). Let s1 , s2 , . . . , sa be distinct chords and let U âŠ† V be a
set of b vertices. Let 0 â‰¤ t1 , t2 , . . . , ta < T . Let A be the event that for every 1 â‰¤ i â‰¤ a,
the process chooses chord si at step ti (i.e., eti = si ), and that U âŠ† WT . Then

 a 
2T b
2
.
1âˆ’
P[A] â‰¤ (1 Â± o (1))
n2
n
5

It is easy to see where this expression comes from. Since |WT | = nâˆ’2T , it is plausible
that P[v âˆˆ WT ] â‰ˆ 1 âˆ’ 2T /n for every v âˆˆ V . Also, if edges are chosen uniformly at
random, ignoring the degree and girth constraints, then the probability of the event
et = s is (1 Â± o (1))2nâˆ’2 . The bound on P[A] says that the constraints can only reduce
this probability. This heuristic will be justified by Lemma 2.3: Throughout the first T
steps of the process, the graph of available edges Ht is nearly complete. Therefore, in
each of the first T steps, both the number of available edges and the number of available
edges incident to U are very close to what these values would be in the unconstrained
graph process. As a consequence, the two processes exhibit similar behavior.
Proof. Note that there is no loss in assuming that
â€¢ s1 , . . . , sa form a matching,
â€¢ t1 , . . . , ta are all distinct, and
â€¢ U is disjoint from the vertices in s1 , . . . , sa ,
for otherwise P[A] = 0 and the conclusion follows trivially.
The sequential nature of the process suggests that we express A as an intersection
of events B0 , B1 , . . . , BT , where Bt depends only on the chord selected at step t. For
0 â‰¤ t < T , let St = {si : ti > t} be the set of chords that are to be chosen after step
t. Let Ut = U âˆª {u : âˆƒs âˆˆ St , u âˆˆ s}. The definition of Bt depends on whether or not
t = ti for some i. If so, we let Bt be the event that chord si is selected at step t.
Otherwise, it is the event that we select at step t a chord disjoint from Ut . Clearly,
A = B0 âˆ© B1 âˆ© . . . âˆ© BT .
Therefore:
(1)

P[A] = P[B0 ] Ã— P[B1 |B0 ] Ã— P[B2 |B1 âˆ© B0 ] Ã— . . . Ã— P[BT âˆ’1 |B0 âˆ© . . . âˆ© BT âˆ’2 ].

By Lemma 2.3, for every t < T , we have



(n âˆ’ 2t)2
nc
.
|At | = 1 Â± O
n âˆ’ 2t
2
Therefore, for every i âˆˆ [a], it holds that


P[Bti |Bti âˆ’1 âˆ© . . . âˆ© B0 ] â‰¤ 1 + O

nc
n âˆ’ 2ti

It will be useful to note also that

a 
a
Y
Y
P[Bti |Bti âˆ’1 âˆ© . . . âˆ© B0 ] â‰¤
1+O

(2)



nc
n âˆ’ 2ti

2
.
(n âˆ’ 2ti )2



2
(n âˆ’ 2ti )2
i=1
i=1




a 
Y
2
2|Uti |
nc
â‰¤ (1 Â± o (1))
1âˆ’
.
1+O
n âˆ’ 2ti
(n âˆ’ 2ti )2
n âˆ’ 2ti
i=1

Consider next the case t âˆˆ
/ {t1 , . . . , ta }. The event B0 âˆ© . . . âˆ© Btâˆ’1 implies that
Ut âŠ† Wt , so by Lemma 2.3, Ut intersects at least





 

nc
|Ut |
nc
1Â±O
|Ut |(n âˆ’ 2t) Â±
|Ut |(n âˆ’ 2t)
= 1Â±O
n âˆ’ 2t
n âˆ’ 2t
2
6

chords in At . Thus:

nc
|Ut |(n âˆ’ 2t)
P[Bt |Btâˆ’1 âˆ© . . . âˆ© B0 ] â‰¤ 1 âˆ’ 1 Â± O
n âˆ’ 2t
|At |



c
2|Ut |
n
.
â‰¤1âˆ’ 1Â±O
n âˆ’ 2t
n âˆ’ 2t


(3)



Therefore, by (1), (2), and (3):
a
Y

(4)

T 
Y


!
2|Ut |
nc
P[A] â‰¤ (1 Â± o (1))
1âˆ’ 1Â±O
n âˆ’ 2t
n âˆ’ 2t
t=0
i=1
!
!


a
T 
Y
X
2
2|Ut |
nc
â‰¤ (1 Â± o (1))
exp âˆ’
1Â±O
(n âˆ’ 2ti )2
n âˆ’ 2t
n âˆ’ 2t
t=0
i=1
!
!
T
a
X
Y
2|Ut |
2
.
exp
âˆ’
â‰¤ (1 Â± o (1))
(n âˆ’ 2ti )2
n âˆ’ 2t
2
(n âˆ’ 2ti )2

!





t=0

i=1

We now estimate the sum in the exponent. By definition of Ut , we have:
|Ut | = |U | + 2 |St | = b + 2 |St | .
It follows that:
ti
ti
T
T
a X
T
a X
X
X
X
X
X
2|Ut |
2
4
1
1
=b
+
=b
+2
.
n âˆ’ 2t
n âˆ’ 2t
n âˆ’ 2t
n/2 âˆ’ t
n/2 âˆ’ t
t=0

We recall that

i=1 t=0

t=0

PL

k=â„“ 1/k

t=0

i=1 t=0

â‰¥ log (L/â„“) holds whenever â„“ â‰¤ L. Therefore:





a
T
X
X
n
n
2|Ut |
â‰¥ b log
log
.
+2
n âˆ’ 2t
n âˆ’ 2T
n âˆ’ 2ti
t=0

i=1

Plugging this into (4), we obtain:
a
Y



!
a
X
n âˆ’ 2ti
n âˆ’ 2T
P[A] â‰¤ (1 Â± o (1))
log
exp b log
+2
n
n
i=1
i=1
!!




a
Y
2
n âˆ’ 2ti 2
2T b
â‰¤ (1 Â± o (1))
1
âˆ’
(n âˆ’ 2ti )2
n
n
i=1
 a 
b
2
2T
â‰¤ (1 Â± o (1))
,
1âˆ’
2
n
n
2
(n âˆ’ 2ti )2

!



as claimed.



Claim 2.6 helps us bound the probability that ET contains a given set of edges:
Lemma 2.7. Let S be a set of a â‰¤ log2 n chords, and let u, v âˆˆ V be distinct vertices.
The probability that S âŠ† ET and that u, v âˆˆ WT is O(nâˆ’(a+2(1âˆ’câˆ’Îµ)) ).
7

Proof. Let s1 , . . . , sa be an ordering of the chords in S. We employ a union bound over
all times t1 , . . . , ta such that for every i, the chord chosen at step ti is si . By Claim 2.6
the probability that S âŠ† ET and both u and v have degree 2 in GT is at most
 a 
 a  c+Îµ 2 !

X
2
2
n
2T 2
(1 Â± o (1))
= O Ta
1âˆ’
2
2
n
n
n
n
0â‰¤t1 ,...,ta â‰¤T


1
,
=O
a+2(1âˆ’câˆ’Îµ)
n

as desired.



Lemma 2.7 allows us to bound the number of edges in BT . If uv âˆˆ BT , then GT
contains a path P from u to v of length â‰¤ g âˆ’ 2 such that:
â€¢ No two consecutive edges in P are chords.
â€¢ The first and the last edge in P are not chords.
A length-â„“ path in Kn satisfying these conditions is said to be â„“-threatening.
We also introduce several random variables that will allow us to bound the size of
Bt throughout the process. For â„“ â‰¤ g âˆ’ 2, we denote by Pâ„“ (Gt ) the number of pairs
u, v âˆˆ Wt such that Î´Gt (u, v) = â„“. Additionally, for v âˆˆ V , we denote by Pâ„“ (Gt , v) the
number of vertices u âˆˆ Wt such that Î´Gt (u, v) = â„“.
Lemma 2.8. Let â„“ âˆˆ N and let a âˆˆ N0 such that 2a + 1 â‰¤ â„“. Then Kn contains fewer
than na+1 (k âˆ’ 1)â„“ â„“-threatening paths containing a chords.
Proof. We prove the lemma by considering the number of â„“-threatening path with a
chords. There are n choices for the initial vertex. Since the first edge is not a chord, it
must be one of the k âˆ’ 1 edges in G that are incident to the initial vertex. Then, for
each subsequent edge, there are two possibilities:
â€¢ If the previous edge was a chord, the next edge must be one of the k âˆ’ 1 edges
in G incident to the current vertex.
â€¢ Otherwise, the next edge is either one of the k âˆ’ 2 non-backtracking edges
incident to the current vertex, or else it is a chord. In this case there are
n âˆ’ k < n choices for the chord.
Put differently, at each step, there are k âˆ’ 1 basic choices: Either the k âˆ’ 1 edges
incident to the current vertex, or else the k âˆ’ 2 non-backtracking edges incident to the
current vertex together with the choice â€œchordâ€. If the choice is â€œchordâ€, there are
(fewer than) n further choices of the specific chord. Since we are considering length-â„“
paths with a chords, the total number of choices is at most na+1 (k âˆ’ 1)â„“ , as desired. 
We next give upper bounds on Pâ„“ (GT ) and Pâ„“ (GT , v) for â„“ â‰¤ g âˆ’ 2 and v âˆˆ WT .
Lemma 2.9. The following hold w.h.p.:
â„“

log3 (n).
(a) For every â„“ â‰¤ g âˆ’ 2, Pâ„“ (GT ) â‰¤ |WT |2 (kâˆ’1)
n
(b) For every â„“ â‰¤ g âˆ’ 2 and every v âˆˆ WT , Pâ„“ (GT , v) â‰¤ (k âˆ’ 1)â„“ .
Proof. We calculate the expected number of length-â„“ paths between vertices in WT . By
Lemma 2.8, there are at most na+1 (k âˆ’ 1)â„“ â„“-threatening paths in Kn with a chords.
8

By Lemma 2.7, for each such path, the probability that it is contained in E(GT ) and
that its two endpoints are in WT is at most O nâˆ’aâˆ’2(1âˆ’câˆ’Îµ) . Therefore:
ï£«
ï£¶
ï£¶
ï£«
(â„“âˆ’1)/2 a+1
(â„“âˆ’1)/2 a+1
â„“
2(c+Îµ)
X n (k âˆ’ 1)â„“
X
n (k âˆ’ 1) ï£¸
ï£¸ = O ï£­n
E [Pâ„“ (GT )] = O ï£­
2
a+2(1âˆ’câˆ’Îµ)
n
na
n
a=0
a=0
ï£«
ï£¶


(â„“âˆ’1)/2
2
X
|WT |
(k âˆ’ 1)â„“
= Oï£­
(k âˆ’ 1)â„“ ï£¸ = O |WT |2
log(n) .
n
n
a=1

Therefore, by Markovâ€™s inequality, for every â„“, it holds that




â„“
1
3
2 (k âˆ’ 1)
log (n) = O
P Pâ„“ (GT ) â‰¥ |WT |
.
n
log2 (n)

Applying a union bound to the O(log(n)) random variables P1 (GT ), . . . , Pgâˆ’2 (GT ), we
conclude that w.h.p., for every 1 â‰¤ â„“ â‰¤ g âˆ’ 2, it holds that
Pâ„“ (GT ) â‰¤ |WT |2

(k âˆ’ 1)â„“
log3 (n),
n

as desired.
Part (b) follows from Mooreâ€™s bound (Observation 2.2). For every v âˆˆ WT there are
at most (k âˆ’ 1)â„“ vertices u âˆˆ V with Î´GT (u, v) = â„“. In particular, there are at most

(k âˆ’ 1)â„“ such vertices in WT .
2.2. The latter evolution of the process. Let
1
1
c(1 âˆ’ c)
, T = (n âˆ’ nc+Îµ ), Tsaf e = (n âˆ’ nÎµ ).
Îµ=
3
2
2
Our plan is to show that w.h.p. GTsaf e is safe.
Our analysis of the first T steps of the process used rather crude tools: Mooreâ€™s
bound, and a first-moment calculation. Analyzing the remaining steps of the process
is more involved. However, this more involved analysis is not necessary if already GT
is safe. This is indeed the case w.h.p. if c < 1/3, as we now show.
Proof of Theorem 1.1 when c < 1/3. Suppose c < 1/3. By Lemma 2.9, w.h.p., for
every 1 â‰¤ â„“ â‰¤ g âˆ’ 2, we have:
(k âˆ’ 1)â„“
(k âˆ’ 1)â„“
log3 (n) â‰¤ n2(c+Îµ)
log3 (n)
n
n
nc
â‰¤ n2c+2Îµ log3 (n) â‰¤ n3c+2Îµâˆ’1 log3 (n) = o (1).
n
Therefore, for every 1 â‰¤ â„“ â‰¤ g âˆ’ 2, it holds that Pâ„“ (GT ) = 0. In other words GT is
safe, as claimed.

Pâ„“ (GT ) â‰¤ |WT |2

We return to our main narrative with 1 > c â‰¥ 1/3. We define:
Î² = Îµ/10,

Î± = Î²/100.

We have chosen these particular constants for concreteness; all we need is that Î² is
sufficiently smaller than Îµ and that Î± is sufficiently smaller than Î². By Lemmas 2.3
and 2.9 the following hold w.h.p. (in fact, (a) - (c) hold with certainty):
9

(a) Tf reeze â‰¥ T .
(b) |WT | = n âˆ’ 2T = nc+Îµ .
(c) For every v âˆˆ WT and â„“ â‰¤ g âˆ’ 2, there holds Pâ„“ (GT , v) â‰¤ (k âˆ’ 1)â„“ =
(d) For every â„“ â‰¤ g âˆ’ 2, there holds Pâ„“ (GT ) â‰¤
| 2 nc

|WT |2 (kâˆ’1)â„“
n

(kâˆ’1)â„“
nc+Îµ |WT |.

log3 (n). In particular,

|BT | â‰¤ |WTn log4 (n).
These are pseudorandom properties of GT : The number of pairs of vertices in WT
at distance â„“ â‰¤ g âˆ’ 2 does not exceed its expectation by more than a polylog factor,
and no vertex in WT is close to too many other vertices in WT . As we show, if these
pseudorandomness conditions hold at step Tsaf e â‰¥ t â‰¥ T , then w.h.p. they persist
until step tâ€² = (n âˆ’ (n âˆ’ 2t)nâˆ’Î± )/2. In particular, between times t and tâ€² the number
of unsaturated vertices gets multiplied by nâˆ’Î± , while the number of forbidden pairs is
multiplied by nâˆ’2Î± (ignoring polylog factors). If we repeat this process (c+Îµ)/Î± = O(1)
times, then w.h.p. no forbidden pairs remain, i.e., the graph is safe. By Lemma 2.5,
this implies that the process saturates.
We make this precise in the next lemma, which is the heart of our proof. It is useful
to introduce the following real function L:


(k âˆ’ 1)â„“ (n âˆ’ 2t)
.
L(â„“, t) = max 1,
nc+Îµ
We now formally define the pseudorandomness properties.

Definition 2.10. For C > 0 we say that Gt is C-path-bounded if:
(a) Pâ„“ (Gt , v) â‰¤ L(â„“, t) logC (n) for every v âˆˆ Wt and every â„“ â‰¤ g âˆ’ 2.
2
â„“
(b) Pâ„“ (Gt ) â‰¤ |Wt | (kâˆ’1)
logC (n) for every â„“ â‰¤ g âˆ’ 2.
n
We remark that for every C there exists some n0 = n0 (C) such that if n â‰¥ n0 and
Gt is C-path-bounded for some T â‰¥ t â‰¥ Tsaf e , then |Wt | = n âˆ’ 2t. This is because (b)
implies that |Bt | = O |Wt |2 nc logC (n)/n = o(|Wt |2 ). Therefore, if n is large enough
then At is not empty, meaning Tf reeze â‰¥ t, and |Wt | = n âˆ’ 2t.
Lemma 2.11. There is a function D = D(C) such that for every Tsaf e â‰¥ t â‰¥ T , if Gt
is C-path-bounded then, for tâ€² = (n âˆ’ (n âˆ’ 2t)nâˆ’Î± )/2, w.h.p. Gtâ€² is D-path-bounded.
Lemma 2.11, yields Proposition 2.1, and hence Theorem 1.1.
Proof of Proposition 2.1. Define the sequence of integers t0 = T , and for i â‰¥ 0, ti+1 :=
(n âˆ’ (n âˆ’ 2ti )nâˆ’Î± )/2. Let m := (c + Îµ)/Î±. Clearly m = O(1). We observe that for every
i â‰¤ m, there holds (n âˆ’ 2ti )2 = (n âˆ’ 2t)2 nâˆ’2Î±i . In particular, (n âˆ’ 2tm )2 ncâˆ’1 = nâˆ’â„¦(1) .
As observed above, Gt0 = GT is C0 := 3-path-bounded. Therefore, by Lemma 2.11,
w.h.p. Gt1 is C1 := D(C0 )-path-bounded. Proceeding by induction, we conclude that
w.h.p. Gtm is Cm -path-bounded, with Cm = O(1). In particular, |Wtm | = n âˆ’ 2tm and
|Btm | â‰¤ |Wtm |2 ncâˆ’1 logCm (n) = (n âˆ’ 2tm )2 ncâˆ’1 = o (1). Namely, Btm = âˆ…, i.e., Gtm is
safe, and by Lemma 2.5 the process saturates.

We turn to prove Lemma 2.11. We wish to analyze the tâ€² âˆ’ t = |Wt |(1 âˆ’ nâˆ’Î± )/2 steps
of the process Gt , Gt+1 , . . . , Gtâ€² . We do so by viewing the process as taking place in
two stages: Recall that Ht = (Wt , At ) is the graph of available edges. In the first stage,
10

we take a random subgraph H âŠ† Ht , where V (H) = Wt and every edge in E(Ht ) = At
is included in E(H) with probability p := nÎ² /|Wt | (with all choices independent). We
also define the graph Gâ€² = (V, E(Gt ) âˆª E(H)). In the second stage, we run the highgirth process beginning from Gt , but using only the edges in E(H). This is similar to
the â€œhonest nibbleâ€ used by Grable [20] to analyze random greedy triangle packing.
The advantage of this approach is that we can use standard tools for analyzing
random binomial graphs to obtain properties of H and Gâ€² . Significantly, there are
very few ways that adding a matching from H to Gt might create a cycle shorter than
g. This implies that the high-girth process run â€œinsideâ€ Gâ€² behaves similarly to the
random greedy matching algorithm in H. Finally, H is sufficiently regular that the
random greedy matching algorithm in H succeeds, with high probability, in matching
all but at most |Wt |nâˆ’Î± vertices in Wt .
Formally, we define the process Gâ€²t , Gâ€²t+1 , . . . as follows. To start, Gâ€²t = Gt . Given Gâ€²i ,
if there exist edges uv âˆˆ E(H) such that dGâ€²i (u) = dGâ€²i (v) = k âˆ’ 1, and Î´Gâ€²i (u, v) â‰¥ g âˆ’ 1,
then choose such an edge e uniformly at random and set Gâ€²i+1 = (V (G), E(Gâ€²i ) âˆª {e}).
If no such edges exist, set Gâ€²i+1 = Gâ€²i . Let Tfâ€² reeze be the smallest integer i such that
Gâ€²i = Gâ€²i+1 .
We couple Gt , Gt+1 , . . . , Gtâ€² and Gâ€²t , Gâ€²t+1 , . . . , Gâ€²tâ€² by setting Gi = Gâ€²i for every t <
i â‰¤ Tfâ€² reeze . For i > Tfâ€² reeze , we obtain Gi+1 from Gi independently of Gâ€²i+1 .
Clearly, for every i â‰¥ t, it holds that E(Gâ€²i ) âŠ† E(Gâ€² ). We will show that w.h.p.
â€²
Tf reeze â‰¥ tâ€² , and hence Gtâ€² = Gâ€²tâ€² . It will then follow from the analysis of the process
Gâ€²0 , . . . , Gâ€²tâ€² that Gtâ€² is D-path-bounded for an appropriate D.
In order to track the process Gâ€²t , Gâ€²t+1 , . . ., we first identify the pairs of vertices
u, v âˆˆ Wt that might have distance â‰¤ g âˆ’ 2 in Gâ€²tâ€² . We observe that since Gâ€²tâ€² âŠ† Gâ€² , if
Î´Gâ€² â€² (u, v) = â„“ â‰¤ g âˆ’ 2 then there exists a sequence of vertices w0 , w1 , . . . , w2mâˆ’1 in Wt
t
such that:
â€¢ w0 = u and w2mâˆ’1 = v.
â€¢ For every 1 â‰¤ i â‰¤ m âˆ’ 1, it holds that w2iâˆ’1 w2i âˆˆ E(H).
â€¢ m âˆ’ 1 + Î´Gt (w0 , w1 ) + Î´Gt (w2 , w3 ) + . . . + Î´Gt (w2mâˆ’2 , w2mâˆ’1 ) = â„“.
This is similar to the observation in Section 2.1 that uv âˆˆ BT only if the chords from a
threatening path in Kn were chosen in the first T steps of the process. We say that a
pair of vertices u, v âˆˆ Wt is â„“-threatened if there exists a sequence of vertices satisfying
these conditions. In this case, we say that the sequence w0 , . . . , w2mâˆ’1 witnesses this
fact.
We remark that the notion of an â„“-threatened pair of vertices is similar, but distinct
from, the notion of an â„“-threatening path. Indeed, the latter refers to the specific path,
while the former to the endpoints. Furthermore, â„“-threatening paths are allowed to
use any chord from Kn , whereas if w0 , . . . , w2mâˆ’1 is a witness that w0 , w2mâˆ’1 are â„“threatened then the edges w1 w2 , w3 w4 , . . . , w2mâˆ’2 w2mâˆ’1 must be in the random graph
H.
For 1 â‰¤ â„“ â‰¤ g âˆ’ 2, let Tâ„“ denote the number of â„“-threatened pairs in Wt . For a vertex
v âˆˆ Wt , let Tâ„“ (v) denote the number of â„“-threatened pairs that include v.
11

In the next claim we establish pseudorandom properties of H and Gâ€² . These follow
from standard techniques in the analysis of functions of independent random variables.
In order not to interrupt the narrative, we defer the proof to Section 3.
Claim 2.12. There exists a function Q = Q(C) such that for every Tsaf e â‰¥ t â‰¥ T if
Gt is C-path-bounded then, with H and Gâ€² defined as above, the following hold w.h.p.:

(a) For every v âˆˆ Wt , dH (v) = 1 Â± nâˆ’0.4Î² nÎ² .
â„“

(b) For every â„“ â‰¤ g âˆ’ 2 it holds that Tâ„“ â‰¤ |Wt |2 (kâˆ’1)
logQ (n).
n
(c) For every v âˆˆ Wt and every â„“ â‰¤ g âˆ’ 2 it holds that Tâ„“ (v) â‰¤ L(â„“, t) log Q (n).
(d) For every v âˆˆ Wt there are at most log(n) vertices u âˆˆ Wt such that uv âˆˆ E(H)
and u, v are â„“-threatened for some â„“ â‰¤ g âˆ’ 2.
(e) For every S âŠ† Wt such that |S| â‰¤ |Wt |/nÎµ/2 , it holds that e (H[S]) â‰¤ |S|n0.9Î² .

We turn to establish properties of the process Gâ€²t , Gâ€²t+1 , . . .. For s âˆˆ N0 , let Us denote
the set of degree-(k âˆ’ 1) vertices in Gâ€²t+s . Our intuition is that for every s â‰¤ tâ€² âˆ’ t,
Us resembles a random subset of Wt with density 1 âˆ’ 2s/|Wt |. This implies, first, that
Tfâ€² reeze â‰¥ tâ€² , and therefore Gtâ€² = Gâ€²tâ€² . Second, this means that for â„“ â‰¤ g âˆ’ 2, the
number of â„“-threatened pairs in Gâ€² in which both vertices remain unsaturated in Gtâ€²
is approximately (|Utâ€² |/|Wt |)2 Tâ„“ = nâˆ’2Î± Tâ„“ . A similar statement holds for â„“-threatened
pairs that contain a specific vertex. We conclude that Gtâ€² is, w.h.p., D-path-bounded
for an appropriate D.
Claim 2.13. There exists a function D = D(Q) such that if H and Gâ€² satisfy conclusions (a)-(e) of Claim 2.12 then, for tâ€² = (n âˆ’ (n âˆ’ 2t)nâˆ’Î± )/2, w.h.p. Gtâ€² is D-pathbounded.
While Claim 2.13 follows from methods developed to study random greedy hypergraph matching (e.g., [2] and [25, Section 4]), it does not seem to follow directly from
any explicit result in the literature. For completenessâ€™ sake we prove it in Section 4.
We are now ready to prove Lemma 2.11.
Proof of Lemma 2.11. Suppose that for Tsaf e â‰¥ t â‰¥ T and C âˆˆ R, Gt is C-pathbounded. Let H and Gâ€² be as above and let tâ€² = (n âˆ’ (n âˆ’ 2t)nâˆ’Î± )/2 be as in the
statement of Lemma 2.11. Then, w.h.p. H and Gâ€² satisfy the conclusions of Claim 2.12
for some Q = Q(C). Consequently, by Claim 2.13, w.h.p. Gtâ€² is D-path-bounded for
some D = D(Q).

3. Proof of Claim 2.12
Claim 2.12 follows from standard arguments in the analysis of functions of independent random variables. We recall the following version of Chernoffâ€™s inequality.
Theorem 3.1 (Chernoffâ€™s Inequality). Let X1 , X2 , . . . , XN be independent Bernoulli
P
random variables, let X = N
i=1 Xi , and let Î´ âˆˆ (0, 1). Then:


1 2
P [|X âˆ’ E[X]| â‰¥ Î´E[X]] â‰¤ 2 exp âˆ’ Î´ E[X] .
3
12

We use a theorem of Kim and Vu to show concentration of multivariate polynomials.
The setup is this: Let Y = (V (Y ), E(Y )) be a hypergraph where the largest hyperedge
size is K = O(1) and |V (Y )| = Ï‰ (1). Let {Xv }vâˆˆV (Y ) be a collection of independent
Bernoulli random variables. Consider the random variable:
X Y
X=
Xv .
eâˆˆE(Y ) vâˆˆe

For every S âŠ† V (Y ), define the random variable:
X
Y
XS =
Xv .
SâŠ†eâˆˆE(Y ) vâˆˆe\S

For every i âˆˆ [K]0 let
Âµi =

max E [XS ] .

)
Sâˆˆ(V (Y
i )

Finally, let Âµ = max0â‰¤iâ‰¤K Âµi . Here is a consequence of the Main Theorem in [23].
Theorem 3.2. In the setup above, there exists a constant D > 0 such that



P X â‰¥ Âµ logD (|V (Y )|) = exp âˆ’â„¦ log2 (|V (Y )|) .
Proof of Claim 2.12. Recall that we have defined the function




(k âˆ’ 1)â„“ |Wt |
(k âˆ’ 1)â„“ (n âˆ’ 2t)
= max 1,
.
L(â„“, t) = max 1,
nc+Îµ
nc+Îµ
For brevity, throughout this proof we write

L(â„“) := L(â„“, t).
By assumption, for every v âˆˆ Wt and every â„“ â‰¤ g âˆ’ 2, it holds that Pâ„“ (Gt , v) â‰¤
L(â„“) logC (n). Therefore, the number of forbidden edges incident to v does not exceed

gâˆ’2 
gâˆ’2
gâˆ’2
X
X
X
(k âˆ’ 1)â„“ |Wt |
C
C
1+
L(â„“) log (n) â‰¤ log (n)
Pâ„“ (Gt , v) â‰¤
nc+Îµ
â„“=1
â„“=1
â„“=1


|Wt |
â‰¤ 1 + Îµ logC+1 (n).
n
Recalling that t â‰¤ Tsaf e = (n âˆ’ nÎµ )/2, it follows that |Wt | â‰¥ nÎµ . Thus:
gâˆ’2
X

Pâ„“ (Gt , v) â‰¤

â„“=1

Therefore:

|Wt |
logC+2 (n).
nÎµ

|Wt |
logC+2 (n).
nÎµ
By definition, dH (v) is distributed binomially with parameters (dHt (v), p). In particular, E [dH (v)] = (1 Â± nâˆ’Îµ logC+2 (n))nÎ² . Applying Chernoffâ€™s inequality we obtain:





n0.6Î²
dHt (v) â‰¤ exp âˆ’â„¦ n0.2Î² .
P |dH (v) âˆ’ pdHt (v)| >
2|Wt |
dHt (v) = |Wt | Â±

13

Next apply a union bound to the vertices in Wt , and conclude that w.h.p. for every
v âˆˆ Wt :


n0.6Î²
dH (v) = pdHt (v) Â±
dHt (v) = 1 Â± nâˆ’0.4Î² nÎ² ,
2|Wt |
as desired.
We now prove (b). Suppose that u, v âˆˆ Wt are â„“-threatened for some â„“ â‰¤ g âˆ’ 2.
Then there is a sequence u = w0 , . . . , w2mâˆ’1 = v in Wt witnessing this fact. Now, the
number of sequences w0 , . . . , w2mâˆ’1 âˆˆ Wt such that Î´Gt (w0 , w1 ) + Î´Gt (w2 , w3 ) + . . . +
Î´Gt (w2mâˆ’2 , w2mâˆ’1 ) = â„“ âˆ’ m + 1 is bounded from above by
m
Y

X

Pâ„“i (Gt ).

â„“1 +...+â„“m =â„“âˆ’m+1 i=1

For each such sequence, the probability that all of the edges w1 w2 , . . . , w2mâˆ’3 w2mâˆ’2
are in E(H) is pmâˆ’1 . This yields the following bound:
(â„“+1)/2

E [Tâ„“ ] â‰¤

X

X

pmâˆ’1

X

X

mâˆ’1

m=1 â„“1 +...+â„“m =â„“âˆ’m+1
(â„“+1)/2

â‰¤

(k âˆ’ 1)â„“
â‰¤
p

(â„“+1)/2 
X
m=1

Pâ„“i (Gt )

i=1

p

m=1 â„“1 +...+â„“m =â„“âˆ’m+1

m
Y

m
Y
(k âˆ’ 1)â„“i
i=1

p|Wt |2 logC (n)
n

n

m 

|Wt |2 logC (n)


â„“âˆ’m
mâˆ’1


m

(â„“+1)/2  Î²
(k âˆ’ 1)â„“ X
n |Wt |â„“ logC (n)
(k âˆ’ 1)â„“
2
C+1
â‰¤
|Wt | log
(n) .
=O
p
n
n
m=1

Hence, by Markovâ€™s inequality:




1
(k âˆ’ 1)â„“
2
C+3
|Wt | log
(n) = O
P Tâ„“ â‰¥
.
n
log2 (n)

Applying a union bound to the O(log(n)) random variables T1 , . . . , Tgâˆ’2 we conclude
â„“

C+3
2
(n), as desired.
that w.h.p., for every â„“ â‰¤ g âˆ’ 2, it holds that Tâ„“ â‰¤ (kâˆ’1)
n |Wt | log
In order to prove (c), we must bound |Wt |(g âˆ’ 2) = O(|Wt | log(n)) random variables.
For a union bound, it suffices to show that there exists a constant D = D(C) such that
for every v âˆˆ Wt and â„“ â‰¤ g âˆ’ 2,




1
D
.
P Tâ„“ (v) â‰¥ L(â„“) log (n) = O
|Wt | log2 (n)

Let v âˆˆ Wt , â„“ â‰¤ g âˆ’ 2, and m âˆˆ N. Let Tâ„“m (v) be the number of vertices u âˆˆ Wt such
that u, v are â„“-threatened and there exists a witness with 2m vertices. Then Tâ„“ (v) â‰¤
P(â„“+1)/2 m
Tâ„“ (v). We plan to use Theorem 3.2 to bound Tâ„“ (v). However, Theorem
m=1
3.2 applies only to polynomials with constant degree, whereas Tâ„“ (v) corresponds to a
polynomial with unbounded degree. To get around this, we first show that for large
14

values of m, Tâ„“m (v) = 0 with sufficiently high probability. Let M = âŒˆ(1âˆ’câˆ’Îµâˆ’Î²)âˆ’1 âŒ‰ =
O(1). We will show that
ï£¹
ï£®


(â„“+1)/2
X
1
C+1
m
ï£»
ï£°
(n) = O
Tâ„“ (v) â‰¥ L(â„“) log
(5)
P
.
|Wt | log2 (n)
m=M
We first observe that:

M âˆ’1
|Wt |nÎ² logC+1 (n)
1
â‰¤
|Wt |M nâˆ’(M âˆ’1)(1âˆ’Î²) logO(1) (n)
n
|Wt |
1 M (c+Îµ)âˆ’(M âˆ’1)(1âˆ’Î²)
1 1âˆ’Î²âˆ’M (1âˆ’câˆ’Îµâˆ’Î²) O(1)
(6)
â‰¤
n
logO(1) (n) â‰¤
n
log
(n)
|Wt |
|Wt |
â‰¤

1
nâˆ’â„¦(1)
.
â‰¤
|Wt |
|Wt | log2 (n)

Now, by considerations similar to those used to bound E [Tâ„“ ]:
ï£®
ï£¹
(â„“+1)/2
(â„“+1)/2
m
X
X
X
Y
Eï£°
Tâ„“m (v)ï£» â‰¤
pmâˆ’1
Pâ„“i (Gt )
Pâ„“1 (Gt , v)
m=M

m=M

i=2

â„“1 +...+â„“m =â„“âˆ’m+1

(â„“+1)/2

mâˆ’1

|Wt |2 logC (n)
n
m=M
M âˆ’1

|Wt |nÎ² logC+1 (n)
C+1
â‰¤ L(â„“) log
(n)
n

â‰¤

X



L(â„“) logC (n) â„“p

(6)

â‰¤ L(â„“) logC+1 (n)

1
.
|Wt | log2 (n)

Inequality (5) follows from Markovâ€™s inequality.
We now use Theorem 3.2 to bound Tâ„“m (v), for m < M . For every e âˆˆ E(Ht ), let Xe
be the indicator of the event e âˆˆ E(H). For m < M , let Tâ„“m (v) be the collection of
potential witnesses of length 2m to the fact that for some u âˆˆ Wt , u, v are â„“-threatened.
In other words, Tâ„“m (v) is the collection of sequences v = w0 , w1 , . . . , w2mâˆ’1 âˆˆ Wt such
that:
â€¢ For every 1 â‰¤ i â‰¤ m âˆ’ 1, w2iâˆ’1 w2i âˆˆ E(Ht ) and
â€¢ Î´Gt (w0 , w1 ) + Î´Gt (w2 , w3 ) + . . . + Î´Gt (w2mâˆ’2 , w2mâˆ’1 ) = â„“ âˆ’ m + 1.
For conciseness, for P âˆˆ Tâ„“m (v) and i âˆˆ [m âˆ’ 1], we write ei (P ) = w2iâˆ’1 w2i . We also
write â„“i (P ) = Î´Gt (w2(iâˆ’1) , w2iâˆ’1 ). Now consider the polynomial
Yâ„“ (v) =

M
âˆ’1
X
m=1

Tâ„“m (v)

=

M
âˆ’1
X

X

mâˆ’1
Y

Xei (P ) .

m=1 P âˆˆTâ„“m (v) i=1

We will show that there exists a constant D > 0 (independent of â„“ and v) such that:



P Yâ„“ (v) â‰¥ L(â„“) logD (n) = exp âˆ’â„¦ log2 (n) .
15

For S âŠ† E(Ht ) and m âˆˆ [M âˆ’ 1], define the set:
Tâ„“m (v, S) = {P âˆˆ Tâ„“m (v) : S âŠ† {e1 (P ), . . . , emâˆ’1 (P )}} .
Since deg Yâ„“ (v) < M = O(1), by Theorem 3.2 it suffices to show that there exists a
constant B such that for every S âŠ† E(Ht ) of cardinality M âˆ’ 1 or less, it holds that

E [Yâ„“ (v)S ] =

M
âˆ’1
X
m=1


pmâˆ’1âˆ’|S| |Tâ„“m (v, S)| = O L(â„“) logB (n) .

For this it is enough to show that for every S âŠ† E(Ht ) and every m < M :


|Tâ„“m (v, S)| = O p|S|âˆ’m+1 L(â„“) logB (n) .

(7)

Let S âŠ† E(Ht ) satisfy |S| â‰¤ M âˆ’ 1. We make the following observations: Suppose
that for m < M âˆ’ 1, P = w0 , . . . , w2mâˆ’1 âˆˆ Tâ„“m satisfies S âŠ† {e1 (P ), . . . , emâˆ’1 (P )}.

In particular, m â‰¥ |S| + 1. Furthermore, there exists an index set I âˆˆ [mâˆ’1]
such
|S|
that for every i âˆˆ I, ei (P ) âˆˆ S. This implies that for every i âˆˆ I, w2i is contained
in one of the edges in S. Therefore, since Gt is C-path-bounded, w2i+1 is one of the
O(Pâ„“i (P ) (Gt , w2i )) = O(L(â„“i (P )) log C (n)) vertices at distance â„“i (P ) from S. Using
these insights, we may now bound |Tâ„“m (v, S)|.
Start with the case where |S| = m âˆ’ 1. In this case, for every P = w0 , . . . , w2mâˆ’1 âˆˆ
Tâ„“m (v), it holds that S = {e1 (P ), . . . , emâˆ’1 (P )}. Therefore, each of w1 , . . . , w2mâˆ’2
is contained in an edge in S, and the only remaining freedom is in the choice of
w2mâˆ’1 . Additionally, w2mâˆ’1 is at distance at most â„“ from S. As mentioned, there
are O(L(â„“) logC (n)) such vertices. Therefore, in this case:

|Tâ„“m (v, S)| = O L(â„“) logC (n) ,

confirming (7).
We now assume that |S| < m âˆ’ 1. In this case:
|Tâ„“m (v, S)|
â‰¤

X

â„“1 +...+â„“m =â„“âˆ’m+1

Pâ„“1 (Gt , v)

X

Iâˆˆ([mâˆ’1]
|S| )

Y

iâˆ’1âˆˆI

!ï£«

O L(â„“i ) logC (n) ï£­

Since Gt is C-path-bounded, for every a â‰¤ g âˆ’ 2 it holds that
Pa (Gt ) â‰¤

(k âˆ’ 1)a |Wt |2 logC (n)
.
n
16

Y

iâˆ’1âˆˆ[mâˆ’1]\I

ï£¶

Pâ„“i (Gt )ï£¸ .

Similarly, Pa (Gt , v) â‰¤ L(a) logC (n) â‰¤ (kâˆ’1)a logC (n). Therefore, for every â„“1 + . . . + â„“m =

it holds that:
â„“ âˆ’ m + 1 and every I âˆˆ [mâˆ’1]
|S|
Y

Pâ„“1 (Gt , v)

iâˆ’1âˆˆI

!ï£«

O L(â„“i ) logC (n) ï£­

Y

iâˆ’1âˆˆ[mâˆ’1]\I

= O logCm (n)(k âˆ’ 1)â„“1 +...+â„“m
= O log

Furthermore, it holds that
ï£«

Cm

mâˆ’1
|S|

|Tâ„“m (v, S)| = O ï£­logCm (n)
= O logCm (n)

â„“

(n)(k âˆ’ 1)



|Wt |2
n



|Wt |2
n

ï£¶

Pâ„“i (Gt )ï£¸

mâˆ’1âˆ’|S| !

mâˆ’1âˆ’|S| !

.

= O(1). Thus:

X

(k âˆ’ 1)â„“

â„“1 +...+â„“m =â„“âˆ’m+1



nÎ² |Wt |
pn

mâˆ’1âˆ’|S|



|Wt |2
n
!

mâˆ’1âˆ’|S|

ï£¶
ï£¸

â„“m (k âˆ’ 1)â„“


nÎ² |Wt |
â„“
(k âˆ’ 1)
=O p
log
(n)
n




â„“
|S|âˆ’m+1 (k âˆ’ 1) |Wt |
|S|âˆ’m+1
=O p
=
O
p
L(â„“)
,
nc+Îµ


|S|âˆ’m+1

(C+1)m

as desired.
We prove (d) by exposing E(H) in two rounds: Let v âˆˆ Wt , and let E(Ht , v) denote
the set of edges in E(Ht ) that are incident to v. We first expose E1 := E(H) \
E(Ht , v), and then E2 := E(H) âˆ© E(Ht , v). We note that E1 and E2 are independent.
Furthermore, the random variables Y1 (v), Y2 (v), . . . , Ygâˆ’2 (v), as well as the set W âŠ† Wt
of vertices u âˆˆ Wt such that u, v are â„“-threatened are determined by
proof
i
h E1 . From the
D
(n)
=
of (c) it follows that there exists a constant D = D(C) such that P |W | â‰¥ |Wt | log
nÎµ

o |Wt |âˆ’1 .
We want to bound |W âˆ© Î“H (v)|. We observe that given E1 (and hence W ), W âˆ©Î“H (v)
is a binomial random subset of W with density parameter p. Therefore, for any s â‰¤
|Wt | logD (n)
, conditioned on |W | = s, it holds that:
nÎµ
P [|W âˆ© Î“H (v)| â‰¥ log(n)] â‰¤
â‰¤



|Wt | logD (n) nÎ²
Â·
nÎµ
|Wt |




s
plog(n) â‰¤ (sp)log(n)
log(n)

log(n)
17


= exp âˆ’â„¦ log2 (n) .

Therefore, using the law of total probability:
P [|W âˆ© Î“H (v)| â‰¥ log(n)]

 

|Wt | logD (n)
|Wt | logD (n)
â‰¤P |W âˆ© Î“H (v)| â‰¥ log(n) |W | â‰¤
P
|W
|
â‰¤
nÎµ
nÎµ




D
|Wt | log (n)
1
+ P |W | >
=o
.
nÎµ
|Wt |
By applying a union bound to all |Wt | vertices, we conclude that w.h.p., for every
v âˆˆ Wt , |W âˆ© Î“H (v) â‰¤ log(n), as desired.
Finally, we prove (e). For âˆ… =
6 S âŠ† Wt such that |S| â‰¤ |Wt |/nÎµ/2 , let XS be the
indicator of the event that e (H[S]) â‰¥ |S|n0.9Î² . Now, e (H[S]) is distributed binomially
with parameters e (Ht [S]) â‰¤ |S|2 /2 and p. Hence, by a union bound:
i  |S|2 /2 
h
0.9Î²
0.9Î²
â‰¤
p|S|n .
E[XS ] = P e (H[S]) â‰¥ |S|n
0.9Î²
|S|n

a
Applying the inequality b â‰¤ (ea/b)b , we obtain:
E[XS ] â‰¤



e|S|2 p
|S|n0.9Î²

|S|n0.9Î²

â‰¤



e|S|nÎ²
n0.9Î² |Wt |

|S|n0.9Î²

â‰¤



en0.1Î²
nÎµ/2

|S|n0.9Î²

.

Applying a union bound over all such sets S, we have:
ï£®
ï£¹
  0.1Î² kn0.9Î²
|Wt |nâˆ’Îµ/2
|Wt |nâˆ’Îµ/2 
X
X
|Wt |
en
ï£¯ X
ï£º
Eï£°
XS ï£» â‰¤
k
nÎµ/2
k=1
k=1
Sâˆˆ(Wkt )
n0.9Î² !k
|Wt |nâˆ’Îµ/2 
|nâˆ’Îµ/2 
n0.9Î² k |WtX
X
e|Wt | 
e
2e
= o (1).
â‰¤
â‰¤
Îµ/2âˆ’0.1Î²
Îµ/2âˆ’0.1Î²
k
n
n
k=1
k=1

By Markovâ€™s inequality, w.h.p., for every such set S, it holds that XS = 0, which is
equivalent to (e).

4. Proof of Claim 2.13
We prove Claim 2.13 by showing that w.h.p. various parameters associated with the
process Gâ€²t , Gâ€²t+1 , . . . remain close to their expected trajectories. This is motivated by
the differential equation method of Wormald [37], and is similar to the approach taken
by Bennett and Bohman [2] in their analysis of random greedy hypergraph matching.
As similar results are abundant in the literature, we aim for the simplest exposition
and not the sharpest analysis.
We use the following supermartingale inequality of Warnke [35, Lemma 2.2 and
Remark 10]. This is a variation on a martingale inequality of Freedman [14, Theorem
1.6].
Theorem 4.1. Let X0 , X1 , . . . be a supermartingale with respect to ahfiltration F0 , F1 , .i. ..
Pjâˆ’1
2
Suppose that |Xi+1 âˆ’ Xi | â‰¤ K for all i, and let V (j) =
i=0 E (Xi+1 âˆ’ Xi ) |Fi .
18

Then, for any Î», v > 0,
Î»2
P [Xi > X0 + Î» and V (i) â‰¤ v for some i] â‰¤ exp âˆ’
2(v + KÎ»/3)




.

In our application, we find some v such that V (i) â‰¤ v for all i. For this v, Theorem
4.1 tells us that for every Î» > 0:


Î»2
.
P [Xi > X0 + Î»] â‰¤ exp âˆ’
2(v + KÎ»/3)
We now introduce the random variables we wish to track. Recall that Us is the set
of unsaturated (i.e., degree-(k âˆ’ 1)) vertices in Gâ€²t+s , where s is a non-negative integer.
In particular, U0 = Wt and for every s â‰¤ Tfâ€² reeze âˆ’ t, it holds that Us = Wt+s and
|Us | = |Wt | âˆ’ 2s. For a vertex v âˆˆ Wt , let N (v, s) = |Î“H (v) âˆ© Us | be the number of
neighbors of v in H that are unsaturated at time s + t. We also define the functions
p(s) = 1 âˆ’

2s
,
|Wt |

n(s) = nÎ² p(s),

Îµ(s) =

n0.6Î²
.
p(s)8

We observe that for 0 â‰¤ Tfâ€² reeze âˆ’ t it holds that p(s) = |Us |/|Wt |.
Recall that tâ€² = (n âˆ’ |Wt |nâˆ’Î± )/2. We show that w.h.p., for every v âˆˆ Wt and every
0 â‰¤ s â‰¤ tâ€² âˆ’ t, it holds that
(8)

N (v, s) = n(s) Â± Îµ(s).

The guiding intuition is that Î“H (v) âˆ© Us behaves like a random subset of Î“H (v) with
density p(s). Since by Claim 2.12 (a) Î“H (v) â‰ˆ nÎ² , it follows that N (v, s) is approximated by n(s).
We define the stopping time Ï„ as the minimum between tâ€² âˆ’ t and the first time that
(8) fails for some v âˆˆ Wt .
A naive attempt to prove (8) might be to show that N (v, s) âˆ’ n(s) is a martingale. However, this is not quite true, as the expected one-step change might be nonzero. To remedy this, we consider two shifted random variables that are obtained from
N (v, s) âˆ’ n(s) and âˆ’(N (v, s)âˆ’ n(s)), respectively, by subtracting an error term. These
turn out to be supermartingales, enabling us to apply Theorem 4.1. For every v âˆˆ Wt ,
we define:
(
N (v, s) âˆ’ n(s) âˆ’ 12 Îµ(s) s â‰¤ Ï„
+
,
N (v, s) =
N + (v, s âˆ’ 1)
s>Ï„
(
âˆ’N (v, s) + n(s) âˆ’ 12 Îµ(s) s â‰¤ Ï„
âˆ’
.
N (v, s) =
N âˆ’ (v, s âˆ’ 1)
s>Ï„
The fact that these random variables â€œfreezeâ€ at time Ï„ is crucial as it allows us to
assume that (8) holds when calculating the maximal and expected one-step changes.
We say that uv âˆˆ E(H) is available at time s if u, v âˆˆ Us and Î´Gâ€²t+s (u, v) â‰¥ g âˆ’ 1.
For v âˆˆ Us , let A(v, s) be the set of available edges at time s that are incident to v. We
note that A(v, s) âŠ† {vu : u âˆˆ Î“H (v) âˆ© Us } (the cardinality of this last set is N (v, s)).
In general, this inclusion might be strict because there may be vertices u âˆˆ Î“H (v) âˆ© Us
19

with Î´Gâ€²t+s (u, v) < g âˆ’ 1 (however, it is true that A(v, 0) = {vu : u âˆˆ Î“H (v) âˆ© U0 }).
Nevertheless, the difference between the sets is small.
Claim 4.2. For every 0 â‰¤ s â‰¤ tâ€² âˆ’ t and every v âˆˆ Us , it holds that |A(v, s)| â‰¥
N (v, s) âˆ’ log(n). Consequently, if Ï„ > s, then |A(v, s)| = n(s) Â± 1.1Îµ(s).
Proof. By assumption, Gâ€² satisfies the conclusions of Claim 2.12. In particular, (d)
implies that there are at most log(n) vertices u âˆˆ Us âŠ† Wt such that u âˆˆ Î“H (v) and
such that u, v are â„“-threatened for some â„“ < g âˆ’ 1. Since Gâ€²t+s is a subgraph of Gâ€² , this
holds for Gâ€²t+s as well, and the claim follows.
We now observe that for every s â‰¤ tâ€² âˆ’ t, Îµ(s) â‰¥ Îµ(0) = n0.6Î² > 10 log(n). Therefore,
if Ï„ > s:
|A(v, s)| = N (v, s) Â± log(n) = n(s) Â± (Îµ(s) + log(n)) = n(s) Â± 1.1Îµ(s).

âˆ’
âˆ
Claim 4.3. For every v âˆˆ Wt , the sequences {N + (v, s)}âˆ
s=0 and {N (v, s)}s=0 are
supermartingales with respect to the filtration induced by {Gâ€²t+s }âˆ
s=0 . Furthermore, for
every 0 â‰¤ s â‰¤ tâ€² âˆ’ t, it holds that


 

5nÎ²
E N âˆ’ (v, s + 1) âˆ’ N âˆ’ (v, s) , E N + (v, s + 1) âˆ’ N + (v, s) â‰¤
.
|Wt |

Proof. We show that {N + (v, s)}âˆ
s=0 is a supermartingale for every v âˆˆ Wt . The proof
is
similar.
We
need to show that for every s â‰¥ 0, it holds that
for {N âˆ’ (v, s)}âˆ
s=0
 +

(9)
E N (v, s + 1) âˆ’ N + (v, s)|Gâ€²t , Gâ€²t+1 , . . . , Gâ€²t+s â‰¤ 0.

We apply the law of total probability. We first observe that if Ï„ â‰¤ s, then, by definition,
N + (v, s + 1) = N + (v, s), so (9) holds. It thus suffices to show that


E N + (v, s + 1) âˆ’ N + (v, s)|Gâ€²t+s âˆ§ Ï„ â‰¥ s + 1 â‰¤ 0.

We therefore assume that Ï„ â‰¥ s + 1. By Claim 4.2 this implies that for every u âˆˆ Us ,
it holds that |A(u, s)| = n(s) Â± 1.1Îµ(s). In particular, this holds for every vertex in
Î“H (v) âˆ© Us . Finally, the number of available edges is equal to |Us | (n(s) Â± 1.1Îµ(s)) /2.
Therefore:
X


2
E N (v, s + 1) âˆ’ N (v, s)|Gâ€²t+s âˆ§ Ï„ â‰¥ s + 1 = âˆ’
|A(u, s)|
|Us | (n(s) Â± 1.1Îµ(s))
uâˆˆÎ“H (v)âˆ©Us


2
2(n(s) Â± 1.1Îµ(s))
2n(s)
2N (v, s)(n(s) Â± 1.1Îµ(s))
3.5Îµ(s)
=âˆ’
=âˆ’
=âˆ’
1Â±
|Us |(n(s) Â± 1.1Îµ(s)
|Us |(n(s) Â± 1.1Îµ(s))
|Us |
n(s)
=âˆ’

2nÎ²
7Îµ(s)
Â±
.
|Wt |
|Us |

Next, we observe that:
n(s + 1) âˆ’ n(s) = âˆ’
20

2nÎ²
.
|Wt |

Finally, we note that:



1
p(s)8
1
n0.6Î²
Îµ(s + 1) âˆ’ Îµ(s) = n
âˆ’
âˆ’1
=
p(s + 1)8 p(s)8
p(s)8 p(s + 1)8
!

8
|Wt | âˆ’ 2s
= Îµ(s)
âˆ’1
|Wt | âˆ’ 2s âˆ’ 2
!


2 âˆ’8
âˆ’1 .
= Îµ(s)
1âˆ’
|Us |
0.6Î²



Hence, by Taylorâ€™s Theorem (recalling that |Us | â‰¥ nâˆ’Î± |Wt | = Ï‰ (1)):


 

16
1
16Îµ(s) 18Îµ(s)
Îµ(s + 1) âˆ’ Îµ(s) = Îµ(s)
+O
,
âˆˆ
.
|Us |
|Us |2
|Us |
|Us |
Therefore:


E N + (v, s + 1) âˆ’ N + (v, s)|Gâ€²t+s âˆ§ Ï„ â‰¥ s + 1


1
= E N (v, s + 1) âˆ’ N (v, s)|Gâ€²t+s âˆ§ Ï„ â‰¥ s + 1 âˆ’ (n(s + 1) âˆ’ n(s)) âˆ’ (Îµ(s + 1) âˆ’ Îµ(s))
2


2nÎ²
7Îµ(s)
8Îµ(s)
2nÎ²
â‰¤ âˆ’
Â±
âˆ’
â‰¤ 0,
+
|Wt |
|Us |
|Wt |
|Us |
as desired.
We also observe that the estimates above imply:


E N + (v, s + 1) âˆ’ N + (v, s)

1
(Îµ(s + 1) âˆ’ Îµ(s))
2
7Îµ(s)
2nÎ²
9Îµ(s)
4nÎ²
16Îµ(tâ€² âˆ’ t)
4nÎ²
16n0.6Î²
2nÎ²
+
+
+
â‰¤
+
=
+ âˆ’8Î±
.
â‰¤
|Wt |
|Us |
|Wt |
|Us |
|Wt |
|Utâ€² âˆ’t |
|Wt | n
|Wt |

â‰¤ E [N (v, s) âˆ’ N (v, s + 1)] + n(s) âˆ’ n(s + 1) +

Recalling that Î± = Î²/100, we obtain:

as claimed.



5nÎ²
E N + (v, s + 1) âˆ’ N + (v, s) â‰¤
,
|Wt |



In order to apply Theorem 4.1, we first note that the maximal one-step change in
N (v, s) is 2. Furthermore, for every s â‰¤ tâ€² âˆ’ t, |n(s + 1) âˆ’ n(s)|, Îµ(s + 1) âˆ’ Îµ(s) = o (1).
Therefore, the maximal one-step change in N + (v, s) and N âˆ’ (v, s) is bounded from
above by 3. Hence, for every 1 â‰¤ s â‰¤ tâ€² âˆ’ t, it holds that:
â€²

V (s) â‰¤ V (t âˆ’ t) â‰¤ 3

tâ€²X
âˆ’tâˆ’1
i=0

â‰¤ 3(tâ€² âˆ’ t)

5nÎ²
|Wt |



E N + (v, i + 1) âˆ’ N + (v, i) |Gâ€²t+i

 
= O nÎ² .
21

By applying Theorem 4.1 with K = 3, Î» = Îµ(s)/2 and v = nÎ² log(n), we conclude that
for every w âˆˆ Wt and every 0 â‰¤ s â‰¤ tâ€² âˆ’ t:





 +

Îµ(s)2 /4
Î²/100
.
P N (w, s) â‰¥ Îµ(s)/2 â‰¤ exp âˆ’
=
exp
âˆ’â„¦
n
2(nÎ² log(n) + 3Îµ(s)/2)

Applying a union bound to the O |Wt |2 choices for v and s, we conclude that w.h.p.,
for every v âˆˆ Wt and 0 â‰¤ s â‰¤ tâ€² âˆ’ t, it holds that N + (v, s) â‰¤ 12 Îµ(s). A similar
calculation implies the analogous result for N âˆ’ (v, s). This implies that Ï„ â‰¥ tâ€² âˆ’ t.
therefore, w.h.p., for every v âˆˆ Wt and 0 â‰¤ s â‰¤ tâ€² âˆ’ t, it holds that
N (v, s) = n(s) Â± Îµ(s).
In particular, this implies that Tfâ€² reeze â‰¥ tâ€² . Therefore, Gtâ€² = Gâ€²tâ€² . Thus Utâ€² âˆ’t = Wtâ€² .
In order to show that Gtâ€² is path-bounded we estimate the probability that a given
set of vertices is in Utâ€² âˆ’t .
Claim 4.4. Let A âŠ† Wt satisfy |A| â‰¤ |Wt |/nÎµ/2 . Then:
P [A âŠ† Utâ€² âˆ’t ] = (1 Â± o (1))nâˆ’Î±|A| .
Proof. Similar to the proof of Claim 2.6, we denote by Bs the event that A âŠ† Us , and
observe that:
P [A âŠ† Utâ€² âˆ’t ] = P [B1 ] Ã— P [B2 |B1 ] Ã— . . . Ã— P [Btâ€² âˆ’t |Btâ€² âˆ’tâˆ’1 ] .
Using the law of total probability, for every s â‰¤ tâ€² âˆ’ t it holds that
P [Bs |Bsâˆ’1 ] = P [Bs |Bsâˆ’1 âˆ§ Ï„ â‰¥ s] P [Ï„ â‰¥ s] + P [Bs |Bsâˆ’1 âˆ§ Ï„ < s] P [Ï„ < s] .

âˆ’0.3Î² n(s) available
Now, if Ï„ â‰¥ s, then every vertex
in
U
is
incident
to
1
Â±
n
sâˆ’1

edges, and there are 1 Â± nâˆ’0.3Î² |Us |n(s)/2 available edges in total. Furthermore,
0.9Î² . Hence A
by assumption, H satisfies
Therefore e (H[A])
 Claim 2.12 (e).
 â‰¤ |A|n
âˆ’0.3Î²
0.9Î²
âˆ’0.05Î²
is incident to 1 Â± n
|A|n(s) Â± |A|n
= 1Â±n
|A|n(s) available edges.
Thus:
! 




1 Â± nâˆ’0.05Î² |A|n(s)
âˆ’0.04Î² 2|A|
= 1âˆ’ 1Â±n
.
P [Bs |Bsâˆ’1 âˆ§ Ï„ â‰¥ s] = 1 âˆ’
(1 Â± nâˆ’0.3Î² ) |Us |n(s)/2
|Us |

Since P [Ï„ â‰¤ tâ€² ] = exp âˆ’â„¦(nÎ²/100 ) , we conclude that:







âˆ’0.04Î² 2|A|
P [Bs |Bsâˆ’1 ] = 1 âˆ’ 1 Â± n
.
1 Â± exp âˆ’â„¦ nÎ²/100
|Us |

Thus:

P [A âŠ† Utâ€² âˆ’t ] =

â€² âˆ’t
tY

P [Bs |Bsâˆ’1 ] = (1 Â± o (1))nâˆ’Î±|A| .

s=1



We can now use Markovâ€™s inequality to show that Gtâ€² satisfies Definition 2.10 (b).
Recall that for â„“ â‰¤ g âˆ’ 2, Tâ„“ is the number of â„“-threatened pairs in Gâ€² . By Claim 2.12
â„“
Q
2
(b), Tâ„“ â‰¤ (kâˆ’1)
n |Wt | log (n). By Claim 4.4, the expected number of these pairs that
are also contained in Utâ€² âˆ’t is at most (1 Â± o (1))nâˆ’2Î± Tâ„“ â‰¤
22

(kâˆ’1)â„“
2 âˆ’2Î± logQ (n)
n |Wt | n

=

(kâˆ’1)â„“
Q
2
â€²
n |Wt | log (n).

Applying Markovâ€™s inequality and a union bound, we conclude
â„“

Q+2
2
â€²
that w.h.p., for every â„“ â‰¤ g âˆ’ 2, Pâ„“ (Gtâ€² ) â‰¤ (kâˆ’1)
(n).
n |Wt | log
Finally, we show that Gtâ€² satisfies Definition 2.10 (a) . Let v âˆˆ Wt and let â„“ â‰¤ g âˆ’ 2.
Let A = Aâ„“ (v) be the set of vertices u âˆˆ Wt such that u, v is â„“-threatened in Gâ€² . Then
|A| = Tâ„“ (v), and by assumption Tâ„“ (v) â‰¤ L(â„“, t) logQ (n). We will bound the probability

A
that |A âˆ© Wtâ€² | â‰¥ L(â„“, tâ€² ) logQ+1 (n). By Claim 4.4, for every B âˆˆ L(â„“,tâ€² ) log
Q+1
(n) , it
holds that:
Q+1
â€²
P [B âŠ† Wtâ€² ] = (1 Â± o (1))nâˆ’Î±L(â„“,t ) log (n) .

Therefore, by a union bound:


â€²

P |A âˆ© Wtâ€² | â‰¥ L(â„“, t ) log

Q+1

a
b


(n) â‰¤




|A|
Q+1
â€²
(1 Â± o (1))nâˆ’Î±L(â„“,t ) log (n) .
Q+1
â€²
L(â„“, t ) log
(n)

â‰¤ (ea/b)b , it follows that:

L(â„“,tâ€² ) logQ+1 (n)


e|A|
â€²
Q+1
(n) â‰¤ (1 Â± o (1))
P |A âˆ© Wtâ€² | â‰¥ L(â„“, t ) log
.
nÎ± L(â„“, tâ€² ) logQ+1 (n)

Applying the inequality

Observing that L(â„“, t) â‰¤ nÎ± L(â„“, tâ€² ), and that |A| â‰¤ L(â„“, t) logQ (n), we have:
L(â„“,tâ€² ) logQ+1 (n)

Q


eL(â„“,
t)
log
(n)
P |A âˆ© Wtâ€² | â‰¥ L(â„“, tâ€² ) logQ+1 (n) â‰¤ (1 Â± o (1))
nÎ± L(â„“, tâ€² ) logQ+1 (n)
L(â„“,tâ€² ) logQ+1 (n)

e
= nâˆ’Ï‰(1) .
â‰¤ (1 Â± o (1))
log(n)

We apply a union bound over the O(|Wt | log(n)) choices of v and â„“ to conclude that
w.h.p., for every v âˆˆ Wtâ€² and every â„“ â‰¤ gâˆ’2, it holds that |Aâ„“ (v)âˆ©Wtâ€² | â‰¤ L(â„“, tâ€² ) logQ+1 (n).
Therefore, for D = Q + 2, w.h.p. Gtâ€² is D-path-bounded.
5. Counting high-girth graphs: proof of Theorem 1.2
Let k, c, n be as in the statement of Theorem 1.2. Let g = c logkâˆ’1 (n). We prove the
theorem by considering the number of (labeled) graphs that can be produced by the
(G, g, k)-high-girth process, with G a random Hamilton cycle on n vertices. First, there
are n!/(2n) choices for the Hamilton cycle G. In Lemma 2.3 we showed that if, for d â‰¥ 3,
Gâ€² is a (d âˆ’ 1)-regular graph on n vertices, then for every 0 â‰¤ t â‰¤ T := (n âˆ’ nc+Îµ)/2,
the (Gâ€² , g, d)-high-girth process has (1 âˆ’ o (1))(n âˆ’ 2t)2 /2 available edges. Thus, the
total number of choices in this phase is equal to
 
T +1 Y

T 
T 
Y
n2
2t 2
(n âˆ’ 2t)2
= (1 âˆ’ o (1))
1âˆ’
N (d) :=
(1 âˆ’ o (1))
2
2
n
t=0
t=0

n/2
n2
= (1 âˆ’ o (1)) 2
2e

By Proposition 2.1, w.h.p. the (Gâ€² , g, d)-high-girth-process succeeds in constructing a
d-regular graph. Therefore the number of successful runs of the algorithm is at least
23

(1 âˆ’ o (1))N (d). Returning to the (G, g, k)-high-girth-process, we conclude that the
number of successful runs for this algorithm is at least

(kâˆ’2)n/2

n!
n2
n n
(1 âˆ’ o (1)) N (3) Ã— N (4) Ã— . . . Ã— N (k) = (1 Â± o (1))
.
(1 âˆ’ o (1)) 2
2n
e
2e

Let H be one of the k-regular graphs that the (G, g, k)-high-girth-process can produce. Then H is the disjoint union of the Hamilton cycle G and the (k âˆ’ 2)-regular
graph H â€² of the chords chosen by the process. There are fewer than e(H â€² )! ways in
which the process can construct H â€² , according to the order in which the edges of H â€²
are added. Furthermore, since H is k-regular, it contains fewer than kn Hamilton cycles. This serves as an upper bound on the number of possible choices for G. Since
e(H â€² ) = (k âˆ’ 2)n/2, the algorithm can produce at least
(kâˆ’2)n/2
((1 Â± o (1))n/e)n (1 âˆ’ o (1))n2 / 2e2
= (â„¦(n))kn/2
n
k ((k âˆ’ 2)n/2)!
different graphs, as claimed.
We remark that the enumeration can be improved by employing better estimates of
the number of Hamiltonian cycles and one-factorizations in regular graphs. However,
even for the case of cubic graphs, it seems unlikely that the best known bounds [17]
yield a tight result.
6. Concluding remarks and open problems

â€¢ A natural and interesting variation of our algorithm starts with n isolated
vertices rather than a Hamilton cycle. At each step we add a uniformly chosen
edge subject to the constraints that all vertex degrees remain â‰¤ k and the girth
remains â‰¥ g (this is in contrast to our own process where we only connect
vertices of minimum degree). RucinÌski and Wormald [33] studied this process
without the girth constraint, and showed that w.h.p. the process yields a regular
graph. We believe that ideas from the present work can be modified to show
that even for g = c logkâˆ’1 (n) (with c < 1) the process is likely to produce a
k-regular graph. However, new complications arise, which presumably require
Wormaldâ€™s differential equation method. We leave this to future work.
â€¢ To what extent do our graphs resemble random regular graphs? Numerical
experiments that we have conducted suggest that they are Ramanujan, or at
least nearly Ramanujan. For reference recall Friedmanâ€™s famous result [15] that
almost all regular graphs are nearly Ramanujan.
â€¢ The large-scale geometry of graphs holds many open questions. Thus, it is
not hard to show that every n-vertex k-regular graph of girth g has at most
nk
g/2 cycles of length g. On the other hand in LPS graphs the numg (k âˆ’ 1)
ber is â„¦Ìƒ(n4/3 ) [8], and no graphs are known for which this number is larger.
Our numerical calculations suggest that in our graphs this number is in fact
Î˜k ((k âˆ’ 1)g /g). It would also be interesting to determine the smallest Î³ =
Î³(n, k, g) such that every girth-g k-regular graph on n vertices has a set of Î³
edges that intersects every g-cycle.
24

The possible relation between a graphâ€™s girth and its diameter is particularly
intriguing. It follows from [12] and Mooreâ€™s bound that
girth(G)
â‰¥ 1,
diam(G)
where the lim sup ranges over all graphs where all vertex degrees are â‰¥ 3.
Nothing better seems to be known at the moment.
Even more remarkably, we do not know whether
2 â‰¥ lim sup

sup(girth(G) âˆ’ diam(G))
is finite or not. The sup is over all G in which all vertex degrees are â‰¥ 3.
References
[1] Mohsen Bayati, Andrea Montanari, and Amin Saberi, Generating random graphs with large girth,
Proceedings of the twentieth annual ACM-SIAM symposium on Discrete algorithms, Society for
Industrial and Applied Mathematics, 2009, pp. 566â€“575.
[2] Patrick Bennett and Tom Bohman, A natural barrier in random greedy hypergraph matching,
Combinatorics, Probability and Computing (2012), 1â€“10.
[3] NL Biggs and MJ Hoare, The sextet construction for cubic graphs, Combinatorica 3 (1983), no. 2,
153â€“165.
[4] Norman Biggs, Constructions for cubic graphs with large girth, the Electronic Journal of Combinatorics 5 (1998), no. 1, 1.
[5] Tom Bohman, The triangle-free process, Advances in Mathematics 221 (2009), no. 5, 1653â€“1677.
[6] Tom Bohman and Lutz Warnke, Large girth approximate Steiner triple systems, Journal of the
London Mathematical Society (2018).
[7] BeÌla BollobaÌs and Oliver Riordan, Constrained graph processes, The Electronic Journal of Combinatorics 7 (2000), no. 1, R18.
[8] Maxime Fortier Bourque and Bram Petri, Kissing numbers of regular graphs, arXiv preprint
arXiv:1909.12817 (2019).
[9] L Sunil Chandran, A high girth graph construction, SIAM journal on Discrete Mathematics 16
(2003), no. 3, 366â€“370.
[10] Patrick Chiu, Cubic Ramanujan graphs, Combinatorica 12 (1992), no. 3, 275â€“285.
[11] Xavier Dahan, Regular graphs of large girth and arbitrary degree, Combinatorica 34 (2014), no. 4,
407â€“426.
[12] Paul ErdoÌ‹s and Horst Sachs, RegulaÌˆre graphen gegebener taillenweite mit minimaler knotenzahl,
Wiss. Z. Martin-Luther-Univ. Halle-Wittenberg Math.-Natur. Reihe 12 (1963), no. 251-257, 22.
[13] Paul ErdoÌˆs, Stephen Suen, and Peter Winkler, On the size of a random maximal graph, Random
Structures & Algorithms 6 (1995), no. 2-3, 309â€“318.
[14] David A Freedman, On tail probabilities for martingales, the Annals of Probability 3 (1975), no. 1,
100â€“118.
[15] Joel Friedman, A proof of Alonâ€™s second eigenvalue conjecture and related problems, American
Mathematical Soc., 2008.
[16] Alexander Gamburd, Shlomo Hoory, Mehrdad Shahshahani, Aner Shalev, and Balint ViraÌg, On
the girth of random Cayley graphs, Random Structures & Algorithms 35 (2009), no. 1, 100â€“117.
[17] Heidi Gebauer, Enumerating all Hamilton cycles and bounding the number of Hamilton cycles in
3-regular graphs, The Electronic Journal of Combinatorics 18 (2011), no. 1, P132.
[18] Stefan Glock, Daniela KuÌˆhn, Allan Lo, and Deryk Osthus, The existence of designs via iterative
absorption, arXiv preprint arXiv:1611.06827 (2016).
[19]
, On a conjecture of ErdoÌ‹s on locally sparse Steiner triple systems, arXiv preprint
arXiv:1802.04227 (2018).
[20] David A Grable, On random greedy triangle packing, the Electronic Journal of Combinatorics 4
(1997), no. 1, P11.
25

[21] Shlomo Hoory, On graphs of high girth, Ph.D. thesis, Hebrew University of Jerusalem Israel, 2002.
[22] Peter Keevash, The existence of designs, arXiv preprint arXiv:1401.3665 (2014).
[23] Jeong Han Kim and Van H Vu, Concentration of multivariate polynomials and its applications,
Combinatorica 20 (2000), no. 3, 417â€“434.
[24] Michael Krivelevich, Matthew Kwan, Po-Shen Loh, and Benny Sudakov, The random k-matchingfree process, Random Structures & Algorithms 53 (2018), no. 4, 692â€“716.
[25] Matthew Kwan, Almost all Steiner triple systems have perfect matchings, arXiv preprint
arXiv:1611.02246 (2016).
[26] Felix Lazebnik, Vasiliy A Ustimenko, and Andrew J Woldar, A new series of dense graphs of high
girth, Bulletin of the American mathematical society 32 (1995), no. 1, 73â€“79.
[27] Alexander Lubotzky, Ralph Phillips, and Peter Sarnak, Ramanujan graphs, Combinatorica 8
(1988), no. 3, 261â€“277.
[28] Brendan D McKay, Nicholas C Wormald, and Beata Wysocka, Short cycles in random regular
graphs, The Electronic Journal of Combinatorics 11 (2004), no. 1, 66.
[29] Moshe Morgenstern, Existence and explicit constructions of q + 1 regular Ramanujan graphs for
every prime power q, Journal of Combinatorial Theory, Series B 62 (1994), no. 1, 44â€“62.
[30] Deryk Osthus and Anusch Taraz, Random maximal H-free graphs, Random Structures & Algorithms 18 (2001), no. 1, 61â€“82.
[31] Michael E Picollelli, The final size of the C4 -free process, Combinatorics, Probability and Computing 20 (2011), no. 6, 939â€“955.
[32]
, The final size of the Câ„“ -free process, SIAM Journal on Discrete Mathematics 28 (2014),
no. 3, 1276â€“1305.
[33] Andrzej RucinÌski and Nicholas C Wormald, Random graph processes with degree restrictions,
Combinatorics, Probability and Computing 1 (1992), no. 2, 169â€“180.
[34] Lutz Warnke, The Câ„“ -free process, Random Structures & Algorithms 44 (2014), no. 4, 490â€“526.
[35]
, On the method of typical bounded differences, Combinatorics, Probability and Computing
25 (2016), no. 2, 269â€“299.
[36] Alfred Weiss, Girths of bipartite sextet graphs, Combinatorica 4 (1984), no. 2-3, 241â€“245.
[37] Nicholas C Wormald, The differential equation method for random graph processes and greedy
algorithms, Lectures on approximation and randomized algorithms 73 (1999), 73â€“155.
Department of Computer Science, The Hebrew University of Jerusalem, Jerusalem
91904, Israel
E-mail address: nati@cs.huji.ac.il
Institute of Mathematics and Federmann Center for the Study of Rationality, The
Hebrew University of Jerusalem, Jerusalem 91904, Israel
E-mail address: menahem.simkin@mail.huji.ac.il

26

