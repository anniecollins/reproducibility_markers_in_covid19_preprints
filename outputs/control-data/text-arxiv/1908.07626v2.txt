Optimal Investment with Correlated Stochastic Volatility Factors
Maxim Bichuch

‚àó

Jean-Pierre Fouque

‚Ä†

arXiv:1908.07626v2 [q-fin.MF] 4 Jun 2020

Monday 8th June, 2020

Abstract
The problem of portfolio allocation in the context of stocks evolving in random environments, that is
with volatility and returns depending on random factors, has attracted a lot of attention. The problem
of maximizing a power utility at a terminal time with only one random factor can be linearized thanks to
a classical distortion transformation. In the present paper, we address the problem with several factors
using a perturbation technique around the case where these factors are perfectly correlated reducing the
problem to the case with a single factor. We illustrate our result with a particular model for which we
have explicit formulas. A rigorous accuracy result is also derived using a verification result for the HJB
equation involved. In order to keep the notations as explicit as possible, we treat the case with one stock
and two factors and we describe an extension to the case with two stocks and two factors.

AMS subject classification 91G80, 60H30.
JEL subject classification G11.
Keywords Optimal investment, asymptotic analysis, utility maximization, stochastic volatility.

1

Introduction

The portfolio optimization problem was first introduced and studied in the continuous-time framework in
[16, 17], which provided explicit solutions on how to trade stocks and/or how to consume so as to maximize
one‚Äôs utility, with risky assets following the Black-Scholes-Merton model (that is, geometric Brownian motions
with constant returns and constant volatilities), and when the utility function is of specific types (for instance,
Constant Relative Risk Aversion (CRRA)).
Stochastic volatility models have been widely studied over the last thirty years in the context of option
pricing and the presence of several factors driving volatility has been well documented (see for instance [9],
[12] and references therein). In general settings, the models are intractable and often asymptotic solutions
are sought, see e.g. [19], [10], [11], [5].
In a general setting, [15] showed existence and uniqueness of an optimal strategy using the duality
approach. As an alternative approach, in a Markovian setting, the portfolio optimization problem with factors
driving returns and volatility can be solved directly be describing it as a solution to an HJB equation with
terminal condition given by the utility function. Example of the latter approach in a portfolio optimization
problem with multiscale factor models for risky assets include [13], where return and volatility are driven
by fast and slow factors. Specifically, the authors heuristically derived the asymptotic approximation to the
value function and the optimal strategy for general utility functions. This analysis is complemented in [6]
and in [7] in a non-Markovian context. The multiscale feature is essential to be able to consider multiple
factors, because each factor requires a unique time scale. The analysis simplifies considerably in the case of
‚àó Department of Applied Mathematics & Statistics, Johns Hopkins University, Baltimore, MD 21218, USA mbichuch@jhu.edu.
Work is partially supported by NSF grant DMS-1736414. Research is partially supported by the Acheson J. Duncan Fund for
the Advancement of Research in Statistics.
‚Ä† Department of Statistics and Applied Probability, South Hall 5504, University of California Santa Barbara, CA 93106
fouque@pstat.ucsb.edu. Work supported by NSF grant DMS-1814091.

1

a single factor and power utilities thanks to a distortion transformation which linearizes the problem (see
[20], [13], [7]).
Our aim in this paper is to solve a problem with multiple factors of the same time scale. We do so by
considering the case with multi factors and power utility as a perturbation problem around the case where
the factors are perfectly correlated which in turns allows for an explicit solution given by a linear problem.
Additionally, we find a ‚Äúnearly-optimal‚Äù strategy, among all admissible strategies, without limiting them to
strategies that asymptotically a-priori converge to the zeroth order strategy. The ‚Äúnearly-optimal‚Äù strategy,
if followed, produces an expected utility of the terminal wealth matching the value function at both zeroth
and first order asymptotic expansion.
The main idea of this paper is to first calculate a heuristic asymptotic expansion in the correlation
parameter. Then, based on this expansion, we derive a verification result for the HJB equation, which in
turn, allows us to bound the value function from above and below similar to the method used e.g. in [2] and
[3]. This procedure also produces a ‚Äúnearly-optimal‚Äù strategy, and shows that the expected utility of the
terminal wealth associated with this strategy is also within the same bounds as the value function.
The rest of the paper is structured in the following way. In Section 2, we study in details the case of
investments in one stock and a risk-free account where the returns and volatility of the stock are driven
by two factors. Our asymtotics around the case of perfect correlation between these two factors reveals a
simple correction to the value function, which takes into account an imperfect correlation as well as a simple
strategy which generates the corrected value function.
In Section 3, we extend the model studied in [4] which admits explicit formulas and enables us to illustrate
the accuracy of our approximation. A proof of this accuracy is given in Section 4.
Finally, to demonstrate that our approach generalizes to the case with multi assets, we consider in Section
5.1 two assets driven by two factors nearly fully correlated. We also extend the model of [4] in that case and
we discuss the difference with the models considered in [1].

2

Models with one Stock and two Factors

We consider a model with a stock price driven by two correlated stochastic volatility factors:
dS(t)
= ¬µ(Z1 (t), Z2 (t))dt + œÉ(Z1 (t), Z2 (t)) dW (t),
S(t)
dZi (t) = Œ±i (Zi (t)) dt + Œ≤i (Zi (t)) dBi (t) i = 1, 2.

(1)
(2)

The three Brownian motions B1 , B2 , and W are defined on a filtered probability space (‚Ñ¶, F, (Ft )t‚â•0 , P). We
assume that the two Brownian motions B1 , B2 are correlated according to d hB1 , B2 it = œÅ12 dt, and that they
are correlated to the Brownian motion W according to d hW, Bi it = œÅi dt, i = 1, 2, with constant coefficients
œÅ12 , œÅ1 , œÅ2 such that |œÅ12 | ‚â§ 1, |œÅ1 | < 1, |œÅ2 | < 1 and
1 + 2œÅ1 œÅ2 œÅ12 ‚àí œÅ21 ‚àí œÅ22 ‚àí œÅ212 ‚â• 0.

(3)

Throughout the paper, we work under standing classical hypotheses on the coefficients of the system (1)-(2)
ensuring existence and uniqueness of a strong solution.
We assume also that the market contains a bond, that carries zero interest rate for convenience. Let œÄt
be the number of shares of stock held at time t. Thus, the evolution of the wealth process Xt following the
self-financing strategy œÄt is given by:
dX(t) = œÄt

dS(t)
= œÄt ¬µ(Z1 (t), Z2 (t))dt + œÄt œÉ(Z1 (t), Z2 (t)) dW (t),
S(t)

(4)

and the value function of the optimal investment problem with terminal time T and utility U is the following:
v(t, x, z1 , z2 ) = sup Et,x,z1 ,z2 [U(XT )] ,

(5)

œÄ

where Et,x,z1 ,z2 [¬∑] denotes the conditional expectation E[¬∑|X(t) = x, Z1 (t) = z1 , Z2 (t) = z2 ], and the supremum is taken over all admissible Markovian strategies œÄs = œÄ(s, X(s), Z1 (s), Z2 (s)) such that X(s) stays
2

nonnegative for all t ‚â§ s ‚â§ T given X(t) = x, Z1 (t) = z1 , Z2 (t) = z2 , and satisfy the integrability condition
(Z
)
T

œÄt2 œÉ 2 (Z1 (t), Z2 (t))dt

E

< ‚àû.

(6)

0

In this paper we consider the case with utility functions U being of power type:
U(x) =

xp
,
p

p 6= 0.

p < 1,

Define the differential operators
1 ,œÅ2
LœÄ,œÅ
x,z1 ,z2 = œÄ¬µ(z1 , z2 )

LœÅz112,z2 =

2
X

2
X
‚àÇ
1
‚àÇ2
‚àÇ2
+ œÄ 2 œÉ 2 (z1 , z2 ) 2 + œÄœÉ(z1 , z2 )
œÅi Œ≤i (zi )
,
‚àÇx 2
‚àÇx
‚àÇx‚àÇzi
i=1
2

Œ±i (zi )

i=1

‚àÇ2
‚àÇ
1X 2
‚àÇ2
+
Œ≤i (zi ) 2 + œÅ12 Œ≤1 (z1 )Œ≤2 (z2 )
.
‚àÇzi
2 i=1
‚àÇzi
‚àÇz1 ‚àÇz2

(7)

The value function v satisfies:
1 ,œÅ2
‚àÇt v + LœÅz112,z2 v + sup LœÄ,œÅ
x,z1 ,z2 v = 0,

(8)

œÄ

v(T, x, z1 , z2 ) = U(x).
Maximization over œÄ gives:
œÄ‚àó = ‚àí

1
¬µ(z1 , z2 ) vx
‚àí
2
œÉ (z1 , z2 ) vxx
œÉ(z1 , z2 )

P2

i=1

œÅi Œ≤i (zi )vxi
,
vxx

(9)

where vi denotes a derivative with respect to zi , i = 1, 2. Substituting (9) into (8), it follows that

‚àÇt v + LœÅz112,z2 v ‚àí

Œª(z1 , z2 )vx +

P2

i=1 œÅi Œ≤i (zi )vxi

2vxx

2
= 0.

(10)

¬µ(z1 ,z2 )
.
where the Sharpe ratio Œª is defined by Œª(z1 , z2 ) = œÉ(z
1 ,z2 )
We proceed in the next section to solve the problem when the two factors are perfectly correlated. It
turns out that this solution follows [6]. We then compute the first order perturbation adjustment, around the
perfectly correlated case. In Section 4, using these zero and first order perturbations, we construct sub- and
super-solutions to the original PDE (10), and rigorously show the error of the constructed approximation.

2.1

Fully Correlated Factors

Our goal is to find the value function v and the optimal strategy to achieve the maximum expected utility
of the terminal wealth. We start by recalling the result from [13] as applied to our case. More specifically,
in the case of fully correlated factors Z1 , Z2 we are able to easily adapt the computations there as follows.
Let us temporarily assume that œÅ12 = 1, then, condition (3) forces us to also assume that œÅ1 = œÅ2 = œÅ, with
|œÅ| < 1. We consider the ‚Äúdistortion transformation‚Äù used in [20] and [13]:
v(t, x, z1 , z2 ) =

q
xp  (0)
Œ® (t, z1 , z2 ) ,
p

where the superscript (0) indicates that this function will be the zeroth order in the asymptotics presented
in the following section. Denoting
Œì=

p
,
1‚àíp

so that

Œì > ‚àí1

and

3

Œì 6= 0,

since

p < 1, p 6= 0,

the function Œ®(0) satisfies
2
X
Œì 2
(0)
Œª (z1 , z2 )Œ®(0) + ŒìœÅŒª(z1 , z2 )
Œ≤i (zi )Œ®i
2q
i=1
P
2
(0)
2

i=1 Œ≤i (zi )Œ®i
1
(q ‚àí 1) + qœÅ2 Œì
= 0.
+
2
Œ®(0)

‚àÇt Œ®(0) + L1z1 ,z2 Œ®(0) +

Choosing
q=

1
,
1 + ŒìœÅ2

so that

1
,
1 ‚àí œÅ2

0<q<

and q = 1

if œÅ = 0,

(11)

the equation for Œ®(0) becomes linear:
Œì 2
Œª (z1 , z2 )Œ®(0) = 0,
2q

(0)
‚àÇt Œ®(0) + L1,œÅ
+
z1 ,z2 Œ®

(12)

Œ®(0) (T, z1 , z2 ) = 1,
where
1
L1,œÅ
z1 ,z2 œÜ = Lz1 ,z2 œÜ + ŒìœÅŒª(z1 , z2 )

2
X

Œ≤i (zi )œÜi ,

(13)

i=1

and L1z1 ,z2 is given by (7) with œÅ12 = 1. Note that in this case, we may assume that B1 (t) = B2 (t) = B(t),
and we get a Feynman‚ÄìKac type formula:
i
h Œì RT 2
(14)
Œ®(0) (t, z1 , z2 ) = EÃÉt,z1 ,z2 e 2q t Œª (Z1 (s),Z2 (s))ds ,
where PÃÉ is defined so that BÃÉ(t) = B(t) ‚àí ŒìœÅ

2.2

Rt
0

Œª(Z1 (s), Z2 (s))ds is a standard Brownian motion under it.

Asymptotics Around the Fully Correlated Case

We now go back to the general correlation structure (3). Our goal is to expand around the fully correlated
case when œÅ12 = 1, and œÅ1 = œÅ2 , presented in the previous section. Accordingly, we now assume that
œÅ1 , œÅ2 , œÅ12 have the following form:
(1)

(1)

œÅi = œÅ + œÅi Œµ, i = 1, 2 and œÅ12 = 1 + œÅ12 Œµ,

(15)

(1)

where œÅ12 < 0 and Œµ is a small parameter, 0 < Œµ  1, small enough to ensure a proper covariance structure
satisfying (3).
Consider the ansatz
q
xp  (0)
Œ® (t, z1 , z2 ) + ŒµŒ®(1) (t, z1 , z2 ) + O(Œµ2 ) ,
(16)
v(t, x, z1 , z2 ) =
p
where the exponent q is given by (11): q =

1
1+ŒìœÅ2

=

1‚àíp
1‚àíp(1‚àíœÅ2 ) .

Plugging this ansatz in the HJB equation

(10) and canceling terms of zero order in Œµ gives that the function Œ®(0) satisfies (12) and, therefore, is given
by (14). Cancelling the terms of order one in Œµ, we deduce that the function Œ®(1) must satisfy:
(1)
‚àÇt Œ®(1) + L1,œÅ
+
z1 ,z2 Œ®

Œì 2 (1)
Œª Œ® + f1 (Œ®(0) , ‚àáŒ®(0) , H(Œ®(0) )) = 0,
2q

Œ®(1) (T, z1 , z2 ) = 0,

4

(17)

where the operator L1,œÅ
z1 ,z2 is given by (13), and
(0)

f1 (Œ®

(0)

, ‚àáŒ®

(0)

, H(Œ®

qŒìœÅ
)) = (0)
Œ®
+ ŒìŒª

(0) (0) (1)
Œ≤1 Œ≤2 Œ®1 Œ®2 (œÅ1

‚àí

(1)
œÅœÅ12

+

(1)
œÅ2 )

+

2
X

!
(1)
(0)
Œ≤i2 œÅi (Œ®i )2

i=1
2
X

(1)

(0)

œÅ i Œ≤ i Œ®i

(1)

(0)

+ œÅ12 Œ≤1 Œ≤2 Œ®12 .

i=1

The probabilistic representation of Œ®(1) is given by the Feynman‚ÄìKac type formula:
"Z
T

Œ®

(1)

e

(t, z1 , z2 ) = EÃÉt,z1 ,z2

Rs

Œì
2q

t

Œª2 (Z1 (œÑ ),Z2 (œÑ ))dœÑ

(0)

f1 (Œ®

, ‚àáŒ®

(0)

, H(Œ®

(0)

#

))(Z1 (s), Z2 (s))ds ,

(18)

t

under the same probability measure PÃÉ as in (14).
We now consider a zeroth order approximation to œÄ ‚àó given in (9), by substituting the zeroth order
p
q
approximation for v from (16), namely, v(t, x, z1 , z2 ) ‚âà xp Œ®(0) (t, z1 , z2 ) , and by using œÅ12 = 1, œÅ1 = œÅ2 =
œÅ, the zeroth order approximation from (15). We obtain
!
P2
(0)
x
0
i=1 Œ≤i Œ®i
.
(19)
Œª + œÅq
œÄ =
(1 ‚àí p)œÉ
Œ®(0)
0

Note that X (œÄ ) > 0, and therefore once we show the appropriate integrability conditions in Corollary 2, it
will follows that œÄ 0 is an admissible strategy.
Next, we consider the value
h
i
0
(œÄ 0 )
v (œÄ ) (t, x, z1 , z2 ) = Et,x,z1 ,z2 U(XT ) ,
obtained by following the strategy œÄ 0 in (4). It satisfies the linear equation:
‚àÇt v (œÄ
v

(œÄ 0 )

0

)

+ LœÅz112,z2 v (œÄ

0

)

0

œÄ ,œÅ1 ,œÅ2 (œÄ
+ Lx,z
v
1 ,z2

0

)

= 0,

(T, x, z1 , z2 ) = U(x).

A classical regular expansion argument for linear PDEs (as in [13][Section 6.3.2] for instance) shows that
with U(x) = xp /p,
0

v (œÄ ) (t, x, z1 , z2 ) =

q
xp  (0)
Œ® (t, z1 , z2 ) + ŒµŒ®(1) (t, z1 , z2 ) + O(Œµ2 ) ,
p

where the function Œ®(0) and Œ®(1) are exactly those obtained in the previous section in (12) and (17) respec0
tively. Up to the first order in Œµ, v (œÄ ) is identical to v expended heuristically in (16). Once we will have
proved in Section 4 that the expansion (16) for v is accurate, we will be able to conclude that the strategy
œÄ 0 given by (19) generates up to order Œµ the value v given by (5) or (8).

3

An Example with Explicit Formula

We consider the following model inspired by the one presented in Chacko and Viceira [4]. We make the
following specific choice of a model (1)-(2):
œÉÃÑ
,
œÉ(z1 , z2 ) = ‚àö
z1 + z2
‚àö
Œ≤i (zi ) = Œ≤ÃÑ 2zi , i = 1, 2,

¬µ(z1 , z2 ) = ¬µÃÑ,
Œ±i (zi ) = m ‚àí zi ,

where we assume that m ‚â• 1 so that the two square-root processes Z1 and Z2 stay positive. We will
consider these processes starting at a point (z, z) with z > 0. Note that in the fully correlated case œÅ12 = 1,
5

we have Z1 (t) = Z2 (t) for all time t which will enable explicit formulas for Œ®(0) (t, z, z) := Œ®ÃÉ(0) (t, z) and
Œ®(1) (t, z, z) := Œ®ÃÉ(1) (t, z). However, in the general non-fully correlated case, the process (Z1 , Z2 ) will not stay
on the diagonal and an explicit formula for the value function will not be available making our approximation
pratical.
From (14), Œ®(0) becomes
i
h Œì RT 2
i
h Œì RT 2
Œ®(0) (t, z, z) = EÃÉt,z,z e 2q t Œª (Z1 (s),Z2 (s))ds = EÃÉt,z e 2q t Œª (Z1 (s),Z1 (s))ds = Œ®ÃÉ(0) (t, z),
‚àö
‚àö
with Œª(z, z) = œÉÃÑ¬µÃÑ 2z = ŒªÃÑ 2z. Note, that the original function Œ®(0) (t, z1 , z2 ) is hard to compute, as opposed
to Œ®ÃÉ(0) (t, z) which can be easily computed. Indeed, Œ®ÃÉ(0) (t, z) solves:
(0)

2
(0)
(0)
Œ®ÃÉt + (m ‚àí z)Œ®ÃÉ(0)
z + Œ≤ÃÑ z Œ®ÃÉzz + 2ŒìœÅŒªÃÑŒ≤ÃÑ z Œ®ÃÉz +

ŒìŒªÃÑ2 (0)
z Œ®ÃÉ = 0,
q

(20)

Œ®ÃÉ(0) (T, z) = 1.
Using the ansatz Œ®ÃÉ(0) (t, z) = eA(t)z+B(t) , we get the system of ODEs:



ŒìŒªÃÑ2
0
2 2
, A(T ) = 0,
A = ‚àí Œ≤ÃÑ A + 2ŒìŒªÃÑœÅŒ≤ÃÑ ‚àí 1 A +
q

(21)

B 0 = ‚àímA, B(T ) = 0.
Assuming the right hand side of (21) has two distinct solutions,
Ô£´
Ô£∂
s
2
2

4ŒìŒªÃÑ Œ≤ÃÑ Ô£∏
1 Ô£≠
2
a¬± =
1 ‚àí 2ŒìŒªÃÑœÅŒ≤ÃÑ ¬±
,
1 ‚àí 2ŒìŒªÃÑœÅŒ≤ÃÑ ‚àí
q
2Œ≤ÃÑ 2
which, in particular is the case when p < 0, we get that
2

A(t) = a+ a‚àí

1 ‚àí eŒ≤ÃÑ (T ‚àít)(a+ ‚àía‚àí )
,
a‚àí ‚àí a+ eŒ≤ÃÑ 2 (T ‚àít)(a+ ‚àía‚àí )

B(t) = ‚àím

1
log
Œ≤ÃÑ 2

2

a‚àí ‚àí a+ eŒ≤ÃÑ (a+ ‚àía‚àí )(T ‚àít)
a‚àí ‚àí a+

!

!
‚àí a+ (T ‚àí t) .

(0)

(0)

Thus, since Z1 (s) = Z2 (s) a.s. for s ‚àà [t, T ], it follows that Œ®1 (t, z, z) = Œ®2 (t, z, z). Separately, note
(0)
(0)
(0)
(0)
(0)
that Œ®1 (t, z, z) + Œ®2 (t, z, z) = Œ®ÃÉz (t, z). Together it therefore follows that Œ®1 (t, z, z) = Œ®2 (t, z, z) =
(0)
(0)
(0)
1 (0)
1 (0)
2 Œ®ÃÉz (t, z). Similar calculation shows also that Œ®11 (t, z, z) = Œ®12 (t, z, z) = Œ®22 (t, z, z) = 4 Œ®ÃÉzz (t, z).
We conclude from (19) that when z1 = z2 = z we also have that
œÄ0 =


2xz
ŒªÃÑ + œÅq Œ≤ÃÑA(t) .
(1 ‚àí p)œÉÃÑ

From (18), Œ®(1) becomes
Œ®

(1)

"Z

#

T

(t, z, z) = EÃÉt,z,z

e

Œì
2q

Rs
t

Œª2 (Z1 (œÑ ),Z2 (œÑ ))dœÑ

(0)

f1 (Œ®

, ‚àáŒ®

(0)

(0)

, H(Œ®

))(Z1 (s), Z2 (s))ds

t

"Z
= EÃÉt,z

#

T

e

Œì
2q

Rs
t

Œª2 (Z1 (œÑ ),Z1 (œÑ ))dœÑ

fÀú1 (s)Z1 (s)Œ®ÃÉ

(0)

(Z1 (s))ds = Œ®ÃÉ(1) (t, z),

t

where


(1)
(1)
(1)
(1)
(1)
(1)
f¬Ø1 (t) = 2qŒìœÅŒ≤ÃÑ 2 A2 (t) 2œÅ1 ‚àí œÅœÅ12 + 2œÅ2 + 2ŒìŒªÃÑŒ≤ÃÑA(t)(œÅ1 + œÅ2 ) + 2œÅ12 Œ≤ÃÑ 2 A2 (t).

6

It is again difficult to compute Œ®(1) (t, z1 , z2 ), however finding Œ®ÃÉ(1) (t, z) is easier. Indeed, Œ®ÃÉ(1) (t, z) satisfies
the following linear PDE:
(1)

2
(1)
(1)
Œ®ÃÉt + (m ‚àí z)Œ®ÃÉ(1)
z + Œ≤ÃÑ z Œ®ÃÉzz + 2ŒìœÅŒªÃÑŒ≤ÃÑ z Œ®ÃÉz +

ŒìŒªÃÑ2 (1) ¬Ø
z Œ®ÃÉ + f1 (t)zŒ®(0) (t, z) = 0,
q

Œ®ÃÉ(1) (T, z) = 0.
We look for a solution of the form
Œ®ÃÉ(1) = (zA1 (t) + B1 (t)) Œ®ÃÉ(0) .
In this case, A1 and B1 must satisfy the ODEs:

A01 (t) + 2A(t)Œ≤ÃÑ 2 ‚àí 1 + 2ŒìœÅŒªÃÑŒ≤ÃÑ A1 + f¬Ø1 (t) = 0,
B10 (t)

+ mA1 (t) = 0,

A1 (T ) = 0,

B1 (T ) = 0.

It then follows that
Z
A1 (t) =

T

e

Rs
t

(2A(u)Œ≤ÃÑ 2 ‚àí1+2ŒìœÅŒªÃÑŒ≤ÃÑ)du

f¬Ø1 (s)ds,

Z

t

3.1

T

B1 (t) = m

A1 (s)ds.
t

Numerical Illustration

We illustrate our finding numerically, in the example of the extended Chacko and Viceira [4] model from
Section 3. We use the parameters:
¬µÃÑ = 0.05, m1 = m2 = 26, œÉÃÑ = 0.2, ŒªÃÑ =

0.05
Œµ
¬µÃÑ
=
, œÅ12 = 1 ‚àí Œµ, œÅ1 = 0.5, œÅ2 = 0.5 ‚àí ,
œÉÃÑ
0.2
2

Œ≤ÃÑ = 5, p = ‚àí1, T = 1.
The graphs are all drawn as functions of (0, z, z), z ‚â• 0 at the point t = 0. In this case it is easily seen
that the Feller condition for the diffusions Z1 , Z2 is satisfied, which guarantees that Z1 (t), Z2 (t) > 0. Figure
1 illustrates the numerical solution of Œ®, together
with the approximations Œ®(0) , and Œ®(0) + ŒµŒ®(1) (left);

(0)
(0)
(1)
and the errors Œ® ‚àí Œ® , Œ® ‚àí Œ® + ŒµŒ®
(right), for Œµ = 0.1. Figure 2 illustrates these for Œµ = 0.05. As
expected, these errors are of order O(Œµ) and O(Œµ2 ) respectively.
0.8
20

40

60

80

100

-0.02

0.6

-0.04
0.4

-0.06
-0.08
20

40

60

80

100

-0.10

Figure 1: Left: graph of the numerical solution of Œ® (blue), zero order and first order approximations
Œ®(0)

(0)
(1)
(0)
(0)
(1)
(orange), Œ® + ŒµŒ® (green). Right: graph of the errors Œ® ‚àí Œ® (blue), Œ® ‚àí Œ® + ŒµŒ®
(orange).
Both graphs are done as a function of (0, z, z), for 0 ‚â§ z ‚â§ 100, with parameter Œµ = 0.1.

7

0.8
20

0.7

40

60

80

100

-0.01
0.6
0.5

-0.02

0.4

-0.03

0.3

-0.04

0.2
-0.05
20

40

60

80

100

Figure 2: Left: graph of the numerical solution of Œ® (blue), zero order and first order approximations
Œ®(0)

(0)
(1)
(0)
(0)
(1)
(orange), Œ® + ŒµŒ® (green). Right: graph of the errors Œ® ‚àí Œ® (blue), Œ® ‚àí Œ® + ŒµŒ®
(orange).
Both graphs are done as a function of (0, z, z), for 0 ‚â§ z ‚â§ 100, with parameter Œµ = 0.05.

4

Proof of Accuracy

We now go back to the general case as in Section 2. The goal is to make rigorous the previous heuristic
results. In other words, we prove that the expansion in (16) is correct. Moreover, as explained at the end of
Section 2.2, we justify that the zeroth order strategy œÄ 0 from (19) indeed, achieves the maximum value up
to order Œµ.
We again consider the HJB equation (10) for the value function v, and we perform the substitution
v(t, x, z1 , z2 ) =

xp
q
(Œ®(t, z1 , z2 )) .
p

(22)

Then, Œ® must satisfy:
‚àÇt Œ® + LœÅz112,z2 Œ® +
1
+
2Œ®

2
X

2
X
Œì 2
œÅi Œ≤i (zi )Œ®i
Œª (z1 , z2 )Œ® + ŒìŒª(z1 , z2 )
2q
i=1

!
(q ‚àí 1) +

qœÅ2i Œì



Œ≤i2 (zi )Œ®2i

+ Œ≤1 (z1 )Œ≤2 (z2 )(œÅ12 (q ‚àí 1) + qœÅ1 œÅ2 Œì) Œ®1 Œ®2

= 0,

i=1

Œ®(T, z1 , z2 ) = 1.
Note that we still assume that q is given by (11), but, however, the equation for Œ® remains fully nonlinear.
The distortion transformation (22) will be key to build sub- and super-solutions for (10), but first, we need
some smoothness properties for the functions Œ®(0) and Œ®(1) .

4.1

Smoothness of Œ®(0) and Œ®(1)

We have the following:
Lemma 1. Assume that Œª, Œ±i , Œ≤i , i = 1, 2 are bounded, twice differentiable with bounded derivatives, and
that œÉ, Œ≤i , i = 1, 2 are bounded away from zero. Then, Œ®(0) and Œ®(1) , the solutions of (12) and (17)
respectively, exist and they are unique and bounded. Moreover, their derivatives up to order two are bounded.
Additionally, Œ®(0) and Œ®(1) are also given by their Feynman‚ÄìKac representations (14) and (18) respectively.
Proof. We show the proof for Œ®(0) , whereas the proof for Œ®(1) is similar.
First, note that under our coefficient assumptions, the operator L1,œÅ
z1 ,z2 appearing in (13) is (degenerate)
(0)
elliptic. Then, existence and uniqueness of the classical solution Œ® of (12) follows from [18][Theorem 6].
Therefore, it is easily seen that all the assumptions of Feynman‚ÄìKac formula in [14][Theorem 5.7.6] hold.
Thus, from (14), it follows that Œ®(0) is bounded.
8

(0)

Since Œ®(0) is a classical solution to (12), it is differentiable, and we can consider Œ®i , its derivative with
respect to zi , i = 1, 2. By differentiating (12), we obtain the system of PDEs:
(0)

‚àÇt Œ®i

+

Œì 2
(0)
(0)
Œª (z1 , z2 )Œ®i + L1,œÅ
z1 ,z2 Œ®i
2q

 (0)
+ Œ±i0 (zi ) + Œ≤i (zi )Œ≤i0 (zi )‚àÇzi + Œ≤i0 (zi )Œ≤j (zj )‚àÇzj + ŒìœÅ (Œªi (z1 , z2 )Œ≤i (zi ) + Œª(z1 , z2 )Œ≤i0 (zi )) Œ®i
Œì
(0)
= ‚àí Œª(z1 , z2 )Œªi (z1 , z2 )Œ®(0) ‚àí ŒìœÅŒªi (z1 , z2 )Œ≤j (zj )Œ®j ,
q

(23)

(0)

Œ®i (T, z1 , z2 ) = 0, i, j = 1, 2 i 6= j.
Note that Œªi here, as per our convention, denotes the partial derivative of Œª with respect to zi , i = 1, 2.
(0)
(0)
Denoting by DŒ®(0) the vector (Œ®1 , Œ®2 )T and by DŒª the vector(Œª1 , Œª2 )T , the system of equations (23) can
be rewritten:
(0)
‚àÇt DŒ®(0) + L1,œÅ
+ V (z1 , z2 )DŒ®(0) +
z1 ,z2 I2√ó2 DŒ®

Œì
Œª(z1 , z2 )Œ®(0) DŒª = 0,
q

DŒ®(0) (T, z1 , z2 ) = 0,

where I2√ó2 is the 2 √ó 2 identity matrix, V is a 2 √ó 2 potential matrix, and the last term being a source term.
Therefore, the assumptions of [14][Theorem 5.7.6] again hold, and DŒ®(0) is given by the Feynman-Kac
formula,
#
"Z


T R
s
Œì (0)
(0)
V (Z1 (u),Z2 (u))du
t
DŒ® (t, z1 , z2 ) = EÃÉt,z1 ,z2
ŒªŒ® DŒª (Z1 (s), Z2 (s))ds .
e
q
t
(0)

(0)

Under our coefficient assumptions, this shows that Œ®1 and Œ®2 are bounded. Differentiating the system
(0)
(0)
(0)
(23) with respect to zi , i = 1, 2, one obtains equations for the second order derivatives Œ®11 , Œ®12 , Œ®22 and
their boundedness is derived by using again a Feynman‚ÄìKac representation and our coefficient assumptions.
Here, we omit these straightforward lengthy details as well as the calculation details for Œ®(1) given by (17)
and its derivatives. Finally, we similarly conclude that the Feynman‚ÄìKac representation (18) of Œ®(1) holds.
Corollary 2. Under the assumptions of Lemma 1, the strategy œÄ 0 given in (19) is admissible.
0

Proof. As noted previously, the process X (œÄ ) is a generalized geometric Brownian Motion, and thus is
(0)
positive. Moreover, under our assumptions from
 (14) , we havethat Œ® is also bounded away from zero.
From Lemma 1, it follows that so is

1
(1‚àíp)œÉ

Œª + œÅq

P2

(0)
Œ≤i Œ®i
(0)
Œ®

i=1

. Therefore, œÄ 0 satisfies the admissibility

constraint (6).

4.2

Building Sub- and Super-Solutions

The goal is now to obtain bounds for the value function v, solution to the HJB equation (10), and to justify
the approximation (16). Consider Œ®(0) and Œ®(1) given as solutions to (12) and (17) respectively and under
the assumptions of Lemma 1. Using those and the distortion transformation (22), define
v ¬± (t, x, z1 , z2 ) =

q
xp  (0)
Œ® (t, z1 , z2 ) + ŒµŒ®(1) (t, z1 , z2 ) ¬± Œµ2 M (T ‚àí t) ,
p

(24)

where M > 0 is a constant to be determined later independently of Œµ, and where q is given by (11). Here,
we assume 0 < p < 1 to start with and the case p < 0 will be treated in Section 4.2.5.
Observe that from the boundary conditions of Œ®(0) and Œ®(1) , we have v ¬± (T, x, z1 , z2 ) = U(x). Note also
that from the Feynman‚ÄìKac formula (14), the function Œ®(0) is bounded, positive, and bounded away from
zero. On the other hand, the function Œ®(1) is bounded, and, therefore, for Œµ small enough, Œ®(0) (t, z1 , z2 ) +
ŒµŒ®(1) (t, z1 , z2 ) ¬± Œµ2 M (T ‚àí t) > 0, and consequently, v ¬± is well defined and nonnegative for 0 < p < 1.

9

4.2.1

Strategy of the proof of accuracy

From (8), we define the operator QœÄ
œÄ,œÅ1 ,œÅ2
QœÄ = ‚àÇt + LœÅz112,z2 + Lx,z
,
1 ,z2
(1)

(1)

where œÅ12 = 1 + œÅ12 Œµ, œÅi = œÅ + œÅi Œµ. We will show that there exists M such that for Œµ small enough we
have
0

QœÄ [v ‚àí ] ‚â• 0, and

sup QœÄ [v + ] ‚â§ 0,

(25)

œÄ

where the strategy œÄ 0 is given by (19) and the strategy œÄ is any admissible strategy. By ItoÃÇ‚Äôs formula and a
justification of the martingale property which will be given later, we then conclude that
h
i
h
i
0
0
v(t, x, z1 , z2 ) ‚â• Et,x,z1 ,z2 U(X (œÄ ) (T )) = Et,x,z1 ,z2 v ‚àí (T, X (œÄ ) (T ), Z1 (T ), Z2 (T ))
"Z
#
T
0
0
QœÄ [v ‚àí ](s, X (œÄ ) (s), Z1 (s), Z2 (s))ds
= v ‚àí (t, x, z1 , z2 ) + Et,x,z1 ,z2
t
‚àí

‚â• v (t, x, z1 , z2 ),

(26)

h
i
h
i
Et,x,z1 ,z2 U(X (œÄ) (T )) = Et,x,z1 ,z2 v + (T, X (œÄ) (T ), Z1 (T ), Z2 (T ))
"Z
#
T
+
œÄ +
(œÄ)
= v (t, x, z1 , z2 ) + Et,x,z1 ,z2
Q [v ](s, X (s), Z1 (s), Z2 (s))ds
t

‚â§ v + (t, x, z1 , z2 ) + Et,x,z1 ,z2

"Z
t

#

T

sup QœÄ [v + ](s, X (œÄ) (s), Z1 (s), Z2 (s))ds
œÄ

+

‚â§ v (t, x, z1 , z2 ),

(27)

and, by taking a supremum over œÄ:
h
i
v(t, x, z1 , z2 ) = sup Et,x,z1 ,z2 U(X (œÄ) (T )) ‚â§ v + (t, x, z1 , z2 ).

(28)

œÄ

In other words, v ‚àí is a submartingale along œÄ 0 and v + is a supermartingale along any admissible œÄ. In
turns, (26) and (28) show that v ‚àí is a sub-solution and v + is a super-solution. Using again the definition
(22) of v ¬± , we deduce that our proposed approximation is accurate at the order Œµ:
v‚àí

q
xp  (0)
= xp O(Œµ2 ),
Œ® + ŒµŒ®(1)
p

(29)

uniformly in (t, z1 , z2 ). This is formalized in the following:
Theorem 3. In addition to the coefficient assumptions in Lemma 1, we assume that Œª is bounded and
bounded away from zero, and 0 < p < 1. Then, there exits a constant M > 0 such that, for Œµ small enough,
the functions v ¬± defined in (24) are sub- and super-solutions, and the accuracy of approximation (29) holds.
Moreover, the strategy œÄ 0 given by (19), is ‚Äúnearly-optimal‚Äù, in other words, if followed, then the expected
utility of the terminal wealth will differ from the value function by O(Œµ2 ), i.e.
 
p 
1
(œÄ 0 )
0 ‚â§ v(t, x, z1 , z2 ) ‚àí Et,x,z1 ,z2
XT
= xp O(Œµ2 ),
(30)
p
uniformly in (t, z1 , z2 ).
Proof. The proof follows the argument presented at the begining of Section 4.2.1 and will mainly consists
(1)
(1)
in deriving the key inequalities (25). Recall that œÅ12 = 1 + œÅ12 Œµ, œÅi = œÅ + œÅi Œµ, and that the strategy œÄ 0 is
given by (19).
10

4.2.2

0

Sub-solution, computation of QœÄ [v ‚àí ]

By direct computation, we get:
 p

q‚àí1  
0
x
Œì
(0)
QœÄ [v ‚àí ] = q
Œ®(0) + ŒµŒ®(1)
‚àÇt Œ®(0) + Œª2 Œ®(0) + L1,œÅ
Œ®
z1 ,z2
p
2q



 p
q‚àí1
Œì 2 (1)
x
(1)
(0)
(0)
(0)
‚àÇt Œ®(1) + L1,œÅ
Œ®
+
Œ®(0) + ŒµŒ®(1)
Œª
Œ®
‚àí
f
(Œ®
,
‚àáŒ®
,
H(Œ®
))
+ Œµq
1
z1 ,z2
p
2q



 p


q‚àí1
Œì
x
Œ¶
Œ®(0)
M 1 + Œª2 (T ‚àí t) +
+ Œµ2 q
+ xp O(Œµ3 )+M xp O(Œµ3 ), (31)
p
2q
2(1 ‚àí p)(Œ®(0) )2
where the O(Œµ3 ) terms are independent of x, M and are uniform in (t, z1 , z2 ), and the quantity Œ¶ is given by
" 2

X 
(1)
(0)
(1) (0) (1)
(1)
(0) 2
Œ¶ = (Œ® )
Œ≤i2 qp(œÅi )2 (Œ®i )2 + 4qpœÅœÅi Œ®i Œ®i ‚àí (q ‚àí 1)(p ‚àí 1)(Œ®i )2
i=1


2
X
(1)
(1)
(1) (0)
(1) (0)
+ 2Œ≤1 Œ≤2 [qpœÅ
œÅi ‚àí (q ‚àí 1)(p ‚àí 1)œÅ12 ](Œ®1 Œ®2 + Œ®2 Œ®1 )
i=1

‚àí (q ‚àí 1)(p ‚àí
"
+ 2Œ®

(0)

Œ®

(1)

2
X

(1) (1)
1)Œ®1 Œ®2

+

(1) (1) (0) (0)
qpœÅ1 œÅ2 Œ®1 Œ®2

#



(1)
(0)
(0) (1)
Œ≤i2 ‚àíqpœÅœÅi (Œ®i )2 + (q ‚àí 1)(p ‚àí 1)Œ®i Œ®i

i=1

+ Œ≤1 Œ≤2

[‚àíqpœÅ

2
X

!#
(1)
œÅi

+ (q ‚àí 1)(p ‚àí

(1)
(0) (0)
1)œÅ12 ]Œ®1 Œ®2

+ (q ‚àí 1)(p ‚àí

(0) (1)
1)(Œ®1 Œ®2

+

(0) (1)
Œ® 2 Œ®1 )

i=1

"
(0) 3

‚àí 2(Œ®

)

Œ≤1 Œ≤2 (p ‚àí

(1) (1)
1)œÅ12 Œ®12

#
2
X
(1) (1)
(Œ≤i œÅi Œ®i ) + (q ‚àí 1)(1 ‚àí p)(Œ®(1) )2
‚àí Œªp
i=1

2
X

!2
(0)
Œ≤ i Œ®i

.

(32)

i=1

From the equations (12) and (17) satisfied by Œ®(0) and Œ®(1) respectively,
the terms ofiorder one and of
h
Œì 2
Œª (T ‚àí t) > 0. Therefore,
order Œµ in (31) cancel. For 0 < p < 1, we have Œì > 0 and consequently 1 + 2q
from the boundedness of Œ¶, one can choose M > 0 independently of Œµ such that the term in Œµ2 in (31) is
positive. Finally, an explicit computation of both terms O(Œµ3 ) shows that it does not change that sign for Œµ
0
small enough. We omit here this lengthy but straightforward computation. The estimate (25) for QœÄ [v ‚àí ]
follows.
Note that for deriving (26) from this estimate, one needs to check that the martingale parts are true
martingales. This can be seen by writing these quantities explicitly and using again the boundedness of the
derivatives of Œ®(0) and Œ®(1) and the admissibility of œÄ 0 . We omit the details.
4.2.3

Super-solution, computation of supœÄ QœÄ [v + ]

+
Using the fact that vxx
< 0, a similar calculation with any admissible strategy œÄ reveals:

2 Ô£∂

P2
+
+
œÅ
Œ≤
v
Œªv
+
i
i
x
i
i=1
Ô£¨
Ô£∑
QœÄ [v + ] ‚â§ sup QœÄ [v + ] = Ô£≠‚àÇt v + + LœÅz112,z2 v + ‚àí
Ô£∏
+
2vxx
œÄ
Ô£´


q‚àí1  
xp  (0)
Œì 2 (0)
(1)
(0)
1,œÅ
(0)
=q
Œ® + ŒµŒ®
‚àÇt Œ® + Œª Œ® + Lz1 ,z2 Œ®
p
2q
 p



q‚àí1
x
Œì 2 (1)
(0)
(1)
(1)
1,œÅ
(1)
(0)
(0)
(0)
+ Œµq
Œ® + ŒµŒ®
‚àÇt Œ® + Lz1 ,z2 Œ® + Œª Œ® ‚àí f1 (Œ® , ‚àáŒ® , H(Œ® ))
p
2q
 p





q‚àí1
x
Œì
Œ¶ + pŒò2
2
2
(0)
+Œµ q
Œ®
‚àíM 1 + Œª (T ‚àí t) +
+ xp O(Œµ3 )+M xp O(Œµ3 ),(33)
p
2q
2(1 ‚àí p)(Œ®(0) )2


11

where Œ¶ is given by (32) and
2

2 2

Œò =q œÅ

(1)

Œ®

2
X

(0)
Œ≤i Œ®i

i=1

‚àíŒ®

(0)

2
X

!2
(1)
Œ≤ i Œ®i

.

i=1

As before, both O(Œµ3 ) terms in (33) are independent of x, M and are uniform in (t, z1 , z2 ), and the terms
of order one and of order Œµ cancel. We chooses M > 0 such that the term in Œµ2 is negative and the O(Œµ3 )
terms are absorbed for Œµ small enough. We conclude that the inequality (25) for supœÄ QœÄ [v + ] holds. The
martingale terms in (27) are handled as before, before taking the supremum in the admissible œÄ.
Finally, from (26) and (27), we deduce
 
q
p  xp 
1
(œÄ 0 )
= xp O(Œµ2 ),
XT
‚àí
Œ®(0) + ŒµŒ®(1)
Et,x,z1 ,z2
p
p
uniformly in (t, z1 , z2 ). Note that here, the O(Œµ2 ) term depends on M . The ‚Äúnear-optimality‚Äù estimate (30)
for the strategy œÄ 0 follows easily from (29).

4.2.4

Remarks

Remark 1. Note that, as it should be, the additional term of oder Œµ2 from (31) to (33)
 p
q‚àí1 
x
pŒò2
(0)
2
Œ®
Œµ q
p
2(1 ‚àí p)(Œ®(0) )2
is positive as p simplifies, q > 0, and 1 ‚àí p > 0.
Remark 2. The model used in our example given in Section 3 based on square-root processes does not satisfy
the assumptions of Theorem 3. Extending the accuracy result to that case requires a stopping argument at
the first time one of the two processes Z1 or Z2 exits the interval [Œ¥, Œ¥ ‚àí1 ] for some small parameter Œ¥ > 0.
The stopped model satisfies the assumption but doesn‚Äôt anymore allow for explicit formulas for the functions
Œ®(0 and Œ®(1) . A careful argument is needed to pass to the limit Œ¥ ‚Üí 0 uniformly in Œµ. This was done, for
instance, for another nonlinear perturbation problem in [8] in the context of stochastic volatility uncertainty.
It is quite technical and beyond the scope of this paper.
4.2.5

The case p < 0

The conclusion of Theorem 3 holds modulo the following adjustements.
The proof in the case p < 0 needs a different definition of v ¬± because in that case Œì =
h
i
Œì 2
therefore, the quantity 1 + 2q
Œª (T ‚àí t) may change sign. We redefine them as
v ¬± (t, x, z1 , z2 ) =

p
1‚àíp

q
xp  (0)
Œ® (t, z1 , z2 ) + ŒµŒ®(1) (t, z1 , z2 ) ¬± Œµ2 M (‚àít) ,
p

h
so that v ‚àí < v + since p < 0. The inequalities (25) still hold as we have now replaced ‚àí 1 +
h
i
Œì 2
by 1 + 2q
Œª (‚àít) and Œì < 0. Now, we need to pay attention at terminal values.
v ¬± (T, x, z1 , z2 ) =
so that v ‚àí (T, x, z1 , z2 ) <

xp
p

< 0 and,

Œì 2
2q Œª (T

q
xp
1 ¬± Œµ2 M (‚àíT ) ,
p
p

and v + (T, x, z1 , z2 ) > xp . Then, the first line of (26) is replaced by
h
i
h
i
0
0
v(t, x, z1 , z2 ) ‚â• Et,x,z1 ,z2 U(X (œÄ ) (T )) ‚â• Et,x,z1 ,z2 v ‚àí (T, X (œÄ ) (T ), Z1 (T ), Z2 (T )) ,

and the first line of (27) is replaced by
h
i
h
i
Et,x,z1 ,z2 U(X (œÄ) (T )) ‚â§ Et,x,z1 ,z2 v + (T, X (œÄ) (T ), Z1 (T ), Z2 (T )) .
The rest of the proof follows the same lines as in the case 0 < p < 1.
12

i
‚àí t)

5

Extension to Models with Multi Assets

We now show how to extend our results to a model with multi-assets, and multi-factors. Consider a model
with multiple assets governed by
dSi (t)
= ¬µi (Z(t))dt + œÉi (Z(t)) dWi (t), i = 1, 2, ¬∑ ¬∑ ¬∑ , n,
Si (t)
dZk (t) = Œ±k (Zk (t)) dt + Œ≤k (Zk (t)) dBk (t), k = 1, 2, ¬∑ ¬∑ ¬∑ , m,

(34)
(35)

where we use the vector notation Z := [Z1 , . . . , Zm ]T and the correlation structure between the Brownian
motions (W1 , ¬∑ ¬∑ ¬∑ , Wn , B1 , ¬∑ ¬∑ ¬∑ , Bm ) is given by:
d hWi , Wj it = œÅW
ij dt,

d hBk , Bl it = œÅB
kl dt,

d hWi , Bk it = œÅik dt,

1 ‚â§ i, j ‚â§ n, 1 ‚â§ k, l ‚â§ m,

B
W
B
with parameters (œÅW
ij , œÅkl , œÅik ) ensuring a proper correlation structure (in particular œÅii = œÅkk = 1 and
W
W
B
B
symmetries œÅij = œÅji , œÅkl = œÅlk ).
Assuming that the wealth is fully invested in the n stocks in a self-financed way, then the wealth process
is given by:

dX(t) =

n
X

n

œÄi (t)

i=1

dSi (t) X
œÄi (t) [¬µi (Z(t))dt + œÉi (Z(t)) dWi (t)] ,
=
Si (t)
i=1

where œÄi (t) is the amount invested in asset i at time t. The value function of the optimal investment problem
with terminal time T and utility U is:
v(t, x, z) = sup Et,x,z [U(XT )] ,

U(x) =

œÄ

xp
, p < 1, p 6= 0.
p

We define the following operators:
W

LœÄ,œÅ
x,z

,œÅ

LœÅz

B

Ô£´
Ô£∂
n,m
n
X
1Ô£≠X W
‚àÇ
‚àÇ2
‚àÇ2
Ô£∏
¬µi (z)œÄi
+
œÅij œÄi œÄj œÉi (z)œÉj (z)
=
+
œÅ
œÄ
œÉ
(z)Œ≤
(z
)
,
ik
i
i
k
k
‚àÇx 2 i,j=1
‚àÇx2
‚àÇx‚àÇzk
i=1
i=1,k=1
Ô£´
Ô£∂
m
m
X
1Ô£≠X B
‚àÇ2 Ô£∏
‚àÇ
+
œÅkl Œ≤k (zk )Œ≤l (zl )
.
=
Œ±k (zk )
‚àÇzk
2
‚àÇzk ‚àÇzl
n
X

k,l=1

k=1

The value function v then satisfies:
B

W

‚àÇt v + LœÅz v + sup LœÄ,œÅ
x,z

,œÅ

v = 0,

(36)

œÄ

v(T, x, z) = U(x).
Our asymptotics will be around the case where the Brownian motions Bk are fully correlated. In order
to model this regime, we define:
(1)

œÅik = œÅi + œÅik Œµ, 1 ‚â§ i ‚â§ n, 1 ‚â§ k ‚â§ m,
(1,B)

(1,B)

with œÅkk = 0 and œÅkl
covariance structure.

and

(1,B)

œÅB
kl = 1 + œÅkl

Œµ,

(37)

< 0, and Œµ is a small parameter, 0 < Œµ  1, small enough to ensure a proper

Remark 3. The model that we are perturbing corresponding to Œµ = 0 in (37), cannot be of eigenvalue equality
(EVE) type as considered in [1] unless m = 1, that is models with a single factor. Indeed, the matrix œÅœÅT
with œÅik = œÅi , 1 ‚â§ i ‚â§ n, 1 ‚â§ k ‚â§ m, admits zero as eigenvalue as soon as m ‚â• 2 and therefore, cannot
satisfy the EVE condition œÅœÅT = cI unless in the uncorrelated case œÅ = 0.
In order to keep the formulas as explicit as possible, we present the case with two assets and two factors.

13

5.1

Model with Two Assets

We continue illustrate the calculation of the expansions in an example with two assets and two driving
factors. Therefore the model will now be governed by (34)‚Äì(35) with n = m = 2. Maximization over œÄ in
(36) gives:
 P

 P

2
2
œÉj œÉi k=1 Œ≤k œÅik vxk + ¬µi vx ‚àí œÅW
Œ≤k œÅjk vxk + ¬µj vx
12 œÉi œÉj
k=1
 2
, i, j = 1, 2, i 6= j,
(38)
œÄi‚àó =
2
(œÅW
12 ) ‚àí 1 œÉi œÉj vxx
2
where vk denotes a derivative with respect to zk , k = 1, 2, and (œÅW
12 ) < 1 to ensure that the two stocks are
not fully correlated. Substituting (38) into (36), it follows that
œÅB

‚àÇt v + Lz12 v
 2


P2
2
W
2
2
W
W
vx,1 vx,2
i=1 Œ≤i ‚àí2œÅ2i œÅ1i œÅ12 + œÅ1i + œÅ2i vx,i + 2Œ≤1 Œ≤2 œÅ21 œÅ22 ‚àí œÅ12 œÅ12 + œÅ11 œÅ12 ‚àí œÅ22 œÅ12
‚àí
2 )v
)
2(1 ‚àí (œÅW
xx
!12
 2
2
2
X

Œª21 ‚àí 2Œª1 Œª2 œÅW
vx
12 + Œª2 vx
W
‚àí
Œ≤i vx,i œÅ1i (Œª1 ‚àí Œª2 œÅW
)
+
œÅ
(Œª
‚àí
Œª
œÅ
)
‚àí
= 0,
2i 2
1 12
12
2
2
(1 ‚àí (œÅW
2(1 ‚àí (œÅW
12 ) )vxx
12 ) )vxx
i=1
where Œªi (z1 , z2 ) =
5.1.1

¬µi (z1 ,z2 )
œÉi (z1 ,z2 ) ,

i = 1, 2.

Fully Correlated Case

Analogous to Section 2.2, we temporarily assume that the two stochastic volatility factors are fully correlated:
œÅB
12 = 1, B1 (t) = B2 (t) = B(t), and d hWi , Bit = œÅi dt, i, j = 1, 2.
We consider the ansatz
q
xp  (0)
v(t, x, z1 , z2 ) =
Œ® (t, z1 , z2 ) .
p
Let Œì =

‚àÇt Œ®

(0)

p
1‚àíp .

1
+
2



Then, it follows that Œ®(0) satisfies
(0)
Œ≤12 Œ®11

+

(0)
Œ≤1 Œ≤2 Œ®12

1
(0)
+ Œ≤22 Œ®22
2








ŒìŒ≤1
(0)
W
W
+ Œ±1 +
Œª1 œÅ1 ‚àí œÅ2 œÅ12 + Œª2 œÅ2 ‚àí œÅ1 œÅ12
Œ®1
2
1 ‚àí (œÅW
)
12



2


Œì Œª21 ‚àí 2Œª1 Œª2 (œÅW
ŒìŒ≤2
(0)
12 ) + Œª2
W
W
Œª1 œÅ1 ‚àí œÅ2 œÅ12 + Œª2 œÅ2 ‚àí œÅ1 œÅ12
Œ®(0)
Œ®2 +
W )2 )
2
1 ‚àí (œÅW
2q(1
‚àí
(œÅ
)
12
12

2
(0)
(0)



2
2
W
W 2
Œ≤
Œ®
+
Œ≤
Œ®
2
1
1
2
(q ‚àí 1) + p q œÅ1 + œÅ2 ‚àí 1 + 1 ‚àí 2qpœÅ1 œÅ2 (œÅ12 ) + (1 ‚àí q)(1 ‚àí p)(œÅ12 )
+
= 0.
(0)
2)
Œ®
2(1 ‚àí p)(1 ‚àí (œÅW
)
12

+ Œ±2 +

Choosing

q=

1+Œì

œÅ21 + œÅ22 ‚àí 2œÅ1 œÅ2 œÅW
12
2
1 ‚àí (œÅW
)
12

‚àí1

linearizes the equation to get:
‚àÇt Œ®(0) +

 (0)
Œì
2
Œª21 ‚àí 2Œª1 Œª2 (œÅW
+ LŒ®(0) = 0,
12 ) + Œª2 Œ®
W
2
2q(1 ‚àí (œÅ12 ) )
Œ®(0) (T, z1 , z2 ) = 1,

where
2

LœÜ = L1z œÜ +


 X
Œì
W
Œª 1 œÅ1 ‚àí œÅ2 œÅW
Œ≤i (zi )œÜi .
12 + Œª2 œÅ2 ‚àí œÅ1 œÅ12
W
2
1 ‚àí (œÅ12 )
i=1
14

(39)

We have the Feynman‚ÄìKac representation:
i
h Œì RT 2
Œ®(0) (t, z1 , z2 ) = EÃÉt,z1 ,z2 e 2q t Œª (Z1 (s),Z2 (s))ds ,
where PÃÉ is defined so that
BÃÉt = Bt ‚àí

Œì
2
1 ‚àí (œÅW
12 )

Z

t



W
Œª1 (Z1 (s), Z2 (s)) œÅ1 ‚àí œÅ2 œÅW
ds
12 + Œª2 (Z1 (s), Z2 (s)) œÅ2 ‚àí œÅ1 œÅ12

0

is standard Brownian Motion under it, and we denoted
Œª2 =
5.1.2

Œª21 + Œª22 ‚àí 2Œª1 Œª2 œÅW
12
.
2
1 ‚àí (œÅW
)
12

Asymptotics

In the general case, we will assume a correlation structure of the form (37):
(1)

œÅik = œÅi + œÅik Œµ, i, k = 1, 2,

and

(1,B)

œÅB
12 = 1 + œÅ12

Œµ,

(40)

(1,B)

with œÅ12 < 0 and Œµ is a small parameter, 0 < Œµ  1, small enough to ensure a proper covariance structure.
As was done previously in the case with one stock and a risk-free asset, we will now expand the general case,
around the known case of Œµ = 0, and calculate the asymptotic expansion similar to (16).
v(t, x, z1 , z2 ) =

q
xp  (0)
Œ® (t, z1 , z2 ) + ŒµŒ®(1) (t, z1 , z2 ) + O(Œµ2 ) ,
p

(41)

Note that the expansion has the same number of arguments as before, as there are still two factors, though
the functions Œ®(i) , i = 0, 1, will be different.
Expanding the correlation coefficients as in (40) and the value function as in (41), we see that Œ®(1)
satisfies an equation similar to (17):
‚àÇt Œ®(1) + LŒ®(1) +

 (1)
Œì
2
Œª21 ‚àí 2Œª1 Œª2 (œÅW
+ f1 (Œ®(0) , ‚àáŒ®(0) , H(Œ®(0) )) = 0,
12 ) + Œª2 Œ®
W
2
2q(1 ‚àí (œÅ12 ) )

(42)

where
f1 (Œ®(0) , ‚àáŒ®(0) , H(Œ®(0) )) =
(0) (0)
+Œ≤1 Œ≤2 Œ®1 Œ®2



(œÅ1 ‚àí

qŒì
2
(0)
(1 ‚àí (œÅW
12 ) )Œ®

(1)
œÅ2 œÅW
12 )(œÅ11

+

(1)
œÅ12 )

2
X



(1)
(1)
(0)
W
Œ≤i2 (œÅ1 ‚àí œÅ2 œÅW
)œÅ
+
(œÅ
‚àí
œÅ
œÅ
)œÅ
(Œ®i )2
2
1 12 2i
12 1i

i=1
(1)

(1)

(1,B)

2
2
W
+ (œÅ2 ‚àí œÅ1 œÅW
12 )(œÅ21 + œÅ22 ) ‚àí (œÅ1 + œÅ2 ‚àí 2œÅ1 œÅ2 œÅ12 )œÅ12



2 

X
Œì
(1)
(1)
(0)
(1,B)
(0)
W
(Œª1 ‚àí Œª2 œÅW
Œ≤i Œ®i ‚àí œÅ12 Œ≤1 Œ≤2 Œ®12 .
12 )œÅ1i + (Œª2 ‚àí Œª1 œÅ12 )œÅ2i
W
2
1 ‚àí (œÅ12 ) i=1

We now consider œÄ 0 , the first order approximation to œÄ ‚àó given in (38),
q by substituting the first order
p
approximation for v from (16), namely, v(t, x, z1 , z2 ) ‚âà xp Œ®(0) (t, z1 , z2 ) .
Therefore,

 
 (0) 
 (0)
W
x q Œ≤1 œÅi1 ‚àí œÅj1 œÅW
+ Œ®(0) (Œªi ‚àí Œªj œÅW
12 )
12 Œ®1 + Œ≤2 œÅi2 ‚àí œÅj2 œÅ12 Œ®2

i, j = 1, 2, i 6= j. (43)
œÄi0 =
2 œÉ Œ®(0)
(1 ‚àí p) 1 ‚àí (œÅW
i
12 )
We next use (œÄ1 , œÄ2 ) = (œÄ10 , œÄ20 ) in the supremum of (36) together with the expansions (40), (41) and evaluate

15

the equation, to get that:
œÅB

0

W

‚àÇt v + Lz12 v + LœÄx,z,œÅ ,œÅ v
v
"

 
(0)
(1)
= q Œ® + ŒµŒ®
‚àÇt Œ®(0) +

 (0)
Œì
2
Œª21 ‚àí 2Œª1 Œª2 (œÅW
+ LŒ®(0)
12 ) + Œª2 Œ®
W
2
2q(1 ‚àí (œÅ12 ) )



#

Œì
2
(1)
+ ‚àÇt Œ®(1) + LŒ®(1) +
Œª21 ‚àí 2Œª1 Œª2 (œÅW
‚àí f1 (Œ®(0) , ‚àáŒ®(0) , H(Œ®(0) ) Œµ + O(Œµ2 )
12 ) + Œª2 Œ®
2
2q(1 ‚àí (œÅW
12 ) )


= O(Œµ2 ),
where the last equality is obtained by cancelling the first two terms using the equations (39) and (42) satisfied
by Œ®(0) and Œ®(1) respectively.
To summarize, this formal computation shows that the strategy (œÄ1 , œÄ2 ) = (œÄ10 , œÄ20 ) given by (43) generates
the value v given by (36) up to order Œµ.
5.1.3

Explicit Formulas

We again consider a specific choice of a model, inspired by a model of Chacko and Viceira
‚àö [4], given by:
i
2zi , for i = 1, 2,
i
=
1,
2,
and
Œ±
(z
)
=
m
‚àí
z
together
with
Œ≤
(z
)
=
Œ≤ÃÑ
¬µi (z1 , z2 ) = ¬µÃÑi , œÉi (z1 , z2 ) = ‚àözœÉÃÑ1 +z
i i
i
i i
2
in (34) and (35) with n = m = 2. As in the exemple in Section 3, we assume m ‚â• 1 so that the processes Z1
and Z2 stay positive. We consider again these processes starting at a point (z, z) with z > 0. Using again
the notation Œ®ÃÉ(0) (t, z) = Œ®(0) (t, z, z) and the equation (39) for Œ®(0) , the equation for Œ®ÃÉ(0) becomes
ŒìŒªÃÑ2 (0)
(0)
2
(0)
(0)
¬Ø
Œ®ÃÉt + (m ‚àí z)Œ®ÃÉ(0)
z Œ®ÃÉ = 0,
z + Œ≤ÃÑ z Œ®ÃÉzz + 2ŒìœÅŒªÃÑŒ≤ÃÑ z Œ®ÃÉz +
q

(44)

Œ®ÃÉ(0) (T, z) = 1,
with the notation
2
ŒªÃÑ2 ‚àí 2ŒªÃÑ1 ŒªÃÑ2 œÅW
12 + ŒªÃÑ2
ŒªÃÑ = 1
,
2
1 ‚àí (œÅW
12 )
2



W
ŒªÃÑ1 œÅ1 ‚àí œÅ2 œÅW
12 + ŒªÃÑ2 œÅ2 ‚àí œÅ1 œÅ12
¬Ø
ŒªÃÑ =
2
1 ‚àí (œÅW
12 )

¬Ø = ŒªÃÑ and equation (44) is identical to (20).
Note that if œÅ1 = œÅ2 , then ŒªÃÑ
The derivation of explicit formulas for Œ®ÃÉ(0) and Œ®ÃÉ(1) is very similar as in Section 3 and we omit the
details. In the end, we obtain Œ®ÃÉ(0) (t, z) = eC(t)z+D(t) and Œ®ÃÉ(1)(t,z) = (C1 (t)z + D1 (t)) Œ®ÃÉ(0) (t, z) where C is
the solution of a Riccati equation, and D, C1 , D1 are solution to linear equations.

6

Conclusion

The problem of portfolio optimization with power utilities when returns and volatilities are driven by a single
factor can be linearized by using a classical distortion transformation. In this paper we proposed to treat this
same problem in the presence of several factors. Our approach is to consider a perturbation around the case
where the factors are fully correlated which can be linearized and amenable to explicit solutions. We identify
the leading order term for the value function corresponding to a Merton‚Äôs portfolio and we characterize the
first order correction as the solution to a linear equation. An example with explicit solutions is given to
illustrate the quality of the approximation. Under a set of reasonable assumptions, we rigorously establish an
accuracy result for this regular perturbation problem by using the construction of sub- and super-solutions
to the fully nonlinear HJB equation characterizing the value function. In turn, we deduce that the leading
order approximation of the optimal strategy generates the value function up to the first order of accuracy.

16

Acknowledgement
The authors would like to thank Ruimeng Hu for her comments on an earlier version of the paper. The
authors are also grateful to the two referees whose comments and suggestions helped a lot in improving the
paper.

References
[1] L. Avanesyan, M. Shkolnikov, and R. Sircar. Construction of forward performance processes in stochastic factor
models and an extension of widder‚Äôs theorem. arXiv:1805.04535v1, 2018.
[2] M. Bichuch. Asymptotic analysis for optimal investment in finite time with transaction costs. SIAM Journal on
Financial Mathematics, 3(1):433‚Äì458, 2012.
[3] M. Bichuch and R. Sircar. Optimal investment with transaction costs and stochastic volatility part ii: Finite
horizon. SIAM Journal on Control and Optimization, 57(1):437‚Äì467, 2019.
[4] G. Chacko and L. M. Viceira. Dynamic consumption and portfolio choice with stochastic volatility in incomplete
markets. Review of Financial Studies, 18(4):1369‚Äì1402, 2005.
[5] J. Feng, M. Forde, and J.-P. Fouque. Short-maturity asymptotics for a fast mean-reverting heston stochastic
volatility model. SIAM Journal on Financial Mathematics, 1(1):126‚Äì141, 2010.
[6] J.-P. Fouque and R. Hu. Asymptotic optimal strategy for portfolio optimization in a slowly varying stochastic
environment. SIAM Journal on Control and Optimization, 5(3), 2017.
[7] J.-P. Fouque and R. Hu. Optimal portfolio under fractional stochastic environment. Mathematical Finance,
29(3), 2019.
[8] J.-P. Fouque and N. Ning. Uncertain volatility models with stochastic bounds. SIAM Journal on Financial
Mathematics, 9(4):1175‚Äì1207, 2018.
[9] J.-P. Fouque, G. Papanicolaou, and R. Sircar. Derivatives in financial markets with stochastic volatility. Cambridge University Press, 2000.
[10] J.-P. Fouque, G. Papanicolaou, and R. Sircar. Mean-reverting stochastic volatility. International Journal of
theoretical and applied finance, 3(01):101‚Äì142, 2000.
[11] J.-P. Fouque, G. Papanicolaou, R. Sircar, and K. Solna. Multiscale stochastic volatility asymptotics. Multiscale
Modeling & Simulation, 2(1):22‚Äì42, 2003.
[12] J.-P. Fouque, G. Papanicolaou, R. Sircar, and K. Solna. Multiscale Stochatic Volatility for Equity, Interest-Rate
and Credit Derivatives. Cambridge University Press, 2011.
[13] J.-P. Fouque, R. Sircar, and T. Zariphopoulou. Portfolio optimization & stochastic volatility asymptotics.
Mathematical Finance, 2016.
[14] I. Karatzas and S. Shreve. Brownian motion. In Brownian Motion and Stochastic Calculus, pages 47‚Äì127.
Springer, 1998.
[15] D. Kramkov and W. Schachermayer. Necessary and sufficient conditions in the problem of optimal investment
in incomplete markets. The Annals of Applied Probability, 13(4):1504‚Äì1516, 2003.
[16] R. C. Merton. Lifetime portfolio selection under uncertainty: The continuous-time case. Review of Economics
and statistics, 51:247‚Äì257, 1969.
[17] R. C. Merton. Optimum consumption and portfolio rules in a continuous-time model. Journal of economic
theory, 3(4):373‚Äì413, 1971.
[18] O. Oleinik. On the smoothness of solutions of degenerating elliptic and parabolic equations. In Doklady Akademii
Nauk, volume 163, pages 577‚Äì580. Russian Academy of Sciences, 1965.
[19] R. Sircar and G. Papanicolaou. Stochastic volatility, smile & asymptotics. Applied Mathematical Finance,
6:107‚Äì145, 1999.
[20] T. Zariphopoulou. Optimal investment and consumption models with non-linear stock dynamics. Mathematical
Methods of Operations Research, 50(2):271‚Äì296, 1999.

17

