MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

arXiv:1907.07900v1 [math.AP] 18 Jul 2019

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA
Abstract. In this paper we study theoretical properties of the entropy-transport functional
with repulsive cost functions. We provide sufficient conditions for the existence of a minimizer
in a class of metric spaces and prove the Î“-convergence of the entropy-transport functional
to a multi-marginal optimal transport problem with a repulsive cost. We also prove the
entropy-regularized version of the Kantorovich duality.

1. Introduction
We consider the following multi-marginal entropy-transport problem
IÎµ [Ï] =

inf

(C0 [Î³] + ÎµE[Î³]),

Î³âˆˆÎ sym
N (Ï)

(1.1)

R
where C0 [Î³] = X N c dÎ³ is the transportation cost related to a cost function c, E[Î³] is the
entropy, and Îµ â‰¥ 0 is a parameter, see Section 2 for details. We consider the setting where
(X, d, m) is a Polish measure space and Ïm âˆˆ Pac (X) is an absolutely continuous probability
measure with respect to the reference measure m. An element Î³ âˆˆ Î sym
N (Ï) is called a
symmetric coupling (or transport plan), that is, a symmetric probability measure in X N
having all marginals equal to Ïm.
We are interested in a class of repulsive cost functions c : X N â†’ R âˆª {+âˆ} of the form
X
c(x1 , . . . , xN ) =
f (d(xi , xj )), for all (x1 , . . . , xN ) âˆˆ X N .
1â‰¤i<jâ‰¤N

We assume f : ]0, âˆ[â†’ R to be a continuous and decreasing function that approaches +âˆ
if d(xi , xj ) â†’ 0. Among the examples of such cost functions we have the Coulomb cost
f (z) = 1/|z|, the Riesz cost f (z) = 1/|z|s , n â‰¥ s â‰¥ max{n âˆ’ 2, 0} (in Rn ) and the logarithmic
cost f (z) = âˆ’ log(|z|). We observe that when Îµ = 0, this entropy-transport problem reduces
to the classical multi-marginal optimal transport problem with repulsive costs [5, 7, 8, 12].
The motivation of this paper comes from both theory and numerics. For repulsive cost
functions, the entropy term in (1.1) plays a role of a regularizer to compute numerically a
solution Î³ of the multi-marginal optimal transport problem I0 [Ï], see [2]. Numerical experiments suggest that when the regularization parameter Îµ goes to 0, the minimizer Î³Îµ converges
to a minimizer of I0 [Ï] having minimal entropy among the minimizer of I0 [Ï].
From a theoretical viewpoint, this type of a functional has direct relevance in Density
Functional Theory. By choosing carefully the parameter Îµ, the functional (1.1) provides a
lower bound for the Hohenberg-Kohn functional in Density Functional Theory [23, 26]. This
is an immediate consequence of the Log-Sobolev Inequality.
Date: July 19, 2019.
The authors acknowledge the support of the Academy of Finland, projects no. 274372, 284511, 312488,
and 314789. A.G. also acknowledges funding by the European Research Council under H2020/MSCA-IF
â€œOTmeetsDFTâ€ [grant ID: 795942].
1

2

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

The entropy-transport problem has appeared previously in the literature in the attractive
case, in particular when c(x1 , x2 ) = d(x1 , x2 )2 . We mention briefly below some of the connections of the entropy-transport with other fields and point out the relevance in the Coulomb
case.
Brief comments on some applications of the entropy-transport
Optimal Transport and Sinkhorn algorithm: The entropy-transport (1.1) was introduced by
M. Cuturi [9] in order to compute numerically the optimal transport plan for the distance
squared cost in the 2-marginals case via the Sinkorn algorithm. Due to its reasonable computational cost, it has been applied to a wide range of problems in various research areas,
including Information Theory, Computer Graphics, Statistical Inference, Machine Learning,
and Mean-Field Games. The entropic regularization method was also considered in the (attractive) multi-marginal case in the so-called barycenter problem introduced by M. Agueh and
G. Carlier [1] (see also [6]) and in numerical methods in the time discretization of Brenierâ€™s
relaxed formulation of the incompressible Euler equation [3]. For a thorough presentation of
the computational aspects we refer to M. Cuturi and G. PeyreÌâ€™s book [24].
Second-order Calculus on RCD spaces: N. Gigli and L. Tamanini [16] studied the entropictransport problem on a class of metric spaces with (Riemannian) Ricci curvature bounded
from below (2-marginals case, c(x1 , x2 ) = d(x1 , x2 )2 ). The entropic regularization procedure
was crucial for establishing a second-order differential structure in that setting.
SchroÌˆdinger Problem: In 1926, E. SchroÌˆdinger introduced the (linear) SchroÌˆdinger equations
describing the non-relativistic evolution of a single particle in an electric field with potential
energy and also established an equivalence between such equations and a system of diffusion
equations [25]. Roughly speaking, the variational problem (see (1.1) with X = C([0, 1], Rd )
and N = 2) arises in the SchroÌˆdinger manuscript while studying the limit k â†’ âˆ (N = 2)
of the empirical measures associated to the evolution of k i.i.d. Brownian motions. We refer
the reader to C. LeÌonard survey [20] for technical details and historical notes.
Lower bound on the Hohenberg-Kohn functional in Density Functional Theory: This is the
particular case where the entropy-transport problem with Coulomb cost comes into play. It
has been shown in [23, 26] that the functional (1.1) provides a lower bound for computing the
ground state energy of the Hohenberg-Kohn functional [5, 7, 8, 12, 21]. Below we give a brief
description of the result. Notice that in this context X = Rd and m is the Lebesgue measure
on Rd .
âˆš
Assume that Î³ âˆˆ Î N (Ï) such that Î³ âˆˆ H 1 (RdN ). This is the case, for example, when
Î³(x1 , . . . , xN ) = |Ïˆ(x1 , . . . , xN )|2 , where Ïˆ âˆˆ H 1 (RdN ) is a ground-state wave function solving
the N -electron SchroÌˆdinger Equation (see [7, 8, 12, 26] for details). Then, we can define the
Hohenberg-Kohn functional by
 2Z

Z
X
~
1
âˆš 2
HK
FÌƒ~ [Ï] =
inf
|âˆ‡ Î³| dx1 . . . dxN +
dÎ³ .
âˆš
2 RdN
|xi âˆ’ xj |
Î³âˆˆÎ N (Ï), Î³âˆˆH 1 (RdN )
RdN
1â‰¤i<jâ‰¤N

Now, as a consequence of the logarithmic Sobolev inequality for the Lebesgue measure [17],
âˆš
the following result holds: if ÏLd âˆˆ P(Rd ) and Î³ âˆˆ H 1 (RdN ) then
C0 [Ï] â‰¤ CÎµ [Ï] â‰¤ FÌƒ~HK [Ï],

with Îµ = Ï€~2 /2.

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

3

Example of optimal entropy couplings. Let us present some computational examples of
minimizers of IÎµ [Ï] illustrating the role of the parameter Îµ. Before this, we recall a result on
the characterization of minimizers in the one-dimensional case [10]. In particular, according
to it the minimizer of I0 [Ï] is concentrated on finitely many graphs and thus singular with
respect to the product reference measure.
Theorem 1.1 ([10]). Let Âµ âˆˆ P(R) be an absolutely continuous probability measure and
f : R â†’ R strictly convex, bounded from below and non-increasing function. Then there exists
a unique optimal symmetric plan Î³ âˆˆ Î“sym (Âµ) that solves
Z
X
min
f (|xj âˆ’ xi |) dÎ³.
sym
Î³âˆˆÎ N (Âµ) RN
1â‰¤i<jâ‰¤N

Moreover, this plan is induced by an optimal cyclical map T , that is, Î³sym = (Î³T )S , where
Î³T = (id, T, T (2) , . . . , T (N âˆ’1) )] Âµ. An explicit optimal cyclical map is
(
FÂµâˆ’1 (FÂµ (x) + 1/N )
if FÂµ (x) â‰¤ (N âˆ’ 1)/N
T (x) =
FÂµâˆ’1 (FÂµ (x) + 1 âˆ’ 1/N )
otherwise.
Here FÂµ (x) = Âµ(âˆ’âˆ, x] is the distribution function of Âµ, and FÂµâˆ’1 is its lower semicontinuous
left inverse.
One-dimensional Entropic-Transport with Coulomb cost and a Gaussian measure. Let Ï be
the normal distribution on the real line with zero mean and standard deviation Ïƒ = 5. We
compute numerically the solution of the entropic-transport problem with Coulomb cost in
the real line using the Sinkorn algorithm [9]. Notice that by Theorem 1.1, we know that
the minimizer of I0 [Ï] is concentrated on a graph. See Figure 1 for an illustration of the
computational results. Our code is based on the Python implementation available at POT
library [14].

Figure 1. The dependence of the minimizer of the entropic-transport problem
(1.1) on the entropic parameter Îµ for the one-dimensional Coulomb cost, N = 2
and Ï âˆ¼ N (0, 5). The pictures show part of the support of the optimal coupling
Î³Îµ around the origin. From the left to right: Îµ = 104 , 10âˆ’2 , 10âˆ’3 , 10âˆ’4 , 10âˆ’5 .

Organization of the paper. In Section 2 we introduce the setting and study sufficient
conditions for the existence of minimizers for the entropy-transport problem (1.1). Section 3
is devoted to the Î“âˆ’convergence proof of the entropic-transport functional CÎµ [Î³] to the multimarginal optimal transport with repulsive costs C0 [Î³]. In Section 4, we study the Kantorovich
duality for the entropic-transport problem.

4

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Strategy of the main proof and some technical remarks. The main result of this paper
is Theorem 3.1, in which we prove the Î“-convergence of the entropic-regularized functional
CÎµ [Î³] to C0 [Î³]. The technical difficulty on dealing with the Î“-convergence comes from the fact
that while for the entropic part E[Î³] the minimizer Î³ tends to be as spread as possible with
respect to m, for the cost C0 [Î³] a minimizer can be very singular and have infinite entropy.
We divide the proof in two parts. The part (I), the lim inf âˆ’inequality, follows basically
from the lower-semicontinuity of the costs C0 [Î³] and CÎµ [Î³] - which are obtained from the
assumption Ï log Ï âˆˆ L1m (X) on the marginal measure Ïm, giving a lower bound on the entropy.
The part (II), the lim sup âˆ’inequality, is more involved. In Section 3.2, we construct a block
approximation Î³n0 for a coupling Î³ with C0 [Î³] < +âˆ. Such a construction is done in several
steps, since we need to construct a competitor Î³n0 such that E[Î³n0 ] < âˆ and Î³n0 âˆˆ Î sym
N (Ï).
The main idea and the rigorous construction is done at section 3.2.
Futhermore, we point out that our construction can deal with the case when the space X
is a domain in Rd , answering a question raised in [3]. There the Î“-convergence was proven
using convolutions; an approach that does not seem to be easy to implement for domains, or
in general metric spaces.
Related works: A proof of the Î“-convergence of (1.1) to the Monge-Kantorovich problem for
c(x, y) = d(x, y)p first appeared in [19, 22] via probabilistic methods. In [6], G. Carlier, V.
Duval, G. PeyreÌ and B. Schmitzer provided an alternative and more analytical proof carrying
out a similar block approximation procedure for the two-marginal squared distance cost in
the Euclidean space and the Wasserstein Barycenter.
2. The entropy-regularized repulsive costs
Let (X, d) be a Polish space and m be a reference measure on X. We denote by P(X) the
set of Borel probability measures on X, and Pac (X) the set of Borel probability measures on
X that are absolutely continuous with respect to m. We denote by mN the product measure
m âŠ— m âŠ— Â· Â· Â· âŠ— m. This is the reference measure we use on the product space X N . On X N we
use the sup-metric, which we denote by dN .
The class of cost functions c : X N â†’ R âˆª {+âˆ} of our interest is given by functions of the
form
X
c(x1 , . . . , xN ) =
f (d(xi , xj )), for all (x1 , . . . , xN ) âˆˆ X N ,
1â‰¤i<jâ‰¤N

where f : [0, âˆ[â†’ R âˆª {+âˆ} satisfies the following conditions
f |]0,âˆ[ is continuous, decreasing ,and
lim f (t) = +âˆ .

tâ†’0+

Above and from now on, we denote by (x1 , . . . , xN ) points in X N , so xi âˆˆ X for each i.
We denote by

Î N (Ï) = Î³ âˆˆ P(X N ) | pri] Î³ = Ïm for all i âˆˆ {1, . . . , N }
the set of couplings or transport plans, where pri is the projection
pri (x1 , . . . , xi , . . . , xN ) = xi for all (x1 , . . . , xi , . . . , xN ) âˆˆ X N .

(F1)
(F2)

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

5

For the definition of the set of symmetric couplings Î sym
N (Ï), see Definition 2.7. We define
the functional C0 [Î³] to be the cost related to the coupling Î³
Z
C0 [Î³] =
c(x1 , . . . , xN ) dÎ³(x1 , . . . , xN ) .
XN

Given Îµ â‰¥ 0, we denote by CÎµ [Î³] the entropy-regularized cost
for all Î³ âˆˆ Î sym
N (Ï),

CÎµ [Î³] = C0 [Î³] + ÎµE[Î³],

(2.1)

where the entropy E[Î³] : P(X N ) â†’ R âˆª {âˆ’âˆ, +âˆ} is defined as
(R
E[Î³] =

XN

ÏÎ³ log ÏÎ³ dmN

+âˆ

if Î³  mN
.
otherwise

(2.2)

The notation ÏÎ³ stands for the Radon-Nikodym derivative of Î³ with respect to the reference
measure mN and Î³  mN means that Î³ is absolutely continuous with respect to the reference
measure mN . Let Ïm âˆˆ Pac (X). In this paper we are interested in the following infimum
IÎµ [Ïm] :=

inf

Î³âˆˆÎ sym
N (Ï)

CÎµ [Î³] .

(2.3)

In order to guarantee the lower semicontinuity for CÎµ , we will assume Ï log Ï âˆˆ L1m (X).
This will take care of the entropy part E[Â·] of the cost. In order to establish the lower
semicontinuity for the functional C0 [Â·], we assume that the measure Ï satisfies the following
two conditions:
1
and
(A)
lim sup Ï(B(x, r)) <
râ†’0 xâˆˆX
N (N âˆ’ 1)2
Z
f (2d(x, o)) dÏ(x) > âˆ’âˆ for some o âˆˆ X .
(B)
X\B(o,r0 )

Above we have, by an abuse of notation, denoted the measure Ïm by only the density Ï; we
will use the same abbreviation in the rest of the paper if there is no risk of confusion. The
Condition (B) is a similar assumption than requiring, in the case of the quadratic cost, that
the marginal measures have finite second moments. The Condition (A) guarantees that the
cost is finite.
If we endow the spaces P(X N ) and P(X) with wâˆ— -topology then, by Prokhorovâ€™s theorem,
any subset of P(X) (or P(X N )) is tight if and only if it is relatively compact.
Remark 2.1 (Entropy-transport seen as a Kullback-Leibler divergence). If Âµ and Î½ are
measures on a set X, the Kullback-Leibler divergence of Âµ with respect to Î½ is defined as
 
(R
dÂµ
log
if Âµ  Î½
dÎ½ dÂµ
X
KL(Âµ|Î½) =
.
+âˆ
otherwise
Now, if both measures Âµ and Î½ are absolutely continuous with respect to some reference measure R of the space X with densities ÏÂµ and ÏÎ½ , respectively, we can write:
 
(R
ÏÂµ
Ï
log
if Âµ  Î½
Âµ
ÏÎ½ dÂµ
X
KL(Âµ|Î½) =
.
+âˆ
otherwise

6

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Considering the entropy-regularized MOT problem, we see that the cost functional CÎµ [Î³] can
be alternatively written as the Kullback-Leibler divergence between Î³ and a kernel Îº defined
below


Z
CÎµ [Î³] = Îµ KL(Î³|Îº) = Îµ

ÏÎ³ ln
XN

ÏÎ³
ÏÎº


dmN ,

where Îº = eâˆ’c/Îµ mN .
For the most part, in this paper we have chosen to consider as a reference measure the
measure mN . However, as the following lemma shows, we could also assume the reference
measure to be (Ïm)âŠ—N since the minimizers of the entropy-regularized MOT problem (2.3)
do not depend on the choice of the reference measure, at least if there exists a minimizer with
finite cost. To state the lemma, let us introduce the notation of relative entropy: for each
reference measure R of a Polish space Y , and for each Î³ âˆˆ P(Y ), we denote by E(Î³|R) the
relative entropy of Î³ with respect to R, defined as
 
(R
dÎ³
if Î³  R
log
dR dÎ³
Y
.
E(Î³|R) =
+âˆ
otherwise
Now we may consider two, a priori different, entropy-regularized MOT problems: the one
introduced in (2.3)
I (Ïm) =

inf

Î³âˆˆÎ sym
N (Ï)

CÎµ [Î³] =: I (Ïm|m) ,

(2.4)

and the problem with the reference measure chosen to be (Ïm)âŠ—N
I (Ïm|Ïm) :=

inf
sym

Î³âˆˆÎ N (Ï)


C0 [Î³] + E(Î³|(Ïm)âŠ—N ) .

(2.5)

The folowing Lemma 2.2 is used only to go from the compact to the general case in the duality
Theorem 4.2. The proof in [11] can be directly applied here to prove Lemma 2.2.
Lemma 2.2. Let (X, d, m) be a Polish measure space, Ïm âˆˆ P(X) a measure satisfying (A)
and (B), and c a cost function satisfying (F1) and (F2). Now for all  > 0 we have
Z
I (Ïm|m) = I (Ïm|Ïm) + N  KL(Ïm|m) = I (Ïm|Ïm) + N 
Ï log Ïdm .
(2.6)
X

Moreover, whenever at least one side of the equality above is finite, the problems (2.4) and
(2.5) have the same minimizers.
2.1. Some properties of the entropy functional. Let us start by noting that the minimum of the entropy is attained by the product measure and that its value is not âˆ’âˆ.
Proposition 2.3. Let (X, d, m) be a Polish metric measure space, and let Ïm âˆˆ Pac (X) with
Ï log Ï âˆˆ L1m (X) . Then




Z
Z
N
N
min
E[Î³]
=
âŠ—
Ï
log
âŠ—
Ï
dm
=
N
Ï log Ï dm > âˆ’âˆ.
N
i=1
i=1
sym
Î³âˆˆÎ N (Ï)

XN

X

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

7

Proof. As we will see, the minimality is an immediate consequence of Jensenâ€™s inequality. Let
Î³ âˆˆ Î (Ï). Then
 


Z
Z

ÏÎ³
ÏÎ³
N
ÏÎ³ log(ÏÎ³ ) dmN =
E[Î³] =
log
+ log âŠ—i=1 Ï âŠ—N
i=1 Ï dmN
N
âŠ—N
Ï
X N âŠ—i=1 Ï
XN
i=1
 Z

Z
Z

ÏÎ³ log âŠ—N
ÏÎ³ dmN +
â‰¥
ÏÎ³ dmN log
i=1 Ï dmN
=0+

XN

XN

XN

E[âŠ—N
i=1 Ï].



Using Proposition 2.3 we immediately get the lower semicontinuity of the entropy functional
by representing the entropy as relative entropy against the probability measure âŠ—N
i=1 (Ïm). See
for instance [27, Lemma 4.1] for the lower semicontinuity of the entropy when the reference
measure is finite.
Corollary 2.4. Let (X, d, m) be a Polish metric measure space, and let Ïm âˆˆ Pac (X) with
Ï log Ï âˆˆ L1m (X). Then E[Â·] is lower semicontinuous in the set Î sym
N (Ï).
Now we are ready to prove the existence of the minimizers for entropy-regularized MOT:
Proposition 2.5. Let (X, d, m) be a Polish metric measure space. Assume that the measure
Ïm âˆˆ Pac (X) satisfies Ï log Ï âˆˆ L1m (X) along with Conditions (A) and (B). Assume that
c : X N â†’ R âˆª {+âˆ} satisfies the conditions (F 1) and (F 2). Then, for each Îµ â‰¥ 0, there
exists a minimizer Î³ âˆˆ Î sym
N (Ï) for the entropic-regularized cost CÎµ [Î³].
âˆ—
Proof. We notice that the set Î sym
N (Ï) is compact in the w -topology [18]. The functional E
is lower semicontinuous by Corollary 2.4, and in our setting the lower semicontinuity of C0 is
proven as a part of the proof of [15, Proposition 3.1]. Since for each Îµ â‰¥ 0 the functional CÎµ

is convex, we conclude that it has a minimizer in the set Î sym
N (Ï)

2.2. Some properties of the coupling cost C0 [Î³]. Notice that in this section Î N (Ï)
denotes the set of couplings in X N (not necessarily symmetric). Moreover, we need to assume
extra hypothesis on the probability measure Ï in order to guaranteee that C0 [Î³] is bounded
from below for a Î³ âˆˆ Î N (Ï) (e.g. f (z) = âˆ’ log(|z|)).
The next theorem from [4] (see also [15, Theorem 3.2]) states that for measures Ï satisfying
the assumptions (A) and (B) there exists Î± > 0 for which the support of any optimal plan is
concentrated away from the set
DÎ± := {(x1 , . . . , xN ) âˆˆ X N | d(xi , xj ) < Î± for some i 6= j} .
Theorem 2.6. [4, Theorem 3.2] Let (X, d), Ï, f , c be such that the measure Ï satisfies (A)
and (B) and the function f satisfies (F1) and (F2). Let Î³ be a minimizer of
Z
I0 [Ï] = min
c(x1 , . . . , xN ) dÎ³(x1 , . . . , xN ).
Î³âˆˆÎ N (Ï) X N

Let us fix 0 < Î² < 1 such that
sup Ï(B(x, Î²)) <
xâˆˆX

1
.
N (N âˆ’ 1)2

Then, we have for all
Î±<f

âˆ’1



N 2 (N âˆ’ 1)
f (Î²)
2


(2.7)

8

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

the inclusion
where

f âˆ’1

spt(Î³) âŠ‚ X N \ DÎ± ,
stands for the left-inverse of f .

(2.8)

Next we observe that one can restrict the problem minÎ³âˆˆÎ (Ï) C0 [Î³] to the class of symmetric
couplings in X N having all the marginals equal to Ï.
Definition 2.7 (Symmetric measures). A measure Î³ âˆˆ P(X N ) is symmetric if
Z
Z
Ï†(Ïƒ(x1 , . . . , xN )) dÎ³, for all Ï† âˆˆ C(X N )
Ï†(x1 , . . . , xN ) dÎ³ =
XN

XN

for all permutations Ïƒ of the N symbols (x1 , . . . , xN ). We denote by Psym (X N ) the set of
sym (X N ).
symmetric probability measures in X N , and notice that Î sym
N (Ï) := Î N (Ï) âˆ© P
Let us also introduce the notation for symmetrized measures. If Î³ is a Borel measure on
X N , we denote by Î³ S the symmetrized measure
1 X
Ïƒ] Î³ ,
Î³ S :=
N!
ÏƒâˆˆSN

where SN is the set of permutations of the {1, . . . , N } koordinates (x1 , . . . , xN ). The following
result follows immediately.
Proposition 2.8. Under the hypothesis of Proposition 2.6, we have that
Z
Z
c(x1 , . . . , xN ) dÎ³.
min
c(x1 , . . . , xN ) dÎ³ = min
sym
Î³âˆˆÎ N (Ï) X N

(2.9)

Î³âˆˆÎ N (Ï) X N

3. The Î“-convergence of Entropic-regularized cost
Now let us turn to the Î“-convergence. From now on, (Ï„n )nâˆˆN is any sequence of positive
real numbers decreasing to zero. Let us introduce the following functionals: for each n âˆˆ N
(
CÏ„n [Î³] if Î³ âˆˆ Î N (Ï)
Cn : Psym (X N ) â†’ R âˆª {+âˆ}, Cn [Î³] =
+âˆ
otherwise
and
C:P

sym

(
C[Î³]
(X ) â†’ R âˆª {+âˆ}, C[Î³] =
+âˆ
N

if Î³ âˆˆ Î N (Ï)
.
otherwise

The goal of this section is to prove that the sequence (CnâˆˆN ) Î“-converges to C in the space
Psym (X N ).
Theorem 3.1. Let (X, d, m) be a Polish metric measure space. Let Ï âˆˆ Pac (X) with Ï log Ï âˆˆ
L1m (X) satisfying (A) and (B). Then the sequence (Cn ) Î“-converges to C in the space Psym (X N ).
Let us fix Î³ âˆˆ Psym (X N ). We need to show that
For each sequence (Î³n )nâˆˆN that converges to Î³
we have lim inf Cn [Î³n ] â‰¥ C[Î³], and
nâ†’âˆ

(I)

There exists a sequence (Î³n )nâˆˆN that converges to Î³ and
lim sup Cn [Î³n ] â‰¤ C[Î³] .
nâ†’âˆ

(II)

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

9

The proof of Theorem 3.1 is divided into two parts. The proof of the first part, the liminfinequality (I), is short and is established in the next subsection. The remainder of this section
is then divided into subsections in which the second part, the limsup-inequality (II) is proven.
3.1. Proof of condition (I). We fix a sequence (Î³n )nâˆˆN that converges to Î³. If Î³ âˆˆ
/ Î N (Ï),
then since the set Î N (Ï) is compact, for large indices we also have Î³n âˆˆ
/ Î N (Ï), so both sides
of inequality (I) are +âˆ, and we are done. Hence we may assume that Î³ and Î³n â€™s are elements
of the set
R Î N (Ï). Since now Î³n âˆˆ Î N (Ï), the claim (I) follows from the lower-semicontinuity
of Î³ 7â†’ c dÎ³ and from the entropy lower bound shown in Proposition 2.3.
3.2. Constructing an approximation of the coupling Î³. First of all, we need to construct an approximation of Î³ only in the case where C0 [Î³] < âˆ: if this is not the case then
any sequence (Î³n ) converging to Î³ can be used to prove Condition (II). The idea of the construction is to redefine a large part of Î³ to be a product measure on finitely many Borel sets
with small diameter. In order not to increase the cost by too much, the Borel sets we are
using have to be far away from the diagonal compared to the diameter of the sets. We call
the part of the measure defined in this way the core part of the approximation. For the rest
of the measure, we take another finite combination of product measures. However, this time
the sets do not need to have small (or even bounded) diameter, but just small measure. This
part will be called the remainder part of the approximation.
We start the construction by taking out a small part of Î³ that will later be used to deal
with the remainder part of the approximation. For this we take a sequence of radii defined
as rn = 1/n. Since C[Î³] < âˆ, there exists a point x = (x1 , . . . , xN ) âˆˆ spt(Î³) with
xi 6= xj

if 1 â‰¤ i < j â‰¤ N.

Moreover, since Î³ âˆˆ Î N (Ï) and Ï satisfies (A), we have
Î³({(y1 , . . . ,yN ) âˆˆ X N | yi 6= xj for all i, j})
X
â‰¥1âˆ’
Î³({(y1 , . . . , yN ) âˆˆ X N | yi = xj })
i6=j

=1âˆ’

X

Ï(X \ {xj }) â‰¥ 1 âˆ’ N (N âˆ’ 1)

i6=j

1
> 0.
N (N âˆ’ 1)2

Thus, using again C[Î³] < âˆ, there exists another point x0 = (xN +1 , . . . , x2N ) âˆˆ spt(Î³), so
that
xi 6= xj if 1 â‰¤ i < j â‰¤ 2N.
0
From now on, we consider x, x fixed. Therefore, for n âˆˆ N sufficiently large we have
d(xi , xj ) > rn

if 1 â‰¤ i < j â‰¤ 2N.

Let us denote by
Bn := B(x, r10n )

and Bn0 := B(x0 , r10n )

the balls around x and x0 with radii rn /10 in the sup-metric of the product space. So,
y = (y1 , . . . , yN ) âˆˆ Bn
if and only if
d(xi , yi ) <
and analogously for

Bn0

rn
10

for all i âˆˆ {1, . . . , N } ,

with the relevant index modifications.

(3.1)

10

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Let us now define
Î³Bn

S
 Î³
|Bn
=
Î³(Bn )

and Î³Bn0

 Î³

|Bn0 S
=
.
Î³(Bn0 )

Observe that Î³Bn and Î³Bn0 are symmetric probability measures. Since the marginals of a
symmetric measure are the same, we may denote by ÏBn the marginal of Î³Bn and similarly
by ÏBn0 the marginal of Î³Bn0 . Let us further denote BÌƒn := spt Î³Bn , BÌƒn0 := spt Î³Bn0 and


1
rn
Îµn :=
min Î³(BÌƒn ), Î³(BÌƒn0 ), rn ,
.
(3.2)
N
f (2rn /5)
We then define a measure
Î³0,n :=Î³ |

0 )
X n \(BÌƒn âˆªBÌƒn

+

Î³(BÌƒn ) âˆ’ Îµn
Î³(BÌƒn0 ) âˆ’ Îµn
Î³| +
Î³| 0 .
BÌƒn
BÌƒn
Î³(BÌƒn )
Î³(BÌƒn0 )

The idea behind the measure Î³0,n is that we have chopped of a small part of the measure
around the points x and x0 (symmetrically) for later use. Since we are working with a singular
cost, we still need to take out a small neighbourhood of the diagonals before approximating
by product measures. We do this now.
We fix a compact Kn âŠ‚ X such that
Îµn
Î³0,n (X N \ KnN ) <
(3.3)
2
and take a small enough Î´n âˆˆ (0, rn ) so that
Îµn
Î³0,n (DÎ´n ) < .
(3.4)
2
Using Kn and Î´n we then define
Î³1,n := Î³0,n |KnN \DÎ´n .

(3.5)

The measure Î³1,n is now the core part of the measure that we approximate. We denote by
Ï1,n the marginals of the symmetric measure Î³1,n .
Let us then approximate the measure Î³1,n . We take Î»n âˆˆ (0, Î´n /n) so that
|f (r) âˆ’ f (s)| < Îµn

for all r, s âˆˆ [Î´n /2, 2 diam(Kn )] with |r âˆ’ s| â‰¤ 2Î»n .

(3.6)

Such Î»n exists by the uniform continuity of f on the compact set[Î´n /2, 2 diam(Kn )]. Since
n
the set Kn is compact, we may fix a finite Borel partition {Bni }M
i=1 of the set spt(Ï1,n ) such
that
diam(Bni ) < Î»n

and

0 < Ï1,n (Bni ) < Îµn for all i âˆˆ {1, . . . , Mn } .

a as
We are now ready to define the core part approximants Î³1,n
a
Î³1,n
=

X
(k1 ,...,kN )âˆˆMnN

Î³1,n (Bnk1 Ã— Â· Â· Â· Ã— BnkN )
Ï1,n (Bnk1 ) Â· Â· Â· Ï1,n (BnkN )

Ï1,n |B k1 âŠ— Â· Â· Â· âŠ— Ï1,n |B kN .
n

(3.7)

n

Now let us handle the main part of the remainder of the measure, namely the measure
Î³2,n := Î³0,n |DÎ´n âˆª(X N \KnN ) .
Because Î³0,n and the set where we restrict it is symmetric, also Î³2,n is. We may thus denote
its marginals by Ï2,n .

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

11

In order to determine which part of the remaining marginal measure should be coupled
where, we define a partition {Ai,n }N
i=1 of the space X by setting, for all i âˆˆ {1, . . . , N âˆ’ 1}
rn
2 },

Ai,n := {y âˆˆ X | d(xi , y) â‰¤
and
AN,n := X \

N[
âˆ’1

Ai,n .

i=1

Condition (3.1) guarantees that the sets Ai,n are pairwise disjoint.
Now we approximate Î³2,n by the measure
!S
N
X
a
Î³2,n := N
,
Î·n,i
i=1

where for all i the measure Î·n,i is the product
!
iâˆ’1
ÏBn |B(x ,r /10)
O
k n
âŠ— Ï2,n |A âŠ—
Î·n,i :=
i,n
ÏBn (B(xk , rn /10))

N
O
k=i+1

k=1

ÏBn |B(x

!
k ,rn /10)

ÏBn (B(xk , rn /10))

.

a ) we have for each i 6= j
By the definition of the sets Ai,n , for every (y1 , . . . , yN ) âˆˆ spt(Î³2,n

rn
rn
2rn
âˆ’
=
,
2
10
5

d(yi , yj ) â‰¥ |d(yi , xj ) âˆ’ d(xj , yj )| >

(3.8)

where we have assumed (which we can do without loss of generality) that yj âˆˆ B(xj , rn /10).
a is that we have coupled the marginals of the
What we have done using the measure Î³2,n
measure Î³2,n with some suitable parts of the marginals of the reserved measure that was taken
out around the point x. In this way we have used unevenly the marginals of this reserved
part. To handle the rest of the reserved part of the measure around the point x, we now use
the reserved measure around the point x0 . So, we need to redefine the coupling for the part
of the marginal given by
Îµn
a
.
Î³ | + Ï2,n âˆ’ (pr1 )] Î³2,n
Ï3,n := (pr1 )]
Î³(BÌƒn ) BÌƒn
We define it as
a
Î³3,n

:=

N
X

!S
Ï†n,i

,

i=1

where each Ï†n,i is defined as
Ï†n,i :=

NO
+iâˆ’1
k=N +1

ÏBn |B(x

!
k ,rn /10)

ÏBn (B(xk , rn /10))

âŠ— Ï3,n âŠ—

2N
O
k=N +i+1

ÏBn |B(x

!
k ,rn /10)

ÏBn (B(xk , rn /10))

.

a ) and each i 6= j
Since spt(Ï3,n ) âŠ‚ spt(ÏBn ), we have that for every (y1 , . . . , yN ) âˆˆ spt(Î³3,n

d(yi , yj ) â‰¥ |d(xk(i) , xk(j) ) âˆ’ d(yi , xk(i ) âˆ’ d(xk(j) , yj )| > rn âˆ’

rn
4rn
rn
âˆ’
=
,
10 10
5

(3.9)

where k(i) 6= k(j) are the indices for which yj âˆˆ B(xk(j) , rn /10) and yi âˆˆ B(xk(i) , rn /10).

12

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

a . Since Î³ a
What remains is the part of the measure around x0 that was not used for Î³3,n
3,n
used the marginals from this part of the reserved measure evenly, we may simply couple the
rest by a measure
!S
2N
ÏBn |B(x ,r /10)
O
k n
a
Î³4,n := b
,
ÏBn (B(xk , rn /10))
k=N +1

with b being the correct scaling constant. Similarly as for the previous remainder part, we
a ) and each i 6= j the inequality (3.9) holds.
have that for every (y1 , . . . , yN ) âˆˆ spt(Î³4,n
Now we are ready to define the full approximation as
a
a
a
a
Î³n0 = Î³1,n
+ Î³2,n
+ Î³3,n
+ Î³4,n
.

By construction Î³n0 âˆˆ Î sym (Ï).
3.3. Narrow convergence of the approximations. Let us now prove that the sequence
(Î³n0 )n narrowly converges to Î³. We could argue this by using the Wasserstein distance.
However, let us do it here directly using the definition of narrow convergence.
Lemma 3.2. The sequence (Î³n0 )n narrowly converges to Î³.
Proof. Let Ï• âˆˆ Cb (X N ) and Îµ > 0. We need an index N0 âˆˆ N such that
Z
Z
Ï•dÎ³ âˆ’
Ï•dÎ³n0 < Îµ for all n â‰¥ N0 .
XN

(3.10)

XN

Let us denote M := supxâˆˆX N |Ï•(x)|; we may assume that M > 0. Since Ï is inner regular,
we can fix a compact set K âŠ‚ X such that
Îµ
.
Ï(X \ K) <
12N M
Since Î³ âˆˆ Î N (Ï), we now have
Îµ
Î³(X N \ K N ) <
.
12M
The function Ï•, when restricted to K N , is uniformly continuous. Hence there exists Î´ > 0 so
that
Îµ
|Ï•(x) âˆ’ Ï•(y)| <
for all x, y âˆˆ K N for which dN (x, y) < Î´ .
(3.11)
12
Now let N0 âˆˆ N be so large that
âˆš

Îµ
for all n â‰¥ N0 .
6
Let us show that this choice of N0 fulfills Condition (3.10). First we note that for all
n â‰¥ N0 we have
Z
Z
Z
Z
Z
Z
0
Ï• dÎ³ âˆ’
Ï• dÎ³1,n +
Ï• dÎ³1,n âˆ’
Ï• dÎ³n0
Ï• dÎ³ âˆ’
Ï• dÎ³n â‰¤
XN
XN
XN
XN
XN
XN
Z
Z
Z
Z
a
Ï• dÎ³1,n âˆ’
â‰¤
Ï• dÎ³ âˆ’
Ï• dÎ³1,n +
Ï• dÎ³1,n
XN
XN
XN
XN
Z
a
a
a
+
Ï• d(Î³2,n
+ Î³3,n
+ Î³4,n
)
N
X
Z
Z
Îµ
a
<
Ï• dÎ³1,n âˆ’
Ï• dÎ³1,n
+ ,
(3.12)
6
XN
XN
N Î»n < Î´

and

6M Îµn <

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

13

where in the last inequality we have used the following facts: Î³(X N ) âˆ’ Î³1,n (X N ) < 3Îµn for
all n, and for the remainder part of the measure Î³n0 we have
a
a
a
(Î³2,n
+ Î³3,n
+ Î³4,n
)(X N ) < 3Îµn for all n âˆˆ N.

It remains to show that for all n â‰¥ N0 we have
Z
Z
5Îµ
a
Ï• dÎ³1,n âˆ’
Ï• dÎ³1,n
<
.
6
XN
XN

(3.13)

We first estimate the integrals in the set K N . Let us fix, for each (k1 , . . . , kN ) âˆˆ MnN for
which the set
(Bnk1 Ã— Â· Â· Â· Ã— BnkN ) âˆ© K N
is nonempty, an element
zk1 ,...,kN âˆˆ (Bnk1 Ã— Â· Â· Â· Ã— BnkN ) âˆ© K N .
Now we have, for a fixed (k1 , . . . , kN ), denoting for simplicity
a
,
z0 := zk1 ,...,kN , Q = Bnk1 Ã— Â· Â· Â· Ã— BnkN , Î³ = Î³1,n , Î³a = Î³1,n

Z

Z
Ï•(z) dÎ³ âˆ’
Qâˆ©K N

Ï•(z) dÎ³a
Qâˆ©K N

Z

N

â‰¤

N

Z

Ï•(z) dÎ³ âˆ’ Ï•(z0 )Î³(Q âˆ© K ) + Ï•(z0 )Î³a (Q âˆ© K ) âˆ’
Qâˆ©K N

Ï•(z) dÎ³a
Qâˆ©K N

+ Ï•(z0 )Î³(Q âˆ© K N ) âˆ’ Ï•(z0 )Î³a (Q âˆ© K N )
Z
Z
â‰¤
|Ï•(z) âˆ’ Ï•(z0 )| dÎ³ +
|Ï•(z0 ) âˆ’ Ï•(z)| dÎ³a
Qâˆ©K N
N

Qâˆ©K N
N

+ M |Î³(Q âˆ© K ) âˆ’ Î³a (Q âˆ© K )|

Îµ
Îµ
+ Î³a (Q âˆ© K N ) Â·
+ M |Î³(Q âˆ© K N ) âˆ’ Î³a (Q âˆ© K N )|
12
12
Îµ
Îµ
+ Î³a (Q âˆ© K N ) Â·
= Î³(Q âˆ© K N ) Â·
12
12
+ M |Î³(Q âˆ© K N ) âˆ’ Î³(Q) + Î³a (Q) âˆ’ Î³a (Q âˆ© K N )|
Îµ
Îµ
â‰¤ Î³(Q âˆ© K N ) Â·
+ Î³a (Q âˆ© K N ) Â·
+ M Î³(Q \ K N ) + M Î³a (Q \ K N ) ,
12
12
a)

< Î³(Q âˆ© K N ) Â·

where in a) we have used Condition (3.11), and in b) the fact that the measures Î³ and Î³a
coincide on â€™cubesâ€™ Q. Summing the estimate above over all cubes Q = Bk1 Ã— Â· Â· Â· Ã— BkN ,
(k1 , . . . , kN ) âˆˆ MnN , gives
Z
Z
a
Ï• dÎ³1,n âˆ’
Ï• dÎ³1,n
KN

KN

Îµ
Îµ
+ Î³a (K N ) Â·
+ M Î³(X N \ K N ) + M Î³a (X N \ K N )
12
12
a) Îµ
Îµ
Îµ
Îµ
Îµ
<
+
+
+
= .
(3.14)
12 12 12 12
3
< Î³1,n (K N ) Â·

14

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA


In inequality a) we have used the fact that Ï(X \ K) < 12M
N and, since the marginals of Î³1,n
a
N
a (X N \ K N ) by Îµ .
and Î³1,n are restrictions of Ï, we can bound both Î³1,n (X \ K N ) and Î³1,n
12M
For the same reason, we have

Z

Z
Ï• dÎ³1,n âˆ’

X N \K N

X N \K N

a
Ï• dÎ³1,n
< 2M Â·

Îµ
Îµ
= .
12M
6

(3.15)

Combining estimates (3.14) and (3.15) gives
Z
Z
Îµ Îµ
3Îµ
5Îµ
a
Ï• dÎ³1,n
< + =
Ï• dÎ³1,n âˆ’
<
,
3 6
6
6
XN
XN
proving Condition (3.13).



3.4. Convergence of the cost functional. In order to prove the Î“-limsup inequality (II),
we need the cost C0 [Â·] to converge along the approximating sequence Î³n . We prove this in
the following lemma.
Lemma 3.3. We have C0 [Î³n0 ] â†’ C0 [Î³] as n â†’ âˆ.
Proof. Let us first consider the remainder part. Recall that for all n âˆˆ N we have
a
a
a
a
(Î³n0 âˆ’ Î³1,n
)(X N ) = (Î³2,n
+ Î³3,n
+ Î³4,n
)(X N ) < 3Îµn .

Thus, using the lower bounds (3.8) and (3.9) for distances in the support of the remainder
part, and the definition (3.2) of Îµn , we get


Z
2rn
3N (N âˆ’ 1)
N (N âˆ’ 1)
a
f
3Îµn â‰¤
rn â†’ 0
(3.16)
c d(Î³n0 âˆ’ Î³1,n
)â‰¤
2
5
2
N
X
as n â†’ âˆ. By continuity of the integral, we get
Z
c d(Î³ âˆ’ Î³1,n ) â†’ 0

(3.17)

XN

as n â†’ âˆ.
a
Let us now estimate the core part of the approximation. By the construction (3.7) of Î³1,n
and the choice (3.6) of Î»n , we have
Z
Z
Z
N (N âˆ’ 1)
N (N âˆ’ 1)
a
c dÎ³1,n âˆ’
c dÎ³1,n â‰¤
Îµn dÎ³1,n <
Îµn .
(3.18)
2
2
XN
XN
XN
Combining the above estimate with (3.16), (3.17) and (3.18) we get
Z
Z
Z
a
0
a
c dÎ³1,n âˆ’
c dÎ³1,n +
c d(Î³n0 âˆ’ Î³1,n
)
C0 [Î³n ] âˆ’ C0 [Î³] â‰¤
XN
XN
XN
Z
+
c d(Î³ âˆ’ Î³1,n ) â†’ 0
XN

as n â†’ âˆ.



MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

15

3.5. Finiteness of the entropy for the approximations. Next we show that the entropy
is finite for the approximating sequence. Notice that, in order to prove (II), we do not need
a better estimate on the entropy.
Lemma 3.4. For each n âˆˆ N we have E[Î³n0 ] < âˆ.
Proof. In order to see the finiteness of the entropy, it suffices to notice that each Î³n0 is a sum
k
k
n
of finitely many measures (Î³Ìƒn,k )N
k=1 each of which is of the form Î³Ìƒn,k = ÏÌƒ1 m âŠ— Â· Â· Â· âŠ— ÏÌƒN m with
dÏÌƒk

ÏÌƒki  Ï and dÏi â‰¤ 1. Indeed, by Proposition 2.3, the entropy is always bounded from below,
and so we can make a crude estimate:
!
!
Z
Nn
Nn
X
X
dÎ³Ìƒn,k
0
d
Î³Ìƒn,k
log
E[Î³n ] =
dm
XN
k=1
k=1


Nn Z
X
dÎ³Ìƒn,k
log
â‰¤ log(Nn ) +
dÎ³Ìƒn,k < âˆ.

dm
XN
k=1

3.6. Proof of condition (II). We are now ready to prove the Î“-lim sup inequality (II). By
Lemma 3.2 we already know that (Î³n0 )n converges to Î³. However, Cn [Î³n0 ] need not converge
to C[Î³]. This can be solved by making the convergence of (Î³n0 )n slower by repeating always
the same measure for sufficiently (but finitely) many times before moving to the next one.
We define k(n) for every n âˆˆ N as


âˆš
.
k(n) = min n, max 1, sup k âˆˆ N | Ï„n E[Î³j0 ] < 1 for all j â‰¤ k
By definition, 1 â‰¤ k(n) â‰¤ n. Moreover, since for every j âˆˆ N we have E[Î³j0 ] < âˆ by Lemma
0
3.4 and Ï„n â†’ 0 by definition, we have that k(n) â†’ âˆ as n â†’ âˆ. Thus, defining Î³n = Î³k(n)
,
for large enough n âˆˆ N we have
âˆš
0
0
0
Cn [Î³n ] = C0 [Î³k(n)
] + Ï„n E[Î³k(n)
] < C0 [Î³k(n)
] + Ï„n .
0
Recalling that by Lemma 3.3 we have C0 [Î³k(n)
] â†’ C0 [Î³], we conclude the proof.
In Proposition (2.5) the existence of a minimizer for the entropy-regularized cost was established. Now that we know that measures Î³ for which C0 (Î³) < âˆ can be approximated by
measures with not only finite costs but also finite entropy, we can say more:

Corollary 3.5. Let (X, d, m) be a Polish metric measure space. Assume that Ïm âˆˆ Pac (X)
satisfies Ï log Ï âˆˆ L1m (X) and Conditions (A) and (B). Assume that c : X N â†’ R âˆª {+âˆ}
satisfies Conditions (F 1) and (F 2). Then, for each Îµ > 0, there exists a unique minimizer
Î³ âˆˆ Î sym
N (Ï) for the entropic-regularized cost CÎµ [Î³], and this minimizer has a finite cost.
Proof. Our marginal measure satisfies Conditions (A) and (B), so there exists a measure
Î³ âˆˆ Î sym
N (Ï) that minimizes C0 with C0 [Î³] < âˆ. It must be noted that this measure can
have infinite entropy. However, because of the approximation result presented in the proof of
0
Condition (II) above, we get the existence of a measure Î³ 0 âˆˆ Î sym
N (Ï) such that C [Î³ ] < âˆ.
The uniqueness claim now follows, since the functional Î³ 7â†’ C [Î³] is strictly convex for
 > 0.


16

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

4. Entropic-Kantorovich Duality for Coulomb-type costs
We start by recalling the classical Fenchel-Rockafellar Theorem and we refer to the I.
Ekeland and R. TeÌmamâ€™s book [13, Theorem 4.2] for a more complete presentation and
references.
Theorem 4.1 (Fenchel-Rockafellar). Let X and Y be Banach spaces and A : X â†’ Y be linear
and continuous. Let F : X â†’ R âˆª {+âˆ} and G : Y â†’ R âˆª {+âˆ} be proper and convex
functions. Then


inf F [x] + G[Ax] x âˆˆ X = sup âˆ’ F âˆ— [âˆ’Aâˆ— Î³] âˆ’ Gâˆ— [Î³] Î³ âˆˆ Yâˆ—
where Aâˆ— : Yâˆ— â†’ Xâˆ— denotes the adjoint operator of A.
Next we prove the Entropic-Kantorovich duality for the problem (2.3).
Theorem 4.2 (Entropic Duality for repulsive costs). Let (X, d, m) be a Polish measure space.
Suppose Ïm âˆˆ P(X) such that (A) and (B) hold and Ï log Ï âˆˆ L1m (X), and c : X N â†’ [0, âˆ] is
a cost function
X
c(x1 , . . . , xN ) =
f (d(xi , xj )),
for all (x1 , . . . , xN ) âˆˆ X N ,
1â‰¤i<jâ‰¤N

where f : [0, +âˆ[â†’ [0, âˆ] is a function satisfying (F 1) and (F 2). Then, for Îµ > 0, the duality
holds
(N Z
)


Z
X
u1 âŠ• Â· Â· Â· âŠ• uN âˆ’ c
min CÎµ [Î³] = sup
ui dÏm âˆ’ Îµ
exp
dmN + Îµ
Îµ
Î³âˆˆÎ (Ï)
XN
ui âˆˆCb (X) i=1 X
 Z



Z
u âŠ• Â·Â·Â· âŠ• u âˆ’ c
= sup
N
udÏm âˆ’ Îµ
exp
dmN + Îµ ,
Îµ
X
XN
uâˆˆCb (X)
where v1 âŠ• Â· Â· Â· âŠ• vN denotes the operator (v1 âŠ• Â· Â· Â· âŠ• vN )(x1 , . . . , xN ) = v1 (x1 ) + Â· Â· Â· + vN (xN ).
Proof. First let us assume that X is a compact space. We denote by X = (Cb (X))N and
Y = Cb (X N ), where Cb (X) is the space of continuous and bounded functions on X, and
similarly for X N . By Riesz representation theorem, the space Y is dual to the space M(X N )
of signed regular Borel measures on X N . Thus we may define the Legendre-Fenchel transform
Gâˆ— of a functional G : Y â†’ R âˆª {+âˆ} by
Z

âˆ—
N
âˆ—
G : M(X ) â†’ R âˆª {+âˆ}, G [Ï€] = sup
Ïˆ dÏ€ âˆ’ G[Ïˆ] .
XN

ÏˆâˆˆCb (X N )

We apply Fenchel-Rockafellar Theorem 4.1 to the functionals
F : (Cb (X))N â†’ R âˆª {+âˆ} , (u1 , . . . , uN ) 7â†’ âˆ’

N Z
X
i=1

and
G : Cb (X N ) â†’ R âˆª {+âˆ} , Ïˆ 7â†’ Îµ

Z

ui dÏm

X

1

e Îµ (Ïˆâˆ’c) dmN ,

XN

and to the operator
A : (Cb (X))N â†’ Cb (X N ) , (u1 , . . . , uN ) 7â†’ u1 âŠ• Â· Â· Â· âŠ• uN .

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

17

Now F and G are proper and convex functionals and A is a linear and continuous operator.
So we may apply Fenchel-Rockafellar duality to get
inf{F [x] + G[Ax] | x âˆˆ X} = sup{âˆ’Gâˆ— [Î³] âˆ’ F âˆ— [âˆ’Aâ€  Î³] | Î³ âˆˆ Yâˆ— } .
This gives (since for every set S we have inf(S) = âˆ’ sup(âˆ’S) and sup S = âˆ’ inf(âˆ’S))
inf{Gâˆ— [Î³] + F âˆ— [âˆ’Aâ€  Î³] | Î³ âˆˆ Yâˆ— } = sup{âˆ’F [x] âˆ’ G[Ax] | x âˆˆ X} .
It remains to show that the above expression has exactly the form of our duality claim. The
claim that the right-hand sides correspond to each other follows immediately from our choices
of X, F , and G. So it remains to show that
inf{Gâˆ— [Î³] + F âˆ— [âˆ’Aâ€  Î³] | Î³ âˆˆ Yâˆ— } = CÎµ [Î³] âˆ’ Îµ .

(4.1)

To prove it, let Î³ âˆˆ M(X N ). Now we have
Z

N
N Z
X
X
âˆ—
âˆ—
N
F [âˆ’A Î³] = sup
ui (xi )dÎ³ âˆ’
ui (xi ) dÏm(xi ) (u1 , . . . , uN ) âˆˆ Cb (X)
X N i=1

(
0
=
+âˆ

i=1

X

if Î³ âˆˆ Î N (Ï)
.
otherwise

Let us then compute Gâˆ— [Î³]:
Z

âˆ—

G [Î³] =

Z

1
e Îµ (Ïˆâˆ’c) dmN

Ïˆ dÎ³ âˆ’ Îµ

sup
ÏˆâˆˆCb (X N )

XN


.

XN

If Î³ is not absolutely continuous with respect to mN we have Gâˆ— [Î³] = +âˆ. If Î³  mN , then
the supremum (that appears in the definition of Gâˆ— [Î³]) is realized at Ïˆ = Îµ log ÏÎ³ + c; this
holds also if the function ÏÎ³ is not continuous since it can be approximated by a sequence of
continuous functions. Thus we get for Î³  mN
Z


1
âˆ—
G [Î³] =
ÏÎ³ Â· Ïˆ âˆ’ Îµe Îµ (Ïˆâˆ’c) dmN
N
ZX
=
(ÎµÏÎ³ log ÏÎ³ + cÏÎ³ âˆ’ ÎµÏÎ³ ) dmN .
XN

Hence, if Î³ âˆˆ Î N (Ï), we have
Gâˆ— [Î³] = C0 [Î³] + ÎµE[Î³] âˆ’ Îµ .
This concludes the duality proof when X is a compact space.
The noncompact case: Due to Lemma 2.2, it suffices to prove the claim in the case where
the reference measure is Ïm instead of m; the finiteness of the measure Ïm now gives access
to inner regularity and to the approximability by compact sets. We will for simplicity denote
Ï := Ïm.
The claim is
min CÎµ [Î³] =

Î³âˆˆÎ N (Ï)

 Z
Z
sup
N
udÏ âˆ’ Îµ
uâˆˆCb (X)

X

XN


exp

u âŠ• Â·Â·Â· âŠ• u âˆ’ c
Îµ



âŠ—N

dÏ


+ Îµ.

18

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

For simplicity, let us denote
 Z
Z
udÏ âˆ’ Îµ
DÏ (u) := N


exp

XN

X

u âŠ• Â·Â·Â· âŠ• u âˆ’ c
Îµ



dÏâŠ—N


+ Îµ for all u âˆˆ Cb (X) .

We may assume that supuâˆˆCb (X) DÏ (u) > âˆ’âˆ; indeed, since we can test with the function
u â‰¡ 0, this always holds for cost functions that are bounded from below.
Let us make, in the notation of the primal functional, the dependence on the reference
measure explicit by the notation Î³ 7â†’ C (Î³|Âµ) when the reference measure on the space X is
Âµ. Thus the original notation Î³ 7â†’ C [Î³] corresponds to Î³ 7â†’ C (Î³|m).
Since the measures Ï and Î³ are inner regular, there exists a sequence (Kn )nâˆˆN of compact
subsets of X such that
Ï(Kn ) â†’ Ï(X)
Let us denote Î³n :=

1
N ) Î³| N
Î³(Kn
Kn

and

and Ïn :=

Î³(KnN ) â†’ Î³(X N ) .

1
Ï(Kn ) Ï|Kn .

Let us also denote by Î³nmin the minimizer

of the problem I (Ïn ). Since Î³ is the minimizer of the problem I (Ï) and since (due to the
absolute continuity of the integral and the continuity of the function t 7â†’ t log t)
lim |C (Î³n |Ïn ) âˆ’ C (Î³|Ï)| = 0 ,

(4.2)

lim |C (Î³n |Ïn ) âˆ’ C (Î³nmin |Ïn )| = 0 .

(4.3)

nâ†’âˆ

we have
nâ†’âˆ

By the duality result proven above for compact spaces, we have for all n âˆˆ N
DÏn (u) = C (Î³nmin |Ïn ) .

sup
uâˆˆCb (Kn )

Again, due to the absolute continuity of the integral, we have
lim

sup

nâ†’âˆ uâˆˆC (K )
n
b

DÏn (u) âˆ’

sup DÏ (u) = 0 .
uâˆˆCb (X)

Putting these conditions together, we get for all n âˆˆ N
C (Î³|Ï) âˆ’

sup DÏ (u)
uâˆˆCb (X)

â‰¤ |C (Î³|Ï) âˆ’ C (Î³n |Ïn )| + C (Î³n |Ïn ) âˆ’ C (Î³nmin |Ïn )
+ C (Î³nmin |Ïn ) âˆ’

sup
uâˆˆCb (Kn )

DÏn (u) +

sup
uâˆˆCb (Kn )

DÏn (u) âˆ’

sup DÏ (u) .
uâˆˆCb (X)

The claim follows by letting n â†’ âˆ.



Remark 4.3. Notice that we always have
(N Z
)


Z
X
u1 âŠ• Â· Â· Â· âŠ• uN âˆ’ c
dmN + Îµ
sup
ui dÏ âˆ’ Îµ
exp
Îµ
XN
ui âˆˆCb (X) i=1 X
 Z



Z
u âŠ• Â·Â·Â· âŠ• u âˆ’ c
â‰¥ sup
N
u dÏ âˆ’ Îµ
exp
dmN + Îµ.
Îµ
X
XN
uâˆˆCb (X)
We show that the equality actually holds by simply choosing a potential u(x) = (u1 (x) +
u2 (x) + Â· Â· Â· + uN (x))/N .

MULTI-MARGINAL ENTROPY-TRANSPORT WITH REPULSIVE COST

19

References
[1] M. Agueh and G. Carlier, Barycenters in the Wasserstein space, SIAM J. on Mathematical Analysis,
43 (2011), pp. 904â€“924.
[2] J.-D. Benamou, G. Carlier, and L. Nenna, A numerical method to solve optimal transport problems
with Coulomb cost, to appear as a chapter in â€œSplitting Methods in Communication and Imaging, Science
and Engineeringâ€, Springer, (2015).
[3]
, Generalized incompressible flows, multi-marginal transport and Sinkhorn algorithm, arXiv preprint
arXiv:1710.08234, (2017).
[4] G. Buttazzo, T. Champion, and L. De Pascale, Continuity and estimates for multimarginal optimal
transportation problems with singular costs, Applied Mathematics & Optimization, (2016), pp. 1â€“16.
[5] G. Buttazzo, L. De Pascale, and P. Gori-Giorgi, Optimal-transport formulation of electronic Density
Functional Theory, Physical Review A, 85 (2012), p. 062502.
[6] G. Carlier, V. Duval, G. PeyreÌ, and B. Schmitzer, Convergence of entropic schemes for optimal
transport and gradient flows, SIAM J. Math. Anal., 49 (2017), pp. 1385â€“1418.
[7] C. Cotar, G. Friesecke, and C. KluÌˆppelberg, Density Functional Theory and optimal transportation
with Coulomb cost, Comm. Pure Appl. Math., 66 (2013), pp. 548â€“599.
[8]
, Smoothing of transport plans with fixed marginals and rigorous semiclassical limit of the HohenbergKohn functional, Archive for Rational Mechanics and Analysis, 228 (2018), pp. 891â€“922.
[9] M. Cuturi, Sinkhorn distances: Lightspeed computation of optimal transport, in Advances in neural
information processing systems, 2013, pp. 2292â€“2300.
[10] S. Di Marino, L. De Pascale, and M. Colombo, Multimarginal optimal transport maps for 1dimensional repulsive costs, Canadian Journal of Mathematics â€“ Journal Canadien des MatheÌmatiques,
67 (2015), pp. 350â€“368.
[11] S. Di Marino and A. Gerolin, An optimal transportation approach for the SchroÌˆdinger Bridge problem
and convergence of the Sinkhorn algorithm, in preparation.
[12] S. Di Marino, A. Gerolin, and L. Nenna, Optimal transport theory for repulsive costs, Topological
Optimization and Optimal Transport: In the Applied Sciences, 17 (2017).
[13] I. Ekeland and R. Temam, Analyse convexe et problemes variationnelles, Dunod Gauthier-Villars, Paris,
(1974).
[14] R. Flamary and N. Courty, POT Python Optimal Transport library, 2017.
[15] A. Gerolin, A. Kausamo, and T. Rajala, Duality theory for multimarginal optimal transport with
repulsive costs in metric spaces, ESAIM Control Optim. Calc. Var., (to appear), (2018).
[16] N. Gigli and L. Tamanini, Second order differentiation formula on compact RCDâˆ— (K, N ) spaces,
arXiv:1701.03932, (2017).
[17] N. Gozlan and C. LeÌonard, Transport inequalities. a survey, Markov Processes and Related Fields, 16
(2010), pp. 635â€“736.
[18] H. G. Kellerer, Duality theorems for marginal problems, Zeitschrift fuÌˆr Wahrscheinlichkeitstheorie und
verwandte Gebiete, 67 (1984).
[19] C. LeÌonard, From the SchroÌˆdinger problem to the Mongeâ€“Kantorovich problem, Journal of Functional
Analysis, 262 (2012), pp. 1879â€“1920.
, A survey of the SchroÌˆdinger problem and some of its connections with optimal transport, Discrete
[20]
Contin. Dyn. Syst., (2014), pp. 1533â€“1574.
[21] E. H. Lieb, Density functionals for Coulomb systems, in Inequalities, Springer, 2002, pp. 269â€“303.
[22] T. Mikami, Mongeâ€™s problem with a quadratic cost by the zero-noise limit of h-path processes, Probability
theory and related fields, 129 (2004), pp. 245â€“260.
[23] L. Nenna, Numerical Methods for Multi-Marginal Opimal Transportation, PhD thesis, UniversiteÌ ParisDauphine, 2016.
[24] G. PeyreÌ and M. Cuturi, Computational Optimal Transport, vol. 11, Now Publishers, Inc., 2019.
[25] E. SchroÌˆdinger, UÌˆber die umkehrung der naturgesetze, Verlag Akademie der wissenschaften in kommission bei Walter de Gruyter u. Company, 1931.
[26] M. Seidl, S. Di Marino, A. Gerolin, K. Giesbertz, L. Nenna, and P. Gori-Giorgi, The StrictlyCorrelated Electron functional for spherically symmetric systems revisited, Accepted in Physical Review
A (available in arXiv:1702.05022), (2016).
[27] K.-T. Sturm, On the geometry of metric measure spaces, Acta Math., 196 (2006), pp. 65â€“131.

20

AUGUSTO GEROLIN, ANNA KAUSAMO, AND TAPIO RAJALA

Vrije Universiteit Amsterdam, Department of Theoretical Chemistry, FEW, De Boelelaan
1083, 1081HV Amsterdam, The Netherlands
E-mail address: augustogerolin@gmail.com
University of Jyvaskyla, Department of Mathematics and Statistics, P.O. Box 35 (MaD),
FI-40014 University of Jyvaskyla, Finland
E-mail address: anna.m.kausamo@jyu.fi
E-mail address: tapio.m.rajala@jyu.fi

