MNRAS 000, 1â€“22 (2019)

Preprint 17 December 2019

Compiled using MNRAS LATEX style file v3.0

Renormalisation of linear halo bias in N-body simulations
Kim F. Werner,1 Cristiano Porciani1?
1 Argelander-Institut

fuÌˆr Astronomie, Auf dem HuÌˆgel 71, 53121 Bonn

arXiv:1907.03774v2 [astro-ph.CO] 16 Dec 2019

Accepted XXX. Received YYY; in original form ZZZ

ABSTRACT

The interpretation of redshift surveys requires modeling the relationship between largescale fluctuations in the observed number density of tracers, Î´h , and the underlying matter density, Î´. Bias models often express Î´h as a truncated series of integrodifferential operators acting on Î´, each weighted by a bias parameter. Due to the
presence of â€˜composite operatorsâ€™ (obtained by multiplying fields evaluated at the
same spatial location), the linear bias parameter measured from clustering statistics
does not coincide with that appearing in the bias expansion. This issue can be cured
by re-writing the expansion in terms of â€˜renormalisedâ€™ operators. After providing a
pedagogical and comprehensive review of bias renormalisation in perturbation theory,
we generalize the concept to non-perturbative dynamics and successfully apply it to
dark-matter haloes extracted from a large suite of N-body simulations. When comparing numerical and perturbative results, we highlight the effect of the window function
employed to smooth the random fields. We then measure the bias parameters as a
function of halo mass by fitting a non-perturbative bias model (both before and after
applying renormalisation) to the cross spectrum PÎ´h Î´ (k). Finally, we employ Bayesian
model selection to determine the optimal operator set to describe PÎ´h Î´ (k) for k < 0.2 h
Mpcâˆ’1 at redshift z = 0. We find that it includes Î´, âˆ‡2 Î´, Î´2 and the square of the traceless tidal tensor, s2 . Considering higher-order terms (in Î´) leads to overfitting as they
cannot be precisely constrained by our data. We also notice that next-to-leading-order
perturbative solutions are inaccurate for k & 0.1 h Mpcâˆ’1 .
Key words: cosmology: theory, large-scale structure of the Universe â€“ methods:
analytical, numerical, statistical

1

INTRODUCTION

The idea that galaxies could be biased tracers of the underlying matter distribution dates back to the 1980s and is intimately linked with the development of the cold-dark-matter
(CDM1 ) cosmological model (e.g. Kaiser 1984; Davis et al.
1985; Rees 1985; Dekel & Rees 1987; White et al. 1987). For
many years, the leading galaxy-biasing model assumed a local and deterministic relation between the smoothed galaxy
density contrast Î´g and the matter density contrast Î´ evaluated at the same position x, i.e. Î´g (x) = f [Î´(x)] where f denotes a generic â€˜bias functionâ€™ (Fry & Gaztanaga 1993). The
freedom in the function f was often described in terms of the
â€˜bias parametersâ€™ i.e. the Taylor coefficients bi appearing in
the â€˜bias expansionâ€™ Î´g = b0 + b1 Î´ + b2 Î´2 + . . . . These parameters depend on the coarse-graining scale used to define Î´
and Î´g . The reasons for smoothing are multiple: (i) galaxies
?

E-mail: kwerner@astro.uni-bonn.de,
porciani@astro.uni-bonn.de
1 Table 1 lists all the acronyms used in the paper.
Â© 2019 The Authors

are discrete objects and we want to define a continuous density field; (ii) our model aims at describing the largest scales
only; (iii) the bias expansion should be well-behaved so that
it can be truncated at finite order; (iv) the dynamical model
we use to evolve cosmological perturbations breaks down on
small scales.
This bias model is applicable to any tracers of the largescale structure (LSS) of the Universe (e.g. galaxy clusters,
dark-matter (DM) haloes, galaxies detected with different
selection criteria) by picking the appropriate function f or,
equivalently, the corresponding set of bias parameters. In
particular, if one considers DM haloes, the local ansatz for
the bias relation is supported by spherically-symmetric models of gravitational collapse which also provide predictions
for the bias parameters as a function of halo mass (e.g. Mo
& White 1996; Mo et al. 1997; Porciani et al. 1998).
It was later realised that anisotropic gravitational collapse generates non-local and stochastic terms in the bias relation (Catelan et al. 1998) and that this originates leadingorder (LO) corrections to the galaxy bispectrum (Catelan
et al. 2000). The implications of this result were fully appre-

2

Werner & Porciani

ciated only a decade later when local bias was shown to be
insufficient to describe the clustering of DM haloes (Manera & GaztanÌƒaga 2011; Matsubara 2011; Roth & Porciani
2011; Pollack et al. 2012, 2014) and evidence for bias corrections that are quadratic in the tidal tensor was found in
N-body simulations (Baldauf et al. 2012; Chan et al. 2012).
At the same time, it was realized that the bias expansion
should also contain a series of derivative terms starting with
R2 âˆ‡2 Î´ because haloes and galaxies collect material from an
extended region of space of characteristic size R (e.g. Desjacques 2008; McDonald & Roy 2009; Desjacques et al. 2010;
Schmidt et al. 2013; Fujita et al. 2016). The current consensus is that the bias relation should be compatible with all
possible symmetries of gravitational instability (McDonald
& Roy 2009; Kehagias et al. 2014; Senatore 2015; Eggemeier
et al. 2019) and thus depend on several other fields than Î´
(see section 2.2).
Different techniques have been developed to measure
the corresponding bias coefficients for DM haloes in numerical simulations. One possibility is to fit model predictions
to the N-body data for various clustering statistics â€“ e.g.
power spectra or two-point correlation functions â€“ (Saito
et al. 2014; Bel et al. 2015; Hoffmann et al. 2015, 2017;
Modi et al. 2017; Hoffmann et al. 2018) or even at the field
level (Roth & Porciani 2011; Schmittfull et al. 2018). Alternatively, one can measure the response of the halo population to long-wavelength perturbations in the matter density
(Li et al. 2016; Baldauf et al. 2016; Lazeyras et al. 2016;
Lazeyras & Schmidt 2019). Lastly, bias parameters can be
obtained by cross-correlating the corresponding fields that
appear in the bias expansion with the halo density distribution (Abidi & Baldauf 2018; Lazeyras & Schmidt 2018).
Another important line of research has examined how
measurable clustering statistics of tracers depend on the bias
relation and on the statistical properties of the underlying
matter-density field. This is, in fact, key to interpret results
from galaxy redshift surveys. For a local bias relation and
in the presence of a Gaussian matter-density field, the ratio b2eff (k) between the (shot-noise subtracted) tracer- and
matter power spectra tends to the constant b21 when k â†’ 0
(Szalay 1988; Coles 1993; Fry & Gaztanaga 1993; Gaztanaga
& Baugh 1998). However, for a non-Gaussian matter density distribution, the constant does not coincide with the
linear bias parameter and also depends on the cumulants of
the matter density as well as higher-order bias parameters
(Scherrer & Weinberg 1998). In particular, if the statistics of
the matter distribution are derived using standard perturbation theory, the LO correction to b21 scales with the variance
of the linear density field that grows large when the coarsegraining scale becomes small (Heavens et al. 1998, see also
our section 2.3.2 for further details). This sensitivity of the
theoretical predictions on the smoothing scale that defines
the bias function complicates the use of bias models to interpret observational data.
Inspired by applications of the renormalisation group to
the perturbative solution of ordinary differential equations,
McDonald (2006) proposed a different interpretation of the
theoretical predictions. The key concept is that the parameters bi appearing in the bias expansion do not actually correspond to the physical constants that can be measured in a
survey. They are, instead, bare quantities that do not take

into account the contribution of perturbative (loop) corrections to the leading terms. One can then rewrite the result
of the perturbative calculations for the power spectrum of
the tracers in terms of measurable â€˜renormalised2 â€™ quantities that do not depend on the smoothing scale. McDonald
& Roy (2009) extended this approach to a bias relation that
also depends on the tidal field. More recently, by using the
diagrammatic representation of perturbation theory (PT),
Assassi et al. (2014) derived a set of conditions that the bias
expansion must satisfy to be perturbatively renormalised order by order (see also Senatore 2015). From these studies it
emerges that only bias expansions that include terms proportional to the tidal field and to derivative of the matter
density (e.g. âˆ‡2 Î´) can be renormalised.
Bias renormalisation is analogous to methods used in
statistical field theory and quantum field theory. In general,
these techniques provide a convenient way to build â€˜effective
theoriesâ€™ that describe physics at a given range of length
(and/or time, mass, etc.) scales and with a given accuracy
by using a finite set of parameters. This bypasses the need
for the â€˜full theoryâ€™ that includes physics on all scales but
might be intractable or, even, unknown. Likewise, the goal
of bias renormalisation is to build an effective model for the
clustering statistics of tracers. Much of the jargon used in
the literature on bias renormalisation is imported from other
branches of physics. Less theoretically inclined researchers
shy away from the unfamiliar notation and concepts. One
of the motivations of this paper is to provide a pedagogical
review of the subject and some concrete examples to see it
â€˜in actionâ€™. A second one is that there are a number of questions that are still unanswered. Are all the possible operators allowed by symmetries necessary in the bias expansion?
Down to what distances does the renormalised bias expansion (truncated to some order) give an accurate description
of the observed clustering statistics of tracers like galaxies?
Although the renormalisation of the bias expansion has
always been discussed within the context of cosmological
PT, only some of its aspects are fully perturbative. If one
writes down a bias expansion in terms of Taylor coefficients,
renormalisation is necessary also when one deals with the exact dynamics (extracted e.g. from simulations as in our case)
in order to account for the non-linear terms (e.g. Î´2 ) that
generate smoothing-dependent spectra. In general, renormalisation fixes a â€˜languageâ€™ problem in the way we describe biasing, and PT provides an approximate solution on
how to implement the remedy in practice. Here we present
a first step towards implementing renormalisation within a
large suite of N-body simulations where the dynamics is nonperturbative. This will shed new light on the limitations of
the perturbative approach.
Usually, tests of the renormalised bias models are conducted by fitting the full perturbative expression for some
clustering statistics to N-body simulations (e.g. Saito et al.
2014). We instead apply the renormalisation procedure step
by step to the numerical data, examining all the contributions due to the relevant fields separately. For simplicity,

2

The whole procedure parallels Wilsonian renormalisation in
field theories. The coarse-graining scale of the density fields here
replaces the cutoff that regularises the loop integrals in the quantum field theories.
MNRAS 000, 1â€“22 (2019)

Bias renormalisation
2

Table 1. Acronyms used in the paper and sections or equations
where they are introduced.
Acronym

Meaning

Section

CDM
DM
LSS
LO
PT
RG
SPT
NLO
EFT
CIC
FFT
MCMC
WAIC
AIC
DIC
NR
IE
RL
RNL

Cold dark matter
Dark matter
Large-scale structure
Leading order
Perturbation theory
Renormalisation group
Standard perturbation theory
Next-to-leading order
Effective field theory
Cloud in cell
Fast Fourier transform
Markov Chain Monte Carlo
Widely applicable information criterion
Akaike information criterion
Deviance information criterion
No renormalisation
Intermediate expansion
Linear renormalisation
Non-linear renormalisation

1
1
1
1
1
1
2.1
2.1
2.2
3.2
3.2
5.1
Eq.
5.2
5.2
Eq.
Eq.
Eq.
Eq.

5.2,

5.3,
5.4,
5.4,
5.4,

we focus on the cross power spectral density PÎ´h Î´ (k) of the
matter and halo density fields3 defined as hÎ´h (k) Î´(k 0 )i =
(2Ï€)3 PÎ´h Î´ (k) Î´D (k + k 0 ), where the brackets h. . . i denote the
average over an ensemble of realizations and Î´D (k) is the
Dirac delta distribution in three dimensions.
The detailed goals of this work are to (i) apply the
Wilsonian renormalisation-group (RG) method to halo bias
in a large suite of N-body simulations and study the behaviour of the fields appearing in the bias expansion as a
function of the coarse-graining scale; (ii) measure the bias
parameters of the DM haloes extracted from simulations by
fitting the halo-matter cross-power spectrum PÎ´h Î´ (k); (iii)
follow their evolution (running) induced by the RG coarsegraining scale; (iv) test that they can be renormalised by rearranging the terms in the bias expansion; (v) use Bayesian
model-selection techniques to determine which bias parameters are necessary to accurately describe PÎ´h Î´ (k) up to
k = 0.2 h Mpcâˆ’1 . In this paper, we introduce the main concepts of our study and focus on the renormalisation of the
linear bias coefficient, b1 . We plan to discuss the renormalisation of the bias parameters at second order in our future
work.
The structure of this paper is as follows: The theoretical motivations and methods of bias renormalisation are
reviewed in section 2 where we also present an original discussion on the impact of filter functions. The numerical techniques and N-body simulations we use are described in section 3. Our results on renormalisation are presented in section 4 and the measurements of the bias parameter in section 5. Finally, our conclusions are laid down in section 6.

3

With a little abuse of notation, we denote by f (k) the Fourier
transform of the function f (x) where x indicates the comoving
position.

MNRAS 000, 1â€“22 (2019)

2.1

3

TRACER BIAS IN COSMOLOGICAL
PERTURBATION THEORY
Standard perturbation theory in a nutshell

Standard perturbation theory (SPT, for a review, see
Bernardeau et al. 2002) describes matter as a pressureless
and inviscid fluid to model the growth of density and velocity perturbations in a Friedmann-Robertson-Walker background with expansion factor a. The system formed by the
continuity, Euler and Poisson equations is solved perturbatively. At any given time, the fastest growing solution for
the density contrast, Î´(x), is expanded as
Î´(x) = Î´1 (x) + Î´2 (x) + Î´3 (x) + . . .

(68)

(69)
(70)
(71)
(74)

(1)

where Î´1 denotes the growing-mode solution to the linearized
set of equations and Î´n = O(Î´1n ). The time evolution of Î´1 is
governed by the linear growth factor D(a), such that Î´1 âˆ D.
Similarly, the fastest growing mode for the divergence of
Ã›
the peculiar velocity âˆ‡ Â· v = âˆ’aH f Î¸ â€“ where H = a/a
is
the Hubble parameter (the dot indicates differentiation with
respect to cosmic time) and f = d ln D/d ln a â€“ is written as
Î¸(x) = Î¸ 1 (x) + Î¸ 2 (x) + Î¸ 3 (x) + . . . ,

(2)

with Î¸ 1 = Î´1 . In Fourier space,
âˆ«




Î´n k =
Fn k1, . . . , kn Î´1 k1 . . . Î´1 kn
Î´D k1 + Â· Â· Â· + kn âˆ’ k

 d3 k1
d3 k n
.
.
.
(2Ï€)3
(2Ï€)3

(3)

and

Î¸n k =

âˆ«




G n k1, . . . , kn Î´1 k1 . . . Î´1 kn
Î´D k1 + Â· Â· Â· + kn âˆ’ k

 d3 k 1
d3 k n
...
,
3
(2Ï€)
(2Ï€)3

(4)

where the kernels Fn and G n are homogeneous functions
of degree zero that describe the couplings between Fourier
modes generated by the dynamical non-linearities. These
functions obey recursion relations that can be solved order by order starting from F1 = G1 = 1 (e.g. Goroff et al.
1986). For instance, the second-order kernels (symmetrized
over permutations of their arguments) are
!
!2
5 1 k1 Â· k2 k 1 k 2
2 k1 Â· k2
F2 k1, k2 ) = +
+
+
,
(5)
7 2 k1 k2 k2 k1
7 k1 k2
3 1 k1 Â· k2
G2 k1, k2 ) = +
7 2 k1 k2

!
!2
k1 k2
4 k1 Â· k2
+
+
,
k2 k1
7 k1 k2

(6)

Although these expressions are exact only in an Einstein-de
Sitter universe, they provide an excellent approximation also
in the Î›CDM scenario (Bernardeau 1994; Lee et al. 2014).
Assuming Gaussian initial conditions allows us to compute perturbative expansions for statistical quantities averaged over an ensemble of realisations of Î´1 . For instance, let
us consider the power spectrum of matter density perturbations, PÎ´Î´ (k), defined as hÎ´(k) Î´(k 0 )i = (2Ï€)3 PÎ´Î´ (k) Î´D (k + k 0 ).
Within SPT and up to fourth order in Î´1 , we can write the
â€˜correlatorâ€™ hÎ´Î´i ' hÎ´1 Î´1 i + hÎ´2 Î´2 i + hÎ´3 Î´1 i (the obvious dependence on the wavevectors is understood here to simplify

4

Werner & Porciani

notation). Therefore, PÎ´Î´ (k) can be approximated as
PÎ´Î´ (k) '

(11)
PÎ´Î´ (k) +

(22)
PÎ´Î´ (k) +

(31)
PÎ´Î´ (k) ,

(7)

(11)

where the LO term PÎ´Î´ (k) coincides with the linear power
spectrum P11 (k) while the next-to-leading-order (NLO) corrections are
âˆ«
d3 q
(22)
PÎ´Î´ (k) = 2
F22 (q, k âˆ’ q) P11 (|k âˆ’ q)|) P11 (q)
,
(8)
(2Ï€)3
âˆ«
d3 q
(31)
PÎ´Î´ (k) = 3 P11 (k) F3 (q, âˆ’q, k) P11 (q)
.
(9)
(2Ï€)3
A powerful diagrammatic technique has been introduced
to conveniently perform the SPT expansion of ensembleaveraged statistics (e.g. Bernardeau et al. 2002). This is analogous to the method introduced by Feynman in quantum
electrodynamics. In most cases, LO contributions are associated with tree diagrams (in the sense of graph theory) and
are thus called â€˜tree-level termsâ€™. Evaluating these quantities
does not require any integration (see e.g. P11 (k) above). On
the other hand, terms associated with diagrams containing
n-loops give rise to â€˜n-loop correctionsâ€™ that require n inte(22)
(13)
grations (see e.g. the 1-loop term PÎ´Î´ (k) + PÎ´Î´ (k)). Note
that, if the tree-level term vanishes, the LO is given by the
1-loop terms (see e.g. section 2.3.2).
SPT mainly suffers from two limitations. First, being a
perturbative technique, it is expected to break down when
and where |Î´(x)| ' 1. Second, the gravitational collapse of an
initially cold distribution of collisionless DM develops multistream regions where the velocity field is not single-valued.
However, the pressureless-fluid approximation adopted by
SPT does not account for this phenomenon which alters
the dynamics of the system. N-body simulations show that,
within the Î›CDM scenario, SPT provides rather accurate
predictions for 2- and 3-point statistics at redshifts z > 1
and k . 0.2 h Mpcâˆ’1 while it becomes increasingly imprecise at lower redshifts (for the same wavenumbers) as the
variance of the density perturbations approaches unity (e.g.
Carlson et al. 2009; Nishimichi et al. 2009; Blas et al. 2014).
2.2

Biasing as an effective field theory

We are interested in describing how discrete objects (for
example DM haloes or galaxies) trace the smooth matter
density field throughout the Universe. Since haloes assemble from the gravitational collapse of matter on small scales
and galaxies form within them, it is reasonable to assume
that some deterministic relationship exists between the density of matter and that of the discrete tracers on large scales.
Numerical simulations and simple toy models that associate
haloes to peaks in the initial density field provide supporting
evidence in favour of this argument. However, the physics of
halo and galaxy formation is complex, highly non-linear and
non-perturbative. Although we can simulate it with the help
of a computer, we are not able to make analytical predictions. Given these circumstances, for practical applications
like the interpretation of galaxy redshift surveys, it makes
sense to opt for a simplified description that holds true only
on large scales.
Analogous problems in other fields of physics led to the
development of effective field theories (EFTs). We highlight
here how the basic concepts of an EFT can be used to model

large-scale biasing. We first introduce the effective overdensity field of the tracers4 , Î´h (x, t), which describes their largescale clustering, but is blind to their precise distribution on
small scales. In order to relate this quantity to the underlying
mass-overdensity field, Î´, it is necessary to identify all possible dependencies that are compatible with the symmetries of
the problem. Assuming that the tracers are non-relativistic
implies that gravitational physics is fully described in terms
of the (rescaled) peculiar gravitational potential Ï†, defined
so that âˆ‡2 Ï† = Î´. Taking into account the equivalence principle and that Î´h is a scalar under rotations, it follows that
Î´h can only depend on scalar combinations of second spatial
derivatives of the peculiar gravitational potential âˆ‚i âˆ‚ j Ï†, and
first spatial derivatives of the peculiar velocity field âˆ‚ j 3 i (McDonald & Roy 2009; Kehagias et al. 2014; Senatore 2015).
The second key step in the construction of an EFT for
biasing is to consider that the physics regulating the clustering of tracers is non-local in space and time. The material
that forms a tracer was dispersed within an extended patch
of characteristic size R at early times and needed a characteristic time T to assemble together. In general, R . 10
hâˆ’1 Mpc (the Lagrangian size of galaxy clusters) which is
small compared with the scales we want to describe using our
EFT. On the other hand, T is never short compared to the
Hubble time. It follows that the effective theory of biasing
should be approximately local in space but non-local in time
(Senatore 2015). In mathematical terms, this means that Î´h
should depend on the cosmological perturbations evaluated
along the past worldlines of the fluid elements that end up
forming the tracers at a given location (or, better, within a
given patch).
Since we are only interested in the large spatial scales,
the third step is to expand the generic (and unknown) functional Î´h in powers of the cosmological fluctuations and
their spatial derivatives (to account for the mild spatial
non-locality). Note that the tensor âˆ‚i âˆ‚ j Ï† is a dimensionless
quantity and its spatial derivatives need to be multiplied by
a length scale of order R in the expansion. It follows that
all derivative corrections will be suppressed on scales much
larger than R. This is more easily seen in Fourier space. For
instance, let us consider the lowest derivative correction to
terms that are proportional to Î´, i.e. âˆ¼ R2 âˆ‡2 Î´ (as we need
a scalar under rotations). In Fourier space this term is proportional to (k R)2 and thus heavily suppressed for scales
k  Râˆ’1 . On the other hand, this also implies that the
derivative expansion breaks down on scales of order R.
Finally, the non-locality in time is accounted for by
making some further hypotheses, namely by assuming that
cosmological perturbations evolve as in SPT. In this case,
the expansion of Î´h is re-organised to avoid duplication of
terms (for instance the velocity divergence coincides with
the overdensity at linear order) and its coefficients are redefined as integrals over time of the original ones (Mirbabayi
et al. 2015; Angulo et al. 2015; Desjacques et al. 2018b,a).
Up to third order in the cosmological perturbations, one

4

The subscript â€˜hâ€™ refers to DM haloes, but the framework is
applicable to any tracer.
MNRAS 000, 1â€“22 (2019)

Bias renormalisation
thus obtains
2

2

2

Î´h = b0 + b1 Î´ + b âˆ‡2 Î´ âˆ‡ Î´ + b2 Î´ + bs2 s
+ b3 Î´3 + bÎ´s2 Î´s2 + bs3 s3 + bÎ“3 Î“3 ,

(10)

where we have (i) decomposed the tensor âˆ‚i âˆ‚ j Ï† into its trace
Î´ and the traceless part,


1
1
si j = âˆ‚i âˆ‚ j Ï† âˆ’ Î´iKj Î´ = âˆ‚i âˆ‚ j âˆ‡âˆ’2 âˆ’ Î´iKj Î´ = Î³i j Î´ ,
(11)
3
3
(with âˆ‡âˆ’2 the inverse of the Laplacian operator and Î´iKj the
Kronecker symbol); (ii) introduced the scalars s2 = si j s ji ,
s3 = si j s jk ski ; (iii) used the (rescaled) velocity potential Ï†3
such that âˆ‡2 Ï†3 = Î¸ to define the tensor pi j = âˆ‚i âˆ‚ j Ï†3 âˆ’ 31 Î´iKj Î¸
and the operator5 Î“3 = s2 âˆ’p2 âˆ’(2/3)(Î´2 âˆ’Î¸ 2 ) with p2 = pi j p ji ;
(iv) included only the leading higher-derivative term âˆ âˆ‡2 Î´,
for simplicity.
In compact form, the bias expansion can be written as
Ã•
Î´h =
bO O ,
(12)
O

where the sum runs over a fixed basis of operators, O, that
are compatible with the symmetries and the evolution of
cosmological perturbations while the bias parameters, bO ,
depend on the characteristics of the population of tracers
(e.g. the halo mass, the galaxy luminosity or the intensity of
a particular emission line).
The expressions above are meant to relate the spatial
distribution of tracers on large scales with the underlying
long-wavelength cosmological perturbations in a deterministic way. However, the short-wavelength fluctuations (to
which our effective theory is blind by construction) also play
a role in determining the precise location of the tracers. In
order to account for this phenomenon in the theory, we introduce a certain degree of randomness in the bias expansion
by assuming that the bias coefficients have also a zero-mean
stochastic component O , i.e.
Ã•
Î´h =
(13)
(bO + O ) O .
O

Furthermore, it is customary to treat each stochastic term
as a perturbation O(Î´). For example, to second order, we can
write:
Î´h = b0 +0 +b1 Î´ +b âˆ‡2 Î´ âˆ‡2 Î´ +1 Î´ + âˆ‡2 Î´ âˆ‡2 Î´ +b2 Î´2 +bs2 s2 . (14)
Under the assumption that the stochastic terms do not correlate with the long-wavelength cosmological perturbations,
their statistical properties are fully determined by their
auto- and cross-correlation functions (or auto- and crossspectra in Fourier space). In the literature, it is often assumed that the cross-spectrum between O and O0 can be
written as a series expansion in k 2 ,
Î¥OO0 (k) = Î¥0,OO0 + Î¥2,OO0 k 2 + Î¥4,OO0 k 4 + . . . .

(15)

Once again, this reflects the fact that Î´h should be determined by the value assumed by the stochastic fields within
5

The bias expansion is sometimes written using the so-called
second- and third-order â€˜Galileonâ€™ operators, G2 (Ï†) and G3 (Ï†) (e.g.
Assassi et al. 2014, see also Chan et al. 2012). The relation between this set of operators and ours is G2 (Ï†) = s 2 âˆ’ (2/3) Î´ 2 and
G3 (Ï†) = âˆ’Î´ 3 /9 âˆ’ s 3 + Î´s 2 /2. Note that Î“3 = G2 (Ï†) âˆ’ G2 (Ï†3 ).
MNRAS 000, 1â€“22 (2019)

5

an extended region of space and not only at one point. However, when taken term by term, this expansion makes little sense in configuration space. While Î¥0,OO0 gives rise to
a standard shot-noise term with a 2-point correlation that
is proportional to the Dirac delta distribution at zero lag,
Î´D (r), the remaining terms generate contributions proportional to âˆ‡2n Î´D (r). These â€˜contact termsâ€™ (as they are generally dubbed in field theory) appear because we are considering an asymptotic expansion in Fourier space that breaks
down on small scales. A more sophisticated treatment of the
short-wavelength modes should then be used to discuss the
statistics of tracers in configuration space.
A note is in order regarding equations (10), (12),
and (13). Implicit in the definition of all fields is a lowpass smoothing procedure that isolates the long-wavelength
modes to which the theory applies. In particular, it is necessary to specify how the smoothing is done for the non-linear
terms like Î´2 and s2 . In fact, the long-wavelength modes of Î´2
depend on the short-wavelength modes of Î´ implying that Î´2
cannot be reliably computed with a perturbative approach
and that it can grow large even at low k. Since we want to
consider only the contribution of the large-scale modes of the
density perturbations, the only meaningful interpretation of
the r.h.s. in equations (10), (12), and (13) is to smooth the
matter overdensity field first and then use the low-pass filtered Î´ to evaluate the non-linear operators (Heavens et al.
1998). Filtering out the short-wavelength modes with k > Î›
is thus necessary for several reasons: (i) as we have already
mentioned, to only consider the scales that are described by
the theory; (ii) to ensure that |Î´(x)|  1 and a series expansion of the bias relation in the cosmological perturbations
makes sense; and (iii) to be able to apply SPT.
The ultimate goal of the effective theory of biasing is to
model the observed n-point correlation functions (and their
corresponding multi-spectra in Fourier space) for tracers on
large scales. In this work, we focus on two-point statistics in
Fourier space. The model predictions are obtained by correlating the Fourier transform of equation (13) either with
itself or with the Fourier transform of the overdensity field.
This provides a systematic expansion of the spectra organized according to the importance of its terms based on
a power-counting argument. The underlying assumption is
that there exist two well-defined scales: a non-linearity scale
Rnl (at which physics becomes non-perturbative and the expansion in powers of the cosmological fluctuations breaks
down) and a non-locality scale L (at which the expansion
in powers of the higher-derivative terms breaks down). The
different contributions to the spectra scale as powers of k L
and k Rnl . Truncating the expansion at a given order thus
provides results with reliable error estimates without referencing any quantity outside of the theory. The bias parameters and the coefficients that define the statistical properties
of the stochastic fields are free parameters that need to be
tuned in order to match observations. However, since the
non-linear operators of the theory are heavily dependent on
the smoothing scale, the best-fitting coefficients will inherit
a dependence on Î›. As we have already mentioned in the
introduction, an analogy can be established between this
description of galaxy biasing and the Wilsonian renormalisation in quantum field theory. In brief, the bias series can be
re-organized so that to eliminate the so-called â€˜UV-sensitiveâ€™
terms that depend on Î› order by order in the perturbative

6

Werner & Porciani

expansion. This is equivalent to expressing the bias relation
in terms of a set of â€˜renormalisedâ€™ operators [O] built from
the original operator basis O
Ã•
Î´h =
(b[O] + [O] ) [O] .
(16)

with
(22)
(k)
Î´2 Î´

P

=2

âˆ«



 d3 q
F2 q, k âˆ’ q P11 q P11 |k âˆ’ q|
,
(2Ï€)3

(22)


 d3 q
F2 âˆ’ q, k P11 q
.
(2Ï€)3

(23)

and

[O]
(31)
(k)
Î´2 Î´

P
2.3

Bias renormalisation

The bias renormalisation forms the main subject of our investigation and, for this reason, we explore the related concepts in more detail.

2.3.1

UV-sensitivity of composite operators

Even for small values of k, Î´2 receives contributions from all
scales. For instance, its expectation value,
âˆ« âˆ
1
hÎ´2 (x)i = 2
q2 PÎ´Î´ (q) dq â‰¡ Ïƒ 2 ,
(18)
2Ï€ 0
can get very large (or even diverge) if the density perturbations have substantial power at small scales. Similarly, the
cross spectrum of Î´2 with the matter-density fluctuations,
defined as hÎ´2 (k) Î´(k 0 )i = (2Ï€)3 PÎ´ 2 Î´ (k) Î´D (k + k 0 ), coincides
with an integral over all scales of the matter bispectrum
âˆ«
d3 q
PÎ´ 2 Î´ (k) =
BÎ´Î´Î´ (q, k âˆ’ q, âˆ’k)
,
(19)
(2Ï€)3
where hÎ´(p) Î´(q) Î´(k)i = (2Ï€)3 BÎ´Î´Î´ (p, q, k) Î´D (p + q + k). All
this implies that, if a low-pass filter W(k, Î›) is applied to Î´,
then Î´2 (k) inherits a strong dependence on Î›. In brief, we
say that the composite operators Î´2 and s2 are UV-sensitive.

Composite operators in SPT

To LO in SPT, we can write the matter power spectrum
(LO)
(LO)
PÎ´Î´ (k) = P11 (k) and the bispectrum BÎ´Î´Î´ (k1, k2, k3 ) =
(112)

(121)

(211)

BÎ´Î´Î´ (k1, k2, k3 ) + BÎ´Î´Î´ (k1, k2, k3 ) + BÎ´Î´Î´ (k1, k2, k3 ). By substituting these approximations in equations (18) and (19)
one obtains
âˆ« Î›
1
2
Ïƒ(LO)
= lim
q2 P11 (q) dq â‰¡ lim Ïƒ12 (Î›) ,
(20)
Î›â†’âˆ 2Ï€ 2 0
Î›â†’âˆ
and
(LO)
(k)
Î´2 Î´

P

=

âˆ« h

(112)

BÎ´Î´Î´ (q, k âˆ’ q, âˆ’k) + cyclical

(22)
(k) +
Î´2 Î´

=P

(31)
(k) ,
Î´2 Î´

P



âˆ«

The behaviour of these cross-spectra at large scales (k â†’ 0)
is usually determined by using spherical coordinates (with
polar axis k) and limiting the integration in q with an upper
cutoff Î›. It turns out that
68 2
(31)
P 2 (k) =
Ïƒ (Î›) P11 (k) ,
(24)
Î´ Î´
21 1
(31)

The bias expansion given in equation (13) contains operators
obtained by multiplying two fields evaluated at the same
spatial location, like Î´2 and s2 . These â€˜local operatorsâ€™ or
â€˜composite operatorsâ€™ (as they are generally called in field
theories) are very sensitive to the short-wavelength modes
of Î´ that are not accurately modelled by SPT. This can be
easily understood, for example, by inspecting the Fourier
transform of Î´2 :
âˆ«
d3 q
Î´2 (k) =
Î´(q) Î´(k âˆ’ q)
.
(17)
(2Ï€)3

2.3.2

= 4P11 k

i d3 q
(2Ï€)3
(21)

which shows that the normalisation of P 2 (k) depends on Î›
Î´ Î´
(Heavens et al. 1998). This is an example of a UV-sensitive
(22)
term. On the other hand, the k â†’ 0 limit of P 2 (k) does
Î´ Î´
not show any cutoff dependence.
2.3.3

Renormalisation and counterterms

Fur illustrative purposes only, let us now consider a simplified bias expansion such that
Î´h (x) = b0 + b1 Î´(x) + b2 Î´2 (x)

(25)

and evaluate the expectation value of Î´h at NLO in SPT.
It is straightforward to obtain that hÎ´h (x)i = b0 +
b2 Ïƒ12 (Î›). Since hÎ´h i is an observable which is identically
equal to zero, if we want to identify our truncated perturbative result with the actual measurement, it is necessary to set b0 + b2 Ïƒ12 (Î›) = bR
= 0. This leads to the modi0
fied bias expansion Î´h (x) = bR
+
b1 Î´(x) + b2 [Î´2 (x) âˆ’ Ïƒ12 (Î›)] =
0
2
2
b1 Î´(x) + b2 [Î´ (x) âˆ’ Ïƒ1 (Î›)].
Starting from this expression, we now derive the cross
spectrum between the tracer density field and the matter
density to 1-loop in SPT. The tree-level result is b1 P11 (k),
 (22)

(31)
while the 1-loop corrections give b2 P 2 (k)+P 2 (k) . EquaÎ´ Î´
Î´ Î´
tion (24) shows that the loop corrections contain a term
which coincides with the tree-level result rescaled by a
cutoff-dependent coefficient. Remarkably, the combination
[b1 + b2 (68/21) Ïƒ12 (Î›)] P11 (k) gives the dominant contribution when k â†’ 0. Inspired by Wilsonian renormalisation
of field theories where the UV divergences are cancelled by
a redefinition of the parameters of the theory, McDonald
(2006) proposes to replace b1 + b2 (68/21) Ïƒ12 (Î›) with the
new (â€˜renormalisedâ€™ or â€˜observableâ€™) linear bias coefficient
bR
. The resulting expression for the cross spectrum at one
1
loop will thus be
(22)
PÎ´h Î´ (k) = bR
1 P11 (k) + b2 P 2 (k) .
Î´ Î´

(26)

Here, bR
should be considered as a free parameter of the
1
model that can be adjusted to fit observational data. On
the other hand, the â€˜bareâ€™ linear bias coefficient b1 should
be merely considered as a mathematical tool to perform calculations and should not be assigned any physical meaning.
This technique can be iterated to renormalise higher-order
bias parameters (McDonald 2006; McDonald & Roy 2009).
The net effect of this procedure is that no UV-sensitive terms
appear in the theoretical expressions for the ensemble averaged statistics of the tracers.
MNRAS 000, 1â€“22 (2019)

Bias renormalisation
A different way to understand renormalisation is
through the introduction of counterterms in the bias expansion. For instance, let us re-consider the example above.
In order to eliminate the UV-sensitive term that appears
in the NLO expression for hÎ´h (x)i, we could add the constant counterterm âˆ†b0 to the r.h.s. of equation (25) and
get hÎ´h (x)i = b0 + âˆ†b0 + b2 Ïƒ12 (Î›). By requiring that the expectation value of the theory coincides with the observed
value (i.e. zero), we thus get âˆ†b0 = âˆ’b0 âˆ’ b2 Ïƒ12 (Î›). The new
bias expansion (including the counterterm) can thus be reorganised as follows:
h
i
Î´h (x) = b1 Î´(x) + b2 Î´2 (x) ,
(27)
0



where Î´2 (x) 0 â‰¡ Î´2 (x) âˆ’ Ïƒ12 (Î›) denotes a new operator compatible with the renormalisation of b0 .
Next, we could add the counterterm âˆ†b1 Î´(x) to the bias
expansion in order to cancel out the UV-sensitive term in the
NLO expression for the two-point statistic PÎ´h Î´ (k). In fact,
the new term generates the correction âˆ†PÎ´h Î´ (k) = âˆ†b1 P11 (k)
and by imposing that b1 + âˆ†b1 + b2 (68/21) Ïƒ12 (Î›) = bR
, we
1
finally obtain
h
i
2
Î´h (x) = bR
,
(28)
1 Î´(x) + b2 Î´ (x)
1



where Î´2 (x) 1 â‰¡ Î´2 (x)âˆ’ Ïƒ12 (Î›) [1+(68/21) Î´(x)] represents the
quadratic operator which is consistent with the renormalisation of both b0 and b1 .
The examples above illustrate how the linear bias coefficient b1 and the field Î´2 can be consistently renormalised
starting from the simplified model given in equation (25).
Considering a more general bias expansion that includes additional composite operators requires further calculations.
For instance, we might want to add a non-local bias term
proportional to s2 . In this case, all the perturbative calculations we made to compute spectra and cross-spectra for Î´2
can be easily generalised to s2 . By introducing the Fourierspace operator


k Â·k 2 1
S2 (k1, k2 ) = Î³i j (k1 ) Î³ ji (k2 ) = 1 2 âˆ’ ,
(29)
k1 k2
3
one finds that
(31)
P 2 (k)
s Î´

hs2 (x)i

= 4P11 k



âˆ«

=

(4/3) Ïƒ 2

and

 d3 q
F2 âˆ’ q, k S2 (q, k âˆ’ q) P11 q
, (30)
(2Ï€)3


O are contracted among themselves as in equations (23) and
(30).
2.4

(31)
(k)
s2 Î´

P
kâ†’0

P11 (k)

=

136 2
Ïƒ (Î›) .
63 1

(31)

Thus, s2 needs to be renormalised. Analogous considerations
apply to other composite operators.
A systematic procedure for renormalising the bias expansion order by order in PT has been presented by Assassi
et al. (2014, see also Senatore 2015). The renormalisation
conditions for the generic operator O appearing in the bias
expansion are
h[O](q) Î´1 (q1 ) . . . Î´1 (qm )i = hO(q) Î´1 (q1 ) . . . Î´1 (qm )i (LO) , (32)
where qi â†’ 0 âˆ€i. In a diagrammatic representation, this
means that the counterterms should be chosen so that to
cancel the loop corrections obtained from diagrams in which
different Fourier modes of Î´ that contribute to the operator
MNRAS 000, 1â€“22 (2019)

Cross-spectrum between matter and tracers

In this paper, we use a large suite of N-body simulations
to test how accurately the third-order bias expansion given
in equation (10) describes the spatial distribution of biased
tracers (namely, dark-matter haloes with different masses).
In order to focus on the deterministic terms, we only consider
the cross-spectrum between the matter-density field and the
tracers, PÎ´h Î´ (k). As a reference, we provide here the perturbative result for this quantity (to NLO) expressed in terms
of the renormalised linear bias parameter bR
(McDonald &
1
Roy 2009; Assassi et al. 2014; Saito et al. 2014; Senatore
2015; Desjacques et al. 2018b):
(LO)

(NLO)

2
PÎ´h Î´ (k) = (bR
1 + b âˆ‡2 Î´ k ) [PÎ´Î´ (k) + PÎ´Î´

(k)] + b2 P[Î´ 2 ]1 Î´ (k)

+ bs2 P[s2 ]1 Î´ (k) + bÎ“3 PÎ“3 Î´ (k) + Î¥2,1,m k 2 .

(33)

In the expression above, we have introduced the LO cross
spectra of the renormalised operators,
(22)
2 (k) ,
Î›â†’âˆ Î´ Î´

P[Î´ 2 ]1 Î´ (k) = lim P
P[s2 ]1 Î´ (k) = lim

h

Î›â†’âˆ

(34)

(22)
(k) +
s2 Î´

P

i
Bs2 Î´ (k) ,

(35)

where6
(22)
(k)
s2 Î´

P

âˆ«

=2

F2 (q, k âˆ’ q) S2 (q,k âˆ’ q) P11 (q)
Â· P11 (|k âˆ’ q|)

d3 q
,
(2Ï€)3

(36)

136 2
Ïƒ (Î›) P11 (k) .
(37)
63 1
On the contrary, the Î“3 operator does not require renormalisation (e.g. Assassi et al. 2014) and we have
(31)
(k) âˆ’
s2 Î´

Bs2 Î´ (k) = P

(31)

PÎ“3 Î´ (k) = BÎ“3 Î´ (k) = lim PÎ“ Î´ (k) ,
3
Î›â†’âˆ

(38)

with7
(31)

PÎ“ Î´ (k) = 4P11 (k)
3

which is UV-sensitive as (McDonald & Roy 2009)
lim

7

âˆ«
[F2 (âˆ’q, k) âˆ’ G2 (âˆ’q, k)]
#
"

d3 q
q Â· (k âˆ’ q) 2
. (39)
Â·
âˆ’ 1 P11 (q)
q |k âˆ’ q|
(2Ï€)3

A few notes are in order here. First, all terms proportional
to P11 (k) have been used to define the renormalised linear
bias parameter as a function of the bare bias coefficients:


68
2
136
2
bR
=
b
+
b
+
b
+
3b
+
b
(40)
2
2 Ïƒ1 (Î›) .
1
3
1
21 2
63 s
3 Î´s
This makes sure that PÎ´h Î´ (k) â†’ bR
P (k) in the limit
1 Î´Î´
k â†’ 0. Secondly, although the perturbative calculations give
(LO)
(NLO)
bR
P
(k) + b1 PÎ´Î´ (k), this expression has been replaced
1 Î´Î´
(LO)
(NLO)
with bR
[PÎ´Î´ (k) + PÎ´Î´ (k)] in equation (33), the difference
1

6
7

(31)

Equation (24) implies that B Î´ 2 Î´ (k) = 0 as P 2 (k) âˆ P11 (k).
Î´ Î´
The perturbative contributions to Î“3 vanish at second order.

8

Werner & Porciani
(NLO)

being proportional to Ïƒ12 PÎ´Î´ (k) and thus higher-order in
the perturbations. As we will show later, this substitution
is a source of error on mildly non-linear scales. Thirdly, the
third-order bias coefficients b3 and bÎ´s2 are renormalised
into bR
and do not appear in equation (33). Fourthly, it
1
turns out that the functions Bs2 Î´ (k) and BÎ“3 Î´ (k) are proportional to each other and therefore a single bias parameter
(a linear combination of bs2 and bÎ“3 ) could be used to scale
their total contribution (McDonald & Roy 2009). Finally, no
direct contributions from the stochastic bias coefficients O
appear in the r.h.s. of equation (33). This is because these
zero-mean stochastic fields are assumed to be independent
of Î´. If, however, matter-density perturbations are described
in terms of an effective deterministic field Î´eff plus stochastic contributions m (from the small-scale modes that are
not included in the theory), then the correlation between
(nlo)
the stochastic terms 1 and m should contribute to PÎ´ Î´ (k).
h
The corresponding cross spectrum is represented by the term
2
2
2
Î¥2,1,m k = (âˆ‚Î¥ m /âˆ‚k )k=0 k in equation (33). Theoretical
considerations suggest that this term should be highly suppressed with respect to the other NLO corrections (Senatore
2015; Angulo et al. 2015).

2.5

(31)
(k)
Î´2 Î´

Î´ Î´

W |k âˆ’ q|

 d3 q
.
(2Ï€)3

(41)

For simplicity, in this work, we use a spherical top-hat filter
in k space,
(
1 if k < Î› ,
W(k) =
(42)
0 otherwise .
The factor W(|k âˆ’ q|) in the integrand of equation (41) thus
limits the integration range to the region where
Î›2 > |k âˆ’ q| 2 = k 2 + q2 âˆ’ 2qk Âµ ,

(43)

with Âµ = (k Â· q)/(kq) the cosine of the angle between k and
q. This turns out to be a constraint on Âµ at fixed q,
k 2 + q 2 âˆ’ Î›2
= Âµmin ,
2qk

(44)

and implies that, for q > Î› âˆ’ k, the integration range in Âµ
will have a lower bound Âµmin > âˆ’1. The complete result for

= P11 (k)W(k)

P

+2



68 2
Ïƒ (Î› âˆ’ k)
21 1

âˆ« Î› âˆ« 1
Î›âˆ’k

Âµmin



F2 âˆ’ q, k dÂµ P11 q

 q2 dq
2Ï€ 2



,

(45)

where the integral over Âµ reduces to
âˆ« 1
Âµmin




51 k q
5 Î›2
17
âˆ’
+
+
F2 âˆ’ q, k dÂµ =
21 112 q k
28 kq


 3
 4
3
17 k
q
3
Î›4
Î›
+
+
+
+
336 q3 k 3
112 k 3 q kq3
 2

5 Î› k Î›2 q
1 Î›6
âˆ’
+ 3 +
.
(46)
3
56 q
84 k 3 q3
k

It follows that
(31)
P 2 (k)
Î´ Î´

Impact of filter functions

Equations (24) and (31) are obtained from equations (23)
and (30) by performing the integration over q in spherical
polar coordinates. The integration range extends over the
full solid angle around k but is limited to the region q < Î›
for the radial component. We show here that this calculation
does not exactly give what one would obtain by smoothing
the density field with a sharp cutoff in k space as, for instance, we will do later when analyzing N-body data.
As mentioned in section 2.2, the bias expansion applies
to fields that have been low-pass filtered. Let us consider
the smoothed field W(k) Î´(k) with W(k) a low-pass, spherically symmetric, window function. In this case, equation
(23) should be replaced with
âˆ«





(31)
P 2 (k) = 4P11 k W k
F2 âˆ’ q, k P11 q W q

Âµ>

0 < k < Î› is



68 2
Ïƒ (Î› âˆ’ k)
21 1
h
i
34 2
Ïƒ1 (Î›) âˆ’ Ïƒ12 (Î› âˆ’ k)
+
21


17 3
5
3 Î›4
1 Î›6
+
k âˆ’ Î›2 k +
+
Hâˆ’1 (k)
168
28
56 k
42 k 3


5 Î›2
3 Î›4
51
+
H1 (k)
+ âˆ’ k+
56
14 k
56 k 3


51 1
5 Î›2
+ âˆ’
âˆ’
H3 (k)
56 k 28 k 3

17 1
+
H
(k)
.
5
168 k 3
= P11 (k)W(k)

(47)

where
Hn (k) =

âˆ« Î›
Î›âˆ’k

q n P11 (q)

dq
2Ï€ 2

(48)

and Ïƒ12 (Î›) âˆ’ Ïƒ12 (Î› âˆ’ k) = H2 (k). By Taylor expanding the
Hn (k) functions to fourth order, we obtain the linear expansion of the expression in the curly parentheses in equation (47),
(31)
(k)
Î´2 Î´

P

68 2
1 Î›3 P11 (Î›)
Ïƒ1 (Î›) âˆ’
P11 (k)W(k) 21
3
2Ï€ 2
"
#
3 0
2
17 Î› P11 (Î›) 1 Î› P11 (Î›)
+ âˆ’
+
k
28
8
2Ï€ 2
2Ï€ 2
=

(49)

+ O(k 2 ) .
This result has some implications for the renormalisation of
(31)
the bias expansion. First, the resulting expression for P 2 (k)
Î´ Î´
is not proportional to P11 (k) at finite wavenumbers. Moreover, the limit for k â†’ 0 of equation (49) is not (68/21) Ïƒ12 (Î›)
(contrary to what claimed by Desjacques et al. 2018b, after
their equation 2.122) and a different cutoff-dependent coefficient should be used to renormalise b1 . Note, however,
that, for a Î›CDM cosmology, the k â†’ 0 limit reduces to
(24) for Î› â†’ +âˆ. We will return to these issues and present
a comparison with N-body simulations in section 4.3. Analogous calculations can also be performed for s2 and other
composite operators.
MNRAS 000, 1â€“22 (2019)

Bias renormalisation

PÎ´h Î´ (k) [h âˆ’3 Mpc 3 ]

10 5

as in Bryan & Norman (1998). We split the halo population into three mass bins based on the number of halo
particles. In the lowest-mass bin, M1 , haloes contain between 40 and 79 particles, corresponding to a mean mass
of M 1 = 6.15 Ã— 1013 hâˆ’1 M . The second bin includes haloes
with 80 to 159 particles (M 2 = 1.21 Ã— 1014 hâˆ’1 M ), while
more massive structures with â‰¥ 160 particles fall into the
highest-mass bin (M 3 = 3.17 Ã— 1014 hâˆ’1 M ).

10 4

PÎ´Mh Î´3 (k)
PÎ´Mh Î´2 (k)
PÎ´Mh Î´1 (k)
PÎ´Î´ (k)

10 3
5.0

3.2

10 -1

10 -2

PÎ´h Î´ (k)/PÎ´Î´ (k)

4.5
4.0

M3

3.5
3.0

M2
M1

2.5
2.0
1.5

10 -2

k [h Mpc ]
âˆ’1

10 -1

Figure 1. Top: Average matter power spectrum PÎ´ Î´ (k) and halomatter cross spectra PÎ´h Î´ (k) (for the mass bins M1, M2, M3 defined in section 3.1) measured from our 40 simulations. Shaded
regions represent the standard error of the mean. Bottom: Corresponding effective bias functions PÎ´h Î´ (k)/PÎ´ Î´ (k). The dashed
lines indicate a constant fit to the five leftmost data points.

3

NUMERICAL METHODS

In this section, we introduce our suite of N-body simulations
and describe the numerical techniques we use to build the
continuous density fields, as well as the auto and cross power
spectra that appear in equation (33).
3.1

9

N-body simulations

We use the SPH code gadget-2 (Springel 2005) to run 40
DM-only simulations. Their main characteristics are summarised in Table 2. We set up the initial conditions (IC) at
zIC = 50 with the music code (Hahn & Abel 2011) employing
the Planck 2015 (Planck Collaboration et al. 2016) cosmology, i.e. h = 0.677, Ïƒ8 = 0.816, ns = 0.967, â„¦m = 0.3089,
â„¦b = 0.0486 and â„¦Î› = 0.6911.
To identify gravitationally bound structures, we use the
rockstar halo finder (Behroozi et al. 2013). This algorithm
uses the phase-space distribution of the simulation particles to detect spherical haloes with a virial mass defined
MNRAS 000, 1â€“22 (2019)

Measuring smoothed fields and spectra

We employ a â€˜cloud-in-cellâ€™ (CIC) interpolation method to
build the gridded overdensity fields Î´ and Î´h starting from
the positions of the N-body particles and of the haloes, respectively. The fields are sampled on a regular Cartesian
mesh with 2563 cells that fully covers the simulation box.
After correcting for the mass-assignment scheme, we use the
fast-Fourier-transform (FFT) algorithm to obtain Î´(k) and
Î´h (k). In the top panel of Fig. 1, we show the matter power
spectrum PÎ´Î´ (k) and the halo-matter cross spectra PÎ´h Î´ (k)
averaged over our set of simulations for each halo mass bin.
The shaded regions indicate the standard error of the mean.
In the bottom panel, we show the ratio PÎ´h Î´ (k)/PÎ´Î´ (k) which
can be interpreted as an effective scale-dependent bias. This
function grows with k, and this effect becomes more prominent for more massive haloes. In order to emphasize this
trend, we fit a constant to the five leftmost data points and
plot the result with a dashed line. The discrepancy between
the solid and dashed line provides a strong motivation for
considering non-linear bias models.
Low-pass smoothing is applied in Fourier space by multiplying the FFT of the fields by the window function W(k)
given in equation (42). We use three different values for the
cutoff scale Î› ensuring that the variance of the Î´ field is
smaller than unity (see Table 3). We also apply spectral
methods to compute the Fourier transforms of si j and âˆ‡2 Î´
starting from Î´(k). In order to compute Î“3 , we first build
three momentum grids (one for each Cartesian component
of the momentum vector) by applying the CIC interpolation
to the particle velocities. To get the velocity grids from these
we divide the momentum components by the density. We
apply the FFT to these grids so that we can first compute
Î¸(k) = ik Â· v(k)/(aH f ) and then pi j (k). Finally, we transform
all the smoothed fields back to real space and compute the
quadratic fields Î´2 (x), s2 (x), p2 (x) and Î“3 (x).
A sample slice extracted from one of the simulation
boxes at z = 0 for all fields is shown in Fig. 2. From top
to bottom we plot the different fields, from left to right
we change the cutoff scale Î›. We standardised the fields
such that dark tones indicate large deviations from than the
mean. As expected, larger values of Î› give rise to more detailed structure in all panels. The most striking feature is
that Î´h and Î´ always look very similar. This is not surprising since Î´h âˆ Î´ at LO in the bias expansion. For larger Î›,
the similarity is less evident, reflecting the increased importance of higher-order and derivative terms. The Laplacian
of Î´ looks qualitatively similar to Î´ for small Î›, whereas,
for large Î›, short-wavelength Fourier modes are enhanced
with respect to the density field. The field Î´2 presents concentrated high positive peaks on top of a rather uniform
background, somewhat reminiscent of shot noise (see also
Heavens et al. 1998). Around those peaks the signal of s2

10

Werner & Porciani

0.05
Î´h

0.1

0.2

8
6
4
2

Î´

0

xâˆ’Âµ
Ïƒ

âˆ‡2 Î´

s2

Î´2
2

Î“3

4
6
8

Figure 2. The fields that are included in the bias expansion. We show a 2D slice extracted from one N-body simulation by fixing one
of the spatial coordinates. The grid of images shows different fields along the vertical direction (as indicated by the labels) and different
values of the cutoff scale Î› (in h Mpcâˆ’1 ) in the horizontal direction. All the fields have been standardised to zero mean and unit variance.
Note that the images only cover 80 per cent of the box in the vertical direction.

MNRAS 000, 1â€“22 (2019)

Bias renormalisation

11

Table 2. The set of parameters that characterise our suite of Nsim simulations: Lbox denotes the box length, Npart the number of particles,
Mpart the particle mass, Lsoft the softening length, and zIC the initial redshift.
Nsim
40

Lbox

Npart

Mpart

1200 h âˆ’1

5123

1.1037 Ã— 1012 h âˆ’1 M

Mpc

Table 3. The variance of the matter density field as a function of
the cutoff scale Î› at z = 0. We contrast the results obtained from
2 ).
linear SPT (Ïƒ12 ) with those measured in the simulations (Ïƒsim
Î› [h Mpcâˆ’1 ]

Ïƒ12

2
Ïƒsim

0.05
0.10
0.20

0.0377
0.1672
0.5430

0.0343
0.1513
0.5223

becomes strong in almost spherical shells which are particularly evident for large Î›. Finally, for Î› = 0.2 h Mpcâˆ’1 , Î“3
presents high peaks at the same locations as Î´2 and s2 while
this correspondence is less striking for smaller Î›. Not visible
in the figure is that the relative amplitudes of the different
fields change dramatically with the cutoff scale. Whereas,
for Î› = 0.05 h Mpcâˆ’1 , they are clearly ordered as expected
from SPT, for Î› = 0.2 h Mpcâˆ’1 , Î´, Î´2 , s2 and Î“3 are all of
order unity.
We employ standard methods to compute the auto and
cross power spectra between the fields using 10, 20 and 40
linearly-spaced bins in k for Î› = 0.05, 0.1, and 0.2 h Mpcâˆ’1 ,
respectively.

4

RENORMALISATION IN SIMULATIONS

In this section, we measure the UV-sensitivity of the composite operators and implement the renormalisation framework
directly in our simulations.
In the top panels of Fig. 3, we show the average over the
40 simulations of the cross spectra between different composite operators and Î´ for three values of Î›. We plot PÎ´ 2 Î´ (k)
on the left-hand side and Ps2 Î´ (k) on the right-hand side. As
expected, our results are UV-sensitive as the amplitude of
the spectra changes dramatically with Î›. Qualitatively, this
is consistent with the perturbative calculations presented in
section 2.3.2.
We want to build a procedure that removes the UVsensitive part from the cross spectra. In the perturbative
(31)
calculations, this term is [limqâ†’0 POÎ´ (q)/P11 (q)] P11 (k). For
(31)

instance, if O = Î´2 , then POÎ´ (q) is obtained from the correlator 2h(Î´2 Î´1 ) Î´1 i (parentheses here denote the fields contributing to Î´2 ). This is the LO term of hÎ´2 Î´1 i. In the simulations, we cannot isolate Î´2 from all the other non-linear
terms. However, if the perturbative ansatz holds true on
the largest scales, we can safely assume that hÎ´2 Î´1 i is dominated by the LO part when k â†’ 0. Therefore, it makes sense
to measure PÎ´ 2 Î´1 (k) from the simulations and compute the
MNRAS 000, 1â€“22 (2019)

Lsoft
0.078 h âˆ’1

Mpc

zIC

Cosmology

50

Planck 2015

â€˜renormalised cross spectrumâ€™
PÎ´ 2 Î´1 (kmin )
P (k)
P[Î´ 2 ]1 Î´ (k) = PÎ´ 2 Î´ (k) âˆ’
P11 (kmin ) 11
= PÎ´ 2 Î´ (k) âˆ’ Î±Î´ 2 (Î›) P11 (k) ,

(50)

where kmin denotes the bin containing the lowest wavenumbers that can be accessed in our simulation boxes and P11 (k)
is computed directly by re-scaling the IC of the simulations.
Similarly, for s2 , we have
Ps2 Î´1 (kmin )
P[s2 ]1 Î´ (k) = Ps2 Î´ (k) âˆ’
P (k)
P11 (kmin ) 11
= Ps2 Î´ (k) âˆ’ Î±s2 (Î›) P11 (k) .
4.1

(51)

Measuring the linear growth factor

In order to implement the renormalisation procedure
sketched above, we need the linear density field Î´1 evaluated at z = 0 in the N-body simulations. This is obtained by
multiplying the IC by the linear growth factor D. Although
D can be computed from the cosmological parameters by
performing a numerical integration (D = 40.015 at z = 0),
the result does not necessarily match the actual growth of
perturbations in the simulations which only provide an approximate solution. Previous studies have shown that different N-body codes might differ by up to 0.3 per cent in
the large-scale normalization of the matter power spectrum
at z = 0 which corresponds to a 5 per cent error on D (see
e.g. Fig. 1 in Schneider et al. 2016). Since the success of the
renormalisation procedure relies on the subtraction of two
signals with comparable amplitudes to get a much smaller
one, we need to make sure that we know the precise value
of the growth factor realized in the simulations. Therefore,
we proceed as follows. First, we measure an â€˜effectiveâ€™ scaledependent growth function directly from our simulations as
Deff (k) =

D Î´(k, z = 0) E
Î´1 (k, zIC ) k bin

(52)

where the average is taken over the same bins of k as
the spectra and we have explicitly written the redshift at
which the fields are evaluated. The result for k < 0.03 h
Mpcâˆ’1 is shown in the top panel of Fig. 4 where the shaded
region indicates the error of the mean over the simulations. Note that, as expected from theoretical considerations, Deff decreases with k on these scales. We are interested in the limit of this function for k â†’ 0. For this reason, we only consider the leftmost bin and analyze the signal at the level of single Fourier modes (see the bottom
panel of Fig. 4). In order to extract the limit, we fit a constant (Deff = 39.98 Â± 0.07, dotted) and a linear function of
k (Deff (k) = 40.09 Â± 0.31 âˆ’ (13 Â± 39) (k/1 h Mpcâˆ’1 ), dashed) to
the measurements. The slope of the linear fit is consistent
with zero within the errors. Furthermore, the two fits give

12

Werner & Porciani

10 3
Î› = 0. 2 h Mpc âˆ’1
Î› = 0. 1 h Mpc âˆ’1
Î› = 0. 05 h Mpc âˆ’1

10 2
10 -2

10 4

k [h Mpc âˆ’1 ]

10 3
10 2

10 1 -2
10
10 2
10 1
10 0
0
-10 0
-10 1
-10 2
-10 3
-10 4 -2
10

k [h Mpc âˆ’1 ]

k [h Mpc âˆ’1 ]

10 -1

10 -1

10 4
10 3
10 2
0
-10 2
-10 3

10 -1

Ps 2 Î´1 (k) [h âˆ’3 Mpc 3 ]

PÎ´ 2 Î´1 (k) [h âˆ’3 Mpc 3 ]

Ps 2 Î´ (k) [h âˆ’3 Mpc 3 ]

10 4

10 1

P[Î´ 2 ]1 Î´ (k) [h âˆ’3 Mpc 3 ]

10 5

P[s 2 ]1 Î´ (k) [h âˆ’3 Mpc 3 ]

PÎ´ 2 Î´ (k) [h âˆ’3 Mpc 3 ]

10 5

10 -2

10 4

k [h Mpc âˆ’1 ]

10 -1

10 3
10 2
0
-10 2 -2
10
10 1
10 0
0
-10 0
-10 1
-10 2
-10 3
-10 4

10 -2

k [h Mpc âˆ’1 ]

k [h Mpc âˆ’1 ]

10 -1

10 -1

Figure 3. Average cross spectra PÎ´ 2 Î´ (k) and Ps 2 Î´ (k), measured from our 40 simulations for different values of Î›. Shaded regions
represent the standard error of the mean. Top: The â€˜fullâ€™ spectra, obtained from cross-correlating the quadratic operators Î´ 2 and s 2 with
Î´. Middle: The UV-sensitive part of the spectra, obtained by correlating Î´ 2 and s 2 with Î´1 . Bottom: The renormalised spectra, obtained
by subtracting the UV-sensitive terms from the full spectra. A symmetric logarithmic scale on the y axis is used for quantities that
assume both positive and negative values. The vertical dashed lines indicate the locations of the different cutoff scales.

consistent limits for k â†’ 0 which are also compatible with
the expected value for D. For our calculations, we therefore
use D = 39.98.

4.2

Renormalising the spectra

We are now ready to compute PÎ´ 2 Î´1 (k) and Ps2 Î´1 (k) as well as
the renormalised spectra P[Î´ 2 ]1 Î´ (k) and P[s2 ]1 Î´ (k). A note is

in order here. The IC of our simulations are Gaussian and all
the three-point correlators of Î´1 should, in principle, vanish.
In practice, however, we measure very noisy non-zero values
for PÎ´ 2 Î´1 (k) and Ps2 Î´1 (k). In the perturbative framework,
1
1
these spectra coincide with the tree-level terms of PÎ´ 2 Î´ (k)
and Ps2 Î´ (k). Therefore, in order to improve the quality of our
results, we subtract the noisy terms from all the non-linear
cross spectra appearing on the r.h.s. of equations (50) and
MNRAS 000, 1â€“22 (2019)

Bias renormalisation
40.05

an average. The results are shown in the bottom panels of
Fig. 3. At large scales, spectra obtained with different values of Î› are now compatible within the errorbars while they
differ when k ' Î›. This means that the renormalisation procedure was successful.

40.00

Deff (k)

39.95
39.90
39.85

4.3

39.80
39.75
39.70
39.65
0.005

0.010

0.015

0.020

k [h Mpc âˆ’1 ]

40.15

0.025

0.030

40.10

Deff (k)

40.05
40.00
39.95
39.90
39.85

13

constant fit
linear fit
D

39.80
0.004 0.005 0.006 0.007 0.008 0.009 0.010 0.011 0.012

k [h Mpc âˆ’1 ]

Figure 4. The top panel shows the k-dependent growth factor
Deff (k), measured in our simulations by using equation (52). The
solid line and the shaded region indicate the average over the
40 realisations and its error, respectively. The hatched region is
magnified in the bottom panel where we fit a constant (solid) and
a linear function of k (dashed) to Deff (k) measured at the first four
multiples of the fundamental frequency 2Ï€/Lbox (data points with
error bars). The dotted line represents the linear growth factor
for the adopted cosmology, D = 40.015.

Table 4. The factors Î±Î´ 2 (Î›) and Î±s 2 (Î›) defined in equations (50)
and (51). The values indicate the average over the simulations and
the uncertainty is the standard error of the mean.
Î› [h Mpcâˆ’1 ]

Î±Î´ 2 (Î›)

Î±s 2 (Î›)

0.05
0.10
0.20

0.072 Â± 0.001
0.349 Â± 0.006
1.261 Â± 0.017

0.046 Â± 0.001
0.228 Â± 0.004
0.834 Â± 0.013

In the top-left panel of Fig. 5, we show a comparison be(31)
tween P 2 (k), calculated with SPT (equation (24), dashedÎ´ Î´
dotted), with SPT including filter functions (equation (41),
dashed), and PÎ´ 2 Î´1 (k) that we measure from the simulations
(solid). We repeat the analysis in the top right panel for
(31)
P 2 (k) and Ps2 Î´1 (k). Equations (24) and (31) show that in
s Î´
SPT the UV-sensitive terms can be written as a Î›-dependent
prefactor times P11 (k). Therefore, in order to conveniently
compare the numerical results to the SPT predictions, we
always plot the ratios of the cross spectra with P11 (k). The
measurements from the simulations (solid) decrease with k
and are in excellent agreement with the SPT results when
filter functions are taken into account (dashed). Note that
when k â†’ 0, the curves do not assume the values 68/21 Ïƒ 2
and 136/63 Ïƒ 2 (dotted), but stay below them (as described
by e.g. the first line of equation (49) for Î´2 ). The logarithmic
difference between the solid and dotted curves decreases for
larger values of Î›. This result confirms the discussion presented in section 2.5.
In the bottom panels of Fig. 5 we compare the renormalised spectra measured from the simulations (shown already in the bottom panels of Fig. 3 in logarithmic scale)
with the theoretical predictions including filter functions.
We find good agreement at all k for small values of Î›. For
Î› = 0.2 h Mpcâˆ’1 , however, the theoretical results differ more
markedly from the simulation measurements. This suggests
either that higher-order terms should be accounted for in
order to match the N-body results, or that the perturbative
expansion starts breaking down at these scales and redshifts.

5

MNRAS 000, 1â€“22 (2019)

MEASURING BIAS PARAMETERS

We now measure the bias parameters by fitting PÎ´h Î´ (k) with
different bias models, renormalised and not. First, we describe our Bayesian fitting routine that takes into account
the correlations between the different spectra extracted from
our simulations. Subsequently, we discuss how many bias parameters are needed to optimally describe our data by using
Bayesian model-comparison techniques. Finally, we present
the best-fitting parameters.

5.1
(51). Our final results for PÎ´ 2 Î´1 (k) and Ps2 Î´1 (k) are shown
in the middle panels of Fig. 3. As expected, they show a
similar behaviour as a function of both Î› and k with respect
to PÎ´ 2 Î´ (k) and Ps2 Î´ (k). However, when k approaches Î› their
signal is suppressed. The corresponding values of Î±Î´ 2 (Î›) and
Î±s2 (Î›) are presented in Table 4.
We finally compute the renormalised spectra P[Î´ 2 ]1 Î´ (k)
and P[s2 ]1 Î´ (k) from equations (50) and (51). We first obtain them for each simulation individually and then perform

Comparing spectra from simulations and SPT

Fitting method

In this section, we introduce the Bayesian method we use
to fit the bias parameters. Readers who are more interested
in the results than in the statistical techniques can directly
move to section 5.3.
Our goal is to fit a model for PÎ´h Î´ (k) to our simulation suite, that can schematically be written as PÎ´h Î´ (k) =
Ã
O bO POÎ´ (k). Contrary to previous work in the field, we do
not rely on perturbation theory, but we measure the spectra POÎ´ (k) together with PÎ´h Î´ (k) from the simulation boxes.

14

Werner & Porciani

10 1
10 0
10 -1
10 -2
10 -3

Î› = 0. 2 h Mpc
Î› = 0. 1 h Mpc âˆ’1
Î› = 0. 05 h Mpc âˆ’1
âˆ’1

0
1000
2000
3000
4000

10 -2

k [h Mpc âˆ’1 ]

10 -2
0

-10 -1

10 -1

10 -2

10 -1

-10 -2

P[s 2 ]1 Î´ (k) [h âˆ’3 Mpc 3 ]

P[Î´ 2 ]1 Î´ (k) [h âˆ’3 Mpc 3 ]

Ps 2 Î´1 (k)/P11 (k)

PÎ´ 2 Î´1 (k)/P11 (k)

10 0

10 -1

10 -2

10 -1

0
1000
2000
3000
4000

10 -1

10 -2

k [h Mpc âˆ’1 ]

Figure 5. The top panels show the UV-sensitive spectra PÎ´ 2 Î´ (k) (left) and Ps2 Î´ (k) (right) divided by the linear matter power spectrum.
1
1
Plotted are the average spectra measured from the simulations for different values of Î› (solid). Shaded regions represent the standard
(31)
(31)
error of the mean. For comparison, the dashed curves represent P 2 (k)/P11 (k) and P 2 (k)/P11 (k) computed from SPT accounting for the
Î´ Î´

s Î´

filter functions â€“ see equation (41) and the analogue for s 2 . Likewise, the horizontal dotted lines indicate the values 68/21 Ïƒ 2 and 136/63 Ïƒ 2
â€“ see equations (24) and (31). Differently, the vertical dashed lines mark the locations of the different cutoff scales. The bottom panels
show the renormalised spectra P[Î´ 2 ] Î´ (k) (left) and P[s 2 ] Î´ (k) (right) measured from the simulations (solid). Shaded regions represent the
1
1
standard error of the mean. Also plotted are the perturbative results evaluated by taking the filter functions into account (dashed).

This means that both the dependent and the independent
variables in our fit are affected by statistical errors. Since
these measurement errors are correlated (as they originate
from the same underlying density field), we need to account
for their covariance matrix C. In practice, we treat each realisation as a repeated measure of all the spectra and we
infer the best-fitting parameters by writing a global likelihood function for the bias parameters.
To simplify the notation, we write all the cross spectra for a given k bin as a multi-dimensional vector y and
their noisy estimates as yÌ‚ = y + Î·, where Î· denotes the measurement error. We assume that the estimator of all yi is
unbiased and that the errors are drawn from a multi-variate
Gaussian distribution with covariance matrix C as stated
above. It follows that the probability of measuring yÌ‚ is
"
#
1
1
T âˆ’1
exp âˆ’ (yÌ‚ âˆ’ y ) C (yÌ‚ âˆ’ y ) .
(53)
P(yÌ‚ ) =
âˆš
2
4Ï€ 2 det C
We now order the components of the vectors so that PÎ´h Î´ (k)

appears first. We can thus write y1 = Î²2 y2 + Î²3 y3 + Â· Â· Â· + Î²n yn
(where the coefficient Î²i represent the n âˆ’ 1 bias parameters
that characterize a model). The likelihood function for the
model parameters (Î², y ) given the data is then
"
#
1
A
L(Î², y ) âˆ P(yÌ‚ |Î², y ) =
exp
âˆ’
,
(54)
âˆš
2
4Ï€ 2 det C
with8
âˆ’1
âˆ’1
A = C11
( yÌ‚1 âˆ’ Î²i yi )2 + 2 C1j
( yÌ‚1 âˆ’ Î²i yi )( yÌ‚ j âˆ’ y j )

+ Ciâˆ’1
j ( yÌ‚i âˆ’ yi )( yÌ‚ j âˆ’ y j ) .

(55)

We then marginalize over the unknown true spectra y , i.e.
âˆ« âˆ
L(Î²) âˆ
L(Î², y ) dn y .
(56)
âˆ’âˆ
8

From now on Greek indices run from 1 to n and Roman indices
run from 2 to n. Moreover, Ciâˆ’1
j denotes the i j-element of the
inverse of C.
MNRAS 000, 1â€“22 (2019)

Bias renormalisation
This is easily achieved after rewriting the integrand in the
form of a n-dimensional Gaussian distribution. We first
rewrite A as
âˆ’1
A = yÌ‚Âµ CÂµÎ½
yÌ‚Î½ + yi Qi j y j âˆ’ 2Ï‰i yi ,

(57)

where
âˆ’1
âˆ’1
âˆ’1
Qi j = Ciâˆ’1
j + C11 Î²i Î² j + Î²i C1j + Î² j C1i
and

(58)

âˆ’1
âˆ’1
Ï‰i = CiÂµ
yÌ‚Âµ + Î²i C1Âµ
yÌ‚Âµ .
(59)
We then express the second term on the r.h.s. of equation (57) as a function of a generic vector d such that

yi Qi j y j = (yi âˆ’di )Qi j (y j âˆ’d j )+di Qi j y j + yi Qi j d j âˆ’di Qi j d j (60)
and impose that di Qi j y j +yi Qi j d j = 2Ï‰i xi . This gives di (Qi j +
Q ji )y j = 2di Qi j y j = 2Ï‰i yi , implying that di Qi j = Ï‰ j . We
finally obtain
di = Ï‰ j Qâˆ’1
ji ,

(61)

which, inserted into equation (57), gives
âˆ’1
A = yÌ‚Âµ CÂµÎ½
yÌ‚Î½ + (yi âˆ’ di )Qi j (y j âˆ’ d j ) âˆ’ di Qi j d j .

(62)

We now perform the integration in equation (56) and arrive
at the final expression for one k bin:
#
"

1
âˆ’1
âˆ’1/2
L(Î²) âˆ [2Ï€ det (CQ)]
exp âˆ’ yÌ‚Âµ CÂµÎ½ yÌ‚Î½ âˆ’ di Qi j d j . (63)
2
To combine all k bins, we consider the total likelihood L
defined as
L (Î²) =

N
Ã–

15

data, this concept differs from the â€˜goodness of fitâ€™ which
quantifies how well a model describes the data that have
been used to optimize the model parameters. The WAIC is
a Bayesian method that generalizes the Akaike Information
Criterion (AIC, Akaike 1973) by averaging over the posterior distribution of the model parameters. It can be shown
that it is asymptotically equivalent to Bayesian cross validation (Watanabe 2010). Moreover, the WAIC can be seen
as an improvement upon the Deviance Information Criterion (DIC, Spiegelhalter et al. 2002) as it is invariant under
re-parametrization of the model and also works for singular
models (where the Fisher information matrix is not invertible). To apply the WAIC, one first estimates the log pointwise predictive density of the model (lppd, Gelman et al.
2014)
Ã•
lppd =
lnhP(wi |Î¸)ipost
(65)
i

where the sum runs over the data points wi , and P(wi |Î¸)
denotes the probability to measure wi under the statistical
model and for a given set of model parameters Î¸. The expectation h. . . ipost is estimated using draws for the model
parameters from the posterior distribution given by the
MCMC chains. The better the model fits the data, the larger
the lppd is. In order to avoid overfitting, the lppd should
be penalized for the effective number of model parameters,
pWAIC . Two different estimators can be used to measure this
quantity from the MCMC chains, namely
Ã•
pWAIC,1 = 2 [loghP(wi |Î¸)ipost âˆ’ hlog P(wi |Î¸)ipost ] ,
(66)
i

and
L j (Î²)

(64)

j=1

pWAIC,2 =

Ã•

h[log P(wi |Î¸) âˆ’ hlog P(wi |Î¸)ipost ]2 ipost .

(67)

i

where N denotes the number of k bins. In practice, we replace the unknown covariance matrix C with an unbiased
estimate derived from the 40 simulations.
We sample the posterior distribution of the bias parameters by using our own Markov Chain Monte Carlo (MCMC)
code and assuming flat priors.
5.2

How many bias parameters are needed?

A generic bias expansion includes all the possible operators allowed by symmetries. Here, we perform a Bayesian
model comparison to investigate how many bias parameters are actually needed to fit PÎ´h Î´ (k) extracted from our
simulations for k < 0.2 h Mpcâˆ’1 . We focus on the M3 sample that shows the most prominent scale-dependent bias in
Fig. 1. We start with fitting the simple linear-bias model
PÎ´h Î´ (k) = b1 PÎ´Î´ (k). Then, we add several combinations of
the terms b2 PÎ´ 2 Î´ (k), bs2 Ps2 Î´ (k) and b âˆ‡2 Î´ Pâˆ‡2 Î´Î´ (k) as summarized in Table 5. Finally, motivated by the perturbative
results presented in section 2.4, we also consider the terms
bÎ“3 PÎ“3 Î´ (k) and Î¥2,1,m k 2 , as well as a combination of the
two (see Table 6).
We quantify the relative performance of each model by
using the Widely Applicable Information Criterion (Watanabe 2010), also known as the Watanabe-Akaike Information
Criterion (WAIC). This method evaluates the â€˜predictive accuracyâ€™ of a model, i.e. how useful the model will be in predicting new or future measurements. For finite and noisy
MNRAS 000, 1â€“22 (2019)

Essentially, each model parameter counts as one if all the
information about it comes from the likelihood function, as
zero if all the information comes from the prior, or as an
intermediate number whenever both the data and the prior
are informative. For our fits, we do not notice any practical difference between using equation (66) or equation (67).
Following Gelman et al. (2014), we finally define the WAIC
by using a deviance scale (i.e. by multiplying the lppd by a
factor of 2 so that the final result is more easily comparable
with the AIC and the DIC):
WAIC = âˆ’2(lppd âˆ’ pWAIC,i )

(68)

The lower the WAIC is, the better the model performs. It
is generally understood that a difference âˆ†WAIC of 5 (10)
provides â€˜suggestiveâ€™ (â€˜substantialâ€™) evidence in favour of the
preferred model.
5.3

Bare bias expansion

When we do not apply any renormalisation (hereafter NR,
short for â€˜no renormalisationâ€™), the lowest WAIC is obtained
for model M4 ,
PÎ´h Î´ (k) = b1 PÎ´Î´ (k) + b âˆ‡2 Î´ Pâˆ‡2 Î´Î´ (k)
+ b2 PÎ´ 2 Î´ (k) + bs2 Ps2 Î´ (k) ,

(69)

for all values of Î›. In Table 5, we report the difference
âˆ†WAIC between each model we have considered and the

16

Werner & Porciani

Table 5. The difference âˆ†WAIC between a model and the preferred one (highlighted with a dash) obtained by fitting PÎ´h Î´ for mass bin
M3 . Columns two to five indicate which operators are included in each model. Columns six to eight (as well as nine to eleven) refer to
different values of Î› expressed in units of h Mpcâˆ’1 .
Model

Î´

Î´2

s2

âˆ‡2 Î´

âˆ†WAIC (NR & RNL)
Î› = 0.05

M1

x

M2a

x

M2b

x

M2c

x

M3a

x

x

M3b

x

x

M3c

x

M4

x

0.1

0.2

0.05

0.1

0.2

62.56

1672.15

69339.13

34.99

1683.11

69847.85

83.16

492.70

4302.72

4.53

689.03

5188.85

40.13

449.46

9308.73

32.54

820.53

7367.62

23.79

81.89

846.68

1.03

â€“

576.55

12.94

436.73

1797.75

7.24

450.06

4406.97

x

10.42

40.97

828.06

â€“

1.63

575.36

x

x

25.14

82.82

328.83

2.33

1.91

161.92

x

x

â€“

â€“

â€“

1.59

3.86

â€“

x
x
x

x

x

Table 6. As in Table 5, but considering models that include
more operators (see columns two and three) with respect to M4 .
Results are displayed for Î› = 0.2 h Mpcâˆ’1 , only.
Model

Î“3

M5a

x

M5b
M6

x

k2

âˆ†WAIC (RL)

âˆ†WAIC (NR & RNL)

âˆ†WAIC (RL)

1.72

1.02

x

2.35

1.88

x

1.66

1.41

5.4

Renormalised bias expansion

For every model expressed in terms of the bare bias parameters, we can renormalise the cross-spectra of the composite
operators with Î´ as in the examples provided by equations
(50) and (51). The subtracted terms proportional to P11 (k)
will then contribute to the renormalised linear bias parameter. Let us consider, for example, equation (69) and re-write
it in terms of the renormalised cross spectra
PÎ´h Î´ (k) = b1 PÎ´Î´ (k) + (Î±Î´ 2 b2 + Î±s2 bs2 ) P11 (k) + b âˆ‡2 Î´ Pâˆ‡2 Î´Î´ (k)
+ b2 P[Î´ 2 ]1 Î´ (k) + bs2 P[s2 ]1 Î´ (k) ,

preferred one. Our results clearly rule out models with less
than four bias parameters. On the other hand, considering
additional terms proportional to Î“3 and k 2 and their combination gives a WAIC which is slightly worse than for M4 ,
as we present in Table 6 for Î› = 0.2 h Mpcâˆ’1 (since higherorder corrections should be most important for this cutoff).
This shows that there is no need to include bÎ“3 and bk 2 in
the bias expansion as, for k < 0.2 h Mpcâˆ’1 , our measurement
of PÎ´h Î´ (k) within âˆ¼ 70 hâˆ’3 Gpc3 cannot constrain them. We
thus conclude that, to describe the z = 0 cross spectral density of massive DM haloes and matter on these scales, we
need to account for the linear bias b1 , the non-linear bias b2 ,
the tidal bias bs2 and the first higher-derivative bias b âˆ‡2 Î´ .
In the top panel of Fig. 6, we plot the best-fitting model
M4 (solid curve) and the corresponding residuals are shown
in the narrow panel below (fourth from the top). The fit
never deviates from the measurements in a statistically significant way and sub-percent accuracy is achieved for most
values of k. In order to visually illustrate the need for and
the concept of renormalisation, in the top panel, we also plot
the individual contributions of the different terms appearing
on the r.h.s. of equation (69). Note that PÎ´Î´ (k), PÎ´ 2 Î´ (k) and
Ps2 Î´ (k) are proportional to each other when k â†’ 0. Moreover, the terms that scale with b2 and bs2 are never negligible
compared with b1 PÎ´Î´ (k), even at the largest scales we can
probe.

(70)

with Î±Î´ 2 and Î±s2 the numerical coefficients appearing in
equations (50) and (51). The result of this decomposition
for the best-fitting model M4 is illustrated in the second
panel from the top of Fig. 6 (labelled IE, short for â€˜intermediate expansionâ€™). The renormalised cross spectra of the
composite operators are now subdominant (and have a different shape) for k â†’ 0 with respect to the linear bias terms.
Their relative contributions to PÎ´h Î´ (k) grow with k (although
their sum nearly vanishes in this particular case).
In perturbative calculations, the spectrum P11 (k) appearing in equation (70) is promoted to PÎ´Î´ (k) to write
PÎ´h Î´ (k) = bR
1 PÎ´Î´ (k) + b âˆ‡2 Î´ P âˆ‡2 Î´Î´ (k)
+ b2 P[Î´ 2 ]1 Î´ (k) + bs2 P[s2 ]1 Î´ (k) ,

(71)

which is the analog of equation (33) with
bR
1 = b1 + Î±Î´ 2 b2 + Î±s 2 bs 2 .

(72)

In the simulations, however, this expression does not coincide any longer with equation (71) as P11 (k) , PÎ´Î´ (k) for
k > 0 (see Fig. 7). The only option to renormalise the linear
bias coefficient without altering equation (69) is to generalize equation (50) to the non-linear regime by using
(NL)
(k)
[Î´ 2 ]1 Î´

P

= PÎ´ 2 Î´ (k) âˆ’ Î±Î´ 2 (Î›) PÎ´Î´ (k) ,

(73)

together with analogous relations for the other composite
operators. We can thus re-write equation (69) as
PÎ´h Î´ (k) = bR
1 PÎ´Î´ (k) + b âˆ‡2 Î´ P âˆ‡2 Î´Î´ (k)
(NL)
(NL)
(k) + bs2 P 2 (k)
[Î´ 2 ]1 Î´
[s ]1 Î´

+ b2 P

(74)

MNRAS 000, 1â€“22 (2019)

Bias renormalisation

NR

10 2

fit

PÎ´h Î´ (k) [h âˆ’3 Mpc 3 ]

10 5

b1 PÎ´Î´
(Î±Î´ 2 b2 + Î±s 2 bs 2 )P11
b2 P[Î´ 2 ]1 Î´
bs 2 P[s 2 ]1 Î´
bâˆ‡2 Î´ Pâˆ‡2 Î´Î´

10 4
10 3

IE

10 2
10 -1

PÎ´h Î´ (k) [h âˆ’3 Mpc 3 ]

-2
10 5 10

RNL

10 2
10 -1

k [h Mpc âˆ’1 ]

10 -1

10 3

RL

10 2
2 10 -2
1
0
1
2
3
10 -2

fit
b1R PÎ´Î´
b2 P[Î´ 2 ]1 Î´
bs 2 P[s 2 ]1 Î´
bâˆ‡2 Î´ Pâˆ‡2 Î´Î´

10 4

fit âˆ’ PÎ´h Î´ (k)
âˆ†PÎ´h Î´ (k)

PÎ´h Î´ (k) [h âˆ’3 Mpc 3 ]

fit âˆ’ PÎ´h Î´ (k)
âˆ†PÎ´h Î´ (k)

2 10 -2
1
0
1
2
3
-2
10 5 10

fit
b1R PÎ´Î´
b2 P[(NL)
Î´ 2 ]1 Î´
bs 2 P[(NL)
s 2 ]1 Î´
bâˆ‡2 Î´ Pâˆ‡2 Î´Î´

10 4
10 3

1.10

PÎ´Î´ (k)/P11 (k)

PÎ´h Î´ (k) [h âˆ’3 Mpc 3 ]

b1 PÎ´Î´
b 2 PÎ´ 2 Î´
b s 2 Ps 2 Î´
bâˆ‡2 Î´ Pâˆ‡2 Î´Î´

10 4
10 3

1.15

fit

10 5

10 -1

k [h Mpc âˆ’1 ]

10 -1

Figure 6. The best fit of the bias model M4 to PÎ´h Î´ (k) (solid) and
its different components (as indicated in the legend) for the halo
mass bin M3 and Î› = 0.2 h Mpcâˆ’1 . The contribution proportional
to b 2s in the top panel changes sign at k ' 0.15 h Mpcâˆ’1 and we
plot its absolute value but use a dashed line to highlight where it
is negative. Similarly, all the contributions proportional to b2 in
the bottom three panels are negative. To improve readability, we
neglect the uncertainty in the bias parameters (only using their
posterior mean). In the top three panels, we show the results
obtained for the NR, IE and RNL cases which give rise to the
same fit. The fit residuals normalised to the statistical error of
the data âˆ†PÎ´h Î´ (k) are displayed in the fourth panel. Results for
the RL case are displayed in the bottom two panels.

17

1.05
1.00
0.95
0.90

10 -2

k [h Mpc ]
âˆ’1

10 -1

Figure 7. Non-linear corrections to the matter power spectrum at
z = 0. The line shows the average ratio taken over the simulations.
Shaded regions indicate the standard error of the mean.

which we refer to as the RNL, short for â€˜non-linear renormalisationâ€™. In the third panel from the top of Fig. 6, we show
the best-fitting model M4 and its different components. Obviously, fitting the RNL expression to the numerical data is
completely equivalent to fitting the NR one and gives exactly
the same constraints on the non-linear and higher-derivative
bias parameters. In fact, all the spectra that are used in the
fits are the same, it is only their labelling that changes. In
the NR case, the terms Î±Î´ 2 PÎ´Î´ and Î±s2 PÎ´Î´ are considered
as parts of PÎ´ 2 Î´ (k) and Ps2 Î´ (k), respectively, whereas they
are interpreted as part of the renormalised linear bias term
in the RNL case. Therefore, the conclusions regarding the
optimal number of bias parameters that we have drawn for
the bare bias expansion still apply to the RNL case.
On the other hand, in hands-on situations, it is common practice to fit one-loop perturbative models to survey
or simulation data (e.g. Saito et al. 2014). In our study,
taking model M4 as an example, this corresponds to using equation (71) together with (50) and (51). In this case
(hereafter dubbed RL, short for â€˜linear renormalisationâ€™),
the best-fitting parameters and the goodness of fit do not
coincide with those obtained for NR and RNL models. We
thus repeat our model-selection test focusing on RL models.
We find that the preferred operator sets vary with the cutoff scale (see the rightmost three columns in Table 5). For
Î› = 0.05 and 0.1 h Mpcâˆ’1 , all models that contain a term
in âˆ‡2 Î´ are favoured. For Î› = 0.2 h Mpcâˆ’1 , instead, M4 is
singled out by the WAIC (the bottom two panels of Fig. 6
display the individual components of M4 and the fit residuals). Further adding the Î“3 and/or k 2 operators leads to
slightly larger WAIC indicating mild overfitting. These results suggest that, as expected in an effective theory, more
bias parameters are needed if smaller scales are considered.
In particular, while Î´ and âˆ‡2 Î´ form the minimal set of operators required for Î› < 0.1 h Mpcâˆ’1 , adding [Î´2 ]1 and [s2 ]1
is necessary to describe the data with Î› = 0.2 h Mpcâˆ’1 .
5.5

Bias parameters

The best-fitting values of the bias parameters obtained for
the NR and the RNL cases are displayed in Table 7 for all
MNRAS 000, 1â€“22 (2019)

18

Werner & Porciani

Table 7. The bias parameters obtained by fitting equations (69) and (74) to PÎ´h Î´ (k) from our 40 simulations.
Mass
bin

Î›
[h Mpcâˆ’1 ]

b1
(NR)

b1R
(RNL)

b2

bs2

bâˆ‡2 Î´
[h 2 Mpcâˆ’2 ]

M1

0.05
0.1
0.2

1.91 Â± 0.02
1.91 Â± 0.02
2.04 Â± 0.04

1.89 Â± 0.01
1.89 Â± 0.01
1.895 Â± 0.003

âˆ’0.09 Â± 0.26
âˆ’0.003 Â± 0.10
âˆ’0.05 Â± 0.03

âˆ’0.14 Â± 0.46
âˆ’0.08 Â± 0.08
âˆ’0.09 Â± 0.01

5.53 Â± 7.34
7.12 Â± 1.26
2.45 Â± 0.36

M2

0.05
0.1
0.2

2.38 Â± 0.02
2.30 Â± 0.04
2.35 Â± 0.05

2.39 Â± 0.02
2.38 Â± 0.01
2.378 Â± 0.004

0.14 Â± 0.39
0.38 Â± 0.15
0.12 Â± 0.05

0.06 Â± 0.67
âˆ’0.25 Â± 0.12
âˆ’0.15 Â± 0.01

17.87 Â± 10.28
18.34 Â± 1.82
10.71 Â± 0.55

M3

0.05
0.1
0.2

3.26 Â± 0.03
2.94 Â± 0.05
2.35 Â± 0.07

3.35 Â± 0.02
3.36 Â± 0.01
3.35 Â± 0.01

2.92 Â± 0.55
1.87 Â± 0.20
1.07 Â± 0.06

âˆ’2.79 Â± 0.95
âˆ’1.00 Â± 0.15
âˆ’0.42 Â± 0.01

57.75 Â± 15.00
54.50 Â± 2.39
40.33 Â± 0.67

Table 8. As in Table 7 but using equation (71).
Mass
bin

Î›
[h Mpcâˆ’1 ]

b1R

b2

bs2

bâˆ‡2 Î´
[h 2 Mpcâˆ’2 ]

M1

0.05
0.1
0.2

1.90 Â± 0.01
1.90 Â± 0.01
1.898 Â± 0.002

âˆ’0.10 Â± 0.27
âˆ’0.10 Â± 0.08
0.05 Â± 0.01

0.01 Â± 0.05
0.02 Â± 0.08
âˆ’0.10 Â± 0.01

7.81 Â± 6.09
7.34 Â± 0.96
3.84 Â± 0.13

M2

0.05
0.1
0.2

2.38 Â± 0.01
2.38 Â± 0.01
2.379 Â± 0.004

âˆ’0.14 Â± 0.40
0.18 Â± 0.12
0.12 Â± 0.01

âˆ’0.05 Â± 0.07
âˆ’0.14 Â± 0.13
âˆ’0.15 Â± 0.01

12.03 Â± 8.58
17.33 Â± 1.39
10.56 Â± 0.17

M3

0.05
0.1
0.2

3.35 Â± 0.02
3.36 Â± 0.01
3.35 Â± 0.01

âˆ’0.87 Â± 0.62
âˆ’0.05 Â± 0.17
0.23 Â± 0.02

âˆ’0.07 Â± 0.11
âˆ’0.07 Â± 0.17
âˆ’0.36 Â± 0.02

42.85 Â± 13.53
41.46 Â± 1.96
30.97 Â± 0.23

mass bins and cutoff scales. We show both the bare linear
bias parameter (b1 ) and the renormalised one (bR
). Simi1
larly, in Table 8, we report the best-fitting parameters for
the RL fits. Notice that, while b1 is Î›-dependent, bR
as1
sumes consistent values for all cutoffs in both the RNL and
RL cases. We can thus conclude that the non-perturbative
renormalisation procedures we have implemented in the simulations were completely successful. Nevertheless, it is worth
pointing out that the best-fitting values of b2 , bs2 and b âˆ‡2 Î´ in
Tables 7 and 8 differ for all mass bins when Î› â‰¥ 0.1 h Mpcâˆ’1 .
In fact, the difference between P11 (k) and PÎ´Î´ (k) becomes
substantial at small scales where also the signal generated
by the non-linear and derivative bias terms is important.
Therefore, the RL fit compensates for the improper renormalisation of the linear-bias term by spuriously altering b2 ,
bs2 and b âˆ‡2 Î´ . These results demonstrate the limitations of
applying perturbative renormalisation at finite values of k.
As already discussed in section 5.4, in order to retain the
measurements of b2 , bs2 and b âˆ‡2 Î´ from the NR fit in the
renormalised case, equation (73) (and its analogue for the
other operators) must be used instead of (50).

5.6

Comparison with previous work

We compare the halo bias parameters we obtained from our
simulations with previous results in the literature. In Fig. 8,
we contrast our results for b1 and bR
(symbols) with the fit
1
by Tinker et al. (2010) â€“ their equation (6) â€“ evaluated for a
mean halo overdensity of âˆ† = 333 (solid line). The fit quan-

tifies the relative amplitude of the halo and matter power
spectra on large scales as measured from a set of N-body
simulations with slightly different cosmological parameters.
To ease the comparison, we express the mass dependence
in terms of the â€˜peak heightâ€™ Î½ = Î´c /ÏƒM . Here, ÏƒM denotes
the linear rms density fluctuation smoothed over the Lagrangian patch of each halo using a spherical top-hat filter
and Î´c = 1.686 is the critical linear overdensity in the spherical collapse model (for an Einstein-de Sitter universe). The
horizontal location of the symbols is obtained by computing
Î½ for every halo and averaging over each mass bin. In the
NR case (left), our best-fitting values run with Î› and differ
from the fit by Tinker et al. (2010) by up to 30 per cent. After renormalisation (right), the Î›-independent data points
obtained in the RNL and RL cases are in excellent agreement with each other and also match the results by Tinker
et al. (2010) to better than 2 per cent which is a factor of
three smaller than the intrinsic scatter about the mean relation between linear bias and halo mass found in Tinker
et al. (2010). This shows that by renormalising the spectra
we automatically obtain a consistent and robust value of bR
1
for all the mass bins.
In Fig. 9, we compare our measurements of b2 and bs2
with other results in the literature. For the quadratic bias
(top panels), we consider three different fitting functions
for the relation b2 (b1 ) extracted from N-body simulations.
The first was obtained by applying the peak-background
split to measurement of the halo mass function (Hoffmann
et al. 2015). The second was determined with the â€˜separateMNRAS 000, 1â€“22 (2019)

Bias renormalisation
4.0
3.5

4.0

NR

3.5

RNL & RL

b1R

3.0

2.5

2.5

2.0

Tinker+10

2.0

1.5

Î› = 0. 2 h Mpc âˆ’1
Î› = 0. 1 h Mpc âˆ’1
Î› = 0. 05 h Mpc âˆ’1

1.5

b1R /b1T10 âˆ’ 1

b1 /b1T10 âˆ’ 1

b1

3.0

0.1
0.0
0.1
0.2
0.3

19

1.6

1.8

2.0

Î½

2.2

2.4

2.6

0.1
0.0
0.1
0.2
0.3

RL
RNL

1.6

1.8

2.0

Î½

2.2

2.4

2.6

Figure 8. The best-fitting linear bias parameter as a function of the peak height, Î½, for different cutoff scales, Î›. The left-hand side
panel refers to the NR case in which b1 runs with Î›. On the contrary, the right-hand side panel shows the results obtained by fitting b1R .
Although solid and open symbols characterize the RNL and RL cases, respectively, all symbols referring to the same mass bin overlap
and cannot be distinguished. As a reference, we also show the fitting function by Tinker et al. (2010) (solid) and its relative deviation
from our results (bottom panels). The shaded area represents the intrinsic scatter about the mean relation found by Tinker et al. (2010).

universeâ€™ technique in which one studies the response to
infinite-wavelength perturbations (Lazeyras et al. 2016). The
third, instead, was derived from measurements of the halo
reduced three-point correlation function (Hoffmann et al.
2017). Note that these methods measure the renormalised
b2 while we only renormalise b1 . Therefore, we do not expect that our Î›-dependent best-fitting values for b2 should
perfectly coincide with the other results in the literature.
Nevertheless, in the NR case (left panel) and for large-scale
cutoffs (i.e Î› = 0.05 and 0.1 h Mpcâˆ’1 ), our measurements approximately run along the fitting functions for the relation
b2 (b1 ). After renormalising b1 (right panel), however, our b2
measurements for the two highest mass bins tend to lie below the previously published results. Moreover, as already
mentioned, we obtain different b2 values in the RNL and
RL cases. The RNL results with small Î› are in much better
agreement with the fitting functions in the literature. This
suggests that it should be possible to further improve the
agreement by extending the RNL technique to renormalise
b2 . We will explore this possibility in our future work. For
the tidal bias (bottom panels), we also compare our bestfitting values to three different literature results. We consider the theoretical prediction for a local Lagrangian biasing scheme (Catelan et al. 2000), bs2 (b1 ) = âˆ’(2/7) (b1 âˆ’ 1)
(Baldauf et al. 2012; Chan et al. 2012) together with two fitting functions that account for a non-vanishing Lagrangian
tidal-tensor bias in N-body simulations (Modi et al. 2017;
Abidi & Baldauf 2018, their equations 22 and 5.1 plus 2.32,
respectively). In agreement with these fitting functions, our
MNRAS 000, 1â€“22 (2019)

measurements provide evidence for large negative tidal biases at high halo masses. After renormalising b1 , this conclusion holds only in the RNL case while bs2 always assumes
values close to zero in the RL case.
In Fig. 10, we plot our results for b âˆ‡2 Î´ as a function
of Î½. The NR and RNL fits are shown together in the lefthand side panel since b âˆ‡2 Î´ assumes the same value in these
cases. On the contrary, the RL results are plotted in the
right-hand side panel. As a benchmark, we also show the
fitting function obtained with the â€˜amplified-modeâ€™ simulation technique by Lazeyras & Schmidt (2019, their equation
5.4 but note that we adopt the opposite sign convention
for b âˆ‡2 Î´ ) as well as the predictions for density peaks (Desjacques 2008) computed using the filter function given in
Chan et al. (2017). In agreement with Elia et al. (2012), our
measurements for the haloes scale with Î½ in a similar way as
the theoretical peak model but assume lower values in the
Î½-range we can probe. Compared with the fit by Lazeyras
& Schmidt (2019), we find comparable results in bins M1
and M2 and substantially higher values for M3 . Overall our
NR and RNL measurements display a steeper Î½-dependence
than expected based on their results.

6

SUMMARY

We have investigated a number of issues related to the clustering of biased tracers of the LSS. In particular, we have
focused on the renormalisation of the linear bias parameter.

20

Werner & Porciani

Hoffmann+15
Lazeyras+16
Hoffmann+17

3

NR

3

Î› = 0. 2 h Mpc âˆ’1
Î› = 0. 1 h Mpc âˆ’1
Î› = 0. 05 h Mpc âˆ’1

b2
1

1

0

0

0.5

0.5

0.0

0.0

0.5

0.5

1.0

1.0

bs 2

bs 2

RNL & RL

2

b2

2

RL
RNL

1.5
2.0

1.5
2.0

local Lagrangian bias
Modi+17
Abidi+18

2.5
3.0

2.0

2.5

2.5
3.0
3.0

b1

3.5

2.0

2.5

3.0

b1R

3.5

Figure 9. Symbols with errorbars indicate the best-fitting non-linear bias parameters b2 (top) and b s 2 (bottom) as a function of b1
for different cutoff scales. The panels on the left-hand side show the bare bias parameters (NR) while the results on the right-hand side
are obtained after renormalising b1 (here, empty and filled symbols correspond the RNL and RL cases, respectively). As a reference, we
overplot several theoretical models and fitting functions for the renormalised parameters (see the main text for details).

Desjacques+08
Lazeyras+19

70

Î› = 0. 2 h Mpc
Î› = 0. 1 h Mpc âˆ’1
Î› = 0. 05 h Mpc âˆ’1

bâˆ‡2 Î´ [h 2 Mpc âˆ’2 ]

50

60
50

bâˆ‡2 Î´ [h 2 Mpc âˆ’2 ]

60

40

70

âˆ’1

NR & RNL

40

30

RL

30

20

20

10

10

0

0
1.6

1.8

2.0

Î½

2.2

2.4

2.6

1.6

1.8

2.0

Î½

2.2

2.4

2.6

Figure 10. The best-fitting first higher-derivative bias parameter, bâˆ‡2 Î´ , as a function of the peak height, Î½, for different cutoff scales. As
a reference, we show the the fit to numerical simulations by Lazeyras & Schmidt (2019, dashed) and the predictions from peak statistics
presented in Desjacques (2008, solid).

MNRAS 000, 1â€“22 (2019)

Bias renormalisation
After reviewing the literature on the subject, we have applied a bias expansion to N-body simulations and studied the
UV-sensitivity of the composite operators that contribute to
the halo-matter cross spectrum PÎ´h Î´ (k). We have then successfully mastered the challenge to renormalize these terms
without resorting to perturbation theory. Finally, we have
identified how many bias parameters are needed to accurately describe halo clustering for k < 0.2 h Mpcâˆ’1 without
overfitting. Our main results can be summarized as follows.
(i) We have run a suite of 40 N-body simulations and measured PÎ´h Î´ (k) for three different halo-mass bins selected at
z = 0. Consistently with previous work, we have found that
the ratio PÎ´h Î´ (k)/PÎ´Î´ (k) grows with k and that this effect
becomes more prominent for more massive haloes (Fig. 1).
The scale dependence of the ratio provides a compelling motivation for considering non-linear bias models.
(ii) We have measured all fields that enter PÎ´h Î´ (k) at one
loop in PT â€“ equation (33) â€“ using different values of the
coarse-graining scale (Î› = 0.05, 0.1 and 0.2 h Mpcâˆ’1 , Fig. 2).
By cross-correlating these fields with the mass overdensity,
we have computed all partial contributions to PÎ´h Î´ (k). Focusing on the composite operators appearing in the bias expansion (e.g. Î´2 and s2 ), we have shown that the amplitude of their cross spectra with Î´ strongly depends on Î›
(top panels of Fig. 3). We have demonstrated that this â€˜UVsensitivityâ€™ is fully captured by the cross correlation between
the composite operators and the linear density field (middle
panels of Fig. 3). Thus, we have successfully obtained the
renormalised spectra by subtracting this UV-sensitive term
from the original spectra (bottom panels of Fig. 3).
(iii) We have compared PÎ´ 2 Î´1 (k) and Ps2 Î´1 (k) extracted
from the simulations to perturbative predictions at LO. An
excellent agreement over a broad range of scales can be
achieved by properly accounting for the window functions
that define the coarse-graining procedure in the perturbative integrals (top panels of Fig. 5). The values 68/21 Ïƒ12 and
136/63 Ïƒ12 , that are usually quoted for the limit k â†’ 0, overpredict our measurements, as they are obtained neglecting
the influence of the window function. The relative difference,
however, decreases with increasing Î›.
(iv) For Î› = 0.05 and 0.1 h Mpcâˆ’1 , we have shown that
the â€˜renormalised spectraâ€™ P[Î´ 2 ]1 Î´ (k) and P[s2 ]1 Î´ (k) measured
in the simulations are in very good agreement with the perturbative calculations obtained by taking the window functions into account (bottom panels of Fig. 5). For Î› = 0.2
h Mpcâˆ’1 , however, the 1-loop results show non-negligible deviations from the numerical data.
(v) We have fit bias models with a different number of
parameters to PÎ´h Î´ (k) by using a Bayesian method that
accounts for correlations between all spectra entering the
model. With a model-selection criterion (WAIC), we have
determined the optimal number of bias parameters that are
needed as a function of Î› for both the renormalised and
non-renormalised spectra. The preferred set of bias operators includes Î´, âˆ‡2 Î´, Î´2 and s2 in most cases (model M4 in
Table 5).
(vi) In Fig. 6, we have illustrated the renormalisation procedure of the linear bias parameter for the optimal model.
We have identified two different modi operandi. The first
(RL) parallels perturbative renormalisation while the secMNRAS 000, 1â€“22 (2019)

21

ond (RNL) generalizes the renormalisation procedure to the
fully non-linear regime.
(vii) We have presented the fits we obtained for the optimal bias model (see Tables 7 and 8, as well as Figs. 8 â€“
10) and compared them to previous results in the literature. While the best-fitting values for the bare linear bias b1
run with Î›, those for the renormalised linear bias bR
stay
1
constant as a function of the cutoff scale (for both RL and
RNL). This confirms that our numerical renormalisation was
successful.
(viii) Finally, we have shown that only RNL leaves the
non-linear and higher-derivative bias parameters unchanged
with respect to the bare bias expansion (NR). This casts
some doubts on the accuracy and robustness of using NLO
perturbative expressions to fit low-redshift observational and
N-body data at k & 0.1 h Mpcâˆ’1 .

ACKNOWLEDGEMENTS
KW acknowledges partial support from the Transregional
Collaborative Research Centre TRR 33 - The Dark Universe
of the Deutsche Forschungsgesellschaft (DFG).

REFERENCES
Abidi M. M., Baldauf T., 2018, J. Cosmology Astropart. Phys.,
7, 029
Akaike H., 1973, Biometrika, 60, 255
Angulo R. E., Foreman S., Schmittfull M., Senatore L., 2015,
J. Cosmology Astropart. Phys., 10, 039
Assassi V., Baumann D., Green D., Zaldarriaga M., 2014, J. Cosmology Astropart. Phys., 8, 056
Baldauf T., Seljak U., Desjacques V., McDonald P., 2012, Phys.
Rev. D, 86, 083540
Baldauf T., Seljak U., Senatore L., Zaldarriaga M., 2016, J. Cosmology Astropart. Phys., 9, 007
Behroozi P. S., Wechsler R. H., Wu H.-Y., 2013, ApJ, 762, 109
Bel J., Hoffmann K., GaztanÌƒaga E., 2015, MNRAS, 453, 259
Bernardeau F., 1994, A&A, 291, 697
Bernardeau F., Colombi S., GaztanÌƒaga E., Scoccimarro R., 2002,
Phys. Rep., 367, 1
Blas D., Garny M., Konstandin T., 2014, J. Cosmology Astropart.
Phys., 1, 010
Bryan G. L., Norman M. L., 1998, ApJ, 495, 80
Carlson J., White M., Padmanabhan N., 2009, Phys. Rev. D, 80,
043531
Catelan P., Lucchin F., Matarrese S., Porciani C., 1998, MNRAS,
297, 692
Catelan P., Porciani C., Kamionkowski M., 2000, MNRAS, 318,
L39
Chan K. C., Scoccimarro R., Sheth R. K., 2012, Phys. Rev. D,
85, 083509
Chan K. C., Sheth R. K., Scoccimarro R., 2017, Phys. Rev. D,
96, 103543
Coles P., 1993, MNRAS, 262, 1065
Davis M., Efstathiou G., Frenk C. S., White S. D. M., 1985, ApJ,
292, 371
Dekel A., Rees M. J., 1987, Nature, 326, 455
Desjacques V., 2008, Phys. Rev. D, 78, 103503
Desjacques V., Crocce M., Scoccimarro R., Sheth R. K., 2010,
Phys. Rev. D, 82, 103529
Desjacques V., Jeong D., Schmidt F., 2018a, J. Cosmology Astropart. Phys., 12, 035
Desjacques V., Jeong D., Schmidt F., 2018b, Phys. Rep., 733, 1

22

Werner & Porciani

Eggemeier A., Scoccimarro R., Smith R. E., 2019, Phys. Rev. D,
99, 123514
Elia A., Ludlow A. D., Porciani C., 2012, MNRAS, 421, 3472
Fry J. N., Gaztanaga E., 1993, ApJ, 413, 447
Fujita T., Mauerhofer V., Senatore L., Vlah Z., Angulo R., 2016,
arXiv e-prints, 1609.00717
Gaztanaga E., Baugh C. M., 1998, MNRAS, 294, 229
Gelman A., Hwang J., Vehtari A., 2014, Statistics and Computing, 24, 997
Goroff M. H., Grinstein B., Rey S.-J., Wise M. B., 1986, ApJ,
311, 6
Hahn O., Abel T., 2011, MNRAS, 415, 2101
Heavens A. F., Matarrese S., Verde L., 1998, MNRAS, 301, 797
Hoffmann K., Bel J., GaztanÌƒaga E., 2015, MNRAS, 450, 1674
Hoffmann K., Bel J., GaztanÌƒaga E., 2017, MNRAS, 465, 2225
Hoffmann K., GaztanÌƒaga E., Scoccimarro R., Crocce M., 2018,
MNRAS, 476, 814
Kaiser N., 1984, ApJ, 284, L9
Kehagias A., NorenÌƒa J., Perrier H., Riotto A., 2014, Nuclear
Physics B, 883, 83
Lazeyras T., Schmidt F., 2018, J. Cosmology Astropart. Phys., 9,
008
Lazeyras T., Schmidt F., 2019, arXiv e-prints, 1904.11294
Lazeyras T., Wagner C., Baldauf T., Schmidt F., 2016, J. Cosmology Astropart. Phys., 2, 018
Lee S., Park C., Biern S. G., 2014, Physics Letters B, 736, 403
Li Y., Hu W., Takada M., 2016, Phys. Rev. D, 93, 063507
Manera M., GaztanÌƒaga E., 2011, MNRAS, 415, 383
Matsubara T., 2011, Phys. Rev. D, 83, 083518
McDonald P., 2006, Phys. Rev. D, 74, 103512
McDonald P., Roy A., 2009, J. Cosmology Astropart. Phys., 8,
020
Mirbabayi M., Schmidt F., Zaldarriaga M., 2015, J. Cosmology
Astropart. Phys., 7, 030
Mo H. J., White S. D. M., 1996, MNRAS, 282, 347
Mo H. J., Jing Y. P., White S. D. M., 1997, MNRAS, 284, 189
Modi C., Castorina E., Seljak U., 2017, MNRAS, 472, 3959
Nishimichi T., et al., 2009, PASJ, 61, 321
Planck Collaboration et al., 2016, A&A, 594, A13
Pollack J. E., Smith R. E., Porciani C., 2012, MNRAS, 420, 3469
Pollack J. E., Smith R. E., Porciani C., 2014, MNRAS, 440, 555
Porciani C., Matarrese S., Lucchin F., Catelan P., 1998, MNRAS,
298, 1097
Rees M. J., 1985, MNRAS, 213, 75P
Roth N., Porciani C., 2011, MNRAS, 415, 829
Saito S., Baldauf T., Vlah Z., Seljak U., Okumura T., McDonald
P., 2014, Phys. Rev. D, 90, 123522
Scherrer R. J., Weinberg D. H., 1998, ApJ, 504, 607
Schmidt F., Jeong D., Desjacques V., 2013, Phys. Rev. D, 88,
023515
Schmittfull M., SimonovicÌ M., Assassi V., Zaldarriaga M., 2018,
arXiv e-prints, 1811.10640
Schneider A., et al., 2016, J. Cosmology Astropart. Phys., 4, 047
Senatore L., 2015, J. Cosmology Astropart. Phys., 11, 007
Spiegelhalter D. J., Best N. G., Carlin B. P., van der Linde A.,
2002, J. Roy. Statist. Soc., B64, 583
Springel V., 2005, MNRAS, 364, 1105
Szalay A. S., 1988, in Audouze J., Pelletan M. C., Szalay A.,
Zelâ€™dovich Y. B., Peebles P. J. E., eds, IAU Symposium Vol.
130, Large Scale Structures of the Universe. p. 163
Tinker J. L., Robertson B. E., Kravtsov A. V., Klypin A., Warren
M. S., Yepes G., GottloÌˆber S., 2010, ApJ, 724, 878
Watanabe S., 2010, J. Mach. Learn. Res., 11, 3571
White S. D. M., Davis M., Efstathiou G., Frenk C. S., 1987, Nature, 330, 451

This paper has been typeset from a TEX/LATEX file prepared by
the author.

MNRAS 000, 1â€“22 (2019)

