AN INFINITESIMAL VARIANT OF GUO-JACQUET TRACE FORMULA I: THE
CASE OF (GL2n,D , GLn,D Ã— GLn,D )

arXiv:1904.07102v3 [math.NT] 30 Apr 2021

HUAJIE LI

Abstract. We establish an inï¬nitesimal variant of Guo-Jacquet trace formula for the case of (GL2n,D ,
GLn,D Ã— GLn,D ). It is a kind of Poisson summation formula obtained by an analogue of Arthurâ€™s
truncation process. It consists in the equality of the sums of two types of distributions which are nonequivariant in general: one type is associated to rational points in the categorical quotient, while the
other type is the Fourier transform of the ï¬rst type. For regular semi-simple points in the categorical
quotient, we obtain weighted orbital integrals.

Contents
1. Introduction
2. Notation
3. The symmetric pair
4. Integrability of the modified kernel
5. Exponential polynomial distributions
6. Non-equivariance
7. An infinitesimal trace formula for MatpÃ—q,D âŠ• MatqÃ—p,D //GLp,D Ã— GLq,D
8. The second modified kernel
9. Weighted orbital integrals
References

1
4
6
9
21
30
33
34
38
41

1. Introduction
The Guo-Jacquet conjecture proposed in [10] is a possible generalisation in higher dimensions of
Waldspurgerâ€™s well-known theorem on central values of automorphic L-functions for GL2 . We briefly
recall it as follows. Let E/F be a quadratic extension of number fields and Î· the quadratic character of
AÃ— /F Ã— attached to it, where A denotes the ring of adeÌ€les of F . Consider the group G = GL2n and its
subgroup H = GLn Ã— GLn defined over F . Let Ï€ be a cuspidal automorphic representation of G(A) with
trivial central character. We say that Ï€ is H-distinguished if the two linear forms (called â€œperiodsâ€) on
it
Z
Ï†(h)dh
PH : Ï† 7â†’
H(F )Z(A)\H(A)

and

PH,Î· : Ï† 7â†’

Z

Ï†(h)Î·(det(h))dh

H(F )Z(A)\H(A)

are both non-zero, where Z denotes the centre of G. This property is directly connected with the nonvanishing of some central L-values (see Friedberg-Jacquetâ€™s work [9]). We also need to deal with another
pair of groups. Let X(E) denote the set of isomorphic classes of quaternion algebras D/F in which E
embeds. For any D âˆˆ X(E), let GD = GLn,D be the algebraic group defined over F whose F -points are
GLn (D) and HD = ResE/F GLn,E be its subgroup. Let Ï€D be a cuspidal automorphic representation of
GD (A) with trivial central character. We say that Ï€D is HD -distinguished if the linear form on it
Z
Ï†(h)dh,
PHD : Ï† 7â†’
HD (F )Z(A)\HD (A)

is not zero, where we identify the centre of GD with Z. One part of the Guo-Jacquet conjecture says
that if Ï€D is HD -distinguished and Ï€ is transferred from Ï€D by the Jacquet-Langlands correspondence,
Date: May 4, 2021.
1

then Ï€ is H-distinguished. We can also expect a converse at least when n is odd. For n = 1, these were
known by Waldspurger [20] and reproved by Jacquet [13].
Now we formally describe the approach of relative trace formulae following Jacquet [13]. This was
adopted by Feigon-Martin-Whitehouse [8] to obtain some partial results. Let f G be a smooth function on
G(A) with compact support. As an analogue of Arthur-Selberg trace formula, the relative trace formula
for the case (G, H) roughly says that there are two ways to write the integral (viewed as a distribution)
Z
Z
Kf G (x, y)Î·(det(x))dxdy,
H(F )\H(A)âˆ©G(A)1

H(F )\H(A)âˆ©G(A)1

P
where G(A)1 denotes the elements in G(A) with absolute-value-1 determinant and Kf G (x, y) = Î³âˆˆG(F )
f G (xâˆ’1 Î³y). The geometric side is expected to be a sum of relative (weighted) orbital integrals while
the spectral side should be an expansion of periods. Similarly there is also another formula for the
case of (GD , HD ). Then the comparison of periods of different pairs of groups predicted by the GuoJacquet conjecture is reduced to the comparison of relative (weighted) orbital integrals, for which there
are already some works such as Guoâ€™s fundamental lemma [10] and Zhangâ€™s transfer [25].
However, we have neglected analytic difficulty in the above discussion. That is to say, the double
integral above is not convergent and neither are two ways of its expansions. This is the reason why some
restrictive local conditions are needed in the main results of [8] though they seem kind of artificial. The
aim of this article is to solve this kind of problem at the level of Lie algebras for the case of (G, H).
Notice that such a double integral can be formally written as a single integral
Z
Kf G/H (x)Î·(det(x))dx,
R

H(F )\H(A)âˆ©G(A)1

where f G/H (x) = H(A)âˆ©G(A)1 f G (xy)dy defines a smooth function on (G/H)(A) with compact support
P
and Kf G/H (x) = Î³âˆˆ(G/H)(F ) f G/H (xâˆ’1 Î³x). Replacing the symmetric space G/H by its tangent space
s â‰ƒ gln âŠ• gln at the neutral element, we are faced with the divergence of the integral
Z
kf (x)Î·(det(x))dx,
H(F )\H(A)âˆ©G(A)1

P
where f is a Bruhat-Schwartz function on s(A) and kf (x) = Î³âˆˆs(F ) f (xâˆ’1 Î³x).
Our main results can be described as follows.
First of all, as in [2], we replace kf (x) with some explicit kfT (x) (see its definition in (4.0.1) and (4.2.2))
to make the last integral absolutely convergent, where T âˆˆ R2n is a truncation parameter. Moreover,
there is a relation of equivalence on s(F ) defined by the categorical quotient s//H; we denote by O the
T
set of classes of equivalence. For each class o âˆˆ O, we define kf,o
(x) and its integral similarly by replacing
s(F ) with o. Then we have
X
T
kfT (x) =
kf,o
(x),
oâˆˆO

and prove the following theorem which gives the geometric expansion of
Z
kfT (x)Î·(det(x))dx.
H(F )\H(A)âˆ©G(A)1

Theorem 1.1 (see Theorem 4.14). For T in a suitable cone in R2n ,
XZ
T
kf,o
(x)Î·(det(x))dx
oâˆˆO

H(F )\H(A)âˆ©G(A)1

is absolutely convergent.

Moreover, we see that each summand in the geometric expansion is a sum of products of polynomials
and exponential functions in T . In fact, most (namely regular semi-simple) terms are simply polynomial
distributions.
Theorem 1.2 (see Corollary 5.9). For T in a suitable cone in R2n and each o âˆˆ O, define
Z
T
T
kf,o
(x)Î·(det(x))dx.
Jo (Î·, f ) :=
H(F )\H(A)âˆ©G(A)1

JoT (Î·, f )

Then T 7â†’
is the restriction of an exponential polynomial in T . In particular, if o is regular
semi-simple, it is the restriction of a polynomial in T .
2

This property allows us to take the constant term Jo (Î·, f ) of JoT (Î·, f ) to eliminate the truncation
parameter. In the infinitesimal setting, the geometric expansion of the Fourier transform of f plays the
role of the original spectral side (cf. [5]). Our infinitesimal variant of Guo-Jacquet trace formula equating
the geometric developments of f and its Fourier transform (defined by (3.5.2) and denoted by fË†) is the
following, which essentially comes from the Poisson summation formula.
Theorem 1.3 (see Theorem 7.1). For a Bruhat-Schwartz function f on s(A), we have the equality
X
X
Jo (Î·, f ) =
Jo (Î·, fË†).
oâˆˆO

oâˆˆO

Such a formula should be of interest for at least two reasons. For one thing, since this formula is close
to but easier than its analogue for the symmetric space, it gives us a clue to the original relative trace
formula (cf. Zydorâ€™s work [27] on Jacquet-Rallis trace formulae). For another, a simplified version of
this formula (see [25, Theorem 8.4 and p. 1875]) has been used in Zhangâ€™s proof of the smooth transfer.
The distributions Jo (Î·, Â·) on s(A) that we obtained are non-equivariant under the conjugation of
H(A) âˆ© G(A)1 in general, which is close to the situation in [2] and different from that in [26]. In fact,
we have the following formula of non-equivariance. The lack of equivariance may add difficulty to the
comparison of Guo-Jacquet trace formulae (cf. [4, Â§22]).
Proposition 1.4 (see Corollary 6.2). For a Bruhat-Schwartz function f on s(A) and y âˆˆ H(A) âˆ© G(A)1 ,
we denote f y (x) := f (yxy âˆ’1 ). Then
X
Î·
Jo (Î·, f y ) = Î·(det(y))
JoQ (Î·, fQ,y
),
Q

where the sum on Q runs over all Ï‰-stable relatively standard parabolic subgroups of G (defined in Section
Î·
5.2). Here JoQ (Î·, Â·) is an analogue of Jo (Î·, Â·) with G replaced by Q, and fQ,y
is defined by (6.0.1) with
s = 0.
Nevertheless, we can write regular semi-simple terms as explicit weighted orbital integrals whose
weights are the restriction to H(A) of Arthurâ€™s in [2] for G(A).
Theorem 1.5 (see Theorem 9.2). Let o âˆˆ O be a regular semi-simple class, P1 an Ï‰-stable relatively
standard parabolic subgroup of G and X1 âˆˆ o an elliptic element relative to P1 (defined in Section 9.2).
For a Bruhat-Schwartz function f on s(A), we have
Z
f (xâˆ’1 X1 x)vP1 (x)Î·(det(x))dx,
Jo (Î·, f ) = vol([HX1 ]) Â·
HX1 (A)\H(A)

where HX1 denotes the centraliser of X1 in H, vol([HX1 ]) is its associated volume and vP1 (x) is the
volume of some convex hull.
This paper is organised in the following way. Section 2 and 3 are devoted to standard notation
in Arthurâ€™s work on trace formulae and characterisation of O in the specific symmetric pair that we
T
consider respectively. We define the truncated kernel kf,o
(x) and prove its integrability in Section 4.
This key definition is partly inspired by [12] [26] [6] (for the decomposition of groups) and [16] (for the
decomposition of linear spaces) apart from Arthurâ€™s pioneering work [2] and its Lie algebra variant [5].
Section 5 is about the quantitive behaviour of our distributions with respect to the truncation parameter
T . In Section 6, we study their variance under the conjugation of H(A) âˆ© G(A)1 . In Section 7, the
infinitesimal Guo-Jacquet trace formula for the case of (GL2n , GLn Ã— GLn ) is given. Section 8 and 9
aim to express the regular semi-simple distribution as weighted orbital integrals.
Here are two final remarks. Firstly, actually we study the more general symmetric pair (GLp+q,D ,
GLp,D Ã— GLq,D ) instead of (GL2n , GLn Ã— GLn ) and add an extra term |Nrd(x1 )|sA to the integrand
in most of this article. Not only do we prefer more general results (including the case considered in
[24] for instance) or possible applications (cf. [17] for the study of the first derivative of L-functions),
but the study of the case where p = q and s = 0 also yields consideration on a more general setting
including the cases where p 6= q or s 6= 0 (see Theorem 5.8 for example). A simple reason for this comes
from the structure of the intersection of H and semi-standard Levi subgroups of G. Secondly, there are
some similarities between our case and the twisted trace formula (cf. [15]) for (GLn Ã— GLn ) â‹Š Ïƒ where
Ïƒ exchanges two copies of GLn . In fact, we obtain the same weights for regular semi-simple orbits.
However, we shall see that more parabolic subgroups will be needed to define the truncation here. We
shall return to this discussion at the end of this paper.
3

Acknowledgement. I would like to express my great appreciation to my PhD advisor Professor PierreHenri Chaudouard for introducing me to this problem and valuable suggestions during my preparation
of this work. Part of this paper was revised during my visit to the Institute for Mathematical Sciences
at the National University of Singapore and I would like to thank their hospitality. This work was
supported by grants from ReÌgion Ile-de-France.
2. Notation
2.1. Roots and weights. Let F be a number field and G a reductive group defined over F . Denote
by ZG the centre of G. Fix a minimal Levi F -subgroup M0 of G. All the following groups are assumed
to be defined over F without further mention. We call a parabolic subgroup P of G semi-standard if
M0 âŠ† P . For any semi-standard parabolic subgroup P of G, we usually write MP for the Levi factor
containing M0 and NP the unipotent radical. Denote by AP the maximal F -split torus in the centre of
MP . Let X(MP )F be the group of characters of MP defined over F . Then define
aP := HomZ (X(MP )F , R)
and its dual space
aâˆ—P := X(MP )F âŠ—Z R,
which are both R-linear spaces of dimension dim(AP ). Notice that the restriction X(MP )F Ö’â†’ X(AP )F
induces an isomorphism
aâˆ—P â‰ƒ X(AP )F âŠ—Z R.
Suppose that P1 âŠ† P2 are a pair of semi-standard parabolic subgroups of G. The restriction
2
X(MP2 )F Ö’â†’ X(MP1 )F induces aâˆ—P2 Ö’â†’ aâˆ—P1 and its dual map aP1 Ö‰ aP2 . Denote by aP
P1 the kernel
âˆ—
âˆ—
of the latter map aP1 Ö‰ aP2 . The restriction X(AP1 )F Ö‰ X(AP2 )F induces aP1 Ö‰ aP2 and its dual map
aP2 Ö’â†’ aP1 . The latter map aP2 Ö’â†’ aP1 provides a section of the previous map aP1 Ö‰ aP2 . Thus we have
decompositions
2
aP1 = aP2 âŠ• aP
P1
and
2 âˆ—
aâˆ—P1 = aâˆ—P2 âŠ• (aP
P1 ) .
2
When P1 is a minimal semi-standard parabolic subgroup, since aP1 (resp. AP1 ) and aP
P1 are independent
P2
of the choice of P1 , we write them as a0 (resp. A0 ) and a0 respectively.
2
For a pair of semi-standard parabolic subgroups P1 âŠ† P2 of G, write âˆ†P
P1 for the set of simple roots
P2
P2
2 âˆ—
for the action of AP1 on NP1 := NP1 âˆ© MP2 . Notice that âˆ†P1 is a basis of (aP
P1 ) . Let

b P2 )âˆ¨ := {ÌŸÎ±âˆ¨ : Î± âˆˆ âˆ†P2 }
(âˆ†
P1
P1

P2
2
be the basis of aP
P1 dual to âˆ†P1 . If B is a minimal semi-standard parabolic subgroup contained in P1 ,
P2
âˆ¨
âˆ¨
2
one has the coroot Î² âˆ¨ associated to any Î² âˆˆ âˆ†P
B . For every Î± âˆˆ âˆ†P1 , let Î± be the projection of Î² to
P2
P2
P2
aP1 , where Î² âˆˆ âˆ†B whose restriction to aP1 is Î±. Such Î±âˆ¨ is independent of the choice of B. Define
P2
âˆ¨
2 âˆ¨
(âˆ†P
P1 ) := {Î± : Î± âˆˆ âˆ†P1 },
2
which is a basis of aP
P1 . Denote by

b P2 := {ÌŸÎ± : Î± âˆˆ âˆ†P2 }
âˆ†
P1
P1

P2 âˆ¨
2 âˆ—
the basis of (aP
P1 ) dual to (âˆ†P1 ) .
For a semi-standard parabolic subgroup P of G, set

G
a+
P := {T âˆˆ aP : âˆ€Î± âˆˆ âˆ†P , Î±(T ) > 0}.

For P1 âŠ† P2 as above, define Ï„PP12 and Ï„bPP12 as the characteristic functions of
2
{T âˆˆ a0 : âˆ€Î± âˆˆ âˆ†P
P1 , Î±(T ) > 0}

and
respectively.

b P2 , ÌŸ(T ) > 0}
{T âˆˆ a0 : âˆ€ÌŸ âˆˆ âˆ†
P1
4

2.2. The functions HP and F P . Let A be the ring of adeÌ€les of F and | Â· |A the product of normalised
local absolute values on the group of ideÌ€les Aâˆ— . Fix a maximal compact subgroup K of G(A) that is
admissible relative to M0 in the sense of [3, p. 9]. In this paper, we choose the standard maximal
compact subgroup for inner forms of GLn (see [22, p. 191 and 199] for example). More concretely,
suppose that G(F ) = GLn (D), where D is a central division algebra over F . For every place v of F ,
fix an isomorphism D âŠ—F Fv â‰ƒ glrv (Dv ), where Dv is a central division algebra over Fv . Under this
isomorphism, the completion at v of G(F ) is Gv â‰ƒ GLnv (Dv ), where nv = nrv . For v a finite place of
F , let Kv â‰ƒ GLnv (ODv ), where ODv is the ring of integers of Dv ; for v an infinite place of F , we choose
Kv to be the orthogonal group, unitary group and compact symplectic group Q
(see [11, Chapter 1.2.8] for
example) for Gv â‰ƒ GLnv (R), GLnv (C) and GLnv (H) respectively; let K := v Kv . Suppose that P is
a semi-standard parabolic subgroup of G. If m âˆˆ MP (A), define HP (m) âˆˆ aP by
hHP (m), Ï‡i = log(|Ï‡(m)|A )

1

for all Ï‡ âˆˆ X(MP )F . Write MP (A) for the kernel of HP and Aâˆž
P for the neutral component for the
topology of R-manifolds of the group of R-points of the maximal Q-split torus in ResF/Q AP . Then
any element x âˆˆ G(A) can be written as x = nmak, where n âˆˆ NP (A), m âˆˆ MP (A)1 , a âˆˆ Aâˆž
P and
k âˆˆ K. We can define a continuous map HP : G(A) â†’ aP by setting HP (x) := HP (a) with respect to
this decomposition. Notice that HP induces an isomorphism from Aâˆž
P to aP . If P âŠ† Q are a pair of
semi-standard parabolic subgroups, write
1
AQ,âˆž
:= Aâˆž
P âˆ© MQ (A) .
P

Then HP also induces an isomorphism from AQ,âˆž
to aQ
P
P.
Denote by â„¦G the Weyl group of (G, A0 ). In the cases to be considered in this paper, for every s âˆˆ â„¦G ,
we can always choose one representative Ï‰s âˆˆ G(F )âˆ©K. In fact, we are dealing with the case of G = GLn
or its inner forms, thus we can choose â„¦G to be the group of permutation matrices. For an F -subgroup
H of G and s âˆˆ â„¦G , we usually write sH := Ï‰s HÏ‰sâˆ’1 . Let P1 and P2 be a pair of semi-standard parabolic
subgroups of G. Denote by â„¦G (aP1 , aP2 ) the (perhaps empty) set of distinct isomorphisms from aP1 to
aP2 obtained by restriction of elements in â„¦G . Denote by â„¦G (aP1 ; P2 ) the (perhaps empty) subset of
double classes in â„¦MP2 \â„¦G /â„¦MP1 of elements s âˆˆ â„¦G such that s(aP1 ) âŠ‡ aP2 . Suppose additionally
that P1 and P2 contain a common minimal semi-standard parabolic subgroup P0 of G. We can talk
about positive roots and standard parabolic subgroups with respect to P0 . By [15, Lemme 1.3.6], each
s âˆˆ â„¦G (aP1 , aP2 ) admits a unique representative (still denoted by s) in â„¦G such that sâˆ’1 Î± > 0 for all
G
2
Î± âˆˆ âˆ†P
P0 . By [15, Lemme 1.3.7], each s âˆˆ â„¦ (aP1 ; P2 ) admits a unique representative (still denoted by
P2
G
âˆ’1
s) in â„¦ such that s Î± > 0 for all Î± âˆˆ âˆ†P0 . If Q is a parabolic subgroup of G containing P1 âˆª P2 and
â„¦MQ (aP1 , aP2 ) 6= âˆ…, we say that P1 and P2 are MQ -associated. There is a bijection between â„¦G (aP1 ; P2 )
and the disjoint union of quotients â„¦MP2 (aR , aR )\â„¦G (aP1 , aR ) where R runs over standard parabolic
subgroups of G contained in P2 , modulo MP2 -association (see [15, Lemme 1.3.7]).
From the reduction theory (see [2, p. 941]), we know that there exists a real number t0 < 0 and a
compact subset ÌºB âŠ† NB (A)M0 (A)1 for each minimal semi-standard parabolic subgroup B of G such
that for any semi-standard parabolic subgroup P of G containing B, we have
G(A) = P (F )SP
B (ÌºB , t0 ).
Here the Siegel set SP
B (ÌºB , t0 ) is defined by
âˆž
SP
B (ÌºB , t0 ) := ÌºB AB (P, t0 )K,

where
âˆž
P
Aâˆž
B (P, t0 ) := {a âˆˆ AB : âˆ€Î± âˆˆ âˆ†B , Î±(HB (a)) > t0 }.
We shall fix such t0 and ÌºB . Additionally, we are authorised to assume that ÌºsB = Ï‰s ÌºB Ï‰sâˆ’1 for s âˆˆ â„¦G .
Moreover, we require that (MP (A) âˆ© ÌºB , MP (A) âˆ© K, B âˆ© MP , t0 ) will play the role of (ÌºB , K, B, t0 ) for
any semi-standard parabolic subgroup P of G containing B.
Let B âŠ† P and t0 be as above. For T âˆˆ a0 , define the truncated Siegel set
âˆž
SP
B (ÌºB , t0 , T ) := ÌºB AB (P, t0 , T )K,

where
âˆž
bP
Aâˆž
B (P, t0 , T ) := {a âˆˆ AB (P, t0 ) : âˆ€ÌŸ âˆˆ âˆ†B , ÌŸ(HB (a) âˆ’ T ) â‰¤ 0}.
1
P
It is known that Aâˆž
B (P, t0 , T )âˆ©MP (A) has compact closure (see [15, Lemme 1.8.1]). Denote by FB (Â·, T )
P
the characteristic function of the projection of SB (ÌºB , t0 , T ) to P (F )\G(A).
5

2.3. Bruhat-Schwartz functions and Haar measures. Write g for the Lie algebra of G. For an
F -linear subspace s of g, denote by S(s(A)) the Bruhat-Schwartz space of s(A), namely the C-linear
space of functions on s(A) generated by fâˆž âŠ— Ï‡âˆž , where fâˆž is a Schwartz function on s(F âŠ—Q R) and
Ï‡âˆž is the characteristic function of an open compact subset of s(Aâˆž ), where we denote by Aâˆž the ring
of finite adeÌ€les of F .
Let P be a semi-standard parabolic subgroup of G. For every algebraic subgroup V of NP (resp. every
subspace h of g), choose the unique Haar measure on V (A) (resp. on h(A)) such that vol(V (F )\V (A)) = 1
(resp. vol(h(F )\h(A)) = 1). We also take the Haar measure on K such that vol(K) = 1.
Fix a Euclidean norm k Â· k on a0 invariant by the group â„¦G and Haar measures on all subspaces of a0
compatible with this norm. If P âŠ† Q are a pair of semi-standard parabolic subgroups, we obtain Haar
Q,âˆž
measures on Aâˆž
via the isomorphism HP .
P and AP
G âˆ—
Denote by ÏP âˆˆ (aP ) the half of the sum of weights (with multiplicities) for the action of AP on
nP . We choose compatible Haar measures on G(A) and its Levi subgroups by requiring that for any
f âˆˆ L1 (G(A)),
Z
Z
Z
Z
f (x)dx =
f (nmk)eâˆ’2ÏP (HP (m)) dndmdk
G(A)
N (A) M (A) K
Z P Z P
Z
Z
=
f (nmak)eâˆ’2ÏP (HP (a)) dndmdadk.
NP (A)

MP (A)1

Aâˆž
P

K

3. The symmetric pair
Let F be a number field and D a central division algebra over F . Let d be the degree of D, i.e.,
dimF (D) = d2 . Denote by GLn,D the reductive group over F whose F -points are GLn (D). For x âˆˆ
GLn (D), we write Nrd(x) for its reduced norm, Trd(x) for its reduced trace and Prdx for its reduced
characteristic polynomial. For x âˆˆ GLp (D) Ã— GLq (D), denote by x1 (resp. x2 ) its projection to the
first (resp. second) component. Until further notice, we shall work in a more general setting than that
of Guo-Jacquet for later use, i.e., we shall study the case of (GLp+q,D , GLp,D Ã— GLq,D ) and add an
additional term |Nrd(x1 )|sA in the integral of the modified kernel.
by diagonal
3.1. Groups and linear spaces. Let G := GLp+q,D and H := GLp,D Ã—GL

 q,D its subgroup
1
0
p
. Thus H = GÎ¸ ,
embedding. Define an involution Î¸ on G by Î¸(g) = Ç«gÇ«âˆ’1 , where Ç« =
0 âˆ’1q
where GÎ¸ denotes the Î¸-invariant subgroup of G.
Define an anti-involution Î¹ on G by Î¹(g) = Î¸(g âˆ’1 ). Denote by S the Î¹-invariant subvariety of G. There
is a symmetrization map
s : G â†’ S, s(g) := gÎ¹(g),
by which one can regard the symmetric space G/H as a subvariety of S. We see that H Ã— H acts on G
by left and right translation and that H acts on S by conjugation.
Let g := Lie(G) and h := Lie(H). Denote by dÎ¸ the differential of Î¸. Thus
h = {X âˆˆ g : (dÎ¸)(X) = X}.
Let s be the tangent space of S at the neutral element. We shall always view s as a subspace of g. Then
s = {X âˆˆ g : (dÎ¸)(X) = âˆ’X},
and





0 A
: A âˆˆ MatpÃ—q (D), B âˆˆ MatqÃ—p (D) â‰ƒ MatpÃ—q (D) âŠ• MatqÃ—p (D).
B 0
There is an H(F )-action on s(F ) by conjugation, i.e.,
s(F ) =

âˆ’1
(h1 , h2 ) Â· (A, B) = (h1 Ahâˆ’1
2 , h2 Bh1 ).

3.2. Semi-simple elements. We say that an element X âˆˆ s is semi-simple if the orbit H Â· X is Zariski
closed in s. By a regular element X âˆˆ s, we mean that the stabiliser HX has minimal dimension.
Proposition 3.1. An element X of s(F ) is semi-simple if
element of the form
ï£«
0 0 1m
ï£¬ 0 0 0
X(A) := ï£¬
ï£­ A 0 0
0 0 0
6

and only if it is H(F )-conjugated to an
ï£¶
0
0 ï£·
ï£·
0 ï£¸
0

with A âˆˆ GLm (D) being semi-simple in the usual sense. More precisely, the set of H(F )-conjugacy
classes of semi-simple elements of s(F ) is bijective to the set of pairs (m, {A}) where 0 â‰¤ m â‰¤ min{p, q}
is an integer and {A} is a semi-simple conjugacy class in GLm (D). Moreover, X(A) is regular semisimple if and only if m = min{p, q} and A is regular semi-simple in GLmin{p,q} (D) in the usual sense.
Proof. The case D = F is [14, Proposition 2.1 and Lemma 2.1] while the case p = q is [24, Proposition
5.2]. This proposition is nothing but a slightly more general one combining both cases, whose proofs are
similar and still work here.




A
âˆˆ s is regular semi-simple if and only if PrdAB is
0


0 A
separable and PrdAB (0) 6= 0. If p > q, an element
âˆˆ s is regular semi-simple if and only if
B 0
PrdBA is separable and PrdBA (0) 6= 0.
Proposition 3.2. If p â‰¤ q, an element

0
B

Proof. We only consider the case p â‰¤ q since the other case can be deduced by symmetry. We may study
the proposition over an algebraic closure F of F . For A âˆˆ MatdpÃ—dq (F ) and B âˆˆ MatdqÃ—dp (F ), we see
that



0 A
(3.2.1)
det Î»Id(p+q) âˆ’
= Î»d(qâˆ’p) det(Î»2 Idp âˆ’ AB).
B 0



0 A
âˆˆ s and denote by PrdX the reduced polynomial of X viewed as an element of g.
B 0
Then PrdX and PrdAB determine each other.
Suppose that PrdAB is separable and PrdAB (0) 6= 0. Let X = Xs + Xn be the Jordan decomposition
in g, where Xs is semi-simple, Xn is nilpotent and Xs Xn = Xn Xs . By the uniqueness of the Jordan
decomposition,
ï£« we see thatï£¶Xs , Xn âˆˆ s. From Proposition 3.1, up to conjugation by H, we may suppose
0 1dp 0
that Xs = ï£­ C
0 0 ï£¸, where C âˆˆ GLdp (F ) is semi-simple. Since PrdX = PrdXs , we deduce that
0
0 0
PrdAB = PrdC . Then PrdC is separable and PrdC (0) 6= 0 by our assumption. By linear algebra, C is
regular semi-simple in GLdp (F ), which implies that Xs âˆˆ s is regular semi-simple by
ï£« Proposition 3.1.
ï£¶
0
D 0
Since Xs Xn = Xn Xs , simple computation (cf. [14, Lemma 2.1]) shows that Xn = ï£­ DC 0 0 ï£¸,
0
0 0
where D âˆˆ gldp (F ) and DC = CD. On the one hand, because Xn is nilpotent and C is invertible, we see
that D is nilpotent. On the other hand, because DC = CD and C is regular semi-simple, we see that D
is semi-simple. Hence, we have D = 0 and thus Xn = 0. Therefore, X = Xs âˆˆ s is regular semi-simple.
The other direction is a direct consequence of Proposition 3.1.

Let X :=

3.3.
Denote by c the affine space Ad min{p,q} . Define a morphism Ï€ : s â†’ c by mapping
 Invariants.

0 A
âˆˆ s to the coefficients of the reduced characteristic polynomial of AB. It is constant on
B 0
H-orbits. Denote by crs the subset of (ci )0â‰¤iâ‰¤d min{p,q}âˆ’1 âˆˆ c such that the polynomial
d min{p,q}âˆ’1

P (Î») := Î»d min{p,q} +

X

ci Î»i

i=0

is separable and c0 6= 0. It is a principal Zariski open subset of c. Denote by cÃ— the subset of
(ci )0â‰¤iâ‰¤d min{p,q}âˆ’1 âˆˆ c such that c0 6= 0. Then crs âŠ† cÃ— .
Proposition 3.3. The pair (c, Ï€) defines a categorical quotient of s by H over F .
Proof. It suffices to consider the case p â‰¤ q since the case p > q can be obtained by symmetry.
We first extend the base field to an algebraic closure F of F . Then HF â‰ƒ GLdp,F Ã— GLdq,F and
sF â‰ƒ MatdpÃ—dq,F âŠ• MatdqÃ—dp,F . For (ci )0â‰¤iâ‰¤dpâˆ’1 âˆˆ cF , denote by A((ci )0â‰¤iâ‰¤dpâˆ’1 ) âˆˆ GLpd its companion
7

matrix

ï£«

0
ï£¬ 1
ï£¬
ï£¬
A((ci )0â‰¤iâ‰¤dpâˆ’1 ) := ï£¬
ï£¬ 0
ï£¬ .
ï£­ ..

0
0
1
..

.
0 Â·Â·Â·

Â·Â·Â·
Â·Â·Â·
..
.
..

.
0

Define a morphism cF â†’ sF by mapping (ci )0â‰¤iâ‰¤dpâˆ’1 to
ï£«
0
1dp
ï£­ A((ci )0â‰¤iâ‰¤dpâˆ’1 ) 0
0
0

0
0
..
.

âˆ’c0
âˆ’c1
âˆ’c2
..
.

0
1 âˆ’cdpâˆ’1

ï£¶

ï£·
ï£·
ï£·
ï£·.
ï£·
ï£·
ï£¸

ï£¶
0
0 ï£¸.
0

This is a section of Ï€, so Ï€ is surjective. By Propositions 3.2 and 3.1, the fibre of any point in the
non-empty open subset cF ,rs âŠ† cF contains exactly one closed orbit. We may use Igusaâ€™s criterion (see
[18, Theorem 4.13] and Remark 3.4 below) to show that the pair (cF , Ï€) defines a categorical quotient
of sF by HF .
The morphism Ï€ : s â†’ c defined over F factors through the categorical quotient Spec(F [s]H ) of s by
H over F . This induces a dual morphism F [c] â†’ F [s]H of F -algebras. We have shown that after the
base change to F , it is an isomorphism of F -algebras. By Galois descent, we deduce that the morphism
F [c] â†’ F [s]H is an isomorphism of F -algebras, i.e., the pair (c, Ï€) defines a categorical quotient of s by
H over F .

Remark 3.4. We notice that cF can be of dimension 1 (when D = F and min{p, q} = 1) in the proof of
Proposition 3.3 above, so the first condition in [18, Theorem 4.13] may not be satisfied. However, as is
evident from the proof of Igusaâ€™s criterion, this condition can be replaced with the surjectivity of Ï€.
The categorical quotient (c, Ï€) defines a relation of equivalence on s(F ), where two elements are in
the same class if and only if they have the same image under Ï€. We denote by O the set of equivalent
classes for this relation. By Proposition 3.1, two semi-simple elements of s(F ) belong to the same class
of O if and only if they are conjugate by H(F ). Denote by Ors the subset of O with images in crs . By
Proposition 3.2, each class in Ors is a regular semi-simple H(F )-orbit in s(F ). Denote by OÃ— the subset
of O with images in cÃ— . Then Ors âŠ† OÃ— .
3.4. Relatively standard parabolic subgroups. Fix Pe0 a minimal parabolic subgroup of H defined
over F and M0 a Levi factor of Pe0 defined over F . Then M0 is also a minimal Levi subgroup of G defined
over F . For a semi-standard parabolic subgroup P of G (namely M0 âŠ† P ), we say that P is â€œrelatively
standardâ€ if Pe0 âŠ† P , i.e., P âˆ© H is a standard parabolic subgroup of H (namely Pe0 âŠ† P âˆ© H). We shall
suppose that ÌºPe0 âŠ† ÌºB for all relatively standard minimal parabolic subgroup B of G. Denote by K the
standard maximal compact subgroup of G(A) and by KH := H(A) âˆ© K the maximal compact subgroup
of H(A). Up to conjugation by G(F ), we may assume that M0 is the subgroup of diagonal matrices in
G and that Pe0 is the product of groups of upper triangular matrices.
We can describe the embedding H Ö’â†’ G via D-bimodules. Let V := he1 , Â· Â· Â·, ep iD (resp. W :=
hf1 , Â· Â· Â·, fq iD ) be the free D-bimodule generated by the basis {e1 , Â· Â· Â·, ep } (resp. {f1 , Â· Â· Â·, fq }). Set GL(V )
to be the group of F -linear automorphisms on V, which acts on V on the left. Denote by GL(V )D the
subgroup of GL(V ) which respects the right D-module structure on V . Put G := GL(V âŠ• W )D and
H := GL(V )D Ã— GL(W )D . Then M0 is the stabiliser in G (or in H) of the D-lines hei iD , 1 â‰¤ i â‰¤ p and
hfi iD , 1 â‰¤ i â‰¤ q. Suppose that Pe0 is the direct product of the stabiliser in GL(V )D of the flag
0 ( he1 iD ( he1 , e2 iD ( Â· Â· Â· ( he1 , Â· Â· Â·, ep iD =: V

and the stabiliser in GL(W )D of the flag
0 ( hf1 iD ( hf1 , f2 iD ( Â· Â· Â· ( hf1 , Â· Â· Â·, fq iD =: W.
A relative standard parabolic subgroup P of G can be interpretated as the stabiliser in G of the flag
0 ( he1 , Â· Â· Â·, ep1 , f1 , Â· Â· Â·, fq1 iD ( he1 , Â· Â· Â·, ep1 , f1 , Â· Â· Â·, fq1 , ep1 +1 , Â· Â· Â·, ep1 +p2 , fq1 +1 , Â· Â· Â·, fq1 +q2 iD
( Â· Â· Â· ( he1 , Â· Â· Â·, ep1 , f1 , Â· Â· Â·, fq1 , Â· Â· Â·, epâˆ’pl +1 , Â· Â· Â·, ep , fqâˆ’ql +1 , Â· Â· Â·, fq iD =: V âŠ• W,
8

where

l
P

pi = p,

i=1

l
P

qi = q and we allow pi or qi to be zero. In particular, we have

i=1

MP â‰ƒ GLp1 +q1 ,D Ã— Â· Â· Â· Ã— GLpl +ql ,D

and
MPH â‰ƒ GLp1 ,D Ã— Â· Â· Â· Ã— GLpl ,D Ã— GLq1 ,D Ã— Â· Â· Â· Ã— GLql ,D .
Proposition 3.5. Let P be a relative standard parabolic subgroup of G. For all X âˆˆ (mP âˆ© s)(F ) and
U âˆˆ (nP âˆ© s)(F ), we have
Ï€(X) = Ï€(X + U ).
Proof. It is a consequence of [16, Lemma 2.1]. We can also give a direct proof as follows. Because of
(3.2.1), for any X âˆˆ s(F ), Ï€(X) is determined by the coefficients of the reduced characteristic polynomial
of X regarded as an element of g(F ). The proposition follows from the easy fact: for X âˆˆ mP (F ) and
U âˆˆ nP (F ), the reduced characteristic polynomial of X + U is equal to that of X.

Corollary 3.6. Let P be a relative standard parabolic subgroup of G and o âˆˆ O. For all subsets
S1 âŠ† (mP âˆ© s)(F ) and S2 âŠ† (nP âˆ© s)(F ), we have o âˆ© (S1 âŠ• S2 ) = (o âˆ© S1 ) âŠ• S2 .
3.5. Fourier transform. Fix a nontrivial unitary character Î¨ of A/F . Let hÂ·, Â·i be the non-degenerate
H(A)-invariant bilinear form on s(A) defined by
hX1 , X2 i := Trd(X1 X2 )

(3.5.1)

for all X1 , X2 âˆˆ s(A). For f âˆˆ S(s(A)), its Fourier transform fË† âˆˆ S(s(A)) is defined by
Z
b :=
b
(3.5.2)
fË†(X)
f (X)Î¨(hX, Xi)dX
s(A)

b âˆˆ s(A).
for all X

4. Integrability of the modified kernel

Fix a minimal semi-standard parabolic subgroup P0 of G. For any semi-standard parabolic subgroup
P of G and T âˆˆ a0 , denote by TP the projection of sT in aP , where s is any element in â„¦G such that
sP0 âŠ† P . Notice that this definition is independent of the choice of s.
For a semi-standard parabolic subgroup P of G, x âˆˆ G(A) and T âˆˆ a0 , define
P
(x, TsP0 ),
F P (x, T ) := FsP
0

where s is any element in â„¦G such that sP0 âŠ† P .
Lemma 4.1. The above definition of F P (x, T ) is independent of the choice of s.
Proof. For any s âˆˆ â„¦G and any minimal semi-standard parabolic subgroup B âŠ† P , since we choose
Ï‰s âˆˆ G(F ) âˆ© K, we have
sP
FsB
(x, T ) = FBP (Ï‰sâˆ’1 x, sâˆ’1 T ).
Let s, sâ€² âˆˆ â„¦G be such that sP0 , sâ€² P0 âŠ† P . Then sâ€² sâˆ’1 âˆˆ â„¦MP . By the last equality and the left
P
MP (F )-invariance of FsP
(Â·, TsP0 ), we have
0
P
â€²
(Ï‰sâˆ’1
FsPâ€² P0 (x, Tsâ€² P0 ) = FsP
â€² sâˆ’1 x, ss
0

âˆ’1

P
(x, TsP0 ).
Tsâ€² P0 ) = FsP
0

This completes the proof of the lemma.



Let f âˆˆ S(s(A)), P be a relatively standard parabolic subgroup of G and o âˆˆ O. Write PH := P âˆ© H.
For x âˆˆ MPH (F )NPH (A)\H(A), define
Z
X
kf,P,o (x) :=
f (xâˆ’1 (X + U )x)dU.
XâˆˆmP (F )âˆ©o

(nP âˆ©s)(A)

For T âˆˆ a0 and x âˆˆ H(F )\H(A), define
X
T
(4.0.1)
kf,o
(x) :=
(âˆ’1)dim(AP /AG )
e0 âŠ†P }
{P :P

X

Î´âˆˆPH (F )\H(F )

Ï„bPG (HP (Î´x) âˆ’ TP ) Â· kf,P,o (Î´x).

We know that the sum over Î´ âˆˆ PH (F )\H(F ) is finite from the following lemma.
9

Lemma 4.2. Let P be a semi-standard parabolic subgroup of G. For all x âˆˆ G(A) and T âˆˆ aP , the sum
X
Ï„bPG (HP (Î´x) âˆ’ T )
Î´âˆˆP (F )\G(F )

is finite.

Proof. This is a particular case of [2, Lemma 5.1].



4.1. Reduction theory.
Lemma 4.3. There exists a point T+ âˆˆ a+
P0 such that for any semi-standard parabolic subgroup Q of
G, any minimal semi-standard parabolic subgroup B of G contained in Q, any T âˆˆ T+ + a+
P0 and any
x âˆˆ G(A), we have
X
X
F P (Î´x, T )Ï„PQ (HP (Î´x) âˆ’ TP ) = 1.
{P :BâŠ†P âŠ†Q} Î´âˆˆP (F )\Q(F )

Proof. This is [2, Lemma 6.4] in our case.



We shall fix such a T+ . If T âˆˆ T+ + a+
P0 , we shall say that T is sufficiently regular.
Lemma 4.4. For any relatively standard parabolic subgroup Q of G, any sufficiently regular T and any
x âˆˆ H(A), we have
X
X
F P (Î´x, T )Ï„PQ (HP (Î´x) âˆ’ TP ) = 1.
e0 âŠ†P âŠ†Q} Î´âˆˆPH (F )\QH (F )
{P :P

This is an analogue of [26, Proposition 2.3] whose proof relies on [12, (2.5) in p. 674] (cf. Lemma
4.11 below). It is essentially a restricted form to x âˆˆ H(A) from Lemma 4.3 for x âˆˆ G(A). We can
give a proof close to the steps in an early version of [26], which reflects that a main complexity of the
truncation here arises from the fact that none of the Siegel sets of H is contained in any Siegel set of
G, as mentioned in [12]. However, we shall adopt alternatively the point of view in [6] to give a more
conceptual proof here, which might be useful in other relative trace formulae as well.
First we introduce a variant (see [6, Â§1.5]) of some concepts and results in [6, Â§2] without reproducing
proofs. We say that a semi-standard parabolic subgroup Q of G is standard if P0 âŠ† Q. For P âŠ† Q a pair
of standard parabolic subgroups of G, denote by ÏQ
P the half of the sum of weights (with multiplicities)
+
for the action of AP on nP âˆ© mQ . We denote by a+
P0 the closure of aP0 in a0 .
Definition 4.5. For g âˆˆ G(A), Q a standard parabolic subgroup of G and T âˆˆ a+
P0 , we define the degree
of T -instability of g with respect to Q by the following formula
Q
degQ
T (g) := maxhÏP , HP (Î´g) âˆ’ T i
(P,Î´)

where (P, Î´) runs over the pairs of a standard parabolic subgroup P âŠ† Q and an element Î´ âˆˆ P (F )\Q(F ).
By Lemma 4.2, we know that the supremum of hÏQ
P , HP (Î´g) âˆ’ T i in the definition is finite and
attainable.
Lemma 4.6 (cf. [6, Lemme 2.2.1]). Let g âˆˆ G(A), Q be a standard parabolic subgroup of G and T âˆˆ a+
P0 .
The following two conditions are equivalent:
(1) degQ
T (g) â‰¤ 0;
b Q , we have hÌŸ, HP (Î´g)âˆ’T i â‰¤
(2) for all parabolic subgroup P âŠ† Q, all Î´ âˆˆ P (F )\Q(F ) and all ÌŸ âˆˆ âˆ†
P
0.

Definition 4.7. Let g âˆˆ G(A) and T âˆˆ a+
P0 . We say that a pair (P, Î´) of a standard parabolic subgroup
P âŠ† G and an element Î´ âˆˆ P (F )\G(F ) is T -canonical for g if it satisfies the following two conditions:
G
(1) hÏG
P , HP (Î´g) âˆ’ T i = degT (g);
G
(2) for any parabolic subgroup Q âŠ‡ P such that hÏG
Q , HQ (Î´g) âˆ’ T i = degT (g), we have Q = P .

Lemma 4.8 (cf. [6, Lemme 2.3.2]). Let g âˆˆ G(A) and T âˆˆ a+
P0 . Then (P, Î´) is a T -canonical pair for g
if and only if it satisfies the following two conditions:
(1) degP
T (Î´g) â‰¤ 0;
(2) for any Î± âˆˆ âˆ†G
P , we have hÎ±, HP (Î´g) âˆ’ T i > 0.
10

Proposition 4.9 (cf. [6, Proposition 2.4.1]). Let g âˆˆ G(A) and T âˆˆ a+
P0 . Then there exists a unique
T -canonical pair for g.
Let T âˆˆ a0 and Q be a standard parabolic subgroup of G. Define Fe Q (Â·, T ) as the characteristic
function of g âˆˆ G(A) such that degQ
T (g) â‰¤ 0.

Proposition 4.10 (cf. [6, Proposition 2.5.1]). For g âˆˆ G(A), Q a standard parabolic subgroup of G and
T âˆˆ a+
P0 , we have
(1)
X
X
Fe P (Î´g, T )Ï„ Q (HP (Î´g) âˆ’ TP ) = 1;
P

{P :P0 âŠ†P âŠ†Q} Î´âˆˆP (F )\Q(F )

(2)

Fe Q (g, T ) =

X

(âˆ’1)dim(AP /AQ )

X

Î´âˆˆP (F )\Q(F )

{P :P0 âŠ†P âŠ†Q}

Ï„bPQ (HP (Î´g) âˆ’ TP ).

Since we have similar formulae for F Q (Â·, T ) for sufficiently regular T (see Lemma 4.3), we know that
F (Â·, T ) = FPQ0 (Â·, T ) for such T . Now we can return to the proof of Lemma 4.4.
eQ

Proof of Lemma 4.4. It is noticeable that the identity is reduced to its analogues for semi-standard Levi
factors of Q, which is a product of GLpi +qi ,D whose intersection with H is GLpi ,D Ã—GLqi ,D . By induction
on the rank of G, it suffices to prove the identity for Q = G.
For a standard parabolic subgroup P of G, fix a set of representatives â„¦P,G in {s âˆˆ â„¦G |Pe0 âŠ† sâˆ’1 P }
MP
. We can rewrite the equality in the lemma as
for the relation s1 âˆ¼ s2 if and only if s2 sâˆ’1
1 âˆˆ â„¦
X
X
X
FPP0 (Ï‰s Î´x, TP0 )Ï„PG (HP (Ï‰s Î´x) âˆ’ TP ) = 1.
{P :P0 âŠ†P } sâˆˆâ„¦P,G Î´âˆˆ(sâˆ’1 P )H (F )\H(F )

In fact, this follows from
âˆ’1

Fs

P

âˆ’1

(Î´x, T ) = Fssâˆ’1 PP0 (Î´x, Tsâˆ’1 P0 ) = FPP0 (Ï‰s Î´x, TP0 )

and
Ï„sGâˆ’1 P (Hsâˆ’1 P (Î´x) âˆ’ Tsâˆ’1 P ) = Ï„PG (HP (Ï‰s Î´x) âˆ’ TP ).
Combining the double sums over s and Î´, we claim that the equality above is equivalent to
X
X
FPP0 (Î´x, TP0 )Ï„PG (HP (Î´x) âˆ’ TP ) = 1.
{P :P0 âŠ†P } Î´âˆˆP (F )\P (F )â„¦G H(F )

In fact, for any s âˆˆ â„¦P,G , consider the map

(sâˆ’1 P )H (F )\H(F ) â†’ P (F )\P (F )â„¦G H(F ), Î´ 7â†’ Ï‰s Î´.
Firstly, it is well-defined: if Î´1 = Ï‰sâˆ’1 pÏ‰s Î´2 with p âˆˆ P (F ), then Ï‰s Î´1 = pÏ‰s Î´2 . Secondly, it is injective: if
Ï‰s Î´1 = pÏ‰s Î´2 with p âˆˆ P (F ), then Î´1 = Ï‰sâˆ’1 pÏ‰s Î´2 with Ï‰sâˆ’1 pÏ‰s = Î´1 Î´2âˆ’1 âˆˆ (sâˆ’1 P )H (F ). Thirdly, for s1 6=
âˆ’1
s2 in â„¦P,G , we have Ï‰s1 Î´1 6= pÏ‰s2 Î´2 with p âˆˆ P (F ): otherwise, s1âˆ’1 P = (Î´2 Î´1âˆ’1 )âˆ’1 (sâˆ’1
2 P )(Î´2 Î´1 ) with
âˆ’1
âˆ’1
âˆ’1 âˆ’1 âˆ’1
âˆ’1
âˆ’1
âˆ’1
âˆ’1
Î´2 Î´1 âˆˆ H(F ), so (s1 P )H = (Î´2 Î´1 ) (s2 P )H (Î´2 Î´1 ), and then Î´2 Î´1 âˆˆ (s1 P )H (F ) = (s2 P )H (F )
âˆ’1
âˆ’1
âˆ’1
for both of (sâˆ’1
1 P )H and (s2 P )H are standard parabolic subgroups of H, which implies s1 P = s2 P
G
contradicting s1 6= s2 . Fourthly, any se âˆˆ â„¦ appears in the image of the map for some s âˆˆ â„¦P,G :
since (e
sâˆ’1 P )H is a semi-standard parabolic subgroup of H, there exists an s0 âˆˆ â„¦H such that Pe0 âŠ†
âˆ’1
âˆ’1
s0 ((e
s P )H ) = (sâˆ’1
sâˆ’1 P ))H = ((e
ss0 )âˆ’1 P )H , i.e., ses0 âˆˆ â„¦P,G . To sum up, we finish the argument of
0 (e
the claim.
It suffices to prove an analogue of the last equality by replacing FPP0 with Fe P for T âˆˆ a+
P0 , as they
are identical for sufficiently regular T . That is to say, for x âˆˆ H(A) = GÎ¸ (A), if (P, Î´) is the unique
T -canonical pair for x, we need toprove that Î´ âˆˆ P (F )\P (F )â„¦G H(F ). Recall that Î¸(g) = Ç«gÇ«âˆ’1 for
1p
0
. Since Ç« âˆˆ M0 (F ) âˆ© K, from Lemma 4.8, we deduce that (P, Î´) is
g âˆˆ G(A), where Ç« =
0 âˆ’1q
the unique T -canonical pair for g âˆˆ G(A) if and only if (P, Î¸(Î´)) is the unique T -canonical pair for Î¸(g).
In particular, if (P, Î´) is the unique T -canonical pair for x âˆˆ H(A), we have Î´ = Î¸(Î´). Denote by Î´0 a
representative of Î´ âˆˆ P (F )\G(F ). Then Î´0 Ç«Î´0âˆ’1 âˆˆ P (F ).
Suppose that Î´0 Ç«Î´0âˆ’1 = mu, where m âˆˆ MP (F ) and u âˆˆ NP (F ). Both of mu and m are semi-simple
in G(F ) (in the classical sense) for (mu)2 = m2 = 1. Applying [2, Lemma 2.1] to the characteristic
function of the singleton {u}, one obtains that mu is NP (F )-conjugated to muâ€² for some uâ€² âˆˆ NP (F )
11

such that muâ€² = uâ€² m. Since both of muâ€² and m are semi-simple in G(F ), by the uniqueness of Jordan
decomposition, we have uâ€² = 1, i.e., Î´0 Ç«Î´0âˆ’1 is NP (F )-conjugated to m. By linear algebra, m is MP (F )conjugated to a diagonal matrix with entries {Â±1} with expected multiplicities p and q respectively. In
sum, Î´0 Ç«Î´0âˆ’1 is P (F )-conjugated to Ï‰s Ç«Ï‰sâˆ’1 for some s âˆˆ â„¦G . Suppose that p0 âˆˆ P (F ) satisfies Î´0 Ç«Î´0âˆ’1 =
âˆ’1 âˆ’1
Î¸
G
p0 (Ï‰s Ç«Ï‰sâˆ’1 )pâˆ’1

0 . Then Ï‰s p0 Î´0 âˆˆ G (F ) = H(F ), i.e., Î´ = P (F )Î´0 âˆˆ P (F )\P (F )â„¦ H(F ).
Lemma 4.11. Let P be a relatively standard parabolic subgroup of G. For any a âˆˆ Aâˆž
e0 (PH , t0 ), there
P
âˆž
exists a relatively standard minimal parabolic subgroup B âŠ† P such that a âˆˆ AB (P, t0 ).
Proof. This is an analogue of [12, (2.5) in p. 674]. To begin with, we reduce ourselves to proving the case
P = G. For this purpose, suppose that the assertion is true in this case, and consider the case P 6= G.
âˆž
Since Aâˆž
e0 (PH , t0 ) = AP
e0 âˆ©MP (MPH , t0 ), by our assumption, there exists a minimal parabolic subgroup Bâˆ—
P
of MP containing Pe0 âˆ© MP such that a âˆˆ Aâˆž
Bâˆ— (MP , t0 ). Let B := Bâˆ— NP . Then B is a relatively standard
âˆž
âˆž
minimal parabolic subgroup of G contained in P , and Aâˆž
Bâˆ— (MP , t0 ) = AB (P, t0 ). Thus a âˆˆ AB (P, t0 ),
which implies the lemma. Therefore, we may and shall only consider the case P = G in the rest of the
proof.
ai
t0
Let a âˆˆ Aâˆž
for 1 â‰¤ i â‰¤ p âˆ’ 1 and p + 1 â‰¤
e0 (H, t0 ). Then a = diag(a1 , Â· Â· Â·, ap+q ), where ai+1 > e
P
i â‰¤ p + q âˆ’ 1. In the definition of Siegel sets, we suppose that t0 < 0, so 0 < et0 < 1. Note that
bi
t0
Aâˆž
P0 (G, t0 ) = {diag(b1 , Â· Â· Â·, bp+q )| bi+1 > e , âˆ€1 â‰¤ i â‰¤ p + q âˆ’ 1}. Thus we need to show that there exists
a permutation s âˆˆ â„¦G such that s Â· a = diag(asâˆ’1 (1) , Â· Â· Â·, asâˆ’1 (p+q) ) satisfies the following two conditions:
(1) s(i) < s(i + 1) for 1 â‰¤ i â‰¤ p âˆ’ 1 and p + 1 â‰¤ i â‰¤ p + q âˆ’ 1;
(2)

asâˆ’1 (i)
asâˆ’1 (i+1)

> et0 for 1 â‰¤ i â‰¤ p + q âˆ’ 1.

Firstly, we show that one can move ap+1 to its left hand side in (a1 , Â· Â· Â·, ap+q ) such that both the first
p + 1 elements and the last q âˆ’ 1 ones in the new sequence are in â€œgoodâ€ order (which means that the
quotient of any consecutive pairs is > et0 ), while keeping the original relative orders among (a1 , Â· Â· Â·, ap )
ap
> et0 , we are already done (one can take s = 1). In general, write
and among (ap+1 , Â· Â· Â·, ap+q ). If ap+1



ai
t0
i1 := max 0, max 1 â‰¤ i â‰¤ p
.
>e
ap+1
a

a

1 +1
When 1 â‰¤ i1 â‰¤ p âˆ’ 1, since et0 < 1, aip+1
â‰¤ et0 implies aip+1
â‰¥ eâˆ’t0 > 1; there is an s âˆˆ â„¦G such that
1 +1
s Â· a = diag(a1 , Â· Â· Â·, ai1 , ap+1 , ai1 +1 , Â· Â· Â·, ap , ap+2 , Â· Â· Â·, ap+q ). When i1 = 0, which implies ap+1 > a1 , there
is an s âˆˆ â„¦G such that s Â· a = diag(ap+1 , a1 , Â· Â· Â·, ap , ap+2 , Â· Â· Â·, ap+q ).
Secondly, we consider moving ap+2 as before. One should check that ap+2 will not exceed the new
a
place of ap+1 , which results from the fact that ap+1
> et0 . Thus one can move ap+1 and ap+2 to their
p+2
left hand side in (a1 , Â· Â· Â·, ap+q ) such that both the first p + 2 elements and the last q âˆ’ 2 ones in the
new sequence are in â€goodâ€ order, while still keeping the original relative orders among (a1 , Â· Â· Â·, ap ) and
among (ap+1 , Â· Â· Â·, ap+q ).
To finish the argument of our claim, it suffices to move ap+3 , Â· Â· Â·, ap+q one by one as above. After
moving ai to its left hand side, where p + 3 â‰¤ i â‰¤ p + q, one requires that both the first i elements and
the last p + q âˆ’ i ones in the new sequence are in â€goodâ€ order, while the original relative orders among
(a1 , Â· Â· Â·, ap ) and among (ap+1 , Â· Â· Â·, ap+q ) are kept. As in the second step above, this is possible since
aiâˆ’1
t0
ai > e . After one moves the last element ap+q , the sequence satisfies the desired two conditions. 

Proposition 4.12. Let B be an arbitrary minimal semi-standard parabolic subgroup of G. Let P be a
parabolic subgroup of G containing B. Suppose that T is sufficiently regular. If m âˆˆ ÌºB âˆ© MP (A), a âˆˆ
P
âˆž
Aâˆž
B (P, t0 ) and k âˆˆ K âˆ© MP (A) satisfy FB (mak, TB ) = 1, then a âˆˆ AB (P, t0 , TB ).
Proof. It results from Lemma 4.6, since FeBP (Â·, T ) = FBP (Â·, T ) for sufficiently regular T . Here we write
FeBP (Â·, T ) for Fe P (Â·, T ) when B plays the role of P0 .


For a relatively standard parabolic subgroup P of G, denote by P(Pe0 , P ) the set of relatively standard
minimal parabolic subgroups of G contained in P . For B âˆˆ P(Pe0 , P ), write
1
AG,âˆž
(P, t0 ) := Aâˆž
B (P, t0 ) âˆ© G(A)
B

and for all T âˆˆ a0 ,
1
AG,âˆž
(P, t0 , T ) := Aâˆž
B (P, t0 , T ) âˆ© G(A) .
B
12

Corollary 4.13. Let P be a relatively standard parabolic subgroup of G. For sufficiently regular T , the
following subset of MPH (A) âˆ© G(A)1
[
G,âˆž
(P, t0 , TB )) Â· (KH âˆ© MPH (A))
(ÌºPe0 âˆ© MPH (A)) Â· (Aâˆž
e (PH , t0 ) âˆ© AB
P
0

e0 ,P )
BâˆˆP(P

projects surjectively on {m âˆˆ MPH (F )\MPH (A) âˆ© G(A)1 |F P (m, T ) = 1}.
Proof. This is an analogue of [26, Corollaire 2.5]. By Lemma 4.11, the following subset of MPH (A)âˆ©G(A)1
[
G,âˆž
(P, t0 )) Â· (KH âˆ© MPH (A))
(ÌºPe0 âˆ© MPH (A)) Â· (Aâˆž
e (PH , t0 ) âˆ© AB
P
0

e0 ,P )
BâˆˆP(P

projects surjectively on MPH (F )\MPH (A) âˆ© G(A)1 . Recall that ÌºPe0 âŠ† ÌºB for all B âˆˆ P(Pe0 , P ) and that
KH âŠ† K by our choices (see Section 3.4). Therefore, the statement to be proved follows from Proposition
4.12.

4.2. Integrability.
Theorem 4.14. For all sufficiently regular T and all s âˆˆ R,
XZ
T
|kf,o
(x)||Nrd(x1 )|sA dx < âˆž,
oâˆˆO

H(F )\H(A)âˆ©G(A)1

where we write x = (x1 , x2 ) âˆˆ GLp,D (A) Ã— GLq,D (A).

Proof. Let P1 âŠ† P2 be a pair of relatively standard parabolic subgroups of G. Following [2, Â§6], for
T1 âˆˆ aP1 , we define the characteristic function
X
G
(âˆ’1)dim(AP2 /AQ ) Ï„PQ1 (T1 )b
Ï„Q
(T1 ).
ÏƒPP12 (T1 ) :=
{Q:P2 âŠ†Q}

Recall that for P âŠ‡ P1 a relatively standard parabolic subgroup of G, we have (see [2, p. 943])
X
ÏƒPP12 (T1 ).
Ï„PG (T1 ) =
Ï„PP1 (T1 )b
{P2 :P âŠ†P2 }

Denote P1,H := P1 âˆ© H. For x âˆˆ P1,H (F )\H(A), we put
Ï‡TP1 ,P2 (x) := F P1 (x, T )ÏƒPP12 (HP1 (x) âˆ’ TP1 ),
and
kP1 ,P2 ,o (x) :=

X

(âˆ’1)dim(AP /AG ) kf,P,o (x).

{P :P1 âŠ†P âŠ†P2 }

Using Lemma 4.4 and the left invariance of HP and kf,P,o by PH (F ), we have
X
X
T
Ï‡TP1 ,P2 (Î´x)kP1 ,P2 ,o (Î´x)
(4.2.1)
kf,o
(x) =
e0 âŠ†P1 âŠ†P2 } Î´âˆˆP1,H (F )\H(F )
{P1 ,P2 :P

for x âˆˆ H(F )\H(A). Thus
XZ
oâˆˆO

â‰¤

H(F )\H(A)âˆ©G(A)1

X

X

oâˆˆO {P1 ,P2 :P
e0 âŠ†P1 âŠ†P2 }

T
|kf,o
(x)||Nrd(x1 )|sA dx

Z

P1,H (F )\H(A)âˆ©G(A)1

Ï‡TP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx.

It suffices to prove that for any pair of relatively standard parabolic subgroups P1 âŠ† P2 of G,
XZ
Ï‡TP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx < âˆž.
oâˆˆO

P1,H (F )\H(A)âˆ©G(A)1

If P1 = P2 6= G, by [2, Lemma 6.1], we have ÏƒPP12 = 0 and then Ï‡TP1 ,P2 = 0, so the integration is zero. If
P1 = P2 = G, by Corollary 4.13, every x âˆˆ H(F )\H(A) âˆ© G(A)1 with F G (x, T ) = 1 has a representative
in the compact subset
[
ÌºPe0 Â· AG,âˆž
(G, t0 , TB ) Â· KH ,
B
e0 ,G)
BâˆˆP(P

13

so the integral is bounded by an integral of a continuous function over a compact subset and thus
convergent. Therefore, we reduce ourselves to proving the following proposition.

Proposition 4.15. Let f âˆˆ S(s(A)), s âˆˆ R and P1 ( P2 be two relatively standard parabolic subgroups
of G. Fix any two positive real numbers Ç«0 and N . Then there exists a constant C such that
XZ
Ï‡TP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx â‰¤ Ceâˆ’N kT k
P1,H (F )\H(A)âˆ©G(A)1

oâˆˆO

for all sufficiently regular T satisfying Î±(T ) â‰¥ Ç«0 k T k for any Î± âˆˆ âˆ†G
P0 .
For x âˆˆ H(F )\H(A), define
kf,G (x) :=

X

kf,G,o (x) =

f (xâˆ’1 Xx)

Xâˆˆs(F )

oâˆˆO

and
kfT (x) :=

(4.2.2)

X

X

T
kf,o
(x).

oâˆˆO

Corollary 4.16. Let f âˆˆ S(s(A)) and s âˆˆ R. Fix any two positive real numbers Ç«0 and N . Then there
exists a constant C such that
Z
|kfT (x) âˆ’ F G (x, T )kf,G (x)||Nrd(x1 )|sA dx â‰¤ Ceâˆ’N kT k
H(F )\H(A)âˆ©G(A)1

for all sufficiently regular T satisfying Î±(T ) â‰¥ Ç«0 k T k for any Î± âˆˆ âˆ†G
P0 .
Proof. For x âˆˆ H(F )\H(A), we have
X
X
X
T
T
kfT (x) âˆ’ F G (x, T )kf,G (x) =
kf,o
(x) âˆ’ F G (x, T )
kf,G,o (x) =
(kf,o
(x) âˆ’ F G (x, T )kf,G,o (x)).
oâˆˆO

oâˆˆO

oâˆˆO

Ï‡TP1 ,P2

= 0 for P1 = P2 6= G, we have
X
T
kf,o
(x) âˆ’ F G (x, T )kf,G,o (x) =

By (4.2.1), since

X

Ï‡TP1 ,P2 (Î´x)kP1 ,P2 ,o (Î´x).

e0 âŠ†P1 (P2 } Î´âˆˆP1,H (F )\H(F )
{P1 ,P2 :P

Therefore,

Z

H(F )\H(A)âˆ©G(A)1

â‰¤

XZ

oâˆˆO

â‰¤

X

|kfT (x) âˆ’ F G (x, T )kf,G (x)||Nrd(x1 )|sA dx

H(F )\H(A)âˆ©G(A)1

X

oâˆˆO {P1 ,P2 :P
e0 âŠ†P1 (P2 }

T
(x) âˆ’ F G (x, T )kf,G,o (x)||Nrd(x1 )|sA dx
|kf,o

Z

P1,H (F )\H(A)âˆ©G(A)1

Ï‡TP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx.

We now conclude by applying Proposition 4.15 to the last expression.



Proof of Proposition 4.15. Let P be a relatively standard parabolic subgroup of G such that P1 âŠ† P âŠ†
P2 . For any X âˆˆ mP (F ) âˆ© o, there exists a unique relatively standard parabolic
! subgroup R of G such
S
that P1 âŠ† R âŠ† P and X âˆˆ (mP (F ) âˆ© r(F ) âˆ© o) âˆ’
mP (F ) âˆ© q(F ) âˆ© o . Write
P1 âŠ†Q(R

ï£«

ï£­
eR
m
P1 := mR âˆ’

and

[

{Q:P1 âŠ†Q(R}

ï£¶

mR âˆ© qï£¸

nP
R := nR âˆ© mP .
By Corollary 3.6, we have

ï£«

(mP (F ) âˆ© r(F ) âˆ© o) âˆ’ ï£­

[

P1 âŠ†Q(R

ï£¶

P
eR
mP (F ) âˆ© q(F ) âˆ© oï£¸ = (m
P1 (F ) âˆ© o) âŠ• ((nR âˆ© s)(F )).
14

Hence
X

kf,P,o (x) =

XâˆˆmP (F )âˆ©o

X

=

Z

f (xâˆ’1 (X + U )x)dU

nP âˆ©s(A)

X

X

P
{R:P1 âŠ†RâŠ†P } Î¾âˆˆm
eR
P (F )âˆ©o Xâˆˆ(nR âˆ©s)(F )
1

Z

f (xâˆ’1 (Î¾ + X + U )x)dU.

(nP âˆ©s)(A)

Denote by P the semi-standard parabolic subgroup of G opposite to P and write
nP
R := nR âˆ© mP .
P
Note that the restriction of hÂ·, Â·i (defined in (3.5.1)) to ((nP
R âˆ©s)(A))Ã—((nR âˆ©s)(A)) is also non-degenerate.
R âˆ© s)(A), applying the Poisson summation formula to the Bruhat-Schwartz function
RFor any Î¾ âˆˆ (m
âˆ’1
f
(x
(Î¾
+ Â· + U )x)dU , we get
(nP âˆ©s)(A)

Z

X

(nP âˆ©s)(A)

Xâˆˆ(nP
R âˆ©s)(F )

P
b
Xâˆˆ(n
R âˆ©s)(F )

where the partial Fourier transform Î¦x,R
of
Î¾
notation Î¨ in Section 3.5)
b
Î¦x,R
Î¾ (X)

:=

X

f (xâˆ’1 (Î¾ + X + U )x)dU =
R

(nP âˆ©s)(A)

Z

Z

(nP
R âˆ©s)(A)

âˆ’1

f (x

b
Î¦x,R
Î¾ (X),

f (xâˆ’1 (Î¾ + Â· + U )x)dU is defined by (recall the

(Î¾ + X + U )x)dU

(nP âˆ©s)(A)

!

b
Î¨(hX, Xi)dX

b âˆˆ (nP âˆ© s)(A). Since hU, Xi
b = 0 for U âˆˆ (nP âˆ© s)(A) and X
b âˆˆ (nP âˆ© s)(A), as well as
for all X
R
R
P
nR âˆ© s = (nP âˆ© s) âŠ• (nR âˆ© s), we have
Z
x,R b
b
Î¦Î¾ (X) =
f (xâˆ’1 (Î¾ + U )x)Î¨(hU, Xi)dU
(nR âˆ©s)(A)

b âˆˆ (nP
for all X
R âˆ© s)(A), whose expression is actually independent of P .
To sum up,
X
X
X
b
kf,P,o (x) =
Î¦x,R
Î¾ (X).
P
b
{R:P1 âŠ†RâŠ†P } Î¾âˆˆm
eR
P (F )âˆ©o Xâˆˆ(nR âˆ©s)(F )
1

Hence

kP1 ,P2 ,o (x) =

X

(âˆ’1)dim(AP /AG ) kf,P,o (x)

{P :P1 âŠ†P âŠ†P2 }

=

X

{P :P1 âŠ†P âŠ†P2 }

=

X

ï£«

X

ï£¬
(âˆ’1)dim(AP /AG ) ï£­
X

{R:P1 âŠ†RâŠ†P2 } Î¾âˆˆm
eR
P (F )âˆ©o
1

ï£«
ï£­

X

X

P
b
{R:P1 âŠ†RâŠ†P } Î¾âˆˆm
eR
P (F )âˆ©o Xâˆˆ(nR âˆ©s)(F )

X

1

(âˆ’1)dim(AP /AG )

X

P
b
Xâˆˆ(n
R âˆ©s)(F )

{P :RâŠ†P âŠ†P2 }

For a relatively standard parabolic subgroup P3 of G containing R, we write
ï£¶
ï£«
[
P3
3 â€²
ï£¸.
ï£­
nQ
(nP
R
R ) := nR âˆ’
{Q:RâŠ†Q(P3 }

Then

X

P
b
Xâˆˆ(n
R âˆ©s)(F )

b
Î¦x,R
Î¾ (X) =

X

X

P3 â€²
{P3 :RâŠ†P3 âŠ†P } Xâˆˆ((n
b
) âˆ©s)(F )

15

R

b
Î¦x,R
Î¾ (X).

ï£¶

b ï£·
Î¦x,R
Î¾ (X)ï£¸
ï£¶

b ï£¸
Î¦x,R
Î¾ (X)

We have

X

=

b
Î¦x,R
Î¾ (X)

P
b
Xâˆˆ(n
R âˆ©s)(F )

{P :RâŠ†P âŠ†P2 }

X

X

(âˆ’1)dim(AP /AG )

X

(âˆ’1)dim(AP /AG )

P3 â€²
{P3 :RâŠ†P3 âŠ†P } Xâˆˆ((n
b
) âˆ©s)(F )

{P :RâŠ†P âŠ†P2 }

X

dim(AP2 /AG )

=(âˆ’1)

X

R

X

P3 â€²
{P3 :RâŠ†P3 âŠ†P2 } Xâˆˆ((n
b
) âˆ©s)(F )
R

b
Î¦x,R
Î¾ (X)

b
Î¦x,R
Î¾ (X)
X

(âˆ’1)dim(AP /AP2 ) .

{P :P3 âŠ†P âŠ†P2 }

From [2, Proposition 1.1], we know that

X
1, if P3 = P2 ;
dim(AP /AP2 )
=
(âˆ’1)
0, otherwise.
{P :P3 âŠ†P âŠ†P2 }

We obtain
X

(âˆ’1)dim(AP /AG )

X

P
b
Xâˆˆ(n
R âˆ©s)(F )

{P :RâŠ†P âŠ†P2 }

Thus

dim(AP2 /AG )
b
Î¦x,R
Î¾ (X) = (âˆ’1)

X

kP1 ,P2 ,o (x) = (âˆ’1)dim(AP2 /AG )

X

X

P2 â€²
b
Xâˆˆ((n
R ) âˆ©s)(F )

X

P2 â€²
{R:P1 âŠ†RâŠ†P2 } Î¾âˆˆm
eR
b
) âˆ©s)(F )
P (F )âˆ©o Xâˆˆ((n

Now
XZ
oâˆˆO

â‰¤

P1,H (F )\H(A)âˆ©G(A)1

XZ

oâˆˆO

=

P1,H (F )\H(A)âˆ©G(A)1

X

{R:P1 âŠ†RâŠ†P2 }

Z

1

R

b
Î¦x,R
Î¾ (X).

b
Î¦x,R
Î¾ (X).

Ï‡TP1 ,P2 (x)|kP1 ,P2 ,o (x)||Nrd(x1 )|sA dx
ï£«

ï£¬
Ï‡TP1 ,P2 (x) ï£­

P1,H (F )\H(A)âˆ©G(A)1

We reduce ourselves to bounding
Z
(4.2.3)

P1,H (F )\H(A)âˆ©G(A)1

X

X

X

ï£¶

P2 â€²
{R:P1 âŠ†RâŠ†P2 } Î¾âˆˆm
eR
b
) âˆ©s)(F )
P (F )âˆ©o Xâˆˆ((n

Ï‡TP1 ,P2 (x)

1

X

eR
Î¾âˆˆ(m
P1 âˆ©s)(F )

Ï‡TP1 ,P2 (x)

X

eR
Î¾âˆˆ(m
P1 âˆ©s)(F )

R

X

P2 â€²
b
Xâˆˆ((n
R ) âˆ©s)(F )

X

P2 â€²
b
Xâˆˆ((n
R ) âˆ©s)(F )

s
b ï£·
|Î¦x,R
Î¾ (X)|ï£¸ |Nrd(x1 )|A dx

s
b
|Î¦x,R
Î¾ (X)||Nrd(x1 )|A dx.
s
b
|Î¦x,R
Î¾ (X)||Nrd(x1 )|A dx

for any fixed relatively standard parabolic subgroup R of G such that P1 âŠ† R âŠ† P2 .
By Iwasawa decomposition and our choices of measures, the integral over P1,H (F )\H(A) âˆ© G(A)1 can
be decomposed as integrals over
(n1 , m1 , k) âˆˆ NP1,H (F )\NP1,H (A) Ã— MP1,H (F )\MP1,H (A) âˆ© G(A)1 Ã— KH .
Then

Z

=

Z
Â·

P1,H (F )\H(A)âˆ©G(A)1

KH

Z

Ï‡TP1 ,P2 (x)

eR
Î¾âˆˆ(m
P1 âˆ©s)(F )

MP1,H (F )\MP1,H (A)âˆ©G(A)1

X

X

P2 â€²
eR
b
Î¾âˆˆ(m
) âˆ©s)(F )
P âˆ©s)(F ) Xâˆˆ((n
1

R

X

Z

X

P2 â€²
b
Xâˆˆ((n
R ) âˆ©s)(F )

NP1,H (F )\NP1,H (A)

s
b
|Î¦x,R
Î¾ (X)||Nrd(x1 )|A dx

F P1 (m1 , T )ÏƒPP12 (HP1 (m1 ) âˆ’ TP1 )

b âˆ’2ÏP1,H (HP1,H (m1 )) |Nrd(m1,1 )|s dn1 dm1 dk,
|Î¦Î¾n1 m1 k,R (X)|e
A

where we write m1 = (m1,1 , m1,2 ) âˆˆ GLp,D (A) Ã— GLq,D (A).
By Corollary 4.13, the following subset of MP1,H (A) âˆ© G(A)1
[
G,âˆž
(P1 , t0 , TB )) Â· (KH âˆ© MP1,H (A))
(ÌºPe0 âˆ© MP1,H (A)) Â· (Aâˆž
e (P1,H , t0 ) âˆ© AB
P
0

e0 ,P1 )
BâˆˆP(P

projects surjectively on {m1 âˆˆ MP1,H (F )\MP1,H (A) âˆ© G(A)1 |F P1 (m1 , T ) = 1}. Let Î“1 âŠ† NP1,H (A) be
a compact subset which projects surjectively on NP1,H (F )\NP1,H (A). Then Î“1 Â· (ÌºPe0 âˆ© MP1,H (A)) is a
16

P

compact subset of NPe0 (A). Let Î“2 âŠ† NP2,H (A), Î“3 âŠ† NPe2,H (A) and Î“4 âŠ† MPe0 (A)1 be compact subsets
0
(independent of T ) such that Î“1 Â· (ÌºPe0 âˆ© MP1,H (A)) âŠ† Î“2 Î“3 Î“4 . We have
Z
X
X
s
b
Ï‡TP1 ,P2 (x)
|Î¦x,R
Î¾ (X)||Nrd(x1 )|A dx
P1,H (F )\H(A)âˆ©G(A)1

â‰¤c1

X

e0 ,P1 )
BâˆˆP(P

Z

KH

b
|Î¦Î¾n2 namk,R (X)|e

Z

Î“4

P2 â€²
eR
b
Î¾âˆˆ(m
) âˆ©s)(F )
P âˆ©s)(F ) Xâˆˆ((n
1

Z

AG,âˆž
(P1 ,t0 ,TB )
B

âˆ’2ÏPe (HB (a))
0

Z

Î“3

Z

R

Î“2

ÏƒPP12 (HP1 (a)

âˆ’ TP1 )

X

X

P2 â€²
eR
b
Î¾âˆˆ(m
) âˆ©s)(F )
P âˆ©s)(F ) Xâˆˆ((n
1

R

|Nrd(a1 )|sA dn2 dndadmdk,

where c1 = vol(KH âˆ© MP1,H (A)) is a constant independent of T .
b âˆˆ (nR âˆ© s)(A). Let R âŠ† P2 be a pair of relatively
Lemma 4.17. Let x âˆˆ H(A), Î¾ âˆˆ (mR âˆ© s)(A) and X
standard parabolic subgroups of G. For n2 âˆˆ NP2,H (A), we have
b = Î¦x,R (X).
b
Î¦Î¾n2 x,R (X)
Î¾

Proof of Lemma 4.17. Let U2 := nâˆ’1
2 Î¾n2 âˆ’ Î¾. Then
Z
b
b =
f (xâˆ’1 nâˆ’1
Î¦nÎ¾ 2 x,R (X)
2 (Î¾ + U )n2 x)Î¨(hU, Xi)dU
(nR âˆ©s)(A)
Z
b
f (xâˆ’1 (Î¾ + U2 + nâˆ’1 U n2 )x)Î¨(hU, Xi)dU.
=
2

(nR âˆ©s)(A)

Since both U2 and nâˆ’1
2 U n2 âˆ’ U belong to (nP2 âˆ© s)(A), we have
so
b =
Î¦Î¾n2 x,R (X)

b
hU2 + nâˆ’1
2 U n2 âˆ’ U, Xi = 0,

Z

(nR âˆ©s)(A)

âˆ’1
b
f (xâˆ’1 (Î¾ + U2 + nâˆ’1
2 U n2 )x)Î¨(hU2 + n2 U n2 , Xi)dU.

Because the change of variables U2 + nâˆ’1
2 U n2 7â†’ U does not change the Haar measure, we obtain
b = Î¦x,R (X).
b
Î¦Î¾n2 x,R (X)
Î¾



Using Lemma 4.17, we get
b = Î¦namk,R (X)
b = Î¦aa
Î¦Î¾n2 namk,R (X)
Î¾
Î¾

âˆ’1

namk,R

By change of variables aâˆ’1 U a 7â†’ U , using the fact that
b = haâˆ’1 U a, aâˆ’1 Xai,
b
hU, Xi

we have

b
(X).

âˆ’1

b = e2ÏR,+ (HB (a)) Î¦aâˆ’1 namk,R (aâˆ’1 Xa),
b
Î¦Î¾n2 namk,R (X)
a Î¾a

where we denote by ÏR,+ the half of the sum of weights (with multiplicities) for the action of A0 on
nR âˆ© s. From the reduction theory (see [2, p. 944]), we know that for a satisfying ÏƒPP12 (HP1 (a) âˆ’ TP1 ) 6= 0,
aâˆ’1 na belongs to a compact subset independent of T . In sum,
Z
X
X
s
b
|Î¦x,R
Ï‡TP1 ,P2 (x)
Î¾ (X)||Nrd(x1 )|A dx
P1,H (F )\H(A)âˆ©G(A)1

â‰¤c2

X

e0 ,P1 )
BâˆˆP(P

Â·

X

sup
yâˆˆÎ“

Z

P2 â€²
eR
b
Î¾âˆˆ(m
) âˆ©s)(F )
P âˆ©s)(F ) Xâˆˆ((n
1

(P1 ,t0 ,TB )
AG,âˆž
B

X

P2 â€²
eR
b
Î¾âˆˆ(m
P1 âˆ©s)(F ) Xâˆˆ((nR ) âˆ©s)(F )

R

(2Ï
âˆ’2Ï )(H (a)) P2
e R,+ Pe0 B
ÏƒP1 (HP1 (a)

âˆ’1 b
|Î¦y,R
Xa)||Nrd(a1 )|sA da,
aâˆ’1 Î¾a (a

âˆ’ TP1 )

where c2 is a constant independent of T , and Î“ is a compact subset of H(A) âˆ© G(A)1 independent of T .
Denote by OF the ring of integers of F . Fix an F -basis for each weight space for the action of A0 (F )
on s(F ). Since the function f âˆˆ S(s(A)) is compactly supported at finite places, there exists an OF eR
scheme structure on such weight spaces independent of T such that the sums over Î¾ âˆˆ (m
P1 âˆ© s)(F ) and
17

P2 â€²
b
b âˆˆ ((nP2 )â€² âˆ© s)(F ) can be restricted to Î¾ âˆˆ m
eR
X
P1 (F ) âˆ© s(OF ) and X âˆˆ (nR ) (F ) âˆ© s(OF ) respectively.
R
To see this, one may consult [5, Â§1.9 and p. 363] for details, and one needs to replace mR and nR in loc.
cit. by mR âˆ© s and nR âˆ© s respectively.
Fix an R-basis {e1 , Â· Â· Â· , eâ„“ } of the R-linear space s(F âŠ—Q R), whose dimension is denoted by â„“, consisting
of eigenvectors for the action of Aâˆž
B . Let k Â· k be the standard Euclidean norm with respect to this basis.
Consider a sufficiently large integer k > 0 to be described precisely at the end of the proof. There exists
2
an even integer m â‰¥ 0, a real number kÎ± â‰¥ 0 for each Î± âˆˆ âˆ†P
B , and a real number c3 > 0 satisfying the
following conditions (cf. [5, (4.10) in p. 372] or [2, p. 946-947]):

(1) if R = P2 , m = 0;
R
2
(2) for all Î± âˆˆ âˆ†P
B âˆ’ âˆ†B , kÎ± â‰¥ k;

(3) for all a0 âˆˆ Aâˆž
B (P2 , t0 ),
X

(4.2.4)

P2 â€²
b
Xâˆˆ(n
R ) (F )âˆ©s(OF )

âˆ’m
b
kaâˆ’1
â‰¤ c3
0 Xa0 k

Y

eâˆ’kÎ± Î±(HB (a0 )) .

P
Î±âˆˆâˆ†B2

We fix such data.
We extend any differential operator âˆ‚ on s(F âŠ—Q R) to s(A) by defining âˆ‚(fâˆž âŠ— Ï‡âˆž ) := (âˆ‚fâˆž ) âŠ— Ï‡âˆž
(see Section 2.3 for the notation). We also write
b
Î¦x,R,âˆ‚
(X)
Î¾

:=

Z

(nR âˆ©s)(A)

b
(âˆ‚f )(xâˆ’1 (Î¾ + U )x)Î¨(hU, Xi)dU.

â†’
âˆ’
â†’
âˆ’
For a multi-index i = (i1 , Â· Â· Â· , iâ„“ ) âˆˆ Zâ„“â‰¥0 , denote by âˆ‚ i := ( âˆ‚eâˆ‚ 1 )i1 Â· Â· Â· ( âˆ‚eâˆ‚ â„“ )iâ„“ the corresponding differenb 7â†’ kXk
b m is a polynomial with Z-coefficients
tial operator on s(F âŠ—Q R). Since m is even, the function X
2
on (nP
R âˆ© s)(F âŠ—Q R). Invoking integration by parts (see [7, Theorem 3.3.1.(f)] for example), we see that
there exists a differential operator âˆ‚ (m) on s(F âŠ—Q R) satisfying the following two conditions.

â†’
âˆ’

(1) âˆ‚ (m) is a finite Z-linear combination of âˆ‚ i â€™s with the properties:
â†’
âˆ’
â€¢ the sum of components of i is m;
â†’
âˆ’
â€¢ all components of i are even integers;
â†’
âˆ’
2
â€¢ all non-zero components of i correspond to eigenvectors lying in (nP
R âˆ© s)(F âŠ—Q R).
b=
(2) For X
6 0, we have

b
b âˆ’m |Î¦y,R,Ad(y
|Î¦y,R
Î¾ (X)| = kXk
Î¾

We fix such a âˆ‚ (m) . Suppose that âˆ‚ (m) =
b 6= 0, we have
Then for X

P

â†’
âˆ’
i âˆˆI

âˆ’1

)âˆ‚ (m)

â†’
âˆ’

b
(X)|.

âˆ’ âˆˆ Z.
âˆ’ âˆ‚ i , where I is a finite set of multi-indices and râ†’
râ†’
i
i

âˆ’1 b
b âˆ’m
|Î¦y,R
Xa)| â‰¤ c4 (y)kaâˆ’1 Xak
aâˆ’1 Î¾a (a

X

â†’
âˆ’
i âˆˆI

â†’
âˆ’
i

âˆ’1 b
|Î¦y,R,âˆ‚
Xa)|,
aâˆ’1 Î¾a (a

where c4 (y) is a continuous function of y.
Denote by Î¦(AB , mR âˆ© s) the set of weights of AB in mR âˆ© s. For any Âµ âˆˆ Î¦(AB , mR âˆ© s), let mÂµ be the
corresponding weight space. From [21, Â§41], we know that there exists a function Ï†Âµ âˆˆ S(mÂµ (A)) for each
Âµ âˆˆ Î¦(AB , mR âˆ©s) and a function Ï†nR âˆ©s âˆˆ S((nR âˆ©s)(A)) such that for all Î¾+U âˆˆ (mR âˆ©s)(A)âŠ•(nR âˆ©s)(A)
and y âˆˆ Î“,
ï£¶
ï£«
X
Y
â†’
âˆ’
Ï†Âµ (Î¾Âµ )ï£¸ Ï†nR âˆ©s (U ),
|(âˆ‚ i f )(y âˆ’1 (Î¾ + U )y)| â‰¤ ï£­
â†’
âˆ’
i âˆˆI

ÂµâˆˆÎ¦(AB ,mR âˆ©s)

where Î¾Âµ denotes the projection of Î¾ to mÂµ (A).
18

Let a âˆˆ AG,âˆž
(P1 , t0 , TB ) be such that ÏƒPP12 (HP1 (a) âˆ’ TP1 ) 6= 0. It is shown in [5, p. 375] that
B
2
Î±(HB (a)) > t0 for all Î± âˆˆ âˆ†P
B . Now we have
X

X

P2 â€²
eR
b
Î¾âˆˆ(m
) âˆ©s)(F )
P âˆ©s)(F ) Xâˆˆ((n
1

=

R

X

X

âˆ’1 b
|Î¦y,R
Xa)|
aâˆ’1 Î¾a (a

P2 â€²
eR
b
Î¾âˆˆm
) (F )âˆ©s(OF )
P (F )âˆ©s(OF ) Xâˆˆ(n
1

â‰¤

R

X

X

P2 â€²
eR
b
Î¾âˆˆm
) (F )âˆ©s(OF )
P (F )âˆ©s(OF ) Xâˆˆ(n
1

â‰¤c5

X

eR
Î¾âˆˆm
P (F )âˆ©s(OF )
1

â‰¤c5 c3

X

ï£«
ï£­

eR
Î¾âˆˆm
P (F )âˆ©s(OF )
1

where c5 := sup c4 (y)
yâˆˆÎ“

Thus

R

P1,H (F )\H(A)âˆ©G(A)1

X

â‰¤c2 c5 c3

e0 ,P1 )
BâˆˆP(P

X

Â·

eR
Î¾âˆˆm
P1 (F )âˆ©s(OF )

Y

b âˆ’m
c4 (y)kaâˆ’1 Xak
âˆ’1

Ï†Âµ (Âµ(a)

ÂµâˆˆÎ¦(AB ,mR âˆ©s)

ï£«
ï£­

Y

ÂµâˆˆÎ¦(AB ,mR âˆ©s)

ï£¶

Î¾Âµ )ï£¸ Â·

X

â†’
âˆ’
i âˆˆI

â†’
âˆ’

i
âˆ’1 b
|Î¦y,R,
Xa)|
aâˆ’1 Î¾a (a

X

P2 â€²
b
Xâˆˆ(n
R ) (F )âˆ©s(OF )

ï£¶

Ï†Âµ (Âµ(a)âˆ’1 Î¾Âµ )ï£¸ Â·

Y

b âˆ’m
kaâˆ’1 Xak

eâˆ’kÎ± Î±(HB (a)) ,

P

Î±âˆˆâˆ†B2

Ï†nR âˆ©s (U )dU , and we have applied (4.2.4) to a0 = a in the last inequality.

(nR âˆ©s)(A)

Z

R

âˆ’1 b
|Î¦y,R
Xa)|
aâˆ’1 Î¾a (a

X

Ï‡TP1 ,P2 (x)

eR
Î¾âˆˆ(m
P1 âˆ©s)(F )

Z

e

AG,âˆž
(P1 ,t0 ,TB )
B

ï£«

Y

ï£­

ÂµâˆˆÎ¦(AB ,mR âˆ©s)

X

P2 â€²
b
Xâˆˆ((n
R ) âˆ©s)(F )

s
b
|Î¦x,R
Î¾ (X)||Nrd(x1 )|A dx

(2ÏR,+ âˆ’2ÏPe )(HB (a)) P2
0
ÏƒP1 (HP1 (a)

âˆ’ TP1 )

ï£¶
ï£¶ ï£«
Y
ï£¬
ï£·
Ï†Âµ (Âµ(a)âˆ’1 Î¾Âµ )ï£¸ Â· ï£­
eâˆ’kÎ± Î±(HB (a)) ï£¸ |Nrd(a1 )|sA da.
P

Î±âˆˆâˆ†B2

mR âˆ©s
Denote by Î£B
the positive weights of mR âˆ© s under the action of AB . Consider the subsets S of
P1
with the following property: for all Î± âˆˆ âˆ†R
B âˆ’ âˆ†B , there exists Âµ âˆˆ S such that its Î±-coordinate
is > 0. Then
mR âˆ©s
Î£B

X

eR
Î¾âˆˆm
P (F )âˆ©s(OF )
1

ï£®

ï£«

X Y
ï£°
ï£­
â‰¤
S

ÂµâˆˆS

ï£«
ï£­

Y

ÂµâˆˆÎ¦(AB ,mR âˆ©s)

X

Î¾âˆ’ âˆˆmâˆ’Âµ (OF )âˆ’{0}

ï£¶

Ï†Âµ (Âµ(a)âˆ’1 Î¾Âµ )ï£¸
ï£¶ï£¹ ï£®

Ï†âˆ’Âµ (Âµ(a)Î¾âˆ’ )ï£¸ï£» ï£°

Y
m

ÂµâˆˆÎ£B R

âˆ©s

ï£«
ï£­

X

Î¾+ âˆˆmÂµ (OF )

ï£¶ï£¹

Ï†Âµ (Âµ(aâˆ’1 )Î¾+ )ï£¸ï£» .

The rest of the proof is analogous to that of [5, Proposition 4.4], and we shall only sketch main steps and
point out additional ingredients. By the argument in [5, p. 373], for a âˆˆ Aâˆž
B (P2 , t0 ), we have bounds for
two factors
ï£¶
ï£«
Y
X
Y
ï£­
Ï†âˆ’Âµ (Âµ(a)Î¾âˆ’ )ï£¸ â‰¤ c6
eâˆ’kÎ±(HB (a))
ÂµâˆˆS

P

Î¾âˆ’ âˆˆmâˆ’Âµ (OF )âˆ’{0}

1
Î±âˆˆâˆ†R
B âˆ’âˆ†B

and
Y

m âˆ©s
ÂµâˆˆÎ£B R

ï£«
ï£­

X

Î¾+ âˆˆmÂµ (OF )

ï£¶

Ï†Âµ (Âµ(aâˆ’1 )Î¾+ )ï£¸ â‰¤ c7 e(2ÏB,+ âˆ’2ÏR,+ )(HB (a)) ,
19

where c6 and c7 are constants independent of T . We deduce that

e

(2ÏR,+ âˆ’2ÏPe )(HB (a))
0

Â·

X

eR
Î¾âˆˆm
P (F )âˆ©s(OF )

â‰¤c8 e

(2ÏR,+ âˆ’2ÏPe )(HB (a))
0

ï£«

ï£¬
Â·ï£­

1

Y

P

ï£«
ï£­

Y

ÂµâˆˆÎ¦(AB ,mR âˆ©s)

ï£¶

ï£¶
ï£¶ ï£«
ï£¬ Y âˆ’kÎ± Î±(HB (a)) ï£·
s
Ï†Âµ (Âµ(a)âˆ’1 Î¾Âµ )ï£¸ Â· ï£­
e
ï£¸ |Nrd(a1 )|A
P

Î±âˆˆâˆ†B2

ï£«

ï£¶
Y
ï£·
ï£¬
ï£·
eâˆ’kÎ±(HB (a)) ï£¸ e(2ÏB,+ âˆ’2ÏR,+ )(HB (a)) Â· ï£­
eâˆ’kÎ± Î±(HB (a)) ï£¸ |Nrd(a1 )|sA
P

1
Î±âˆˆâˆ†R
B âˆ’âˆ†B

ï£«

ï£¬
=c8 e(2ÏB,+ âˆ’2ÏPe0 )(HB (a)) |Nrd(a1 )|sA Â· ï£­

Y

Î±âˆˆâˆ†B2

ï£¶ ï£«

P

1
Î±âˆˆâˆ†R
B âˆ’âˆ†B

ï£¶

ï£· ï£¬ Y âˆ’kÎ± Î±(HB (a)) ï£·
eâˆ’kÎ±(HB (a)) ï£¸ Â· ï£­
e
ï£¸,
P

Î±âˆˆâˆ†B2

where c8 is a constant independent of T . The last expression only differs from [5, (4.17) in p. 375] by a
factor
pq
! p+q
s
1/p
|Nrd(a
)|
1
(2ÏB,+ âˆ’2ÏPe )(HB (a))
(2Ï
âˆ’2Ï
)(H
(a))
s
B,+
B
e
A
P
0
0
e
|Nrd(a1 )|A = e
1/q
|Nrd(a2 )|A
âˆ—
in the form of eÎ»(HB (a)) , where Î» âˆˆ (aG
B ) . We shall see that this discrepancy will be unimportant when
we follow the end of the proof of [5, Proposition 4.4] (cf. [26, end of Â§3.2]). Write
ï£«
ï£¶
ï£¬ X
ï£·
Î»=ï£­
cÎ± Î±ï£¸ + Î»â€² ,
P

Î±âˆˆâˆ†B2

âˆ—
where cÎ± âˆˆ R and Î»â€² âˆˆ (aG
P2 ) . By [4, Lemma 8.3.(b)], there exists a constant c9 > 0 such that for all
P2
G
T1 âˆˆ aP1 satisfying ÏƒP1 (T1 ) = 1, we have
ï£«
ï£¶
X
ï£¬
ï£·
Î»â€² (T2 ) â‰¤ c9 ï£­
Î²(T12 )ï£¸ ,
P

Î²âˆˆâˆ†P2
1

G,âˆž
G
2
where we write T1 = T12 + T2 with T12 âˆˆ aP
(P1 , t0 , TB ) satisfies
P1 and T2 âˆˆ aP2 . Hence, when a âˆˆ AB
P2
ÏƒP1 (HP1 (a) âˆ’ TP1 ) 6= 0, we have
ï£¶
ï£«
ï£¬ Y cÎ± Î±(HB (a)) ï£· Î»â€² (HP2 (a))
eÎ»(HB (a)) = ï£­
e
ï£¸Â·e
P

Î±âˆˆâˆ†B2

ï£¶
Y
â€²
G
G
â€²
ï£·
ï£¬
=ï£­
ecÎ± Î±(HB (a)) ï£¸ Â· eÎ» (HP2 (a)âˆ’TP2 ) eÎ» (TP2 )
ï£«

P

ï£«

Î±âˆˆâˆ†B2

ï£¶ ï£«

ï£¶

ï£¬ Y cÎ± Î±(HB (a)) ï£· ï£¬ Y c9 tÎ² ï£· c10 kT k
â‰¤ï£­
e
e
,
ï£¸Â·ï£­
ï£¸e
P

P

Î±âˆˆâˆ†B2

Î²âˆˆâˆ†P2
1

G
where TPG2 is the projection of TP2 to aG
P2 via the decomposition aP2 = aP2 âŠ• aG , we let
2
tÎ² âˆˆ R be the projection of HP1 (a) âˆ’ TP1 to aP
P1
constant independent of T . To bound (4.2.3), it
375]. More precisely, set

kÎ± + cÎ± ,
kÎ±â€² :=
kÎ± + k + cÎ± ,

P

P
Î²âˆˆâˆ†P2
1

tÎ² ÌŸÎ²âˆ¨ with

2
via the decomposition aP1 = aP
P1 âŠ• aP2 , and c10 is a
suffices to plug this extra factor into [5, (4.18) in p.

R
2
for all Î± âˆˆ âˆ†P
B âˆ’ âˆ†B ;
P1
R
for all Î± âˆˆ âˆ†B âˆ’ âˆ†B .
20

Then there exists a constant c11 > 0 independent of T such that
Z
X
X
Ï‡TP1 ,P2 (x)
P1,H

(F )\H(A)âˆ©G(A)1

P2 â€²
eR
b
Î¾âˆˆ(m
) âˆ©s)(F )
P âˆ©s)(F ) Xâˆˆ((n
1

1 ,âˆž
â‰¤c11 vol(AP
(t0 , TB ))ec10 kT k
B

Y

P

R

P

Î±âˆˆâˆ†B2 âˆ’âˆ†B1


Z
â€²
eâˆ’kÎ± Î±(TB )

0

âˆž

s
b
|Î¦x,R
Î¾ (X)||Nrd(x1 )|A dx


â€²
(1 + t)nÎ± e(c9 âˆ’kÎ± )t dt ,

1 ,âˆž
1
where AP
(t0 , TB ) := Aâˆž
B (P1 , t0 , TB ) âˆ© MP1 (A) , and nÎ± â€™s are positive integers independent of T . We
B
P1 ,âˆž
P1
2
know that vol(AB (t0 , TB )) is of polynomial growth in T and that kÎ± â‰¥ k+cÎ± for all Î± âˆˆ âˆ†P
B âˆ’âˆ†B 6= âˆ….
G
For sufficiently regular T satisfying Î±(TB ) â‰¥ Ç«0 kT k for all Î± âˆˆ âˆ†B , if we choose sufficiently large k, then
the last expression is bounded by Ceâˆ’N kT k with a constant C independent of T .


5. Exponential polynomial distributions
Let T be sufficiently regular, o âˆˆ O and Î· be the quadratic character of AÃ— /F Ã— attached to a quadratic
field extension E/F . For f âˆˆ S(s(A)) and s âˆˆ C, define
Z
T
kf,o
(x)Î·(Nrd(x))|Nrd(x1 )|sA dx
(5.0.1)
JoG,T (Î·, s, f ) :=
H(F )\H(A)âˆ©G(A)1

and
J G,T (Î·, s, f ) :=

Z

H(F )\H(A)âˆ©G(A)1

kfT (x)Î·(Nrd(x))|Nrd(x1 )|sA dx,

T
where kf,o
(x) and kfT (x) are defined by (4.0.1) and (4.2.2) respectively, and we write x = (x1 , x2 ) âˆˆ
GLp,D (A) Ã— GLq,D (A). From Theorem 4.14, we know that JoG,T (Î·, s, Â·) and J G,T (Î·, s, Â·) are well-defined
distributions on S(s(A)) and that
X
J G,T (Î·, s, f ) =
JoG,T (Î·, s, f ),
oâˆˆO

which is an analogue of the geometric side of Arthurâ€™s trace formula.

5.1. A generalised case in the product form. Let Q be a relatively standard parabolic subgroup of
G. Then
MQ â‰ƒ GLp1 +q1 ,D Ã— Â· Â· Â· Ã— GLpl +ql ,D
and
MQH â‰ƒ GLp1 ,D Ã— Â· Â· Â· Ã— GLpl ,D Ã— GLq1 ,D Ã— Â· Â· Â· Ã— GLql ,D ,
l
l
P
P
qi = q and we allow pi or qi to be zero. The tangent space of MQ /MQH at the
pi = p,
where
i=1

neutral element is

i=1

mQ âˆ© s â‰ƒ

M

{1â‰¤iâ‰¤l|pi qi 6=0}



0

Matqi Ã—pi ,D


Matpi Ã—qi ,D
.
0

The conjugate action of MQH (F ) on (mQ âˆ© s)(F ) can be described as follows:




GLpi (D)
0
Matpi Ã—qi (D)
(1) if pi qi 6= 0,
acts on
by conjugation;
GLqi (D)
0
Matqi Ã—pi (D)


GLpi (D)
(2) if pi qi = 0,
acts on 0 (viewed as a 0-dimensional vector space) trivially.
GLqi (D)
We may generalise integrability in last section to the product setting here whose proof is similar.
Define a relation of equivalence on (mQ âˆ© s)(F ) which is similar to that on s(F ) on each component.
We denote by OmQ âˆ©s the set of equivalent classes for this relation. For o âˆˆ O, the intersection o âˆ© mQ (F )
is a finite (perhaps empty) union of classes o1 , Â· Â· Â·, ot âˆˆ OmQ âˆ©s . Fix the minimal parabolic subgroup
Pe0â€² := Pe0 âˆ© MQH = Pe0 âˆ© MQ of MQH and its Levi factor M0 . We say that a parabolic subgroup P â€²
of MQ is semi-standard (resp. relatively standard) if M0 âŠ† P â€² (resp. Pe0â€² âŠ† P â€² ). Notice that there
exists a bijection from the set of semi-standard (resp. relatively standard) parabolic subgroups of G
contained in Q to the set of semi-standard (resp. relatively standard) parabolic subgroups of MQ given
by P 7â†’ P âˆ© MQ , whose inverse is given by P â€² 7â†’ P â€² NQ .
Choose Ï‚Q âˆˆ â„¦G (not unique) such that Ï‚Q P0 âŠ† Q. Fix the minimal semi-standard parabolic subgroup
â€²
P0 := (Ï‚Q P0 ) âˆ© MQ of MQ depending on the choice of Ï‚Q . For any semi-standard parabolic subgroup P â€²
21

of MQ and T âˆˆ a0 , denote by TP â€² the projection of sT in aP â€² , where s âˆˆ â„¦MQ such that sP0â€² âŠ† P â€² . For
s âˆˆ â„¦MQ and a semi-standard parabolic subgroup P âŠ† Q of G, we see that sP0â€² âŠ† P âˆ© MQ if and only if
sÏ‚Q P0 âŠ† P . Then (Ï‚Q T )P âˆ©MQ = TP which is independent of the choice of Ï‚Q . If T âˆˆ a+
P0 is sufficiently
+
regular with respect to P0 âŠ† G, then Ï‚Q T âˆˆ aP â€² is sufficiently regular with respect to P0â€² âŠ† MQ .
0
Let f â€² âˆˆ S((mQ âˆ© s)(A)), P â€² be a relatively standard parabolic subgroup of MQ and 1 â‰¤ j â‰¤ t. Write
â€²
PH
:= P â€² âˆ© MQH = P â€² âˆ© H. For x âˆˆ MPHâ€² (F )NPHâ€² (A)\MQH (A), define
Z
X
MQ
f â€² (xâˆ’1 (X + U )x)dU.
(5.1.1)
kf â€² ,P
â€² ,o (x) :=
j
XâˆˆmP â€² (F )âˆ©oj

For T âˆˆ a0 and x âˆˆ MQH (F )\MQH (A), define
X
kfQ,T
(âˆ’1)dim(AP â€² /AMQ )
â€² ,o (x) :=
j
eâ€² âŠ†P â€² }
{P â€² :P
0

(nP â€² âˆ©s)(A)

X

â€² (F )\M
Î´âˆˆPH
QH (F )

M

M

Q
Ï„bP â€² Q (HP â€² (Î´x) âˆ’ TP â€² ) Â· kf â€² ,P
â€² ,o (Î´x).
j

l
For sufficiently regular T âˆˆ a+
P0 and {si }1â‰¤iâ‰¤l âˆˆ C , define
Z
Y
Q,Ï‚Q T
â€²
(Î·,
{s
},
f
)
:=
JoQ,T
(x)Î·(Nrd(x))
k
|Nrd(xi,1 )|sAi dx,
â€²
i
f ,oj
j
MQH (F )\MQH (A)âˆ©MQ (A)1

1â‰¤iâ‰¤l

where we write x = (x1 , ..., xl ) âˆˆ GLp1 +q1 ,D (A) Ã— Â· Â· Â· Ã— GLpl +ql ,D (A) and xi = (xi,1 , xi,2 ) âˆˆ GLpi ,D (A) Ã—
Q,Ï‚ T
GLqi ,D (A). As explained above, kf â€² ,oQj and JoQ,T
are independent of the choice of Ï‚Q . Then we have
j
(Î·, {si }, Â·) on S((mQ âˆ© s)(A)). It only depends on the projection of Ï‚Q T
well-defined distributions JoQ,T
j
Q
to aÏ‚Q P0 and does not depend on TQ . Now we define
JoQ,T :=

(5.1.2)

t
X

JoQ,T
j

j=1

and
J Q,T :=

X

JoQ,T .

oâˆˆO
Î·
fQ

âˆˆ S((mQ âˆ© s)(A)) by
Z
Z
Î·
fQ
(X) :=
f (k âˆ’1 (X + V )k)Î·(Nrd(k))dV dk

For f âˆˆ S(s(A)), define
(5.1.3)

KH

(nQ âˆ©s)(A)

for all X âˆˆ (mQ âˆ© s)(A).
5.2. Ï‰-stable parabolic subgroups. In our case, we can embed G into g in the standard way. For
any linear subspace v of g, we denote by vÃ— the intersection of v and G in g.
 that p = q. Let
 Assume
0 1n
Ã—
Ã—
âˆˆ G(F ). In this
us denote n := p = q. Then s (F ) is the union of classes in O . Let Ï‰ :=
1n 0
section, we shall freely use the notation in Section 3.4. Then Ï‰ is the element in G exchanging ei and fi
for all 1 â‰¤ i â‰¤ n. We see that Ï‰ Pe0 Ï‰ âˆ’1 = Pe0 . We say that a semi-standard parabolic subgroup Q of G is
â€œÏ‰-stableâ€ if Ï‰QÏ‰ âˆ’1 = Q. By Chevalleyâ€™s theorem, this condition is equivalent to Ï‰ âˆˆ Q. Recall that a
relatively standard parabolic subgroup Q of G is understood as the stabiliser in G of the flag
0 ( he1 , Â·Â·Â·, ep1 , f1 , Â·Â·Â·, fq1 iD ( he1 , Â·Â·Â·, ep1 +p2 , f1 , Â·Â·Â·, fq1 +q2 iD ( ... ( he1 , Â·Â·Â·, ep1 +Â·Â·Â·+pl , f1 , Â·Â·Â·, fq1 +Â·Â·Â·+ql iD ,
where

l
P

i=1

pi =

l
P

qi = n and we allow pi or qi to be zero.

i=1

Proposition 5.1. Assume that p = q = n. Let Q be a relatively standard parabolic subgroup of G. Then
Q is Ï‰-stable if and only if pi = qi for all 1 â‰¤ i â‰¤ l.
Proof. Since Ï‰ âˆˆ G exchanges ei and fi for all 1 â‰¤ i â‰¤ n, the parabolic subgroup Ï‰QÏ‰ âˆ’1 of G is the
stabiliser in G of the flag
0 ( hf1 , Â·Â·Â·, fp1 , e1 , Â·Â·Â·, eq1 iD ( hf1 , Â·Â·Â·, fp1 +p2 , e1 , Â·Â·Â·, eq1 +q2 iD ( ... ( hf1 , Â·Â·Â·, fp1 +Â·Â·Â·+pl , e1 , Â·Â·Â·, eq1 +Â·Â·Â·+ql iD .
Then Ï‰QÏ‰ âˆ’1 = Q if and only if the flags associated to Ï‰QÏ‰ âˆ’1 and Q are the same, which is equivalent
to pi = qi for all 1 â‰¤ i â‰¤ l.

22

An illustrating example of Ï‰-stable relatively
l = 2)
ï£«
âˆ—
ï£¬ 0
Q=ï£¬
ï£­ âˆ—
0

standard parabolic subgroups of G looks like (when

ï£¶Ã—
âˆ—
âˆ— ï£·
ï£· .
âˆ— ï£¸
âˆ—
Ã—

pn pn
induces a bijection from the set
Proposition 5.2. Assume that p = q = n. The map Pn 7â†’
pn pn
of standard parabolic subgroups in GLn,D (namely containing the group of upper triangular matrices) to
the set of Ï‰-stable relatively standard parabolic subgroups in G.
âˆ—
âˆ—
âˆ—
âˆ—

âˆ—
0
âˆ—
0

Proof. It is known that there is a bijection between the set of standard parabolic subgroups in GLn,D
and the set of partitions of n. By Proposition 5.1, the latter set is in bijection with the set of Ï‰-stable
relatively standard parabolic subgroups in G. The composition of these bijection is exactly given by the
Ã—

pn pn
.

map Pn 7â†’
pn pn
Proposition 5.3. Assume that p = q = n. Let Q âŠ† R be a pair of relatively standard parabolic subgroups
of G. If Q is Ï‰-stable, then R is Ï‰-stable.
Proof. Suppose that R is the stabiliser in G of the flag
0 ( he1 , Â·Â·Â·, er1 , f1 , Â·Â·Â·, ft1 iD ( he1 , Â·Â·Â·, er1 +r2 , f1 , Â·Â·Â·, ft1 +t2 iD ( ... ( he1 , Â·Â·Â·, er1 +Â·Â·Â·+rlâ€² , f1 , Â·Â·Â·, ft1 +Â·Â·Â·+tlâ€² iD .
The condition Q âŠ† R tells us that the partition (p1 , Â· Â· Â·, pl ) (resp. (q1 , Â· Â· Â·, ql )) is a refinement of the
partition (r1 , Â· Â· Â·, rlâ€² ) (resp. (t1 , Â· Â· Â·, tlâ€² )) of n, and that for all 1 â‰¤ j â‰¤ lâ€² , rj and tj are divided into the
same number of segments in these two refinements. Hence, if pi = qi for all 1 â‰¤ i â‰¤ l, then rj = tj for

all 1 â‰¤ j â‰¤ lâ€² . Thus this proposition results from Proposition 5.1.
For any relative standard parabolic subgroup Q of G, define
\
Ï‰-st
R,
Q
:=
{R:QâŠ†R,Ï‰RÏ‰ âˆ’1 =R}

which is the minimal Ï‰-stable parabolic subgroup of G containing Q.
Proposition 5.4. Assume that p = q = n. Let o âˆˆ O. The following three conditions are equivalent:
(1) o âˆˆ OÃ— ;
(2) for all relatively standard parabolic subgroup Q of G, if o âˆ© q(F ) 6= âˆ…, then Q is Ï‰-stable;
(3) for all relatively standard parabolic subgroup Q of G, if o âˆ© mQ (F ) 6= âˆ…, then Q is Ï‰-stable.
Proof. The direction (2)â‡’(3) is trivial. We actually have (2)â‡”(3) from Proposition 3.5.
Next, we prove the direction (1)â‡’(2). We assume that o âˆˆ OÃ— and that o âˆ© q(F ) 6= âˆ… for some
relatively standard parabolic subgroup Q of G. If Q is not Ï‰-stable, let k be the minimal integer such
that 1 â‰¤ k â‰¤ l âˆ’ 1 and that
X
X
pi âˆ’
qi 6= 0.
1â‰¤iâ‰¤k

1â‰¤iâ‰¤k

Without loss of generality, we may assume that
X
X
pi âˆ’
qi < 0.


1â‰¤iâ‰¤k

1â‰¤iâ‰¤k



âˆ— âˆ—
Let
âˆˆ o âˆ© q(F ). Then A âˆˆ gln (D) is in the form of
, where the size of the zero matrix
0 âˆ—

 

P
P
pi . Therefore, A is not invertible, which
in the lower left corner is at least
pi Ã— 1 +
0
B

A
0



k+1â‰¤iâ‰¤l

k+1â‰¤iâ‰¤l

contradicts with o âˆˆ OÃ— . This establishes (1)â‡’(2).
Finally,
the direction (3)â‡’(1). We assume (3). Suppose that o âˆˆ
/ OÃ— . Let P (Î») := PrdAB (Î»),
 we prove

0 A
where
is any element in o. By [23, Proposition 5], there exists 1 â‰¤ m â‰¤ n such that P (Î») =
B 0
Î»dm R(Î»), where R(Î») = PrdC (Î») for some C âˆˆ GLnâˆ’m (D). Let Q be the relative standard parabolic
23

ï£«

0
ï£¬ 0
ï£¬
subgroup of G with l = 2, p1 = q1 = n âˆ’ m and p2 = q2 = m. Then ï£­
C
0
which contradicts with (3). This shows (3)â‡’(1).

0 1nâˆ’m
0
0
0
0
0
0

ï£¶
0
0 ï£·
ï£· âˆˆ o âˆ© mQ (F ),
0 ï£¸
0


Denote by ÏQ,+ the half of the sum of weights (with multiplicities) for the action of A0 on nQ âˆ© s. We
see that ÏQ,+ = ÏQ âˆ’ ÏQH and that for Q âŠ† R a pair of relatively standard parabolic subgroup of G, the
restriction of (2ÏQ,+ âˆ’ 2ÏQH ) aQ to aR equals (2ÏR,+ âˆ’ 2ÏRH ) aR .
Lemma 5.5. Assume that p = q = n. Let Q be a relatively standard parabolic subgroup of G. For all
b âˆ¨ , we have (2ÏQ,+ âˆ’ 2ÏQH )(ÌŸâˆ¨ ) â‰¥ 0. Moreover, 2ÏQ,+ âˆ’ 2ÏQH viewed as an element of (aG )âˆ—
ÌŸâˆ¨ âˆˆ âˆ†
Q
Q
is zero if and only if Q is Ï‰-stable.

Proof. Put eâˆ—i âˆˆ aâˆ—0 (resp. fiâˆ— âˆˆ aâˆ—0 ) to be the character of the action of A0 on ei (resp. fi ). Write eâˆ¨
i âˆˆ a0
âˆ— âˆ¨
(resp. fiâˆ¨ âˆˆ a0 ) to be the dual basis, i.e., eâˆ—i (eâˆ¨
)
=
Î´
(resp.
f
(f
)
=
Î´
)
for
1
â‰¤
i,
j
â‰¤
n.
A
basis
of
ij
ij
j
i
j
âˆ¨
âˆ¨
âˆ¨
âˆ¨
aQ is given by hâˆ¨
for
1
â‰¤
i
â‰¤
l.
Write
+
f
+
Â·
Â·
Â·
+
f
:=
e
+
Â·
Â·
Â·
+
e
q1 +Â·Â·Â·+qiâˆ’1 +1
q1 +Â·Â·Â·+qi
p1 +Â·Â·Â·+piâˆ’1 +1
p1 +Â·Â·Â·+pi
i
hâˆ—i âˆˆ (aQ )âˆ— to be the dual basis. Denote

ÌŸkâˆ¨ :=

l
P

(pi + qi )

i=k+1

âˆ¨
(hâˆ¨
1 + Â· Â· Â· + hk ) âˆ’

2n

k
P

(pi + qi )

i=1

âˆ¨
(hâˆ¨
k+1 + Â· Â· Â· + hl ).

2n

Recall that
b G )âˆ¨ = {ÌŸâˆ¨ |1 â‰¤ k â‰¤ l âˆ’ 1}
(âˆ†
Q
k

is a basis of aG
Q . We can also see that
2ÏQ,+

X

(pi qj + qi pj )(hâˆ—i âˆ’ hâˆ—j )

X

(pi pj + qi qj )(hâˆ—i âˆ’ hâˆ—j ),

= dimF (D)

aQ

1â‰¤i<jâ‰¤l

and that
2ÏQH

aQ

= dimF (D)

1â‰¤i<jâ‰¤l

so
(2ÏQ,+ âˆ’ 2ÏQH )

aQ

X

= dimF (D)

(pi âˆ’ qi )(qj âˆ’ pj )(hâˆ—i âˆ’ hâˆ—j ).

1â‰¤i<jâ‰¤l

Since

l
P

i=1

pi =

l
P

qi = n, we have

i=1

(hâˆ—i

âˆ’

hâˆ—j )(ÌŸkâˆ¨ )

(
0, if k + 1 â‰¤ i < j â‰¤ l or 1 â‰¤ i < j â‰¤ k;
=
1, if 1 â‰¤ i â‰¤ k and k + 1 â‰¤ j â‰¤ l.

Then
(2ÏQ,+ âˆ’ 2ÏQH )(ÌŸkâˆ¨ ) = dimF (D)

X

(pi âˆ’ qi )(qj âˆ’ pj )

1â‰¤iâ‰¤k
k+1â‰¤jâ‰¤l

ï£«

= dimF (D) ï£­
ï£«

= dimF (D) ï£­

X

pi âˆ’

X

1â‰¤iâ‰¤k

1â‰¤iâ‰¤k

X

X

pi âˆ’

1â‰¤iâ‰¤k

1â‰¤iâ‰¤k

ï£¶ï£«

qi ï£¸ ï£­
ï£¶2

X

k+1â‰¤jâ‰¤l

qi ï£¸ â‰¥ 0.

qj âˆ’

X

k+1â‰¤jâ‰¤l

ï£¶

pj ï£¸

It is clear that (2ÏQ,+ âˆ’ 2ÏQH )(ÌŸkâˆ¨ ) = 0 for all 1 â‰¤ k â‰¤ l âˆ’ 1 if and only if pi = qi for all 1 â‰¤ i â‰¤ l.
24



5.3. Exponential polynomials. Let T1 , T2 âˆˆ a0 . Following [3, Â§2], define Î“P (T1 , T2 ) âˆˆ R inductively
on dim(AP /AG ) by setting
X
(âˆ’1)dim(AQ /AG ) Ï„bPQ (T1 )Î“Q (T1 , T2 )
Ï„bPG (T1 âˆ’ T2 ) =
{Q:P âŠ†Q}

for any relatively standard parabolic subgroup P of G. This definition can be explicitly given by [3, (2.1)
in p. 13] and only depends on the projections of T1 , T2 onto aG
P . For T = (t1 , ..., tp+q ) âˆˆ a0 , we denote
âˆ—
âˆ—
Î£1 (T ) := t1 + ... + tp . If we use the notation in Section 3.4 and put eâˆ—i âˆˆ aâˆ—0 (resp.
P fi âˆˆâˆ— a0 ) to be the
character of the action of A0 on ei (resp. fi ), it is equivalent to say that Î£1 = 1â‰¤iâ‰¤p ei . For T2 âˆˆ aQ
and s âˆˆ C, write
Z
(5.3.1)
pQ,s (T2 ) :=
e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(T1 ) Î“Q (T1 , T2 )dT1 .
aG
Q

When p = q = n, s = 0 and Q is Ï‰-stable, it is reduced to
Z
pQ,0 (T2 ) =
Î“Q (T1 , T2 )dT1
aG
Q

by Lemma 5.5.
b R )âˆ¨ the lattice
For Q âŠ† R a pair of relatively standard parabolic subgroups of G, denote by Z(âˆ†
Q
R
âˆ¨
R
G
âˆ¨
G
âˆ¨
G
b ) in a and by Z(âˆ† ) the lattice generated by (âˆ† ) in a . Following [3, Â§2], for
generated by (âˆ†
Q
Q
R
R
R
Î» âˆˆ aâˆ—Q,C := aâˆ—Q âŠ—R C, define
Y

R
b R âˆ¨ âˆ’1
Î»(ÌŸâˆ¨ )
Î¸bQ
(Î») := vol(aR
Q Z(âˆ†Q ) )
b R )âˆ¨
ÌŸ âˆ¨ âˆˆ(âˆ†
Q

and


G âˆ¨ âˆ’1
G
Î¸R
(Î») := vol(aG
R Z(âˆ†R ) )

Y

Î»(Î±âˆ¨ ).

âˆ¨
Î±âˆ¨ âˆˆ(âˆ†G
R)

Proposition 5.6. Let Q be a relatively standard parabolic subgroup of G, T2 âˆˆ aQ and s âˆˆ C. The
function T1 7â†’ Î“Q (T1 , T2 ) is compactly supported on aG
Q . Moreover, the function T2 7â†’ pQ,s (T2 ) is an
exponential polynomial in T2 ; more precisely, there exists a polynomial pQ,R,s (not necessarily unique)
on aG
R of degree â‰¤ dim(AQ /AG ) for each relatively standard parabolic subgroup R containing Q such that
X
G
G
e(2ÏR,+ âˆ’2ÏRH +sÎ£1 )(T2,R ) pQ,R,s (T2,R
),
pQ,s (T2 ) =
{R:QâŠ†R}

G
R
G
where we write T2,R
for the projection of T2 âˆˆ aQ in aG
R via the decomposition aQ = aQ âŠ• aR âŠ• aG . When
p = q = n and s = 0, the purely polynomial term of pQ,0 (T2 ) is given by
X
G
pQ,R,0 (T2,R
),
{R:QâŠ†R,Ï‰RÏ‰ âˆ’1 =R}

which is a homogeneous polynomial in T2 of degree dim(AQÏ‰-st /AG ); in particular, if Q is Ï‰-stable, then
pQ,0 (T2 ) is a homogeneous polynomial in T2 of degree dim(AQ /AG ).
Proof. The first statement is [3, Lemmas 2.1]. First let us prove the second one.
From [3, Lemma 2.2], we know that the integral
Z
eÎ»(T1 ) Î“Q (T1 , T2 )dT1
aG
Q

is an entire function in Î» âˆˆ aâˆ—Q,C , and its value is given by
X
G
R
G
(âˆ’1)dim(AQ /AR ) eÎ»(T2,R ) Î¸bQ
(Î»)âˆ’1 Î¸R
(Î»)âˆ’1
{R:QâŠ†R}

when the latter expression makes sense.
R
G
Fix Îµ âˆˆ aâˆ—Q,C such that Î¸bQ
(Îµ) 6= 0 and Î¸R
(Îµ) 6= 0 for all relatively standard parabolic subgroups R
Ã—
R
containing Q. Then for t âˆˆ R whose absolute value is small enough, we also have Î¸bQ
(2ÏQ,+ âˆ’ 2ÏQH +
25

G
sÎ£1 + tÎµ) 6= 0 and Î¸R
(2ÏQ,+ âˆ’ 2ÏQH + sÎ£1 + tÎµ) 6= 0 for all relatively standard parabolic subgroups R
containing Q. Let Î» = 2ÏQ,+ âˆ’ 2ÏQH + sÎ£1 + tÎµ in the formula above, and we obtain
X
G
R
(2ÏQ,+ âˆ’ 2ÏQH + sÎ£1 + tÎµ)âˆ’1
(âˆ’1)dim(AQ /AR ) e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 +tÎµ)(T2,R ) Î¸bQ
pQ,s (T2 ) = lim
t7â†’0

Â·

{R:QâŠ†R}

G
Î¸R
(2ÏQ,+

âˆ’ 2ÏQH + sÎ£1 + tÎµ)âˆ’1 .

Since the restriction of 2ÏQ,+ âˆ’ 2ÏQH + sÎ£1 to aR equals 2ÏR,+ âˆ’ 2ÏRH + sÎ£1 , we get
G

G

e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(T2,R ) = e(2ÏR,+ âˆ’2ÏRH +sÎ£1 )(T2,R ) .
G
We can put pQ,R,s (T2,R
) to be the constant term of the Laurent series development around t = 0 of
G

G
R
(2ÏQ,+ âˆ’ 2ÏQH + sÎ£1 + tÎµ)âˆ’1 .
(2ÏQ,+ âˆ’ 2ÏQH + sÎ£1 + tÎµ)âˆ’1 Î¸R
t 7â†’ (âˆ’1)dim(AQ /AR ) e(tÎµ)(T2,R ) Î¸bQ

G
G
Then pQ,R,s (T2,R
) is a polynomial in T2,R
of degree â‰¤ dim(AQ /AG ). Hence we prove the existence in
the second statement.
Now let p = q = n and s = 0. From Lemma 5.5, we know that the purely polynomial term of pQ,0 (T2 )
is given by
X
G
pQ,R,0 (T2,R
).
{R:QâŠ†R,Ï‰RÏ‰ âˆ’1 =R}

Next we compute the degree of pQ,R,0 that we chose above for each Ï‰-stable parabolic subgroup R
containing Q. Denote
b R )âˆ¨ : (2ÏQ,+ âˆ’ 2ÏQH )(ÌŸâˆ¨ ) = 0}
N1 := â™¯{ÌŸâˆ¨ âˆˆ (âˆ†
Q
and
âˆ¨
âˆ¨
N2 := â™¯{Î±âˆ¨ âˆˆ (âˆ†G
R ) : (2ÏQ,+ âˆ’ 2ÏQH )(Î± ) = 0},
where â™¯ means the cardinality of a finite set. Then
deg(pQ,R,0 ) = N1 + N2 .

b G )âˆ¨ and (âˆ†G )âˆ¨ are bases of aG . Since R is relatively standard and Ï‰-stable, by
Recall that both of (âˆ†
R
R
R
Lemma 5.5, we have
N2 = dim(AR /AG ).
Keep the notation as in the proof of Lemma 5.5 for Q. Since R is relatively standard and Ï‰-stable, by
Proposition 5.1, we may suppose that R is the stabiliser in G of the flag
0 ( he1 , Â·Â·Â·, er1 , f1 , Â·Â·Â·, fr1 iD ( he1 , Â·Â·Â·, er1 +r2 , f1 , Â·Â·Â·, fr1 +r2 iD ( ... ( he1 , Â·Â·Â·, er1 +Â·Â·Â·+rlâ€² , f1 , Â·Â·Â·, fr1 +Â·Â·Â·+rlâ€² iD .
The fact that Q âŠ† R tells us that both of the partitions (p1 , Â· Â· Â·, pl ) and (q1 , Â· Â· Â·, ql ) are refinements of
the partition (r1 , Â· Â· Â·, rlâ€² ) of n, and that every ri is divided into the same number of segments in these
two refinements. Then
)
(
j
k
X
X
â€²
R
âˆ¨
âˆ¨
G
âˆ¨
R
b Q ) = projection of ÌŸk âˆˆ (âˆ†
b Q ) to aQ 1 â‰¤ k â‰¤ l âˆ’ 1,
2ri âˆ€1 â‰¤ j â‰¤ l âˆ’ 1
(pi + qi ) 6=
(âˆ†
=

(

i=1

i=1

projection of

ÌŸkâˆ¨

âˆˆ

âˆ¨
bG
(âˆ†
Q)

to

aR
Q

â€²

1 â‰¤ k â‰¤ l âˆ’ 1, âˆ„1 â‰¤ j â‰¤ l âˆ’ 1s.t.

k
X
i=1

pi =

k
X

qi =

i=1

j
X
i=1

ri

)

.

Because the restriction of 2ÏQ,+ âˆ’ 2ÏQH to aR equals 2ÏR,+ âˆ’ 2ÏRH and R is relatively standard and
Ï‰-stable, by Lemma 5.5, we do not need the projection, i.e.,




b G )âˆ¨ .
b G )âˆ¨ to aR = (2ÏQ,+ âˆ’ 2ÏQH ) ÌŸâˆ¨ âˆˆ (âˆ†
(2ÏQ,+ âˆ’ 2ÏQH ) projection of ÌŸkâˆ¨ âˆˆ (âˆ†
k
Q
Q
Q
From the proof of Lemma 5.5, for any 1 â‰¤ k â‰¤ l, we have (2ÏQ,+ âˆ’ 2ÏQH )(ÌŸkâˆ¨ ) = 0 if and only if
k
k
P
P
Ï‰-st
qi . We can also see that Q
pi =
is the Ï‰-stable parabolic subgroup R containing Q with
i=1

i=1

maximal lâ€² := dim(AR ). To sum up, we have

N1 = dim(AQÏ‰-st /AR ).
Hence for each Ï‰-stable parabolic subgroup R containing Q,
deg(pQ,R,0 ) = N1 + N2 = dim(AQÏ‰-st /AR ) + dim(AR /AG ) = dim(AQÏ‰-st /AG ).
The assertion about the particular case where Q is Ï‰-stable is [3, Lemma 2.2] combined with Lemma
5.5; it can also be read from the results above that we have proved.

26

5.4. Quantitive behaviour in T . For a relatively standard parabolic subgroup Q of G, let {sQ
i }1â‰¤iâ‰¤l âˆˆ
Zl be the explicit constants determined by
Y
sQ
(5.4.1)
|Nrd(xi,1 )|Ai = e(2ÏQ,+ âˆ’2ÏQH )(HQH (x))
1â‰¤iâ‰¤l

1

for all x âˆˆ MQH (A) âˆ© MQ (A) , where we write x = (x1 , ..., xl ) âˆˆ GLp1 +q1 ,D (A) Ã— Â· Â· Â· Ã— GLpl +ql ,D (A) and
sQ

xi = (xi,1 , xi,2 ) âˆˆ GLpi ,D (A) Ã— GLqi ,D (A). If pi qi = 0 for some 1 â‰¤ i â‰¤ l, we shall take |Nrd(xi,1 )|Ai = 1
and sQ
i = 0 by convention. Then such constants are unique.
Proposition 5.7. Let Q be a relatively standard parabolic subgroup of G. If pi qi 6= 0 for some 1 â‰¤ i â‰¤ l,
then
!
X
X
Q
si = 2d
(pk âˆ’ qk ) +
(qk âˆ’ pk ) .
k<i

When p = q = n, if Q is Ï‰-stable, then

sQ
i

k>i

= 0 for all 1 â‰¤ i â‰¤ l.

Proof. Assume that pi qi 6= 0 for some 1 â‰¤ i â‰¤ l. Let x âˆˆ MQH (A). We have
P
P 
qk -th power of |Nrd(xi,1 )|A ;
(1) the contribution of xi,1 to e2ÏQ,+ (HQH (x)) is the d
qk âˆ’
(2) the contribution of xi,1 to e2ÏQH (HQH (x))

(3) the contribution of xi,2 to e

2ÏQ,+ (HQH (x))

(4) the contribution of xi,2 to e

2ÏQH (HQH (x))

k>i

k<i

k>i

k<i

k>i

k<i

k>i

k<i

P
P 
pk -th power of |Nrd(xi,1 )|A ;
pk âˆ’
is the d

P
P 
pk -th power of |Nrd(xi,2 )|A ;
is the d
pk âˆ’

P
P 
qk -th power of |Nrd(xi,2 )|A .
is the d
qk âˆ’


P
P
In sum, the contribution of xi to e(2ÏQ,+ âˆ’2ÏQH )(HQH (x)) is the product of the d
(pk âˆ’qk )+ (qk âˆ’pk ) k>i
k<i

P
P
(pk âˆ’ qk ) -th power of |Nrd(xi,2 )|A .
th power of |Nrd(xi,1 )|A and the d
(qk âˆ’ pk ) +
k<i

k>i

)Nrd(xi,2 )|A = |Nrd(x
Now let x âˆˆ MQH (A) âˆ© MQ (A)1 . Then |Nrd(x
i )|A = 1. Therefore, the
i,1
P
P
(2ÏQ,+ âˆ’2ÏQH )(HQH (x))
contribution of xi to e
is the 2d
(pk âˆ’qk )+ (qk âˆ’pk ) -th power of |Nrd(xi,1 )|A .
k<i

k>i

We have proved the first statement.
The second statement is nothing but a special case of the first one, since we have pk = qk for 1 â‰¤ k â‰¤ l
in this case.


Theorem 5.8. Let T â€² be sufficiently regular, o âˆˆ O and f âˆˆ S(s(A)). Then for all sufficiently regular
T and s âˆˆ C, we have
X
â€² G
â€²
Î·
JoG,T (Î·, s, f ) =
pQ,s (TQ âˆ’ TQâ€² )e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )((T )Q ) JoQ,T (Î·, {sQ
i + s}, fQ ),
e0 âŠ†Q}
{Q:P

â€²
G
G
where we write (T â€² )G
Q for the projection of TQ âˆˆ aQ in aQ via the decomposition aQ = aQ âŠ• aG , the
â€²

Î·
distributions JoG,T and JoQ,T are defined by the formulae (5.0.1) and (5.1.2) respectively, and fQ
and
pQ,s are defined by the formulae (5.1.3) and (5.3.1) respectively.

Corollary 5.9. Let o âˆˆ O, f âˆˆ S(s(A)) and s âˆˆ C. Then the functions T 7â†’ JoG,T (Î·, s, f ) and
T 7â†’ J G,T (Î·, s, f ) are the restriction of exponential polynomials in T , so we can extend them to all
T âˆˆ a0 . When p = q = n and s = 0, their purely polynomial terms have degree â‰¤ n âˆ’ 1; in particular, if
o âˆˆ OÃ— (e.g., o âˆˆ Ors ), T 7â†’ JoG,T (Î·, 0, f ) is the restriction of a polynomial in T of degree â‰¤ n âˆ’ 1.
Proof of Corollary 5.9. It results from Theorem 5.8, Propositions 5.6 and 5.4.



Remark 5.10. We may extend our result to the product form in Section 5.1 by similar argument. Let Q
be a relatively standard parabolic subgroup of G. Let o âˆˆ O, f â€² âˆˆ S((mQ âˆ© s)(A)) and {si }1â‰¤iâ‰¤l âˆˆ Cl .
Then the functions JoQ,T (Î·, {si }, f â€² ) and J Q,T (Î·, {si }, f â€² ) are the restriction of exponential polynomials
in T independent of TQ , so we can extend them to all T âˆˆ a0 .
27

Proof of Theorem 5.8. Let P be a relatively standard parabolic subgroup of G, Î´ âˆˆ PH (F )\H(F ) and
x âˆˆ H(A) âˆ© G(A)1 . Substituting T1 = HP (Î´x) âˆ’ TPâ€² and T2 = TP âˆ’ TPâ€² in the definition of Î“P (T1 , T2 ),
we get
X
(âˆ’1)dim(AQ /AG ) Ï„bPQ (HP (Î´x) âˆ’ TPâ€² )Î“Q (HP (Î´x) âˆ’ TPâ€² , TP âˆ’ TPâ€² ).
Ï„bPG (HP (Î´x) âˆ’ TP ) =
{Q:P âŠ†Q}

Then

JoG,T (Î·, s, f ) =

Z

H(F )\H(A)âˆ©G(A)1

ï£«
ï£­

X

(âˆ’1)dim(AP /AG )

Î´âˆˆPH (F )\H(F )

e0 âŠ†P }
{P :P
s
Î·(Nrd(x))|Nrd(x1 )|A dx

=

Â·
Z

H(F )\H(A)âˆ©G(A)1

ï£«
ï£­

X

{Q:P âŠ†Q}

X

X

Ï„bPG (HP (Î´x) âˆ’ TP ) Â· kf,P,o (Î´x)ï£¸

X

(âˆ’1)dim(AP /AG )

e0 âŠ†P }
{P :P

ï£¶

Î´âˆˆPH (F )\H(F )

ï£¶

(âˆ’1)dim(AQ /AG ) Ï„bPQ (HP (Î´x) âˆ’ TPâ€² )Î“Q (HP (Î´x) âˆ’ TPâ€² , TP âˆ’ TPâ€² )ï£¸ kf,P,o (Î´x)

Â· Î·(Nrd(x))|Nrd(x1 )|sA dx.

Exchanging the order of two sums over P and Q, and decomposing the sum over PH (F )\H(F ) into two
sums over PH (F )\QH (F ) and QH (F )\H(F ), we have
X
X
X
X Z
(âˆ’1)dim(AP /AQ )
JoG,T (Î·, s, f ) =
H(F )\H(A)âˆ©G(A)1

e0 âŠ†Q}
{Q:P

e0 âŠ†P âŠ†Q}
{P :P

Î´ â€² âˆˆQH (F )\H(F ) Î´âˆˆPH (F )\QH (F )

Ï„bPQ (HP (Î´Î´ â€² x) âˆ’ TPâ€² )Î“Q (HP (Î´Î´ â€² x) âˆ’ TPâ€² , TP âˆ’ TPâ€² )kf,P,o (Î´Î´ â€² x)Î·(Nrd(x))|Nrd(x1 )|sA dx.

Combining the integral over H(F )\H(A) âˆ© G(A)1 and the sum over QH (F )\H(F ) into an integral over
QH (F )\H(A) âˆ© G(A)1 , and using the fact that
PH (F )\QH (F ) â‰ƒ (PH (F ) âˆ© MQH (F ))\MQH (F ),
we obtain
JoG,T (Î·, s, f ) =

X

e0 âŠ†Q}
{Q:P

Z

QH (F )\H(A)âˆ©G(A)1

Ï„bPQ (HP (Î´x)

X

X

(âˆ’1)dim(AP /AQ )

e0 âŠ†P âŠ†Q}
{P :P

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

âˆ’ TPâ€² )Î“Q (HP (Î´x) âˆ’ TPâ€² , TP âˆ’ TPâ€² )kf,P,o (Î´x)Î·(Nrd(x))|Nrd(x1 )|sA dx.

By Iwasawa decomposition and our choices of measures, the integral over QH (F )\H(A) âˆ© G(A)1 can
be decomposed as integrals over
Ã— MQH (F )\MQH (A) âˆ© MQ (A)1 Ã— KH .
(n, a, m, k) âˆˆ NQH (F )\NQH (A) Ã— AG,âˆž
Q
Then
JoG,T (Î·, s, f )

=

X

e0 âŠ†Q}
{Q:P

Z

KH

Z

X

MQH (F )\MQH (A)âˆ©MQ (A)1

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

Z

AG,âˆž
Q

Ï„bPQ (HP (Î´namk)

Z

NQH (F )\NQH (A)

X

(âˆ’1)dim(AP /AQ )

e0 âŠ†P âŠ†Q}
{P :P

âˆ’ TPâ€² )Î“Q (HP (Î´namk) âˆ’ TPâ€² , TP âˆ’ TPâ€² )

Â· kf,P,o (Î´namk)Î·(Nrd(mk))|Nrd(a1 m1 )|sA eâˆ’2ÏQH (HQH (am)) dndadmdk.
Notice that

and that

Ï„bPQ (HP (Î´namk) âˆ’ TPâ€² ) = Ï„bPQ (HP (Î´m) + HP (a) âˆ’ TPâ€² ) = Ï„bPQ (HP (Î´m) âˆ’ TPâ€² ),

Î“Q (HP (Î´namk) âˆ’ TPâ€² , TP âˆ’ TPâ€² ) = Î“Q (HQ (Î´namk) âˆ’ TQâ€² , TQ âˆ’ TQâ€² ) = Î“Q (HQ (a) âˆ’ TQâ€² , TQ âˆ’ TQâ€² ).
28

In addition, by change of variables, we see that
X

kf,P,o (Î´namk) =

XâˆˆmP (F )âˆ©o

X

=

XâˆˆmP (F )âˆ©o

X

=

XâˆˆmP (F )âˆ©o

Z

f ((Î´namk)âˆ’1 (X + U )Î´namk)dU

(nP âˆ©s)(A)

Z

f ((Î´aâˆ’1 namk)âˆ’1 (X + aâˆ’1 U a)Î´aâˆ’1 namk)dU

(nP âˆ©s)(A)

Z

f ((Î´aâˆ’1 namk)âˆ’1 (X + U )Î´aâˆ’1 namk)e2ÏQ,+ (HQ (a)) dU

(nP âˆ©s)(A)

= e2ÏQ,+ (HQ (a)) kf,P,o (Î´aâˆ’1 namk).
Since Î´aâˆ’1 naÎ´ âˆ’1 âˆˆ NQH (A) âŠ† NPH (A) and kf,P,o is left invariant by NPH (A), we deduce that
kf,P,o (Î´namk) = e2ÏQ,+ (HQ (a)) kf,P,o (Î´mk).
In sum, the integrand for the term indexed by Q in the above formula for JoG,T (Î·, s, f ) is independent
of n âˆˆ NQH (F )\NQH (A). We can choose the Haar measure such that vol(NQH (F )\NQH (A)) = 1. Then
JoG,T (Î·, s, f ) =

X

e0 âŠ†Q}
{Q:P

Z

Z

AG,âˆž
Q

|Nrd(a1 )|sA e(2ÏQ,+ âˆ’2ÏQH )(HQ (a)) Î“Q (HQ (a) âˆ’ TQâ€² , TQ âˆ’ TQâ€² )da

MQH (F )\MQH (A)âˆ©MQ (A)1

Ï„bPQ (HP (Î´m) âˆ’ TPâ€² )

Z

KH

X

(âˆ’1)dim(AP /AQ )

e0 âŠ†P âŠ†Q}
{P :P



!

X

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

kf,P,o (Î´mk)Î·(Nrd(k))dk Î·(Nrd(m))|Nrd(m1 )|sA eâˆ’2ÏQH (HQH (m)) dm.

By the definition of the Haar measure on AG,âˆž
, we have
Q
Z

AG,âˆž
Q

:=

Z

aG
Q

=e

|Nrd(a1 )|sA e(2ÏQ,+ âˆ’2ÏQH )(HQ (a)) Î“Q (HQ (a) âˆ’ TQâ€² , TQ âˆ’ TQâ€² )da

e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(T1 ) Î“Q (T1 âˆ’ TQâ€² , TQ âˆ’ TQâ€² )dT1

(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )((T â€² )G
Q)

Z

aG
Q

=e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )((T

â€² G
)Q )

e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(T1 ) Î“Q (T1 , TQ âˆ’ TQâ€² )dT1

pQ,s (TQ âˆ’ TQâ€² ).

Since nP = nQ
P âŠ• nQ , by change of variables, we see that
kf,P,o (Î´mk) =

X

XâˆˆmP (F )âˆ©o

Z

(nQ
P âˆ©s)(A)

= e2ÏQ,+ (HQH (m))

dU

X

Z

f ((Î´mk)âˆ’1 (X + U + V )Î´mk)dV

(nQ âˆ©s)(A)

XâˆˆmP (F )âˆ©o

Z

(nQ
P âˆ©s)(A)

so we can write
Z
kf,P,o (Î´mk)Î·(Nrd(k))dk = e2ÏQ,+ (HQH (m))
KH

= e2ÏQ,+ (HQH (m))

dU

Z

f (k âˆ’1 ((Î´m)âˆ’1 (X + U )Î´m + V )k)dV,
(nQ âˆ©s)(A)

X

XâˆˆmP (F )âˆ©o
t
X

j=1
29

M

Z

(nQ
P âˆ©s)(A)

kf Î·Q,P âˆ©MQ ,oj (Î´m)
Q

Î·
fQ
((Î´m)âˆ’1 (X + U )Î´m)dU

by (5.1.1). Now we can draw our conclusion by noting that
t Z
X
X
â€²
Î·
JoQ,T (Î·, {sQ
+
s},
f
)
=
i
Q
MQH (F )\MQH (A)âˆ©MQ (A)1

j=1

X

e0 âŠ†P âŠ†Q}
{P :P
M

Î´âˆˆ((P âˆ©MQ )(F )âˆ©MQH (F ))\MQH (F )
M

(âˆ’1)dim(AP âˆ©MQ /AMQ )

Q
Ï„bP âˆ©M
(HP âˆ©MQ (Î´m) âˆ’ (Ï‚Q T â€² )P âˆ©MQ )
Q

Â· kf Î·Q,P âˆ©MQ ,oj (Î´m)Î·(Nrd(m))|Nrd(m1 )|sA e(2ÏQ,+ âˆ’2ÏQH )(HQH (m)) dm
Z Q
X
X
(âˆ’1)dim(AP /AQ )
=
MQH (F )\MQH (A)âˆ©MQ (A)1

ï£«

Ï„bPQ (HP (Î´m) âˆ’ TPâ€² ) ï£­

t
X
j=1

e0 âŠ†P âŠ†Q}
{P :P

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

ï£¶

M
kf Î·Q,P âˆ©MQ ,oj (Î´m)ï£¸ Î·(Nrd(m))|Nrd(m1 )|sA
Q

Â· e(2ÏQ,+ âˆ’2ÏQH )(HQH (m)) dm.


5.5. Independence of constant terms. Let JoG (Î·, s, f ) and J G (Î·, s, f ) be the constant terms of
JoG,T (Î·, s, f ) and J G,T (Î·, s, f ) respectively. We fix a common minimal Levi subgroup M0 of H and
G.
Firstly, the distributions JoG (Î·, s, f ) and J G (Î·, s, f ) are independent of the choice of the relatively
standard minimal parabolic subgroup P0 of G at the very beginning of last section. In fact, let P0â€² be
another relatively standard minimal parabolic subgroup of G and Ïƒ âˆˆ â„¦G such that P0â€² = ÏƒP0 . Denote
G
â€²
by JPG,T
â€² ,o (Î·, s, f ) and JP â€² ,o (Î·, s, f ) the distributions obtained starting from P0 . Then if T âˆˆ aP â€² , we have
0
0

0

âˆ’1

JPG,T
(Î·, s, f ) = JoG,Ïƒ T (Î·, s, f ), so JPGâ€² ,o (Î·, s, f ) = JoG (Î·, s, f ).
â€²
0
0 ,o
Secondly, the distributions JoG (Î·, s, f ) and J G (Î·, s, f ) are independent of the choice of the minimal
parabolic subgroup Pe0 of H. In fact, let Pe0â€² be another minimal parabolic subgroup of H and Ïƒ âˆˆ â„¦H
G
such that Pe0â€² = Ïƒ âˆ’1 Pe0 . Put P0â€² := Ïƒ âˆ’1 P0 . Denote by JPG,T
eâ€² ,o (Î·, s, f ) the distributions
eâ€² ,o (Î·, s, f ) and JP
0

0

obtained starting from Pe0â€² and P0â€² . We can apply the argument of [5, Proposition 4.6] after some minor
âˆ’1
T
(Î·, s, f ), so JoG (Î·, s, f ) = JPG
modifications here to prove that JoG,T (Î·, s, f ) = J G,Ïƒ
eâ€² ,o (Î·, s, f ).
eâ€²
P0 ,o

0

6. Non-equivariance
Let Q be a relatively standard parabolic subgroup of G, s âˆˆ R and y âˆˆ H(A)âˆ©G(A)1 . For f âˆˆ S(s(A)),
Î·
define fQ,s,y
âˆˆ S((mQ âˆ© s)(A)) by
Z
Z
Î·
(6.0.1)
fQ,s,y (X) :=
f (k âˆ’1 (X + V )k)Î·(Nrd(k))pQ,s (âˆ’HQ (ky))dV dk
KH

(nQ âˆ©s)(A)

for all X âˆˆ (mQ âˆ© s)(A), where pQ,s is defined by the formula (5.3.1).
Proposition 6.1. For f âˆˆ S(s(A)) and y âˆˆ H(A) âˆ© G(A)1 , we denote f y (x) := f (yxy âˆ’1 ). Then for all
sufficiently regular T , o âˆˆ O and s âˆˆ R, we have
X
G
Î·
JoG,T (Î·, s, f y ) = Î·(Nrd(y))|Nrd(y1 )|sA
e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(TQ ) JoQ,T (Î·, {sQ
i + s}, fQ,s,y ),
e0 âŠ†Q}
{Q:P

l
where JoG,T and JoQ,T are defined by the formulae (5.0.1) and (5.1.2) respectively, {sQ
i }1â‰¤iâ‰¤l âˆˆ Z are
G
G
the explicit constants determined by (5.4.1), and we write TQ for the projection of TQ âˆˆ aQ in aQ via
the decomposition aQ = aG
Q âŠ• aG .

For o âˆˆ O and f âˆˆ S(s(A)) (resp. f â€² âˆˆ S((mQ âˆ© s)(A))), thanks to Corollary 5.9 (resp. Remark 5.10),
we may take the constant term JoG (Î·, s, f ) of JoG,T (Î·, s, f ) (resp. JoQ (Î·, {si }, f â€² ) of JoQ,T (Î·, {si }, f â€² )) for
s âˆˆ C (resp. {si }1â‰¤iâ‰¤l âˆˆ Cl ). When s = 0 (resp. si = 0 for all 1 â‰¤ i â‰¤ l), denote JoG (Î·, f ) := JoG (Î·, 0, f )
(resp. JoQ (Î·, f â€² ) := JoQ (Î·, {0}, f â€²)).
30

Corollary 6.2. Assume that p = q = n. Let f âˆˆ S(s(A)), y âˆˆ H(A) âˆ© G(A)1 and o âˆˆ O. We have
X
Î·
JoG (Î·, f y ) = Î·(Nrd(y))
JoQ (Î·, fQ,0,y
).
e0 âŠ†Q,Ï‰QÏ‰ âˆ’1 =Q}
{Q:P

Proof of Corollary 6.2. We apply Proposition 6.1 to the case s = 0 and consider the constant terms of
both sides. Because JoQ,T is independent of TQ , by Lemma 5.5, only Ï‰-stable Q contribute to the purely

polynomial term. Then we apply Proposition 5.7 to the case p = q = n to conclude.
Proof of Proposition 6.1. By definition,
ï£«
Z
X
ï£­
JoG,T (Î·, s, f y ) =

(âˆ’1)dim(AP /AG )

H(F )\H(A)âˆ©G(A)1

Â·

e0 âŠ†P }
{P :P
s
Î·(Nrd(x))|Nrd(x1 )|A dx,

where

X

kf y ,P,o (Î´x) =

XâˆˆmP (F )âˆ©o

H(F )\H(A)âˆ©G(A)1

Â·

Î´âˆˆPH (F )\H(F )

Z

By change of variables, we have
ï£«
Z
ï£­
JoG,T (Î·, s, f y ) =

X

ï£¶

Ï„bPG (HP (Î´x) âˆ’ TP ) Â· kf y ,P,o (Î´x)ï£¸

f (y(Î´x)âˆ’1 (X + U )Î´xy âˆ’1 )dU = kf,P,o (Î´xy âˆ’1 ).

(nP âˆ©s)(A)

X

(âˆ’1)dim(AP /AG )

e0 âŠ†P }
{P :P
Î·(Nrd(xy))|Nrd(x1 y1 )|sA dx.

X

Î´âˆˆPH (F )\H(F )

ï£¶

Ï„bPG (HP (Î´xy) âˆ’ TP ) Â· kf,P,o (Î´x)ï£¸

For x âˆˆ H(A) and P a relatively standard parabolic subgroup of G, let kP (x) be an element in KH
such that xkP (x)âˆ’1 âˆˆ PH (A). Then
Ï„bPG (HP (Î´xy) âˆ’ TP ) = Ï„bPG (HP (Î´x) âˆ’ TP + HP (kP (Î´x)y)).

Substituting T1 = HP (Î´x) âˆ’ TP and T2 = âˆ’HP (kP (Î´x)y) in the definition of Î“P (T1 , T2 ), we get
X
(âˆ’1)dim(AQ /AG ) Ï„bPQ (HP (Î´x) âˆ’ TP )Î“Q (HP (Î´x) âˆ’ TP , âˆ’HP (kP (Î´x)y)).
Ï„bPG (HP (Î´xy) âˆ’ TP ) =
{Q:P âŠ†Q}

Thus

JoG,T (Î·, s, f y ) =

Z

H(F )\H(A)âˆ©G(A)1

ï£«
ï£­

X

{Q:P âŠ†Q}

X

(âˆ’1)dim(AP /AG )

e0 âŠ†P }
{P :P

X

Î´âˆˆPH (F )\H(F )

ï£¶

(âˆ’1)dim(AQ /AG ) Ï„bPQ (HP (Î´x) âˆ’ TP )Î“Q (HP (Î´x) âˆ’ TP , âˆ’HP (kP (Î´x)y))ï£¸

Â· kf,P,o (Î´x)Î·(Nrd(xy))|Nrd(x1 y1 )|sA dx,

Exchanging the order of two sums over P and Q, and decomposing the sum over PH (F )\H(F ) into two
sums over PH (F )\QH (F ) and QH (F )\H(F ), we obtain
X
X
X
X Z
(âˆ’1)dim(AP /AQ )
JoG,T (Î·, s, f y ) =
e0 âŠ†Q}
{Q:P

H(F )\H(A)âˆ©G(A)1

e0 âŠ†P âŠ†Q}
{P :P

Ï„bPQ (HP (Î´Î´ â€² x) âˆ’ TP )Î“Q (HP (Î´Î´ â€² x)
Â· |Nrd(x1 y1 )|sA dx.

Î´ â€² âˆˆQH (F )\H(F ) Î´âˆˆPH (F )\QH (F )

âˆ’ TP , âˆ’HP (kP (Î´Î´ â€² x)y))kf,P,o (Î´Î´ â€² x)Î·(Nrd(xy))

Combining the integral over H(F )\H(A) âˆ© G(A)1 and the sum over QH (F )\H(F ) into the integral over
QH (F )\H(A) âˆ© G(A)1 , and using the fact that
PH (F )\QH (F ) â‰ƒ (PH (F ) âˆ© MQH (F ))\MQH (F ),
we have
JoG,T (Î·, s, f y ) =

X

e0 âŠ†Q}
{Q:P

Z

QH (F )\H(A)âˆ©G(A)1

Ï„bPQ (HP (Î´x)

X

e0 âŠ†P âŠ†Q}
{P :P

(âˆ’1)dim(AP /AQ )

X

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

âˆ’ TP )Î“Q (HP (Î´x) âˆ’ TP , âˆ’HP (kP (Î´x)y))kf,P,o (Î´x)Î·(Nrd(xy))|Nrd(x1 y1 )|sA dx.
31

By Iwasawa decomposition and our choices of measures, the integral over QH (F )\H(A) âˆ© G(A)1 can
be decomposed as integrals over
Ã— MQH (F )\MQH (A) âˆ© MQ (A)1 Ã— KH .
(n, a, m, k) âˆˆ NQH (F )\NQH (A) Ã— AG,âˆž
Q
Then
X

JoG,T (Î·, s, f y ) =

e0 âŠ†Q}
{Q:P

Z

KH

Z

MQH (F )\MQH (A)âˆ©MQ

X

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

(A)1

Z

AG,âˆž
Q

Z

NQH (F )\NQH (A)

X

(âˆ’1)dim(AP /AQ )

e0 âŠ†P âŠ†Q}
{P :P

Ï„bPQ (HP (Î´namk) âˆ’ TP )Î“Q (HP (Î´namk) âˆ’ TP , âˆ’HP (kP (Î´namk)y))

Â· kf,P,o (Î´namk)Î·(Nrd(mky))|Nrd(a1 m1 y1 )|sA eâˆ’2ÏQH (HQH (am)) dndadmdk.
As in the proof of Theorem 5.8, we see that
Ï„bPQ (HP (Î´namk) âˆ’ TP ) = Ï„bPQ (HP (Î´m) âˆ’ TP ),

and that

kf,P,o (Î´namk) = e2ÏQ,+ (HQ (a)) kf,P,o (Î´mk).
In addition,
Î“Q (HP (Î´namk) âˆ’ TP , âˆ’HP (kP (Î´namk)y)) = Î“Q (HQ (Î´namk) âˆ’ TQ , âˆ’HQ (kP (Î´namk)y))
= Î“Q (HQ (a) âˆ’ TQ , âˆ’HQ (kQ (Î´namk)y))
= Î“Q (HQ (a) âˆ’ TQ , âˆ’HQ (ky)).
To sum up, the integrand for the term indexed by Q in the above formula for JoG,T (Î·, s, f y ) is independent
of n âˆˆ NQH (F )\NQH (A). We can choose the Haar measure such that vol(NQH (F )\NQH (A)) = 1. Then
Z
Z
X Z
X
JoG,T (Î·, s, f y ) =
(âˆ’1)dim(AP /AQ )
e0 âŠ†Q}
{Q:P

KH

MQH (F )\MQH (A)âˆ©MQ (A)1

X

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

AG,âˆž
Q

e0 âŠ†P âŠ†Q}
{P :P

Ï„bPQ (HP (Î´m) âˆ’ TP )Î“Q (HQ (a) âˆ’ TQ , âˆ’HQ (ky))

Â· e2ÏQ,+ (HQ (a)) kf,P,o (Î´mk)Î·(Nrd(mky))|Nrd(a1 m1 y1 )|sA eâˆ’2ÏQH (HQH (am)) dadmdk.
First, let us compute the integral on AG,âˆž
, which is
Q
Z

AG,âˆž
Q

:=

Z

aG
Q

=e

|Nrd(a1 )|sA e(2ÏQ,+ âˆ’2ÏQH )(HQ (a)) Î“Q (HQ (a) âˆ’ TQ , âˆ’HQ (ky))da

e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(T1 ) Î“Q (T1 âˆ’ TQ , âˆ’HQ (ky))dT1

G
(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(TQ
)

Z

aG
Q

e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(T1 ) Î“Q (T1 , âˆ’HQ (ky))dT1

G

=e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(TQ ) pQ,s (âˆ’HQ (ky)).
Next, we consider the integral on KH , which is
Z
kf,P,o (Î´mk)Î·(Nrd(k))pQ,s (âˆ’HQ (ky))dk.
KH

As in the proof of Theorem 5.8, we see that
Z
X
kf,P,o (Î´mk) = e2ÏQ,+ (HQH (m))
XâˆˆmP (F )âˆ©o

(nQ
P âˆ©s)(A)

dU

32

Z

f (k âˆ’1 ((Î´m)âˆ’1 (X + U )Î´m + V )k)dV,
(nQ âˆ©s)(A)

so we can write

Z

kf,P,o (Î´mk)Î·(Nrd(k))pQ,s (âˆ’HQ (ky))dk
Z
X
Î·
=e2ÏQ,+ (HQH (m))
fQ,s,y
((Î´m)âˆ’1 (X + U )Î´m)dU
KH

XâˆˆmP (F )âˆ©o

=e2ÏQ,+ (HQH (m))

t
X

(nQ
P âˆ©s)(A)

M

kf Î·Q

j=1

Q,s,y ,P âˆ©MQ ,oj

(Î´m)

by (5.1.1). Hence
X

JoG,T (Î·, s, f y ) =Î·(Nrd(y))|Nrd(y1 )|sA

ï£­

t
X

M

kf Î·Q

Q,s,y ,P âˆ©MQ ,oj

j=1

X

(âˆ’1)dim(AP /AQ )
ï£¶

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

Ï„bPQ (HP (Î´m) âˆ’ TP )

(Î´m)ï£¸ Î·(Nrd(m))|Nrd(m1 )|sA e(2ÏQ,+ âˆ’2ÏQH )(HQH (m)) dm.

As in the proof of Theorem 5.8, we notice that
Z
Î·
JoQ,T (Î·, {sQ
+
s},
f
)
=
i
Q,s,y

MQH (F )\MQH (A)âˆ©MQ (A)1

P

j=1

(2ÏQ,+ âˆ’2ÏQH )(HQH (m))

X

(âˆ’1)dim(AP /AQ )

e0 âŠ†P âŠ†Q}
{P :P

ï£«
t
X
M
Ï„bQ (HP (Î´m) âˆ’ TP ) ï£­
k Î·Q
Â·e

Z

MQH (F )\MQH (A)âˆ©MQ (A)1

e0 âŠ†Q}
{Q:P

X

e0 âŠ†P âŠ†Q}
{P :P

ï£«

G

e(2ÏQ,+ âˆ’2ÏQH +sÎ£1 )(TQ )

fQ,s,y ,P âˆ©MQ ,oj

dm.

ï£¶

X

Î´âˆˆ(PH (F )âˆ©MQH (F ))\MQH (F )

(Î´m)ï£¸ Î·(Nrd(m))|Nrd(m1 )|sA

Then we finish the proof.



7. An infinitesimal trace formula for MatpÃ—q,D âŠ• MatqÃ—p,D //GLp,D Ã— GLq,D
Theorem 7.1. For f âˆˆ S(s(A)) and s âˆˆ R,
X
X
JoG (Î·, s, f ) =
JoG (Î·, s, fË†),
oâˆˆO

oâˆˆO

where fË† is the Fourier transform of f defined by (3.5.2), and JoG (Î·, s, Â·) denotes the constant term of
JoG,T (Î·, s, Â·).
Proof. From the Poisson summation formula, we know that for any x âˆˆ H(A),
X
X
fË†(xâˆ’1 Xx),
f (xâˆ’1 Xx) =
Xâˆˆs(F )

Xâˆˆs(F )

i.e.,
kf,G (x) = kfË†,G (x).
Using Corollary 4.16, for all sufficiently regular T satisfying Î±(T ) â‰¥ Ç«0 k T k for any Î± âˆˆ âˆ†P0 , we
have
Z
G,T
F G (x, T )kf,G (x)Î·(Nrd(x))|Nrd(x1 )|sA dx â‰¤ C1 eâˆ’N kT k
J
(Î·, s, f ) âˆ’
H(F )\H(A)âˆ©G(A)1

and
J G,T (Î·, s, fË†) âˆ’

Z

H(F )\H(A)âˆ©G(A)1

F G (x, T )kfË†,G (x)Î·(Nrd(x))|Nrd(x1 )|sA dx â‰¤ C2 eâˆ’N kT k .

Thus
|J G,T (Î·, s, f ) âˆ’ J G,T (Î·, s, fË†)| â‰¤ (C1 + C2 )eâˆ’N kT k .
33

By Corollary 5.9, we know that both of J G,T (Î·, s, f ) and J G,T (Î·, s, fË†) are exponential polynomials in
T . Because we can choose N to be large enough, we deduce that
J G,T (Î·, s, f ) = J G,T (Î·, s, fË†).
Since

X

J G,T (Î·, s, f ) =

JoG,T (Î·, s, f )

oâˆˆO

and

J G,T (Î·, s, fË†) =

X

JoG,T (Î·, s, fË†),

oâˆˆO

we obtain

X

X

JoG,T (Î·, s, f ) =

oâˆˆO

JoG,T (Î·, s, fË†).

oâˆˆO

We may conclude by taking the constant terms of both sides.



8. The second modified kernel
In this section and the next, we shall focus on the case where p = q = n in order to get better
description for distributions associated to regular semi-simple orbits. We shall change our notation by
denoting G := GL2n,D and H := GLn,D Ã— GLn,D without further mention.
Let f âˆˆ S(s(A)), P be a relatively standard parabolic subgroup of G and o âˆˆ Ors (see Section 3.3).
For x âˆˆ PH (F )\H(A), define
X
X
f ((nx)âˆ’1 Xnx).
jf,P,o (x) :=
XâˆˆmP (F )âˆ©o nâˆˆNPH (F )

Let T âˆˆ a0 . For x âˆˆ H(F )\H(A), define
X
T
jf,o
(x) :=
(âˆ’1)dim(AP /AG )
e0 âŠ†P }
{P :P

X

Î´âˆˆPH (F )\H(F )

Ï„bPG (HP (Î´x) âˆ’ TP ) Â· jf,P,o (Î´x).

By Lemma 4.2, we know that the sum over Î´ âˆˆ PH (F )\H(F ) is finite. Recall that since o âˆˆ Ors âŠ† OÃ— ,
if mP (F ) âˆ© o 6= âˆ…, then P is Ï‰-stable by Proposition 5.4. Thus the above definitions only involve the
relatively standard parabolic subgroups that are Ï‰-stable.
Lemma 8.1. Let P be a relatively standard parabolic subgroup of G and o âˆˆ Ors . For X âˆˆ mP (F ) âˆ© o,
the map
NPH â†’ nP âˆ© s, n 7â†’ nâˆ’1 Xn âˆ’ X
is an F -isomorphism of algebraic varieties and preserves the Haar measures on A-points.
Proof. Since P is relatively standard and Ï‰-stable, we can suppose
Ã—

pn,D pn,D
,
P =
pn,D pn,D
where

ï£«

Then we have
mP âˆ© s =
Let



ï£¬
ï£¬
Pn,D = ï£¬
ï£­

GLn1 ,D

mPn,D

mPn,D

Matn1 Ã—n2 ,D
GLn2 ,D

Â·Â·Â·
Â·Â·Â·
..
.

Matn1 Ã—nl ,D
Matn2 Ã—nl ,D
..
.
GLnl ,D



, NPH =

ï£«

ï£¬
ï£¬
ï£¬
ï£¬
X=ï£¬
ï£¬ B1
ï£¬
ï£¬
ï£­


NPn,D

NPn,D

A1
..

..

.
Bl
34

.



ï£¶

, nP âˆ© s =

ï£¶

ï£·
ï£·
ï£·.
ï£¸



nPn,D

ï£·
ï£·
ï£·
Al ï£·
ï£· âˆˆ mP (F ) âˆ© o,
ï£·
ï£·
ï£·
ï£¸

nPn,D



.

where Ai , Bi âˆˆ GLni (D) for 1 â‰¤ i â‰¤ l,
ï£«
1 C12
ï£¬
1
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
n=ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£­

and
Â·Â·Â·
Â·Â·Â·
..
.

ï£¶

C1l
C2l
..
.
1
1

D1l
D2l
..
.
1

where Cij , Dij âˆˆ Matni Ã—nj ,D for 1 â‰¤ i < j â‰¤ l. Then
ï£«
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
ï£¬
Xnâˆ’nX = ï£¬
ï£¬ 0 B1 C12 âˆ’ D12 B2
ï£¬
ï£¬
0
ï£¬
ï£¬
ï£­

Â·Â·Â·
Â·Â·Â·
..
.

D12
1

0

ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£· âˆˆ NPH ,
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸

A1 D12 âˆ’ C12 A2
0

Â·Â·Â·
Â·Â·Â·
..
.

A1 D1l âˆ’ C1l Al
A2 D2l âˆ’ C2l Al
..
.
0

Â·Â·Â·
Â·Â·Â·
..
.

B1 C1l âˆ’ D1l Bl
B2 C2l âˆ’ D2l Bl
..
.
0

We claim that the morphism of F -affine spaces

ï£¶

ï£·
ï£·
ï£·
ï£·
ï£·
ï£·
ï£· âˆˆ nP âˆ©s.
ï£·
ï£·
ï£·
ï£·
ï£·
ï£¸

Matni Ã—nj ,D âŠ• Matni Ã—nj ,D â†’ Matni Ã—nj ,D âŠ• Matni Ã—nj ,D
(Cij , Dij ) 7â†’ (Ai Dij âˆ’ Cij Aj , Bi Cij âˆ’ Dij Bj )
induces an F -linear isomorphism on F -points. In fact, since it gives an F -linear map between finite
dimensional linear spaces of the same dimension, we only need to prove that this map is injective under
base change to an algebraic closure of F . Then without loss of generality, it suffices to consider the
case where D = F . If Ai Dij âˆ’ Cij Aj = Bi Cij âˆ’ Dij Bj = 0, then Cij Aj Bj = Ai Dij Bj = Ai Bi Cij
and Dij Bj Aj = Bi Cij Aj = Bi Ai Dij . Since X is regular semi-simple, Ai Bi and Aj Bj (resp. Bi Ai and
Bj Aj ) have no common eigenvalue. By the classical theory of Sylvester equation [19], we know that
Cij = Dij = 0 and conclude.
From this claim, we know that the map
NPH â†’ nP âˆ© s, n 7â†’ Xn âˆ’ nX
is an F -isomorphism of algebraic varieties and preserves the Haar measures on A-points. Notice that
nâˆ’1 Xn âˆ’ X = nâˆ’1 (Xn âˆ’ nX). It is not hard to check that here nâˆ’1 functions as some translation
Ai Dij âˆ’ Cij Aj 7â†’ Ai Dij âˆ’ Cij Aj + (a polynomial of Ciâ€² j â€² and Diâ€² j â€² , iâ€² > i, j â€² â‰¤ j or iâ€² â‰¥ i, j â€² < j), so an
analogous assertion still holds for the map n 7â†’ nâˆ’1 Xn âˆ’ X.

Theorem 8.2. For all sufficiently regular T , all s âˆˆ R and o âˆˆ Ors ,
Z
T
|jf,o
(x)||Nrd(x1 )|sA dx < âˆž,
H(F )\H(A)âˆ©G(A)1

where we write x = (x1 , x2 ) âˆˆ GLn,D (A) Ã— GLn,D (A). Moreover, for s âˆˆ C,
Z
G,T
T
Jo (Î·, s, f ) =
jf,o
(x)Î·(Nrd(x))|Nrd(x1 )|sA dx.
H(F )\H(A)âˆ©G(A)1

Proof. As in the proof of Theorem 4.14, using the left invariance of jf,P,o by PH (F ), we reduce ourselves
to proving
Z
Ï‡TP1 ,P2 (x)|jP1 ,P2 ,o (x)||Nrd(x1 )|sA dx < âˆž,
P1,H (F )\H(A)âˆ©G(A)1

where P1 ( P2 are a pair of relatively standard parabolic subgroups of G and for x âˆˆ P1,H (F )\H(A),
we put
X
(âˆ’1)dim(AP /AG ) jf,P,o (x).
jP1 ,P2 ,o (x) :=
{P :P1 âŠ†P âŠ†P2 }

35

In addition,
X

jf,P,o (x) =

X

X

X

f ((nx)âˆ’1 (Î¾ + X)nx),

P
{R:P1 âŠ†RâŠ†P } Î¾âˆˆm
nâˆˆNPH (F )
eR
P (F )âˆ©o Xâˆˆ(nR âˆ©s)(F )
1

P
eR
where we use the notations m
P1 and nR in the proof of Proposition 4.15.
Applying Lemma 8.1, we get

X

jf,P,o (x) =

X

X

X

f (xâˆ’1 (Î¾ + X + u)x)

P
{R:P1 âŠ†RâŠ†P } Î¾âˆˆm
uâˆˆ(nP âˆ©s)(F )
eR
P (F )âˆ©o Xâˆˆ(nR âˆ©s)(F )

=

1

X

X

X

f (xâˆ’1 (Î¾ + X)x).

{R:P1 âŠ†RâŠ†P } Î¾âˆˆm
Xâˆˆ(nR âˆ©s)(F )
eR
P (F )âˆ©o
1

Hence
X

jP1 ,P2 ,o (x) =

ï£«

ï£¬
(âˆ’1)dim(AP /AG ) ï£­

{P :P1 âŠ†P âŠ†P2 }

X

=

X

{R:P1 âŠ†RâŠ†P2 } Î¾âˆˆm
eR
P (F )âˆ©o
1

ï£«

X

X

{R:P1 âŠ†RâŠ†P } Î¾âˆˆm
Xâˆˆ(nR âˆ©s)(F )
eR
P (F )âˆ©o

X

ï£­

X

{P :RâŠ†P âŠ†P2 }

1

ï£¶

(âˆ’1)dim(AP /AG ) ï£¸

X

ï£¶

ï£·
f (xâˆ’1 (Î¾ + X)x)ï£¸
f (xâˆ’1 (Î¾ + X)x).

Xâˆˆ(nR âˆ©s)(F )

By [2, Proposition 1.1], we have
jP1 ,P2 ,o (x) = (âˆ’1)dim(AP2 /AG )

X

X

X

X

P

f (xâˆ’1 (Î¾ + X)x).

e P2 (F )âˆ©o Xâˆˆ(nP2 âˆ©s)(F )
Î¾âˆˆm
1

Applying Lemma 8.1 again, we obtain
jP1 ,P2 ,o (x) = (âˆ’1)dim(AP2 /AG )

2
eP
Î¾âˆˆm
P1 (F )âˆ©o

f ((n2 x)âˆ’1 Î¾n2 x),

n2 âˆˆNP2,H (F )

where we denote P2,H := P2 âˆ© H.
Decomposing the integral over x âˆˆ P1,H (F )\H(A)âˆ©G(A)1 into double integrals n1 âˆˆ NP1,H (F )\NP1,H (A)
and y âˆˆ MP1,H (F )NP1,H (A)\H(A) âˆ© G(A)1 , and using the fact that Ï‡TP1 ,P2 (x) is left invariant under
NP1,H (A), we have
Z

P1,H

=

Z

(F )\H(A)âˆ©G(A)1

Ï‡TP1 ,P2 (x)|jP1 ,P2 ,o (x)||Nrd(x1 )|sA dx

MP1,H (F )NP1,H (A)\H(A)âˆ©G(A)1

X

Â·

â‰¤

Z

P
e P2 (F )âˆ©o
Î¾âˆˆm
1

X

NP1,H (F )\NP1,H (A)

Ï‡TP1 ,P2 (n1 y)

f ((n2 n1 y)âˆ’1 Î¾n2 n1 y) |Nrd(y1 )|sA dn1 dy

n2 âˆˆNP2,H (F )

MP1,H (F )NP1,H (A)\H(A)âˆ©G(A)1

ï£«
Z
ï£­

Z

Ï‡TP1 ,P2 (y)

X

P

e P2 (F )âˆ©o
Î¾âˆˆm
1

X

NP1,H (F )\NP1,H (A) n âˆˆN
2
P2,H (F )

ï£¶

|f ((n2 n1 y)âˆ’1 Î¾n2 n1 y)|dn1 ï£¸ |Nrd(y1 )|sA dy.
36

Since P1,H âŠ† P2,H and vol(NP2,H (F )\NP2,H (A)) = 1, we see that
Z
X
|f ((n2 n1 y)âˆ’1 Î¾n2 n1 y)|dn1
NP1,H (F )\NP1,H (A) n âˆˆN
2
P2,H (F )

=

Z

NP1,H (F )\NP1,H (A)

=

Z

NP1,H (F )\NP1,H (A)

=

Z

NP1,H (F )\NP1,H (A)

Z

X

|f ((n2 nn1 y)âˆ’1 Î¾n2 nn1 y)|dndn1

NP2,H (F )\NP2,H (A) n âˆˆN
2
P2,H (F )

Z

|f ((nn1 y)âˆ’1 Î¾nn1 y)|dndn1

NP2,H (A)

Z

|f ((n1 y)âˆ’1 (Î¾ + U )n1 y)|dU dn1 ,

(nP2 âˆ©s)(A)

where we have applied Lemma 8.1 in the last equality. Therefore
Z
Ï‡TP1 ,P2 (x)|jP1 ,P2 ,o (x)||Nrd(x1 )|sA dx
P1,H (F )\H(A)âˆ©G(A)1

â‰¤

Z

MP1,H (F )NP1,H (A)\H(A)âˆ©G(A)1

=

P

e P2 (F )âˆ©o
Î¾âˆˆm
1

Z

NP1,H (F )\NP1,H (A)

Z

X

Ï‡TP1 ,P2 (y)

P1,H (F )\H(A)âˆ©G(A)1

Z

âˆ’1

|f ((n1 y)

(nP2 âˆ©s)(A)

Ï‡TP1 ,P2 (x)

X

P
e P2 (F )âˆ©o
Î¾âˆˆm
1

!

(Î¾ + U )n1 y)|dU dn1 |Nrd(y1 )|sA dy
Z

|f (xâˆ’1 (Î¾ + U )x)|dU

(nP2 âˆ©s)(A)

!

|Nrd(x1 )|sA dx,

whose convergence results from that of the formula (4.2.3) when R = P2 .
Now we begin to prove the second statement. From the first statement, now we have the right to
write
Z
T
jf,o
(x)Î·(Nrd(x))|Nrd(x1 )|sA dx
1
H(F )\H(A)âˆ©G(A)
Z
X
=
Ï‡TP1 ,P2 (x)jP1 ,P2 ,o (x)Î·(Nrd(x))|Nrd(x1 )|sA dx,
e0 âŠ†P1 âŠ†P2 }
{P1 ,P2 :P

where

P1,H (F )\H(A)âˆ©G(A)1

X

jP1 ,P2 ,o (x) =

(âˆ’1)dim(AP /AG ) jf,P,o (x)

{P :P1 âŠ†P âŠ†P2 }

X

=

{P :P1 âŠ†P âŠ†P2 }

ï£«

(âˆ’1)dim(AP /AG ) ï£­

X

X

XâˆˆmP (F )âˆ©o nâˆˆNPH (F )

1

ï£¶

f ((nx)âˆ’1 Xnx)ï£¸ .

Decompose the integral over x âˆˆ P1,H (F )\H(A)âˆ©G(A) into double integrals over n1 âˆˆ NP1,H (F )\NP1,H (A)
and y âˆˆ MP1,H (F )NP1,H (A)\H(A) âˆ© G(A)1 . Since NP1,H (F )\NP1,H (A) is compact, by Lemma 8.1 and
[21, Â§41],
X
X
X
X
|f ((n1 y)âˆ’1 (X + u)n1 y)|
|f ((nn1 y)âˆ’1 Xnn1 y)| =
XâˆˆmP (F )âˆ©o uâˆˆ(nP âˆ©s)(F )

XâˆˆmP (F )âˆ©o nâˆˆNPH (F )

is bounded independently of n1 âˆˆ NP1,H (F )\NP1,H (A). Then using the fact that Ï‡TP1 ,P2 (x) is left invariant
under NP1,H (A), we have
Z
T
(x)Î·(Nrd(x))|Nrd(x1 )|sA dx
jf,o
H(F )\H(A)âˆ©G(A)1
Z
X
X
(âˆ’1)dim(AP /AG )
=
Ï‡TP1 ,P2 (y)
e0 âŠ†P1 âŠ†P2 }
{P1 ,P2 :P

X

XâˆˆmP (F )âˆ©o

ï£«
Z
ï£­

MP1,H (F )NP1,H (A)\H(A)âˆ©G(A)1

X

NP1,H (F )\NP1,H (A) nâˆˆN

PH (F )

{P :P1 âŠ†P âŠ†P2 }

ï£¶

f ((nn1 y)âˆ’1 Xnn1 y)dn1 ï£¸ Î·(Nrd(y))|Nrd(y1 )|sA dy.
37

Since P1,H âŠ† PH and vol(NPH (F )\NPH (A)) = 1, we see that
Z
X
f ((nn1 y)âˆ’1 Xnn1 y)dn1
=
=
=

Z

Z

Z

NP1,H (F )\NP1,H (A) nâˆˆN
PH (F )

NP1,H (F )\NP1,H (A)

NP1,H (F )\NP1,H (A)

NP1,H (F )\NP1,H (A)

Z

X

f ((nn2 n1 y)âˆ’1 Xnn2 n1 y)dn2 dn1

NPH (F )\NPH (A) nâˆˆN
PH (F )

Z

f ((nn1 y)âˆ’1 Xnn1 y)dndn1

NPH (A)

Z

f ((n1 y)âˆ’1 (X + U )n1 y)dU dn1 ,

(nP âˆ©s)(A)

where we have applied Lemma 8.1 in the last equality. Therefore
Z
T
jf,o
(x)Î·(Nrd(x))|Nrd(x1 )|sA dx
1
H(F )\H(A)âˆ©G(A)
Z
X
X
=
Ï‡TP1 ,P2 (y)
e0 âŠ†P1 âŠ†P2 }
{P1 ,P2 :P

X

XâˆˆmP (F )âˆ©o

=

X

Z

NP1,H (F )\NP1,H (A)

e0 âŠ†P1 âŠ†P2 }
{P1 ,P2 :P

ï£«

=

Â·ï£­

X

XâˆˆmP (F )âˆ©o

X

MP1,H (F )NP1,H

Z

Z

Z

Z

(âˆ’1)dim(AP /AG )

{P :P1 âŠ†P âŠ†P2 }

âˆ’1

f ((n1 y)

(X + U )n1 y)dU dn1

(nP âˆ©s)(A)

P1,H (F )\H(A)âˆ©G(A)1

(nP âˆ©s)(A)

e0 âŠ†P1 âŠ†P2 }
{P1 ,P2 :P

(A)\H(A)âˆ©G(A)1

X

Ï‡TP1 ,P2 (x)

!

Î·(Nrd(y))|Nrd(y1 )|sA dy

(âˆ’1)dim(AP /AG )

{P :P1 âŠ†P âŠ†P2 }

ï£¶

f (xâˆ’1 (X + U )x)dU ï£¸ Î·(Nrd(x))|Nrd(x1 )|sA dx

P1,H (F )\H(A)âˆ©G(A)1

Ï‡TP1 ,P2 (x)kP1 ,P2 ,o (x)Î·(Nrd(x))|Nrd(x1 )|sA dx.

From the proof of Theorem 4.14, we are authorised to write
Z
T
G,T
kf,o
(x)Î·(Nrd(x))|Nrd(x1 )|sA dx
Jo (Î·, s, f ) =
H(F )\H(A)âˆ©G(A)1
Z
X
=
Ï‡TP1 ,P2 (x)kP1 ,P2 ,o (x)Î·(Nrd(x))|Nrd(x1 )|sA dx,
e0 âŠ†P1 âŠ†P2 }
{P1 ,P2 :P

P1,H (F )\H(A)âˆ©G(A)1

which completes the proof.


9. Weighted orbital integrals

As in the last section, we shall assume that p = q = n in the following discussion. Moreover, we shall
suppose that s = 0 in the orbital integral for convenience, since |Nrd(x1 )|sA is not invariant under the
G
translation by Aâˆž
G . Recall that for o âˆˆ O and f âˆˆ S(s(A)), we denote by Jo (Î·, f ) the constant term of
G,T
Jo (Î·, 0, f ).
9.1. Weyl groups. From Section 5.5, we may choose P0 to be the stabiliser in G of the flag
0 ( he1 iD ( he1 , f1 iD ( he1 , f1 , e2 iD ( he1 , f1 , e2 , f2 iD ( Â· Â· Â· ( he1 , f1 Â· Â·Â·, en , fn iD = V âŠ• W
by the notation in Section 3.4. Then all Ï‰-stable relatively standard parabolic subgroups of G contain
P0 . Denote by P0 the stabiliser in G of the flag
0 ( he1 , f1 iD ( he1 , f1 , e2 , f2 iD ( Â· Â· Â· ( he1 , f1 Â· Â·Â·, en , fn iD = V âŠ• W.
It is the minimal Ï‰-stable relatively standard parabolic subgroup of G. A parabolic subgroup P of G
is relatively standard and Ï‰-stable if and only if P0 âŠ† P . Let P0,n be the group of upper triangular
matrices in GLn,D . We can talk about positive roots for G, H and GLn,D with respect to P0 , Pe0 and
P0,n respectively.
38


Ã—

Ã—
p1,n p1,n
p2,n p2,n
Lemma 9.1. Let P1 =
and P2 =
be a pair of Ï‰-stable relatively standard
p1,n p1,n
p2,n p2,n
parabolic subgroups of G, 
where P1,n
 and P2,n are standard parabolic subgroups of GLn,D .
sn
induces a bijection from
1) The map sn 7â†’ s =
sn
P

2,n
a) the set of representatives sn of â„¦GLn,D (aP1,n , aP2,n ) in â„¦GLn,D such that sâˆ’1
n Î± > 0 for all Î± âˆˆ âˆ†P0,n

to
2
b) the set of representatives s of â„¦G (aP1 , aP2 ) in â„¦G such that sâˆ’1 Î± > 0 for all Î± âˆˆ âˆ†P
P0 .


s
2) The map sn 7â†’ s = n
induces a bijection from
sn

a) the set of representatives sn of â„¦GLn,D (aP1,n ; P2,n ) in â„¦GLn,D such that sn (aP1,n ) âŠ‡ aP2,n and
P2,n
sâˆ’1
n Î± > 0 for all Î± âˆˆ âˆ†P0,n
to
b) the set of representatives s of â„¦G (aP1 ; P2 ) in â„¦G such that s(aP1 ) âŠ‡ aP2 and sâˆ’1 Î± > 0 for all
2
Î± âˆˆ âˆ†P
P0 .
Proof. Suppose that P1,n and P2,n correspond to the partitions (n1 , Â· Â· Â·, nl ) and (nâ€²1 , Â· Â· Â·, nâ€²lâ€² ) respectively
of n. Then P1 and P2 correspond to the partitions (2n1 , Â· Â· Â·, 2nl ) and (2nâ€²1 , Â· Â· Â·, 2nâ€²lâ€² ) respectively of 2n.
For an integer m > 0, denote by Sm the symmetric group of degree m.
1) From [4, p. 33], the set â„¦GLn,D (aP1,n , aP2,n ) is empty unless l = lâ€² , in which case
(9.1.1)

â„¦GLn,D (aP1,n , aP2,n ) â‰ƒ {sn âˆˆ Sl : âˆ€1 â‰¤ i â‰¤ l, nâ€²i = nsn (i) }.

Similarly, the set â„¦G (aP1 , aP2 ) is empty unless l = lâ€² , in which case
(9.1.2)

â„¦G (aP1 , aP2 ) â‰ƒ {s âˆˆ Sl : âˆ€1 â‰¤ i â‰¤ l, 2nâ€²i = 2ns(i) }.

The map in the lemma is induced by the obvious bijection between the right hand sides of (9.1.1) and
(9.1.2).
2) From [4, p. 59], the set a) is identified with the set of sn âˆˆ Sl âŠ† Sn such that (nsn (1) , Â· Â· Â·, nsn (l) ) is
âˆ’1
finer than (nâ€²1 , Â· Â· Â·, nâ€²lâ€² ), and such that sâˆ’1
n (i) < sn (i + 1) for any 1 â‰¤ i â‰¤ n âˆ’ 1 that is not of the form
nâ€²1 + Â· Â· Â· + nâ€²k for some 1 â‰¤ k â‰¤ lâ€² . Similarly, the set b) is identified with the set of s âˆˆ Sl âŠ† S2n such that
(2ns(1) , Â· Â· Â·, 2ns(l) ) is finer than (2nâ€²1 , Â· Â· Â·, 2nâ€²lâ€² ), and such that sâˆ’1 (i) < sâˆ’1 (i + 1) for any 1 â‰¤ i â‰¤ 2n âˆ’ 1
that is not of the form 2nâ€²1 + Â· Â· Â· + 2nâ€²k for some 1 â‰¤ k â‰¤ lâ€² . The map in the lemma is induced by the
obvious bijection between these two sets.

For P1 and P2 a pair of Ï‰-stable relatively standard parabolic subgroups of G, denote by â„¦H (aP1 , aP2 )
the (perhaps empty) set of distinct isomorphisms from aP1 to aP2 obtained by restriction of elements
in â„¦H . It is a subset of â„¦G (aP1 , aP2 ) a priori. However, since the image of the map in Lemma 9.1.1)
is contained in â„¦H , we actually have â„¦H (aP1 , aP2 ) = â„¦G (aP1 , aP2 ) (cf. [15, Lemme 2.8.1]). Denote by
S H
2 âˆ©H
â„¦H (aP1 ; P2 ) the set of s âˆˆ
â„¦ (aP1 , aQ ) such that s(aP1 ) âŠ‡ aP2 and sâˆ’1 Î± > 0 for each Î± âˆˆ âˆ†P
QH ,
aQ

where the union takes over all aQ associated to some Ï‰-stable relatively standard parabolic subgroup Q
of G. Then â„¦H (aP1 ; P2 ) = â„¦G (aP1 ; P2 ) by Lemma 9.1.2).

9.2. Regular semi-simple terms. Let o âˆˆ Ors (see Section 3.3). It is possible to choose an element
X1 âˆˆ o and a relatively standard parabolic subgroup P1 of G such that X1 âˆˆ mP1 (F ) (thus P1 is Ï‰-stable
by Proposition 5.4) but X1 cannot be H(F )-conjugated to an element in the Lie algebra of any relatively
standard parabolic subgroup R ( P1 . We call such X1 an elliptic element in (mP1 âˆ© s)(F ).
Ã—

p1,n p1,n
Let P1 =
be an Ï‰-stable relatively standard parabolic subgroup of G, where P1,n is a
p1,n p1,n


0 A1
âˆˆ (mP1 âˆ© s)(F ) be a regular semi-simple
standard parabolic subgroup of GLn,D . Let X1 =
B1 0
element in s. Then X1 is elliptic in (mP1 âˆ© s)(F ) if and only if A1 B1 is elliptic in mP1,n (F ) in the usual
sense, i.e., PrdA1 B1 is irreducible (see [23, Proposition 5] for example). Let HX1 be the centraliser of X1
in H. Then X1 is elliptic in (mP1 âˆ© s)(F ) if and only if the maximal F -split torus in HX1 is AP1 .
39

Theorem 9.2. Let o âˆˆ Ors , P1 be a relatively standard parabolic subgroup of G and X1 âˆˆ o be an elliptic
element in (mP1 âˆ© s)(F ). For f âˆˆ S(s(A)), we have
Z
G
âˆž
f (xâˆ’1 X1 x)vP1 (x)Î·(Nrd(x))dx,
Jo (Î·, f ) = vol(AP1 HX1 (F )\HX1 (A)) Â·
HX1 (A)\H(A)

where vP1 (x) is left-invariant under HX1 (A) and equals the volume of the projection onto aG
P1 of the convex
hull of {âˆ’HQ (x)}, where Q runs over all semi-standard parabolic subgroups of G with MQ = MP1 .
Proof. Consider a relatively standard parabolic subgroup P of G and X âˆˆ mP (F ) âˆ© o (thus P is Ï‰stable by Proposition 5.4). There exists an Ï‰-stable relatively standard parabolic subgroup P2 âŠ† P and
X2 âˆˆ (mP2 âˆ© s)(F ) such that X2 is conjugate to X via an element in MPH (F ) and the maximal F -split
torus in HX2 is AP2 . Then any element in H(F ) which conjugates X1 and X2 will conjugate AP1 and
AP2 . It follows that there exists s âˆˆ â„¦H (aP1 , aP2 ) and m âˆˆ MPH (F ) such that
X = mÏ‰s X1 Ï‰sâˆ’1 mâˆ’1 .
Suppose that P3 âŠ† P is another relatively standard parabolic subgroup, sâ€² âˆˆ â„¦H (aP1 , aP3 ) and mâ€² âˆˆ
MPH (F ) such that
â€² âˆ’1
X = mâ€² Ï‰sâ€² X1 Ï‰sâˆ’1
.
â€² m
Then there is Î¶ âˆˆ HX (F ) such that
mâ€² Ï‰sâ€² = Î¶mÏ‰s .
Since HX âŠ† MPH , we see that
Ï‰sâ€² = Î¾Ï‰s
for some Î¾ âˆˆ MPH (F ). In sum, for any given P a relatively standard parabolic subgroup of G and
X âˆˆ mP (F ) âˆ© o, there is a unique s âˆˆ â„¦H (aP1 ; P ) such that X = mÏ‰s X1 Ï‰sâˆ’1 mâˆ’1 for some m âˆˆ MPH (F ).
For x âˆˆ PH (F )\H(A), we obtain
X
X
f ((nx)âˆ’1 Xnx)
jf,P,o (x) =
XâˆˆmP (F )âˆ©o nâˆˆNPH (F )

X

=

sâˆˆâ„¦H (aP1 ;P ) mâˆˆM

X

=

X

âˆ’1 (F )
PH ,Ï‰s X1 Ï‰s

X

sâˆˆâ„¦H (aP1 ;P ) mâˆˆM

âˆ’1 (F )
PH ,Ï‰s X1 Ï‰s





X

f ((mnx)âˆ’1 Ï‰s X1 Ï‰sâˆ’1 mnx)

MPH (F ) nâˆˆNPH (F )

f ((mx)âˆ’1 Ï‰s X1 Ï‰sâˆ’1 mx),
PH (F )

where MPH ,Ï‰s X1 Ï‰sâˆ’1 denotes the centraliser of Ï‰s X1 Ï‰sâˆ’1 in MPH . For T âˆˆ a0 and x âˆˆ H(F )\H(A), we
have
X
X
T
Ï„bPG (HP (Î´x) âˆ’ TP ) Â· jf,P,o (Î´x)
(âˆ’1)dim(AP /AG )
jf,o
(x) =
Î´âˆˆPH (F )\H(F )

{P :P0 âŠ†P }

X

=

Î´âˆˆPH (F )\H(F )

{P :P0 âŠ†P }

ï£«

=

ï£¬
Â·ï£¬
ï£­

X

X

sâˆˆâ„¦H (aP1 ;P ) mâˆˆM

X

X

(âˆ’1)dim(AP /AG )

âˆ’1 (F )
PH ,Ï‰s X1 Ï‰s

(âˆ’1)dim(AP /AG )

X



Ï„bPG (HP (Î´x) âˆ’ TP )

PH (F )

ï£·
f ((mÎ´x)âˆ’1 Ï‰s X1 Ï‰sâˆ’1 mÎ´x)ï£·
ï£¸

sâˆˆâ„¦H (aP1 ;P ) Î´âˆˆM

{P :P0 âŠ†P }

ï£¶

X

âˆ’1 (F )
PH ,Ï‰s X1 Ï‰s

Â· f ((Î´x)âˆ’1 Ï‰s X1 Ï‰sâˆ’1 Î´x).



H(F )

Ï„bPG (HP (Î´x) âˆ’ TP )

Notice that the centraliser of Ï‰s X1 Ï‰sâˆ’1 in H is actually contained in MPH . We deduce that
X
X
X
T
(âˆ’1)dim(AP /AG )
Ï„bPG (HP (Î´x) âˆ’ TP ) Â· f ((Î´x)âˆ’1 Ï‰s X1 Ï‰sâˆ’1 Î´x)
jf,o
(x) =

H
{P :P âŠ†P }
sâˆˆâ„¦ (aP1 ;P ) Î´âˆˆH

0

=

X

{P :P0 âŠ†P }

(âˆ’1)dim(AP /AG )

X

âˆ’1 (F )
Ï‰s X1 Ï‰s

X

sâˆˆâ„¦H (aP1 ;P ) Î´âˆˆHX1 (F )\H(F )
40

H(F )

Ï„bPG (HP (Ï‰s Î´x) âˆ’ TP ) Â· f ((Î´x)âˆ’1 X1 Î´x).

For y âˆˆ H(A), write
Ï‡T (y) :=

X

X

(âˆ’1)dim(AP /AG )

sâˆˆâ„¦H (aP1 ;P )

{P :P0 âŠ†P }

Then

X

T
jf,o
(x) =

Ï„bPG (HP (Ï‰s y) âˆ’ TP ).

f ((Î´x)âˆ’1 X1 Î´x) Â· Ï‡T (Î´x).

Î´âˆˆHX1 (F )\H(F )
T
For sufficiently regular T , using Theorem 8.2 and the fact that jf,o
(x)Î·(Nrd(x)) is left invariant by
we have
Z
T
JoG,T (Î·, 0, f ) =
jf,o
(x)Î·(Nrd(x))dx

Aâˆž
G,

H(F )\H(A)âˆ©G(A)1

=

Z

Aâˆž
G H(F )\H(A)

Hence,
(9.2.1)

ï£«
ï£­

X

Î´âˆˆHX1 (F )\H(F )

JoG,T (Î·, 0, f ) = vol(Aâˆž
P1 HX1 (F )\HX1 (A)) Â·

where
vP1 (x, T ) :=

Z

ï£¶

f ((Î´x)âˆ’1 X1 Î´x) Â· Ï‡T (Î´x)ï£¸ Î·(Nrd(x))dx.

Z

f (xâˆ’1 X1 x)vP1 (x, T )Î·(Nrd(x))dx.

HX1 (A)\H(A)

Ï‡T (ax)da.

âˆž
Aâˆž
G \AP

1

Here we have cheated by assuming that vP1 (x, T ) is well-defined and left-invariant under HX1 (A) in the
last equality, which is explained below along with its geometric interpretation.
Let Q be a parabolic subgroup of G containing P0 . Since P0 âŠ† P1 , by the charaterisation in [4, p.
59], â„¦G (aP1 ; Q) is empty unless P0 âŠ† Q, in which case we have â„¦G (aP1 ; Q) = â„¦H (aP1 ; Q) by Lemma
9.1.2). Therefore, we have
X
X
G
(âˆ’1)dim(AQ /AG )
Ï„bQ
(HQ (Ï‰s y) âˆ’ TQ ).
Ï‡T (y) =
sâˆˆâ„¦G (aP1 ;Q)

{Q:P0 âŠ†Q}

Compared to [2, p. 951], vP1 (x, T ) is nothing but the restriction to H(A) of Arthurâ€™s weight for G(A). It is
shown in [1, Corollary 3.3] that the integral over a can be taken over a compact subset. From [1, Corollary
3.5], vP1 (x, T ) equals the volume of the projection onto aG
P1 of the convex hull of {TQ âˆ’ HQ (x)}, where Q
takes over all semi-standard parabolic subgroups of G with MQ = MP1 . For y âˆˆ HX1 (A) âŠ† MP1 âˆ©H (A),
the convex hull associated to vP1 (yx, T ) is a translation of that associated to vP1 (x, T ), so they have the
same volume, i.e., vP1 (yx, T ) = vP1 (x, T ). By taking constant terms of both sides of (9.2.1), we obtain
the theorem.

Remark 9.3. As mentioned in the proof of Theorem 9.2, the weights we get for regular semi-simple
orbits are the restriction to H(A) of Arthurâ€™s weights (see [2, p. 951]) for G(A). They are also the
same as those (see [15, p. 131]) appearing in the twisted trace formula for (GLn,D Ã— GLn,D ) â‹Š Ïƒ, where
Ïƒ acts on GLn,D Ã— GLn,D by Ïƒ(x, y) := (y, x). For Pn a standard parabolic subgroup of GLn,D and

Ã—
pn pn
P =
an Ï‰-stable relatively standard parabolic subgroup of G, we may identify aP with the
pn pn
Ïƒ-invariant subspace of aPn Ã—Pn . The Ï‰-stable relatively standard parabolic subgroups of G here play the
role of the Ïƒ-stable standard parabolic subgroups of GLn,D Ã— GLn,D , which correspond to the standard
parabolic subsets of (GLn,D Ã— GLn,D ) â‹Š Ïƒ in the sense of [15, Â§2.7]. However, we need more (namely
relatively standard) parabolic subgroups in our truncation to deal with o âˆˆ
/ OÃ— .
References
[1] James Arthur. The characters of discrete series as orbital integrals. Invent. Math., 32(3):205â€“261, 1976.
[2] James Arthur. A trace formula for reductive groups. I. Terms associated to classes in G(Q). Duke Math. J., 45(4):911â€“
952, 1978.
[3] James Arthur. The trace formula in invariant form. Ann. of Math. (2), 114(1):1â€“74, 1981.
[4] James Arthur. An introduction to the trace formula. In Harmonic analysis, the trace formula, and Shimura varieties,
volume 4 of Clay Math. Proc., pages 1â€“263. Amer. Math. Soc., Providence, RI, 2005.
[5] Pierre-Henri Chaudouard. La formule des traces pour les algeÌ€bres de Lie. Math. Ann., 322(2):347â€“382, 2002.
41

[6] Pierre-Henri Chaudouard. Sur une variante des troncatures dâ€™Arthur. In Werner MuÌˆller, Sug Woo Shin, and Nicolas Templier, editors, Geometric Aspects of the Trace Formula, pages 85â€“120, Cham, 2018. Springer International
Publishing.
[7] Anton Deitmar. A first course in harmonic analysis. Universitext. Springer-Verlag, New York, second edition, 2005.
[8] Brooke Feigon, Kimball Martin, and David Whitehouse. Periods and nonvanishing of central L-values for GL(2n).
Israel J. Math., 225(1):223â€“266, 2018.
[9] Solomon Friedberg and HerveÌ Jacquet. Linear periods. J. Reine Angew. Math., 443:91â€“139, 1993.
[10] Jiandong Guo. On a generalization of a result of Waldspurger. Canad. J. Math., 48(1):105â€“142, 1996.
[11] Brian Hall. Lie groups, Lie algebras, and representations, volume 222 of Graduate Texts in Mathematics. Springer,
Cham, second edition, 2015. An elementary introduction.
[12] Atsushi Ichino and Shunsuke Yamana. Periods of automorphic forms: the case of (GLn+1 Ã— GLn , GLn ). Compos.
Math., 151(4):665â€“712, 2015.
[13] HerveÌ Jacquet. Sur un reÌsultat de Waldspurger. Ann. Sci. EÌcole Norm. Sup. (4), 19(2):185â€“229, 1986.
[14] HerveÌ Jacquet and Stephen Rallis. Uniqueness of linear periods. Compositio Math., 102(1):65â€“123, 1996.
[15] Jean-Pierre Labesse and Jean-Loup Waldspurger. La formule des traces tordue dâ€™apreÌ€s le Friday Morning Seminar,
volume 31 of CRM Monograph Series. American Mathematical Society, Providence, RI, 2013. With a foreword by
Robert Langlands [dual English/French text].
[16] Jason Levy. A truncated Poisson formula for groups of rank at most two. Amer. J. Math., 117(6):1371â€“1408, 1995.
[17] Qirui Li. An intersection number formula for CM cycles in Lubin-Tate towers. arXiv e-prints, page arXiv:1803.07553,
Mar 2018.
[18] V. L. Popov and Eh. B. Vinberg. Invariant theory. Algebraic geometry. IV: Linear algebraic groups, invariant theory, Encycl. Math. Sci. 55, 123-278 (1994); translation from Itogi Nauki Tekh., Ser. Sovrem. Probl. Mat., Fundam.
Napravleniya 55, 137-309 (1989)., 1989.
[19] J. J. Sylvester. Sur lâ€™eÌquation en matrices px = xq. C. R. Acad. Sci., Paris, 99:67â€“71, 115â€“116, 1884.
[20] J.-L. Waldspurger. Sur les valeurs de certaines fonctions L automorphes en leur centre de symeÌtrie. Compositio Math.,
54(2):173â€“242, 1985.
[21] AndreÌ Weil. Sur certains groupes dâ€™opeÌrateurs unitaires. Acta Math., 111:143â€“211, 1964.
[22] AndreÌ Weil. Basic number theory. Classics in Mathematics. Springer-Verlag, Berlin, 1995. Reprint of the second (1973)
edition.
[23] Chia-Fu Yu. Characteristic polynomials of central simple algebras. Taiwanese J. Math., 17(1):351â€“359, 01 2013.
[24] Chong Zhang. On linear periods. Math. Z., 279(1-2):61â€“84, 2015.
[25] Chong Zhang. On the smooth transfer for Guo-Jacquet relative trace formulae. Compos. Math., 151(10):1821â€“1877,
2015.
[26] Michal Zydor. La variante inï¬niteÌsimale de la formule des traces de Jacquet-Rallis pour les groupes lineÌaires. J. Inst.
Math. Jussieu, 17(4):735â€“783, 2018.
[27] Michal Zydor. Les formules des traces relatives de Jacquet-Rallis grossieÌ€res. J. Reine Angew. Math., 762:195â€“259,
2020.

UniversiteÌ de Paris, Sorbonne UniversiteÌ, CNRS, Institut de MatheÌmatiques de Jussieu-Paris Rive
Gauche, F-75013 Paris, France
E-mail: huajie.li@imj-prg.fr

42

