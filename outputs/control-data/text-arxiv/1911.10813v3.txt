Parameter-free hybrid-like functional based on an extended Hubbard model:
DFT+U + V
Nicolas Tancogne-Dejean1, 2, ‚àó and Angel Rubio1, 2, 3, 4, ‚Ä†

arXiv:1911.10813v3 [cond-mat.str-el] 21 Sep 2020

1

Max Planck Institute for the Structure and Dynamics of Matter and Center for Free-Electron Laser Science,
Luruper Chaussee 149, 22761 Hamburg, Germany
2
European Theoretical Spectroscopy Facility (ETSF)
3
Nano-Bio Spectroscopy Group, Universidad del Paƒ±ÃÅs Vasco,
CFM CSIC-UPV/EHU-MPC, 20018 San SebastiaÃÅn, Spain
4
Center for Computational Quantum Physics (CCQ),
The Flatiron Institute, 162 Fifth Avenue, New York NY 10010
In this article, we propose an energy functional at the level of DFT+U + V that allows us to
compute self-consistently the values of the on-site interaction, Hubbard U and Hund J, as well
as the intersite interaction V . This functional extends the previously proposed ACBN0 functional
[Phys. Rev. X 5, 011006 (2015)] including both on-site and intersite interactions. We show that
this ab initio self-consistent functional yields improved electronic properties for a wide range of
materials, ranging from sp materials to strongly-correlated materials. This functional can also be
seen as an alternative general and systematic way to construct parameter-free hybrid functionals,
based on the extended Hubbard model and a selected set of Coulomb integrals, and might be used
to develop novel approximations. By extending the DFT+U method to materials where strong
local and nonlocal interactions are relevant, this work opens the door to the ab initio study the
electronic, ionic, and optical properties of a larger class of strongly correlated materials in and out
of equilibrium.

I.

INTRODUCTION

During the last few decades, density functional theory
(DFT) has emerged as one of the most reliable and efficient numerical method to simulate a wide range of materials. However, it is well known that the most employed
local and semilocal functionals suffer from many problems, in particular the so-called ‚Äúdelocalization problem‚Äù, which prevents a practical application of using
DFT to materials where strong local electron-electron
are taking place1,2 . More advanced functionals, such as
meta-generalized gradient approximation, or hybrid functionals can solve some of these problems, but are still not
ideal for strongly-correlated systems. In order to overcome this problem, one can rely on the well-established
dynamical mean field theory (DMFT) 3,4 , and its extensions such as DFT+DMFT or GW+DMFT, which
has become the state-of-the-art methods to treat strongly
correlated materials5 . In most of these methods, the effective electronic parameter describing the local interaction, the Hubbard U , is computed within the framework
of constrained random-phase approximation (cRPA)6‚Äì9 .
As an alternative effective approach, DFT+U method
originally proposed by V. Anisimov, A. Lichestein, and
coworkers1,10‚Äì12 provides a successful way to improve the
treatment of correlated solids upon DFT, without the
numerical burden of the DFT+DMFT or GW+DMFT
methods. In order to correct the over-delocalization
of the electrons, it was proposed to include an energy
penalty U for the localized 3d or 4f orbitals, in the
spirit of the mean-field Hubbard model.1,2,10‚Äì12 The success of the DFT+U method mainly originates from the
simplicity of the method, its relative low computational
cost, and the fact that it can predict the proper magnetic ground state of correlated materials such as charge-

transfer and Mott insulators.1 Of course, the DFT+U
approach is not applicable to some really stronglycorrelated systems and for these systems once needs to
go beyond DFT+U and use DMFT or cluster DMFT
frameworks. Other limitations include for instance the
incapacity to access lifetimes of quasiparticles. Still, the
DFT+U approach is very attractive when it comes to the
calculation of larger systems, such as twisted bilayer systems with small twist angles13 , or for out-of-equilibrium
situations, using real-time TDDFT+U 14,15 . It also improves the description of the optical properties of some
correlated materials within linear response16 .
Here, we develop an efficient numerical approach tailored towards materials for which not only local correlations are important, but also nonlocal correlations, which
means a strong interaction between neighboring localized
electrons. This is one step towards dealing with correlated materials in an efficient way but within the constraints of applicability of the DFT+U + V method (as
discussed for instance in Ref. 2). One example of such
system in which nonlocal correlations are important is
charge-ordering insulators, such as Fe3 O4 17 , for which an
electron is delocalized over two sites and hence the MottHubbard localization cannot occur. Nonlocal interaction
also plays a key role in low-dimensional systems, such
as ad-atoms on Si(111) surfaces18 or sp electron systems
such as graphite and graphene19‚Äì21 . Finally, the role of
the intersite interaction is strongly debated for high-Tc
superconductors and dictates many of their properties22 .
In all these systems, the intersite interaction plays a decisive role and the related self-interaction error contained
in (semi-)local functional of DFT is crucially hampering
the capability of these functionals.
The low-energy physics of these systems is usually well
described by an extended Hubbard model. In particular,

2
if we only account for charge interaction between neighboring sites, the extended Hubbard Hamiltonian reads
HeHub = ‚àí

XX
i,j

+

tij (c‚Ä†i,œÉ cj,œÉ + h.c.) + U

X

œÉ

1 XX
Vij ni,œÉ nj,œÉ0 ,
2
0

ni,‚Üë ni,‚Üì

i

(1)

i6=j œÉ,œÉ

where œÉ denotes the spin index, tij are the hopping matrix elements, U represents the on-site interaction, and
Vij are the nonlocal Coulomb matrix elements between
the neighboring sites i and j.
Our goal is to derive the expression of an orbital energy
functional containing at the same time U and J describing the multi-band on-site interaction, and the intersite
interaction V describing the charge interaction between
the different atomic sites. The functional can be seen
as a hybrid functional, in which the Kohn-Sham orbitals
are expanded into a basis of atomic-like orbitals, including the on-site terms, and some of the intersite terms.
At variance with most of the proposed hybrid functionals, we do not use a mixing parameter to determine the
weight of the exchange interaction, but we base our approach on the extended Hubbard model and the related
DFT+U + V scheme, which allows for a fully ab initio
and self-consistent estimate of the U , J, and V effective
electronic parameters. Moreover, we use an approximate
double-counting term, as commonly done for DFT+U ,
which does not require any parameter to be adjusted.
The self-consistency in the Hubbard U can be crucial
in the case of transition-metal complexes23 , and we expect this to be equally true for the intersite interaction.
In our approach, the on-site Hubbard U , Hund J, and
the intersite interaction V are all evaluated at the same
time, to ensure the consistency of our approach. It is
important to stress that except for the additional cost of
computing more Coulomb integrals at the beginning of
the calculation, our approach does not represent a major extra cost compared to the usual DFT+U and the
ACBN0 functional16,24 . This makes our method very attractive computationally. Another major interest of this
method is the possibility to extend it directly to the timedependent case, only assuming the adiabatic approximation, or to couple to other degrees of freedom, such as
phonons.
This paper is organized as follow. First, we briefly
review the DFT+U and the DFT+U + V methods
in Sec. II. Then, we present our generalization of the
ACBN0 functional, the extended ACBN0 functional, in
Sec. III. We then test our new functional on different systems and compare our results with prior works. Finally,
we draw our conclusions in Sec.V.

II.

DFT+U AND DFT+U + V

The DFT+U method aims at replacing the DFT energy functional EDFT [n] by the DFT+U energy func-

tional of the form16
I,œÉ
I,œÉ
EDFT+U [n, {nI,œÉ
mm0 }] = EDFT [n]+Eee [{nmm0 }]‚àíEdc [{nmm0 }] ,
(2)
where Eee is the electron-electron interaction energy, and
Edc accounts for the double counting of the electronelectron interaction already present in EDFT . This
double-counting term is not known in the general case
and several approximated forms have been proposed
along the years. The Eee and Edc energies depend on the
density matrix of a localized orbitals basis set {œÜI,n,l
m },
which are the localized orbitals attached to the site I. In
the following we refer to the elements of the density matrix of the localized basis as occupation matrices, and we
denote them {nI,œÉ
mm0 }. Combining these two expressions,
we obtain the EU energy to be added to the DFT total energy, which only depends on an effective Hubbard
U parameter U eff = U ‚àí J. This gives the rotationalinvariant form of DFT+U proposed by Dudarev et al.,25
I,œÉ
I,œÉ
EU [{nI,œÉ
mm0 }] = Eee [{nmm0 }] ‚àí Edc [{nmm0 }]
eff X 
X UI,n,l
X I,n,l,œÉ I,n,l,œÉ 
nmm0 nm0 m , (3)
nI,n,l,œÉ
‚àí
=
2 m,œÉ mm
0
m

I,n,l

where I is an atom index, n, l and m refer to the principal, azimuthal, and angular quantum numbers, respectively, and œÉ is the spin index. In the case of a periodic
system, the occupation matrices nI,n,l,œÉ
are given by
mm0
nI,n,l,œÉ
mm0 =

BZ
XX
n

I,n,l œÉ
œÉ
œÉ
wk fnk
hœàn,k
|PÃÇmm
0 |œàn,k i ,

(4)

k

œÉ
is the occupawhere wk is the k-point weight and fnk
œÉ
I,n,l
tion of the Bloch state |œàn,k i. Here, |œÜm i are the localized orbitals that form the basis used to describe electron
I,n,l
localization and PÃÇmm
0 is the projector associated with
I,n,l
I,n,l
ihœÜI,n,l
these orbitals, usually defined as PÃÇmm
0 = |œÜm
m0 |.
The definition of the orbitals and of the projectors will
be discussed in more details below. In the following, we
omit the principal quantum number n for conciseness.
Recently, an extension of the DFT+U method was proposed by V. Leiria Campo Jr and M. Cococcioni26 , in
order to account for the intersite electronic interaction
V , in the spirit of the extended Hubbard Hamiltonian22 .
This represents the first ab initio DFT+U + V method
proposed in the literature capable of estimating the intersite interaction V . In their method, only the charge
interaction between neighboring sites is accounted for.
In a similar spirit, Belozerov and coworkers proposed a
LDA+DMFT+V approach that they applied to the monoclinic phase of VO2 27 .
The Hubbard U is usually defined as the averaged of the
on-site interactions of the localized orbitals
X I,l I,l
1
I,l
U I,l =
hœÜ œÜ |Vee |œÜI,l
(5)
i œÜj i,
(2l + 1)2 i,j i j

where Vee is the screened Coulomb interaction. If the
screened Coulomb interaction is frequency dependent,

3
this leads to a frequency-dependent U , as used in the
cRPA method. If a statically screened Coulomb interaction is used instead, as done in the DFT+U method, the
U becomes frequency independent.
In a similar way, the most akin definition of the averaged
intersite interaction V is defined as26
VII,l
0 ,l0 =

evaluate the average intersite interaction V ab initio and
self-consistently, in a form of a pseudo-hybrid calculation.

III. AB INITIO V :
THE EXTENDED ACBN0 FUNCTIONAL

X I,l I 0 ,l0
1
I 0 ,l0
hœÜi œÜj |Vee |œÜI,l
i.
i œÜj
0
(2l + 1)(2l + 1) i,j

In Ref. 24, an approximation to the electron interaction
energy named ACBN0 functional was proposed, allowing
for an efficient ab initio evaluation of the DFT+U energy,
which can be seen as a screened Hartree-Fock evaluation
of the on-site U , or equally as a pseudo-hybrid functional
in which the (screened) Hartree-Fock energy is included
only on a selected localized subspace. We propose here an
hUI X
X
extension of this approach, which includes not only the
I,‚àíœÉ
nI,œÉ
Eee [{nIJ,œÉ
mm nm0 m0
mm0 }] =
on-site interaction, but also the charge exchange between
2
m,m0 ,œÉ
I
two sites. Below, we refer to this new functional as the
i
extended ACBN0 functional.
UI ‚àí JI X
I,œÉ I,œÉ
nmm nm0 m0
+
In our generalized functional, the electron interaction
2
m6=m0 ,œÉ
energy is given
‚àó

X
X
V IJ  I J
JIœÉ
1 X h X X I,Œ± I,Œ≤
N N ‚àí
nIJœÉ
n
+
0
0
mm m m ,
E
=
nÃÑmm0 nÃÑm00 m000 (œÜIm œÜIm0 |œÜIm00 œÜIm000 )
ee
2
2
m,m0 ,œÉ
IJ
I
{m} Œ±,Œ≤
i
i
X hUI
X X I,Œ± I,Œ±
J I X I,œÉ I,œÉ
IJ,œÉ
I
I
N (N
‚àí 1)
N (N ‚àí 1) ‚àí
Edc [{nmm0 }] =
‚àí
nÃÑmm0 nÃÑm00 m000 (œÜIm œÜIm000 |œÜIm00 œÜIm0 )
2
2 œÉ
(6)
For conciseness, we omit below the quantum numbers in
IJ
our notation and refer in the following to VII,l
.
0 ,l0 as V
I,l
I,l
I
I
Similarly, we refer below to U and J as U and J .
The expression for Eee and Edc become for DFT+U +V 26

I

+

{m} Œ±

‚àó
X
V IJ

2

IJ

NINJ ,

+

‚àó
1 Xh X X

4

P‚àó

where IJ denotes that for each atom I the sum runs
over its neighboring
we
P atoms J. IIn these
P expression,
I,œÉ
defined N I,œÉ = m nI,œÉ
and
N
=
N
.
This
defimm
œÉ
nition uses a generalization of the occupation matrix
nIJœÉ
mm0 =

BZ
XX
n

œÉ
œÉ
IJ
œÉ
wk fnk
hœàn,k
|PÃÇmm
0 |œàn,k i ,

(7)

k

where it is clear that nIIœÉ
mm0 is the usual occupation matrix
nIœÉ
as
defined
in
Eq.
4.
0
mm
Combining the previous expressions, one arrives to the
energy EU V that must be added to the DFT total energy
EU V =

X U eff X 
I

2

I

‚àí

2

X

II,œÉ
nII,œÉ
mm0 nm0 m

‚àí

X

JI,œÉ
nIJ,œÉ
mm0 nm0 m .

mm0 Œ±,Œ≤

XX

where we considered only the charge interaction between
two sites, neglecting other two-site interactions and also
three- and four-site interactions, as the former one is
likely to be the largest contribution to the energy26 .
In Eq. (9), the renormalized occupation matrices nÃÑI,œÉ
mm0
and occupations NÃÑœàI,œÉ
are
respectively
given
by
nk
nÃÑIœÉ
mm0 =

X

œÉ
I
œÉ
wk fnk NÃÑœàIœÉnk hœànk
|PÃÇmm
0 |œànk i ,

(10)

XX
œÉ
I
œÉ
hœànk
|PÃÇmm
|œànk
i.

(11)

nk

NÃÑœàI,œÉ
=
nk



i
JI,Œ± I I
J
J
nÃÑIJ,Œ±
nÃÑ
(œÜ
œÜ
|œÜ
œÜ
)
(9)
,
0
0
0
0
mm m m m m m m

mm0 Œ±

{I} m

m0

m,œÉ

‚àó
X
V IJ
IJ

nII,œÉ
mm ‚àí

IJ

JJ,Œ≤
I I
J
J
nÃÑII,Œ±
mm nÃÑm0 m0 (œÜm œÜm |œÜm0 œÜm0 )

(8)

m,m0 ,œÉ

This energy is the expression for the DFT+U + V
proposed in Ref. 26, and is invariant under rotation
of the orbitals of the same atomic site. This is a
generalization of the work of Dudarev et al.25 , where
the double-counting expression is a generalization
of the fully-localized limit (FLL) double-counting of
DFT+U . The motivation of this specific expression
for the intersite interaction was done in Ref. 26 and is
therefore not discussed here. Below we show how it
is possible to extend the work of Agapito et al.24 to

P
In the last expression, the sum {I} runs over all orbitals
of the system owning the quantum numbers n and l, and
being attached to atoms of the same type as the atom
I. This makes that NÃÑœàI,œÉ
can be seen as the Mulliken
nk
charge of atom I.24 Here we propose a definition of the
generalized renormalized occupation matrices nÃÑIJ,œÉ
mm0
X
œÉ
IJ
œÉ
nÃÑIJœÉ
wk fnk NÃÑœàIJœÉ
hœànk
|PÃÇmm
(12)
0 |œànk i ,
mm0 =
nk
nk

where we introduced an ansatz similar to the one of the
original paper of the ACBN0 functional, namely a degree
of screening in nÃÑIJ,œÉ
mm0

4

NÃÑœàIJœÉ
=
nk

X
m

œÉ
I
œÉ
hœànk
|PÃÇmm
|œànk
i +

X
œÉ
J
œÉ
hœànk
|PÃÇm
0 m0 |œànk i ,
m0

(13)
where the quantity is not summed over all atomic species
having the same quantum numbers (as done in Eq. 11),
but corresponds here to the charge of the bound formed
by atom I and atom J. Let us comment on the motivation for this renormalization of the generalized occupation matrix. In the case of on-site interaction, the
original motivation was that if a wavefunction is fully
delocalized, i.e. not occupying the localized subspace, it
should give a vanishing contribution to the on-site interaction U , and the ACBN0 functional should reduce to
the (semi-)local functional used to describe the itinerant
electrons. By including the weighting coefficient, which
is the Mulliken charge of the set of orbitals, the effect
is enhanced24 . Here, as we consider an intersite interaction, the idea is the opposite. In the atomic limit, for
which the wavefunctions are not delocalized over different sites, there should be no intersite interaction. This
is well seen by the fact that for the Coulomb integral of

the form (œÜIm œÜIm |œÜJm0 œÜJm0 ) to be non-zero, there must be
an overlap of the charge density originating from the two
atomic sites. Hence, if a wavefunction is not delocalized
over the two considered sites, the term NÃÑœàIJœÉ
vanishes,
nk
and the wavefunction does not contribute to the intersite
V . Importantly, thanks to the renormalization employed
here, if a wavefunction is fully localized on one site, the
wavefunction still participates to the interaction.28 In the
context of cRPA, the screening is given by the ‚Äúrest‚Äù of
the system, but also from the cross-term screening coming from the ‚Äúrest‚Äù of the system and from the localized
subspace. Only the electrons fully localized in the localized subspace do not contribute to the screening. This
means that NÃÑœàIœÉnk and NÃÑœàIJœÉ
should be equal to 1 for elecnk
trons fully contained in the localized subspace, as they do
not lead to any screening. Partially delocalized electrons
should also contribute to the screening. These properties are both given by the renormalization factor of the
ACBN0 functional, as well as in our extended ACBN0
functional, which at least partly explains the success of
this approach.

From Eq. (9), the effective inter-site interaction between the I and J atomic sites, VÃÑ IJ , is given by
i
h
P
P
IJ,Œ± JI,Œ±
J
J
II,Œ± JJ,Œ≤
I I
nÃÑ
‚àí
Œ¥
nÃÑ
nÃÑ
|œÜ
œÜ
)
nÃÑ
œÜ
(œÜ
0
0
0
0
0
0
0
Œ±Œ≤ mm m m
mm m m
m m m m
Œ±,Œ≤
1 mm
P

VÃÑ IJ =
.
P
JŒ≤
2
IJŒ±
nIŒ± n 0 0 ‚àí
n 0 nJIŒ±
0
0
0
m,m ,Œ±Œ≤

mm m m

This expression is the main result of this section. With
it, one can evaluate the intersite interaction ab initio and
self-consistently, similarly to what is done for the effective U in the ACBN0 functional. We also derived the expression of the extended ACBN0 functional for the case
of noncollinear spins, as presented in Appendix A. The
expression of the forces is also given in Appendix B.
So far, we remained elusive on the orbitals used to define the localized subspace. This is a technical but very
important implementation-dependent issue that deserves
some discussion. In the Octopus code16,29 , we construct
the localized orbitals {œÜI,n,l
m } by taking the radial part of
the pseudo-atomic wavefunctions given by the pseudopotential files, and multiplying them by the usual spherical
harmonics, in order to obtain the pseudo-atomic orbitals.
More precisely, in case of periodic solids, we use in all the
above equations not the isolated localized orbital, but the
Bloch sums of the localized orbitals, which read as
1 X ‚àíik.R I,n,l
œÜI,n,l
e
œÜm (r + R) ,
m,k (r) = ‚àö
N R

(15)

and which amount for introducing a phase factor when
the spheres on which the atomic orbitals are defined cross
the border of the real-space simulation box. Here N corresponds to the number of unit cells forming the periodic
crystal, i.e., the number of k-points of the simulation.

m,m ,Œ±

mm

(14)

mm

The projection onto Kohn-Sham states selects a single
momentum, explaining why the k-point index was not
specified in the above equations. Also note that the normalization factor in the Bloch sum vanishes when we use
the periodicity of the crystal for computing the sum over
the entire crystal. This reduces to a sum over the unit
cell without the normalization factor.
In order to be able to treat various type of solids, including weakly correlated solids such as Si, we also implemented the LoÃàwdin orthonormalization procedure, which
transforms the set of non-orthogonal localized orbitals
{œÜI,n,l
m } into an orthonormal set of localized orbitals
X  ‚àí1 
œÜÃÑi,k (r) =
Sk 2
œÜj,k (r) ,
(16)
j

ji

where i and j indices run over all the considered orbitals,
and the overlap matrix for the set of considered orbitals is
(Sk )ij = hœÜik |œÜjk i. Importantly, using these orthogonalized orbitals, we obtain a trace of the on-site occupation
matrix which is consistent with the Mulliken population
analysis and leads to the exact same trace of the occupation matrix than the dual projector defined in Ref. 30
for non-orthogonal basis set.
Due to the periodicity of the Bloch sums of the localized orbitals, we only need to compute projections on
the orbitals of the atoms inside the simulation box, irrespective of the number of neighboring atoms considered.

5

.
FIG. 1. Sketch of possible choices for defining a portion of
the real-space grid on which the atomic orbitals and Coulomb
integrals can be evaluated. Atom positions are indicated by
green crosses. Details are discussed in the main text.

This is also the case for a simpler DFT+U calculation,
making the cost of DFT+U + V calculation only mildly
more expensive than a more standard DFT+U calculation. This is a major difference compared to the original
formulation of DFT+U +V , which requires the construction of larger supercells to include further neighbors26 .
We stress here that the orthonormal orbitals given by
Eq. (15) are not the ones that we use to compute the
Coulomb integrals, as they are periodic orbitals, and
Coulomb integrals computed using these orbitals would
contain both on-site and intersite overlaps, which is not
what we want. For this reason, the Coulomb integrals
are computed before performing the orthonormalization
procedure, from the atomic orbitals of the pseudopotential. More precisely, each of them is evaluated on a portion of the grid, and the Coulomb integrals are computed
on the union of these two spheres, using a non-periodic
Poisson solver. This is sketched in Fig. 1, in which the
violet points correspond to the grid points obtained from
the union of the two spherical meshes centered on two
atoms (indicated by green crosses). These are the points
we used in our implementation. Another possible choice
would be a single, larger, sphere centered at the middle
of the two atoms, as indicated in red in Fig. 1. This
choice obviously leads to more grid points and we found
that there is no difference in between the two choices, as
the atomic orbitals rapidly decay away from the center
of the atom. Finally, we note that a formulation in terms
of Wannier functions would look very much the same as
the one we have presented here.

IV.
A.

RESULTS
ZrSiSe

The nodal-line semimetals have received a lot of attention recently. Due to the vanishing density of states at

.
FIG. 2. Bandstructure of bulk ZrSiSe obtained using the extended ACBN0 functional (red lines) compared to the hybrid
functional calculation (blue dots).

the Dirac or Weyl points, the screening of the Coulomb
interaction is altered, and long-range Coulomb interaction is a crucial ingredient in the description of these
materials31 . Hence, the nodal-line semimetals exhibit
strong nonlocal correlations32,33 , which are not captured
by a local Hubbard U as used in DFT+U . This represents therefore an interesting potential application of our
extended ACBN0 functional.
In order to benchmark our functional, we decided to investigate ZrSiSe, and we used a hybrid functional as a
reference to compare with. In Ref. 32 and 34, it was
shown that hybrid functional calculations with a fraction
of exact exchange of 7% reproduce best the experimental
results, compared to the standard fraction of 25% used in
the HSE06 functional35 . We employed the experimental
lattice constant of 3.623 AÃä and we sampled the real-space
using a spacing of 0.3 Bohr and the Brillouin zone using
a 7 √ó 7 √ó 3 k-point grid. We considered localization of
the d orbitals of Zr and included the interaction with the
first nearest neighbors. We employed the local-density
approximation for the DFT exchange-correlation energy
functional. We obtained self-consistent values for the effective Ueff = U ‚àí J and V of 1.63 eV and 0.37 eV respectively. The comparison of the bandstructure computed
from DFT+U + V and the hybrid functional is shown in
Fig. 2. We found that DFT+U + V has almost the same
band dispersion than the one obtained from the hybrid
functional close to the Weyl point, showing the validity
of our functional in describing this material.
We recently applied our functional to successfully reproduce the measured angle-resolved photoemission spectrum of ZrSiSe34 including spin-orbit coupling. Formulae
for noncollinear spins are presented in Appendix A.

6
B.

Graphene and graphite

Low-dimensional sp materials received a lot of attention recently as they display strong local and nonlocal
Coulomb interaction20,21 . In Ref. 20, cRPA calculations
of the on-site and intersite interactions for graphene at
half-filling were presented. Similar calculations were performed in graphene and graphite in Ref. 21. In order to illustrate the flexibility and robustness of our implementation, we compute the intersite interactions for graphene,
treated here with mixed periodic boundary conditions,
and graphite, which is a fully periodic material. We use
a 15 √ó 15 k-point grid to sample the two-dimensional
Brillouin zone of graphene and a 12 √ó 12 √ó 4 grid in
the case of graphite. We employ an in-plane lattice constant of 2.47AÃä in both cases, and an out-of-plane constant
of 6.708AÃä for graphite. The real-space grid is sampled
by a spacing of 0.45 Bohr and we employed the normconserving Pseudodojo pseudopotential36 . We compare
the previously reported values to the ones obtained by
our functional in Tab. I. A major difference is that the
in the present calculations all p orbitals are considered,
whereas prior studies only considered pz orbitals. As a
result, both on-site and intersite interactions are found to
be smaller in our case that in previous works20,21 , which
is fully compatible with considering more orbitals in the
localized subspace, which, in the language of cRPA, reduces the screening from the rest of the system.
Material
U
V01
V02
V03
V04

Graphite
Graphene
This work Ref. 21 This work Ref. 21 Ref. 20
7.62
8.0-8.1
7.58
9.3
10.16
4.04
3.9
4.00
5.5
5.68
2.58
2.4-2.4
2.56
4.1
4.06
2.25
1.9
2.22
3.6
3.70
1.88
3.19

TABLE I. Calculated values of the on-site (U ) and intersite
(V0i ) interactions for graphite and graphene computed with
our extended ACBN0 functional (DFT+U+V), compared to
prior works. Values are given in eV. The notation V0i denotes
the intersite interaction between an atom in the unit cell,
and its i-th neighbor. In the case of graphite, two values are
indicated corresponding to the two sublattices of the system.

Already in the 1950s, in the context of œÄ-conjugated
systems, it was proposed by Pariser, Parr, and Pople a
one-band model with nearest-neighbor hopping and intersite interaction. This model has been widely studied
and few expressions have been proposed to interpolate
the Coulomb interaction between the long-range 1/r behavior, and the short-range on-site value, which is the
Hubbard U . In order to get a more physical insight on
the values obtained by our method, we compare them to
the popular Ohno interpolation formula37 , which reads
Vij = p

U
.
1 + (U rij )2

(17)

.
FIG. 3. Comparison between the calculated intersite V for
graphite and the extrapolated values using the Ohno formula
and the calculated on-site effective U . An effective dielectric
constant  of 2.15 is used here.

In this expression, the intersite interaction between
atoms i and j separated by the distance rij is estimated
from the on-site interaction U and an effective dielectric
constant .
The fact that we can fit the values of the intersite
interaction with the Ohno potential indicates that the
Coulomb integrals are properly computed. The most interesting point is that the effective dielectric constant
 = 2.15, used here to match our calculated intersite
interaction values, agrees reasonably very well with the
effective dielectric constant of graphite of 2.5 found experimentally or from cRPA calculations 21 . This shows
that the functional correctly describes the screening at
place in graphite.
Fig. 4 shows the band structure of graphene obtained
using the extended ACBN0 functional, compared to the
LDA one. In this case, we included both s and p orbitals,
orthonormalized using the LoÃàwdin orthonormalization
procedure discussed above. The comparison of the band
dispersion close to the K point (right panel of Fig. 4)
shows that the extended ACBN0 leads to Fermi velocity
quite close to the GW one around the K point, compared to the LDA calculation. This demonstrates that
our functional also improves the description of the electronic properties of graphene. However, we note that the
extended ACBN0 functional opens too much the gap between the œÄ bands at the M point. Indeed, the extended
ACBN0 functional yields a splitting of 6.58 eV, compared
to 4.01 eV for the LDA. This overestimates the GW splitting of 4.89 eV, but is quite similar to the B3LYP value
of 6.14 eV 39 , which is probably linked to the way we are
approximating the screening in the ACBN0 functional.

7
.
Parameters
Uss
Upp
Usp
Vss
Vsp
Vpp

This work
3.68
3.55
2.29
0.94
1.37
1.86

Ref. 26
2.82
3.65
3.18
1.40
1.36
1.34

TABLE II. Effective electronic parameters of silicon calculated from the extended ACBN0 functional, compared to the
one obtained by linear response26 . The parameters labeled by
U correspond to on-site interactions whereas the ones labeled
by V correspond to the nearest neighbor interactions.
FIG. 4.
Left panel: Band structure of graphene, calculated using the LDA (dashed black lines), compared to the
LDA+U + V calculation (red lines). Right-panel: comparison of the band-dispersion close to the K point. The GW
data (blue dotted lines) are taken from Ref. 38.

C.

Silicon

In Ref. 26, LDA+U + V method was applied to bulk
silicon, as a test case of weakly correlated semiconductor
material that is well understood. They showed that this
corrective functional improves the values of direct and
indirect bandgaps compared to LDA. The calculated values of on-site U and intersite V interactions, obtained
from our functional, are compared in Tab. II to the values obtained from linear-response calculation in 3 √ó 3 √ó 3
supercell calculation26 . We employed an 8 √ó 8 √ó 8 kpoint grid to sample the Brillouin zone, a grid spacing of
0.5 Bohr and norm-conserving Pseudodojo pseudopotential36 . The lattice constant is taken to be the experimental one of a = 5.431AÃä. Overall, our results are found to be
in reasonable agreement with the values of Ref. 26, even
if we are getting significant differences for some of the
values. This can be tracked to different implementations,
different pseudopotentials, and the difference between the
supercell treatment and the primitive one, as the screening is computed in a different way in the two approaches.
However, it is worth noting that the band structure of
silicon computed from LDA+U + V almost matches perfectly the one obtained from linear response values, as
shown in Fig. 5. This shows that whereas the values of
U and V are not fully transferable from one implementation to another one, the observables obtained from the
two approaches, the extended ACBN0 functional and linear response, are very similar. We checked that using the
generalized gradient approximation instead of the LDA
one for the exchange-correlation part does not lead to a
significant change of the calculated values of the effective
electronic parameters.

.
FIG. 5. Band structure of bulk silicon calculated using the
LDA (dashed black lines) , compared to the one obtained
from the LDA+U + V method (red lines). The blue dots correspond to the LDA+U + V calculation from linear-response
calculation of U and V in supercell26 . Only valence bands
and the first conduction band are shown.

D.

Transition metal oxides: MnO and NiO

We now turn our attention to transition metal oxides,
for which it is quite common to employ the DFT+U
method to improve the description of electronic correlations. We computed the density of state of both bulk
NiO and bulk MnO in their antiferromagnetic phase,
as shown in Figs. 6 and 7. The magnetic moment
obtained for the different functionals are reported in
Tab. III. All the calculations presented here were performed considering type-II antiferromagnetic materials
below their his NeÃÅel temperature. Below its NeÃÅel temperature (TN = 523K40 ), NiO exhibits a rhombohedral
structure, which is obtained by contraction of the original
cubic cell along one of the [111] directions.40 However, we
have neglected the small distortions and considered NiO
(and MnO) in its cubic rock-salt structure. Calculations
were performed using a lattice parameter of 4.1704 AÃä
for NiO and 4.4315 AÃä for MnO, a real-space spacing of
‚àÜr = 0.2 Bohr, and a 8 √ó 8 √ó 8 k-point grid to sam-

8
ple their Brillouin zones. We employed norm-conserving
pseudo-potentials, and all orbitals available were considered for localization. A broadening of 0.1 eV was used
to mimic the experimental broadening of the density of
states.
Functional
PBE
ACBN0
eACBN0
Exp.
a
b
c
d

Reference
Reference
Reference
Reference

NiO
1.15
1.57
1.64
1.64a , 1.90b

MnO
4.13
4.39
4.36
4.58c , 4.79d

41
42
42
43

TABLE III. Calculated magnetic moments of the transition
metal atoms for different methods, in Bohr magneton, compared to the experimental values. The magnetic moments are
computed by taking a sphere around the atoms, with respectively a radius of 1.11AÃä and 1.04AÃä for NiO and MnO.

As many prior studies, see for instance Refs. 44 and
45, we found that the semi-local Perdew-Burke-Ernzerhof
(PBE)46 functional produces a very small bandgap for
NiO. Adding a Hubbard U improves the energy bandgap
compared to the experiment. This also changes the shape
of the peaks located around -5eV and -7eV. Considering the intersite interaction (bottom panel of Fig. 6) improves further the bandgap. Moreover, it induces a splitting of the broad peak obtained at the PBE+U level
into two peaks, corresponding to O-p bands and Ni-d
bands, and improves the position of the satellite peak
to be at -6 eV. These three peaks make that the density of states computed at the extended ACBN0 level is
improved compared to the calculation considering only
the on-site interaction, even if notable differences compared to the experiment still persists. It is important
to note that these effects are the same as the one obtained from self-consistent linear-response evaluation of
the on-site and intersite interactions, which shows again
that our approach qualitatively captures the same effects
as the linear-response method of Ref.26 . We find that
the magnetic moment of NiO is also improved using the
extended ACBN0 functional compared to the PBE+U
result, see Tab. III.
The calculation performed for bulk MnO also show,
at the PBE level, the same effects as reported before in
the literature44,45 : there is a wrong splitting of the density of states for the top valence bands, the bandgap is
too small, and the bottom of the valence bands shows a
double peak, as for NiO, which is also not correct. We
found that these features are already corrected very well
by the addition on an on-site interaction, which yield a
nice agreement with the experimental result. Interestingly, the addition of an intersite interaction does not
produces any sizable difference, compared to a simple
PBE+U calculation. The magnetic moment of the Mn
atom is also not much affected by the inclusion of the

FIG. 6.
Comparison of the density of states of NiO
obtained using the LDA (top panel),the ACBN0 functional (DFT+U ; middle panel), and the extended ACBN0
functional (DFT+U + V ; bottom panel), with the experimental one obtained from photoemission and inverse
photoemission47 . The energies were shifted such that the top
of the valence band corresponds to the zero of energy in all
cases.

intersite interaction, see Tab. III.
These calculations show that in the case where the onsite interaction is not enough to describe the electronic
properties, the ab initio evaluation of the intersite interaction improves the description of the electronic properties, whereas when the on-site interaction is enough,
adding the intersite interaction does not degrade the electronic properties.

E.

Band gaps of semiconductors and insulators

After investigating in details the effect of our functional
on the electronic properties of specific materials, we finally want to discuss its performance on the electronic
band gaps of a series of semiconductors and insulators.
It is indeed interesting to wonder if this functional can be
used without having to rely on some knowledge of how
the localization takes place, and to use it as a pseudohybrid functional. Our results, presented in Tab. IV, are
obtained using a 8 √ó 8 √ó 8 k-point grid for sampling the
Brillouin zone of each material. We employed the experimental lattice constant and used PBE norm-conserving

9

Ar
C
Si
Ge
LiF
MgO
BN
AlSb
AlP
AlAs
GaAs
NiO
MnO
TiO2
ZnO
MARE(%)

PBE ACBN0 eACBN0 G0 W0
8.66
13.08
13.07
13.2849
4.19
4.28
5.71
5.5049
0.61
0.44
1.30
1.1249
0.04
0.00
0.03
0.6649
9.14
11.13
12.19
13.2749
4.78
5.54
6.71
7.2549
4.30
5.30
5.78
5.8549
1.22
1.14
1.78
1.8050
1.56
1.77
2.83
2.3950
1.43
1.46
2.47
2.0950
0.52
0.35
1.14
1.6449
1.01
2.14
2.29
1.149
0.99
0.24
0.32
1.749
1.91
2.61
2.83
3.1849
0.95
3.51
3.61
2.6849
48.9
38.97
19.48
14.71

exp.
14.2049
5.4849
1.1749
0.7449
14.2049
7.8349
6.2549
1.6250
2.4549
2.1550
1.5249
4.024
4.124
3.03-3.324
3.4424

TABLE IV. Electronic band gaps, in eV, calculated as the
differences of Kohn-Sham eigenvalues for various materials.
Calculations were performed at the experimental lattice constant. The mean absolute relative error (MARE) is also reported.
FIG. 7. Same as Fig. 6, but for bulk MnO. Experimental
data are taken from Ref. 48.

Pseudodojo pseudopotential36 . For each materials we
converged the spacing such that it yields a converged
PBE bandgap at 20 meV. In the case of ACBN0 and
eACBN0 calculations, all atomic orbitals available from
the pseudopotentials were employed to construct the localized subspaces. This implies that different pseudopotentials will lead to different intersite interactions, as for
instance some pseudopotentials provide d orbitals for Si,
whereas some other do not. Overall, we find that the
choice of the pseudopotential does not affect too much
the band gaps obtained by the functional, except in the
case of partially occupied d orbitals, such as in transition
metal oxides, and there we note that some important deviations can be observed, as for example in NiO.
The mean absolute relative error obtained for the
eACBN0 functional (19.48%) shows that overall the
functional improves drastically the energy bandgap of
semiconductor and insulators, compared to PBE (which
yields a MARE of 48.9%) and PBE+U , as this latter only
mildly improves upon PBE. The results obtained with
the eACBN0 are reasonably close to the one obtained
with a by-far more expansive G0 W0 method, which gives
for this set of materials a MARE of 14.71%.
This shows that beyond the set of specific materials presented above, the functional properly improves the description of electronic properties for a large variety of
solids, without having to select a priori on which type of
orbitals the localization has to take place.

V.

CONCLUSION

In conclusion, we presented an efficient method to
compute ab initio and self-consistently the effective electronic parameters U , J, and V . We implemented the
DFT+U + V and our novel energy functional in the realspace TDDFT code Octopus29 . We showed results for
ground-state calculations showing that our implementation yields results in good agreement with the ones
previously reported in the literature. We applied our
functional to a correlated nodal-line semimetal, ZrSiSe,
showing that our functional produces very similar results
to the one obtained from a by far more expensive hybrid functional calculation. Applied to low-dimensional
sp compounds, our functional gives results in qualitative
agreement with cRPA calculations. We tested our functional on bulk silicon and bulk transition metal oxides,
and we found that our functional reproduces well the results of linear-response in supercell26 . Finally, we applied
it to a set of semiconductors and insulators, showing that
the electronic bandgap is well improved compared PBE
and PBE+U , and that the functional performs reasonably well compared to G0 W0 .
Let us comment on the choice of localized orbitals. In
this work we employed pseudo-atomic orbitals obtained
from the pseudopotentials. Whereas we found that for
s ‚àí p semiconductors, the choice of the pseudopotential
is quite irrelevant for the obtained results, we observed
significant differences for transition metal oxides depending on the choice of the pseudopotentials. This can be
seen as a limitation of our method. However, our approach is not limited to pseudopotential-based codes and

10
can straightforwardly be used using any type of localized orbitals, such as for instance Wannier orbitals. One
can therefore get rid of the pseudopotential dependency,
or at least reduce it drastically, by applying the present
method on Wannier orbitals constructed on-the-fly, such
as for instance using the SCDM-k method51
Finally, we note that in this work we followed Ref. 26
and only considered specific intersite interaction. Determining how reliable and general is this approximation
will require further investigations and would require extending the presented energy functional to include other
intersite interactions. The method we presented here is
general enough such that one could easily extend it to
include other interaction terms. The present work also
suggests that when evaluating the expensive exchange
operator, most of the Coulomb integrals might not be
very relevant and some of them can maybe be neglected,
based on physical considerations.
The extension of this functional to the time-dependent
case, or its performance on forces and vibrational properties of solids, will be investigated in a future work.

interaction energy for noncollinear spin systems
Eee =

X UI X X
2

I

‚àíœÉ‚àíœÉ
nœÉœÉ
mm nm0 m0 +

œÉ mm0

U I ‚àí J I X X œÉœÉ œÉœÉ
nmm nm0 m0
2
0
œÉ
m6=m

I

U X X œÉ‚àíœÉ ‚àíœÉœÉ J I X X œÉ‚àíœÉ ‚àíœÉœÉ
‚àí
n
nmm nm0 m0
n
‚àí
2 œÉ m mm mm
2 œÉ
m6=m0
"
#
X VIJ X X
IœÉœÉ JœÉ 0 œÉ 0
IJœÉœÉ 0 JIœÉ 0 œÉ
+
nmm nm0 m0 ‚àí nmm0 nm0 m .
2
0
0

(A1)

œÉœÉ mm

I6=J

In the fully localized limit, the corresponding double
counting term is given for the on-site interaction by52
#
"
X UI
JI I NI
JI I
on‚àísite
I
I
I
N (N ‚àí1)‚àí N (
‚àí1)‚àí m . m ,
EDC
=
2
2
2
4
I
(A2)
where m isP
theP
magnetization of the localized subspace16 ,
and N I = œÉ m nI,œÉœÉ
mm is the number of electrons in the
localized orbitals of the site I.
For the inter-site interaction, the double counting term
is given by
inter‚àísite
EDC
=

‚àó
X
V

2

IJ

NINJ .

(A3)

ACKNOWLEDGMENTS

N.T.-D. would like to acknowledge M. A. Sentef for
interesting and fruitful discussions. This work was supported by the European Research Council (ERC-2015AdG694097), the Cluster of Excellence Advanced Imaging of Matter‚Äô (AIM), Grupos Consolidados (IT1249-19)
and SFB925. The Flatiron Institute is a division of the
Simons Foundation.

Appendix A: DFT+U+V with noncollinear spin

Putting everything together, one obtains that the
rotationally-invariant form corresponding to Eq. (8) for
the noncollinear spins reads
#
"
X UI ‚àí JI X X
X X I,œÉœÉ0 I,œÉ0 œÉ
I,œÉœÉ
nmm0 nm0 m
EU V =
nmm ‚àí
2
0
0
œÉ m
mm œÉœÉ

I

‚àí

‚àó
X
VIJ X X

2

IJ

0

0

JI,œÉ œÉ
nIJ,œÉœÉ
mm0 nm0 m .

(A4)

mm0 œÉœÉ 0

which is very similar to the expression Eq. (8) presented
in the main text, with the exception that the trace is done
also on the spin coordinates for the on-site and inter-site
interactions. The corresponding potential is given by
i
X UI ‚àí J I X X h
0
œÉ
œÉ
II
œÉ0
VU V |œànk
i=
Œ¥mm0 Œ¥œÉœÉ0 ‚àí 2nI,œÉ
0
m m Pmm0 |œànk i
2
0
0
mm

I

In this section we present the formula we obtained as
we extended the DFT+U +V to the noncollinear spin
case. Based on the same approximation as before, we arrive to the following expression for the electron-electron

‚àí

‚àó
X

VIJ

IJ

XX

œÉ

0

0

œÉ IJ
œÉ
eik.RIJ nJI,œÉ
m0 m Pmm0 |œànk i .

mm0 œÉœÉ 0

Based on the expression Eq. A1, we obtain the expression for the inter-site V for the non-colinear spin case as
h
i
0 0
P
P
IJ,œÉœÉ 0 JI,œÉ 0 œÉ
I I
J
J
I,œÉœÉ J,œÉ œÉ
(œÜ
œÜ
|œÜ
œÜ
)
nÃÑ
nÃÑ
‚àí
nÃÑ
nÃÑ
0
0
0
0
0
0
0
0
m
m
mm
m
m
mm
mm
mm
œÉœÉ
1 mm

VÃÑ IJ =
.
(A6)
P
P  IœÉœÉ JœÉ0 œÉ0
0 JIœÉ 0 œÉ
2
IJœÉœÉ
n n 0 0 ‚àín 0 n 0
0
0
m,m

œÉœÉ

Appendix B: Forces

In this section we present the formula we obtained for
the contribution to the forces acting on an atom Œ± along

mm m m

mm

mm

the direction i coming from the intersite term. This is

(A5)

11
given by

‚àÇEV
‚àÇEV ‚àÇnIJ,œÉ
mm0
= ‚àí IJ,œÉ
‚àÇRŒ±,i
‚àÇR
Œ±,i
‚àÇnmm0
"
#
IJ,œÉ
JI,œÉ
X
‚àÇn
‚àÇn
0
0
mm
mm
nJI,œÉ
+ nIJ,œÉ
(. B1)
m0 m
mm0
‚àÇRŒ±,i
‚àÇRŒ±,i
0
V
FŒ±,i
=‚àí

=

‚àó
X
V IJ
IJ

2

m,m ,œÉ

As for the case of DFT+U 16 , the derivative of the generalized occupation matrix is expressed in terms of the
derivative of the orbitals to reduce the so-called egg-box

‚àó
‚Ä†
1

2

3

4
5

6

7

8

9

10

11

12

13

14

15

16

17

18

19

nicolas.tancogne-dejean@mpsd.mpg.de
angel.rubio@mpsd.mpg.de
V. I. Anisimov, F. Aryasetiawan, and A. Lichtenstein,
Journal of Physics: Condensed Matter 9, 767 (1997).
B. Himmetoglu, A. Floris, S. Gironcoli, and M. Cococcioni, International Journal of Quantum Chemistry 114,
14 (2014).
W. Metzner and D. Vollhardt, Phys. Rev. Lett. 62, 324
(1989).
A. Georges and G. Kotliar, Phys. Rev. B 45, 6479 (1992).
G. Kotliar, S. Y. Savrasov, K. Haule, V. S. Oudovenko,
O. Parcollet, and C. A. Marianetti, Rev. Mod. Phys. 78,
865 (2006).
T. Miyake and F. Aryasetiawan, Phys. Rev. B 77, 085122
(2008).
M. Aichhorn, L. Pourovskii, V. Vildosola, M. Ferrero,
O. Parcollet, T. Miyake, A. Georges, and S. Biermann,
Phys. Rev. B 80, 085101 (2009).
T. Miyake, F. Aryasetiawan, and M. Imada, Phys. Rev.
B 80, 155134 (2009).
M. Aichhorn, S. Biermann, T. Miyake, A. Georges, and
M. Imada, Phys. Rev. B 82, 064504 (2010).
V. I. Anisimov, J. Zaanen, and O. K. Andersen, Physical
Review B 44, 943 (1991).
V. I. Anisimov, I. V. Solovyev, M. A. Korotin, M. T.
CzyzÃáyk, and G. A. Sawatzky, Physical Review B 48, 16929
(1993).
A. I. Liechtenstein, V. I. Anisimov, and J. Zaanen, Physical Review B 52, R5467 (1995).
L. Xian, D. M. Kennes, N. Tancogne-Dejean, M. Altarelli,
and A. Rubio, Nano letters 19, 4934 (2019).
N. Tancogne-Dejean, M. A. Sentef, and A. Rubio, Phys.
Rev. Lett. 121, 097402 (2018).
G. E. Topp, N. Tancogne-Dejean, A. F. Kemper, A. Rubio,
and M. A. Sentef, Nature communications 9, 4452 (2018).
N. Tancogne-Dejean, M. J. T. Oliveira, and A. Rubio,
Phys. Rev. B 96, 245133 (2017).
V. I. Anisimov, I. S. Elfimov, N. Hamada, and K. Terakura, Phys. Rev. B 54, 4387 (1996).
P. Hansmann, T. Ayral, L. Vaugier, P. Werner, and
S. Biermann, Phys. Rev. Lett. 110, 166401 (2013).
H.-K. Tang, J. Leaw, J. Rodrigues, I. Herbut, P. Sengupta,
F. Assaad, and S. Adam, Science 361, 570 (2018).

effect. After some algebra, one obtains that
"
œÉ
X
‚àÇœàk,v
‚àÇnJI,œÉ
œÉ
m0 m
=
wk fk,v Œ¥Œ±,J hœÜJ,n,l
ihœàk,v
|œÜI,n,l
|
0
m,k i
m ,k
‚àÇRŒ±,i
‚àÇri
k,v
#
œÉ
‚àÇœàk,v
J,n,l
I,n,l
œÉ
+Œ¥Œ±,I hœÜm0 ,k |œàk,v ih
|œÜm,k i .
‚àÇri
(B2)
In the present expression, as in the ACBN0 case16 the
derivative of U , J, and V to the forces is not taken into
account. Moreover, in case of a LoÃàwdin orthonormalization, the contribution from the derivative of the overlap
matrix with respect to the atomic position is missing in
the previous expression. This will be explored in a further publication.

20

21

22
23

24

25

26

27

28

29

30

31

32

33

M. SchuÃàler, M. RoÃàsner, T. O. Wehling, A. I. Lichtenstein,
and M. I. Katsnelson, Phys. Rev. Lett. 111, 036601 (2013).
T. O. Wehling, E. SÃßasÃßƒ±ogÃÜlu, C. Friedrich, A. I. Lichtenstein,
M. I. Katsnelson, and S. BluÃàgel, Phys. Rev. Lett. 106,
236805 (2011).
V. J. Emery, Phys. Rev. Lett. 58, 2794 (1987).
H. J. Kulik, M. Cococcioni, D. A. Scherlis, and N. Marzari,
Phys. Rev. Lett. 97, 103001 (2006).
L. A. Agapito, S. Curtarolo, and M. Buongiorno Nardelli,
Phys. Rev. X 5, 011006 (2015).
S. L. Dudarev, G. A. Botton, S. Y. Savrasov, C. J.
Humphreys, and A. P. Sutton, Phys. Rev. B 57, 1505
(1998).
V. L. C. Jr and M. Cococcioni, Journal of Physics: Condensed Matter 22, 055602 (2010).
A. S. Belozerov, M. A. Korotin, V. I. Anisimov, and A. I.
Poteryaev, Phys. Rev. q
B 85, 045109 (2012).

as a definition of the
We found that using NÃÑœàIœÉnk NÃÑœàJœÉ
nk
weighting coefficient, which implies that a wavefunction
only localized to one site does not contribute to V , overscreens the intersite interaction V , for instance for binary
s ‚àí p semiconductors. In this manuscript, all the results
are presented for the weighting factor given by Eq. 13.
N. Tancogne-Dejean, M. J. T. Oliveira, X. Andrade, H. Appel, C. H. Borca, G. Le Breton, F. Buchholz, A. Castro, S. Corni, A. A. Correa, U. De Giovannini, A. Delgado, F. G. Eich, J. Flick, G. Gil, A. Gomez, N. Helbig,
H. Hbener, R. Jestdt, J. Jornet-Somoza, A. H. Larsen, I. V.
Lebedeva, M. Lders, M. A. L. Marques, S. T. Ohlmann,
S. Pipolo, M. Rampp, C. A. Rozzi, D. A. Strubbe, S. A.
Sato, C. Schfer, I. Theophilou, A. Welden, and A. Rubio, The Journal of Chemical Physics 152, 124119 (2020),
https://doi.org/10.1063/1.5142502.
M. J. Han, T. Ozaki, and J. Yu, Phys. Rev. B 73, 045110
(2006).
Y. Huh, E.-G. Moon, and Y. B. Kim, Phys. Rev. B 93,
035138 (2016).
Y. Klein, M. Casula, D. Santos-Cottin, A. Audouard,
D. Vignolles, G. FeÃÄve, V. Freulon, B. PlacÃßais, M. Verseils,
H. Yang, L. Paulatto, and A. Gauzzi, Phys. Rev. B 97,
075140 (2018).
A. N. Rudenko, E. A. Stepanov, A. I. Lichtenstein, and

12

34

35

36

37

38

39

40

41
42

M. I. Katsnelson, Phys. Rev. Lett. 120, 216401 (2018).
G. Gatti, A. Crepaldi, M. Puppin, N. Tancogne-Dejean,
L. Xian, S. Roth, S. ans Polishchuk, P. Bugnon, A. Magrez, H. Berger, F. Frassetto, L. Poletto, L. Moreschini,
A. Rotenberg, E.and Rubio, M. Chergui, and M. Grioni,
Submitted.
J. Heyd, G. E. Scuseria, and M. Ernzerhof, The Journal
of chemical physics 118, 8207 (2003).
M. Van Setten, M. Giantomassi, E. Bousquet, M. J. Verstraete, D. R. Hamann, X. Gonze, and G.-M. Rignanese,
Computer Physics Communications 226, 39 (2018).
K. Ohno, in Advances in quantum chemistry, Vol. 3 (Elsevier, 1967) pp. 239‚Äì322.
P. E. Trevisanutto, C. Giorgetti, L. Reining, M. Ladisa,
and V. Olevano, Physical review letters 101, 226405
(2008).
M. Lazzeri, C. Attaccalite, L. Wirtz, and F. Mauri, Phys.
Rev. B 78, 081406 (2008).
A. P. Cracknell and S. J. Joshua, Mathematical Proceedings of the Cambridge Philosophical Society 66, 493
(1969).
A. H. A., J. Phys. Soc. Jpn. 17, Suppl. B (1962).
A. K. Cheetham and D. A. O. Hope, Phys. Rev. B 27,

43

44

45

46

47

48

49
50

51

52

6964 (1983).
B. E. F. Fender, A. J. Jacobson, and F. A. Wedgwood,
The Journal of Chemical Physics 48, 990 (1968).
S. Mandal, K. Haule, K. M. Rabe, and D. Vanderbilt, npj
Computational Materials 5, 1 (2019).
F. Tran, P. Blaha, K. Schwarz, and P. NovaÃÅk, Phys. Rev.
B 74, 155108 (2006).
J. P. Perdew, K. Burke, and M. Ernzerhof, Phys. Rev.
Lett. 77, 3865 (1996).
G. A. Sawatzky and J. W. Allen, Phys. Rev. Lett. 53, 2339
(1984).
J. van Elp, R. H. Potze, H. Eskes, R. Berger, and G. A.
Sawatzky, Phys. Rev. B 44, 1530 (1991).
F. Tran and P. Blaha, Phys. Rev. Lett. 102, 226401 (2009).
D. Wing, J. B. Haber, R. Noff, B. Barker, D. A. Egger,
A. Ramasubramaniam, S. G. Louie, J. B. Neaton, and
L. Kronik, Phys. Rev. Materials 3, 064603 (2019).
A. Damle, L. Lin, and L. Ying, Journal of Computational
Physics 334, 1 (2017).
F. Bultmark, F. Cricchio, O. GraÃänaÃàs, and L. NordstroÃàm,
Phys. Rev. B 80, 035121 (2009).

