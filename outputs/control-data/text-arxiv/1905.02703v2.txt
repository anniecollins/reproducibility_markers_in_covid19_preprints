arXiv:1905.02703v2 [eess.SP] 21 Nov 2019

Fusion of Deep Neural Networks for Activity
Recognition: A Regular Vine Copula Based
Approach
Shan Zhang, Baocheng Geng and Pramod K. Varshney

Muralidhar Rangaswamy

Department of Electrical Engineering and Computer Science
Syracuse University, Syracuse, NY 13244
{szhang60, bageng, varshney}@syr.edu

Air Force Research Labs
Wright-Patterson Air Force Base, OH 45433
Muralidhar.Rangaswamy@us.af.mil

Abstractâ€”In this paper, we propose regular vine copula based
fusion of multiple deep neural network classifiers for the problem
of multi-sensor based human activity recognition. We take the
cross-modal dependence into account by employing regular vine
copulas that are extremely flexible and powerful graphical models
to characterize complex dependence among multiple modalities.
Multiple deep neural networks are used to extract high-level
features from multi-sensing modalities, with each deep neural
network processing the data collected from a single sensor. The
extracted high-level features are then combined using a regular
vine copula model. Numerical experiments are conducted to
demonstrate the effectiveness of our approach.

I. I NTRODUCTION
The recent development of small-size, low-power, multifunctional sensors and revolutionary advances in communication and computing technologies have resulted in many applications of sensor/information fusion. One such application is
human activity recognition (HAR) that can be used for health
care, personal fitness, and border surveillance, etc. [1]â€“[3].
The task of HAR is to detect and recognize human actions
from the data provided by multiple sensors. HAR is naturally
a classification task. Combining multiple sensing modalities
can boost the classification performance. However, since each
sensor carries a unique physical trait, sensor heterogeneity or
incommensurability is the first critical challenge for multimodal fusion. Also, multiple sensor modalities tend to be
dependent due to non-linear cross-modal interactions. In this
paper, we study a classification problem by fusing multiple
classifiers, one for each modality, for the recognition of human
actions. Thus, the data compatibility issues among multiple
modalities can be avoided [4], [5]. Moreover, the non-linear
dependence is also addressed.
Most of the current multi-classifier fusion solutions for HAR
rely on shallow classifiers, such as Support Vector Machines
(SVMs), Random Forests and Decision Trees, which employ
handcrafted statistical features extracted from each modality.
The typical strategy for the fusion of these features is to
combine the outputs obtained from multiple classifiers, where
The work was supported by Air Force Office of Scientific Research under
Grant FA9550-17-1-0313 under the DDDAS program.

each classifier only takes the features of one modality [6]â€“[11].
Since the multivariate sensor observations are dependent, the
outputs from the multiple classifiers are inherently dependent.
This dependence can be non-linear. The design of an optimal
fusion rule that can address this non-linear dependence becomes the key issue. In the aforementioned literature [6]â€“[11],
simple fusion rules, such as majority voting, naive Bayesian
fusion, weighted average fusion, and Dempster-Shafer fusion,
were used. None of these existing fusion rules in [6]â€“[11]
exploit the non-linear dependence among multiple classifiers.
Moreover, designing and selecting robust features heavily
relies on human experience and is time consuming. Also,
only shallow features, such as mean, variance and amplitude,
can be learned according to human expertise, which can be
insufficient for more complex activities [12].
Deep learning has had breakthroughs in a wide variety
of unimodal applications, such as visual object recognition,
natural language processing and object detection [13]. Compared to the shallow classifiers, the deep classifiers can learn
many more high-level features directly from raw data (or
lightly processed data) and avoid the need for the design of
handcrafted features. Recently, single deep learning models for
HAR have been discussed in detail in the survey paper [14].
Very recently, multimodal deep learning methodologies for
HAR have attracted some attention [15], [16]. Similar fusion
strategies as discussed for multiple shallow classifiers can be
applied to deep neural networks, based on the level where
the fusion is performed: intermediate fusion with higher-level
representations, referred to as high-level features, late fusion
with decisions or probability scores. In [15], [16], intermediate
fusion strategies using Deep Neural Networks (DNNs) and
Convolutional Neural Networks (CNNs) were studied, where
a fully connected fusion layer was used to combine multiple
DNNs or CNNs. As mentioned earlier, the data from multiple sensing modalities are non-linearly dependent. The fully
connected fusion layer can learn this dependence in some
manner. However, understanding and analyzing this non-linear
dependence using the fully connected layer or another deep
neural network is yet to be solved.
Copula-based dependence modeling [17] provides a flexible

parametric characterization of the joint distribution of multiple
sensor observations. It allows the separation of modeling
different univariate marginals from modeling the multivariate
(dependence) structure. The separated multivariate structure
is referred to as a multivariate copula that can characterize
non-linear or even more complex dependence. It has been
shown that copula-based fusion of multiple sensing modalities
can significantly improve the inference performance [3], [18]â€“
[21]. However, for high-dimensional dependence structures,
the underlying dependence can be more complex and the
well defined multivariate copula functions, e.g., multivariate
Gaussian copulas, multivariate Student-t copulas, may lack
the ability to characterize the potential complex dependence
[22]. In this paper, we adopt a more general copula model,
regular vine (R-Vine) copulas [23]â€“[25] that are constructed by
decomposing a multivariate copula into a cascade of bivariate
copulas.
In this paper, we propose to leverage the DNNs and
the R-Vine copula based dependence modeling for sensorbased recognition of human actions. More specifically, we use
multiple DNNs to extract high-level features from multiple
sensing modalities, where each DNN only takes the data from
a single sensor. Different from the fusion strategy (using a
fully connected fusion layer) in [15], [16], we propose a
probabilistic fusion methodology, R-Vine copula based fusion
rule, that combines the extracted high-level features and characterizes the cross-modal dependence. Moreover, our proposed
model is designed to improve the classification performance
compared to the neural network based fusion method and
adds interpretability in the sense that it explicitly explains the
dependence structure of the extracted features from different
modalities.

II. C OPULA T HEORY
A copula is a multivariate distribution with uniform
marginal distributions. The unique correspondence between a
multivariate copula and any multivariate distribution is stated
in Sklarâ€™s theorem [26] which is a fundamental theorem that
forms the basis of copula theory. Also, for high-dimensional
dependence structures, more flexible R-Vine copulas are constructed by decomposing a multivariate copula into a set of
bivariate copulas, which will be discussed in Section IV.
Theorem 1 (Sklarâ€™s Theorem): The joint distribution
function F of random variables x1 , . . . , xd can be cast as
F (x1 , x2 , . . . , xd ) = C(F1 (x1 ), F2 (x2 ), . . . , Fd (xd )),

(1)

where F1 , . . . , Fd are marginal distribution functions for
x1 , . . . , xd . If Fm , m = 1, . . . , d are continuous, C is a
unique d-dimensional copula. Conversely, given a copula
C and univariate Cumulative Distribution Functions (CDFs)
F1 , . . . , Fd , F in (1) is a valid multivariate CDF with
marginals F1 , . . . , Fd .

For continuous distributions F and F1 , . . . , Fd , the joint
Probability Density Function (PDF) of random variables
x1 , . . . , xd is obtained by differentiating both sides of (1):
f (x1 , . . . , xd ) =

d
Y


fm (xm ) c(F1 (x1 ), . . . , Fd (xd )), (2)

m=1

where f1 , . . . , fd are the marginal densities and c is referred
to as the density of the multivariate copula C that is given by
c(u) =

âˆ‚ L (C(u1 , . . . , ud ))
,
âˆ‚u1 , . . . , âˆ‚ud

(3)

where um = Fm (xm ) and u = [u1 , . . . , ud ]. Note that
C(Â·) is a valid CDF and c(Â·) is a valid PDF for uniformly
distributed random variables um , m = 1, 2, . . . , d. Since the
random variable um represents the CDF of xm , the CDF of
um naturally follows a uniform distribution over [0, 1].
Various families of multivariate copula functions are presented in [26], such as elliptical and Archimedean copulas.
Since different copula functions model different types of dependence, selection of copula functions to fit the given data is
a key problem. Moreover, the dependence parameter denoted
by Ï†, contained in a copula function, is used to characterize the
amount of dependence among d random variables. Typically,
Ï† is unknown a priori and needs to be estimated, e.g., using
Maximum Likelihood Estimation (MLE) or Kendallâ€™s Ï„ [27].
Note that in general, Ï† may be a scalar, a vector or a matrix.
III. P ROBLEM S TATEMENT
Consider a supervised classification problem with G classes.
Let â„¦ = {w1 , w2 , . . . , wG } be the set of class labels. L sensors
make a set of observations regarding the object/event at time
instant n, {x1n , x2n , . . . , xLn , yn }, where n = 1, 2, . . . and
1
2
xln âˆˆ Rdl Ã—dl , d1l , d2l âˆˆ N, N = [1, 2, . . .] is the observation of
sensor l at time n. yn âˆˆ â„¦ is the class label. We assume that
the sensor observations are continuous random variables that
are conditionally independent and identically distributed (i.i.d.)
over time. L independent pre-trained DNN classifiers are used
to extract high-level features from each sensing modality. A
typical DNN is shown in Fig. 1. Compared to the traditional
artificial neural networks, DNN is more capable of learning
informative features from large amount of data. We use hln âˆˆ
R1Ã—rl , rl âˆˆ N to represent the nth high-level feature vector
extracted from sensor l. These high-level features are then
combined using the R-Vine copula based fusion rule. We show
the classification system to be studied in Fig. 2.
Remark 1: Note that for the sensor-based HAR, we use
the DNNs to extract high-level features instead of CNNs.
There are two main reasons. The first one is that compared
to DNNs, CNNs are computationally more intensive. The
second one is that the high-level features extracted from
CNNs are generally high dimensional. Also, among these high
dimensional features, a large number of features are irrelevant
and redundant. Fusing all the features based on R-Vine copula
models is computationally inefficient.
Our aim is to determine the class label by combining the
extracted high-level features. Assume that we have a training

dependence structure that is fully characterized by the copula
(see (2)). Therefore, we have

f (h|wi ) =

N Y
K
Y
n=1

Fig. 1: A typical Deep Neural Network structure [15].

Sensor ğŸğŸ

DNN

High-level ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ… ğ’‰ğ’‰ğŸğŸ

Sensor ğ’ğ’

DNN

Highâˆ’level ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ… ğ’‰ğ’‰ğ’ğ’

Sensor ğ‘³ğ‘³

DNN

Highâˆ’level ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ…ğ… ğ’‰ğ’‰ğ‘³ğ‘³

â‹®
â‹®

R-Vine Copula
Based Fusion

Classification
Decision

Fig. 2: R-Vine Copula Based Multi-modal DNN.

set with a total of N feature vectors and the joint feature vector
is
1Ã—(r1 +r2 +...+rL )
hn = [h1n h2n . . . hL
, n = [N ],
n] âˆˆ R

f (h|wi )P (wi )
âˆ f (h|wi )P (wi ),
f (h)

(5)

where h = [h1 , . . . , hN ], f (h|wi ) is the joint likelihood
function and P (wi ) is the prior probability for class wi . If
the class prior probabilities are not known, it is commonly
assumed that the classes are equally likely. The class label
w0 is determined by choosing the label with highest posterior
probability, which is given by
w0 = arg max P (wi |h).
wi âˆˆâ„¦

(6)

Since f (h) is a constant for all the classes, the main problem
is how to model and maximize f (h|wi ) under unknown
multivariate dependence. In the following section, we will use
R-Vine copulas to model the joint likelihood function.
IV. R-V INE C OPULA BASED F USION OF M ULTIPLE D EEP
N EURAL N ETWORKS
In this section, we present the R-Vine copula based fusion
rule. Our goal now is to find the joint PDFs of feature vectors
h under each class. According to Sklarâ€™s theorem (Section
II), the joint PDF can be separated into its marginals and the

(7)

k=1

where fk (hkn |wi ), k = 1, . . . , K are the marginal PDFs and
i
Fi (hn ) = [F1i (h1n ), . . . , FK
(hKn )] denotes all the marginal
CDFs at time instant n under class wi , wi âˆˆ â„¦. Moreover,
ci is the copula density function for class wi and Ï†i is the
corresponding parameter set.
Since we have no knowledge of the joint distributions of
the extracted high-level features, the marginal PDFs, marginal
CDFs, copula density functions and their corresponding parameters need to be estimated using the training dataset. The
estimation of the marginal distributions and optimal copula
density functions for all the classes is similar. Therefore, the
class index i will be omitted for now to simplify notations.
The marginal PDFs can be estimated non-parametrically
using kernel density estimators [28] that provide a smoothed
estimate of true density by choosing the optimal bandwidth
so that an accurate estimate is achieved. Further, the marginal
CDFs can be determined by the Empirical Probability Integral
Transforms (EPIT) [18]. The estimate of Fk (Â·) is given as

(4)

where [N ] = [1, 2, . . . , N ]. In the following, for notational
simplicity, we omit the superscripts of the feature vectors in
(4) and let hn = [h1n , h2n , . . . , hKn ], K = r1 + r2 + . . . + rL .
Using Bayesâ€™ theorem, the posterior probability of class wi
given the joint high-level feature vectors is given as:
P (wi |h) =

 

fk (hkn |wi ) ci Fi (hn )|Ï†i ,

FÌ‚k (Â·) =

N
1 X
1h <{Â·} ,
N n=1 kn

(8)

where 1{Â·} is the indicator function.
Next, we discuss how to construct and find the optimal
multivariate copula câˆ— using R-Vine copula models, which was
introduced by Bedford and Cooke in [23], [24].

A. R-Vine copula Models
Before we give the formal definition of the R-Vine copula,
we first introduce R-Vine. A d dimensional R-Vine V =
(T1 , . . . , Tdâˆ’1 ) is a nest of d âˆ’ 1 trees, where the edges of
the tree Ti are the nodes of the tree Ti+1 , and if two edges
in tree Ti share a common node, they are connected in tree
Ti+1 . By specifying bivariate copulas on each of the edges,
we obtain R-Vine copula and it is defined as follows.
Definition 1 (R-Vine Copula): An R-Vine copula consists
of three parts, denoted by (F, V, B), where
1) F = [F1 , F2 , . . . , Fd ]T âˆˆ [0, 1]d is a vector with uniform
marginals.
2) V is a d-dimensional R-Vine.
3) B = {CCe,a ,Ce,b |De | e = {a, b} âˆˆ Ei , i = 1, 2, . . . , d âˆ’
1; Ï†} is a set of bivariate copulas with a set of parameters
Ï†, where Ei is the edge set for tree Ti , Ce,a , Ce,b
are the conditioned nodes of the edge e and De is the
conditioning node set of the edge e.

ğ’„ğ’„ğŸğŸ,ğŸğŸ (ï¿½; ğœ±ğœ±ğŸğŸ,ğŸğŸ )

1

f (zk )

Y

Ã—

(9)
3,4|2

cCe,a ,Ce,b |De (FCe,a |De (zCe,a |zDe ), FCe,b |De (zCe,b |zDe ); Ï†),
where e = {a, b} and zDe = {zj |j âˆˆ De }, f (zk ) is the
marginal PDF of the observation of variable k, k = 1, . . . , K.
Moreover, the conditional distribution FCe,a |De (zCe,a |zDe ) can
be obtained recursively tree by tree using the following equation [29]:


âˆ‚CCa,a1,Ca,a2|Da FCa,a1|Da(zCa,a1|zDa), FCa,a2|Da(zCa,a2 |zDa)
,
âˆ‚FCa,a2|Da(zCa,a2|zDa)
(10)
where e = {a, b} âˆˆ Ei , a = {a1 , a2 } and b = {b1 , b2 } are
the edges that connect Ce,a and Ce,b given the conditioning
variables De . Similarly, we can obtain FCe,b |De (zCe,b |zDe ).
An illustrative 5-dimensional R-Vine copula example is
shown in Fig. 3. For variables z1 , z2 , z3 , z4 , z5 and if they
share the same dependence structure as in Fig. 3, according
to (9), their joint PDF can be expressed as
" 5
#
Y
f (z1 ,z2 ,z3 ,z4 ,z5 ) =
f (zl ) Â·c1,2 Â·c2,3 Â·c2,4 Â·c3,5 Â·c1,3|2

2,3

ğ’„ğ’„ğŸğŸ,ğŸ“ğŸ“|ğŸ‘ğŸ‘ (ï¿½; ğœ±ğœ±ğŸğŸ,ğŸ“ğŸ“|ğŸ‘ğŸ‘ )

ğ‘»ğ‘»ğŸğŸ

3,5

1,3|2

ğ’„ğ’„ğŸğŸ,ğŸ“ğŸ“|ğŸğŸğŸğŸ (ï¿½; ğœ±ğœ±ğŸğŸ,ğŸ“ğŸ“|ğŸğŸğŸğŸ )

ğ’„ğ’„ğŸ’ğŸ’,ğŸ“ğŸ“|ğŸğŸğŸğŸğŸğŸ (ï¿½; ğœ±ğœ±ğŸ’ğŸ’,ğŸ“ğŸ“|ğŸğŸğŸğŸğŸğŸ )

2,5|3

ğ‘»ğ‘»ğŸ‘ğŸ‘

ğ‘»ğ‘»ğŸ’ğŸ’

1,5|23

omit the conditioning elements for conditional marginal CDFs.
Note that the conditional marginal CDFs can be obtained
recursively using (10).
The best copula câˆ— is selected from the copula library C
using the Akaike Information Criterion (AIC) [31] as the
criterion, which is given as
AICm = âˆ’

N
X

log cm (FÌ‚k1 (hk1 n ), FÌ‚k2 (hk2 n )|Ï†Ì‚m ) + 2q(K),

n=1

(12)
where q(K) is the number of parameters in the mth copula model. Also, the conditioning elements for conditional
marginal CDFs are omitted.
The best copula câˆ— is
câˆ— = arg min AICm .

(13)

V. N UMERICAL R ESULTS

B. Estimation of Optimal R-Vine copula
The estimation of optimal R-Vine copula model for the
joint feature vector h requires the selection of the R-Vine
tree structure V, the choice of copula families for the bivariate copula set B and the estimation of their corresponding
parameters Ï†. To select the optimal R-Vine tree structure,
we adopt the sequential maximum spanning tree algorithm
in [30]. This sequential method is based on Kendallâ€™s Ï„ . The
sequential method starts with the selection of the first tree
T1 and continues tree by tree up to the last tree TKâˆ’1 . The
trees are selected in a way that the chosen bivariate copula
models the strongest pair-wise dependencies present which
are characterized by Kendallâ€™s Ï„ . After the optimal R-Vine
tree structure is selected, we need to define a bivariate copula
family and estimate the optimal bivariate copulas that best
characterizes the pair-wise dependencies.
Consider a library of copula, C = {cm : m = 1, 2, . . . , M }
Before estimating the optimal bivariate copula, the copula
parameter set Ï† is first obtained using MLE, which is given
by
log c(FÌ‚k1 (hk1 n ), FÌ‚k2 (hk2 n )|Ï†),

ğ‘»ğ‘»ğŸğŸ

cm âˆˆC

where the inputs for the bivariate copulas are omitted.

Ï†

5

Fig. 3: An example R-Vine copula for five variables.

Â·c3,4|2 Â·c2,5|3 Â·c1,4|23 Â·c1,5|23 Â·c4,5|123 ,

N
X

ğ’„ğ’„ğŸğŸ,ğŸ’ğŸ’|ğŸğŸğŸğŸ (ï¿½; ğœ±ğœ±ğŸğŸ,ğŸ’ğŸ’|ğŸğŸğŸğŸ )
1,4|23

l=1

Ï†Ì‚ = arg max

ğ’„ğ’„ğŸ‘ğŸ‘,ğŸ“ğŸ“ (ï¿½; ğœ±ğœ±ğŸ‘ğŸ‘,ğŸ“ğŸ“ )

3

2,4

i=1 eâˆˆEi

k=1

ğ’„ğ’„ğŸğŸ,ğŸ‘ğŸ‘|ğŸğŸ (ï¿½; ğœ±ğœ±ğŸğŸ,ğŸ‘ğŸ‘|ğŸğŸ )

ğ’„ğ’„ğŸ‘ğŸ‘,ğŸ’ğŸ’|ğŸğŸ (ï¿½; ğœ±ğœ±ğŸ‘ğŸ‘,ğŸ’ğŸ’|ğŸğŸ )

f (z|V, B, Ï†) =

Kâˆ’1
Y

ğ’„ğ’„ğŸğŸ,ğŸ‘ğŸ‘ (ï¿½; ğœ±ğœ±ğŸğŸ,ğŸ‘ğŸ‘ )

4

1,2

K
Y

2
ğ’„ğ’„ğŸğŸ,ğŸ’ğŸ’ (ï¿½; ğœ±ğœ±ğŸğŸ,ğŸ’ğŸ’ )

Using the R-Vine copula model and Sklarâ€™s theorem,
the joint PDF of a K-dimensional observation vector z =
[z1 , . . . , zK ] is given by

(11)

n=1

where (k1 , k2 ), k1 , k2 âˆˆ [1, 2, . . . , K] is a connected pair in the
selected R-Vine tree V and for simplification of notation, we

In this section, we demonstrate the efficacy of our proposed
R-Vine copula based methodology for the fusion of multiple
DNNs. To show the superiority of our proposed fusion scheme,
we also compare our result with the classification performance
obtained by using the following schemes:
â€¢ Single modality without fusion: Feed the raw data into a
DNN classifier.
â€¢ Data-level fusion: Concatenate all the raw data from
different modalities into one input vector and feed it into
a DNN classifier.
â€¢ Fully connected layer fusion: Concatenate the extracted
features into one feature vector and use a fully connected
fusion layer to achieve a final classification decision.
TABLE I: STISEN: F1 scores for Watch-DNN, Phone-DNN, Fullyconnected layer fusion, Data-level fusion, R-Vine copula fusion.
Model
Watch-DNN
Phone-DNN
Fully-connected layer fusion
Data-level fusion
R-Vine copula fusion

F1 score
71.4%
70.2%
78.0%
79.3%
88.6%

A. Datasets
We select two publicly available datasets that contain multimodality sensor readings for the recognition of human activities.

TABLE II: ANGUITA: F1 scores for Accelerometer-DNN,
Gyroscope-DNN, Fully-connected layer fusion, Data-level fusion, RVine copula fusion.
Model
Accelerometer-DNN
Gyroscope-DNN
Fully-connected layer fusion
Data-level fusion
R-Vine copula fusion

F1 score
87.8%
72.9%
91.9%
88.3%
92.8%

STISEN Heterogeneity Activity Recognition Dataset, collected by Stisen et al. [32], contains the sensor readings
from two modalities: smartphone and smart watch. Each
modality is equipped with two motion sensors, accelerometer
and gyroscope. There are 6 classes (â€˜Sitâ€™, â€˜Standâ€™, â€˜Walkâ€™,
â€˜Stairsupâ€™, â€˜Stairsdownâ€™, â€˜Bikeâ€™) to be classified. We focus
on the fusion of phone and watch modalities. Each of the
two motion sensors produces a three-dimensional data vector,
making each data sample contain 6 attributes in total. We select
the data captured by Samsung Galaxy S3 mini phone and
Samsung Galaxy Gear watch, where the data samples were
sampled at a rate of 100 Hz. 9000 samples from each modality
are used to train and test DNN models for feature selection,
and another 9000 samples are used to train and test the R-Vine
copula based fusion methodology.
ANGUITA Human Activity Recognition Using Smartphone
Dataset, collected by Anguita et al. [33], contains accelerometer and gyroscope three-dimensional sensor data. It was
collected from 30 volunteers who performed six different activities (â€˜Walkingâ€™, â€˜Walking-upstairsâ€™, â€˜Walking-downstairsâ€™,
â€˜Sitingâ€™, â€˜Standingâ€™, â€˜Layingâ€™). We focus on the fusion of
accelerometer and gyroscope modalities. These sensor data
were sampled at a rate of 50 Hz, and were separated into
windows of 128 values. Each window has 50% overlap with
the previous window. The 128-real value vector in each
window stands for one sample for each activity.
B. Classification Accuracy
We use F1 score as the classification performance metric,
which is given by
2 X precisionw Ã— recallw
,
(14)
F1 =
|â„¦| w precisionw + recallw
P
TP
where precision = T PT+F
P and recall = T P +F N . Here, TP,
FP and FN denote true positive, false positive and false negative, respectively. F1 score is robust to unbalanced distributions
of data samples across classes.
Table I and Table II show the F1 scores comparing the
five classification schemes: two single modalities based DNN
classifiers and three multi-modal fusion based DNN classifiers
for the STISEN and ANGUITA datasets, respectively. As
we can see, fusion based schemes perform better than single
modality based schemes. Also, our proposed R-Vine copula
based fusion methodology performs better than using the datalevel fusion scheme and fully connected fusion layer scheme.
Our proposed methodology achieves an overall 88.6% and

92.8% F1 scores for the STISEN and ANGUITA datasets,
respectively. Moreover, we can see that for phone and watch
modalities, the R-Vine copula based fusion scheme achieves
higher performance improvement compared to accelerometer
and gyroscope modalities. This is because of the fact that
the accelerometer and gyroscope are less dependent while the
phone and watch are highly dependent.
It should be noted that the training of R-Vine copula models
requires less number of training samples compared to the
training of a fully connected fusion layer or another DNN used
for fusion. In Table I and Table II, the performance of our RVine copula scheme is obtained by using a total of N = 1200
feature samples. However, the fully connected fusion layer
based scheme requires a total of N = 6000 feature samples.
In Fig. 4, we show the first level dependence structure (first
tree of the R-Vine copula model; see Fig. 3 as an example) of
the extracted features using our proposed R-Vine copula based
fusion method for activity â€˜Walking-upstairsâ€™ in ANGUITA
dataset. Here, features h1 , h2 , h3 , h4 are from the accelerometer while the features h5 , h6 , h7 are from the gyroscope. As
we can see that, features h3 and h6 are highly correlated and
the two modalities accelerometer and gyroscope are correlated
mainly via these two features. Using the knowledge of intramodal and cross-modal feature dependencies, we can trace
back and find where these dependent features originated from,
which would yield the reduction of training data needed in
DNNs. Furthermore, we are able to understand the correlation
among the raw data from different modalities. The R-Vine
copula based fusion method adds interpretability of the model
which explicitly provides the dependence structure for features
from different modalities, compared to the neural network
based fusion which is totally a â€˜black-boxâ€™ model.
ğ’‰ğ’‰ğŸğŸ
ğ’‰ğ’‰ğŸğŸ

ğ’‰ğ’‰ğŸ’ğŸ’

ğ’‰ğ’‰ğŸ‘ğŸ‘

ğ’‰ğ’‰ğŸ”ğŸ”

ğ’‰ğ’‰ğŸ•ğŸ•

ğ’‰ğ’‰ğŸ“ğŸ“

Fig. 4: First level dependence structure for activity â€˜Walking-upstairsâ€™.

Table III and Table IV show the confusion matrices using
the R-Vine copula based fusion scheme for the STISEN and
ANGUITA datasets, respectively. As we observe, the fusion
of phone and watch modalities achieves perfect classification
for static activities (â€˜Sitâ€™ and â€˜Standâ€™). Also, the fusion of the
accelerometer and gyroscope from the smartphone achieves
significantly accurate classification for moving activities (e.g.,
â€˜Walkingâ€™, â€˜Layingâ€™).
VI. C ONCLUSION
In this paper, an R-Vine copula based feature fusion approach was presented to perform activity recognition using
multi-modal sensor observations. The features of each modality were extracted via a DNN and afterwards, an R-Vine
copula model was constructed to capture the dependencies
of intra-modal and cross-modal features. The procedures of

TABLE III: STISEN: Confusion matrix for R-Vine copula based fusion.
Sit
Stand
Walk
Stairsup
Stairsdown
Bike
Precision

Sit
498
0
0
0
0
0
100.0%

Stand
0
454
0
0
0
0
100.0%

Walk
0
0
402
24
39
8
85.0%

Stairsup
0
0
43
408
53
4
80.3%

Stairsdown
2
46
17
50
408
2
77.7%

Bike
0
0
38
0
0
486
89.7%

Recall
99.6%
90.8%
80.4%
81.6%
81.6%
97.2%
88.6%

TABLE IV: ANGUITA: Confusion matrix for R-Vine copula based fusion.
Walking
Walking-upstairs
Waking-downstairs
Sitting
Standing
Laying
Precision

W
276
6
8
3
3
2
92.6%

WU
0
259
0
6
3
0
96.6%

WD
17
0
211
1
2
0
91.3%

model construction involve selecting the optimal R-Vine tree
structure, obtaining the copula parameter set Ï†, and choosing
the best copula câˆ— . Experiments on two human activity datasets
demonstrated the efficiency of our proposed method compared
to neural network based data/feature fusion, in terms of high
prediction accuracy, less number of training samples required
and dependence interpretability. In the future, we aim to
address the problem of feature selection while constructing
copula fusion model to achieve the balance of computation
efforts and classification performance.
R EFERENCES
[1] Pang Wu, Huan-Kai Peng, Jiang Zhu, and Ying Zhang, â€œSenscare: Semiautomatic activity summarization system for elderly care,â€ in International Conference on Mobile Computing, Applications, and Services.
Springer, 2011, pp. 1â€“19.
[2] Pang Wu, Jiang Zhu, and Joy Ying Zhang, â€œMobisens: A versatile
mobile sensing platform for real-world applications,â€ Mobile Networks
and Applications, vol. 18, no. 1, pp. 60â€“80, 2013.
[3] Satish G Iyengar, Pramod K Varshney, and Thyagaraju Damarla, â€œOn
the detection of footsteps based on acoustic and seismic sensing,â€ in
2007 41st Asilomar Conference on Signals, Systems and Computers,
2007.
[4] Jiquan Ngiam, Aditya Khosla, Mingyu Kim, Juhan Nam, Honglak Lee,
and Andrew Y Ng, â€œMultimodal deep learning,â€ in Proceedings of the
28th international conference on machine learning (ICML-11), 2011,
pp. 689â€“696.
[5] Dana Lahat, TuÌˆlay Adali, and Christian Jutten, â€œMultimodal data fusion:
an overview of methods, challenges, and prospects,â€ Proceedings of the
IEEE, vol. 103, no. 9, pp. 1449â€“1477, 2015.
[6] Piero Zappi, Thomas Stiefmeier, Elisabetta Farella, Daniel Roggen, Luca
Benini, and Gerhard Troster, â€œActivity recognition from on-body sensors
by classifier fusion: sensor scalability and robustness,â€ in Intelligent
Sensors, Sensor Networks and Information, 2007. ISSNIP 2007. 3rd
International Conference on. IEEE, 2007, pp. 281â€“286.
[7] Maja Stikic, TaÌ‚m Huynh, Kristof Van Laerhoven, and Bernt Schiele,
â€œAdl recognition based on the combination of rfid and accelerometer
sensing,â€ in Pervasive Computing Technologies for Healthcare, 2008.
PervasiveHealth 2008. Second International Conference on. IEEE, 2008,
pp. 258â€“263.
[8] Ming Li, Viktor RozgicÌ, Gautam Thatte, Sangwon Lee, Adar Emken,
Murali Annavaram, Urbashi Mitra, Donna Spruijt-Metz, and Shrikanth
Narayanan, â€œMultimodal physical activity recognition by fusing temporal and cepstral information,â€ IEEE transactions on neural systems
and rehabilitation engineering: a publication of the IEEE Engineering
in Medicine and Biology Society, vol. 18, no. 4, pp. 369, 2010.

Si
3
3
0
248
26
0
88.6%

St
0
3
1
33
298
6
87.4%

L
0
0
0
0
0
329
100.0%

Recall
93.2%
95.6%.
95.9%
85.2%
87.4%
97.63%
92.8%

[9] Oresti Banos, Miguel Damas, Hector Pomares, Fernando Rojas, Blanca
Delgado-Marquez, and Olga Valenzuela, â€œHuman activity recognition
based on a sensor weighting hierarchical classifier,â€ Soft Computing,
vol. 17, no. 2, pp. 333â€“343, 2013.
[10] Haodong Guo, Ling Chen, Liangying Peng, and Gencai Chen, â€œWearable
sensor based multimodal human activity recognition exploiting the
diversity of classifier ensemble,â€ in Proceedings of the 2016 ACM
International Joint Conference on Pervasive and Ubiquitous Computing.
ACM, 2016, pp. 1112â€“1123.
[11] Henry Friday Nweke, Ying Wah Teh, Ghulam Mujtaba, and Mohammed Ali Al-garadi, â€œData fusion and multiple classifier systems
for human activity detection and health monitoring: Review and open
research directions,â€ Information Fusion, vol. 46, pp. 147â€“170, 2019.
[12] Jianbo Yang, Minh Nhut Nguyen, Phyo Phyo San, Xiaoli Li, and Shonali
Krishnaswamy, â€œDeep convolutional neural networks on multichannel
time series for human activity recognition.,â€ in Ijcai, 2015, vol. 15, pp.
3995â€“4001.
[13] Yann LeCun, Yoshua Bengio, and Geoffrey Hinton, â€œDeep learning,â€
nature, vol. 521, no. 7553, pp. 436, 2015.
[14] Jindong Wang, Yiqiang Chen, Shuji Hao, Xiaohui Peng, and Lisha Hu,
â€œDeep learning for sensor-based activity recognition: A survey,â€ Pattern
Recognition Letters, 2018.
[15] Valentin Radu, Catherine Tong, Sourav Bhattacharya, Nicholas D Lane,
Cecilia Mascolo, Mahesh K Marina, and Fahim Kawsar, â€œMultimodal
deep learning for activity and context recognition,â€ Proceedings of the
ACM on Interactive, Mobile, Wearable and Ubiquitous Technologies,
vol. 1, no. 4, pp. 157, 2018.
[16] Fernando Moya Rueda, ReneÌ Grzeszick, Gernot A Fink, Sascha Feldhorst, and Michael ten Hompel, â€œConvolutional neural networks for
human activity recognition using body-worn sensors,â€ in Informatics.
Multidisciplinary Digital Publishing Institute, 2018, vol. 5, p. 26.
[17] Harry Joe, Dependence modeling with copulas, CRC Press, 2014.
[18] Hao He, Arun Subramanian, Pramod K Varshney, and Thyagaraju
Damarla, â€œFusing heterogeneous data for detection under non-stationary
dependence,â€ in 2012 15th International Conference on Information
Fusion (FUSION). IEEE, 2012, pp. 1792â€“1799.
[19] Ashok Sundaresan and Pramod K Varshney, â€œLocation estimation of a
random signal source based on correlated sensor observations,â€ IEEE
Transactions on Signal Processing, vol. 59, no. 2, pp. 787â€“799, 2011.
[20] Satish G Iyengar, Pramod K Varshney, and Thyagaraju Damarla, â€œBiometric authentication: a copula based approach,â€ Multibiometrics for
Human Identification, pp. 95â€“119, 2011.
[21] Hao He, Arun Subramanian, Sora Choi, Pramod K Varshney, and Thyagaraju Damarla, â€œSocial media data assisted inference with application
to stock prediction,â€ in 2015 49th Asilomar Conference on Signals,
Systems and Computers. IEEE, 2015, pp. 1801â€“1805.
[22] Shan Zhang, Lakshmi Narasimhan Theagarajan, Sora Choi, and
Pramod K Varshney, â€œFusion of correlated decisions using regular vine
copulas,â€ IEEE Transactions on Signal Processing, 2019.

[23] Tim Bedford and Roger M Cooke, â€œProbability density decomposition
for conditionally dependent random variables modeled by vines,â€ Annals
of Mathematics and Artificial intelligence, vol. 32, no. 1-4, pp. 245â€“268,
2001.
[24] Tim Bedford and Roger M Cooke, â€œVines: A new graphical model for
dependent random variables,â€ Annals of Statistics, pp. 1031â€“1068, 2002.
[25] Kjersti Aas, Claudia Czado, Arnoldo Frigessi, and Henrik Bakken, â€œPaircopula constructions of multiple dependence,â€ Insurance: Mathematics
and economics, vol. 44, no. 2, pp. 182â€“198, 2009.
[26] Roger B Nelsen, An introduction to copulas, vol. 139, Springer Science
& Business Media, 2013.
[27] Hao He, Heterogeneous sensor signal processing for inference with
nonlinear dependence, Ph.D. thesis, Syracuse University, 2015.
[28] L Wassermann, â€œAll of nonparametric statistics,â€ 2006.
[29] Harry Joe, â€œFamilies of m-variate distributions with given margins and
m (m-1)/2 bivariate dependence parameters,â€ Lecture Notes-Monograph
Series, pp. 120â€“141, 1996.
[30] Jeffrey Dissmann, Eike C Brechmann, Claudia Czado, and Dorota
Kurowicka, â€œSelecting and estimating regular vine copulae and application to financial returns,â€ Computational Statistics & Data Analysis,
vol. 59, pp. 52â€“69, 2013.
[31] Hirotogu Akaike, BN Petrov, and F Csaki, â€œInformation theory and an
extension of the maximum likelihood principle,â€ 1973.
[32] Allan Stisen, Henrik Blunck, Sourav Bhattacharya, Thor Siiger Prentow,
Mikkel Baun KjÃ¦rgaard, Anind Dey, Tobias Sonne, and Mads MÃ¸ller
Jensen, â€œSmart devices are different: Assessing and mitigatingmobile
sensing heterogeneities for activity recognition,â€ in Proceedings of the
13th ACM Conference on Embedded Networked Sensor Systems. ACM,
2015, pp. 127â€“140.
[33] Davide Anguita, Alessandro Ghio, Luca Oneto, Xavier Parra, and
Jorge Luis Reyes-Ortiz, â€œA public domain dataset for human activity
recognition using smartphones.,â€ in Esann, 2013.

