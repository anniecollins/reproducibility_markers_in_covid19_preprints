On algebraic extensions and decomposition
of homomorphisms of free groups

arXiv:1907.00243v3 [math.GR] 27 Oct 2020

Noam Kolodner
Abstract
We give a counterexample to a conjecture by Miasnikov, Ventura and Weil, stating that an
extension of free groups is algebraic if and only if the corresponding morphism of their core
graphs is onto, for every basis of the ambient group. In the course of the proof we present a
partition of the set of homomorphisms between free groups which is of independent interest.

1

Introduction

The purpose of this paper is to develop new machinery for the study of morphisms between core
graphs associated with free groups (see definitions in Â§2). For this purpose, we construct a category
which enriches that of free groups and enables to study surjectivity with respect to arbitrary bases.
The main application we give is a counterexample to a conjecture by Miasnikov, Ventura, and Weil
[MVW07] which was revised by Parzanchevski and Puder [PP14].
Conjecture 1.1 ([MVW07]). Let FY be a free group on the set Y , and let H â‰¤ K â‰¤ FY be
subgroups. If the morphism between the associated core-graphs Î“X (H) â†’ Î“X (K) is surjective for
every basis X of FY , then K is an algebraic extension of H.
The converse is indeed true: if H â‰¤ K is an algebraic extension, then Î“B (H) â†’ Î“B (K) is
indeed onto for any basis B. In [PP14], Parzanchevski and Puder constructed a counterexample for
the conjecture in F2 , the free group on two generators. Their proof relies heavily on idiosyncrasies
of the automorphism group of F2 , and they conjectured that these are the only obstructions,
revising the conjecture in two ways:
Conjecture 1.2 ([PP14]). Let H â‰¤ K â‰¤ FY . If for every free extension F 0 of FY and for every
basis X of F 0 the morphism Î“X (H) â†’ Î“X (K) is onto then K is algebraic over H.
Conjecture 1.3 ([PP14]). The original conjecture holds for H â‰¤ K â‰¤ FY such that |Y | > 2.
In this paper, we show that both revised forms of the conjecture are false. In fact, we prove a
stronger statement:
Theorem 1.4. The extension hbbabaâˆ’1 i < hb, abaâˆ’1 i is not algebraic, but for every morphism

Ï• : F{a,b} â†’ FX with
X arbitrary and Ï•(a), Ï•(b) 6= 1, the graph morphism Î“X Ï• hbbabaâˆ’1 i â†’

Î“X Ï•(hb, abaâˆ’1 i) is surjective.
Our result naturally raises the question what is the algebraic interpretation (if one exists at all)
of the property of being â€œonto in all basesâ€, as the one suggested by the conjectures above turns
out to be false. In addition, the methods which we develop for the analysis of our counterexample
are of independent interest: The first idea is extending the scope of inspection from the category
of automorphisms to a larger category of homomorphisms called FGR (â€œFree Groups with Restrictionsâ€), which is defined in Â§3. In the new category we present a recursive decomposition of
morphisms, which in turn enables ones to verify whether the desired property of graphs holds for
all FGR homomorphisms. A second point of interest is the observation of a property of the word
bbabaâˆ’1 which ensures that the recursive process ends. This property is defined in Â§6, and leads to
further questions and applications, for example to solving some forms of equations in free groups.
Acknowledgement. I am grateful to Ori Parzanchevski for his guidance and for carefully reading
and commenting on a draft of this paper. I would also like to thank the referee for the helpful
comments. This research was supported by ISF grant 1031/17 of Ori Parzanchevski.
1

2

Preliminaries

We present the definitions we use in the paper, merging the language of [KM02] and [Sta83].
Definition 2.1 (Graphs). We use graphs in the sense of Serre [Ser77]: A graph Î“ is a set V (Î“) of
vertices and a set E (Î“) of edges with a function Î¹ : E (Î“) â†’ V (Î“) called the initial vertex map and
e
an involution : E (Î“) â†’ E (Î“) with e 6= e and e = e. A graph morphism f : Î“ â†’ âˆ† is a pair of set
E
functions f : E (Î“) â†’ E (âˆ†) and f V : V (Î“) â†’ V (âˆ†) that commute with the structure functions.
A path in Î“ is a finite sequence e1 , . . . , en âˆˆ E (Î“) with Î¹ (ek ) = Î¹ (ek+1 ) for every 1 â‰¤ k < n. The
path is closed if Î¹ (en ) = Î¹ (e1 ), and reduced if ek+1 6= ek for all k. All the graphs in the paper are
assumed to be connected unless specified otherwise, namely, for every e, f âˆˆ E (Î“) there is a path
e, e1 , . . . , en , f .
Definition 2.2 (Labeled graphs). Let X be a set and let X âˆ’1 be the set of its formal inverses.
We define RX to be the graph with E (RX ) = X âˆª X âˆ’1 , V (RX ) = {âˆ—}, x = xâˆ’1 and Î¹ (x) = âˆ—.
An X-labeled graph is a graph Î“ together with a graph morphism l : Î“ â†’ RX . A morphism of
X-labeled graphs Î“ and âˆ† is a graph morphism f : Î“ â†’ âˆ† that commutes with the label functions.
Let P (Î“) be the set of all the paths in Î“, let FX be the free group on X and let P = e1 , . . . , en
be a path. The edge part of the label function lE : E (Î“) â†’ E (RX ) can be extended to a function
l : P (Î“) â†’ FX by the rule l (P ) = l (e1 ) . . . (en ).
A pointed X-labeled graph is an X-labeled graph that has a distinguished vertex called the
base point. A morphism of a pointed labeled graph sends the base point to the base point. This
constitutes a category called X-Grph. For a pointed X-labeled graph Î“ we define Ï€1 (Î“) to be
Ï€1 (Î“) = {l (P ) âˆˆ FX | P is a closed path beginning at the base point} .
Definition 2.3. Let FX be the free group on the set X. We define a category Sub (FX ), whose
objects are subgroups H â‰¤ FX and there is a unique morphism in Hom (H, K) iff H â‰¤ K. It is
easy to verify that Ï€1 is a functor from X-Grph to Sub (FX ).
Note: The functor Ï€1 defined above is not the fundamental group of Î“ as a topological space.
Rather, if one views Î“ and RX as topological spaces and l as a continuous function, then Ï€1 is the
image of the fundamental group of Î“ in that of RX under the group homomorphism induced by l.
Definition 2.4 (Folding). A labeled graph Î“ is folded if l (e) 6= l (f ) holds for every two edges
e, f âˆˆ E (Î“) with Î¹ (f ) = Î¹ (e). We notice that there is at most one morphism between two pointed
folded labeled graphs. If Î“ is not folded, there exist e, f âˆˆ E (Î“) such that Î¹ (e) = Î¹ (f ) and
l (e) = l (f ); Let Î“0 be the graph obtained by identifying the vertex Î¹ (e) with Î¹ f , the edges e
with f and e with f . We say Î“0 is the result of folding e and f . The label function l factors through
Î“0 , yielding a label function l0 on Î“0 , and we notice that Ï€1 (Î“) = Ï€1 (Î“0 ).
Definition 2.5 (Core graph). A core graph Î“ is a labeled, folded, pointed graph such that every
edge in Î“ belongs in a closed reduced path around the base point. Is case of finite graphs this is
equivalent to every v âˆˆ V (Î“) having deg(v) := |Î¹âˆ’1 (v)| > 1 except the base point which can have
any degree.
Definition 2.6. Let X-CGrph be the category of connected, pointed, folded, X-labeled core
graphs. Define a functor Î“X : Sub (FX ) â†’ X-CGrph that associates to the subgroup H â‰¤ FX a
graph Î“X (H) (which is unique up to a unique isomorphism) such that Ï€1 (Î“X (H)) = H.
Fact 2.7 ([Sta83, KM02]). The functors Ï€1 and Î“ define an equivalence between the categories
X-CGrph and Sub (FX ).
The correspondence between the categories of X-CGrph and Sub (FX ) follows from the theory
of cover spaces. Let us sketch a proof. We regard RX as a topological space and look at the category
of connected pointed cover spaces of RX . This category is equivalent to Sub (FX ), following from
the fact that RX has a universal cover. Let Î“ be a connected folded X-labeled core graph, viewed as
a topological space and l as a continuous function. There is a unique way up to cover isomorphism
to extend Î“ to a cover of RX . There is also a unique way to associate a core graph to a cover
space of RX . This gives us an equivalence between the category of connected pointed cover spaces
of RX and pointed connected folded X-labeled core graphs.
2

Definition 2.8. By uniqueness of the core graph of a subgroup we can define a functor
Core : X-Grph â†’ X-CGrph that associates to a graph Î“ a core graph such that Ï€1 (Core (Î“)) =
Ï€1 (Î“).
Definition 2.9. Let Î“ be a graph with a vertex v of degree one which is not the base-point. For
e = Î¹âˆ’1 (v), let Î“0 be the graph with V (Î“0 ) = V (Î“) \ {v} and E (Î“0 ) = E (Î“) \ {e, e}. We say that
Î“0 is the result of trimming e from Î“, and we notice that Ï€1 (Î“) = Ï€1 (Î“0 ).
Remark 2.10. For a finite graph Î“, after both trimming and folding |E (Î“0 )| < |E (Î“)|. If no
foldings or trimmings are possible then Î“ is a core graph. This means that after preforming a finite
amount of trimmings and foldings we arrive at Core (Î“). It follows from the uniqueness of Core (Î“)
that the order in which one performs the trimmings and foldings does not matter.
Definition 2.11 (Algebraic extension). Let H â‰¤ K â‰¤ FX be subgroups. The subgroup K is said
to be an algebraic extension of H if there exists no proper free factor J of K with H â‰¤ J < K.
Conjecture 1.1 is the converse to the following:
Fact 2.12 ([MVW07]). If H â‰¤ K â‰¤ FX and H â‰¤ K is an algebraic extension then Î“Y (H) â†’
Î“Y (K) is onto for every basis Y of FX .
Another motivation for this conjecture is the fact that in a specific case it is true
Fact 2.13. Let Y be a finite set then FY is algebraic over H iff Î“X (H) â†’ Î“X (FY ) is onto for
every basis X of FY (To see why this is true notice that Î“X (FY ) is a bouquet of circles for every
X).
When we combine Facts 2.12 and 2.13 we get a statement about intermediate subgroups which
is another motivation for the conjecture: Let H â‰¤ K â‰¤ FY then K is algebraic over H iff for every
L with K â‰¤ L â‰¤ FY and every basis X of L the morphism Î“X (H) â†’ Î“X (K) is onto.

3

The category FGR

Definition 3.1 (Whitehead graph). A 2-path in a graph Î“ is a pair (e, f ) âˆˆ E (Î“) Ã— E (Î“) with
Î¹ (f ) = Î¹ (e) and f 6= e. If Î“ is X-labeled, the set


W (Î“) = l (e) , l f | (e, f ) is a 2-path in Î“
forms the set of edges of a combinatorial (undirected) graph whose vertices are X âˆª X âˆ’1 , called the
Whitehead graph of Î“. If w âˆˆ FX is a cyclically reduced word, the Whitehead graph of w as defined
in [Whi36, Sta99] and the Whitehead graph of Î“ (hwi) defined here coincide. Let WX = W (RX )
be the set of edges of the Whitehead graph of RX , which we call the full Whitehead graph. Let
x, y âˆˆ X âˆª X âˆ’1 and let {x, y} âˆˆ WX be an edge. We denote x.y = {x, y} (this is similar to the
notation in [LS01]).
Definition 3.2. A homomorphism Ï• : FY â†’ FX is non-degenerate if Ï• (y) 6= 1 for every y âˆˆ Y .
Definition 3.3. Let w âˆˆ FX be a reduced word of length n. Define Î“w to be the X-labeled graph
with V (Î“w ) = {1, . . . , n + 1} forming a path P labeled by l (P ) = w. Notice that Î“w âˆ¼
= Î“wâˆ’1 .
Definition 3.4. Let Ï• : FY â†’ FX be a non-degenerate homomorphism. We define a functor
FÏ• from Y -labeled graphs to X-labeled graphs by sending y-labeled edges to Ï• (y)-labeled paths.
Formally, let âˆ† be a Y -labeled graph and let E0 = {e âˆˆ E (âˆ†) |l (e) âˆˆ Y } be an orientation of âˆ†,
namely, E (âˆ†) = E0 t {e | e âˆˆ E0 }. For every e âˆˆ E (âˆ†) let ne âˆˆ N be the length of the word
Ï• (l (e))Fâˆˆ FX plus one. We consider V (âˆ†) as a graph without edges, take
 the disjoint union of
graphs eâˆˆE0 Î“Ï•(l(e)) t V (âˆ†) and for every e âˆˆ E0 glue 1 âˆˆ V Î“Ï•(l(e)) to Î¹ (e) âˆˆ V (âˆ†), and

ne âˆˆ V Î“Ï•(l(e)) to Î¹ (e) âˆˆ V (âˆ†). As for functoriality, if f : âˆ† â†’ Îž is a morphism of Y -labeled
graphs, FÏ• f is defined as follows: every edge in FÏ• (âˆ†) belongs to a path FÏ• (e) for some e âˆˆ E(âˆ†),
and we define (FÏ• f ) (FÏ• (e)) = FÏ• (f (e)).

3

The motivation for FÏ• is topological: thinking of âˆ†, RY , RX as topological spaces and of
l : âˆ† â†’ RY , Ï• : RY â†’ RX as continuous functions, we would like to think of âˆ† as an X-labeled
graph with the label function Ï• â—¦ l. The problem is that Ï• â—¦ l does not send edges to edges, and
we mend this by splitting edges in âˆ† to paths representing their images in RX .
Remark 3.5. For H â‰¤ FY we notice that Core(FÏ• Î“Y (H)) = Î“X (Ï• (H)).
Definition 3.6 (Stencil). Let Î“ be an Y -labeled graph, and Ï• : FY â†’ FX a non-degenerate
homomorphism. We say that the pair (Ï•, Î“) is a stencil iff FÏ• (Î“) is a folded graph. Notice that
if Î“ is not folded, then FÏ• (Î“) is not folded for any Ï•.
Definition 3.7. Let Ï„ : FX \ {1} â†’ X âˆª X âˆ’1 be the function returning the last letter of a reduced
word. For reduced words u, v in a free group, we write u Â· v to indicate that there is no cancellation
in their concatenation, namely Ï„ (u) 6= Ï„ (v âˆ’1 ).
We leave the proof of Lemmas 3.8 and 3.10 as easy exercises for the reader.
Lemma 3.8. Let Î“ be an Y -labeled graph and Ï• : FY â†’ FX a non-degenerate homomorphism.
âˆ’1
Then (Ï•, Î“) is a stencil iff Î“ is folded and for every x.y âˆˆ W (Î“) we have Ï• (x) Â· Ï• (y)
(i.e.
Ï„ (Ï• (x)) 6= Ï„ (Ï• (y))).
Proposition 3.9. Let Ï• : FZ â†’ FY and Ïˆ : FY â†’ FX be non-degenerate homomorphisms. The
equality FÏˆâ—¦Ï• = FÏˆ â—¦ FÏ• holds iff (Ïˆ, Î“Ï•(x) ) is a stencil for every x âˆˆ Z.
Proof. As FÏ• is defined by replacing edges by paths and gluing, it is enough to consider the graph
Î“x with a single edge labeled x âˆˆ Z. Both FÏˆâ—¦Ï• (Î“x ) and FÏˆ â—¦FÏ• (Î“x ) are paths whose labels equal
Ïˆ (Ï• (x)), but FÏˆâ—¦Ï• (Î“x ) is always folded whereas FÏˆ â—¦FÏ• (Î“x ) may not be. In fact, FÏ• (Î“x ) = Î“Ï•(x)
and so by definition FÏˆ â—¦ FÏ• (Î“x ) is folded iff (Ïˆ, Î“Ï•(x) ) is a stencil.
Lemma 3.10. Let Ï• and Ïˆ be homomorphism as in Proposition 3.9 (such that FÏˆâ—¦Ï• = FÏˆ â—¦ FÏ• )
and let x âˆˆ Z. Then Ï„ Ïˆ (Ï• (x)) = Ï„ Ïˆ (Ï„ Ï• (x)).
Definition 3.11 (FGR). The objects of the category Free Groups with Restrictions (FGR) are
pairs (Y, N ) where Y is a set of â€œgeneratorsâ€ and N âŠ† WX a set of â€œrestrictionsâ€. A morphism
Ï• âˆˆ Hom ((Y, N ) , (X, M )) is a group homomorphism Ï• : FY â†’ FX with the following properties:
(i)
(ii)
(iii)
(iv)

For every x âˆˆ Y , Ï• (x) 6= 1 (Ï• is non-degenerate).
For every x âˆˆ Y , W (Î“Ï•(x) ) âŠ† M .
For every x.y âˆˆ N , Ï•(x) Â· Ï•(y)âˆ’1 (i.e. Ï„ (Ï• (x)) 6= Ï„ (Ï• (y))).
For every x.y âˆˆ N , Ï„ (Ï• (x)) .Ï„ (Ï• (y)) âˆˆ M .1

A main motivation for this definition is the second part of the next Proposition.
Proposition 3.12. 1. FGR is a category, i.e. composition of morphisms is a morphism.
2. Any two composable FGR morphisms Ï•, Ïˆ satisfy FÏˆâ—¦Ï• = FÏˆ â—¦ FÏ• .
Ï•

Ïˆ

Proof. Let (X1 , N1 ) âˆ’â†’ (X2 , N2 ) âˆ’â†’ (X3 , N3 ). For any x âˆˆ X1 we have W (Î“Ï•(x) ) âŠ† N2 since Ï•
satisfies (ii). Since Ïˆ satisfies (iii), (Ïˆ, Î“Ï•(x) ) is a stencil, so that FÏˆâ—¦Ï• = FÏˆ â—¦FÏ• by Proposition 3.9.
This also implies len Ïˆ(Ï• (x)) â‰¥ len Ï• (x) â‰¥ 1, so that Ïˆ â—¦Ï• satisfies (i). As Î“Ïˆâ—¦Ï•(x) = FÏˆ (Î“Ï•(x) ),
we have
i 
 h[
W Î“Ïˆâ—¦Ï•(x) =
W (Î“Ïˆ(z) ) âˆª Ï„ Ïˆ (z) .Ï„ Ïˆ (y) | z.y âˆˆ W (Î“Ï•(x) )
z.yâˆˆW (Î“Ï•(x) )

The part in [ ] is contained in N3 since Ïˆ satisfies (ii), and the rest is contained in N3 since Ï•
satisfies (ii) and Ïˆ satisfies (iv), hence Ïˆâ—¦Ï• satisfies (ii). Finally, whenever x.y âˆˆ N1 , it follows from
(iv) for Ï• that Ï„ Ï• (x) .Ï„ Ï• (y) âˆˆ N2 , and from (iv) for Ïˆ that Ï„ Ïˆ(Ï„ Ï•(x)).Ï„ Ïˆ(Ï„ Ï•(y)) âˆˆ N3 . Using
Lemma 3.10 we see that Ï„ Ïˆ(Ï•(x)).Ï„ Ïˆ(Ï•(y)) âˆˆ N3 , hence Ïˆâ—¦Ï• satisfies (iv), and thus also (iii).
Lemma 3.13. An FGR morphism Ï• : (Y, N ) â†’ (X, M ) is an FGR-isomorphism iff Ï•|Y âˆªY âˆ’1 : Y âˆª
Y âˆ’1 â†’ X âˆª X âˆ’1 is a bijection that commutes with inversion and M = {Ï•(x).Ï•(y) | x.y âˆˆ N }.
1 Technically,

(iv) implies (iii), as M âŠ† WY and x.x âˆˆ
/ WY .

4

Proof. We show that if Ï• : (Y, N ) â†’ (X, M ) is an FGR-isomorphism then Ï•|Y âˆªY âˆ’1 : Y âˆª Y âˆ’1 â†’
X âˆª X âˆ’1 , and the rest is immediate. Let Ï• and Ïˆ be composable FGR morphisms. As Ïˆ, Î“Ï•(x)
is a stencil, for every x âˆˆ Y we have len (Ïˆ â—¦ Ï• (x)) â‰¥ len (Ï• (x)). Let x âˆˆ Y and let Ï• be an
isomorphism and Ïˆ its inverse. So len (Ï• (x)) â‰¤ len (Ïˆ â—¦ Ï• (x)) = len (x) = 1, and on the other
hand Ï• (x) 6= 1 implies len (Ï• (x)) = 1, namely Ï• (x) âˆˆ X âˆª X âˆ’1 .

3.1

Partition of Hom in FGR

Let X be a countably infinite set, Y a finite set and (Y, NY ) an FGR object. We present a
recursive partition of Hom ((Y, NY ), (X, WX )). The ultimate goal of this partition is decomposing
free group morphisms FY â†’ FX , and we notice that Hom ((Y, âˆ…) , (X, WX )) are all the nondegenerate homomorphisms in Hom (FY , FX ). In order to perform this recursive process we need
to consider morphisms with a general restriction set NY in the domain, but it is not necessary
to consider a general NX in place of WX (and in fact, the method presented does not work for a
general restriction set NX ).
Let Ï• âˆˆ Hom((Y, NY ), (X, WX )). If x.y âˆˆ NY then Ï•(x) Â· Ï•(y âˆ’1 ) by definition. Let x.y âˆˆ
WY \NY . There are five possible types of cancellation in the product Ï•(x)Ï•(y âˆ’1 ). Denote u =
Ï• (x), v = Ï• (y), and let t be the maximal subword canceled in uv âˆ’1 , so that u = u0 Â· t, v = v0 Â· t,
and uv âˆ’1 = u0 Â· v0âˆ’1 . The five types of cancellation are:
1.
2.
3.
4.
5.

No cancellation, namely t = 1.
u and v âˆ’1 do not absorb one another, namely t, u0 , v0 6= 1 and uv âˆ’1 = u0 Â· v0âˆ’1 .
u absorbs v âˆ’1 , namely t 6= 1, v0 = 1, u0 6= 1 and uv âˆ’1 = u0 .
v âˆ’1 absorbs u, namely t 6= 1, v0 6= 1, u0 = 1 and uv âˆ’1 = v0âˆ’1 .
u and v âˆ’1 cancel each other out, namely u = v.

If y = xâˆ’1 then only the first two types can occur, and if xâˆ’1 .y âˆ’1 âˆˆ NY only the first
four. For Ï• âˆˆ Hom ((Y, NY ), (X, WX )) and x.y âˆˆ WY \NY such that Ï•(x)Ï•(y âˆ’1 ) is of cani
âˆˆ
cellation type i, we define an FGR object (Ui , NUi ) and a so-called folding morphism Ïˆx.y
i
. Namely, there is an FGR morphism
Hom((Y, NY ), (Ui , NUi )), such that Ï• factors through Ïˆx.y
i
i
Ï•0 âˆˆ Hom ((Ui , NUi ), (X, WX )) with Ï• = Ï•0 â—¦ Ïˆx.y
. We describe Ui , NUi , Ïˆx.y
, Ï•0 for each type:
1
= Id, NU1 = NY âˆª {x.y}, and Ï•0 = Ï•.
1. U1 = Y , Ïˆx.y
2. There are two cases here, depending on whether x = y âˆ’1 or not: 
2
2
x 6= y âˆ’1 : U2 = Y t {s} and NU2 = Ï„ Ïˆx.y
(r).Ï„ Ïˆx.y
(z)|r.z âˆˆ NY âˆª x.sâˆ’1 , y.sâˆ’1 , x.y where

ï£±
z=x
ï£´
ï£´u0
ï£´
ï£²v
z=y
0
Ï•0 (z) =
ï£´t
z=s
ï£´
ï£´
ï£³
Ï• (z) z âˆˆ U2 \{xÂ±1 , y Â±1 , sÂ±1 }.

ï£±
ï£´
ï£²xs z = x
2
Ïˆx.y (z) = ys z = y
ï£´
ï£³
z
z âˆˆ Y \{xÂ±1 , y Â±1 }

2
2
(z)|r.z âˆˆ NY } âˆª {x.sâˆ’1 , y.sâˆ’1 , x.y} where
x = y âˆ’1 : U2 = Y t {s} and NU2 ={Ï„ Ïˆx.y
(r).Ï„ Ïˆx.y
ï£±
(
ï£´
z=x
ï£²u0
sâˆ’1 xs z = x
2
0
Ïˆx.y
(z) =
Ï•
(z)
=
t
z=s
ï£´
z
z âˆˆ Y \{xÂ±1 }
ï£³
Ï• (z) z âˆˆ U2 \{xÂ±1 , sÂ±1 }.

 3

3
3. U3 = Y and NU3 = Ï„ Ïˆx.y
(r) .Ï„ Ïˆx.y
(z) |r.z âˆˆ NY âˆª x.y âˆ’1 where
(
(
xy z = x
u0
z=x
3
0
Ïˆx.y (z) =
Ï• (z) =
z
z âˆˆ Y \{xÂ±1 }
Ï• (z) z âˆˆ U3 \{xÂ±1 }.
 4

4
4. U4 = Y and NU4 = Ï„ Ïˆx.y
(r) .Ï„ Ïˆx.y
(z) |r.z âˆˆ NY âˆª xâˆ’1 .y where
(
(
yx z = y
v0
z=y
4
0
Ïˆx.y (z) =
Ï• (z) =
Â±1
z
z âˆˆ Y \{y }
Ï• (z) z âˆˆ U4 \{y Â±1 }.
5

 5
5
5. U5 = Y âˆ’ {y} and NU5 = Ï„ Ïˆx.y
(r) .Ï„ Ïˆx.y
(z) |r.z âˆˆ NY where
(
x z=y
5
Ïˆx.y (z) =
Ï•0 (z) = Ï• (z) âˆ€z âˆˆ U5 .
z z âˆˆ Y \{y Â±1 }
iâˆ—
With x.y fixed, let Ïˆx.y
: Hom ((Ui , NUi ) , (X, WX )) â†’ Hom ((Y, NY ) , (X, WX )) be the induced
0
0
i
function Ï• 7â†’ Ï• â—¦ Ïˆx.y . We obtain that Hom ((Y, NY ) , (X, WX )) can be presented as a disjoint
union
G5
iâˆ—
Hom ((Y, NY ) , (X, WX )) =
Ïˆx.y
(Hom ((Ui , NUi ) , (X, WX ))) .
i=1

For every (Ui , NUi ), if NUi 6= WUi we continue recursively, choosing an edge x.y âˆˆ WUi \NUi and
partitioning Hom ((Ui , NUi ), (X, WX )) accordingly. We now show that no matter which edges are
chosen, this process terminates:
Theorem 3.14. Any Ï• âˆˆ Hom((Y, NY ), (X, WX )) decomposes as Ï• = Ï•0 â—¦ Ïˆk â—¦ Â· Â· Â· â—¦ Ïˆ1 such that
1. The morphisms Ïˆj : Ujâˆ’1 â†’ Uj (1 â‰¤ j â‰¤ k, U0 = Y ) are folding morphisms.
2. NUk = WUk , and in particular Ï•0 (x) Â· Ï•0 (y)âˆ’1 for x 6= y âˆˆ Uk âˆª Ukâˆ’1 .
Proof. Let O be the collection of all FGR morphisms from
P some (Y, NY ) with Y finite into (X, WX ).
Define a height function h : O â†’ N Ã— N by h (Ï•) =
yâˆˆY len (Ï• (y)) , |WY \NY | , and consider
N Ã— N with the lexicographic order. It is straightforward to verify that h (Ï•0 ) < h (Ï•) for every
i
i
. Thus, the decomposition process ends in a finite amount
and Ï• = Ï•0 â—¦ Ïˆx.y
folding morphism Ïˆx.y
of steps.
Proposition 3.15 (The triangle rule). Let (Y, NY ) be an FGR object, and x.y âˆˆ NY and z âˆˆ
Y âˆª Y âˆ’1 be such that z.y, z.x âˆˆ WY \NY . Then
1âˆ—
1âˆ—
Hom ((Y, NY ) , (X, WX )) = Ïˆz.y
(Hom ((Y, NY1 ) , (X, WX ))) âˆª Ïˆz.x
(Hom ((Y, NY2 ) , (X, WX )))

(not a disjoint union), where NY1 = NY âˆª {z.y} and NY2 = NY âˆª {z.x}.
Proof. Let Ï• : (Y, NY ) â†’ (X, WX ). As Ï„ (Ï• (x)) = Ï„ (Ï• (z)) = Ï„ (Ï• (y)) contradicts x.y âˆˆ NY , either
1
1
.
or Ï• = Ï•0 â—¦Ïˆz.x
Ï„ (Ï• (x)) 6= Ï„ (Ï• (z)) or Ï„ (Ï• (y)) 6= Ï„ (Ï• (z)), hence Ï• decomposes as Ï• = Ï•0 â—¦Ïˆz.y

3.2

The Core functor

The flowing easy claim leads to some very helpful observations.
Claim 3.16. Let Î“ â†’ âˆ† be a surjective graph morphism. Let Î“0 be a graph resulting from folding
two edges in Î“, and âˆ†0 the pushout of Î“0 â† Î“ â†’ âˆ† (which is obtained by folding the images of
these edges in âˆ†, if they are different from one another [Sta83]). Then Î“0 â†’ âˆ†0 is surjective.
Let Î“ be a finite Y -labeled graph. One obtains CoreÎ“ by a finite sequence of folding and
trimming, and one can perform foldings first and only then trimmings, as when a folded graph
is trimmed it remains folded. Following the claim, if Î“ â†’ âˆ† is a surjective graph morphism and
CoreÎ“ is obtained from Î“ without trimming then CoreÎ“ â†’ Coreâˆ† is also surjective.
Corollary 3.17. If Î“ is a core graph and (Ï•, Î“) a stencil, then FÏ• (Î“) is a core graph, namely,
CoreFÏ• (Î“) = FÏ• (Î“). If Î“, âˆ† are core graphs, (Ï•, Î“) is a stencil and Î“ â†’ âˆ† is onto, then
CoreFÏ• (Î“) â†’ CoreFÏ• (âˆ†) is onto.
We recall a Lemma from [PP14]:
Lemma 3.18 ([PP14]). Let Î“ be a finite X-labeled graph such that for every vertex v, except for
possibly the base-point, there are e, e0 âˆˆ Î¹âˆ’1 (v) with l(e) 6= l(e0 ). Then CoreÎ“ is obtained from Î“
by foldings alone (i.e. without trimming).
Corollary 3.19. Let H â‰¤ K â‰¤ FY be subgroups such that there is a non-trivial
cyclically reduced

word in H. If the morphism Î“Y (H) â†’ Î“Y (K) is onto then Î“Y uHuâˆ’1 â†’ Î“Y uKuâˆ’1 is onto
for every u âˆˆ FY .
6

Proof. Let u âˆˆ FY be a reduced word. We construct the graph Î“uY (H) by taking the graph
Î“Y (H) t Î“u , gluing len(u) + 1 âˆˆ V (Î“u ) to the base point of Î“Y (H) and setting the new base point
to be 1 âˆˆ V (Î“u ). We notice that Ï€1 (Î“uY (H)) = uHuâˆ’1 and that Î“uY (H) â†’ Î“uY (K) is onto. Since
H and K contain a cyclically reduce word the degrees of the base points of Î“Y (H) and Î“Y (K)
are at least two. From this we conclude that both Î“uY (H) and Î“uY (K) satisfy the conditions of
Lemma 3.18. Finally an inductive application of Claim 3.16 gives the result.

4

Basis-independent surjectivity

Returning to Conjectures 1.1-1.3, recall that for H â‰¤ K â‰¤ FY , we seek to show that for every free
extension FX of FY and every Ï• âˆˆ Aut (FX ) the graph morphism Î“X (Ï• (H)) â†’ Î“X (Ï• (K)) is surjective. Without loss of generality we may take X, from now on, to be a fixed countably infinite set,
and assume Y âŠ† X. In Theorem 1.4 we even consider the set of non-degenerate homomorphisms
Hom ((Y, âˆ…) , (X, WX )): this includes all injective homomorphisms FY ,â†’ FX , which in turn include all the restrictions of automorphisms of FX . Using Remark 3.5 we translate the problem to
showing that all the graph morphisms {CoreFÏ• (Î“Y (H) â†’ Î“Y (K)) | Ï• âˆˆ Hom ((Y, âˆ…) , (X, WX ))}
are surjective. This is a special case of the following problem.
Problem 4.1. Given a morphism Î“ â†’ âˆ† between two U -labeled core graphs, and an FGR object
(U, NU ), we call the pair (Î“ â†’ âˆ†, (U, NU )) a surjectivity problem. We say that the problem resolves
positively if all the morphisms in the set P = {CoreFÏ• (Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((U, NU ) , (X, WX ))}
are surjective. Note that taking (U, NU ) = (Y, âˆ…) we recover the problem of surjectivity w.r.t.
every non-degenerate Ï• : FU â†’ FX , and taking (U, NU ) = (Y, W (Î“)) we obtain a trivial problem.
Let us give a simple criterion for showing that one instance of Problem 4.1 is contained in
another, or that the problems are equivalent. For U 0 -labeled core graphs Î“0 , âˆ†0 and Ïˆ : (U, NU ) â†’
(U 0 , NU 0 ) an FGR morphism such that FÏˆ (Î“ â†’ âˆ†) = Î“0 â†’ âˆ†0 ,
{CoreFÏ• (Î“0 â†’ âˆ†0 ) | Ï• âˆˆ Hom ((U 0 , NU 0 ) , (X, WX ))}
= {CoreFÏ• â—¦ FÏˆ (Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((U 0 , NU 0 ) , (X, NX ))}
= {CoreFÏ•â—¦Ïˆ (Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((U 0 , NU 0 ) , (X, NX ))}
âŠ† {CoreFÏ• (Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((U, NU ) , (X, NX ))} ,
so that the problem (Î“0 â†’ âˆ†0 , (U 0 , NU 0 )) is contained in (Î“ â†’ âˆ†, (U, NU )). If Ïˆ is an FGRisomorphism, then the two problems are equivalent.
Remark 4.2. Following corollary 3.19 it is enough to consider surjectivity problems where Ï€1 (Î“)
contains a cyclically reduced word: otherwise, one can examine the graph of a conjugate of Ï€1 (Î“)
that contains a cyclically reduced word.
Definition 4.3. Let Î“ be a Y -labeled folded graph. An FGR object (Y, NY ) is said to be a stencil
space of Î“ if W (Î“) âŠ† NY . The reason for the name is that for any object (X, NX ) and morphism
Ï• âˆˆ Hom ((Y, NY ), (X, NX )), the pair (Ï•, Î“) is a stencil.
We show a method for determining whether all the morphisms in a problem (Î“ â†’ âˆ†, (U, NU ))
are surjective. We distinguish three cases:
1. Î“ â†’ âˆ† is not surjective: clearly P resolves negatively.
2. Î“ â†’ âˆ† is surjective and W (Î“) âŠ† NU , i.e. (U, NU ) is a stencil space of Î“: following Corollary
3.17, P resolves positively.
3. Î“ â†’ âˆ† is surjective and W (Î“) \NU 6= âˆ…: in this case we cannot resolve P immediately. We
call this an ambiguous case.
When (Î“ â†’ âˆ†, (U, NU )) is an ambiguous case, we cover it by five new problems, according to the

7

partition of Hom presented in Â§3.1: For any x.y âˆˆ W (Î“) \NU we have
{CoreFÏ• (Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((U, NU ) , (X, NX ))}
[5
i
(Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((Ui , NUi ) , (X, WX ))}
= i=1 {CoreFÏ•â—¦Ïˆx.y
[5
i
(Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((Ui , NUi ) , (X, WX ))}
= i=1 {CoreFÏ• â—¦ FÏˆz.y
[5
i
(Î“ â†’ âˆ†)) | Ï• âˆˆ Hom ((Ui , NUi ) , (X, WX ))} ,
= i=1 {CoreFÏ• (CoreFÏˆz.y
where the last equality follows
 from Remark 3.5. Thus we obtain five different subproblems
i
(Î“ â†’ âˆ†) , (Ui , NUi ) , and P resolves positively iff all the five subproblems do so. If
CoreFÏˆz.y
one of these five problems is of case 1 then (Î“ â†’ âˆ†, (U, NU )) resolves negatively, if all are of case
2 then (Î“ â†’ âˆ†, (U, NU )) resolves positively, and otherwise we continue recursively and split each
ambiguous case into five sub-subproblems. We now give a toy example to show how this process
may end.
Example 4.4. Let P be the surjectivity
problem with U = {x, y}, NU = {x.y âˆ’1 , xâˆ’1 .y,

âˆ’1 âˆ’1
âˆ’1
âˆ’1 âˆ’1
y .x , x.x }, Î“ = Î“U xyx y
(the commutator) and âˆ† = Î“U (hx, yi). The extension
âˆ’1 âˆ’1
xyx y
< hx, yi is algebraic so we know that this surjectivity problem resolves positively. We
will show how one can conclude this using the method presented above. We notice that Î“  âˆ†
and x.y âˆˆ W (Î“) \NU , so P is an ambiguous case. We split into five subproblems (some of the
calculations are explicit and some omitted and left to the reader):

1
1. P1 : Ïˆx.y
= Id, U1 = U, NU1 = x.y âˆ’1 , xâˆ’1 .y, y âˆ’1 .xâˆ’1 , x.xâˆ’1 , x.y , Î“1 = Î“, âˆ†1 = âˆ†. The
problem P1 resolves positively as (U1 , NU1 ) is a stencil space of Î“1 and Î“1  âˆ†1 .
 âˆ’1 âˆ’1
xt
2
2. P2 : Ïˆx.y
: x7y7â†’
t.y , x .t, y âˆ’1 .xâˆ’1 , x.tâˆ’1 , y.tâˆ’1 , x.y ,Î“2 =
U2 =
â†’yt , U2 = {x, y, t} , N

âˆ’1
âˆ’1
2
2
= Î“U2 xtyxâˆ’1 tâˆ’1 y âˆ’1 , âˆ†2 = Î“U2 (hxt, yti). Again
CoreFÏˆx.y
(Î“) = Î“U2 Ïˆx.y xyx y
P2 resolves positively as (U2 , NU2 ) is a stencil space of Î“2 and Î“2  âˆ†2 .
 âˆ’1 âˆ’1
â†’x
3
: x7y7â†’
, x .x, y âˆ’1 .xâˆ’1 , y.xâˆ’1 , Î“3 = Î“  âˆ† = âˆ†3 , and
3. P3 : Ïˆx.y
yx , U3 = U , NU3 = x.y
x.y âˆˆ W (Î“3 ) \NU3 , so this is an ambiguous case.
 âˆ’1 âˆ’1
â†’xy
4
: x7y7â†’
, x .y, y âˆ’1 .xâˆ’1 , x.y âˆ’1 , Î“4 = Î“  âˆ† = âˆ†4 , and
4. P4 : Ïˆx.y
y , U4 = U , NU4 = y.y
x.y âˆˆ W (Î“4 ) \NU4 so this is an ambiguous case.
5. This case does not occur because xâˆ’1 .y âˆ’1 âˆˆ NU .
We notice first that the FGR-isomorphism x â†” y gives an equivalence between P4 and P3 , and
second, that P3 is identical to the original P! Now, it may seem that we are trapped in an
infinite self-referential loop: P resolves positively if P resolves positively. Thankfully, Theorem
3.14 rescues us from this nightmare. Let Ï• âˆˆ Hom ((U, NU ) , (X, WX )). We decompose Ï• by x.y
recursively, mirroring the splitting of the four subproblems. Because the decomposition of the
morphism via FGR is finite, it can loop through problems 3 and 4 only a finite number of times
until it arrives at a stencil space equivalent to P1 or P2 . Since P1 and P2 resolve positively, we
conclude that so does P.
Not all surjectivity problems end with equivalent ambiguous problems. In some cases this
process produces more and more different ambiguous problems and therefore the algorithm does
not end with a conclusive answer. In the case of the counterexample (Â§5), after a fair amount of
splitting we end up with ambiguous cases equivalent to or contained in problems we have previously
encountered. In Section Â§6 we discuss a property of the graph Î“ in a problem P that is a necessary
condition for this process to end.

4.1

Change of coordinates

With X and (Y, NY ) as before, in P = {CoreFÏ• (Î“ â†’ âˆ†) | Ï• âˆˆ Hom ((Y, NY ) , (X, WX ))} there
can be many repetitions, as different homomorphisms Ï• may give rise to the same graph morphism
CoreFÏ• (Î“ â†’ âˆ†). We can exploit this in a way which shortens calculations significantly in Â§5.

8

Definition 4.5. A change of coordinates consists of
1. FGR objects (V, NV ), (U1 , N1 ), . . . , (Un , Nn ),
2. a group homomorphism Ïƒ : FV â†’ FY (not necessarily an FGR
morphism),
3. an FGR morphism Ïˆi : (V, NV ) â†’ (Ui , Ni ) for every i,
4. an FGR morphism Ïƒi : (Y, NY ) â†’ (Ui , Ni ) for every i,

>Y
V

>X

Ïƒi


Ui

Ïˆi

such that
1.
2.
3.
4.

Ï•

Ïƒ

Ï•0

Ï€1 (âˆ†) â‰¤ Im Ïƒ,
Ïƒ âˆ— : Ï• 7â†’ Ï• â—¦ Ïƒ takes Hom ((Y, NY ) , (X, WX )) to Hom ((V, NV ) , (X, WX )),
Ïƒi â—¦ Ïƒ = Ïˆi for every i,
for every Ï• âˆˆ Hom ((Y, NY ), (X, WX )) there is an index i and a morphism Ï•0 âˆˆ
Hom ((Ui , Ni ) , (X, WX )) such that Ï• â—¦ Ïƒ = Ï•0 â—¦ Ïˆi .

Proposition 4.6. The problem (Î“ â†’ âˆ†, (Y, NY )) resolves
(CoreFÏƒi (Î“ â†’ âˆ†) , (Ui , Ni )) resolves positively for every i.

positively

if

and

only

if

Note that not all FGR morphisms in Hom ((Y, NY ) , (X, WX )) necessarily factor through one
of the Ïƒi , meaning there could be Ï• âˆˆ Hom ((Y, NY ) , (X, WX )) (as is the case in Â§5) with no
decomposition as Ï• = Ï•0 â—¦ Ïƒi â€“ this is what makes the new set of problems potentially simpler.
Proof. Let Ï€1 (Î“) = H and Ï€1 (âˆ†) = K.
The morphisms Ïˆi induce functions
âˆ—
Ïˆ
:
Hom
((U
,
N
)
,
(X,
W
))
â†’
Hom
((V,
N
)
,
(X,
W
)),
and conditions 2, 3, 4 imply 5 : Im Ïƒ âˆ— =
i
i
X
V
X
Si
âˆ—
i Im Ïˆi . As Î“ â†’ âˆ† means that H â‰¤ K, for every homomorphism Ï• : FY â†’ FX we have
Ï• (H) â‰¤ Ï• (K), hence there is a unique graph morphism Î“X (Ï• (H)) â†’ Î“X (Ï• (K)). We notice
that:
P = {CoreFÏ• (Î“Y (H) â†’ Î“Y (K)) |Ï• âˆˆ Hom ((Y, NY ) , (X, WX ))}
= {Î“X (Ï• (H)) â†’ Î“X (Ï• (K)) |Ï• âˆˆ Hom ((Y, NY ) , (X, WX ))}


1 
= Î“X Ï• â—¦ Ïƒ Ïƒ âˆ’1 (H) â†’ Î“X Ï• â—¦ Ïƒ Ïƒ âˆ’1 (K) |Ï• âˆˆ Hom ((Y, NY ) (X, WX ))
[ 
5
=
Î“X (Ï•0 â—¦ Ïˆi (Ïƒ âˆ’1 (H))) â†’ Î“X (Ï•0 â—¦ Ïˆi (Ïƒ âˆ’1 (K)))|Ï•0 âˆˆ Hom ((Ui , Ni ) , (X, WX ))
[i 

=
CoreFÏ•0 Î“Ui (Ïˆi (Ïƒ âˆ’1 (H))) â†’ Î“Ui (Ïˆi (Ïƒ âˆ’1 (K))) |Ï•0 âˆˆ Hom ((Ui , Ni ) , (X, WX ))
i
[ 

3
=
CoreFÏ•0 Î“Ui (Ïƒi â—¦ Ïƒ(Ïƒ âˆ’1 (H))) â†’ Î“Ui (Ïƒi â—¦ Ïƒ(Ïƒ âˆ’1 (K))) |Ï•0 âˆˆ Hom ((Ui , Ni ) , (X, WX ))
i
[
1
=
{CoreFÏ•0 (Î“Ui (Ïƒi (H)) â†’ Î“Ui (Ïƒi (K))) |Ï•0 âˆˆ Hom ((Ui , Ni ) , (X, WX ))}
i
[
=
{CoreFÏ•0 (CoreFÏƒi (Î“ â†’ âˆ†)) |Ï•0 âˆˆ Hom ((Ui , Ni ) , (X, WX ))} .
i

5

The counterexample

In this section we prove Theorem 1.4. showing that H = hbbabaâˆ’1 i and K = hb, abaâˆ’1 i constitute
a counterexample to Conjectures 1.1, 1.2, 1.3.
Theorem (1.4). The extension H â‰¤ K is not algebraic, but for every morphism Ï• : F{a,b} â†’ FX
with X arbitrary and Ï•(a), Ï•(b) 6= 1, the graph morphism Î“X (Ï• (H)) â†’ Î“X (Ï•(K)) is surjective.
First, H is a proper free factor of K, so in particular H â‰¤ K is not an algebraic extension.
Following Section Â§4, we need to show that the problem Î“{a,b} (H) â†’ Î“{a,b} (K) , ({a, b} , âˆ…)
resolves positively. By a change of coordinate (Proposition 4.6) we replace this problem with eight
problems that are easier to analyze. Let (V, NV ) = ({Î±, Î²} , âˆ…), and
Ïƒ : F{Î±,Î²} â†’ F{a,b} ,

Ïƒ (Î±) = b,

Ïƒ (Î²) = abaâˆ’1 .

We notice that
 H < K â‰¤ Im Ïƒ. For any non-degenerate Ï• : F{a,b} â†’ FX , the words Ï• (b) = Ï•â—¦Ïƒ (Î±)
âˆ’1
and Ï• aba
= Ï• â—¦ Ïƒ (Î²) are conjugate, hence there exist reduced words x, y, u, v âˆˆ FX such that
9

Ï•(b) = x Â· u Â· v Â· xâˆ’1 , Ï•(abaâˆ’1 ) = y Â· v Â· u Â· y âˆ’1 (in particular, vu and uv are cyclically reduced). By
non-degeneracy we can also assume u 6= 1, and if v = 1 then u is cyclically reduced. We perform
a change of coordinates according to the eight possible cases, with (Ui , Ni ), Ïˆi and Ïƒi being:
# x
y
v
1 =1 =1 =1
2 6= 1 =1 =1
3 =1 6= 1 =1
4

6= 1 6= 1 =1

5
6
7

=1 =1 6= 1
6= 1 =1 =
6 1
=1 6= 1 =
6 1

8

6= 1 6= 1 6= 1

Ui
{u}
{y, u}
{x, u}

Ni
Ïˆi (Î±), Ïˆi (Î²)
Ïƒi (a), Ïƒi (b)
{u.uâˆ’1 }
u, u
u, u
{y.uâˆ’1 , u.y, u.uâˆ’1 }
u, yuy âˆ’1
y, u
âˆ’1
âˆ’1
âˆ’1
âˆ’1
xux , u
x , xuxâˆ’1
{x.uâˆ’1 , u.x, u.uâˆ’1 }
x.u , u.x, u.u ,
{x, u, y}
xuxâˆ’1 , yuy âˆ’1
yxâˆ’1 , xuxâˆ’1
y.uâˆ’1 , u.y, y.x
{v, u}
{v.uâˆ’1 , u.v âˆ’1 }
uv, vu
uâˆ’1 , uv
âˆ’1
âˆ’1
âˆ’1
âˆ’1
{v, u, y} {v.u , u.v , y.v , u.y}
uv, yvuy
yv, uv
âˆ’1
âˆ’1
âˆ’1
âˆ’1
âˆ’1 âˆ’1
{v, u, x} {v.u
,
u.v
,
x.u
,
v.x}
xuvx
,
vu
u
x
, xuvxâˆ’1
 âˆ’1

âˆ’1
âˆ’1
v.u , u.v , x.u ,
{v, u, y, x}
xuvxâˆ’1 , yvuy âˆ’1 yuâˆ’1 xâˆ’1 , xuvxâˆ’1
v.x, y.v âˆ’1 , u.y

For every 1 â‰¤ i â‰¤ 8 we denote Î“i = Î“ (Ïƒi (H)) and âˆ†i = Î“ (Ïƒi (K)). We obtain eight problems,
and we proceed to split them and identify all the stencil spaces. We index the cases in the following
manner: if Case i is not a stencil space it splits into five cases Case i.1, i.2, . . . i.5. For each case, the
morphism Ïˆi.j is the folding morphism this subset of morphisms factors through. The co-domain
of Ïˆi.j is the FGR object (Ui.j , Ni.j ), and the graphs are indexed by Î“i.j = CoreFÏˆi.j (Î“i ) and
âˆ†i.j = CoreFÏˆi.j (âˆ†i ), and the âˆ† graphs are depicted in Figure 5.1. In each case either W (Î“i )\Ni
is empty, hence (Ui , Ni ) is a stencil space of Î“i and we can resolve the subproblem, or it is not
empty, and then we continue splitting. Remark 4.2 allows us to conjugate, or equivalently to
change the base points of the graphs.
Case 5. Here Î“5 = Î“(huvuvvui)  âˆ†5 and W (Î“5 ) \N5 = {u.uâˆ’1 , v.v âˆ’1 }. We split by u.uâˆ’1 .
1
âˆ’1
Case 5.1. Ïˆ5.1 = Ïˆu.u
, u.v âˆ’1 , u.uâˆ’1 }, Î“5.1 = Î“5 and âˆ†5.1 = âˆ†5 (hence Î“5.1 
âˆ’1 , N5.1 = {v.u
âˆ’1
âˆ†5.1 ). W (Î“5.1 ) \NU5.1 = {v.v } (so we must split by v.v âˆ’1 ).
1
âˆ’1
Case 5.1.1. Ïˆ5.1.1 = Ïˆv.v
, u.v âˆ’1 , u.uâˆ’1 , v.v âˆ’1 }. Again Î“5 = Î“5.1.1 , âˆ†5.1.1 = âˆ†5
âˆ’1 , N5.1.1 = {v.u
and W (Î“5.1 ) \N5.1 = âˆ…, hence the subcase resolves positively.
2
âˆ’1
âˆ’1
âˆ’1
âˆ’1 âˆ’1 âˆ’1
âˆ’1
Case 5.1.2. Ïˆ5.1.2 = Ïˆv.v
 âˆ’1 , v 7â†’ t vt, N5.1.2 = {t.u , u.t, u.u , v.t , t .v , v.v }; Î“5.1.2 =
âˆ’1
âˆ’1
Î“ ut vtut vvtu  âˆ†5.1.2 and W (Î“5.1.2 ) \N5.1.2 = âˆ… hence the subcase resolves positively.
2
âˆ’1
âˆ’1
âˆ’1 âˆ’1 âˆ’1
Case 5.2. Ïˆ5.2 = Ïˆu.u
âˆ’1 ,
 u 7â†’ t ut, N5.2 = {v.t, u.t , u.u , t .u }; Î“5.2
âˆ’t
âˆ’1
âˆ’1
Î“ t utvt utvvt ut
is not cyclically reduced so we conjugate and set Î“5.2
Î“ utvtâˆ’1 utvvtâˆ’1 u  âˆ†5.2 and W (Î“5.2 ) \N5.2 = {v.v âˆ’1 }. We split by v.v âˆ’1 .

=
=

1
âˆ’1
Case 5.2.1. Ïˆ5.1 = Ïˆv.v
, u.uâˆ’1 , tâˆ’1 .uâˆ’1 , v.v âˆ’1 }; Î“5.2.1 = Î“5.2 , âˆ†5.2.1 = Î“5.2
âˆ’1 , NU5.2.1 = {v.t, u.t
and W (Î“5.2.1 ) \N5.2.1 = âˆ…, hence the subcase resolves positively.
âˆ’1
2
, N5.2.2 = {s.t, u.tâˆ’1 , u.uâˆ’1 , tâˆ’1 .uâˆ’1 , v.sâˆ’1 , sâˆ’1 .v âˆ’1 , v.v âˆ’1 };
Case 5.2.2. Ïˆ5.2.2 = Ïˆv.v
âˆ’1 , v 7â†’ svs
âˆ’1
âˆ’1
âˆ’1
âˆ’1
Î“5.2.2 = Î“ uts vst uts vvst u  âˆ†5.2.2 and W (Î“5.2.2 ) \N5.2.2 , hence the subcase resolves positively.

Case 2. Here Î“2 = Î“ uuyuy âˆ’1  âˆ†2 and W (Î“2 ) \N2 = {uâˆ’1 .y âˆ’1 , u.y âˆ’1 }. We notice that
u.uâˆ’1 âˆˆ N2 , so we can use the triangle rule (Proposition 3.15) to deduce that every morphism
1
factors through either Ïˆu1 âˆ’1 .yâˆ’1 or Ïˆu.y
âˆ’1 .

Case 2.1. We have two cases: Ïˆ2.1 = Ïˆu1 âˆ’1 .yâˆ’1 and N2.1 = {y.uâˆ’1 , u.y, u.uâˆ’1 , uâˆ’1 .y âˆ’1 }, or Ïˆ2.10 =
1
âˆ’1
Ïˆu.y
, u.y, u.uâˆ’1 , u.y âˆ’1 }. These cases are equivalent, as Î³ : (U2 , N2.1 ) â†’
âˆ’1 and N2.10 = {y.u
(U2 , N2.10 ) defined by u 7â†’ uâˆ’1 , y 7â†’ y satisfies FÎ³ (Î“2.1 â†’ âˆ†2.1 ) = Î“2.10 â†’ âˆ†2.10 . Finally,
Î“2.1 = Î“2 , âˆ†2.1 = âˆ†2 , and W (Î“2.1 ) \N2.1 = {u.y âˆ’1 }.
1
âˆ’1
Case 2.1.1. Ïˆ2.1.1 = Ïˆu.y
, u.y, u.uâˆ’1 , uâˆ’1 .y âˆ’1 , u.y âˆ’1 }; Î“2.1.1 = Î“2.1 , âˆ†2.1.1 =
âˆ’1 and N2.1.1 = {y.u
âˆ†2.1 and W (Î“2.1.1 ) \N2.1.1 = âˆ…, hence the subcase resolves positively.

10

2
âˆ’1
Case 2.1.2. Ïˆ2.1.2 = Ïˆu.y
y and N2.1.2 = {t.uâˆ’1 , uâˆ’1 .y, t.y, t.uâˆ’1 , u.tâˆ’1 ,
âˆ’1 , u 7â†’ ut, y 7â†’ t

y âˆ’1 .tâˆ’1 , u.y âˆ’1 }; Î“2.1.2 = Î“ utuyuty âˆ’1 t  âˆ†2.1.2 and W (Î“2.1.2 ) \N2.1.2 = âˆ…, hence the
subcase resolves positively.
3
âˆ’1
Case 2.1.3. Ïˆ2.1.3 = Ïˆu.y
, N2.1.3 = {y.uâˆ’1 , y âˆ’1 .y, y âˆ’1 .uâˆ’1 , u.y} and Î“2.1.3 =
âˆ’1 , u 7â†’ uy

Î“ uy âˆ’1 uuy âˆ’1 y âˆ’1
 âˆ†2.1.3 . We notice that Î³ : (U5 , N5 ) â†’ (U2.1.3 , N2.1.3 ) defined by
u 7â†’ uâˆ’1 , v 7â†’ y satisfies FÎ³ (Î“5 â†’ âˆ†5 ) is conjugate to Î“2.1.3 â†’ âˆ†2.1.3 , which implies that
this subproblem is contained in Case 5.
4
âˆ’1
Case 2.1.4. Ïˆ2.1.4 = Ïˆu.y
y and N2.1.4 = {y.uâˆ’1 , u.y, u.uâˆ’1 , uâˆ’1 .y âˆ’1 }; N2.1.4 = N2.1
âˆ’1 , y 7â†’ u
and Î“2.1.4 = Î“2.1 , âˆ†2.1.4 = âˆ†2.1 , so this is the same problem as Case 2.1.

Case 3. Here Î“3 = Î“ xuuxâˆ’1 u  âˆ†3 and W (Î“3 ) \N3 = {xâˆ’1 .uâˆ’1 , u.xâˆ’1 } We notice that
u.uâˆ’1 âˆˆ N2 so we can split using the triangle rule.

Case 3.1. We have two cases Ïˆ3.1 = Ïˆu1 âˆ’1 .xâˆ’1 , N3.1 = {x.uâˆ’1 , u.x, u.uâˆ’1 , u.xâˆ’1 } and Ïˆ3.10 =
1
âˆ’1
Ïˆu.x
, u.x, u.uâˆ’1 , uâˆ’1 .xâˆ’1 }. These cases are equivalent, as Î³ : (U3 , N3.1 ) â†’
âˆ’1 , N3.10 = {x.u
(U3 , N3.10 ) defined by u 7â†’ uâˆ’1 , x 7â†’ x satisfies FÎ³ (Î“3.1 â†’ âˆ†3.1 ) = Î“3.10 â†’ âˆ†3.10 . Finally
Î“3.1 = Î“3 , âˆ†3.1 = âˆ†3 and W (Î“3.1 ) \N3.1 = {uâˆ’1 .xâˆ’1 }. We split by uâˆ’1 .xâˆ’1 .
Case 3.1.1. Ïˆ3.1.1 = Ïˆu1 âˆ’1 .xâˆ’1 and N3.1.1 = {x.uâˆ’1 , u.x, u.uâˆ’1 , u.xâˆ’1 , xâˆ’1 .uâˆ’1 }; Î“3.1.1 =
Î“3.1 , âˆ†3.1.1 = âˆ†3.1 and W (Î“3.1.1 ) \N3.1.1 = âˆ… hence the subcase resolves positively.
âˆ’1 âˆ’1
Case 3.1.2. Ïˆ3.1.2 = Ïˆu2 âˆ’1 .xâˆ’1 , x 7â†’ tâˆ’1 x, u 7â†’ tâˆ’1
 u and N3.1.2 = {x.t, u.x, u.t, t .x ,
âˆ’1 âˆ’1
âˆ’1 âˆ’1
âˆ’1 âˆ’1 âˆ’1
âˆ’1
t .u , x .u }; Î“3.1.2 = Î“ t xt ut ux u  âˆ†3.1.2 and W (Î“3.1.2 ) \N3.1.2 = âˆ…,
hence the subcase resolves positively.

Case 3.1.3. Ïˆ3.1.3 = Ïˆu3 âˆ’1 .xâˆ’1 , x 7â†’ ux and N3.1.3 = {x.uâˆ’1 , u.x, u.uâˆ’1 , u.xâˆ’1 }; N3.1.3 = N3.1 and
Î“3.1.3 = Î“3.1 , âˆ†3.1.1 = âˆ†3.1 . This is the same problem as Case 3.1.
Case 3.1.4. Ïˆ3.1.4 = Ïˆu4 âˆ’1 .xâˆ’1 , u 7â†’ xu and N3.1.4 = {x.xâˆ’1 , u.x, u.xâˆ’1 , x.uâˆ’1 }; Î“3.1.4 =
Î“ (hxxuxuui)  âˆ†3.1.4 . We notice that Î³ : (U5 , N5 ) â†’ (U3.1.4 , N3.1.4 ) defined by u 7â†’ x, v 7â†’ u
satisfies that FÎ³ (Î“5 â†’ âˆ†5 ) is conjugate to Î“3.1.4 â†’ âˆ†3.1.4 , hence this is contained in Case 5.

Case 4. Here Î“4 = xuuxâˆ’1 yuy âˆ’1  âˆ†4 and W (Î“4 ) \N4 = {xâˆ’1 .y âˆ’1 }. We split by xâˆ’1 .y âˆ’1 âˆˆ
W (Î“4 ) \N4 .
1
âˆ’1
Case 4.1. Ïˆ4.1 = Ïˆv.v
, u.x, u.uâˆ’1 , y.uâˆ’1 , u.y, y.x, xâˆ’1 .y âˆ’1 }; Î“4.1 = Î“4 , âˆ†4.1 = âˆ†4
âˆ’1 , N4.1 = {x.u
and W (Î“4.1 ) \N4.1 = âˆ…, hence the subcase resolves positively.

Case 4.2. Ïˆ4.2 = Ïˆx2âˆ’1 .yâˆ’1 , x 7â†’ tâˆ’1 x, y 7â†’ tâˆ’1 y and N4.2 = {x.uâˆ’1 , u.x, u.uâˆ’1 , y.uâˆ’1 y.u, y.x,
xâˆ’1 .tâˆ’1 , y âˆ’1 .tâˆ’1 , y âˆ’1 .xâˆ’1 }; after conjugation Î“4.2 = Î“4 , âˆ†4.2 = âˆ†4 and W (Î“4.2 ) \N4.2 = âˆ…,
hence the subcase resolves positively.
Case 4.3. Ïˆ4.3 = Ïˆx3âˆ’1 .yâˆ’1 , x 7â†’ yx and N4.3 = {x.uâˆ’1 , u.x, u.uâˆ’1 , y.uâˆ’1 , u.y, y.x, y.xâˆ’1 }. We
notice that Î³ : (U3 , N3 ) â†’ (U4.3 , N4.3 ) defined by u 7â†’ u, x 7â†’ x satisfies FÎ³ (Î“3 â†’ âˆ†3 ) =
Î“4.3 â†’ âˆ†4.3 , hence this problem is contained in Case 3.
Case 4.4. Ïˆ4.4 = Ïˆx4âˆ’1 .yâˆ’1 , y 7â†’ xy and N4.4 = {x.uâˆ’1 , u.x, u.uâˆ’1 , y.uâˆ’1 , u.y, y.x, x.y âˆ’1 }. We
notice that Î³ : (U2 , N2 ) â†’ (U4.4 , N4.4 ) defined by u 7â†’ u, y 7â†’ y satisfies FÎ³ (Î“2 â†’ âˆ†2 ) = Î“4.4 â†’
âˆ†4.4 , hence this problem is contained in Case 2.

Case 6. Here Î“6 = uvuvyvuy âˆ’1  âˆ†6 and W (Î“6 ) \N6 = {y âˆ’1 .uâˆ’1 , v.y âˆ’1 }. We notice that
v.uâˆ’1 âˆˆ N2 so we can split using the triangle rule.
Case 6.1. We have two cases Ïˆ6.1 = Ïˆu1 âˆ’1 .yâˆ’1 , N6.1 = {v.uâˆ’1 , u.v âˆ’1 , y.v âˆ’1 , u.y, y âˆ’1 .uâˆ’1 } and
1
Ïˆ6.10 = Ïˆv.y
= {v.uâˆ’1 , u.v âˆ’1 , y.v âˆ’1 , u.y, v.y âˆ’1 }. These cases are equivalent, as
âˆ’1 , N6.10
Î³ : (U6 , N6.1 ) â†’ (U6 , N6.10 ) defined by u 7â†’ v âˆ’1 , v 7â†’ uâˆ’1 satisfies FÎ³ (Î“6.1 â†’ âˆ†6.1 ) = Î“6.10 â†’
âˆ†6.10 . Î“6.1 = Î“6 , âˆ†6.1 = âˆ†6 and W (Î“6.1 ) \N6.1 = {v.y âˆ’1 }. We split by v.y âˆ’1 .
1
Case 6.1.1. Ïˆ6.1.1 = Ïˆv.y
= {v.uâˆ’1 , u.v âˆ’1 , y.v âˆ’1 , u.y, y âˆ’1 .uâˆ’1 , v.y âˆ’1 }; Î“6.1.1 =
âˆ’1 and N6.1.1
Î“6 , âˆ†6.1.1 = Î“6 and W (Î“6.1.1 ) \N6.1.1 = âˆ…, hence the subcase resolves positively.

11

2
âˆ’1
Case 6.1.2. Ïˆ6.1.2 = Ïˆv.y
y and N6.1.2 = {t.uâˆ’1 , u.v âˆ’1 , y.v âˆ’1 , u.y, v.tâˆ’1 ,
âˆ’1 , v 7â†’ vt, y 7â†’ t

tâˆ’1 .y âˆ’1 }; Î“6.1.2 = Î“ uvtuvyvtuy âˆ’1 t  âˆ†6.1.2 and W (Î“6.1.2 ) \N6.1.2 = âˆ…, hence the subcase
resolves positively.
3
âˆ’1
Case 6.1.3. Ïˆ6.1.3 = Ïˆv.y
, N6.1.3 = {y âˆ’1 .uâˆ’1 , u.v âˆ’1 , y.v âˆ’1 , u.y, y âˆ’1 .uâˆ’1 , v.y} and
âˆ’1 , v 7â†’ vy

Î“6.1.3 = Î“ y âˆ’1 uvy âˆ’1 uvvy âˆ’1 u . We notice that Î³ : (U5 , N5 ) â†’ (U6.1.3 , N6.1.3 ) defined by
u 7â†’ y âˆ’1 u, v 7â†’ v satisfies FÎ³ (Î“5 â†’ âˆ†5 ) is conjugate to Î“6.1.3 â†’ âˆ†6.1.3 therefore this problem
is contained in Case 5.
4
Case 6.1.4. Ïˆ6.1.4 = Ïˆv.y
y 7â†’ v âˆ’1 y, N6.1.4 = {v.uâˆ’1 , u.v âˆ’1 , y.v âˆ’1 , u.y, v âˆ’1 .y âˆ’1 } and
âˆ’1 ,

Î“6.1.4 vuvuyvuy âˆ’1 . We notice that Î³ : (U2 , N2 ) â†’ (U6.1.4 , N6.1.4 ) defined by u 7â†’ vu satisfies
FÎ³ (Î“2 â†’ âˆ†2 ) = Î“6.1.4 â†’ âˆ†6.1.4 , hence this problem is contained in Case 2.

Case 7. Here Î“7 = xuvuvxâˆ’1 vu  âˆ†7 and W (Î“7 ) \N7 = {xâˆ’1 .v âˆ’1 , u.xâˆ’1 }. We notice that
u.v âˆ’1 âˆˆ N2 so we can split using the triangle rule.
1
Case 7.1 We have two cases Ïˆ7.1 = Ïˆu.x
N7.1 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, xâˆ’1 .u} and
âˆ’1 ,
1
âˆ’1
âˆ’1
âˆ’1
Ïˆ7.10 = Ïˆxâˆ’1 .v , , N7.10 = {v.u , u.v , x.u , v.x, xâˆ’1 .v âˆ’1 }. These cases are equivalent, as
Î³ : (U7 , N7.1 ) â†’ (U7 , N7.10 ) defined by u 7â†’ v âˆ’1 , v 7â†’ uâˆ’1 satisfies FÎ³ (Î“7.1 â†’ âˆ†7.1 ) = Î“7.10 â†’
âˆ†7.10 ; Î“7.1 = Î“7 , âˆ†7.1 = Î“7 and W (Î“7.1 ) \N7.1 = {xâˆ’1 .v âˆ’1 }. We split by xâˆ’1 .v âˆ’1 .

Case 7.1.1. Ïˆ7.1.1 = Ïˆx1âˆ’1 .vâˆ’1 and N7.1.1 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, xâˆ’1 .u, xâˆ’1 .v âˆ’1 }; Î“7.1.1 =
Î“7 , âˆ†7.1.1 = âˆ†7 and W (Î“7.1.1 ) \N7.1.1 = âˆ…, hence the subcase resolves positively.
Case 7.1.2. Ïˆ7.1.2
=
Ïˆx2âˆ’1 .vâˆ’1 ,
x
7â†’
tâˆ’1 x, v
7â†’
tâˆ’1 v and N7.1.2  =
âˆ’1
âˆ’1
âˆ’1 âˆ’1 âˆ’1 âˆ’1
âˆ’1 âˆ’1
âˆ’1
{v.u , u.t, x.u , v.x, t .x , t .v , x .v }; Î“7.1.2 = Î“ ut vutâˆ’1 vxâˆ’1 vutâˆ’1 xuâˆ’1 
âˆ†7.1.2 and W (Î“7.1.2 ) \N7.1.2 = âˆ…, hence the subcase resolves positively.
Case 7.1.3 Ïˆ7.1.3 = Ïˆx4âˆ’1 .vâˆ’1 , x 7â†’ vx, N7.1.3 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, v.xâˆ’1 } and
Î“7.1.3 xuvuvxâˆ’1 uv . We notice that Î³ : (U3 , N3 ) â†’ (U7.1.3 , N7.1.3 ) defined by u 7â†’ uv, x 7â†’ x
satisfies FÎ³ (Î“3 â†’ âˆ†3 ) = Î“7.1.3 â†’ âˆ†7.1.3 , hence this problem is contained in Case 3.
Case 7.1.4 Ïˆ7.1.3 = Ïˆx4âˆ’1 .vâˆ’1 , v 7â†’ xv, N7.1.4 = {v.uâˆ’1 , u.xâˆ’1 , x.uâˆ’1 , v.x, x.v âˆ’1 } Î“7.1.4 =
(huxvuxvvuxi). We notice that Î³ : (U5 , N5 ) â†’ (U7.1.4 , N7.1.4 ) defined by u 7â†’ ux, v 7â†’ v satisfies
FÎ³ (Î“5 â†’ âˆ†5 ) = Î“7.1.4 â†’ âˆ†7.1.4 , hence this problem is contained in Case 5.

Case 8. Here Î“8 xuvuvxâˆ’1 yvuy âˆ’1  âˆ†8 andW (Î“8 ) \N8 = {xâˆ’1 .y âˆ’1 }. We split by xâˆ’1 .y âˆ’1 .
Case 8.1. Ïˆ8.1 = Ïˆx1âˆ’1 .yâˆ’1 , N8.1 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, y.v âˆ’1 , u.y, xâˆ’1 .y âˆ’1 }; Î“8.1 =
Î“8 , âˆ†8.1 = âˆ†8 and W (Î“8.1 ) \N8.1 = âˆ… hence the subcase resolves positively.
Case 8.2. Ïˆ8.2 = Ïˆx2âˆ’1 .yâˆ’1 , x 7â†’ tâˆ’1 x, y 7â†’ tâˆ’1 y and N8.2 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, y.v âˆ’1 , u.y,
tâˆ’1 .y âˆ’1 , tâˆ’1 .xâˆ’1 , xâˆ’1 .y âˆ’1 }; Î“8.2 , âˆ†8.2 are conjugate to Î“8 , âˆ†8 and W (Î“8.2 ) \N8.2 = âˆ… hence the
subcase resolves positively.
Case 8.3. Ïˆ8.3 = Ïˆx3âˆ’1 .yâˆ’1 , x 7â†’ yx and N8.3 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, y.v âˆ’1 , u.y, y.xâˆ’1 }. We
notice that Î³ : (U7 , N7 ) â†’ (U8.3 , N8.3 ) defined by u 7â†’ u, x 7â†’ x, v 7â†’ v satisfies FÎ³ (Î“7 â†’ âˆ†7 ) =
Î“8.3 â†’ âˆ†8.3 , hence this problem is contained in Case 7.
Case 8.4. Ïˆ8.4 = Ïˆx4âˆ’1 .yâˆ’1 , y 7â†’ xy and N8.4 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, y.v âˆ’1 , u.y, x.y âˆ’1 }. We
notice that Î³ : (U6 , N6 ) â†’ (U8.4 , N8.4 ) defined by u 7â†’ u, y 7â†’ y, v 7â†’ v satisfies FÎ³ (Î“6 â†’ âˆ†6 ) =
Î“8.4 â†’ âˆ†8.4 , hence this problem is contained in Case 6.
Case 8.5. Ïˆ8.5 = Ïˆx5âˆ’1 .yâˆ’1 , y 7â†’ x and N8.4 = {v.uâˆ’1 , u.v âˆ’1 , x.uâˆ’1 , v.x, x.v âˆ’1 , u.x}. We notice
that Î³ : (U5 , N5 ) â†’ (U8.4 , N8.4 ) defined by u â†’
7 u, v 7â†’ v satisfies FÎ³ (Î“5 â†’ âˆ†5 ) = Î“8.5 â†’ âˆ†8.5 ,
hence this problem is contained in Case 5.
Case 1. We notice that Î“1  âˆ†1 and that W (Î“1 ) \N1 = âˆ…, hence the case resolves positively.

12

6

Stencil-finiteness

Let P = {Î“ â†’ âˆ† | (U, NU )} be a surjectivity problem. In this section we define and
examine a property of the graph Î“, that is necessary for the recursive splitting of P (as
described in Â§4) to end in a finite set
cases.
Examining Ex of equivalentâˆ’1ambiguous

ample 4.4 we see that all the graphs CoreFÏ• Î“ xyx
y âˆ’1 |Ï• âˆˆ Hom ((U, NU ) , (X, WX ))
are
stencil spaces FÏ• Î“ xyxâˆ’1 y âˆ’1 |Ï• âˆˆ Hom ((U1 , NU1 ) , (X, WX )) and
 containedâˆ’1inâˆ’1two

âˆ’1
FÏ• Î“ xtyx t y
|Ï• âˆˆ Hom ((U2 , NU2 ) , (X, WX )) . This is a reformulation of a classic result of Wicks [Wic62] about the commutator, as we explain below. A closer examination of the computation in Â§5 shows that there are five stencil spaces (up to conjugation) that
 include all other
stencil spaces: Cases 1, 2.1, 5.1.1, 5.1.2, and 6.1. The set of
âˆ’1
graphs
CoreF
Î“
bbaba
|Ï• âˆˆ Hom (({a, b} , âˆ…) , (X, WX )) is the union of the stencil spaces
Ï•
S
{F
(Î“
)
|Ï•
âˆˆ
Hom
((U
,
N
Ï•
i
i
Ui ) , (X, WX ))} with I = {1, 2.1, 5.1.1, 5.1.2 , 6.1} the set of indices
iâˆˆI
of stencil space cases. This fact, formulated differently, appears in [Mes72] (where Meskin attributes it to unpublished work by Newman). In fact, he shows more generally that this is true
for all Baumslag-Solitar relators bl abm aâˆ’1 (l, m âˆˆ Z). Technically this generalizes Wicksâ€™ result,
as the commutator has l = 1, m = âˆ’1. This leads us to define the notion of stencil-finiteness
below. Even though Meskin and Wicks did not define this notion, each of them showed that some
word satisfies it. They were interested in words w with this property because it implies an easy
algorithm to determine whether there is a solution to the equation w (y1 , . . . , yn ) = a with a âˆˆ FX
and unknowns y1 , . . . , yn âˆˆ FY . First we define the following poset:
Definition 6.1. Let X be a countably infinite set, and define an equivalence relation between
folded X-labeled graphs: Î“ âˆ¼ âˆ† iff there exists non-degenerate homomorphisms Ï•, Ïˆ : FX â†’ FX
such that (Ï•, Î“) and (Ïˆ, âˆ†) are stencils and FÏ• (Î“) = âˆ†, FÏˆ (âˆ†) = Î“. On the set of equivalence
classes we define [Î“] â‰¤ [âˆ†] iff there exists a non-degenerate homomorphism Ï• : FX â†’ FX such that
(Ï•, âˆ†) is a stencil and FÏ• (âˆ†) = Î“.
Definition 6.2. We say that a folded Y -labeled graph âˆ† has stencil-finiteness if the set
{[Core (FÏ• (âˆ†))] |Ï• âˆˆ Hom ((Y, âˆ…) , (X, WX ))} has a finite number of maximal elements.
This property can be translated to a property of words, subgroups and homomorphisms of free
groups by taking the corresponding graphs. Not all words have this property: Using the methods
described in this paper one can show that the word x3 y 2 does not have this property. This is a
lengthy computation and not the subject matter of the paper, and is therefore omitted. Is stencil
finiteness a sufficient condition for the process ending? We do not know the answer. A priori, the
graph Î“ may have stencil finiteness while âˆ† doesnâ€™t, and while the graphs CoreFÏ• (Î“) could repeat
themselves, the graphs CoreFÏ• (âˆ†) can be distinct and thus lead to infinite distinct ambiguous
cases. We do not have an explicit example for this mainly because there arenâ€™t many graphs known
to have stencil finiteness. The words known to have stencil finiteness are bl abm aâˆ’1 with l, m âˆˆ Z
(this includes the commutator), primitive words. One can show that powers of a word with this
property have it as well.
We end with some open questions:
1. Are there any other words with this property? Are there core graphs of subgroups with rank
â‰¥ 2 that have this property?
2. Is a surjectivity problem P = {Î“ â†’ âˆ†| (U, NU )} such that Î“ has stencil finiteness decidable?
3. Is stencil finiteness a decidable property?
4. Is there a purely algebraic interpretation of the property of an extension being onto on every
base?

References
[KM02] I. Kapovich and A. Myasnikov, Stallings foldings and subgroups of free groups, J. Algebra 248 (2002),
no. 2, 608â€“668.
[LS01] R. C. Lyndon and P. E. Schupp, Combinatorial group theory, Classics in Mathematics, Springer-Verlag,
Berlin, 2001. Reprint of the 1977 edition.

13

[Mes72] S. Meskin, Nonresidually finite one-relator groups, Trans. Amer. Math. Soc. 164 (1972), 105â€“114.
[MVW07] A. Miasnikov, E. Ventura, and P. Weil, Algebraic extensions in free groups, Geometric group theory,
2007, pp. 225â€“253.
[PP14] O. Parzanchevski and D. Puder, Stallings graphs, algebraic extensions and primitive elements in F2 ,
Math. Proc. Cambridge Philos. Soc. 157 (2014), no. 1, 1â€“11.
[Ser77] J.-P. Serre, Arbres, amalgames, SL2 , SociÃ©tÃ© MathÃ©matique de France, Paris, 1977. Avec un sommaire
anglais, RÃ©digÃ© avec la collaboration de Hyman Bass, AstÃ©risque, No. 46.
[Sta83] J. R. Stallings, Topology of finite graphs, Invent. Math. 71 (1983), no. 3, 551â€“565.
[Sta99] J. R. Stallings, Whitehead graphs on handlebodies, Geometric group theory down under (Canberra, 1996),
1999, pp. 317â€“330.
[Whi36] J. H. C. Whitehead, On Certain Sets of Elements in a Free Group, Proc. London Math. Soc. (2) 41
(1936), no. 1, 48â€“56.
[Wic62] N. J. Wicks, Commutators in free products, J. London Math. Soc. 37 (1962), 433â€“444.

14

u
u

v

u

t

u

t

u

u

v

y

y

x

u

u

t

x
v

t

u

t

v

v

t

u

v

u

v

Case 6.1.2
Case 3.1.2
v

u

t
u

v

y
u
u

t
u

v
u

x

x

t

v
x

y

Case 6.1.4
u
t

u

v

u

u

v

Case 7.1.3
x

u

v

t
x

u

t

y

u

u

Case 7.1.2

v

x

x

t

u

u

u

v

v

u

Case 3.1.4

t

x

u

v

x

v

y

u
u

v

u

v

Case 7.1.4

y

y

u

u

t

s

t

s

u

y

u

v

u

v
t

u

v

s

y

v

u

v
u
y

Case 6.1.3

Figure 5.1: The graphs âˆ†i.k.j = CoreFÏˆi.k.j (âˆ†i,k ) arising in the analysis of the counterexample.

15

