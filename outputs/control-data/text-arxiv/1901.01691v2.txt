arXiv:1901.01691v2 [math.DS] 2 Jun 2020

DIMENSION OF INVARIANT MEASURES FOR AFFINE
ITERATED FUNCTION SYSTEMS
DE-JUN FENG
Abstract. Let {Si }iâˆˆÎ› be a finite contracting affine iterated function system
(IFS) on Rd . Let (Î£, Ïƒ) denote the two-sided full shift over the alphabet Î›, and Ï€ :
Î£ â†’ Rd be the coding map associated with the IFS. We prove that the projection
of an ergodic Ïƒ-invariant measure on Î£ under Ï€ is always exact dimensional, and its
Hausdorff dimension satisfies a Ledrappier-Young type formula. Furthermore, the
result extends to average contracting affine IFSs. This completes several previous
results and answers a folklore open question in the community of fractals. Some
applications are given to the dimension of self-affine sets and measures.

1. Introduction
1.1. Motivation and the main result. Let Matd (R) denote the set of real d Ã— d
matrices. By an affine iterated function system (affine IFS) on Rd we mean a finite
family S = {Sj }jâˆˆÎ› of affine mappings from Rd to Rd , taking the form
(1.1)

Sj (x) = Mj x + aj ,

j âˆˆ Î›,

where Mj âˆˆ Matd (R) and aj âˆˆ Rd . Here, in contrast to the usual definition of
affine IFS, we do not assume that Mj are invertible or contracting (in the sense that
kMj k < 1 where k Â· k is the matrix operator norm). We say that S is contracting
if all Mj are contracting. It is well-known that if S is contracting, there exists a
unique non-empty compact set K âŠ‚ Rd such that
[
Sj (K).
K=
jâˆˆÎ›

We call K the self-affine set generated by S. In particular, if all the maps in S are
contracting similitudes, we call K a self-similar set. As usual, a contracting S is
said to satisfy the open set condition if there exists a non-empty open set U âŠ‚ Rd
such that Sj (U), j âˆˆ Î›, are disjoint subsets of U; moreover, S is said to satisfy the
strong separation condition if Sj (K), j âˆˆ Î›, are disjoint.
Let (Î£, Ïƒ) be the two-sided full shift over the alphabet Î›, i.e. Î£ = Î›Z and Ïƒ :
Î£ â†’ Î£ is the left shift map. Endow Î£ with the product topology and let MÏƒ (Î£)
denote the space of Ïƒ-invariant Borel probability measures on Î£.
Key words and phrases. Iterated function systems, self-affine sets and measures, invariant measures, exact dimensionality, Hausdorff dimension, packing dimension.
2000 Mathematics Subject Classification: 28A80, 37C45.
1

2

DE-JUN FENG

Definition 1.1. Let m âˆˆ MÏƒ (Î£). An affine IFS S = {Mj x + aj }jâˆˆÎ› is said to
be average contracting with respect to m if, for m-a.e. x = (xn )âˆ
n=âˆ’âˆ âˆˆ Î£, the top
Lyapunov exponent Î»(x) defined by
1
Î»(x) = lim log kMx0 Â· Â· Â· Mxnâˆ’1 k
nâ†’âˆ n
is strictly negative.
We remark that the above limit in defining Î»(x) exists and takes values in [âˆ’âˆ, âˆ)
for m-a.e. x. This follows from the Furstenberg-Kesten theorem [35] or Kingmanâ€™s
sub-additive ergodic theorem [45].
Now let m âˆˆ MÏƒ (Î£) and suppose that S is average contracting with respect to
m. The canonical coding map Ï€ : Î£ â†’ Rd , given by
Ï€(x) = lim Sx0 â—¦ Sx1 â—¦ Â· Â· Â· â—¦ Sxn (0)
(1.2)

nâ†’âˆ


= lim ax0 + Mx0 ax1 + Â· Â· Â· + Mx0 Â· Â· Â· Mxnâˆ’1 axn ,
nâ†’âˆ

is well-defined on Î£ up to a set of zero m-measure ([16, 14]); see Section 3 for a
self-contained proof. The push-forward Ï€âˆ— m of m by Ï€, given by
(Ï€âˆ— m)(F ) = m(Ï€ âˆ’1 (F ))

for any Borel set F âŠ‚ Rd ,

is called an invariant measure or stationary measure for S. When m is ergodic, Ï€âˆ— m
is called an ergodic invariant measure for S. Moreover if m is a Bernoulli product
measure, Ï€âˆ— m is called a self-affine measure generated by S; if in addition, S consists
of similarities, then Ï€âˆ— m is called a self-similar measure.
The main purpose of this paper is to study the dimension of invariant measures
for affine IFSs. Recall that for a probability measure Î· on a metric space X, the
local upper and lower dimensions of Î· at x âˆˆ X are defined respectively by
dimloc (Î·, x) = lim sup
râ†’0

log Î·(B(x, r))
,
log r

dimloc (Î·, x) = lim inf
râ†’0

log Î·(B(x, r))
,
log r

where B(x, r) stands for the closed ball of radius r centered at x. If
dimloc (Î·, x) = dimloc (Î·, x),
the common value is denoted as dimloc (Î·, x) and is called the local dimension of Î· at
x. We say that Î· is exact dimensional if there exists a constant C such that the local
dimension dimloc (Î·, x) exists and equals C for Î·-a.e. x âˆˆ X. It is well-known that if
Î· is an exact dimensional measure in Rd , the Hausdorff and packing dimensions of
Î· coincide and are equal to the involved constant C, and so are some other notions
of dimension (e.g. entropy dimension); see [72, 22]. Recall that the Hausdorff and
packing dimensions of Î· are defined by
dimH Î· = inf{dimH F : Î·(F ) > 0 and F is a Borel set},
dimP Î· = inf{dimP F : Î·(Rd \ F ) = 0 and F is a Borel set},
where dimH F, dimP F stand for the Hausdorff and packing dimensions of F , respectively (cf. [23]).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

3

A folklore open problem in fractal geometry asks whether every ergodic invariant
measure for an affine IFS is exact dimensional. As the main result of this paper, we
give the following affirmative answer.
Theorem 1.2. Let S = {Mj x + aj }jâˆˆÎ› be an affine IFS on Rd and m âˆˆ MÏƒ (Î£).
Suppose that S is average contracting with respect to m. Let Âµ = Ï€âˆ— m. Then
(i) dimloc (Âµ, x) exists for Âµ-a.e. x âˆˆ Rd .
(ii) Assume furthermore that m is ergodic. Then Âµ is exact dimensional and
dimH Âµ satisfies a Ledrappier-Young type dimension formula.
The precise dimension formula of Âµ and some of its applications will be given in
Sections 1.2-1.3.
We remark that Theorem 1.2 also holds in its one-sided version. To be more
precise, let (Î£+ , Ïƒ) denote the one-sided full shift over the alphabet Î›, i.e.,
Î£+ = {(xn )âˆ
n=0 : xn âˆˆ Î› for all n â‰¥ 0},
and Ïƒ is the left shift map. Let Ï„ : Î£ â†’ Î£+ be the natural projection defined by
+
âˆ
x = (xn )âˆ
n=âˆ’âˆ 7â†’ x = (xn )n=0 .

It is well known that the push-forward map Ï„âˆ— : MÏƒ (Î£) â†’ MÏƒ (Î£+ ), m 7â†’ Ï„âˆ— m, is
bijective, and moreover, Ï„âˆ— m is ergodic if and only if m is ergodic (see e.g. [15, pp. 2122]). Let m+ âˆˆ MÏƒ (Î£+ ) and assume that S is average contracting with respect to
m = (Ï„âˆ— )âˆ’1 (m+ ). Define Ï€ + : Î£+ â†’ Rd by (xn )âˆ
n=0 7â†’ limnâ†’âˆ Sx0 â—¦ Â· Â· Â· â—¦ Sxn (0).
Then Ï€(x) = Ï€ + (x+ ) and so Ï€ + is well defined m+ -a.e. Moreover, (Ï€ + )âˆ— (m+ ) = Ï€âˆ— m.
Hence the conclusions of Theorem 1.2 hold for (Ï€ + )âˆ— (m+ ).
Below we first give some background information about the above study.
The problem of the existence of local dimensions has a long history in smooth
dynamical systems, as well as in the study of IFSs. It is of great importance in
dimension theory of dynamical systems and fractal geometry. In [72], Young proved
that an ergodic hyperbolic measure invariant under a C 2 surface diffeomorphism is
always exact dimensional. (Here by hyperbolic one means that the measure has no
zero Lyapunov exponent.) For a hyperbolic measure Âµ in higher-dimensional C 2
systems, Ledrappier and Young [46] proved the existence of Î´ u and Î´ s , the local
dimensions along stable and unstable local manifolds, respectively, and the upper
local dimension of Âµ is bounded by the sum of Î´ u and Î´ s ; moreover they obtained
a formula for Î´ u and Î´ s in terms of conditional entropies and Lyapunov exponents,
which nowadays is called â€œLedrappier-Young formulaâ€. Eckmann and Ruelle [19]
indicated that it is unknown whether the local dimension of Âµ is equal to the sum of
Î´ u and Î´ s if Âµ is a hyperbolic measure. Then the problem was referred as EckmannRuelle conjecture, and was finally answered affirmatively by Barreira, Pesin and
Schmeling in 1999 for C 1+Î± diffeomorphisms [10]. Later, the result of exact dimensionality was further extended by Qian and Xie [62] and Shu [69] to C 2 expanding
endomorphisms and C 2 non-degenerate endomorphisms, respectively.
For the study of IFSs, it is well-known that if S is a contractive IFS consisting of
similarity maps, or more generally, a contracting C 1 conformal IFS, then under an

4

DE-JUN FENG

additional assumption of the open set condition, the push-forward measure of any
ergodic invariant measure by the coding map is exact dimensional with dimension
given by the classical entropy divided by the Lyapunov exponent (cf. [12, 40, 58]).
The result essentially follows from the Shannon-McMillan-Breiman theorem in entropy theory. However, the problem becomes much more complicated without assuming the open set condition. In [29], by introducing a notion of projection entropy
and adopting some ideas from [46], Feng and Hu proved that for any contracting C 1
conformal IFS, the push-forward measure of every ergodic invariant measure under
the coding map is exact dimensional, with dimension given by the projection entropy divided by the Lyapunov exponent. Later this result was further extended to
some random self-similar measures [25, 68] and push-forward measures of ergodic
invariant measures for some random conformal IFSs [52]. It is worth pointing out
that the exact dimensionality of overlapping self-similar measures was first claimed
by Ledrappier; nevertheless no proof has been written out (cf. [59, p. 1619]). This
property was also conjectured later by Fan, Lau and Rao in [27].
The first result for affine IFSs is due to Bedford [11] and McMullen [51], who
independently calculated the Hausdorff and box-counting dimensions of a special
class of planar self-affine sets (which are now called Bedford-McMullen carpets) and
showed that they are usually different. McMullen [51] also implicitly proved the
exact dimensionality of self-affine measures on the Bedford-McMullen carpets, and
calculated the precise value of the dimension. Later, Gatzouras and Lalley [36] and
BaranÌski [1] obtained similar results for a class of more general carpet-like self-affine
sets in the plane. In [44], Kenyon and Peres extended Bedford and McMullenâ€™s
result to higher dimensional self-affine carpets, and moreover, they proved the exact
dimensionality and gave a Ledrappier-Young type dimension formula for arbitrary
ergodic invariant measure on these carpets. For more related results on carpet-like
self-affine sets, see the survey paper [24].
In [29], Feng and Hu proved that for each contracting invertible affine IFS in Rd ,
Theorem 1.2 holds under an additional assumption that the linear parts of the IFS
commute (i.e. Mi Mj = Mj Mi ). It remained open whether this additional assumption could be removed. Very recently, BaÌraÌny and KaÌˆenmaÌˆki [4] made a substantial
progress. They proved that for contracting invertible affine IFSs, every planar selfaffine measure (more generally, every self-affine measure in Rd having d distinct
Lyapunov exponents) is exact dimensional, and moreover, under certain domination
condition on the linear parts {Mj }, the push-down of every quasi-Bernoulli measure
on the self-affine set is exact dimensional, with dimension given by a LedrappierYoung type formula. Some other partial results were also obtained in [2, 64, 32].
Along another direction, it is proved that for a given ergodic m âˆˆ MÏƒ (Î£), Ï€âˆ— m
is exact dimensional for â€œalmost allâ€ contracting invertible affine IFSs satisfying
kMj k < 1/2 ([42, 41, 66]); however, the result does not apply to any concrete case.
Theorem 1.2 finally gives a full affirmative answer to the problem of the existence
of local dimensions in the context of affine IFSs. It completes the aforementioned
previous works on the problem.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

5

Exact dimensionality and Ledrappier-Young type dimension formula play a significant role in many of the recent advances in dimension theory of self-affine sets
and measures (see e.g. [2, 3, 4, 5, 6, 7, 8, 9, 18, 26, 39, 54, 61, 64]). In the remaining
part of this section, we will present some applications of Theorem 1.2 along the lines
of these developments.
The proof of Theorem 1.2 is based on some ideas from the work of Ledrappier
and Young [46]. It also adopts and extends some ideas used in [29, 4, 62] for the
construction of measurable partitions and the density estimates of associated conditional measures. Since our construction of measurable partitions is much different
from these works (see Remark 4.3), and the IFSs in consideration may be noninvertible and non-contractive, many estimates of conditional measures need to be
rebuilt or re-justified. A key part of our arguments is on the estimation of the
so-called â€œtransverse dimensionâ€ of these conditional measures, where significant efforts are made to handle the situation when the linear parts of the IFS do not satisfy
any domination condition (in such case the angles of Oseledets subspaces may be
arbitrarily close to zero). Our strategy is to build an induced dynamics so that we
are able to focus on the trajectories where the angles of Oseledets subspaces are
larger than a positive constant.
1.2. Dimension formulas. Throughout this subsection, under the assumptions of
Theorem 1.2, we further assume that m is ergodic. We are going to present certain
dimension formulas for Âµ = Ï€âˆ— m and related conditional measures.
First notice that in this ergodic case, the condition (3) in Definition 1.1 is equivalent to
Z
1
log kMx0 Â· Â· Â· Mxnâˆ’1 k dm(x) < 0.
(1.3)
Î» := lim
nâ†’âˆ n
By Oseledetsâ€™ multiplicative ergodic theorem [55], there exist an integer
Ps1 â‰¤ s â‰¤ d,
numbers Î» = Î»1 > Â· Â· Â· > Î»s â‰¥ âˆ’âˆ, positive integers k1 , . . . , ks with i=1 ki = d,
and measurable linear subspaces
Rd = Vx0 ) Vx1 ) Â· Â· Â· ) Vxs = {0},

x âˆˆ Î£,

such that for m-a.e. x = (xn )âˆ
n=âˆ’âˆ ,
(i) Mxâˆ’1 Vxi âŠ‚P
VÏƒiâˆ’1 x ;
i
(ii) dim Vx = sj=i+1 kj ;
(iii) limnâ†’âˆ n1 log kMxâˆ’n Â· Â· Â· Mxâˆ’1 vk = Î»i+1 for v âˆˆ Vxi \Vxi+1 .
When the matrices Mj (j âˆˆ Î›) are assumed to be invertible, then (i) becomes an
equality. It in general is a containment because Mj may be singular. The numbers
Î»1 , . . . , Î»s are called the Lyapunov exponents of (Mj )jâˆˆÎ› with respect to m, and ki
the multiplicity of Î»i , i = 1, . . . , s. Recall that Ï€(x) is well-defined for m-a.e. x.
Hence there exists a Borel set Î£â€² âŠ‚ Î£ with Ïƒ(Î£â€² ) = Î£â€² and m(Î£â€² ) = 1 such that Ï€
is well-defined on Î£â€² and the above properties (i)-(iii) hold for x âˆˆ Î£â€² .

6

DE-JUN FENG

We remark that these linear subspaces Vxi only depend on i and xâˆ’ := (xj )âˆ’1
j=âˆ’âˆ
since by (i)-(iii), one has


1
i
d
Vx = v âˆˆ R : lim log kMxâˆ’n Â· Â· Â· Mxâˆ’1 vk â‰¤ Î»i+1 .
nâ†’âˆ n
Using this property, we construct a family of measurable partitions Î¾0 , . . . , Î¾s of Î£â€²
as follows:
Î¾i (x) := {y âˆˆ Î£â€² : y âˆ’ = xâˆ’ , Ï€y âˆ’ Ï€x âˆˆ Vxi },
here Î¾i (x) is the Î¾i -atom that contains x (see Sections 2.2 and 4 for the details).
Moreover, let
(1.4)

P = {[j] âˆ© Î£â€² : j âˆˆ Î›}

be the canonical partition of Î£â€² , where [j] := {x = (xn )âˆ
n=âˆ’âˆ âˆˆ Î£ : x0 = j}. Define
(1.5)

hi = Hm (P|Î¾bi ),

i = 0, . . . , s,

where Hm (Â·|Â·) stands for the conditional entropy and Î¾bi is the Ïƒ-algebra generated
by Î¾i (see Sections 2.1-2.2 for the definitions).

We remark that the spaces Vxi are strictly decreasing, Rd = Vx0 ) Vx1 ) Â· Â· Â· )
= {0}. Therefore, the partitions Î¾i become finer as i increases: the partition
Î¾0 is the partition according to the â€œpastâ€ xâˆ’ , then Î¾1 is the partition according to
the past joined with the partition according to translations of Vxi , etc. Therefore hi
decrease with i, since hi+1 is conditioned on partition Î¾i+1 which is finer than the
partition Î¾i on which hi is conditioned.
Vxs

Now we are ready to present the dimension formula for Ï€âˆ— m.
Theorem 1.3. Let S = {Mj x + aj }jâˆˆÎ› be an affine IFS on Rd and m be an ergodic
Ïƒ-invariant measure on Î£. Suppose that S is average contracting with respect to m.
Let Âµ = Ï€âˆ— m. Then
(1.6)

dimH Âµ =

sâˆ’1
X
hi+1 âˆ’ hi
i=0

Î»i+1

,

where hi are defined as in (1.5).
We remark that both the nominators and denominators in (1.6) are non-positive.
Next we give similar dimension formulas for certain conditional measures associated
with m. For i = 0, . . . , s, let {mÎ¾xi } be the system of conditional measures of m
associated with the partition Î¾i (cf. Section 2.2). For a linear subspace W of Rd , let
W âŠ¥ denote the orthogonal complement of W in Rd , and let PW : Rd â†’ W denote
the orthogonal projection from Rd to W .
Theorem 1.4. Under the assumptions of Theorem 1.3, forany 0 â‰¤ i < j â‰¤ s and
m-a.e. x âˆˆ Î£â€² , the push-forward measures Ï€âˆ— (mÎ¾xi ), P(V j )âŠ¥ Ï€ âˆ— (mÎ¾xi ) of mÎ¾xi are exact
x

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

7

dimensional with
sâˆ’1
 X
hâ„“+1 âˆ’ hâ„“
dimH Ï€âˆ— (mÎ¾xi ) =
,
Î»
â„“+1
â„“=i

(1.7)
(1.8)

dimH



P(V j )âŠ¥ Ï€
x



(mÎ¾xi )
âˆ—



=

(1.9)

dimloc





P(V j )âŠ¥ Ï€ âˆ— m, P(V j )âŠ¥ (Ï€x) =
x

Î»â„“+1

â„“=i

Moreover, for m-a.e. x âˆˆ Î£â€² and any 1 â‰¤ j â‰¤ s,


jâˆ’1
X
hâ„“+1 âˆ’ hâ„“

x

,

jâˆ’1
X
hâ„“+1 âˆ’ hâ„“
â„“=0

Î»â„“+1

.

From the above theorem,
 we can deduce certain dimension conservation property
for the measures Ï€âˆ— mÎ¾x0 and Âµ. To state the result, let G(d, k) denote the Grassmannian manifold of k-dimensional linear subspaces of Rd . For a Borel probability
measure Î· on Rd and W âˆˆ G(d, k), let {Î·W,z = Î·zÎ¶W }zâˆˆRd denote the the system of
conditional measures of Î· associated with the measurable partition Î¶W given by
Î¶W = {W + a : a âˆˆ W âŠ¥ }.
These conditional measures are also called the slicing measures of Î· along the subspace W (cf. [50, Â§10.1]). Following Furstenberg [34], we give the following.
Definition 1.5. A measure Î· is said to be dimension conserving with respect to the
projection PW âŠ¥ , if
dimH Î· = dimH Î·W,z + dimH ((PW âŠ¥ )âˆ— Î·)
for Î·-a.e. z âˆˆ Rd .
For i âˆˆ {0, . . . , s âˆ’ 1}, define Î i : Î£â€² â†’ G(d,
(1.10)

Ps

j=i+1

kj ) by

Î i (x) = Vxi .

The push-forward measures (Î i )âˆ— m, i = 1, . . . , s âˆ’ 1, are called the Furstenberg
measures or Furstenberg-Oseledets measures associated with (Mj )jâˆˆÎ› and m. An
ergodic measure Î½ âˆˆ MÏƒ (Î£) is said to be quasi-Bernoulli if there exists a positive
constant C such that
C âˆ’1 Î½([I])Î½([J]) â‰¤ Î½([IJ]) â‰¤ CÎ½([I])Î½([J])
for any finite words I, J over Î›, where
[I] := {x âˆˆ Î£ : xj = ij for 0 â‰¤ j â‰¤ n âˆ’ 1}
for I = i0 . . . inâˆ’1 . Similarly, we say that Î½ is sub-multiplicative if there exists a
positive constant C such that Î½([IJ]) â‰¤ CÎ½([I])Î½([J]) for any finite words I, J over
Î›.
Theorem 1.6. Under the assumptions of Theorem 1.3, we further assume that
s â‰¥ 2. Let i âˆˆ {1, . . . , s âˆ’ 1}. Then the following statements hold.

8

DE-JUN FENG


(i) For m-a.e. x âˆˆ Î£â€² , Ï€âˆ— mÎ¾x0 is dimension conserving with respect to P(Vxi )âŠ¥


and moreover, the projected measure P(Vxi )âŠ¥ Ï€ âˆ— mÎ¾x0 is exact dimensional,


and so are the slicing measures Ï€âˆ— mÎ¾x0 V i ,y for Ï€âˆ— mÎ¾x0 -a.e. y.
x
(ii) Assume that m is quasi-Bernoulli. Then for (Î i )âˆ— m-a.e. W , Âµ is dimension conserving with respect to PW âŠ¥ , and moreover, the associated projected
measure and almost all slicing measures are exact dimensional.
(iii) Assume that m is sub-multiplicative. Then for (Î i )âˆ— m-a.e. W , there exists
a subset AW of Rd with Âµ(AW ) > 0 such that for every z âˆˆ AW ,
dimloc (ÂµW,z , z) =

sâˆ’1
X
hâ„“+1 âˆ’ hâ„“
â„“=i



PW âŠ¥ âˆ— Âµ, PW âŠ¥ (z) =

Î»â„“+1

,

iâˆ’1
X

hâ„“+1 âˆ’ hâ„“
,
Î»â„“+1
â„“=0


and so, dimH Âµ = dimloc (ÂµW,z , z) + dimloc PW âŠ¥ âˆ— Âµ, PW âŠ¥ (z) . When m is
quasi-Bernoulli then one can take the set AW such that Âµ(AW ) = 1.
dimloc

We remark that part (ii) of Theorem 1.6 was previously proved in [4] under the assumptions that S is contracting, invertible and its linear parts satisfy certain domination condition. According to part (iii) of the theorem, when m is sub-multiplicative,
Âµ partially satisfies dimension conservation. It is unknown whether part (ii) always holds when m is only assumed to be ergodic. However, as is illustrated in the
following theorem, this is true in the special case that the linear parts of the IFS
commute.
Theorem 1.7. Let S = {Mj x + aj }jâˆˆÎ› be an affine IFS on Rd , average contracting
with respect to an ergodic m âˆˆ MÏƒ (Î£). Let Âµ = Ï€âˆ— m. Assume s â‰¥ 2 and in
addition that Mj Mj â€² = Mj â€² Mj for j, j â€² âˆˆ Î›. Then for i âˆˆ {1, . . . , s âˆ’ 1}, Vxi is
constant m-a.e., denoted by Wi , moreover, Âµ is dimension conserving with respect
to P(Wi )âŠ¥ .
It is worth pointing out that if Âµ is a contracting self-similar measure in Rd with
a finite rotation group, then for each proper subspace W of Rd , Âµ is dimension conserving with respect to PW . The result is due to Falconer and Jin [25]. Under an
additional assumption of the strong separation condition, this result can be alternatively derived from a general result of Furstenberg (cf. [34, Theorem 3.1]). We
remark that this dimension conservation property also extends to ergodic invariant measures for rotation-free self-similar IFSs (see Remark 6.3). However, as was
proved by Rapaport [63], this dimension conservation actually can fail for some selfsimilar measures with infinite rotation groups. Finally we remark that Theorems
1.6-1.7 can be applied to analyze slices and projections of certain self-affine sets (see
Remark 7.5).
1.3. Semi-continuity of dimension and applications. Here we present a semicontinuity result on the dimension of ergodic invariant measures for affine IFSs and

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

9

give its application to the dimension of self-affine sets. Again let S = {Mi x + ai }iâˆˆÎ›
be an affine IFS on Rd , average contracting with respect to an ergodic invariant
measure m on Î£. Write a = (ai )iâˆˆÎ› . To emphasize the dependence on a, let Ï€a
be the coding map associated to S and let hi,a (i = 1, . . . , s) be the conditional
entropies of m defined in (1.5). Then we have the following.
Theorem 1.8.
(1) The mapping a 7â†’ hi,a is upper semi-continuous for each
i âˆˆ {1, . . . , s}.
(2) Moreover, the mapping a 7â†’ dimH ((Ï€a )âˆ— m) is lower semi-continuous.
Part (1) of the above result was first proved by Rapaport [64, Lemma 8] in the
case when m is a Bernoulli product measure and S is invertible and contracting.
Part (2) was shown by Hochman and Shmerkin [38] for a special class of self-similar
measures on R. In Remark 8.2 we give a further extension of Theorem 1.8.
Below we present an application of Theorem 1.8 to the dimension of self-affine
sets and associated stationary measures. For this purpose, in the remaining part
of this subsection we assume that kMj k < 1 for j âˆˆ Î› and write M = (Mj )jâˆˆÎ› .
Let K(M, a) be the self-affine set generated by the IFS S = {Mj x + aj }jâˆˆÎ› . In
1988, Falconer [21] introduced a quantity associated to M, nowadays usually called
the affinity dimension dimAFF (M), which is always an upper bound for the upper
box-counting dimension of K(M, a), and such that when kMj k < 1/2 for all j, then
for Ld|Î›| -a.e. a, dimH K(M, a) = min(d, dimAFF (M)). In fact, Falconer proved this
with 1/3 as the upper bound on the norms; it was subsequently shown by Solomyak
[70] that 1/2 suffices.
The analogue of affinity dimension for measures is the Lyapunov dimension, which
we denote dimLY (m, M); see Section 7 for its definition. In [42], Jordan, Pollicott
and Simon proved that the Lyapunov dimension dimLY (m, M) is always an upper
bound for the Hausdorff dimension of (Ï€a )âˆ— m, and moreover when kMj k < 1/2 for
all j, then for Ld|Î›| -a.e. a, dimH ((Ï€a )âˆ— m) = min(d, dimLY (m, M)).
Recall a set in a topological space is said to be of first category if it can be written
as the countable union of nowhere dense subsets. As an application of Theorem 1.8,
we get the following result.
Theorem 1.9. Suppose that kMj k < 1/2 for j âˆˆ Î›. Then the following hold.
(i) For every ergodic Ïƒ-invariant measure m on Î£, the exceptional set

a âˆˆ Rd|Î›| : dimH ((Ï€a )âˆ— m) 6= min(d, dimLY (m, M))

is of first category in Rd|Î›| .
(ii) The exceptional set

a âˆˆ Rd|Î›| : dimH K(M, a) 6= min(d, dimAFF (M))
is of first category in Rd|Î›| .

The above result says that these exceptional sets are also small in a topological
sense. A fundamental and challenging question is to specify those translation vectors

10

DE-JUN FENG

not lying in the exception sets. Significant progresses have been made recently in
[2, 26, 4, 64], showing that under certain additional assumptions, the Hausdorff
and Lyapunov dimensions of a self-affine measure (or more generally, the pushforward of a quasi-Bernoulli measure) coincide if the involved Furstenberg measures
have enough large dimension. In next theorem we will drop off some redundant
assumptions used in these works and further extend the result to the push-forward
measures of ergodic sub-multiplicative measures.
Recall that for a Borel probability measure Î· on a metric space, its upper Hausdorff
dimension dimâˆ—H Î· is the smallest Hausdorff dimension of a Borel set F of Î· measure
1. Set d0 = 0 and dâ„“ = k1 + Â· Â· Â· + kâ„“ for 1 â‰¤ â„“ â‰¤ s.
Theorem 1.10. Let S = {Mj x+ aj }jâˆˆÎ› be a contracting affine IFS on Rd satisfying
the strong separation condition and m âˆˆ MÏƒ (Î£) be ergodic and sub-multiplicative.
Let i be the unique element in {1, . . . , s} so that diâˆ’1 â‰¤ dimLY (m, M) < di . Then
(1.11)

dimH (Ï€âˆ— m) = dimLY (m, M)

provided one of the following conditions holds:
(a) s = 1.
(b) i = s > 1, Î»s 6= âˆ’âˆ and
(1.12)

dimâˆ—H ((Î sâˆ’1 )âˆ— m) + dimLY (m, M) â‰¥ dsâˆ’1(d âˆ’ dsâˆ’1 + 1).

(c) 1 â‰¤ i â‰¤ s âˆ’ 1, and
(1.13)

dimâˆ—H ((Î i )âˆ— m) âˆ’ dimLY (m, M) â‰¥ di (d âˆ’ di âˆ’ 1),

(1.14)

dimâˆ—H ((Î iâˆ’1 )âˆ— m) + dimH (Ï€âˆ— m) â‰¥ diâˆ’1 (d âˆ’ diâˆ’1 + 1).

The conditions (b), (c) in the above theorem were introduced in [64] and [4],
respectively, in slightly stronger forms. For a contracting invertible affine IFS, Rapaport [64] proved the implication (b)â‡’ (1.11) in the case when m is Bernoulli
and (Mj )jâˆˆÎ› satisfies an irreducibility assumption; whilst BaÌraÌny and KaÌˆenmaÌˆki [4]
proved (1.11) under the assumptions that the conditions (1.13)-(1.14) hold for all
i âˆˆ {1, . . . , s âˆ’ 1}, m is Bernoulli and d = 2, or m is quasi-Bernoulli and {Mj }jâˆˆÎ›
satisfies a domination condition.
We remark that (1.14) always holds whenever i = 1, since d0 = 0. It is worth
pointing out that for every affine IFS S = {Mj x + aj }jâˆˆÎ› on Rd , there exists at
least one ergodic m âˆˆ MÏƒ (Î£), called KaÌˆenmaÌˆki measure, so that dimLY (m, M) =
dimAFF (M). This was first proved by KaÌˆenmaÌˆki [43] in the case when S is invertible,
and it extends to the general case by the sub-additive thermodynamic formalism [17].
Very recently, Bochi and Morris [13] showed that whenever S is invertible, each
KaÌˆenmaÌˆki measure is sub-multiplicative. Hence for an invertible S satisfying the
strong separation condition, if one of the conditions (a)-(c) in Theorem 1.10 fulfills
for some KaÌˆenmaÌˆki measure m, then dimH K(M, a) = dimAFF (M) = dimH (Ï€âˆ— m).
To check the conditions (b)-(c) in Theorem 1.10, one needs to estimate the (upper) Hausdorff dimension of Furstenberg measures (Î i )âˆ— m. So far there have been
only a few dimensional results on these measures. In the case d = 2, Hochman
and Solomyak [39] calculated the Hausdorff dimension of Furstenberg measures for

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

11

Bernoulli m under some mild assumptions. In [8, Sect. 2.4], BaÌraÌny, Rams and Simon determined the Hausdorff dimension of Furstenberg measures for some special
triangular affine IFSs in Rd , in which m could be any ergodic measure.
We remark that the conditions of Theorem 1.10 might not be sharp. Very recently, BaÌraÌny, Hochman and Rapaport [3] made a significant progress in dimension
theory of affine IFSs, showing that the Hausdorff and affinity dimensions of a planar
self-affine set coincide under the strong separation condition and certain irreducibility assumption; and similarly, the Hausdorff and Lyapunov dimensions of a planar
self-affine measure coincide under the same assumptions. In [37], Hochman and Rapaport further showed that the strong separation condition can be replaced by the
exponential separation condition, which is substantially weaker.
1.4. Organization of the paper. The paper is organized as follows. In Section 2,
we provide some density results about conditional measures, and present a version of
Oseledetsâ€™s multiplicative ergodic theorem due to Froyland et al. [33]. In Section 3,
we give some auxiliary results on the coding maps for average contracting affine IFSs.
In Section 4, we construct a finite family of measurable partitions of Î£ for a given
average contracting affine IFS and give some necessary properties. In Section 5
we prove an inequality for the transverse dimensions of the conditional measures
associated with these measurable partitions. In Section 6, we prove Theorems 1.21.4, 1.6-1.7. In Section 7, we give some properties of Lyapunov dimension. In
Section 8, we prove Theorems 1.8-1.10.
2. Preliminaries
2.1. Conditional information and entropy. Let (X, B, m) be a probability space.
For a sub-Ïƒ-algebra A of B and f âˆˆ L1 (X, B, m), we denote by Em (f |A) the the
conditional expectation of f given A. For a countable B-measurable partition Î¾ of
X, we denote by Im (Î¾|A) the conditional information of Î¾ given A, which is given
by the formula
X
(2.1)
Im (Î¾|A) = âˆ’
Ï‡A log Em (Ï‡A |A),
AâˆˆÎ¾

where Ï‡A is the characteristic function on A. The conditional entropy of Î¾ given A,
written as Hm (Î¾|A), is defined by the formula
Z
Hm (Î¾|A) = Im (Î¾|A) dm.

(See e.g. [57, 71] for more details.) The above information and entropy are unconditional when A = N , the trivial Ïƒ-algebra consisting of sets of measure zero and
one, and in this case we write
Im (Î¾|N ) =: IÎ½ (Î¾) and Hm (Î¾|N ) =: Hm (Î¾).

For a countable partition Î¾, we use Î¾b to denote the Ïƒ-algebra generated by Î¾. If Î¾
is an uncountable measurable partition of X (which will be defined in Section 2.2),
Î¾b is defined as the sub-Ïƒ-algebra of B whose sets are Î¾-saturated (i.e. unions of

12

DE-JUN FENG

W
elements in Î¾). If Î¾1 ,. . . , Î¾n are countable partitions, then Î¾1 âˆ¨ Â· Â· Â· âˆ¨ Î¾n = ni=1 Î¾i
denotes the partition consists of the sets W
A1 âˆ© Â· Â· Â· âˆ© An with Ai âˆˆ Î¾i . Similarly for
Ïƒ-algebras A1 , A2 ,. . . , A1 âˆ¨ A2 âˆ¨ Â· Â· Â· or i Ai denotes the Ïƒ-algebra generated by
S
i Ai .

In the following lemma, we list some basic properties of the (conditional) expectation, information and entropy. The reader is referred to [57, pages 20-21 and 38]
for details.

Lemma 2.1. Let T be a measure-preserving transformation of a separable probability
space (X, B, m). Let Î¾, Î· be two countable Borel partitions of X with Hm (Î¾) < âˆ,
Hm (Î·) < âˆ, and A a sub-Ïƒ-algebra of B. Then we have
(i)
(ii)
(iii)
(iv)
(v)

Em (f |A) â—¦ T = Em (f â—¦ T |T âˆ’1A) for f âˆˆ L1 (X, B, m).
Im (Î¾|A) â—¦ T = Im (T âˆ’1 Î¾|T âˆ’1A).
Im (Î¾ âˆ¨ Î·|A) = Im (Î¾|A) + Im (Î·|Î¾b âˆ¨ A).
Hm (Î¾ âˆ¨ Î·|A) = Hm (Î¾|A) + Hm (Î·|Î¾b âˆ¨ A).
If A1 âŠ‚ A2 âŠ‚ Â· Â· Â· is an increasing sequence of sub-Ïƒ-algebras with An â†‘ A,
then supn Im (Î¾|An) âˆˆ L1 , and Im (Î¾|An ) converges almost everywhere and in
L1 to Im (Î¾|A). In particular, limnâ†’âˆ Hm (Î¾|An) = Hm (Î¾|A).

For the convenience of the reader, below we state an almost trivial property of
the conditional expectation. For a proof, see e.g. [29, Lemma 3.10].
Lemma 2.2. Let (X, B, m) be a probability space and A a sub-Ïƒ-algebra of B. Let
A âˆˆ B with m(A) > 0. Then
Em (Ï‡A |A)(x) > 0
for m-a.e. x âˆˆ A.
The following lemma is a variant of Makerâ€™s ergodic theorem ([49]).
Lemma 2.3 ([48], Corollary 1.6, p. 96). Let T be a measure-preserving transformation of a probability space (X, B, m). Let gk âˆˆ L1 (X, B, m) be a sequence that
converges almost everywhere and in L1 to g âˆˆ L1 (X, B, m). Then
kâˆ’1

1X
gkâˆ’j (T j x) = Em (g|I)(x)
lim
kâ†’+âˆ k
j=0

almost everywhere and in L1 , where I = {B âˆˆ B : T âˆ’1 (B) = B}.
2.2. Conditional measures. Here we give a brief introduction to Rohlinâ€™s theory
of Lebesgue spaces, measurable partitions and conditional measures. The reader is
referred to [65, 56, 20] for more details.
A probability space (X, B, m) is called a Lebesgue space if it is isomorphic (mod 0)
to a probability space which is the union of [0, s] for some s âˆˆ [0, 1] with Lebesgue
measure and a finite or countable number of atoms. Now let (X, B, m) be a Lebesgue
space. A measurable partition Î· of X is a partition of X such that, up to a set
of measure zero, the quotient space X/Î· is separated by a countable number of

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

13

measurable sets {Bi }. The quotient space X/Î· with its inherited probability space
structure, written as (XÎ· , BÎ· , mÎ· ), is again a Lebesgue space. Also, any measurable
partition Î· determines a sub-Ïƒ-algebra of B, denoted by Î·b, whose elements are unions
of elements of Î·. Conversely, any sub-Ïƒ-algebra Bâ€² of B is also countably generated,
say by {Biâ€² }, and therefore all the sets of the form âˆ©Ai , where Ai = Biâ€² or its
complement, form a measurable partition. In particular, B itself is corresponding
to a partition into single points. An important property of Lebesgue spaces and
measurable partitions is the following.
Theorem 2.4 (Rohlin [65]). Let Î· be a measurable partition of a Lebesgue space
(X, B, m). Then, for every x in a set of full m-measure, there is a probability measure
mÎ·x defined on Î·(x), the element of Î· containing x. These measures are uniquely
characterized (up to sets of m-measure 0) by the following properties:
R if A âŠ‚ X is
a measurable set, then x 7â†’ mÎ·x (A) is Î·b-measurable and m(A) = mÎ·x (A)dm(x).
1
Î·
These properties imply
Î·)(x) for mR that for any f âˆˆ L (X, B, m), mx (f ) = Em (f |b
a.e. x, and m(f ) = Em (f |b
Î·)dm.
The family of measures {mÎ·x } in the above theorem is called the canonical system
of conditional measures associated with Î·.

Throughout the remaining part of this subsection, we assume that (X, B, m) is a
Lebesgue space. Suppose that Y is a complete separable metric space and Ï€ : X â†’ Y
is a B-measurable map. Let B(Y ) denote the Borel-Ïƒ-algebra on Y .
According to Rohlinâ€™s theory (cf. [65, Section 2.5], [56, Chapter IV]), the mapping
Ï€ induces a measurable partition
Î¾ = {Ï€ âˆ’1 (y) : y âˆˆ Y }

(2.2)

of X with Î¾b = Ï€ âˆ’1 B(Y ) (mod 0), and (XÎ¾ , BÎ¾ , mÎ¾ ) is isomorphic (mod 0) to (Y, B(Y ), Ï€âˆ— m).
The system of conditional measures {mÎ¾x } is also called the disintegration of m with
respect to Ï€.
For y âˆˆ Y , we use B(y, r) to denote the closed ball in Y of radius r centered at
y. Moreover we write for x âˆˆ X,
B Ï€ (x, r) = Ï€ âˆ’1 B(Ï€x, r).

(2.3)

Furthermore, we say that Y is a Besicovitch space if Y is a complete separable
metric space and the Besicovich covering lemma (see e.g. [50]) holds in Y . Besicovich spaces include, for instance, Euclidean spaces, compact finite-dimensional
Riemannian manifolds and complete separable ultrametric spaces.
Lemma 2.5. Let Ï€ : X â†’ Y be a measurable mapping from a Lebesgue space
(X, B, m) to a Besicovitch space Y . Let Î· be a measurable partition of X. Then the
following properties hold.
(1) Let A âˆˆ B. Then for m-a.e. x âˆˆ X,
mÎ·x (B Ï€ (x, r) âˆ© A)
= Em (Ï‡A |Î·Ì‚ âˆ¨ Ï€ âˆ’1 B(Y ))(x).
Î·
Ï€
râ†’0
mx (B (x, r))
lim

14

DE-JUN FENG

(2) Let Î± be a finite or countable measurable partition of X. Then for m-a.e. x âˆˆ
X,

mÎ· (B Ï€ (x, r) âˆ© Î±(x))
= âˆ’Im Î±|Î·Ì‚ âˆ¨ Ï€ âˆ’1 B(Y ) (x).
lim log x Î· Ï€
râ†’0
mx (B (x, r))
Furthermore, set

mÎ·x (B Ï€ (x, r) âˆ© Î±(x))
g(x) = âˆ’ inf log
r>0
mÎ·x (B Ï€ (x, r))
and assume Hm (Î±) < âˆ. Then g â‰¥ 0 and g âˆˆ L1 (X, B, m).
Proof. These properties have been proved in [29, Lemma 3.3, Proposition 3.5] in the
case when Y = Rd . The proofs there remain valid for the general case when Y is a
Besicovitch space.

Ë†
Remark 2.6. In the above lemma,
wehave Em (Ï‡A |Î·Ì‚ âˆ¨ Ï€ âˆ’1 B(Y )) = Em (Ï‡A |Î·Ì‚ âˆ¨ Î¾)

and Im (Î±|Î·Ì‚ âˆ¨ Ï€ âˆ’1 B(Y )) = Im Î±|Î·Ì‚ âˆ¨ Î¾Ë† m-a.e., where Î¾ is given by (2.2). This is
because Î¾b = Ï€ âˆ’1 B(Y ) (mod 0).
Definition 2.7. Two probability measures m1 and m2 on a measurable space (X, B)
are said to be strongly equivalent if there exists a positive constant C such that
C âˆ’1 m1 (A) â‰¤ m2 (A) â‰¤ Cm1 (A) for all A âˆˆ B.

Lemma 2.8. Let Ï€ : X â†’ Y be a measurable mapping from a Lebesgue space
(X, B, m1 ) to a Besicovitch space Y . Let Î¾ be the measurable partition of X given
in (2.2). Suppose m2 is another probability measure on (X, B) strongly equivalent
to m1 . Then for m1 -a.e. x, (m1 )Î¾x and (m2 )Î¾x are strongly equivalent.
Proof. It is a direct consequence of the following standard result (see, e.g. [47,
Proposition 6.1]): Let Î± be a measurable partition of a Lebesgue space (X, B, m)
and Î½ another probability measure on B which is absolutely continuous with respect
to m. Then for Î½-a.e.x, the conditional measure Î½xÎ± is absolutely continuous with
respect to mÎ±x on Î±(x) and
g|Î±(x)
dÎ½xÎ±
=R
,
Î±
dmx
g dmÎ±x
Î±(x)

where g := dÎ½/dm.



Lemma 2.9. Let Ï€ : X â†’ Y be a measurable mapping from a Lebesgue space
(X, B, m) to a Besicovitch space Y . Let Î¾ be the measurable partition of X given in
(2.2). Suppose A âˆˆ B with m(A) > 0 and let mA be the probability measure given
by mA (E) = m(A âˆ© E)/m(A) for E âˆˆ B. Then for m-a.e. x âˆˆ A, (mA )Î¾x = (mÎ¾x )A ,
that is,
mÎ¾x (A âˆ© E)
Î¾
for all E âˆˆ B.
(mA )x (E) =
mÎ¾x (A)
Proof. Again it is a direct consequence of [47, Proposition 6.1].



DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

15

2.3. Induced transformations. Let (X, B, m, T ) be an invertible measure-preserving
system. Fix N âˆˆ N and F âˆˆ B with m(F ) > 0. By the PoincareÌ recurrence theorem,
the first return map to F associated with T N , defined by
rF (x) = inf{n â‰¥ 1 : T N n (x) âˆˆ F },
exists almost everywhere. The map TF : F â†’ F defined almost everywhere by
TF (x) = T N rF (x) (x)
is called the transformation induced by T N on the set F .
For n â‰¥ 1, set Fn = {x âˆˆ F : rF (x) = n}. Write
B|F := {B âˆ© F : B âˆˆ B},

mF :=

1
m|F ,
m(F )

where m|F stands for the restriction of m on F , that is, m|F (B) = m(B âˆ© F )
for B âˆˆ B. The following result is well-known (see e.g. [20, pp. 61-63] and [60,
pp. 257-258] for a proof).
Lemma 2.10.
(i) The induced transformation TF is a measure-preserving transformation on the space (F, B|F , mF ).
(ii) The family of sets {T N j Fn }nâ‰¥1, 0â‰¤jâ‰¤nâˆ’1 are disjoint, and hence
âˆ
X

n m(Fn ) â‰¤ 1.1

n=1

(iii) âˆ’

âˆ
X

m(Fn ) log m(Fn ) < âˆ.

n=1

Set I = {B âˆˆ B : T âˆ’1 (B) = B} and IF := {B âˆˆ B|F : (TF )âˆ’1 (B) = B}. Recall
that N is a fixed positive integer and rF is the first return map to F with respect
to T N . The following result will be needed in the proof of Theorem 1.2.
P rF (x)âˆ’1
Lemma 2.11. Let g âˆˆ L1 (X, B, m). Set G(x) = N
g(T j x) for x âˆˆ F . Then
j=0
G âˆˆ L1 (F, B|F , mF ). Moreover,
(2.4)

NEm (g|I)(x) =

EmF (G|IF )(x)
EmF (rF |IF )(x)

for m-a.e. x âˆˆ F .
1This

is actually an equality in the ergodic case, but since we consider also non-ergodic measures,
there is only an inequality.

16

DE-JUN FENG

Proof. First notice that
Z

F

âˆ

1 X
|G| dmF =
m(F ) n=1

Z

|G| dm
Fn

âˆ N nâˆ’1 Z
1 X X
â‰¤
|g â—¦ T p | dm
m(F ) n=1 p=0 Fn

âˆ N nâˆ’1 Z
1 X X
|g| dm (since T is invertible and preserves m)
=
m(F ) n=1 p=0 T p Fn
âˆ N âˆ’1 nâˆ’1

1 XXX
=
m(F ) n=1 k=0 j=0

Z

|g| dm

T Nj+k Fn

N âˆ’1 âˆ nâˆ’1 Z
1 X XX
=
|g| dm
m(F ) k=0 n=1 j=0 T Nj+k Fn
Z
N
â‰¤
|g| dm,
m(F ) X

where in the last inequality we have used the fact that for any k, the sets in the
collection {T N j+k Fn : n âˆˆ N, 0 â‰¤ j â‰¤ n âˆ’ 1} are disjoint (see Lemma 2.10(ii)).
Hence G âˆˆ L1 (mF ). Below we prove (2.4).
Consider the sequence of integer-valued functions (nk (x))âˆ
k=0 , which are defined
on F almost everywhere by n0 (x) = 0, and
nk (x) =

kâˆ’1
X

rF (TFj x)

for k â‰¥ 1,

j=0

where TFj := (TF )j . Clearly, nk (x) â‰¥ k and TFk (x) = T N nk (x) (x). Hence,
kâˆ’1
X

j

G(TFj x) =

j=0

(TF x)âˆ’1
kâˆ’1 N rF X
X

g(T p(TFj x))

p=0

j=0

j

=

(TF x)âˆ’1
kâˆ’1 N rF X
X
p=0

j=0

=

(x)âˆ’1
kâˆ’1 N nj+1
X
X
j=0

g(T N nj (x)+p x)

g(T â„“ x)

â„“=N nj (x)

N nk (x)âˆ’1

=

X
i=0

g(T i x).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

17

By the Birkhoff ergodic theorem, we have
kâˆ’1

(2.5)

1
1 X
G(TFj x) = lim
lim
kâ†’+âˆ nk (x)
kâ†’+âˆ nk (x)
j=0

N nk (x)âˆ’1

= NEm (g|I)(x)

X

g(T i x)

i=0

for m-a.e. x âˆˆ F . Applying the Birkhoff ergodic theorem again, we have
kâˆ’1

1X
G(TFj x) = EmF (G|IF )(x)
lim
kâ†’+âˆ k
j=0

and

kâˆ’1

nk (x)
1X
rF (TFj x) = EmF (rF |IF )(x)
= lim
kâ†’+âˆ
kâ†’+âˆ k
k
j=0
lim

for m-a.e. x âˆˆ F . Here we have used the fact that rF âˆˆ L1 (F, B|F , mF ), which
follows directly from Lemma 2.10(ii). Taking quotient we get
kâˆ’1

1 X
G(TFj x) = EmF (G|IF )(x)/EmF (rF |IF )(x)
kâ†’+âˆ nk (x)
j=0
lim

for m-a.e. x âˆˆ F . Combining this with (2.5) yields (2.4).



2.4. Oseledetsâ€™ multiplicative ergodic theorem. For x, y âˆˆ Rd \{0}, let âˆ¡(x, y)
denote the angle between the lines â„“x and â„“y , where â„“x stands for the line in Rd
passing through the origin and x. In such definition, we always have âˆ¡(x, y) âˆˆ
[0, Ï€/2] and
(kxk2 kyk2 âˆ’ hx, yi2)1/2
,
sin âˆ¡(x, y) =
kxkkyk
where hÂ·, Â·i is the standard inner product in Rd . Similarly the angle between linear
subspaces U, V of Rd with U âˆ© V = {0} is defined by
sin âˆ¡(U, V ) =

inf

xâˆˆU \{0}, yâˆˆV \{0}

sin âˆ¡(x, y).

We will require the following version of Oseledetsâ€™ multiplicative ergodic theorem,
due to Froyland et al. [33, Theorem 4.1]:
Theorem 2.12. Let T be an invertible measure-preserving transformation of the
Lebesgue space (X, B, m). Let M : X â†’ Matd (R) be a measurable function such
that
Z
log+ kM(x)k dm(x) < âˆ.

Then there exists a measurable set X â€² âŠ† X with T (X â€² ) = X â€² and m(X â€² ) = 1,
such that for each x âˆˆ X â€² , there are positive integers s(x), k1 (x), . . . , ks(x)(x) with
k1 (x) + Â· Â· Â· + ks(x) (x) = d, numbers Î»1 (x) > Â· Â· Â· > Î»s(x) (x) â‰¥ âˆ’âˆ and a splitting
s(x)
Rd = Ex1 âŠ• Â· Â· Â· âŠ• Ex so that the following hold.
(i) dim Exi = ki (x).
(ii) M(x)Exi âŠ† ETi x (with equality if Î»i (x) > âˆ’âˆ).

18

DE-JUN FENG

(iii) For 1 â‰¤ i â‰¤ s(x) and v âˆˆ Exi \{0},
1
lim log kM(T nâˆ’1 x) Â· Â· Â· M(x)vk = Î»i (x),
nâ†’âˆ n
with uniform convergence on any compact subset of Exi \{0}.
(iv) For 1 â‰¤ i â‰¤ s(x),
1
max
log kM(T âˆ’1 x) Â· Â· Â· M(T âˆ’n x)vk
lim
nâ†’âˆ n vâˆˆE i
, kv||=1
T âˆ’n x
1
min
log kM(T âˆ’1 x) Â· Â· Â· M(T âˆ’n x)vk = Î»i (x).
nâ†’âˆ n vâˆˆE i
,
kv||=1
T âˆ’n x

= lim

1
log âˆ¡(âŠ•iâˆˆI ETi n x , âŠ•jâˆˆJ ETj n x ) = 0 whenever I âˆ© J = âˆ…,
n
(vi) The function s : X â€² â†’ N is measurable and T -invariant.
(vii) The mappings x 7â†’ Î»i (x), Exi , ki (x) are measurable on {x : s(x) â‰¥ i}, and
Î»i (T x) = Î»i (x), ki (T x) = ki (x).
(v) lim

nâ†’Â±âˆ

Remark 2.13.
(1) Theorem 2.12 is only stated in [33] for the case when m is ergodic. It extends directly to the general case by using ergodic decomposition.
When M(x) is invertible for all x this is the classic Oseledetsâ€™ multiplicative
ergodic theorem, but we emphasize that the above is valid even in the noninvertible case (in which case the usual statements of Oseledetsâ€™ theorem
only provide a flag and not a splitting).
(2) The uniform convergence in part (iii) of Theorem 2.12 is not stated in [33].
However it is well-known when A takes values in GL(R, d), and the argument
works also in the general case of Matd (R)-valued cocycles. See e.g. [31,
p. 1111] for a sketched proof. Part (iv) of Theorem 2.12 was only implicitly
included in the proof of [33, Theorem 4.1].
(3) The numbers Î»1 (x), . . . , Î»s(x) (x) are called the Lyapunov exponents of M at
x with respect to m. The number ki (x) is called the multiplicity of Î»i (x).
Moreover, {(Î»i (x), ki (x))}1â‰¤iâ‰¤s(x) is called the Lyapunov spectrum of (M, m)
over X â€² .
L
d
i
i
(4) The decomposition s(x)
i=1 Ex is called the Oseledets splitting of R , and Ex ,
1 â‰¤ i â‰¤ s(x), are called the Oseledets subspaces.
3. Canonical coding maps for average contracting affine IFSs
For z â‰¥ 0, write log+ z = max{0, log z} and logâˆ’ z = max{0, âˆ’ log z}, with the
convention log 0 = âˆ’âˆ. In this section, we prove the following proposition, which
will be used in the proof of our main result.
Proposition 3.1. Let S = {Sj (x) = Mj x + aj }jâˆˆÎ› be an affine IFS on Rd and m âˆˆ
MÏƒ (Î£). Suppose that S is average contracting with respect to m. Let Ï€ : Î£ â†’ Rd be
given by (1.2). Then there exists a Borel set E âŠ‚ Î£ with Ïƒ(E) = E and m(E) = 1
such that for any x = (xn )âˆ
n=âˆ’âˆ âˆˆ E,

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

19

(i) Ï€(x) is well-defined, i.e. the limit in defining Ï€(x) in (1.2) exists and is finite.
(ii) Sx0 (Ï€Ïƒx) = Ï€(x).
(iii) limnâ†’âˆ n1 log+ kÏ€(Ïƒ n x)k = 0.
Part (i) of the above proposition was first proved by Brandt [16] in the special
case when m is a Bernoulli product measure, and it was then extended by Bougerol
and Picard [14] to the general case when m is ergodic. For the convenience of the
reader, we shall provide a self-contained proof of part (i).
Before proving Proposition 3.1, we shall first prove the following auxiliary result,
which is a variant of Proposition 2.1 in [30].
Proposition 3.2. Let T : X â†’ X be an ergodic measure-preserving transformation on a probability space (X, B, m). Let {fn }âˆ
n=1 be a sequence of non-negative
+
measurable functions on X such that log f1 âˆˆ L1 (m) and
fn+k (x) â‰¤ fn (x)fk (T n x)
R
for all n, k âˆˆ N and x âˆˆ X. Set Î» = limnâ†’âˆ (1/n) log fn dm. Then for any Ç« > 0,
the following properties hold:
(3.1)

(i) If Î» 6= âˆ’âˆ, then for m-a.e. x âˆˆ X, there exists a positive integer n0 (x) such
that

(3.2)

| log fn (T k x) âˆ’ nÎ»| â‰¤ (n + k)Ç«

for all n â‰¥ n0 (x) and k â‰¥ 0.
(ii) If Î» = âˆ’âˆ, then for any N > 0 and m-a.e. x âˆˆ X, there exists a positive
integer n0 (x) such that
(3.3)

log fn (T k x) â‰¤ âˆ’Nn + (n + k)Ç«
for all n â‰¥ n0 (x) and k â‰¥ 0.

Proof.
the arguments of [30, Proposition 2.1]. By sub-additivity,
R Here we modify
R
+
Î» â‰¤ log f1 dm â‰¤ log f1 dm < âˆ. Below we first prove (i).

Assume that Î» 6= âˆ’âˆ. We first prove that log fj âˆˆ L1 (m) for each j âˆˆ N. To see
this, observe that by (3.1),
+

log fj â‰¤

jâˆ’1
X

log+ (f1 â—¦ T k ) âˆˆ L1 (m).

k=0

It remains to show that logâˆ’ fj âˆˆ L1 (m). Suppose this is not true, then
Z
Z
log fj dm = log+ fj âˆ’ logâˆ’ fj dm = âˆ’âˆ,

so by the sub-additivity of {fn },

1
Î» = inf
k k

Z

log fk dm = âˆ’âˆ,

leading to a contradiction. This proves that log fj âˆˆ L1 (m) for each j.

20

DE-JUN FENG

Next let Ç« > 0 and take 0 < Î´ < Ç«/6. By the Kingmanâ€™s sub-additive ergodic
theorem, for m-a.e. x âˆˆ X there exists n1 (x) such that
| log fn (x) âˆ’ nÎ»| â‰¤ nÎ´

for all n â‰¥ n1 (x).

Setting n2 (x) := max1â‰¤jâ‰¤n1 (x) | log fj (x) âˆ’ jÎ»|/Î´, we see that n2 (x) < âˆ a.e. and
| log fk (x) âˆ’ kÎ»| â‰¤ (n2 (x) + k)Î´

(3.4)

for all k âˆˆ N.

Hence by (3.1) and (3.4), for every n â‰¥ n2 (x) and k â‰¥ 0 we have
log fn (T k x) â‰¥ log fn+k (x) âˆ’ log fk (x)



â‰¥ (n + k)Î» âˆ’ (n2 (x) + n + k)Î´ âˆ’ kÎ» + (n2 (x) + k)Î´

(3.5)

= nÎ» âˆ’ (2n2 (x) + n + 2k)Î´
â‰¥ nÎ» âˆ’ (n + k)Ç«.

To see the opposite inequality, take â„“ large enough such that |Î² âˆ’ Î»| < Î´, where
Z
1
log fâ„“ dm.
Î² :=
â„“

Applying the Birkhoff ergodic theorem to the integrable functions log fj (j = 1, . . . , 2â„“),
we obtain
1
(3.6)
lim log fj (T p x) = 0 for 1 â‰¤ j â‰¤ 2â„“ and m-a.e. x.
pâ†’âˆ p
Let n â‰¥ 2â„“ and x âˆˆ X. Write n = qâ„“ + s with â„“ â‰¤ s â‰¤ 2â„“ âˆ’ 1. By submultiplicativity, we have
!
qâˆ’1
Y
fn (x) â‰¤ fj (x)
fâ„“ (T pâ„“+j x) fsâˆ’j (T qâ„“+j x), j = 0, 1, . . . , â„“ âˆ’ 1,
p=0

where we take the convention that f0 â‰¡ 1. Taking product of these inequalities
yields
! qâ„“âˆ’1
! â„“âˆ’1
!
â„“âˆ’1
Y
Y
Y
(fn (x))â„“ â‰¤
fj (x)
fâ„“ (T p x)
fsâˆ’j (T qâ„“+j x) ,
p=0

j=0

j=0

so for k â‰¥ 0,

(fn (T k x))â„“ â‰¤

â„“âˆ’1
Y
j=0

fj (T k x)

!

qâ„“+kâˆ’1

Y

p=k

fâ„“ (T p x)

!

â„“âˆ’1
Y
j=0

!

fsâˆ’j (T qâ„“+k+j x) .

Taking logarithm and dividing both sides by â„“ we have
!
!
kâˆ’1
n+kâˆ’sâˆ’1
X
X 1
1
log fâ„“ (T i x) âˆ’
log fâ„“ (T i x) + Î›1 + Î›2 ,
(3.7) log(fn (T k x)) â‰¤
â„“
â„“
i=0
i=0
Pâ„“âˆ’1 1
Pâ„“âˆ’1 1
log fj (T k x), Î›2 := j=0
log fsâˆ’j (T qâ„“+k+j x).
where Î›1 := j=0
â„“
â„“

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

21

Similar to (3.4), by using the Birkhoff ergodic theorem and (3.6), we see that
for m-a.e. x there exists n3 (x) such that for every n â‰¥ n3 (x) and every k â‰¥ 0 and
1 â‰¤ j â‰¤ 2â„“,
n+kâˆ’sâˆ’1
X
i=0

kâˆ’1
X
i=0

1
log fâ„“ (T i x) âˆ’ (n + k âˆ’ s)Î² â‰¤ (n + k âˆ’ s)Î´,
â„“

1
log fâ„“ (T i x) âˆ’ kÎ² â‰¤ (n3 (x) + k)Î´,
â„“

| log fj (T k x)| â‰¤ (n3 (x) + k)Î´,
where the third inequality implies that Î›1 â‰¤ (n3 (x) + k)Î´ and
Î›2 â‰¤ (n3 (x) + qâ„“ + k + â„“ âˆ’ 1)Î´ â‰¤ (n3 (x) + n + k)Î´.
Applying the above inequalities to (3.7), we see that for m-a.e. x âˆˆ X, for every
n â‰¥ n3 (x) and every k â‰¥ 0,
log fn (T k x) â‰¤ (n + k âˆ’ s)(Î² + Î´) âˆ’ (kÎ² âˆ’ (n3 (x) + k)Î´) + (n3 (x) + k)Î´
+ (n3 (x) + n + k)Î´
= (n âˆ’ s)Î² + (2n + 4k + 3n3 (x) âˆ’ s)Î´
â‰¤ nÎ» + (n + k)Ç«.
From this and (3.5) we see that (3.2) holds for every n â‰¥ n0 (x) := max{n2 (x), n3 (x)}
and every k â‰¥ 0. This prove (i).
To see (ii), suppose Î» = âˆ’âˆ. By the Kingmanâ€™s sub-additive ergodic theorem,
limnâ†’âˆ (1/n) log fn (x) = âˆ’âˆ for m-a.e. x. Fix N and define
fËœn (x) = max{fn (x), eâˆ’nN } for n âˆˆ N, x âˆˆ X.
Then limnâ†’âˆ (1/n) log fËœn (x) = âˆ’N for m-a.e. x. Meanwhile it is direct to check
Ëœ
that {fËœn }âˆ
n=1 is sub-multiplicative (i.e., (3.1) holds for {fn }), so by the Kingmanâ€™s
sub-additive ergodic theorem,
Z
lim (1/n) log fËœn dm = âˆ’N.
nâ†’âˆ

Applying (i) to {fËœn }âˆ
n=1 yields that for m-a.e. x âˆˆ X, there exists a positive integer
n0 (x) such that
log fn (T k x) â‰¤ log fËœn (T k x) â‰¤ âˆ’Nn + (n + k)Ç«
for all n â‰¥ n0 (x) and k â‰¥ 0. This completes the proof of the proposition.



As a direct corollary of Proposition 3.2, we have the following.
Corollary 3.3. Under the assumptions of Proposition 3.2, for any Ç«, N > 0 and for
m-a.e. x âˆˆ X, there exists c(x) > 0 such that
|fn (T k x)| â‰¤ c(x) exp(n max{Î», âˆ’N}) exp((n + k)Ç«)
for all n â‰¥ 1 and k â‰¥ 0.

22

DE-JUN FENG

Proof of Proposition 3.1. Without loss of generality we may assume that m is ergodic, since the general case can be proved by considering the ergodic decomposition
of m.
Set fn (x) = kMx0 Â· Â· Â· Mxnâˆ’1 k for x âˆˆ Î£ and n â‰¥ 1. Let f0 (x) â‰¡ 1 for convention.
Since S is average contracting with respect to m, we have
Z
1
log fn dm =: Î» < 0.
lim
nâ†’âˆ n
Let 0 < Ç« < âˆ’Î»/3. Applying Corollary 3.3 to {fn } and the shift map Ïƒ : Î£ â†’ Î£
(in which we take N = 2Ç«), we see that for m-a.e. x, there exists c(x) > 0 such that
fn (Ïƒ k x) â‰¤ c(x)eâˆ’2nÇ« e(n+k)Ç«
for any n â‰¥ 1 and k â‰¥ 0. It follows that for m-a.e. x,
âˆ
âˆ
X
X
kMxk Â· Â· Â· Mxk+nâˆ’1 axk+n k â‰¤ (max kai k)
fn (Ïƒ k x)
i

n=0

n=0

â‰¤ (max kai k)c(x)
i

âˆ
X

eâˆ’2nÇ« e(n+k)Ç«

n=0

= (max kai k)c(x)(1 âˆ’ eâˆ’Ç« )âˆ’1 ekÇ«
i

for all k â‰¥ 0. It follows that for m-a.e. x, Ï€(Ïƒ k x) is well-defined and kÏ€(Ïƒ k x)k â‰¤
(maxi kai k)c(x)(1 âˆ’ eâˆ’Ç« )âˆ’1 ekÇ« for all k â‰¥ 0. That is enough to conclude the proposition.

4. Measurable partitions associated with affine IFSs
Let S = {Mj x + aj }jâˆˆÎ› be an affine IFS on Rd and m âˆˆ MÏƒ (Î£). Suppose that
S is average contracting with respect to m. In this section, under an additional
assumption formulated later in (4.7), we construct a finite family of measurable
partitions of Î£ and give some properties of these partitions and the corresponding
conditional measures of m.
Define M : Î£ â†’ Matd (R) by
M(x) = Mxâˆ’1 ,

x = (xn )âˆ
n=âˆ’âˆ .

Applying Theorem 2.12 to the measure-preserving system (Î£, Ïƒ âˆ’1 , m) and the
matrix cocycle M, we get a measurable Î£â€² âŠ‚ Î£ with Ïƒ(Î£â€² ) = Î£â€² and m(Î£â€² ) = 1, so
that the Lyapunov spectrum
{(Î»i (x), ki (x))}1â‰¤iâ‰¤s(x)
and the Oseledets splitting
Rd = Ex1 âŠ• Â· Â· Â· âŠ• Exs(x)
are well-defined for x âˆˆ Î£â€² (cf. Remark 2.13). In this case, for any x âˆˆ Î£â€² and
1 â‰¤ i â‰¤ s(x),

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

23

1
log kMxâˆ’n Â· Â· Â· Mxâˆ’1 vk = Î»i (x) for v âˆˆ Exi \{0},
n
with uniform convergence on any compact subset of Exi \{0},
1
lim
max
log kMx0 Â· Â· Â· Mxnâˆ’1 vk
nâ†’âˆ n vâˆˆE i n , kv||=1
Ïƒ x
(4.2)
1
= lim
min
log kMx0 Â· Â· Â· Mxnâˆ’1 vk = Î»i (x),
nâ†’âˆ n vâˆˆE i n , kv||=1
Ïƒ x
(4.1)

lim

nâ†’âˆ

and
(4.3)

lim sup
nâ†’âˆ

1
max
log kMx0 Â· Â· Â· Mxnâˆ’1 vk â‰¤ Î»i (x).
s(x) j
n vâˆˆâŠ•j=i
EÏƒ n x , kv||=1

In addition, by Proposition 3.1 we may assume that the coding map Ï€ is welldefined on Î£â€² and that
1
(4.4)
lim log+ kÏ€(Ïƒ n x)k = 0 for x âˆˆ Î£â€² .
nâ†’âˆ n
Define for x âˆˆ Î£â€² ,
(4.5)

s(x)

Vxi := âŠ•j=i+1 Exj

for i = 0, . . . , s(x) âˆ’ 1,

and

Vxs(x) := {0}.

By (4.1), we have


1
i
d
(4.6)
Vx = v âˆˆ R : lim sup log kMxâˆ’n Â· Â· Â· Mxâˆ’1 vk â‰¤ Î»i+1 (x)
nâ†’âˆ n

for x âˆˆ Î£â€² , i = 0, . . . , s(x) âˆ’ 1.

âˆ’1
âˆ’
For x = (xj )âˆ
j=âˆ’âˆ âˆˆ Î£, we write x = (xj )j=âˆ’âˆ . The following simple fact is our
starting point in constructing measurable partitions of Î£â€² .

Lemma 4.1. Let x, y âˆˆ Î£â€² with xâˆ’ = y âˆ’ . Then s(x) = s(y) and Î»i (x) = Î»i (y) for
1 â‰¤ i â‰¤ s(x). Moreover, Vxi = Vyi for 0 â‰¤ i â‰¤ s(x).
Proof. For x âˆˆ Î£â€² and v âˆˆ Rd \ {0}, define
1
Î»(x, v) := lim log kMxâˆ’n Â· Â· Â· Mxâˆ’1 vk.
nâ†’âˆ n
By (4.1), the above limit always exists and takes values in {Î»i (x) : 1 â‰¤ i â‰¤ s(x)}.
Clearly Î»(x, v) only depends on v and xâˆ’ . Hence for x, y âˆˆ Î£â€² with xâˆ’ = y âˆ’ , we
have s(x) = s(y) and Î»i (x) = Î»i (y) for 1 â‰¤ i â‰¤ s(x); by (4.6) we also have Vxi = Vyi
for 1 â‰¤ i â‰¤ s(x). This completes the proof of the lemma.

In the remaining part of this section, we always make the following assumption:
(4.7)

s(x), k1 (x), . . . , ks(x) (x) are constant for m-a.e. x âˆˆ Î£â€² .

Here we donâ€™t make the stronger assumption that m is ergodic. Let us write these
constants as s, k1 , . . . , ks .

24

DE-JUN FENG

Below we construct a finite family of measurable partitions Î¾0 , . . . , Î¾s of Î£â€² .
â€²
Let Î¾0 be the partition of Î£â€² so that the Î¾0 -atom containing x = (xj )+âˆ
j=âˆ’âˆ âˆˆ Î£ is
given by
â€²
Î¾0 (x) = {y = (yj )âˆ
j=âˆ’âˆ âˆˆ Î£ : yj = xj for j â‰¤ âˆ’1}.

By Lemma 4.1, Vyi = Vxi for any y âˆˆ Î¾0 (x) and i âˆˆ {0, 1, . . . , s}.
Similarly, for i âˆˆ {1, . . . , s}, we define the partition Î¾i of Î£â€² by
i
Î¾i (x) = {y = (yj )âˆ
j=âˆ’âˆ âˆˆ Î¾0 (x) : Ï€y âˆ’ Ï€x âˆˆ Vx },

x âˆˆ Î£â€² .

Lemma 4.2. Î¾0 , . . . , Î¾s are measurable partitions of (Î£â€² , B(Î£â€² ), m).
Proof. By Rohlin theory (cf. [65, Section 2.5], [56, Chapter IV]), it is enough to
show that for every i âˆˆ {0, 1, . . . , s}, one can construct a measurable mapping Ï€i
from Î£â€² to a complete separable metric space Yi such that Î¾i is induced by Ï€i , in the
sense that Î¾i = {Ï€iâˆ’1 (y) : y âˆˆ Yi }. Below we construct such mappings Ï€i .
Let Î£âˆ’ := {(xn )âˆ’1
n=âˆ’âˆ : xn âˆˆ Î› for all n â‰¤ âˆ’1} and endow it with a suitable
metric compatible to the product topology. For j âˆˆ {0, . . . , d}, the set of all jdimensional affine subspaces in Rd forms a closed smooth manifold, which is called
the (d, j)-affine Grassmannian and is denoted by Graff(d, j).
Set Yi = Î£âˆ’ Ã— Graff(d, ki+1 + Â· Â· Â· + ks ) for i âˆˆ {0, . . . , s âˆ’ 1} and Ys = Î£âˆ’ Ã— Rd .
Define Ï€i : Î£â€² â†’ Yi (i = 0, 1, . . . , s) by
x 7â†’ (xâˆ’ , Vxi + Ï€x).
It is readily checked that for each i, Ï€i is measurable and Î¾i is induced by Ï€i .



Remark 4.3. The above construction of the measurable partitions Î¾0 , . . . , Î¾s is different from that built in the previous work of [29, 4]. In [29], the partitions were
made on the one-sided shift space due to the simple structure of Oseledets splitting
subspaces. In [4], the partitions were made on the product space of the self-affine set
and the flag manifolds.
Let P be the canonical partition of Î£â€² given in (1.4). For n âˆˆ N, set
P0nâˆ’1

=

nâˆ’1
_

Ïƒ âˆ’j P,

j=0

where âˆ¨ stands for the join of partitions (cf. [57]).
For convenience, write

(4.8)
Qn,Ç« := x âˆˆ Î£â€² : kÏ€Ïƒ j xk â‰¤ (1/2)ejÇ«/2 for all j â‰¥ n

for n âˆˆ N and Ç« > 0. Below we give several lemmas to further illustrate the properties
of Î¾i and the associated conditional measures.

Lemma 4.4.

(1) For x âˆˆ Î£â€² , i âˆˆ {0, . . . , s} and n âˆˆ N,
Î¾i (x) âˆ© P0nâˆ’1 (x) = Ïƒ âˆ’n (Î¾i (Ïƒ n x)).

As a consequence, Î¾i âˆ¨ P0nâˆ’1 = (Ïƒ âˆ’n Î¾i ) âˆ¨ P0nâˆ’1 = Ïƒ âˆ’n Î¾i .

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

25

(2) Let x âˆˆ Î£â€² and Ç« > 0. Then there exists n0 (x) such that for i âˆˆ {0, . . . , sâˆ’1},
 Ï€
B (x, en(Î»i+1 (x)+2Ç«) ) if Î»i+1 (x) 6= âˆ’âˆ
nâˆ’1
(4.9)
Qn,Ç« âˆ© Î¾i (x) âˆ© P0 (x) âŠ‚
B Ï€ (x, eâˆ’n/Ç« )
if Î»i+1 (x) = âˆ’âˆ
when n â‰¥ n0 (x), here B Ï€ (x, r) is defined as in (2.3). Moreover,
 Ï€
B (x, en(Î»1 (x)+2Ç«) ) if Î»1 (x) 6= âˆ’âˆ
nâˆ’1
(4.10)
Qn,Ç« âˆ© P0 (x) âŠ‚
B Ï€ (x, eâˆ’n/Ç« )
if Î»1 (x) = âˆ’âˆ
when n â‰¥ n0 (x).
â€²
Proof. We first prove (1). Let x = (xj )âˆ
j=âˆ’âˆ âˆˆ Î£ , i âˆˆ {0, . . . , s} and n âˆˆ N. We
nâˆ’1
only prove that Î¾i (x) âˆ© P0 (x) âŠ‚ Ïƒ âˆ’n (Î¾i (Ïƒ n x)). The proof of the other direction is
similar.
nâˆ’1
Let y = (yj )âˆ
(x). Then Ï€y âˆ’Ï€x âˆˆ Vxi and yj = xj for j â‰¤ nâˆ’1.
j=âˆ’âˆ âˆˆ Î¾i (x)âˆ©P0
By Proposition 3.1(ii),

Ï€y âˆ’ Ï€x = Sy0 ...ynâˆ’1 (Ï€Ïƒ n y) âˆ’ Sx0 ...xnâˆ’1 (Ï€Ïƒ n x)
= Sx0 ...xnâˆ’1 (Ï€Ïƒ n y) âˆ’ Sx0 ...xnâˆ’1 (Ï€Ïƒ n x)

(4.11)

= Mx0 ...xnâˆ’1 (Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x),
here and afterwards we write Mi1 ...in for Mi1 Â· Â· Â· Min . Since Ï€y âˆ’ Ï€x âˆˆ Vxi , by (4.11)
and (4.6) we have
1
log kMxâˆ’k ...xâˆ’1 x0 ...xnâˆ’1 (Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x)k
n
+
k
kâ†’âˆ
1
= lim sup
log kMxâˆ’k ...xâˆ’1 (Ï€y âˆ’ Ï€x)k â‰¤ Î»i+1 (x) = Î»i+1 (Ïƒ n x).
n
+
k
kâ†’âˆ

lim sup

Applying (4.6) to VÏƒin x gives Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x âˆˆ VÏƒin x . In the meantime, since yj = xj
for j â‰¤ n âˆ’ 1, we have also Ïƒ n y âˆˆ Î¾0 (Ïƒ n x). Therefore y âˆˆ Ïƒ âˆ’n (Î¾i (Ïƒ n x)). This proves
Î¾i (x) âˆ© P0nâˆ’1 (x) âŠ‚ Ïƒ âˆ’n (Î¾i (Ïƒ n x)).
Next we prove (2). Let x âˆˆ Î£â€² , i âˆˆ {0, . . . , s âˆ’ 1} and Ç« > 0. By (4.3) and (4.4),
there exists n0 = n0 (x) such that for any n â‰¥ n0 ,
 n(Î» (x)+Ç«)
e i+1
if Î»i+1 (x) 6= âˆ’âˆ
kMx0 ...xnâˆ’1 vk â‰¤
(4.12)
max
âˆ’2n/Ç«
e
if Î»i+1 (x) = âˆ’âˆ
vâˆˆVÏƒin x , kvk=1
and
(4.13)

1
kÏ€Ïƒ n xk â‰¤ enÇ«/2 .
2

26

DE-JUN FENG

Now let n â‰¥ n0 and y âˆˆ Qn,Ç« âˆ© Î¾i (x) âˆ© P0nâˆ’1 (x). Then kÏ€Ïƒ n yk â‰¤ (1/2)enÇ«/2, y âˆ’ = xâˆ’ ,
Ï€y âˆ’ Ï€x âˆˆ Vxi and furthermore by (1), Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x âˆˆ VÏƒin x . By (4.11)-(4.13),
kÏ€y âˆ’ Ï€xk = kMx0 ...xnâˆ’1 (Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x)k


â‰¤
max
kMx0 ...xnâˆ’1 vk kÏ€Ïƒ n y âˆ’ Ï€Ïƒ n xk
vâˆˆVÏƒin x , kvk=1

â‰¤



en(Î»i+1 (x)+2Ç«)
eâˆ’n/Ç«

if Î»i+1 (x) 6= âˆ’âˆ
.
if Î»i+1 (x) = âˆ’âˆ

This proves (4.9). Moreover, since Vx0 = Rd , the above argument for the case i = 0
actually proves (4.10).

Recall that for a measurable partition Î· of Î£â€² , {mÎ·x } stands for the canonical
system of conditional measures associated with Î· (cf. Section 2.2).
Lemma 4.5. Let i âˆˆ {0, 1, . . . , s}. Then for m-a.e. x âˆˆ Î£â€² , the following hold.
(1) mxÏƒ

âˆ’n Î¾
i

(A) = mÎ¾Ïƒin x (Ïƒ n A) for any n âˆˆ N and measurable A âŠ‚ Î£â€² .

(2) mxÏƒ

âˆ’n Î¾
i

(A) =

(3)

mÎ¾xi (A âˆ© P0nâˆ’1 (x))
mÎ¾xi (P0nâˆ’1 (x))

mÎ¾xi (Ïƒ âˆ’n A âˆ© P0nâˆ’1 (x))
Î£â€² .

mÎ¾Ïƒin x (A)

for any n âˆˆ N and measurable A âŠ‚ Î£â€² .

= mÎ¾xi (P0nâˆ’1 (x)) for any n âˆˆ N and measurable A âŠ‚

Proof. All the results follow from the Ïƒ-invariance of m and the uniqueness of conditional measures. For the readerâ€™s convenience, we include below the detailed arguments.
To see (1), fix n âˆˆ N and define a family of probability measures {Âµx }xâˆˆÎ£â€² such
that Âµx is supported on (Ïƒ âˆ’n Î¾i )(x) = Ïƒ âˆ’n (Î¾i (Ïƒ n x)) and satisfies
Âµx (A) = mÎ¾Ïƒin x (Ïƒ n A)

for any measurable A âŠ‚ Î£â€² .

Then by Theorem 2.4, for every measurable A âŠ‚ Î£â€² and m-a.e. x,
Âµx (A) = Em (Ï‡Ïƒn A |Î¾bi )(Ïƒ n x)

= Em (Ï‡Ïƒn A â—¦ Ïƒ n |Ïƒ âˆ’n Î¾bi )(x)
= Em (Ï‡A |Ïƒ âˆ’n Î¾bi )(x).

(by Lemma 2.1(i))

R
It follows that x 7â†’ Âµx (A) is Ïƒ âˆ’n Î¾bi -measurable and m(A) = Âµx (A)dm(x). Therefore, {Âµx } is a canonical system of conditional measures associated with Ïƒ âˆ’n Î¾i . By
âˆ’n
the uniqueness of conditional measures, we have Âµx = mÏƒx Î¾i for m-a.e. x. This
proves (1).
To see (2), let n âˆˆ N and notice that Ïƒ âˆ’n Î¾i = Î¾i âˆ¨ P0nâˆ’1 by Lemma 4.4(1). Similar
to the proof of (1), we define a family of probability measures {Î½x }xâˆˆÎ£â€² such that Î½x

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

27

is supported on (Ïƒ âˆ’n Î¾i )(x) = Î¾i (x) âˆ© P0nâˆ’1 (x) and satisfies
Î½x (A) =

mÎ¾xi (A âˆ© P0nâˆ’1 (x))
mÎ¾xi (P0nâˆ’1 (x))

for any measurable A âŠ‚ Î£â€² .

Then by Theorem 2.4, for every measurable A âŠ‚ Î£â€² and m-a.e. x,
X
Î½x (A) =
(4.14)
Ï‡B (x) Â· hB (x),
BâˆˆP0nâˆ’1

where hB := Em (Ï‡Aâˆ©B |Î¾bi )/Em(Ï‡B |Î¾bi ). Since hB is Î¾bi -measurable, the mapping x 7â†’
nâˆ’1
[
Î½x (A) is Î¾bi âˆ¨ P
-measurable (i.e. Ïƒ âˆ’n Î¾bi -measurable). Moreover by (4.14),
0
Z
X Z
Î½x (A) dm(x) =
Ï‡B hB dm
BâˆˆP0nâˆ’1

=

X Z

BâˆˆP0nâˆ’1

=

X Z

BâˆˆP0nâˆ’1

=

X Z

BâˆˆP0nâˆ’1

=

X

Em (Ï‡B hB |Î¾bi ) dm

Em (Ï‡B |Î¾bi )hB dm
Em (Ï‡Aâˆ©B |Î¾bi ) dm

m(A âˆ© B) = m(A).

BâˆˆP0nâˆ’1

Hence the family {Î½x } is a canonical system of conditional measures associated with
Ïƒ âˆ’n Î¾i , and so (2) follows by the uniqueness of conditional measures.
Finally we prove (3). By (1), we have
mÎ¾Ïƒin x (A) = mÎ¾Ïƒin x (Ïƒ n (Ïƒ âˆ’n A)) = mÏƒx

âˆ’n Î¾
i

(Ïƒ âˆ’n A).

Applying (2) to Ïƒ âˆ’n A (instead of A) yields that
mÎ¾Ïƒin x (A) = mÏƒx

âˆ’n Î¾
i

(Ïƒ âˆ’n A) =

mÎ¾xi (Ïƒ âˆ’n A âˆ© P0nâˆ’1 (x))
mÎ¾xi (P0nâˆ’1 (x))

which implies (3).

,


Now for i âˆˆ {0, 1, . . . , s}, define
(4.15)

hi (x) = Em (fi |I)(x),

x âˆˆ Î£â€² ,

where fi := Im (P|Î¾bi ) and I = {A âˆˆ B(Î£â€² ) : Ïƒ âˆ’1 A = A}. Clearly fi â‰¥ 0 a.e. By
Lemma 2.1(v), fi âˆˆ L1 . It follows that hi â‰¥ 0 a.e. and hi âˆˆ L1 .

28

DE-JUN FENG

Lemma 4.6. Let i âˆˆ {0, 1, . . . , s}. Then for m-a.e. x âˆˆ Î£â€² ,
log mÎ¾xi (P0nâˆ’1 (x)) = âˆ’
(4.16)

nâˆ’1
X
j=0

Im (P|Î¾bi )(Ïƒ j x)

and

1
log mÎ¾xi (P0nâˆ’1 (x)) = hi (x).
nâ†’âˆ n

âˆ’ lim
Furthermore,

1
log m(P0nâˆ’1 (x)) = h0 (x)
nâ†’âˆ n

âˆ’ lim

(4.17)

for m-a.e. x âˆˆ Î£â€² .

Proof. Let i âˆˆ {0, 1, . . . , s}. By Theorem 2.4,
X
X
log mÎ¾xi (P0nâˆ’1 (x)) =
Ï‡A (x) log mÎ¾xi (A) =
Ï‡A (x) log Em (Ï‡A |Î¾bi )(x)
AâˆˆP0nâˆ’1

AâˆˆP0nâˆ’1

and hence âˆ’ log mÎ¾xi (P0nâˆ’1 (x)) = Im (P0nâˆ’1 |Î¾bi )(x) for m-a.e. x. By Lemma 2.1,
!
nâˆ’1
_
Im (P nâˆ’1 |Î¾bi ) = Im (P|Î¾bi ) + Im
Ïƒ âˆ’j P Î¾bi âˆ¨ Pb
0

j=1

= Im (P|Î¾bi ) + Im

nâˆ’1
_
j=1

Ïƒ âˆ’j P Ïƒ âˆ’1 Î¾bi

= Im (P|Î¾bi ) + Im (P0nâˆ’2 |Î¾bi ) â—¦ Ïƒ

!

(by Lemma 4.4(1))
(by Lemma 2.1(ii)).

Therefore by induction we have
(4.18)

Im (P0nâˆ’1 |Î¾bi )

=

nâˆ’1
X
j=0

Im (P|Î¾bi ) â—¦ Ïƒ j .

Now (4.16) follows from (4.18) and the Birkhoff ergodic theorem.
To see (4.17), applying the Shannon-McMillian-Breiman theorem (see e.g. [57,
p. 39]) to the transformations Ïƒ and Ïƒ âˆ’1 respectively, we have the following convergences (pointwise and in L1 ):
1
log m(P0nâˆ’1 (x)) = Em (g1 |I)(x),
nâ†’+âˆ n
(4.19)
1
0
âˆ’ lim
log m(Pâˆ’(nâˆ’1)
(x)) = Em (g2 |I)(x),
nâ†’+âˆ n
Wâˆ j b
Wâˆ j b
W
âˆ’j b
b
where g1 := Im (P| âˆ
j=1 Ïƒ P,
j=1 Ïƒ P), g2 := Im (P| j=1 Ïƒ P). Noticing that Î¾0 =
we have g2 = Im (P|Î¾b0 ) = f0 and so Em (g2 |I) = h0 . To prove (4.17), by (4.19) it
suffices to show that
âˆ’ lim

(4.20)

Em (g1 |I)(x) = Em (g2 |I)(x)

for m-a.e. x.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

29

0
To see (4.20) first observe that for x âˆˆ Î£â€² , Pâˆ’(nâˆ’1)
(Ïƒ n x) = Ïƒ n (P0nâˆ’1 (x)) and hence
0
m(Pâˆ’(nâˆ’1)
(Ïƒ n x)) = m(Ïƒ n (P0nâˆ’1 (x))) = m(P0nâˆ’1 (x)). For any B âˆˆ I, we have
Z
0
log m(Pâˆ’(nâˆ’1)
(x)) dm(x)
B
Z
0
= Ï‡B (x) log m(Pâˆ’(nâˆ’1)
(x)) dm(x)
Z
0
= Ï‡B (Ïƒ n x) log m(Pâˆ’(nâˆ’1)
(Ïƒ n x)) dm(x)
(by the Ïƒ-invariance of m)
Z
= Ï‡B (Ïƒ n x) log m(P0nâˆ’1 (x)) dm(x)
Z
= Ï‡B (x) log m(P0nâˆ’1 (x)) dm(x)
(by Ï‡B = Ï‡B â—¦ Ïƒ n as B âˆˆ I)
Z
=
log m(P0nâˆ’1 (x)) dm(x).
B

Dividing both sides by n, letting n â†’ âˆ and applying (4.19), we have
Z
Z
Em (g1 |I) dm =
Em (g2 |I) dm for all B âˆˆ I.
B

B

Therefore Em (g1 |I) = Em (g2 |I) almost everywhere. This completes the proof of the
lemma.

Below we give an interesting corollary of Lemma 4.6, although we will not use it
in the rest part of the paper.
Corollary 4.7. Let i âˆˆ {0, 1, . . . , s}. Then hi = 0 a.e. if and only if mÎ¾xi = Î´x
(i.e. mÎ¾xi ({x}) = 1) for m-a.e. x âˆˆ Î£â€² .
Proof. By Lemma 2.1(v), fi := Im (P|Î¾bi ) â‰¥ 0 a.e. and fi âˆˆ L1 . Hence by (4.15),
hi = 0 a.e. if and only if fi = 0 a.e. However according to the first equality in (4.16),
the condition fi = 0 a.e. implies that for m-a.e. x, mÎ¾xi (P0nâˆ’1 (x)) = 1 for every n â‰¥ 1
and hence
mÎ¾xi ({x}) = mÎ¾xi (Î¾0 (x) âˆ© P0âˆ (x)) = mÎ¾xi (P0âˆ (x)) = 1,
using the fact that mÎ¾xi is supported on Î¾i (x) âŠ‚ Î¾0 (x). Conversely, by the first
equality in (4.16) (applied to n = 1), we obtain that fi (x) = âˆ’ log mÎ¾xi (P(x)); hence
the condition
mÎ¾xi ({x}) = 1 a.e.
implies that fi = 0 a.e. This completes the proof of the corollary.

We end the section by the following.
Lemma 4.8. Let Ç« > 0 and define Qn,Ç« as in (4.8) for n âˆˆ N. Then for ma.e. x âˆˆ Î£â€² ,
mÎ¾i (Qn,Ç« âˆ© P nâˆ’1 (x))
=1
(i = 0, 1, . . . , s)
lim x Î¾i nâˆ’10
nâ†’âˆ
mx (P0 (x))

30

DE-JUN FENG

and

m(Qn,Ç« âˆ© P0nâˆ’1 (x))
= 1.
nâ†’âˆ
m(P0nâˆ’1 (x))
lim

Proof. The equalities follow from the Lebesgue density lemma for Polish ultrametric
spaces (see, e.g. [53, Proposition 2.10]) and
Sthe facts that the sequence (Qn,Ç« ) of sets is
monotone increasing as n increases, and n Qn,Ç« is of full m-measure by Proposition
3.1(iii).

5. Transverse dimensions
In this section, we prove an inequality for the transverse dimensions of the conditional measures that we constructed in Section 4.
Recall that S is an affine IFS on Rd of the form (1.1), average contracting with
respect to some m âˆˆ MÏƒ (Î£). Let Ï€ be the associated coding map. Let M : Î£ â†’
Matd (R) be the matrix cocycle given by M(x) = Mxâˆ’1 , and {(Î»i (x), ki (x))}1â‰¤iâ‰¤s(x), xâˆˆÎ£â€²
the Lyapunov spectrum for M with respect to the transformation Ïƒ âˆ’1 . Suppose that
(4.7) holds, i.e. there exist s, k1 , . . . , ks so that s(x) = s, ki (x) = ki (i = 1, . . . , s) for
m-a.e. x âˆˆ Î£â€² . Let âŠ•si=1 Exi be the Oseledets splitting of Rd , and {0} = Vxs âŠ‚ Â· Â· Â· âŠ‚
Vx0 = Rd the associated filtration.
Let Î¾0 , Î¾1 , . . . , Î¾s be the measurable partitions of Î£â€² that we constructed in Section 4. For x âˆˆ Î£â€² and r > 0, set
(5.1)

Î“i (x, r) = {y âˆˆ Î£â€² : dist(Ï€y + Vxi , Ï€x + Vxi ) â‰¤ r},

and define

i = 1, . . . , s

Î¾

log mxiâˆ’1 (Î“i (x, r))
, i = 1, . . . , s.
râ†’0
log r
We call Ï‘0 ,. . . , Ï‘sâˆ’1 the transverse dimensions of m. Intuitively we may view Ï‘i (x)
as the dimension of m along the direction Exi+1 .
Ï‘iâˆ’1 (x) = lim inf

The main result of this section is the following, which plays a key role in the proof
of Theorem 1.2.
Proposition 5.1. For m-a.e. x âˆˆ Î£â€² ,
Ï‘iâˆ’1 (x) â‰¥

hi (x) âˆ’ hiâˆ’1 (x)
,
Î»i (x)

i = 1, . . . , s,

where hi are defined as in (4.15).
This result can be viewed as an analogue of Proposition 11.2 in [46]. A stronger
version of the result, with the inequality being replaced by the equality, was proved
earlier in [29, Theorem 6.2], [2, Theorem 3.3], and [4, Propositions 5.3 and 7.3] under
various additional assumptions.
The proof of Proposition 5.1 is quite long and delicate. Besides extending some
ideas from the previous works [46, 29, 4], we need to employ certain new strategy
as well.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

31

We first introduce some notation and give several lemmas.
For x âˆˆ Î£â€² , i âˆˆ {1, . . . , s} and r > 0, set
Bxi (r) = {v âˆˆ Exi : kvk â‰¤ r}
and
Ti (x, r) = {y âˆˆ Î¾iâˆ’1 (x) : Ï€y âˆ’ Ï€x âˆˆ Vxi âŠ• Bxi (r)}.
Lemma 5.2. Let x âˆˆ Î£â€² , i âˆˆ {1, . . . , s}, n âˆˆ N and r > 0. For
0â‰¤aâ‰¤

min

vâˆˆEÏƒi n x , kvk=1

kMx0 Â·Â·Â·xnâˆ’1 vk,

we have
Ti (x, ar) âˆ© P0nâˆ’1 (x) âŠ‚ Ïƒ âˆ’n Ti (Ïƒ n x, r).

(5.2)

Proof. Let y âˆˆ Ti (x, ar) âˆ© P0nâˆ’1 (x). By definition,
(5.3)

y âˆˆ Î¾iâˆ’1 (x) âˆ© P0nâˆ’1 (x)

(5.4)

Ï€y âˆ’ Ï€x âˆˆ Vxi âŠ• Bxi (ar).

and

By (5.3) and Lemma 4.4(1), y âˆˆ Ïƒ âˆ’n (Î¾iâˆ’1 (Ïƒ n x)). Moreover since y âˆˆ P0nâˆ’1 (x), by
(4.11),
Ï€y âˆ’ Ï€x = Mx0 ...xnâˆ’1 (Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x).

(5.5)

Since y âˆˆ Î¾iâˆ’1 (x), by definition Ï€y âˆ’ Ï€x âˆˆ Vxiâˆ’1 = Vxi âŠ• Exi . Applying (4.6) to Vxiâˆ’1
yields
1
lim sup log kMxâˆ’k ...xâˆ’1 (Ï€y âˆ’ Ï€x)k â‰¤ Î»i (x) = Î»i (Ïƒ n x),
kâ†’âˆ k
where the last equality follows from Theorem 2.12(vii). Hence by (5.5),
lim sup
kâ†’âˆ

1
log kMxâˆ’k ...xâˆ’1 x0 ...xnâˆ’1 (Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x)k â‰¤ Î»i (Ïƒ n x).
n+k

iâˆ’1
n
n
i
i
Applying (4.6) to VÏƒiâˆ’1
n x gives Ï€Ïƒ y âˆ’ Ï€Ïƒ x âˆˆ VÏƒ n x = VÏƒ n x âŠ• EÏƒ n x . Write

Ï€y âˆ’ Ï€x = v1 + w1
Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x = v2 + w2

with v1 âˆˆ Vxi and w1 âˆˆ Exi ,
with v2 âˆˆ VÏƒin x and w2 âˆˆ EÏƒi n x .

By (5.4), w1 âˆˆ Bxi (ar) and hence kw1 k â‰¤ ar. Since Mx0 Â·Â·Â·xnâˆ’1 VÏƒin x âŠ‚ Vxi and
Mx0 Â·Â·Â·xnâˆ’1 EÏƒi n x âŠ‚ Exi , by (5.5) we see that w1 = Mx0 ...xnâˆ’1 w2 and so
ar â‰¥ kw1 k = kMx0 ...xnâˆ’1 w2 k â‰¥ akw2 k.
It follows that kw2 k â‰¤ r. Hence Ï€Ïƒ n y âˆ’ Ï€Ïƒ n x âˆˆ VÏƒin x âŠ• BÏƒi n x (r). This together with
y âˆˆ Ïƒ âˆ’n (Î¾iâˆ’1 (Ïƒ n x)) yields that y âˆˆ Ïƒ âˆ’n Ti (Ïƒ n x, r). Therefore
Ti (x, ar) âˆ© P0nâˆ’1 (x) âŠ‚ Ïƒ âˆ’n Ti (Ïƒ n x, r)
and we are done.



32

DE-JUN FENG

Let Î¸(x) denote the smallest angle between the Oseledets subspaces, i.e.


Î¸(x) = min âˆ¡ âŠ•iâˆˆI Exi , âŠ•jâˆˆJ Exj .
Iâˆ©J=âˆ…

We have the following.

Lemma 5.3. For x âˆˆ Î£â€² , i âˆˆ {1, . . . , s} and r > 0,
Ti (x, r) âŠ‚ Î¾iâˆ’1 (x) âˆ© Î“i (x, r) âŠ‚ Ti (x, r/ sin Î¸(x)).
Proof. We first prove that Ti (x, r) âŠ‚ Î¾iâˆ’1 (x) âˆ© Î“i (x, r). Let y âˆˆ Ti (x, r). Then by
definition, y âˆˆ Î¾iâˆ’1 (x) and Ï€y âˆ’ Ï€x = v + w for some v âˆˆ Vxi , w âˆˆ Exi with kwk â‰¤ r,
which implies that
dist(Ï€y + Vxi , Ï€x + Vxi ) â‰¤ kwk â‰¤ r.
Hence y âˆˆ Î¾iâˆ’1 (x) âˆ© Î“i (x, r). This proves the relation Ti (x, r) âŠ‚ Î¾iâˆ’1 (x) âˆ© Î“i (x, r).
Next we prove that Î¾iâˆ’1(x) âˆ© Î“i (x, r) âŠ‚ Ti (x, r/ sin(Î¸(x))). Let Uxi := Vxiâˆ’1 âŠ– Vxi
denote the orthogonal complement of Vxi in Vxiâˆ’1 . Let z âˆˆ Î¾iâˆ’1 (x) âˆ© Î“i (x, r). Then
Ï€z âˆ’ Ï€x âˆˆ Vxiâˆ’1 and dist(Ï€z + Vxi , Ï€x + Vxi ) â‰¤ r. Hence Ï€z âˆ’ Ï€x = v + u for some
v âˆˆ Vxi and u âˆˆ Uxi with kuk â‰¤ r. Since v + u âˆˆ Vxiâˆ’1 = Vxi âŠ• Exi , v + u = v1 + w1 for
some v1 âˆˆ Vxi and w1 âˆˆ Exi . Notice that w1 = (v âˆ’ v1 ) + u with u âŠ¥ (v âˆ’ v1 ). We
have
kuk
r
kuk
â‰¤
â‰¤
.
kw1 k =
sin âˆ¡(w1 , v âˆ’ v1 )
sin Î¸(x)
sin Î¸(x)
Thus Ï€z âˆ’ Ï€x = v1 + w1 , where v1 âˆˆ Vxi and w1 âˆˆ Exi with kw1 k â‰¤ r/ sin Î¸(x).
Therefore, z âˆˆ Ti (x, r/ sin Î¸(x)) and we are done.

Now we turn back to the proof of Proposition 5.1. Clearly, to prove the proposition
it is sufficient to show that for any Ç« > 0, there exists F (Ç«) âŠ‚ Î£â€² so that
(5.6)

Ï‘iâˆ’1 (x) â‰¥

hiâˆ’1 (x) âˆ’ hi (x)
âˆ’Î»i (x) + Ç«

for m-a.e. x âˆˆ F (Ç«) and i âˆˆ {1, . . . , s}.

and limÇ«â†’0 m(F (Ç«)) = 1.
Here and afterwards in this section, we may assume that Î»s 6= âˆ’âˆ a.e., since
Proposition 5.1 holds automatically when i = s and Î»s (x) = âˆ’âˆ.
We first construct F (Ç«) for Ç« > 0. Set
(5.7)

F0 (Ç«) := {x âˆˆ Î£â€² : sin Î¸(x) > Ç«}.

By (4.2), there exist a large integer N(Ç«) and a Borel set F (Ç«) âŠ‚ F0 (Ç«) with
m(F (Ç«)) > (1 âˆ’ Ç«)m(F0 (Ç«)) so that for i âˆˆ {1, . . . , s},
(5.8)

kMx0 Â·Â·Â·xnâˆ’1 vk â‰¥ Ç«âˆ’1 en(Î»i (x)âˆ’Ç«) kvk

for x âˆˆ F (Ç«), n â‰¥ N(Ç«) and v âˆˆ EÏƒi n x . Clearly, m(F (Ç«)) â†’ 1 as Ç« â†’ 0.
In the remaining part of this section we prove (5.6) for the constructed F (Â·). From
now on, we fix Ç« > 0 and write simply F = F (Ç«) and N = N(Ç«).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

33

Let ÏƒF : F â†’ F be the transformation induced by Ïƒ N on the set F (cf. Section 2.3). That is, ÏƒF (x) = Ïƒ N rF (x) (x), where
rF (x) := inf{n â‰¥ 1 : Ïƒ nN x âˆˆ F }.
The map ÏƒF is well-defined on F up to a set of zero m-measure. Let mF be the
Borel probability measure on F defined by
mF (D) =

m(F âˆ© D)
m(F )

for any Borel set D âŠ‚ F.

Recall that mF is ÏƒF -invariant.
For x âˆˆ F , set
â„“(x) = NrF (x)

(5.9)

and

Ï(i, x) = eâ„“(x)(Î»i (x)âˆ’Ç«) ,

i = 1, . . . , s.

Then we have
Lemma 5.4. For x âˆˆ F , i âˆˆ {1, . . . , s} and r > 0,
(5.10)

â„“(x)âˆ’1

Î¾iâˆ’1 (x) âˆ© Î“i (x, Ï(i, x)r) âˆ© P0

(x) âŠ‚ Ïƒ âˆ’â„“(x) (Î“i (ÏƒF x, r) âˆ© Î¾iâˆ’1 (ÏƒF x)) .

Proof. Fix x âˆˆ F , i âˆˆ {1, . . . , s} and r > 0. Set a = Ç«âˆ’1 Ï(i, x). Since â„“(x) =
NrF (x) â‰¥ N, by (5.8),
a = Ç«âˆ’1 eâ„“(x)(Î»i (x)âˆ’Ç«) â‰¤ inf{kM â„“(x) (x)vk : v âˆˆ EÏƒi â„“(x) x , kvk = 1},

(5.11)

where M n (x) := Mx0 Â·Â·Â·xnâˆ’1 . Observe that
Î¾iâˆ’1 (x) âˆ© Î“i (x, Ï(i, x)r)
âŠ‚ Ti (x, Ï(i, x)r/ sin Î¸(x))
(by Lemma 5.3)

âˆ’1
âŠ‚ Ti x, Ç« Ï(i, x)r
(since sin Î¸(x) â‰¥ Ç«)
= Ti (x, ar) .

Hence
â„“(x)âˆ’1

Î¾iâˆ’1(x) âˆ© Î“i (x, Ï(i, x)r) âˆ© P0
âŠ‚ Ti (x, ar) âˆ©

(x)

â„“(x)âˆ’1
P0
(x)

âŠ‚ Ïƒ âˆ’â„“(x) Ti Ïƒ â„“(x) x, r
= Ïƒ âˆ’â„“(x) Ti (ÏƒF x, r)



(by (5.11) and Lemma 5.2)

âŠ‚ Ïƒ âˆ’â„“(x) (Î“i (ÏƒF x, r) âˆ© Î¾iâˆ’1 (ÏƒF x))

(by Lemma 5.3).

This completes the proof of the lemma.



Now write
(5.12)

Fn := {x âˆˆ F : rF (x) = n},

n = 1, 2, . . . .

Recall that {mÎ¾xi } is the canonical system of conditional measures associated with
Î¾i , i = 0, . . . , s. The following result is an induced version of Lemma 2.5.

34

DE-JUN FENG

Proposition 5.5. Let i âˆˆ {1, . . . , s}. Then for m-a.e. x âˆˆ F ,


Î¾iâˆ’1
â„“(x)âˆ’1
âˆ
kN
âˆ’1
mx
Î“i (x, r) âˆ© P0
(x)
X
X
(5.13) lim log
=âˆ’
Ï‡Fk (x)
Im (P|Î¾bi )(Ïƒ j x).
Î¾
râ†’0
mxiâˆ’1 (Î“i (x, r))
j=0
k=1
Furthermore, set

g(x) = âˆ’ inf log

(5.14)

r>0



Î¾
â„“(x)âˆ’1
mxiâˆ’1 Î“i (x, r) âˆ© P0
(x)
Î¾

mxiâˆ’1 (Î“i (x, r))

.

Then g â‰¥ 0 and g âˆˆ L1 (F, B|F , mF ).
Proof. Fix i âˆˆ {1, . . . , s}. Write di =
by

Ps

j=i+1 kj .

Define Ï†i : Î£â€² â†’ Yi := G(d, di )Ã—Rd


Ï†i (x) = Vxi , P(Vxi )âŠ¥ (Ï€x) .

Then Ï†i is measurable. Moreover,

Î¾i (x) = {y âˆˆ Î¾0 (x) : Ï†i (y) = Ï†i (x)},

(5.15)

x âˆˆ Î£â€² .

Endow Yi with the following product metric Ïi :
Ïi ((V, a), (W, b)) = max{kPV âˆ’ PW k, ka âˆ’ bk}.
It is not hard to see that Yi is a Besicovitch space. For x âˆˆ Î£â€² and r > 0, set
B Ï†i (x, r) := {y âˆˆ Î£â€² : Ïi (Ï†i y, Ï†i x) â‰¤ r}.
Then by definition,
Î¾0 (x) âˆ© B Ï†i (x, r) = Î¾0 (x) âˆ© Î“i (x, r),

(5.16)

x âˆˆ Î£â€² , r > 0.

Hence for x âˆˆ F and r > 0,
(5.17)
Î¾
mxiâˆ’1

log



Î“i (x, r) âˆ©
Î¾

â„“(x)âˆ’1
P0
(x)

mxiâˆ’1 (Î“i (x, r))



Î¾
mxiâˆ’1

= log

= log

= log
=

âˆ
X



â„“(x)âˆ’1
Î¾0 (x) âˆ© Î“i (x, r) âˆ© P0
(x)
Î¾

mxiâˆ’1 (Î¾0 (x) âˆ© Î“i (x, r))


Î¾iâˆ’1
â„“(x)âˆ’1
Ï†i
mx
Î¾0 (x) âˆ© B (x, r) âˆ© P0
(x)
Î¾

mxiâˆ’1 (Î¾0 (x) âˆ© B Ï†i (x, r))


Î¾iâˆ’1
â„“(x)âˆ’1
Ï†i
mx
B (x, r) âˆ© P0
(x)
Î¾

mxiâˆ’1 (B Ï†i (x, r))

X

k=1 AâˆˆP kNâˆ’1
0

Ï‡Fk âˆ©A (x) log


Î¾
mxiâˆ’1 B Ï†i (x, r) âˆ© A
Î¾

mxiâˆ’1 (B Ï†i (x, r))

.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

35

By (5.17) and applying Lemma 2.5(1) to Ï†i : Î£â€² â†’ Yi , we have for m-a.e. x âˆˆ F ,


Î¾
â„“(x)âˆ’1
mxiâˆ’1 Î“i (x, r) âˆ© P0
(x)
lim log
Î¾
râ†’0
mxiâˆ’1 (Î“i (x, r))
âˆ


X
X
âˆ’1
d
=
Ï‡Aâˆ©Fk (x) log Em Ï‡A |Î¾iâˆ’1 âˆ¨ Ï†i B(Yi ) (x)
k=1 AâˆˆP kNâˆ’1
0

=

âˆ
X

X

Ï‡Aâˆ©Fk (x) log Em

k=1 AâˆˆP kNâˆ’1
0

=

âˆ
X

Ï‡Fk (x)

k=1

=âˆ’

âˆ
X
k=1

=âˆ’

âˆ
X
k=1

This proves (5.13).

X




b
Ï‡A |Î¾i (x)

Ï‡A (x) log Em

AâˆˆP0kNâˆ’1

Ï‡Fk (x)Im (P0kN âˆ’1 |Î¾bi )(x)
Ï‡Fk (x)

kN
âˆ’1
X
j=0




b
Ï‡A |Î¾i (x)

Im (P|Î¾bi )(Ïƒ j x)

(by (4.18)).

Next we prove that g âˆˆ L1 (mF ). We mainly follow the arguments in [29, Lemma
3.3 and Proposition 3.5]. By Theorem 2.4, for any given C âˆˆ Î¾iâˆ’1 , the conditional
Î¾
measures mxiâˆ’1 (x âˆˆ C) represent the same measure supported on C, which we
rewrite as mC . Fix C âˆˆ Î¾iâˆ’1 , k âˆˆ N and A âˆˆ P0kN âˆ’1 . We define measures ÂµC and
âˆ’1
Î½C on Yi by ÂµC (E) = mC (Ï†âˆ’1
i E âˆ© A) and Î½C (E) = mC (Ï†i E) for all E âˆˆ B(Yi ).
By the Hardy-Littlewood maximal inequality (see, e.g. Theorem 2.19 in [50]), there
exists a positive constant a (which depends on Yi ) such that


ÂµC (B(z, r))
< u â‰¤ au
(u > 0).
ÂµC z âˆˆ Yi : inf
r>0 Î½C (B(z, r))

Hence for any u > 0,
(
mC

)
!

Ï†i
m
B
(x,
r)
âˆ©
A
C
x âˆˆ Î£â€² : inf
< u âˆ© A â‰¤ au.
r>0
mC (B Ï†i (x, r))

Integrating C over Î¾iâˆ’1 , we obtain
(
)
!

Î¾iâˆ’1
Ï†i
m
B
(x,
r)
âˆ©
A
x
m
x âˆˆ Î£â€² : inf
< u âˆ© A â‰¤ au.
Î¾
r>0
mxiâˆ’1 (B Ï†i (x, r))

Î¾
mxiâˆ’1 B Ï†i (x, r) âˆ© A
A
. Then the above inequality can be rewritten
Write g (x) = inf
Î¾
r>0
mxiâˆ’1 (B Ï†i (x, r))
as
(5.18)

m(A âˆ© {g A < u}) â‰¤ au.

36

DE-JUN FENG

Note that by (5.14) and (5.17), g(x) = âˆ’
g is non-negative,
Z
Z âˆ
g dm =
m{g > t} dt

Pâˆ P
k=1

AâˆˆP0kNâˆ’1

Ï‡Fk âˆ©A (x) log g A (x). Since

0

=

Z

0

â‰¤

âˆ
âˆX

âˆ
X

X

k=1 AâˆˆP kNâˆ’1
0

X

k=1 AâˆˆP kNâˆ’1
0

â‰¤

âˆ
X

m(Fk âˆ© A âˆ© {g A < eâˆ’t }) dt

X

Z

âˆ

min{m(Fk âˆ© A), aeâˆ’t } dt

(by (5.18))

0

(âˆ’m(Fk âˆ© A) log m(Fk âˆ© A) + m(Fk âˆ© A)(1 + log a))

k=1 AâˆˆP kNâˆ’1
0

â‰¤ 1 + log a +

âˆ
X

X

(âˆ’m(Fk âˆ© A) log m(Fk âˆ© A))

k=1 AâˆˆP kNâˆ’1
0

âˆ
X

ï£®ï£«

X

ï£¶

m(Fk âˆ© A) ï£¸
m(Fk âˆ© A)
log
m(Fk )
m(Fk )
k=1
AâˆˆP0kNâˆ’1

1
+ log
m(Fk )


âˆ
X
1
â‰¤ 1 + log a +
m(Fk ) kN log(#Î›) + log
m(Fk )
k=1
â‰¤ 1 + log a +

< âˆ

m(Fk ) ï£°ï£­

âˆ’

(by Lemma 2.10(ii)-(iii)).

This finishes the proof of the proposition.



Finally we are ready to prove (5.6), the last step in the proof of Proposition 5.1.
Proof of (5.6). Fix Ç« > 0 and write F = F (Ç«). Let i âˆˆ {1, . . . , s}.
For x âˆˆ F and n âˆˆ N, define
Ïn (i, x) =

nâˆ’1
Y

Ï(i, ÏƒFk x),

k=0

where ÏƒFk := (ÏƒF )k , and Ï(i, x) = eâ„“(x)(Î»i (x)âˆ’Ç«) (as defined in (5.9)). Moreover, write
Î¾

Hn (x) := log

Gn (x) := log

mxiâˆ’1 (Î“i (x, Ïn (i, x)))

,
Î¾
mÏƒiâˆ’1
F x (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x)))


Î¾
â„“(x)âˆ’1
mxiâˆ’1 Î“i (x, Ïn (i, x)) âˆ© P0
(x)
Î¾

mxiâˆ’1 (Î“i (x, Ïn (i, x)))

.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

37

Then for m-a.e. x âˆˆ F ,
Hn (x) + Gn (x) = log

= log

â‰¤ log

â‰¤ log

= log



Î¾
â„“(x)âˆ’1
mxiâˆ’1 Î“i (x, Ïn (i, x)) âˆ© P0
(x)
Î¾

mÏƒiâˆ’1
x (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x)))
F

Î¾
â„“(x)âˆ’1
mxiâˆ’1 Î¾iâˆ’1 (x) âˆ© Î“i (x, Ïn (i, x)) âˆ© P0
(x)
Î¾

mÏƒiâˆ’1
F x (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x)))



Î¾
â„“(x)âˆ’1
mxiâˆ’1 Ïƒ âˆ’â„“(x) (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x)) âˆ© Î¾iâˆ’1 (ÏƒF x)) âˆ© P0
(x)
Î¾

mÏƒiâˆ’1
F x (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x)))



Î¾
â„“(x)âˆ’1
mxiâˆ’1 Ïƒ âˆ’â„“(x) (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x))) âˆ© P0
(x)
Î¾

mÏƒiâˆ’1
F x (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x)))



Î¾
â„“(x)âˆ’1
mxiâˆ’1 Ïƒ âˆ’â„“(x) (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x))) âˆ© P0
(x)
Î¾

mÏƒiâˆ’1
â„“(x) x (Î“i (ÏƒF x, Ïnâˆ’1 (i, ÏƒF x)))

â„“(x)âˆ’1

= log mÎ¾xiâˆ’1 (P0
=âˆ’

âˆ
X
k=1

Ï‡Fk (x)

(x))

kN
âˆ’1
X
j=0

(by Lemma 4.5(3))

j
Im (P|Î¾d
iâˆ’1 )(Ïƒ x) =: Qiâˆ’1 (x)

(by (4.16)),

that is, Hn (x) + Gn (x) â‰¤ Qiâˆ’1 (x). Therefore for m-a.e. x âˆˆ F ,
!
nâˆ’1
X
Î¾
âˆ’ log mÎ¾xiâˆ’1 (Î“i (x, Ïn (i, x))) = âˆ’
Hnâˆ’j (ÏƒFj x) âˆ’ log mÏƒiâˆ’1
(Î“i (ÏƒFn x, 1))
n
Fx
j=0

â‰¥âˆ’

nâˆ’1
X

Hnâˆ’j (ÏƒFj x)

j=0

â‰¥

nâˆ’1
X
j=0


Gnâˆ’j (ÏƒFj x) âˆ’ Qiâˆ’1 (ÏƒFj x) ,

and thus
nâˆ’1


âˆ’ log mxiâˆ’1 (Î“i (x, Ïn (i, x)))
1X
Gnâˆ’j (ÏƒFj x) âˆ’ Qiâˆ’1 (ÏƒFj x) .
â‰¥
n
n j=0
Î¾

Notice that by Proposition 5.5, when n â†’ +âˆ,
Gn â†’ Qi := âˆ’

âˆ
X
k=1

Ï‡Fk

kN
âˆ’1
X
j=0

Im (P|Î¾bi ) â—¦ Ïƒ j

(by (5.10))

38

DE-JUN FENG

pointwise and in L1 . By Lemma 2.3, for m-a.e. x âˆˆ F ,
Î¾

âˆ’ log mxiâˆ’1 (Î“i (x, Ïn (i, x)))
â‰¥ EmF ((Qi âˆ’ Qiâˆ’1 )|IF )(x),
nâ†’âˆ
n
where IF := {B âˆˆ B|F : ÏƒFâˆ’1 (B) = B}. In the meantime, by the Birkhoff ergodic
theorem,
âˆ’1
lim
log(Ïn (i, x)) = EmF (N(âˆ’Î»i + Ç«)rF |IF )(x)
nâ†’âˆ n
= N(âˆ’Î»i (x) + Ç«)EmF (rF |IF )(x) mF -a.e.,
lim inf

where we use the fact that Î»i is Ïƒ-invariant and thus ÏƒF -invariant. Hence for ma.e. x âˆˆ F ,
Î¾

Î¾

log mxiâˆ’1 (Î“i (x, Ïn (i, x)))
log mxiâˆ’1 (Î“i (x, r))
= lim inf
lim inf
nâ†’âˆ
râ†’0
log r
log(Ïn (i, x))
EmF ((Qi âˆ’ Qiâˆ’1 )|IF )(x)
â‰¥
N(âˆ’Î»i (x) + Ç«)EmF (rF |IF )(x)

 
b
Em Im (P|Î¾d
)
âˆ’
I
(P|
Î¾
)
iâˆ’1
m
i |I (x)
=
âˆ’Î»i (x) + Ç«
hiâˆ’1 (x) âˆ’ hi (x)
=
.
âˆ’Î»i (x) + Ç«

(by Lemma 2.11)

That is, (5.6) holds. This completes the proof of Proposition 5.1.



6. Local dimensions of invariant measures for affine IFSs
In this section, we prove Theorems 1.2-1.4 and 1.6-1.7.
Let M : Î£ â†’ Matd (R) be the matrix-valued function defined by
M(x) = Mxâˆ’1 ,

x = (xj )+âˆ
j=âˆ’âˆ .

Let m âˆˆ MÏƒ (Î£). Let
s(x)

Rd = âŠ•i=1 Exi
(x âˆˆ Î£â€² )
be the Oseledets splittings of Rd associated with (Î£, Ïƒ âˆ’1 , m) and M (see Section 4),
and 0 > Î»1 (x) > Â· Â· Â· > Î»s(x) (x) â‰¥ âˆ’âˆ the corresponding Lyapunov exponents.
Below we prove parts (i) and (ii) of Theorem 1.2 separately.
Proof of Theorem 1.2(i). In the beginning we assume that the condition (4.7) holds,
that is, for all x âˆˆ Î£â€² ,
s(x) = s,

and

dim Exi = ki for i = 1, . . . , s.

(Just keep in mind that we donâ€™t assume that m is ergodic at this moment.)
Write Vxi = âŠ•sj=i+1 Exj for i = 0, . . . , s âˆ’ 1, and Vxs = {0}. Clearly
{0} = Vxs âŠ‚ Vxsâˆ’1 âŠ‚ Â· Â· Â· âŠ‚ Vx0 = Rd .

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

39

Let Î¾0 , Î¾1 , . . . , Î¾s be the measurable partitions of Î£â€² constructed as in Section 4.
Furthermore, we set
(6.1)

Î¾âˆ’1 = {Î£â€² , âˆ…}

and Î»0 (x) = Î»1 (x) for x âˆˆ Î£â€² .

Clearly Î¾âˆ’1 (x) = Î£â€² for any x âˆˆ Î£â€² . By Lemma 4.4(2), we have
(6.2)

Qn,Ç« âˆ© Î¾i (x) âˆ© P0nâˆ’1 (x) âŠ‚ B Ï€ (x, en(Î»i+1 (x)+Ç«) ),

i = âˆ’1, 0, . . . , s âˆ’ 1

when n is large enough. Here B Ï€ (x, r) is defined as in (2.3).
For i = âˆ’1, 0, . . . , s, let {mÎ¾xi } be the canonical system of conditional measures
associated with Î¾i . By the definition of Î¾âˆ’1 , we see that mÎ¾xâˆ’1 = m for any x âˆˆ Î£â€² .
For x âˆˆ Î£â€² and i âˆˆ {0, 1, . . . , s}, let hi (x) be defined as in (4.15). Due to (4.17)
we write
hâˆ’1 (x) = h0 (x).
According to Lemmas 4.6 and 4.8,
(6.3)
âˆ’ log mÎ¾xi (Qn,Ç« âˆ© P0nâˆ’1 (x))
= hi (x) for m-a.e. x âˆˆ Î£â€² ,
i = âˆ’1, 0, . . . , s.
lim
nâ†’âˆ
n
For x âˆˆ Î£â€² and r > 0, let Î“i (x, r) be defined as in (5.1), that is,
Î“i (x, r) = {y âˆˆ Î£â€² : dist(Ï€y + Vxi , Ï€x + Vxi ) â‰¤ r},

i = 1, . . . , s.

Write for convention that
Î“0 (x, r) = Î£â€² .
It is easy to see that for i = 0, 1, . . . , s,
Î“i (x, r) = {y âˆˆ Î£â€² : kP(Vxi )âŠ¥ (Ï€y âˆ’ Ï€x)k â‰¤ r},

(6.4)

where (Vxi )âŠ¥ stands for the orthogonal complement of the space Vxi in Rd , and PW
is the orthogonal projection from Rd to W .
Moreover, define
(6.5)

Ï‘i (x) = lim inf
râ†’0

log mÎ¾xi (Î“i+1 (x, r))
,
log r

i = âˆ’1, 0, . . . , s âˆ’ 1.

Clearly Ï‘âˆ’1 (x) = 0 for every x âˆˆ Î£â€² since Î“0 (x, r) = Î£â€² . Combining this with
Proposition 5.1 yields
(6.6)

Ï‘i (x) â‰¥

hi+1 (x) âˆ’ hi (x)
Î»i+1 (x)

(i = âˆ’1, 0, . . . , s âˆ’ 1)

for m-a.e. x âˆˆ Î£â€² .
For i = âˆ’1, 0, . . . , s and x âˆˆ Î£â€² , define
Î´ i (x) = lim sup
râ†’0

log mÎ¾xi (B Ï€ (x, r))
,
log r

We claim that for m-a.e. x âˆˆ Î£â€² ,
(C1) Î´ s (x) = Î´ s (x) = 0.

Î´ i (x) = lim inf
râ†’0

log mÎ¾xi (B Ï€ (x, r))
.
log r

40

DE-JUN FENG

hi+1 (x) âˆ’ hi (x)
â‰¥ Î´ i (x) âˆ’ Î´ i+1 (x) for i = âˆ’1, 0, . . . , s âˆ’ 1.
Î»i+1 (x)
(C3) Î´ i+1 (x) + Ï‘i (x) â‰¤ Î´ i (x) for i = âˆ’1, 0, . . . , s âˆ’ 1.

(C2)

It is easy to see that (C1)-(C3) together with (6.6) force inductively that for
m-a.e. x âˆˆ Î£â€² ,
hi+1 (x) âˆ’ hi (x)
(6.7)
for i = s âˆ’ 1, . . . , 0, âˆ’1,
Ï‘i (x) =
Î»i+1 (x)
for i = s, s âˆ’ 1, . . . , 0, âˆ’1

Î´ i (x) = Î´ i (x)

(we write the common value as Î´i (x)), and furthermore
(6.8)

Î´i (x) =

sâˆ’1
X

Ï‘j (x) =

j=i

for i = âˆ’1, 0, . . . , s. In particular,
(6.9)

sâˆ’1
X
hj+1 (x) âˆ’ hj (x)

Î»j+1 (x)

j=i

dimloc (Ï€âˆ— m, Ï€x) = Î´âˆ’1 (x) = Î´0 (x) =

sâˆ’1
X

Ï‘i (x) =

i=0

sâˆ’1
X
hi+1 (x) âˆ’ hi (x)
i=0

Î»i+1 (x)

for m-a.e. x, which proves Theorem 1.2(i) under the additional assumption (4.7). In
the following we prove (C1)-(C3) respectively.
Proof of (C1). Since Î¾s (x) = Ï€ âˆ’1 (Ï€x) âˆ© Î¾0 (x) âŠ‚ B Ï€ (x, r) for any x âˆˆ Î£â€² and r > 0,
we have
mÎ¾xs (B Ï€ (x, r)) â‰¥ mÎ¾xs (Î¾s (x)) = 1
and so mÎ¾xs (B Ï€ (x, r)) = 1 for all x âˆˆ Î£â€² . Thus Î´ s (x) = Î´ s (x) = 0 for all x âˆˆ Î£â€² . 
Proof of (C2). We give a proof by contradiction, which is modified from [46, Â§10.2]
and the proof of [29, Theorem 2.11]. Assume that (C2) is not true. Then there
exists i âˆˆ {âˆ’1, 0, . . . , s âˆ’ 1} such that
hi+1 (x) âˆ’ hi (x)
< Î´ i (x) âˆ’ Î´ i+1 (x)
Î»i+1 (x)
on a set U = Ui âŠ‚ Î£â€² with positive measure. Fix such i. Removing a suitable
subset from U if necessary, we may assume that one of the following holds: (a)
Î»i+1 (x) 6= âˆ’âˆ for all x âˆˆ U; or (b) Î»i+1 (x) = âˆ’âˆ and Î´ i (x) > Î´ i+1 (x) for all x âˆˆ U.
Notice that (b) can not occur unless i = s âˆ’ 1, since Î»i+1 (x) 6= âˆ’âˆ for i < s âˆ’ 1.
Now we first assume that the scenario (a) occurs. Then there exist Î± > 0 and
real numbers hi , hi+1 , Î»i+1 , Î´ i , Î´i+1 with Î»i+1 < 0 such that
hi+1 âˆ’ hi
< Î´ i âˆ’ Î´ i+1 âˆ’ Î±
(6.10)
Î»i+1
and for any Ç« > 0, there exists BÇ« âŠ‚ U with m(BÇ« ) > 0 so that for x âˆˆ BÇ« ,
|hi (x) âˆ’ hi | < Ç«/2,

|hi+1 (x) âˆ’ hi+1 | < Ç«/2,

Î»i+1 (x) < Î»i+1 + Ç«/2

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

41

and
Î´ i (x) â‰¥ Î´ i âˆ’ Ç«/2, Î´ i+1 (x) < Î´ i+1 + Ç«/2.
Fix Ç« âˆˆ (0, âˆ’Î»i+1 /3). There exists n0 : BÇ« â†’ N such that for m-a.e. x âˆˆ BÇ« and
n > n0 (x), we have

Î¾
log mxi+1 B Ï€ (x, en(Î»i+1 +2Ç«) )
< Î´ i+1 + Ç«;
(1)
n(Î»i+1 + 2Ç«)
1
(2) âˆ’ log mxÎ¾i+1 (P0nâˆ’1 (x)) > hi+1 âˆ’ Ç«
(by (4.16));
n
(3) Qn,Ç« âˆ© Î¾i (x) âˆ© P0nâˆ’1 (x) âŠ‚ B Ï€ (x, en(Î»i+1 +2Ç«) )
(by (6.2));
1
(4) âˆ’ log mÎ¾xi (Qn,Ç« âˆ© P0nâˆ’1 (x)) < hi + Ç«
(by (6.3)).
n
Take N0 such that
âˆ† := {x âˆˆ BÇ« : n0 (x) â‰¤ N0 }
has the positive measure. By Lemma 2.5(1) and Lemma 2.2, there exist c > 0 and
âˆ†â€² âŠ‚ âˆ† with m(âˆ†â€² ) > 0 such that for x âˆˆ âˆ†â€² , there exists n = n(x) â‰¥ N0 such that
Î¾

(5)

mxi+1 (L âˆ© âˆ†)
Î¾

mxi+1 (L)

> c, where

L := B Ï€ (x, en(Î»i+1 +2Ç«) );

log mÎ¾xi B Ï€ (x, 2en(Î»i+1 +2Ç«) )
> Î´ i âˆ’ Ç«;
(6)
n(Î»i+1 + 2Ç«)
log(1/c)
(7)
< Ç«.
n
Take x âˆˆ âˆ†â€² such that (1)â€“(7) are satisfied with n = n(x). Write C = Î¾i+1 (x) and
â€²
C = Î¾i (x). Then by (5) and (1),
mxÎ¾i+1 (L âˆ© âˆ†) â‰¥ cmxÎ¾i+1 (L) â‰¥ cen(Î»i+1 +2Ç«)(Î´ i+1 +Ç«) .
Î¾

But for each y âˆˆ L âˆ© âˆ†, by (2), myi+1 (P0nâˆ’1 (y)) < eâˆ’n(hi+1 âˆ’Ç«) . It follows that the
number of distinct P0nâˆ’1 -atoms intersecting C âˆ© L âˆ© âˆ† is larger than
mxÎ¾i+1 (L âˆ© âˆ†)en(hi+1 âˆ’Ç«) .
However each such a P0nâˆ’1 -atom, say P0nâˆ’1 (y), intersects C â€² âˆ©Lâˆ©âˆ†. This implies that
Qn,Ç« âˆ© C â€² âˆ© P0nâˆ’1 (y) is contained in C â€² âˆ© B Ï€ (x, 2en(Î»i+1 +2Ç«) ). To see this implication,
let z âˆˆ P0nâˆ’1 (y) âˆ© C â€² âˆ© L âˆ© âˆ†; since z âˆˆ L âˆ© âˆ†, we have d(Ï€z, Ï€x) â‰¤ en(Î»i+1 +2Ç«) and
thus
Qn,Ç« âˆ© C â€² âˆ© P0nâˆ’1 (y) = Qn,Ç« âˆ© Î¾i (z) âˆ© P0nâˆ’1 (z)
âŠ‚ B Ï€ (z, en(Î»i+1 +2Ç«) ) (by (3))
âŠ‚ B Ï€ (x, 2en(Î»i+1 +2Ç«) ),
so Qn,Ç« âˆ© C â€² âˆ© P0nâˆ’1 (y) âŠ‚ C â€² âˆ© B Ï€ (x, 2en(Î»i+1 +2Ç«) ), as desired. In the meantime, by
(4), mÎ¾xi (Qn,Ç« âˆ©P0nâˆ’1 (y)) â‰¥ eâˆ’n(hi +Ç«) . (To see it, picking w âˆˆ P0nâˆ’1 (y) âˆ©C â€² âˆ©Lâˆ©âˆ†, we

42

DE-JUN FENG

have Î¾i (x) = Î¾i (w) and thus mÎ¾xi (Qn,Ç« âˆ© P0nâˆ’1 (y)) = mÎ¾wi (Qn,Ç« âˆ© P0nâˆ’1 (w)) â‰¥ eâˆ’n(hi +Ç«) .)
Hence
mxÎ¾i (B Ï€ (x, 2en(Î»i+1 +2Ç«) )) â‰¥ #{P0nâˆ’1 -atoms intersecting C â€² âˆ© L âˆ© âˆ†} Â· eâˆ’n(hi +Ç«)
â‰¥ mxÎ¾i+1 (L âˆ© âˆ†)en(hi+1 âˆ’Ç«) eâˆ’n(hi +Ç«)
â‰¥ cen(Î»i+1 +2Ç«)(Î´i+1 +Ç«) en(hi+1 âˆ’Ç«) eâˆ’n(hi +Ç«) .
Combining the above inequality with (6) yields
(Î»i+1 + 2Ç«)(Î´ i âˆ’ Ç«)
(6.11)

log c
+ hi+1 âˆ’ hi âˆ’ 2Ç«
n
â‰¥ (Î»i+1 + 2Ç«)(Î´ i+1 + Ç«) + hi+1 âˆ’ hi âˆ’ 3Ç«.

â‰¥ (Î»i+1 + 2Ç«)(Î´ i+1 + Ç«) +

Taking Ç« â†’ 0 yields hi+1 âˆ’ hi â‰¤ Î»i+1 (Î´ i âˆ’ Î´ i+1 ), which leads to a contradiction with
(6.10) (keep in mind that Î»i+1 < 0).
Next we assume that the scenario (b) occurs, that is, Î»i+1 (x) = âˆ’âˆ and Î´ i (x) >
Î´ i+1 (x) for all x âˆˆ U. In this case, i = s âˆ’ 1, and thus by (C1), Î´ i+1 (x) = Î´ i+1 (x) = 0
for all x âˆˆ U. So Î´ i (x) > 0 for all x âˆˆ U. Hence there exist real numbers hi , hi+1 , Î´i
with Î´ i > 0, so that for any Ç« > 0, there exists BÇ« âŠ‚ U with m(BÇ« ) > 0 such that
for x âˆˆ BÇ« ,
|hi (x) âˆ’ hi | < Ç«/2,

|hi+1 (x) âˆ’ hi+1 | < Ç«/2,

Î´i (x) â‰¥ Î´ i âˆ’ Ç«/2.

Set Î»i+1 = (âˆ’1/Ç«) âˆ’ 2Ç« and Î´ i+1 = 0. Then an argument similar to that for the
scenario (a) shows that the previous estimates (1)-(7) hold, and moreover, the inequality (6.11) still holds. Taking Ç« â†’ 0 gives Î´ i â‰¤ Î´ i+1 = 0, leads to a contradiction
with Î´ i > 0.

Proof of (C3). Here we give a proof by contradiction, following the lines of the
proof of [29, Theorem 2.11], in which the arguments were adapted from the original
proof of [46, Lemma 11.3.1]. Assume that (C3) is not true. Then there exists
i âˆˆ {âˆ’1, 0, . . . , s âˆ’ 1} such that Î´i+1 (x) + Ï‘i (x) > Î´ i (x) on a subset of Î£â€² with
positive measure. Hence there exist Î² > 0 and real numbers Î´ i , Î´ i+1 , Ï‘i such that
(6.12)

Î´ i+1 + Ï‘i > Î´ i + Î²,

and for any Ç« > 0, there exists AÇ« âŠ‚ Î£â€² with m(AÇ« ) > 0 so that for x âˆˆ AÇ« ,
(6.13)

|Î´i (x) âˆ’ Î´ i | < Ç«/2,

|Î´ i+1 (x) âˆ’ Î´ i+1 | < Ç«/2,

|Ï‘i (x) âˆ’ Ï‘i | < Ç«/2.

Let 0 < Ç« < Î²/4. Find N1 and a set Aâ€²Ç« âŠ‚ AÇ« with m(Aâ€²Ç« ) > 0 such that

(6.14)
mxÎ¾i+1 B Ï€ (x, 2eâˆ’n ) â‰¤ eâˆ’n(Î´i+1 âˆ’Ç«)
for x âˆˆ Aâ€²Ç« and n > N1 .

By Lemma 2.5(1) and Lemma 2.2, we can find c > 0 and Aâ€²â€²Ç« âŠ‚ Aâ€²Ç« with m(Aâ€²â€²Ç« ) > 0
and N2 > N1 such that for all x âˆˆ Aâ€²â€²Ç« and n â‰¥ N2 ,
mÎ¾xi (Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n ))
mÎ¾xi (B Ï€ (x, eâˆ’n ))

> c.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

43

For x âˆˆ Aâ€²â€²Ç« and n â‰¥ N2 , we have

(6.15)

mÎ¾xi (B Ï€ (x, eâˆ’n )) â‰¤ câˆ’1 mÎ¾xi (Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n ))
Z
âˆ’1
myÎ¾i+1 (Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n )) dmÎ¾xi (y)
=c
Z
âˆ’1
myÎ¾i+1 (Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n )) dmÎ¾xi (y),
=c
Î“i+1 (x,eâˆ’n )

where in the last equality, we use the fact that y âˆˆ Î“i+1 (x, eâˆ’n ), if y âˆˆ Î¾i (x) and
Î¾i+1 (y) âˆ© Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n ) 6= âˆ…. To see this fact, let y âˆˆ Î¾i (x) such that Î¾i+1 (y) âˆ©
Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n ) 6= âˆ…. Take w âˆˆ Î¾i+1 (y) âˆ© Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n ). Then Ï€w âˆ’ Ï€y âˆˆ Vyi+1 ,
kÏ€w âˆ’ Ï€xk â‰¤ eâˆ’n and w âˆ’ = y âˆ’ = xâˆ’ which implies Vwi+1 = Vyi+1 = Vxi+1 . Hence
dist(Ï€y + Vxi+1 , Ï€x + Vxi+1 ) = dist(Ï€w + Vxi+1 , Ï€x + Vxi+1 ) â‰¤ kÏ€w âˆ’ Ï€xk â‰¤ eâˆ’n ,
and thus y âˆˆ Î“i+1 (x, eâˆ’n ). This completes the proof of the fact. In the above
argument, since kÏ€w âˆ’ Ï€xk â‰¤ eâˆ’n , we have Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n ) âŠ‚ B Ï€ (w, 2eâˆ’n ) and thus
Î¾i+1
myÎ¾i+1 (Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n )) = mw
(Aâ€²Ç« âˆ© B Ï€ (x, eâˆ’n ))
Î¾i+1
â‰¤ mw
(B Ï€ (w, 2eâˆ’n ))

â‰¤ eâˆ’n(Î´i+1 âˆ’Ç«)

(by (6.14)).

Combining the above inequality with (6.15) yields
mÎ¾xi (B Ï€ (x, eâˆ’n )) â‰¤ câˆ’1 eâˆ’n(Î´i+1 âˆ’Ç«) mÎ¾xi (Î“i+1 (x, eâˆ’n ))

(x âˆˆ Aâ€²â€²Ç« , n â‰¥ N2 ).

Letting n â†’ âˆ, we obtain Î´ i (x) â‰¥ Î´ i+1 âˆ’ Ç« + Ï‘i (x) for x âˆˆ Aâ€²â€²Ç« . Combining this with
(6.13) yields
Î´ i â‰¥ Î´ i+1 + Ï‘i âˆ’ 4Ç« â‰¥ Î´i+1 + Ï‘i âˆ’ Î²,
which contradicts (6.12).

So far we have proved Theorem 1.2(i) under the additional assumption (4.7). Now
we consider the general case that the integer functions s(x) and dim Vxi , 1 â‰¤ i â‰¤ s(x),
may not be constant over Î£â€² . In such case, by Theorem 2.12 there exists a finite
Borel partition
k
G
â€²
Î£ =
Î£j
j=1

â€²

of Î£ so that for each j, Î£j is Ïƒ-invariant, and s(x) and dim Vxi are constant restricted
on Î£j . Ignore those indices j with m(Î£j ) = 0. We define probability measures mj
by
m|Î£j
.
mj =
m(Î£j )
Then mj âˆˆ MÏƒ (Î£j ). Since now (4.7) holds for mj (in which Î£â€² is replaced by Î£j ),
we see that (6.9) holds when replacing m by mj . In particular, the local dimension
dimloc (Ï€âˆ— (mj ), Ï€x) exists for mj -a.e. x âˆˆ Î£j . Equivalently,
(6.16)

log m(Î£j âˆ© B Ï€ (x, r))
râ†’0
log r
lim

exists for m-a.e. x âˆˆ Î£j .

44

DE-JUN FENG

By Lemma 2.5(1) and Lemma 2.2, for m-a.e. x âˆˆ Î£j , the following
m(Î£j âˆ© B Ï€ (x, r))
râ†’0
m(B Ï€ (x, r))
lim

exists and takes positive value. This together with (6.16) yields that the local
dimension dimloc (Ï€âˆ— m, Ï€x) exists for m-a.e. x âˆˆ Î£j . Since j is arbitrarily taken,
dimloc (Ï€âˆ— m, Ï€x) exists for m-a.e. x âˆˆ Î£â€² . This completes the proof of Theorem
1.2(i).

Proof of Theorems 1.2(ii) and 1.3. Since now m is assumed to be ergodic, the condition (4.7) holds and the functions Î»i (x), hi (x) (i = âˆ’1, . . . , s) considered in the
proof of Theorem 1.2(i) are all constant, which we denote by Î»i , hi respectively. The
formula (1.6) just follows from (6.9).

Proof of Theorem 1.4. It is based on the proof of Theorem 1.2. To see (1.7), let
i âˆˆ {0, . . . , s âˆ’ 1}. By (6.8), for m-a.e. x âˆˆ Î£â€² ,
Ï€âˆ— mÎ¾xi

dimloc



sâˆ’1
X

hk+1 âˆ’ hk
.
, Ï€x = Î´i =
Î»k+1
k=i

Equivalently, for m-a.e. x âˆˆ Î£â€² and mÎ¾xi -a.e. y âˆˆ Î¾i (x),

sâˆ’1
X


hk+1 âˆ’ hk
.
dimloc Ï€âˆ— mÎ¾xi , Ï€y = Î´i =
Î»k+1
k=i



Hence for m-a.e. x âˆˆ Î£â€² , Ï€âˆ— mÎ¾xi is exact dimensional with dimension given by (1.7).
Next we prove (1.8) and (1.9). By (6.7), for m-a.e. x âˆˆ Î£â€² ,
(6.17)

Ï‘i (x) = Ï‘i :=

hi+1 âˆ’ hi
Î»i+1

for i = âˆ’1, 0, . . . , s âˆ’ 1.

Let Î“i (x, r) (x âˆˆ Î£â€² ), 0 â‰¤ i â‰¤ s, be defined as in (6.4).
Fix j âˆˆ {1, . . . , s}. For i = âˆ’1, 0, . . . , j and x âˆˆ Î£â€² , define
log mÎ¾xi (Î“j (x, r))
Î³ i,j (x) = lim sup
,
log r
râ†’0

log mÎ¾xi (Î“j (x, r))
Î³ i,j (x) = lim inf
.
râ†’0
log r

We claim that
(6.18)
where g :

Î¾i (x) âˆ© Î“j (x, r) = Î¾i (x) âˆ© g âˆ’1(B(gx, r)),
Î¾i (x) â†’ (Vxj )

âŠ¥

is defined by y 7â†’ P(V j )âŠ¥ (Ï€y). To see this, let y âˆˆ
x

Î¾i (x) âˆ© Î“j (x, r). Then dist(Ï€y + Vxj , Ï€x + Vxj ) â‰¤ r, equivalently, kgy âˆ’ gxk â‰¤ r; hence
y âˆˆ g âˆ’1 (B(gx, r)). This proves the direction Î¾i (x) âˆ© Î“j (x, r) âŠ‚ Î¾i (x) âˆ© g âˆ’1 (B(gx, r)).
The other direction can be proved similarly. This completes the proof of (6.18).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

45

Now due to (6.18), we have mÎ¾xi (Î“j (x, r)) = mÎ¾xi (g âˆ’1(B(gx, r))), and so




Î³ i,j (x) = dimloc P(V j )âŠ¥ Ï€ âˆ— mÎ¾xi , P(V j )âŠ¥ (Ï€x) ,
x
x


(6.19)


Î¾i
Î³ i,j (x) = dimloc P(V j )âŠ¥ Ï€ âˆ— mx , P(V j )âŠ¥ (Ï€x) .
x

x

We claim that for m-a.e. x âˆˆ Î£â€² , the following properties hold:

(D1) Î³ j,j (x) = Î³ j,j (x) = 0.
(D2) hi âˆ’ hi+1 â‰¥ âˆ’Î»i+1 (Î³ i,j (x) âˆ’ Î³ i+1,j (x)) for i = âˆ’1, 0, . . . , j âˆ’ 1.
(D3) Î³ i+1,j (x) + Ï‘i â‰¤ Î³ i,j (x) for i = âˆ’1, 0, . . . , j âˆ’ 1.
Clearly (D1)-(D3) together with (6.17) force that for m-a.e. x âˆˆ Î£â€² ,
for i = j, j âˆ’ 1, . . . , 0, âˆ’1,

Î³ i,j (x) = Î³ i,j (x)

(we write the common value as Î³i,j (x)), and furthermore
(6.20)

Î³âˆ’1,j (x) =

jâˆ’1
X

Ï‘k =

k=0
jâˆ’1

(6.21)

Î³i,j (x) =

jâˆ’1
X
hk+1 âˆ’ hk
k=0

X hk+1 âˆ’ hk
k=i

Î»k+1

Î»k+1

and

for i âˆˆ {0, 1, . . . , j âˆ’ 1}.

Now (1.9) just follows from (6.20) and the fact (6.19). To see (1.8), let i âˆˆ {0, . . . , jâˆ’
1}. By (6.21) and (6.19), we have for m-a.e. x âˆˆ Î£â€² and mÎ¾xi -a.e. y âˆˆ Î¾i (x),
dimloc



P(V j )âŠ¥ Ï€
x



mÎ¾xi
âˆ—

jâˆ’1

X

hk+1 âˆ’ hk
, P(V j )âŠ¥ (Ï€y) = Î³i,j (x) =
,
x
Î»k+1
k=i

where we use the fact that Vyi = Vxi for y âˆˆ Î¾i (x), due to y âˆˆ Î¾0 (x) (see Lemma 4.1).


As a consequence, for m-a.e. x âˆˆ Î£â€² , P(V j )âŠ¥ Ï€ âˆ— mÎ¾xi is exact dimensional and (1.8)
x
holds. To complete the proof of Theorem 1.4, in the following we prove (D1)-(D3)
respectively.
By the definition of Î¾j , for x âˆˆ Î£â€² and y âˆˆ Î¾j (x), we have Ï€y âˆ’ Ï€x âˆˆ Vxj and
thus Ï€y + Vxj = Ï€x + Vxj . It follows that y âˆˆ Î“j (x, r). Hence Î¾j (x) âŠ‚ Î“j (x, r) and
thus mjx (Î“j (x, r)) = 1 for x âˆˆ Î£â€² and any r > 0. Hence Î³ j,j (x) = Î³ j,j (x) = 0 for all
x âˆˆ Î£â€² . This proves (D1).
The proofs of (D2) and (D3) are almost identical to that of (C2) and (C3), respectively. Indeed we only need to modify the proofs of (C2) and (C3) slightly. More
precisely, among other minor adjustments, we may simply replace the terms Î´i , Î´i+1 ,
B Ï€ (x, en(Î»i+1 +2Ç«) ), B Ï€ (x, 2en(Î»i+1 +2Ç«) ), B Ï€ (x, eâˆ’n ) therein by Î³i,j , Î³i+1,j , Î“j (x, en(Î»i+1 +2Ç«) ),
Î“j (x, 2en(Î»i+1 +2Ç«) ), and Î“j (x, eâˆ’n ) respectively. This completes the proof of Theorem
1.4.

As a corollary of Theorem 1.4, we have

46

DE-JUN FENG

Corollary 6.1. Under the assumptions of Theorem 1.3, for i âˆˆ {0, . . . , s âˆ’ 1} and
m-a.e. x âˆˆ Î£â€² ,
(6.22)

hi+1 âˆ’ hi
log mÎ¾xi (Î“i+1 (x, r))
â‰¤ ki+1 .
=
râ†’0
log r
Î»i+1

Ï‘i (x) = lim

Proof. Fix i âˆˆ {0, . . . , s âˆ’ 1}. As is proved in Theorem 1.4, for m-a.e. x âˆˆ Î£â€² ,
log mÎ¾xi (Î“i+1 (x, r))
hi+1 âˆ’ hi
.
= Î³i,i+1 (x) =
râ†’0
log r
Î»i+1
lim

âˆ’hi
â‰¤ ki+1 . By Theorem 1.4, for
To see (6.22) it remains to prove that hi+1
Î»i+1


â€²
m-a.e. x âˆˆ Î£ , the measure Î·x := P(V i+1 )âŠ¥ Ï€ âˆ— mÎ¾xi is exact dimensional with
x

âˆ’hi
dimension hi+1
. However, Î·x is supported on the affine subspace Ï€x + (Vxi âŠ– Vxi+1 )
Î»i+1
of dimension ki+1 , where Vxi âŠ– Vxi+1 stands for the orthogonal complement of Vxi+1
âˆ’hi
in Vxi . Hence dimH Î·x â‰¤ ki+1 , and so, hi+1
â‰¤ ki+1 .

Î»i+1

Lemma 6.2.  (i) Let m âˆˆ MÏƒ (Î£) be quasi-Bernoulli. Then for m-a.e. x âˆˆ Î£,
Ï€âˆ— mÎ¾x0 is strongly equivalent to Ï€âˆ— m.

(ii) Let m âˆˆ MÏƒ (Î£) be sub-multiplicative. Then for m-a.e. x âˆˆ Î£, Ï€âˆ— mÎ¾x0 is
absolutely continuous with respect to Ï€âˆ— m.
Proof. We first prove (i). Since m is quasi-Bernoulli, by definition there exists a
positive constant C such that
C âˆ’1 m([I])m([J]) â‰¤ m([IJ]) â‰¤ Cm([I])m([J])
for all finite words I, J over Î›. Below we show that for m-a.e. x âˆˆ Î£,
(6.23)

C âˆ’1 m([I]) â‰¤ mÎ¾x0 ([I]) â‰¤ Cm([I])

for all finite words
 I over Î›. This is enough to conclude the strong equivalence
between Ï€âˆ— mÎ¾x0 and Ï€âˆ— m, since Ï€x only depends on x+ := (xn )âˆ
n=0 .

To see (6.23), note that the measurable partition Î¾0 is induced by the mapping
Ï„ : Î£ â†’ Î£âˆ’ , x 7â†’ xâˆ’ = (xn )âˆ’1
âˆ’âˆ . That is, Î¾0 (x) = {y âˆˆ Î£ : Ï„ y = Ï„ x} for every x.
Applying Lemma 2.5(1) to Ï„ : Î£ â†’ Î£âˆ’ yields that for m-a.e. x,
(6.24)

m([xâˆ’n . . . xâˆ’1 I])
nâ†’âˆ m([xâˆ’n . . . xâˆ’1 ])

mÎ¾x0 ([I]) = Em (Ï‡[I] |Ï„ âˆ’1 (B(Î£âˆ’ )))(x) = lim

for all finite words I over Î›. (6.23) is then obtained from the quasi-Bernoulli property
of m.
Next we prove (ii). Here m is assumed to be sub-multiplicative and we only have
the one-sided inequality m([IJ]) â‰¤ Cm([I])m([J]). However this is enough to derive
from (6.24) that for m-a.e.
x, mÎ¾x0 ([I]) â‰¤ Cm([I]) for all finite words I over Î›. As a

consequence, Ï€âˆ— mÎ¾x0 is absolutely continuous with respect to Ï€âˆ— m, with a uniformly
bounded Radon-Nikodym derivative.


DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

47

Proof of Theorem 1.6. We
 first prove (i).
 FixÎ¾ i âˆˆ {1, . . . , s âˆ’ 1}. By Theorem 1.4,
â€²
Î¾i
for m-a.e. x âˆˆ Î£ , Ï€âˆ— mx and P(Vxi )âŠ¥ Ï€ âˆ— mx0 are exact dimensional with
dimH Ï€âˆ— mÎ¾xi

and
dimH
hence,
(6.25)

dimH Ï€âˆ— mÎ¾xi

P(Vxi )âŠ¥ Ï€






=

mÎ¾x0
âˆ—

+ dimH

sâˆ’1
X
hk+1 âˆ’ hk

Î»k+1

k=i



=

P(Vxi )âŠ¥ Ï€

iâˆ’1
X
hk+1 âˆ’ hk

Î»k+1

k=0



âˆ—

mÎ¾x0



,

= dimH Ï€âˆ— mÎ¾x0



.

Next let x âˆˆ Î£â€² and write W = Vxi , Î½ = mÎ¾x0 , Î· = Ï€âˆ— Î½. Notice that Î½ is supported
on Î¾0 (x). Consider the measurable partition Î¶ of Rd given by
Î¶ := {W + a : a âˆˆ W âŠ¥ }.
Set Ï€ âˆ’1 Î¶ := {Î¾0 (x) âˆ© Ï€ âˆ’1 (W + a) : a âˆˆ W âŠ¥ }. Then Ï€ âˆ’1 Î¶ is a measurable partition
âˆ’1
of Î¾0 (x). Let {Î½yÏ€ Î¶ }yâˆˆÎ¾0 (x) be the system of conditional measures of Î½ associated
with Ï€ âˆ’1 Î¶, and {Î·zÎ¶ }zâˆˆRd the system of conditional measures of Î· associated with Î¶.
Write Î·W,z := Î·zÎ¶ . By the uniqueness of conditional measures, we have for Î½-a.e. y,
âˆ’1 
(6.26)
Ï€âˆ— Î½yÏ€ Î¶ = Î·W,Ï€y .

Notice also that for y âˆˆ Î¾0 (x), the atom (Ï€ âˆ’1 Î¶)(y) is nothing but Î¾i (y). Hence we
âˆ’1
have Î½yÏ€ Î¶ = mÎ¾yi for m-a.e. x and mÎ¾x0 -a.e. y. This combining with (6.26) gives


(6.27)
Ï€âˆ— mÎ¾xi = Ï€âˆ— mÎ¾x0 V i ,Ï€x
x

for m-a.e. x. Plugging the above equality into (6.25), we see that Ï€âˆ— mÎ¾x0 satisfies
dimension conservation along Vxi . This proves (i).

Now we turn to the proof of (ii). Suppose that m is quasi-Bernoulli. By Lemma
6.2(i), for m-a.e. x âˆˆ Î£â€² , Ï€âˆ— mÎ¾x0 is strongly equivalent to Âµ = Ï€âˆ— m; as a consequence, P(Vxi )âŠ¥ Ï€ âˆ— mÎ¾x0 is strongly equivalent to P(Vxi )âŠ¥ âˆ— Âµ. It follows that

P
hk+1 âˆ’hk
for m-a.e. x âˆˆ Î£â€² , P(Vxi )âŠ¥ âˆ— Âµ is exact dimensional with dimension iâˆ’1
k=0 Î»k+1 .


Equivalently, for Î i âˆ— m-a.e. W , PW âŠ¥ âˆ— Âµ is exact dimensional with dimension
Piâˆ’1 hk+1 âˆ’hk
k=0 Î»k+1 .

Again since Ï€âˆ— mÎ¾x0 is strongly equivalent to Âµ for m-a.e. x, applying Lemma
2.8 to the orthogonal projection
P(Vxi )âŠ¥ : Rd â†’ (Vxi )âŠ¥ , we see that m-a.e. x, ÂµVxi ,Ï€x

is equivalent to Ï€âˆ— mÎ¾x0 V i ,Ï€x = Ï€âˆ— mÎ¾xi , and so ÂµVxi ,Ï€x is exact dimensional with
x

Psâˆ’1 hk+1 âˆ’hk
dimension k=i
.
Equivalently,
for
Î 
m-a.e. W and Âµ-a.e. z, ÂµW,z is exact
i
Î»k+1
âˆ—
Psâˆ’1 hk+1 âˆ’hk
. Recall that we have proved that for
dimensional with dimension
k=i
Î»k+1


P
hk+1 âˆ’hk
Î i âˆ— m-a.e. W , PW âŠ¥ âˆ— Âµ is exact dimensional with dimension iâˆ’1
k=0 Î»k+1 . This
is enough to conclude (ii).

48

DE-JUN FENG

Finally, we prove (iii). Suppose that m is sub-multiplicative. By Lemma 6.2(ii),
for m-a.e. x âˆˆ Î£â€² , Ï€âˆ— mÎ¾x0 is absolutely continuous with respect to Âµ. Hence there
exists H âŠ‚ Î£â€² with full m-measure such that for any x âˆˆ H, there exists a Borel
set Fx âŠ‚ Rd with positive Âµ-measure such that (Ï€âˆ— mÎ¾x0 )Fx is strongly equivalent to
ÂµFx , where Î½A stands for the probability measure defined by Î½A (Â·) = Î½(A âˆ© Â·)/Î½(A).
As is proved in part (ii), when m is quasi-Bernoulli, we can take Fx = Î£â€² .
Now fix x âˆˆ H and i âˆˆ {1, . . . , s âˆ’ 1}. Set W = Vxi and write for convenience


Î· := Ï€âˆ— mÎ¾x0 , Î· â€² := (Ï€âˆ— mÎ¾x0 )Fx , Âµâ€² := ÂµFx .

Applying Lemma 2.9 to the projection PW âŠ¥ : Rd â†’ Rd and using the Borel density
lemma, we see that for Âµ-a.e. z âˆˆ Fx (equivalently for Î·-a.e. z âˆˆ Fx ),
dimloc ((Î· â€² )W,z , z) = dimloc (Î·W,z , z),
(6.28)

dimloc
dimloc

dimloc ((Âµâ€² )W,z , z) = dimloc (ÂµW,z , z),




PW âŠ¥ âˆ— Î· â€² , PW âŠ¥ (z) = dimloc PW âŠ¥ âˆ— Î·, PW âŠ¥ (z) ,




PW âŠ¥ âˆ— Âµâ€² , PW âŠ¥ (z) = dimloc PW âŠ¥ âˆ— Âµ, PW âŠ¥ (z) .

Since Î· â€² and Âµâ€² are strongly equivalent, by Lemma 2.8, for Âµ-a.e. z âˆˆ Fx ,
dimloc

dimloc ((Î· â€² )W,z , z) = dimloc ((Âµâ€² )W,z , z),




PW âŠ¥ âˆ— Î· â€² , PW âŠ¥ (z) = dimloc PW âŠ¥ âˆ— Âµâ€² , PW âŠ¥ (z) .

Combining the above equalities with (6.28) yields that for Âµ-a.e. z âˆˆ Fx ,
dimloc

dimloc (ÂµW,z , z) = dimloc (Î·W,z , z),




PW âŠ¥ âˆ— Âµ, PW âŠ¥ (z) = dimloc PW âŠ¥ âˆ— Î·, PW âŠ¥ (z) .

Now (iii) follows from (i). This completes the proof of the theorem.



Proof of Theorem 1.7. Here we only give a sketched proof. It is based on [29, Theorem 2.11] and its proof.
Since the linear parts Mj of S commute, Rd can be decomposed into the direct
sum T1 âŠ• Â· Â· Â· âŠ• Tâ„“ of some subspaces with dimensions q1 , . . . , qâ„“ , so that for each pair
(j, p) âˆˆ Î› Ã— {1, . . . , â„“}, Mj Tp âŠ‚ Tp and Mj is â€œweakly conformalâ€ on Tp in the sense
that there exists aj,p â‰¥ 0 so that limnâ†’âˆ kMjn vk1/n = aj,p for v âˆˆ Tp \{0}. Hence
under a suitable coordinate change, S can be written as the direct product of some
â€œweakly conformalâ€ affine IFSs S1 , . . . , Sâ„“ on Rq1 ,. . . , Rqâ„“ (cf. [29, Definition 2.10]).
P
Set Î»p = jâˆˆÎ› m([j]) log aj,p for p = 1, . . . , â„“. Permutating Sj â€™s if necessary, we
may assume that
Î»1 â‰¥ Â· Â· Â· â‰¥ Î»â„“ .
For p âˆˆ {1, . . . , â„“} and let Ï„p be the orthogonal projection from Rd to Yp :=
Î¶
Rq1 Ã— Â· Â· Â· Ã— Rqp , and let mxp be the conditional measure of m associated with the
measurable partition {Ï€ âˆ’1 â—¦ Ï„pâˆ’1 (y) : y âˆˆ Yp } of Î£. It is implicitly proved in [29,
Theorem 2.11] that there exist hm (Ïƒ) = h0 â‰¥ h1 â‰¥ Â· Â· Â· â‰¥ hâ„“ â‰¥ 0 such that for
Î¶ 
m-a.e. x âˆˆ Î£ and p âˆˆ {1, . . . , â„“ âˆ’ 1}, the measure Ï€âˆ— mxp is exact dimensional

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

49

Pâ„“âˆ’1 hj+1 âˆ’hj
, and moreover, Âµ = Ï€âˆ— m is exact dimensional with
with dimension j=p
Î»j+1
Pâ„“âˆ’1 hj+1 âˆ’hj
. (We remark that this is only proved in [29] in the case
dimension j=0 Î»
j+1
when S is invertible and contracting. But it can be extended to the general case
like Theorem 1.6.) Applying this result to the IFS S1 Ã— Â· Â· Â· Ã— Sp gives that (Ï„p )âˆ— Âµ is
P
hj+1 âˆ’hj
exact dimensional with dimension pâˆ’1
.
j=0 Î»
j+1

Set Âµ = Ï€âˆ— m. Let {ÂµYpâŠ¥ ,z } denote the system of conditional measures of Âµ associated with the measurable partition {Ï„pâˆ’1 (y) : y âˆˆ Yp } of Rd . Similar to the proof
Î¶ 
of (6.27), we can show that for m-a.e. x âˆˆ Î£, ÂµYpâŠ¥ ,Ï€x = Ï€âˆ— mxp . It follows that Âµ
is dimension conserving with respect to the projection Ï„p . Moreover, ÂµYpâŠ¥ ,z is exact
dimensional for Âµ-a.e z.
Now let 1 â‰¤ p1 < Â· Â· Â· < psâ€² = â„“ be those integers so that
Î»1 = Â· Â· Â· = Î»p1 > Î»p1 +1 = Â· Â· Â· = Î»p2 > Â· Â· Â· > Î»psâ€² âˆ’1 +1 = Â· Â· Â· = Î»psâ€² .

It is readily checked that s = sâ€² , Î»i = Î»pi and Vxi = Wi := YpâŠ¥i for 1 â‰¤ i â‰¤ s and
m-a.e x. In particular, P(Wi )âŠ¥ = Ï„pi for i = 1, . . . , s âˆ’ 1. Hence Âµ is dimension
conserving with respect to the projections P(Wi )âŠ¥ , i = 1, . . . , s âˆ’ 1.

Remark 6.3. The proof of Theorem 1.7 implies the following result: Let S =
{Sj (x) = rj x + aj }jâˆˆÎ› be a self-similar IFS on Rd with rj > 0, average contracting
with respect to an ergodic m âˆˆ MÏƒ (Î£). Then for any proper subspace W of Rd , Ï€âˆ— m
is dimension conserving with respect to PW . This generalizes the result in [25, 34].
To see it, let p = dim W and let v1 , . . . , vd be an orthonormal basis of Rd such that
span(v1 , . . . , vp ) = W . Then one can check that S can be written as the product
S1 Ã— Â· Â· Â· Ã— Sd of some one-dimensional IFSs on X1 , . . . , Xd , where Xi = span(vi ), and
moreover Î»1 = Â· Â· Â· = Î»d . Now the desired dimension conservation property follows
from the proof of Theorem 1.7.
7. Lyapunov dimension
Throughout this section, let m be an ergodic Ïƒ-invariant measure on Î£ and M =
(Mj )jâˆˆÎ› be a tuple of d Ã— d real matrices satisfying
Z
1
Î»(M, m) := lim
log kMx0 Â· Â· Â· Mxnâˆ’1 k dm(x) < 0.
nâ†’âˆ n
Let S = {Sj (x) = Mj x + aj }jâˆˆÎ› be an affine IFS on Rd . Let {(Î»i , ki )}1â‰¤iâ‰¤s be the
Lyapunov spectrum of M with respect to (Î£, Ïƒ âˆ’1 , m). Set
L0 = 0

and

Li = âˆ’

i
X

Î»â„“ kâ„“ for i = 1, . . . , s.

â„“=1

Clearly L0 < L1 < Â· Â· Â· < Ls . Following [42], we give the following.

50

DE-JUN FENG

Definition 7.1. The Lyapunov dimension of m with respect to M, denoted as
dimLY (m, M), is defined to be
ï£±
!
jâˆ’1
ï£´
X
hm (Ïƒ) âˆ’ Ljâˆ’1
ï£´
ï£´
ï£´
if Ljâˆ’1 â‰¤ hm (Ïƒ) < Lj for some j âˆˆ {1, . . . , s},
kâ„“ +
ï£´
ï£²
(âˆ’Î»
j)
â„“=0
ï£´
ï£´
ï£´
d hm (Ïƒ)
ï£´
ï£´
ï£³
Ls

if hm (Ïƒ) â‰¥ Ls .

Let Ï€ be the coding map associated with S. Recall that hi , 0 â‰¤ i â‰¤ s, are the
conditional entropies of m defined in (1.5), and h0 = hm (Ïƒ). The following result
says that the Lyapunov dimension of m is always an upper bound for the Hausdorff
dimension of Ï€âˆ— m. This result was first proved in [42] under a stronger assumption
that kMj k < 1 for all j.
Proposition 7.2. dimH Ï€âˆ— m â‰¤ min{d, dimLY (m, M)}. Moreover, the equality holds
if and only if one of the following holds:
(1) hm (Ïƒ) â‰¥ Ls , and hi = hm (Ïƒ) âˆ’ Li for all i âˆˆ {1, . . . , s}.
(2) hm (Ïƒ) âˆˆ [Ljâˆ’1 , Lj ) for some j âˆˆ {1, . . . , s}, and

hm (Ïƒ) âˆ’ Li if 1 â‰¤ i â‰¤ j âˆ’ 1,
hi =
0
if j â‰¤ i â‰¤ s.
Proof. Since Î»(M, m) < 0, the IFS S is average contracting with repect to m. By
Psâˆ’1 hi+1 âˆ’hi
. Recall that
Theorem 1.3, dimH Ï€âˆ— m = i=0
Î»i+1
0 > Î»(M, m) = Î»1 > Â· Â· Â· > Î»s â‰¥ âˆ’âˆ,

and
hm (Ïƒ) = h0 â‰¥ h1 â‰¥ Â· Â· Â· â‰¥ hs â‰¥ 0.
Moreover by Corollary 6.1, hi âˆ’ hi+1 â‰¤ (âˆ’Î»i+1 )ki+1 for each i. Hence dimH Ï€âˆ— m is
bounded above by
)
( sâˆ’1
X xi+1 âˆ’ xi
xi+1 âˆ’ xi
: hm (Ïƒ) = x0 â‰¥ Â· Â· Â· â‰¥ xs â‰¥ 0,
â‰¤ ki+1 for all i .
âˆ† := max
Î»i+1
Î»i+1
i=0
Now it is readily checked that the following hold: (a) if hm (Ïƒ) â‰¥ Ls , then âˆ† = d
and the maximum in defining âˆ† is attained uniquely at (x0 , x1 , . . . , xs ) where xi =
hm (Ïƒ) âˆ’ Li for 0 â‰¤ i â‰¤ s; (b) if hm (Ïƒ) âˆˆ [Ljâˆ’1 , Lj ) for some j âˆˆ {1, . . . , s}, then
!
jâˆ’1
X
hm (Ïƒ) âˆ’ Ljâˆ’1
kâ„“ +
âˆ†=
,
(âˆ’Î»j )
â„“=0
and the maximum is attained uniquely at (x1 , . . . , xs ) where xi = hm (Ïƒ) âˆ’ Li for
i â‰¤ j âˆ’ 1 and 0 for i â‰¥ j. As a consequence, the results of the proposition hold. 

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

51

Remark 7.3. By Proposition 7.2, if dimH Ï€âˆ— m = min{d, dimLY (m, M)}, then
j
X
hâ„“ âˆ’ hâ„“âˆ’1
â„“=1

Î»â„“

= min{k1 + Â· Â· Â· + kj , dimH Ï€âˆ— m}

for j = 1, . . . , s.

This result was partially proved in [4, Corollay 2.7].
Proposition 7.4. Suppose that S is contracting and satisfies the strong separation
condition. Then the following statements hold.
(i) hs = 0, hm (Ïƒ) < Ls and dimLY (m, M) < d.
(ii) Let j be the unique element in {1, . . . , s} so that Ljâˆ’1 â‰¤ hm (Ïƒ) < Lj . Then
dimH Ï€âˆ— m = dimLY (m, M) if and only if
(7.1)

jâˆ’1
X
hâ„“ âˆ’ hâ„“âˆ’1
â„“=1

Î»â„“

= djâˆ’1,

s
X
hâ„“ âˆ’ hâ„“âˆ’1
= 0,
Î»
â„“
â„“=j+1

where d0 := 0 and di := k1 + Â· Â· Â· + ki for 1 â‰¤ i â‰¤ s.

Proof. (i) We first claim that hs = 0. Since S satisfies the strong separation condition, Î¾s (x) = {x} for each x âˆˆ Î£â€² . Thus Î¾bs = B(Î£â€² ) and hence hs = Hm (P|Î¾bs ) = 0.

Next we prove that hm (Ïƒ) < Ls . Clearly this is true if Ls = âˆ (equivalently, if
Î»s = âˆ’âˆ). Below we assume that Î»s > âˆ’âˆ.
Let K denote the self-affine set generated by S. For Î´ > 0 let KÎ´ be the closed
Î´-neighborhood of K, i.e. KÎ´ = {z : d(z, K) â‰¤ Î´}. Since S satisfies the strong
separation condition, we can pick a small Î´ such P
that Si (KÎ´ ) (i âˆˆ Î›) are disjoint
d
d
subsets
P of the interior of KÎ´ and hence L (KÎ´ ) > iâˆˆÎ› L (Si (KÎ´ )). It follows that
Ï := iâˆˆÎ› | det(Mi )| < 1.
Since m is ergodic Ïƒ-invariant, by [31, Lemma 3.2] and the Shannon-McMillanBreiman theorem, for m-a.e. x âˆˆ Î£,
log | det(Mx0 ...xnâˆ’1 )|
log m([x0 . . . xnâˆ’1 ])
(7.2)
lim
= âˆ’Ls , lim
= âˆ’hm (Ïƒ).
nâ†’âˆ
nâ†’âˆ
n
n

For Ç« > 0 and n âˆˆ N, let Î›n,Ç« denote the set of words I of length n over the
alphabet Î› such that
| det(MI )| â‰¥ eâˆ’nLs âˆ’nÇ« , m([I]) â‰¤ eâˆ’nhm (Ïƒ)+nÇ« .
P
By (7.2), limnâ†’âˆ IâˆˆÎ›n,Ç« m([I]) = 1. Notice that
X
X
| det(MI )|
| det(MI )| â‰¥
Ïn =
IâˆˆÎ›n

â‰¥

X

IâˆˆÎ›n,Ç«

IâˆˆÎ›n,Ç«

eâˆ’nLs âˆ’nÇ«

m([I])

eâˆ’nhm (Ïƒ)+nÇ«
ï£«

= eâˆ’n(Ls âˆ’hm (Ïƒ)+2Ç«) Â· ï£­

X

IâˆˆÎ›n,Ç«

ï£¶

m([I])ï£¸ .

52

DE-JUN FENG

Letting n â†’ âˆ and Ç« â†’ 0, we obtain the desired inequality hm (Ïƒ) â‰¤ Ls +log Ï < Ls .
Now the inequality dimLY (m, M) < d follows directly from Definition 7.1. This
proves (i).
Finally we prove (ii). Since hs = 0 and 0 â‰¤ hâ„“âˆ’1 âˆ’ hâ„“ â‰¤ (âˆ’Î»â„“ )kâ„“ for each â„“
by Corollary 6.1, we see that (7.1) holds if and only if hâ„“âˆ’1 âˆ’ hâ„“ = (âˆ’Î»â„“ )kâ„“ for
1 â‰¤ â„“ â‰¤ j âˆ’ 1 and hâ„“ = 0 for j â‰¤ â„“ â‰¤ s. By Proposition 7.2, this is equivalent to
that dimH Ï€âˆ— m = dimLY (m, M).

Remark 7.5. Theorem 1.6 (resp. Theorem 1.7) can be applied to estimate the
dimension of slices and projections of certain self-affine sets. To see it, let K a selfaffine sets generated by a contracting affine IFS {Sj = Mj x + aj }jâˆˆÎ› on Rd . Suppose
that there exists an ergodic m âˆˆ MÏƒ (Î£) so that
(7.3)

dimH Ï€âˆ— m = dimH K.

Follow the notation in Theorem 1.6 and assume s â‰¥ 2. Since the slicing measures
(Ï€âˆ— (mÎ¾x0 ))Vxi ,y are supported on the slices K âˆ© (Vxi + y), by using Theorem 1.6(i)
and a general inequality in Theorem 2.10.25 of Federer [28], we obtain that for
i âˆˆ {1, . . . , s âˆ’ 1} and m-a.e. x,
dimH K âˆ© (Vxi + y) =

sâˆ’1
X
hâ„“+1 âˆ’ hâ„“
â„“=i

and
(7.4)
dimH

(

Î»â„“+1

for P(Vxi )âŠ¥ Ï€

y âˆˆ P(Vxi )âŠ¥ (K) : dimH K âˆ© (Vxi + y) =



âˆ—


mÎ¾x0 -a.e. y âˆˆ (Vxi )âŠ¥

sâˆ’1
X
hâ„“+1 âˆ’ hâ„“
â„“=i

Î»â„“+1

)

If in addition to the assumption (7.3), we further assume that

=

iâˆ’1
X
hâ„“+1 âˆ’ hâ„“
â„“=0

Î»â„“+1

.

dimH Ï€âˆ— m = dimLY (m, M),
then
(7.5)

dimH P(Vxi )âŠ¥ (K) = min{dim(Vxi )âŠ¥ , dimH K}

for m-a.e. x.

Indeed by Remark 7.3, the sum in the right-hand side of (7.4) is equal to
min{dim(Vxi )âŠ¥ , dimH Ï€âˆ— m},
and hence equal to min{dim(Vxi )âŠ¥ , dimH K}. Now (7.5) follows from (7.4).
8. Semi-continuity of entropies and dimensions
In this section, we prove Theorems 1.8-1.10. Set
âˆ
X
(8.1)
f (x) =
kMx0 Â· Â· Â· Mxnâˆ’1 k for x âˆˆ Î£.
n=1

Lemma 8.1.
Let Î· be a Borel probability measure on Î£ with Î·({f
 = âˆ}) = 0.

Then Ï€a âˆ— Î· depends continuously on a, in the sense that Ï€an âˆ— Î· converges to

Ï€a âˆ— Î· weakly when an converges to a.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

53

Proof. For x âˆˆ Î£ with f (x) < âˆ, Ï€a (x) is well-defined for every a âˆˆ Rd|Î›| and
moreover,
(8.2)

kÏ€a (x) âˆ’ Ï€b (x)k â‰¤ f (x)ka âˆ’ bk.

For N âˆˆ N, set AN := {x : f (x) < N}. Since Î·({f = âˆ}) = 0, it follows that
Î·(AN ) â†’ 1 as N â†’ âˆ.

Let (an ) âŠ‚ Rd|Î›| so that limnâ†’âˆ an = a. For convenience, write Î½n = Ï€an âˆ— Î· and

Î½ = Ï€a âˆ— Î·. To show that Î½n converges weakly to Î½, by the Portmanteau theorem,
it suffices to show that lim supnâ†’âˆ Î½n (F ) â‰¤ Î½(F ) for any compact set F âŠ‚ Rd .

Now fix a compact set F âŠ‚ Rd . Let Ç« > 0. Take a small r > 0 so that Î½(Vr (F )) â‰¤
Î½(F ) + Ç«, where Vr (F ) stands for the r-neighborhood of F . Take a large N so that
Î·(Î£ \ AN ) < Ç«. Pick n0 so that kan âˆ’ ak < r/N when n â‰¥ n0 .

By (8.2), for x âˆˆ AN and n â‰¥ n0 we have kÏ€an (x) âˆ’ Ï€a (x)k â‰¤ Nkan âˆ’ ak < r.
Hence AN âˆ© Ï€aâˆ’1
(F ) âŠ‚ AN âˆ© Ï€aâˆ’1 (Vr (F )) for n â‰¥ n0 . It follows that for n â‰¥ n0 ,
n
(F ))
Î½n (F ) = Î·(Ï€aâˆ’1
n
(F ))
â‰¤ Î·(Î£ \ AN ) + Î·(AN âˆ© Ï€aâˆ’1
n
â‰¤ Ç« + Î·(AN âˆ© Ï€aâˆ’1 (Vr (F )))
â‰¤ Ç« + Î½(Vr (F ))
â‰¤ Î½(F ) + 2Ç«.
Hence lim supnâ†’âˆ Î½n (F ) â‰¤ Î½(F ) + 2Ç«. Letting Ç« â†’ 0 gives lim supnâ†’âˆ Î½n (F ) â‰¤
Î½(F ), as desired.

Proof of Theorem 1.8. We first prove part (1) of the theorem. This is done by
extending an idea of Rapaport [64, Lemma 8].
It is implicitly proved in Proposition 3.1 that m({f = âˆ}) = 0, where f is defined
as in (8.1). Let i âˆˆ {1, . . . , s} and write Î¾i,a for Î¾i so as to emphasize its dependence
on a. Since
Z
0 = m({f = âˆ}) = mÎ¾xi,a ({f = âˆ})dm(x),
n
o
Î¾
the set âˆ†a := x âˆˆ Î£â€² : mxi,a ({f = âˆ}) = 0 has full m-measure.

Noticing that Î¾0 is independent of a, and Î¾i,a is a refinement of Î¾0 (i.e. any set in
Î¾i,a is a subset of an element in Î¾0 ), we have
hi,a = Hm (P|Î¾i,a )
Z
= âˆ’ log mÎ¾xi,a (P(x)) dm(x)
Z Z
=
âˆ’ log mÎ¾yi,a (P(y)) dmÎ¾x0 (y) dm(x)
Z
= HmÎ¾x0 (P|Î¾i,a ) dm(x).

54

DE-JUN FENG

Fix a0 âˆˆ Rd|Î›| . In what follows we show that
R hi,a is upper semi-continuous in a
at a0 . Since âˆ†a0 has full m-measure, hi,a = âˆ†a HmÎ¾x0 (P|Î¾i,a ) dm(x). Hence it is
0
sufficient to show that a 7â†’ HmÎ¾x0 (P|Î¾i,a ) is upper semi-continuous at a0 for every
x âˆˆ âˆ†a0 . For this purpose, fix x âˆˆ âˆ†a0 and write C = Î¾0 (x), W = Vxi and mC = mÎ¾x0 .
Then by the definition of Î¾i,a ,
âˆ’1
âŠ¥
HmÎ¾x0 (P|Î¾i,a ) = HmC (P|Ï€aâˆ’1 â—¦ PW
âŠ¥ (B(W ))).

Following the proof of [71, Lemma 8.5] or [64, Lemma 8] with minor changes, we
can construct a sequence (Î²n ) of finite Borel partitionsSof W âŠ¥ such that (i) Ïƒ(Î²n ) â†‘
âˆ’1
âŠ¥
B(W âŠ¥ ) and (ii) mC â—¦ Ï€aâˆ’1
(PW
âŠ¥ (âˆ‚B)) = 0 for any B âˆˆ
n Î²n . Since Ïƒ(Î²n ) â†‘ B(W ),
0
âˆ’1
âŠ¥
âˆ’1
âˆ’1
HmC (P|Ï€aâˆ’1 â—¦ PW
â—¦ PW
âŠ¥ (B(W )) = lim HmC (P|Ï€a
âŠ¥ (Ïƒ(Î²n ))
nâ†’âˆ
"
X X

âˆ’1
u (mC |A ) â—¦ Ï€aâˆ’1 (PW
= lim
âŠ¥ (B))
nâ†’âˆ

AâˆˆP BâˆˆÎ²n

âˆ’

X

âˆ’1
u mC â—¦ Ï€aâˆ’1 (PW
âŠ¥ (B))

BâˆˆÎ²n



#

,

where u(z) := âˆ’z log z and mC |A (E) = mC (A âˆ© E). Since x âˆˆ âˆ†a0 , mC ({f =
âˆ}) = 0. By Lemma 8.1, the measures (Ï€a)âˆ— (mC ) and (Ï€a )âˆ— (mC |A ) (A âˆˆ P)
depend continuously on a; and so do PW âŠ¥ Ï€a âˆ— (mC ) and PW âŠ¥ Ï€a âˆ— (mC |A ). For
S
âˆ’1
A âˆˆ P and B âˆˆ n Î²n , since mC â—¦ Ï€aâˆ’1
(PW
âŠ¥ (âˆ‚B)) = 0, we have also (mC |A ) â—¦
0

âˆ’1
âˆ’1
âˆ’1
âˆ’1
(P
(B))
and
Ï€a0 (PW âŠ¥ (âˆ‚B)) = 0; it follows
that,
as
functions
of
a,
u
m
â—¦
Ï€
C
âŠ¥
a
W

âˆ’1
âˆ’1
âˆ’1
u (mC |A ) â—¦ Ï€a (PW âŠ¥ (B)) (A âˆˆ P) are continuous at a0 , and so is HmC (P|Ï€a â—¦
âˆ’1
âˆ’1
âŠ¥
âˆ’1
PW
â—¦ PW
âŠ¥ (Ïƒ(Î²n )). Hence a 7â†’ HmC (P|Ï€a
âŠ¥ (B(W )) is upper semi-continuous at
a0 , as desired. This proves the upper semi-continuity of hi,a .
Next we prove the lower semi-continuity of the mapping a 7â†’ dimH ((Ï€a )âˆ— m). By
Theorem 1.3, we have
(8.3)

dimH ((Ï€a )âˆ— m) =

s
X

ti hi,a ,

i=0

1
for i = 1, . . . , s, with convention Î»s+1 := âˆ’âˆ.
where t0 = âˆ’ Î»11 and ti = Î»1i âˆ’ Î»i+1
Notice that t0 > 0, ti â‰¤ 0 for 1 â‰¤ i â‰¤ s and moreover, h0,a â‰¡ hÏƒ (m). By part (1),
h1,a , . . . , hs,a are upper semi-continuous in a. Hence by (8.3), dimH ((Ï€a )âˆ— m) is lower
semi-continuous in a.


Remark 8.2. Theorem 1.8 can be further extended. For given m and M = (Mj )jâˆˆÎ› ,
let Sr,a denote the IFS {rj Mj x + aj }jâˆˆÎ› where r = (rj )jâˆˆÎ› âˆˆ (R\{0})Î› so that Sr,a
is average contracting with respect to m. Notice that the Oseledets subspaces with
respect to m and (rj Mj )jâˆˆÎ› are independent of r. A slight modification of the
above proof establishes the upper semi-continuity of (r, a) 7â†’ hi,r,a and the lower
semi-continuity of (r, a) 7â†’ dimH ((Ï€r,a )âˆ— m).

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

55

Similarly, for given m let Sr,O,a denote the IFS {rj Oj x + aj }jâˆˆÎ› of similitudes,
where r = (rj )jâˆˆÎ› âˆˆ (R\{0})Î› , O = (Oj )jâˆˆÎ› âˆˆ O(d)Î› , a = (aj )jâˆˆÎ› âˆˆ Rd|Î›| so that
Sr,O,a is average contracting with respect to m. Then the mapping (r, O, a) 7â†’
dimH ((Ï€r,O,a )âˆ— m) is lower semi-continuous.
Proof of Theorem 1.9. We first prove (i). Let m be an ergodic Ïƒ-invariant measure
m on Î£. For n âˆˆ N, set


1
d|Î›|
.
â„¦n := a âˆˆ R
: dimH ((Ï€a )âˆ— m) â‰¤ min(d, dimLY (m, M)) âˆ’
n
Since dimH ((Ï€a )âˆ— m) is lower semi-continuous in a by Theorem 1.8, â„¦n is closed for
each n. Meanwhile, it was proved in [42] that dimH ((Ï€a )âˆ— m) = min(d, dimLY (m, M))
for Ld|Î›| -a.e. a. Hence for each n, â„¦n is a closed set of zero Lebesgue measure, so it
is nowhere dense. This is enough to conclude (i).
Next we prove (ii). It was shown by KaÌˆenmaÌˆki [43] that there exists an ergodic
Ïƒ-invariant measure Î· on Î£ such that dimLY (Î·, M) = dimAFF (M). Fix such Î·. Note
that for each a,
dimH ((Ï€a )âˆ— Î·) â‰¤ dimH K(M, a) â‰¤ min(d, dimAFF (M)).
It implies that

a âˆˆ Rd|Î›| : dimH K(M, a) 6= min(d, dimAFF (M))

âŠ‚ a âˆˆ Rd|Î›| : dimH ((Ï€a )âˆ— Î·) 6= min(d, dimLY (Î·, M)) .

Now (ii) follows from (i).



To prove Theorem 1.10 we need the following.
Lemma 8.3 ([64, Lemma 22]). Let Âµ be a probability Borel measure on Rd and
1 â‰¤ k < d. Then the following statements hold.
(i) If dimH Âµ â‰¤ k then for 0 < t â‰¤ dimH Âµ,
dimH {W âˆˆ G(d, k) : dimH ((PW )âˆ— Âµ) < t} â‰¤ k(d âˆ’ k âˆ’ 1) + t.
(ii) If dimH Âµ â‰¥ k then for dimH Âµ âˆ’ k(d âˆ’ k) < t â‰¤ k,
dimH {W âˆˆ G(d, k) : dimH ((PW )âˆ— Âµ) < t} â‰¤ k(d âˆ’ k) + t âˆ’ dimH Âµ.
Proof of Theorem 1.10. The proof is mainly adapted from [64]. For the convenience
of the reader, we include the details. Write Âµ = Ï€âˆ— m. Since S satisfies
P the strong
separation condition, by Proposition 7.4 we have hs = 0, hm (Ïƒ) < sâ„“=1 (âˆ’Î»â„“ )kâ„“
and dimLY (m, M) < d. Let i be the unique element in {1, . . . , s} so that diâˆ’1 â‰¤
dimLY (m, M) < di . (Recall that d0 = 0 and dj = k1 + Â· Â· Â· + kj for j â‰¥ 1.) By
P
Definition 7.1, we have hm (Ïƒ) âˆˆ [Liâˆ’1 , Li ) where L0 := 0 and Lj := âˆ’ jâ„“=1 Î»â„“ kâ„“ for
j â‰¥ 1. Below we prove the equality dimH Âµ = dimLY (m, M) under the assumption
that one of the scenarios (a), (b), (c) occurs.

56

DE-JUN FENG

We first consider the scenario (a). In this case, s = 1 and by Theorem 1.3,
dimH Âµ =

hm (Ïƒ)
h1 âˆ’ h0
=âˆ’
= dimLY (m, M).
Î»1
Î»1

Next we consider the scenario (b). In this case, i = s and so hm (Ïƒ) âˆˆ [Lsâˆ’1 , Ls ).
To show that dimH Ï€âˆ— m = dimLY (m, M), it suffices to show that
hsâˆ’1 = hm (Ïƒ) + k1 Î»1 + Â· Â· Â· + ksâˆ’1 Î»sâˆ’1 .
Psâˆ’1
Indeed if (8.4) holds, then h0 âˆ’ hsâˆ’1 = â„“=1
(âˆ’Î»â„“ )kâ„“ , which forces that hâ„“âˆ’1 âˆ’ hâ„“ =
(âˆ’Î»â„“ )kâ„“ for 1 â‰¤ â„“ â‰¤ s âˆ’ 1 (recalling that hâ„“âˆ’1 âˆ’ hâ„“ â‰¤ (âˆ’Î»â„“ )kâ„“ for all 1 â‰¤ â„“ â‰¤ s by
Corollary 6.1); hence
sâˆ’1
X
hâ„“ âˆ’ hâ„“âˆ’1
= dsâˆ’1 ,
Î»â„“
â„“=1

(8.4)

so (7.1) holds for j = s, then by Proposition 7.4, we obtain that dimH Âµ = dimLY (m, M).
To show (8.4) we first prove that
(8.5)

hsâˆ’1 â‰¥ hm (Ïƒ) + k1 Î»1 + Â· Â· Â· + ksâˆ’1 Î»sâˆ’1 .

To see this, replacing S by one of its iterations if necessary, we may assume that
kMj k < 1/2 for all j âˆˆ Î›. By Theorem 1.9 in [42], for Ld|Î›| -a.e. a âˆˆ Rd|Î›| ,
dimH ((Ï€a )âˆ— m) = dimLY (m, M).
Hence by Proposition 7.2, for Ld|Î›| -a.e. a âˆˆ Rd|Î›| ,
hsâˆ’1,a = hm (Ïƒ) + k1 Î»1 + Â· Â· Â· + ksâˆ’1Î»sâˆ’1 ,
here and in the next sentence, we write hsâˆ’1,a = hsâˆ’1 to indicate its dependence
on a. Since hsâˆ’1,a is upper semi-continuous in a by Theorem 1.8, it follows that
hsâˆ’1,a â‰¥ hm (Ïƒ) + k1 Î»1 + Â· Â· Â· + ksâˆ’1 Î»sâˆ’1 for all a âˆˆ Rd|Î›| . This proves (8.5).
Now suppose on the contrary that (8.4) does not hold. Then by (8.5), there exists
Î´ > 0 such that hsâˆ’1 = hm (Ïƒ) + k1 Î»1 + Â· Â· Â· + ksâˆ’1 Î»sâˆ’1 + Î´. By Theorem 1.6 (iii), for
(Î sâˆ’1 )âˆ— m-a.e. W âˆˆ G(d, d âˆ’ dsâˆ’1 ),
dimH ((PW âŠ¥ )âˆ— Âµ) â‰¤

sâˆ’1
X
hâ„“ âˆ’ hâ„“âˆ’1
â„“=1

Î»â„“

hs âˆ’ hsâˆ’1
Î»s
hsâˆ’1
= dimH Âµ âˆ’
(âˆ’Î»s )
= dimH Âµ + dsâˆ’1 âˆ’ dimLY (m, M) âˆ’ Î´/(âˆ’Î»s ),
= dimH Âµ âˆ’

where in the last equality, we use the fact that
dimLY (m, M) = dsâˆ’1 +

h0 âˆ’ Lsâˆ’1
hsâˆ’1 âˆ’ Î´
= dsâˆ’1 +
.
(âˆ’Î»s )
(âˆ’Î»s )

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

57

Let Y denote the set of W âˆˆ G(d, d âˆ’ dsâˆ’1) such that
dimH ((PW âŠ¥ )âˆ— Âµ) â‰¤ dimH Âµ + dsâˆ’1 âˆ’ dimLY (m, M) âˆ’ Î´/(âˆ’Î»s ).
Then m â—¦ (Î sâˆ’1 )âˆ’1 (Y) = 1, so by (1.12),
(8.6)

dimH Y â‰¥ dimâˆ—H ((Î sâˆ’1 )âˆ— m)
â‰¥ dsâˆ’1(d âˆ’ dsâˆ’1) + dsâˆ’1 âˆ’ dimLY (m, M).

On the other hand, we can get an upper bound estimate for dimH Y by using Lemma
8.3. Indeed, if dimH Âµ â‰¤ dsâˆ’1 , then by Lemma 8.3(i) applied to k = dsâˆ’1 and
t = dimH Âµ + dsâˆ’1 âˆ’ dimLY (m, M) âˆ’ Î´/(âˆ’Î»s ), we see that
dimH Y â‰¤ dsâˆ’1 (d âˆ’ dsâˆ’1 ) + dimH Âµ âˆ’ dimLY (m, M) âˆ’ Î´/(âˆ’Î»s )
â‰¤ dsâˆ’1 (d âˆ’ dsâˆ’1 ) + dsâˆ’1 âˆ’ dimLY (m, M) âˆ’ Î´/(âˆ’Î»s );
Conversely if dimH Âµ > dsâˆ’1 , then by Lemma 8.3(ii) applied to k = dsâˆ’1 and t =
dimH Âµ + dsâˆ’1 âˆ’ dimLY (m, M) âˆ’ Î´/(âˆ’Î»s ), we get the same upper bound for dimH Y,
which contradicts with (8.6). This proves (8.4).
Finally we consider the scenario (c). In this case, hm (Ïƒ) âˆˆ [Liâˆ’1 , Li ). Clearly the
assumptions (1.13)-(1.14) imply that
diâˆ’1 â‰¤ dimH Âµ â‰¤ dimLY (m, M) â‰¤ di .
To prove dimH Âµ = dimLY (m, M), by Proposition 7.4 it suffices to prove that
P
Piâˆ’1 hâ„“ âˆ’hâ„“âˆ’1
â„“âˆ’1
= diâˆ’1 and sâ„“=i+1 hâ„“ âˆ’h
= 0. As d0 = 0, the first equality holds
â„“=1
Î»â„“
Î»â„“
automatically when i = 1.
Piâˆ’1 hâ„“ âˆ’hâ„“âˆ’1
Now we first prove that
= diâˆ’1 . To avoid triviality, we assume
â„“=1
Î»â„“
that i â‰¥ 2. For n âˆˆ N, let Xn denote the set of W âˆˆ G(d, d âˆ’ diâˆ’1 ) so that
dimH ((PW âŠ¥ )âˆ— Âµ) < diâˆ’1 âˆ’ 1/n. By Lemma 8.3(ii) applied to k = diâˆ’1 and t =
diâˆ’1 âˆ’ 1/n,
dimH Xn â‰¤ diâˆ’1 (d âˆ’ diâˆ’1 ) + diâˆ’1 âˆ’ (1/n) âˆ’ dimH Âµ
< dimâˆ—H ((Î iâˆ’1 )âˆ— m)

(by (1.14)).

It follows that m â—¦ (Î iâˆ’1 )âˆ’1 (Xn ) < 1 and hence dimH ((PW âŠ¥ )âˆ— Âµ) > diâˆ’1 âˆ’ 1/n on a
set of positive (Î iâˆ’1 )âˆ— m-measure. However by Theorem 1.6(iii),
(8.7)

dimH ((PW âŠ¥ )âˆ— Âµ) â‰¤

iâˆ’1
X
hâ„“ âˆ’ hâ„“âˆ’1
â„“=1

Î»â„“

for (Î iâˆ’1 )âˆ— m-a.e. W .

Piâˆ’1 hâ„“ âˆ’hâ„“âˆ’1
â‰¥ diâˆ’1 âˆ’ 1/n. As n is arbitrary, we obtain that
It follows that
â„“=1
Î»â„“
Piâˆ’1 hâ„“ âˆ’hâ„“âˆ’1
â‰¥ diâˆ’1 . Since hâ„“âˆ’1 âˆ’ hâ„“ â‰¤ (âˆ’Î»â„“ )kâ„“ for each â„“ by Corollary 6.1, we
â„“=1
Î»â„“
Piâˆ’1
hâ„“ âˆ’hâ„“âˆ’1
have â„“=1 Î»â„“ = diâˆ’1 , as desired.
P
h âˆ’h
Next we prove that sâ„“=i+1 â„“ Î»â„“â„“âˆ’1 = 0. For n âˆˆ N, let Zn denote the set of
W âˆˆ G(d, d âˆ’ di ) so that dimH ((PW âŠ¥ )âˆ— Âµ) < dimH Âµ âˆ’ 1/n. By Lemma 8.3(i) applied

58

DE-JUN FENG

to k = di and t = dimH Âµ âˆ’ 1/n,
dimH Zn â‰¤ di (d âˆ’ di ) âˆ’ di + dimH Âµ âˆ’ (1/n)
â‰¤ di (d âˆ’ di ) âˆ’ di + dimLY (m, M) âˆ’ (1/n)
< dimâˆ—H ((Î i )âˆ— m)

(by (1.13)).

Hence mâ—¦(Î i )âˆ’1 (Zn ) < 1 and so dimH ((PW âŠ¥ )âˆ— Âµ) > dimH Âµâˆ’1/n on a set of positive
(Î i )âˆ— m-measure. This combining with (8.7) (in which we replace i âˆ’ 1 by i) yields
P
Pi hâ„“ âˆ’hâ„“âˆ’1
â„“âˆ’1
that iâ„“=1 hâ„“ âˆ’h
â‰¥
dim
Âµ
âˆ’
1/n.
Letting
n
â†’
âˆ
gives
â‰¥ dimH Âµ,
H
â„“=1
Î»â„“
Î»â„“
Ps
hâ„“ âˆ’hâ„“âˆ’1
which, together with (1.6), implies that â„“=i+1 Î»â„“
= 0. This completes the
proof of the theorem.

Acknowledgements. The author is indebted to Julien Barral, Xiong Jin, FrancÌ§ois
Ledrappier and Ariel Rapaport for some helpful comments, and to Yufeng Wu for
catching many typos. He thanks the anonymous referees for many suggestions that
led to the improvement of the paper. This research was partially supported by a
HKRGC GRF grant and the Direct Grant for Research in CUHK.
References
[1] K. BaranÌski. Hausdorff dimension of the limit sets of some planar geometric constructions.
Adv. Math., 210(1):215â€“245, 2007.
[2] B. BaÌraÌny. On the Ledrappier-Young formula for self-affine measures. Math. Proc. Cambridge
Philos. Soc., 159(3):405â€“432, 2015.
[3] B. BaÌraÌny, M. Hochman, and A. Rapaport. Hausdorff dimension of planar self-affine sets and
measures. Invent. Math., 216(3):601â€“659, 2019.
[4] B. BaÌraÌny and A. KaÌˆenmaÌˆki. Ledrappier-Young formula and exact dimensionality of self-affine
measures. Adv. Math., 318:88â€“129, 2017.
[5] B. BaÌraÌny, A. KaÌˆenmaÌˆki, and H. Koivusalo. Dimension of self-affine sets for fixed translation
vectors. J. Lond. Math. Soc. (2), 98(1):223â€“252, 2018.
[6] B. BaÌraÌny and M. Rams. Dimension maximizing measures for self-affine systems. Trans. Amer.
Math. Soc., 370(1):553â€“576, 2018.
[7] B. BaÌraÌny, M. Rams, and K. Simon. On the dimension of self-affine sets and measures with
overlaps. Proc. Amer. Math. Soc., 144(10):4427â€“4440, 2016.
[8] B. BaÌraÌny, M. Rams, and K. Simon. Dimension of the repeller for a piecewise expanding affine
map. preprint, arXiv:1803.03788, 2018.
[9] J. Barral and D.-J. Feng. Multifractal formalism for almost all self-affine measures. Comm.
Math. Phys., 318(2):473â€“504, 2013.
[10] L. Barreira, Y. Pesin, and J. Schmeling. Dimension and product structure of hyperbolic measures. Ann. of Math. (2), 149(3):755â€“783, 1999.
[11] T. Bedford. Crinkly curves, markov partitions and box dimensions in self-similar sets. PhD
Thesis, The University of Warwick, 1984.
[12] T. Bedford. Applications of dynamical systems theory to fractalsâ€”a study of cookie-cutter
Cantor sets. In Fractal geometry and analysis (Montreal, PQ, 1989), volume 346 of NATO
Adv. Sci. Inst. Ser. C Math. Phys. Sci., pages 1â€“44. Kluwer Acad. Publ., Dordrecht, 1991.
[13] J. Bochi and I. D. Morris. Equilibrium states of generalised singular value potentials and
applications to affine iterated function systems. Geom. Funct. Anal., 28(4):995â€“1028, 2018.
[14] P. Bougerol and N. Picard. Strict stationarity of generalized autoregressive processes. Ann.
Probab., 20(4):1714â€“1730, 1992.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

59

[15] R. Bowen. Equilibrium states and the ergodic theory of Anosov diffeomorphisms. Lecture
Notes in Mathematics, Vol. 470. Springer-Verlag, Berlin-New York, 1975.
[16] A. Brandt. The stochastic equation Yn+1 = An Yn + Bn with stationary coefficients. Adv. in
Appl. Probab., 18(1):211â€“220, 1986.
[17] Y.-L. Cao, D.-J. Feng, and W. Huang. The thermodynamic formalism for sub-additive potentials. Discrete Contin. Dyn. Syst., 20(3):639â€“657, 2008.
[18] T. Das and D. Simmons. The Hausdorff and dynamical dimensions of self-affine sponges: a
dimension gap result. Invent. Math., 210(1):85â€“134, 2017.
[19] J.-P. Eckmann and D. Ruelle. Ergodic theory of chaos and strange attractors. Rev. Modern
Phys., 57(3, part 1):617â€“656, 1985.
[20] M. Einsiedler and T. Ward. Ergodic theory with a view towards number theory, volume 259 of
Graduate Texts in Mathematics. Springer-Verlag London, Ltd., London, 2011.
[21] K. J. Falconer. The Hausdorff dimension of self-affine fractals. Math. Proc. Cambridge Philos.
Soc., 103(2):339â€“350, 1988.
[22] K. J. Falconer. Techniques in fractal geometry. John Wiley & Sons, Ltd., Chichester, 1997.
[23] K. J. Falconer. Fractal geometryâ€“Mathematical foundations and applications. John Wiley &
Sons, Inc., Hoboken, NJ, second edition, 2003.
[24] K. J. Falconer. Dimensions of self-affine sets: a survey. In Further developments in fractals
and related fields, Trends Math., pages 115â€“134. BirkhaÌˆuser/Springer, New York, 2013.
[25] K. J. Falconer and X. Jin. Exact dimensionality and projections of random self-similar measures and sets. J. Lond. Math. Soc. (2), 90(2):388â€“412, 2014.
[26] K. J. Falconer and T. Kempton. Planar self-affine sets with equal Hausdorff, box and affinity
dimensions. Ergodic Theory Dynam. Systems, 38(4):1369â€“1388, 2018.
[27] A.-H. Fan, K.-S. Lau, and H. Rao. Relationships between different dimensions of a measure.
Monatsh. Math., 135(3):191â€“201, 2002.
[28] H. Federer. Geometric measure theory. Springer-Verlag New York Inc., New York, 1969.
[29] D.-J. Feng and H. Hu. Dimension theory of iterated function systems. Comm. Pure Appl.
Math., 62(11):1435â€“1500, 2009.
[30] D.-J. Feng and A. KaÌˆenmaÌˆki. Equilibrium states of the pressure function for products of
matrices. Discrete Contin. Dyn. Syst., 30(3):699â€“708, 2011.
[31] D.-J. Feng and P. Shmerkin. Non-conformal repellers and the continuity of pressure for matrix
cocycles. Geom. Funct. Anal., 24(4):1101â€“1128, 2014.
[32] J. Fraser, T. Jordan, and N. Jurga. Dimensions of equilibrium measures on a class of planar
self-affine sets. J. Fractal Geom., 7(1):87-111, 2020.
[33] G. Froyland, S. Lloyd, and A. Quas. Coherent structures and isolated spectrum for PerronFrobenius cocycles. Ergodic Theory Dynam. Systems, 30(3):729â€“756, 2010.
[34] H. Furstenberg. Ergodic fractal measures and dimension conservation. Ergodic Theory Dynam.
Systems, 28(2):405â€“422, 2008.
[35] H. Furstenberg and H. Kesten. Products of random matrices. Ann. Math. Statist., 31:457â€“469,
1960.
[36] D. Gatzouras and S. P. Lalley. Hausdorff and box dimensions of certain self-affine fractals.
Indiana Univ. Math. J., 41(2):533â€“568, 1992.
[37] M. Hochman and A. Rapaport. Hausdorff dimension of planar self-affine sets and measures
with overlaps. preprint, arXiv:1904.09812, 2019.
[38] M. Hochman and P. Shmerkin. Local entropy averages and projections of fractal measures.
Ann. of Math. (2), 175(3):1001â€“1059, 2012.
[39] M. Hochman and B. Solomyak. On the dimension of Furstenberg measure for SL2 (R) random
matrix products. Invent. Math., 210(3):815â€“875, 2017.
[40] J. E. Hutchinson. Fractals and self-similarity. Indiana Univ. Math. J., 30(5):713â€“747, 1981.
[41] T. Jordan. Unpublished note. 2011.
[42] T. Jordan, M. Pollicott, and K. Simon. Hausdorff dimension for randomly perturbed self affine
attractors. Comm. Math. Phys., 270(2):519â€“544, 2007.

60

DE-JUN FENG

[43] A. KaÌˆenmaÌˆki. On natural invariant measures on generalised iterated function systems. Ann.
Acad. Sci. Fenn. Math., 29(2):419â€“458, 2004.
[44] R. Kenyon and Y. Peres. Measures of full dimension on affine-invariant sets. Ergodic Theory
Dynam. Systems, 16(2):307â€“323, 1996.
[45] J. F. C. Kingman. The ergodic theory of subadditive stochastic processes. J. Roy. Statist. Soc.
Ser. B, 30:499â€“510, 1968.
[46] F. Ledrappier and L.-S. Young. The metric entropy of diffeomorphisms. I. Characterization
of measures satisfying Pesinâ€™s entropy formula. II. Relations between entropy, exponents and
dimension. Ann. of Math. (2), 122(3):509â€“539; 540â€“574, 1985.
[47] P.-D. Liu and Q. Min. Smooth ergodic theory of random dynamical systems. Lecture Notes in
Mathematics, 1606. Springer-Verlag, Berlin, 1995.
[48] R. ManÌƒeÌ. Ergodic theory and differentiable dynamics. Springer-Verlag, Berlin, 1987.
[49] P. T. Maker. The ergodic theorem for a sequence of functions. Duke Math. J., 6:27â€“30, 1940.
[50] P. Mattila. Geometry of sets and measures in Euclidean spaces. Cambridge University Press,
Cambridge, 1995.
[51] C. McMullen. The Hausdorff dimension of general SierpinÌski carpets. Nagoya Math. J., 96:1â€“9,
1984.
[52] E. Mihailescu and M. UrbanÌski. Random countable iterated function systems with overlaps
and applications. Adv. Math., 298:726â€“758, 2016.
[53] B. Miller. The existence of measures of a given cocycle. I. Atomless, ergodic Ïƒ-finite measures.
Ergodic Theory Dynam. Systems, 28(5):1599â€“1613, 2008.
[54] I. Morris and P. Shmerkin. On equality of Hausdorff and affinity dimensions, via self-affine
measures on positive subsystems. Trans. Amer. Math. Soc., 371:1547â€“1582, 2019.
[55] V. I. Oseledec. A multiplicative ergodic theorem. Liapunov characteristic numbers for dynamical systems. Trans. Moscow. Math. Soc., 19:197â€“231, 1968.
[56] W. Parry. Entropy and generators in ergodic theory. W. A. Benjamin, Inc., New YorkAmsterdam, 1969.
[57] W. Parry. Topics in ergodic theory. Cambridge University Press, Cambridge-New York, 1981.
[58] N. Patzschke. Self-conformal multifractal measures. Adv. in Appl. Math., 19(4):486â€“513, 1997.
[59] Y. Peres and B. Solomyak. Existence of Lq dimensions and entropy dimension for selfconformal measures. Indiana Univ. Math. J., 49(4):1603â€“1621, 2000.
[60] K. Petersen. Ergodic theory. Cambridge University Press, Cambridge, 1983.
[61] F. Przytycki and M. UrbanÌski. On the Hausdorff dimension of some fractal sets. Studia Math.,
93(2):155â€“186, 1989.
[62] M. Qian and J.-S. Xie. Entropy formula for endomorphisms: relations between entropy, exponents and dimension. Discrete Contin. Dyn. Syst., 21(2):367â€“392, 2008.
[63] A. Rapaport. A self-similar measure with dense rotations, singular projections and discrete
slices. Adv. Math. 321:529â€“546, 2017.
[64] A. Rapaport. On self-affine measures with equal Hausdorff and Lyapunov dimensions. Trans.
Amer. Math. Soc., 370(7):4759â€“4783, 2018.
[65] V. A. Rohlin. On the fundamental ideas of measure theory. Amer. Math. Soc. Translation,
1952(71):55, 1952.
[66] E. Rossi. Local dimensions of measures on infinitely generated self-affine sets. J. Math. Anal.
Appl., 413(2):1030â€“1039, 2014.
[67] W. Rudin. Real and complex analysis. McGraw-Hill Book Co., New York, third edition, 1987.
[68] S. Saglietti, P. Shmerkin, and B. Solomyak. Absolute continuity of non-homogeneous selfsimilar measures. Adv. Math., 335:60â€“110, 2018.
[69] L. Shu. Dimension theory for invariant measures of endomorphisms. Comm. Math. Phys.,
298(1):65â€“99, 2010.
[70] B. Solomyak. Measure and dimension for some fractal families. Math. Proc. Cambridge Philos.
Soc., 124(3):531â€“546, 1998.
[71] P. Walters. An introduction to ergodic theory. Springer-Verlag, New York-Berlin, 1982.

DIMENSION OF INVARIANT MEASURES FOR AFFINE IFS

61

[72] L. S. Young. Dimension, entropy and Lyapunov exponents. Ergodic Theory Dynam. Systems,
2(1):109â€“124, 1982.
Department of Mathematics, The Chinese University of Hong Kong, Shatin, Hong
Kong,
E-mail address: djfeng@math.cuhk.edu.hk

