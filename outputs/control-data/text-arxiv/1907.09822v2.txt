Sieving out Unnecessary Constraints in Scenario Optimization
with an Application to Power Systems

arXiv:1907.09822v2 [eess.SY] 8 Jan 2020

Miguel Picallo and Florian DoÌˆrfler

Abstractâ€” Many optimization problems incorporate uncertainty affecting their parameters and thus their objective
functions and constraints. As an example, in chance-constrained
optimization the constraints need to be satisfied with a certain
probability. To solve these problems, scenario optimization is
a well established methodology that ensures feasibility of the
solution by enforcing it to satisfy a given number of samples
of the constraints. The main theoretical results in scenario
optimization provide the methods to determine the necessary
number of samples, or to compute the risk based on the
number of so-called support constraints. In this paper, we
propose a methodology to remove constraints after observing
the number of support constraints and the consequent risk.
Additionally, we show the effectiveness of the approach with an
illustrative example and an application to power distribution
grid management when solving the optimal power flow problem.
In this problem, uncertainty in the loads converts the admissible
voltage limits into chance-constraints.

I. I NTRODUCTION
Many real-world optimization problems are full of uncertainties, but this is ignored in many cases. However, if
this uncertainty is not taken into account, it may lead to
suboptimal solutions, or what is even worse, solutions that
do not satisfy the constraints of the problem. Therefore,
it is essential to represent these uncertainties with random
variables and stochastic constraints.
There are mainly two methodologies to deal with stochastic constraints: robust optimization and chance-constrained
optimization. Robust optimization [2] aims at ensuring feasibility for any realization of the random variables in the
stochastic constraints, and thus prevents the worst-case scenarios. However, robust optimization solutions may be too
conservative in terms of performance, since improbable extreme values of the random variables may shrink the feasible
region too much. In the worst case, this may even lead to
problems with an empty feasible space.
On the other hand, in chance-constrained optimization the
constraints do not need to be satisfied for every realization,
but only satisfied with a given probability guarantee, like
90%, 95% or 99%. These chance-constrained optimization
problems are typically solved by turning the stochastic constraints into deterministic ones. Sometimes this can be done
exactly, for example, in the case of Gaussian uncertainty with
linear constraints; in other cases, a conservative approach can
Funding by the Swiss Federal Office of Energy through the project
Renewable Management and Real-Time Control Platform (ReMaP)
(SI/501810-01) and the ETH Foundation is gratefully acknowledged.
M. Picallo and F. DoÌˆrfler are with the Automatic Control Laboratory at
ETH ZuÌˆrich, Switzerland. {miguelp,doerfler}@ethz.ch
This version includes some corrections to the published version [1].

be used to ensure feasibility [3]. However, in many cases the
problem may not be tractable due to various reasons, like not
knowing the probability distribution of the random variables.
The scenario approach [4], [5], [6], [7], [8] is a data-driven
optimization that aims at solving these intractable chanceconstrained optimization problems by using only samples of
scenarios, i.e., realizations of the random variables. These
scenarios are used to subtitute the chance-constraint by a
deterministic constraint, one for every scenario. In [6] a
method is derived to determine the necessary number of
scenarios to ensure a given probability guarantee. However,
this method may result in too conservative solutions, that
have an expected risk far below the risk threshold of the
original chance-constrained problem. Therefore, in [7] this
method is improved by allowing to violate some scenarios.
Support constraints are defined as the scenarios whose removal results in an improvement of the objective function.
In [6] it is proven that the scenario approach produces exact
bounds, when the solution of the problem has as many
support constraints as decision variables. This is called a
fully-supported solution. When this is not the case, a better
bound on the risk can be computed using the method in [8]
as a function of the number of support constraints.
The natural question arising is then the following: when
a not fully-supported solution is observed, can the optimal
value of the objective function be improved, while still
keeping the risk below its limit? The contribution of this
paper consist in proposing an extension of [8], to sieve out
scenarios like in [7], when a not fully-supported solution
is found. An illustrative example is presented to show the
effectiveness of the approach. Moreover, a power system
application is presented. In this application, our scenario
approach allows to find a feasible solution, that is closer
to the true optimum than the standard scenario approach [6].
In the context of power systems, multiple uncertainties
may affect the modelling of the optimization problems. An
example is the optimal power flow, an optimization problem
used to determine the set-points of controllable elements
in an electrical grid. Uncertainties in loads and generation
availability need to be taken into account in order to provide
solutions satisfying the constraints. In [9], [10], [11] this is
achieved assuming a known probability distribution of these
uncertainties. In [12], [13], [14], [15], [16] this assumption is
dropped, and the scenario approach is used as an appropriate
tool to solve this problem.
The rest of the paper is structured as follows: Section II
describes some relevant definitions and results established
in the context of scenario optimization. Section III presents

the main contribution of the paper: the method to remove
constraints after observing the number of support constraints,
with an example to illustrate its effectiveness. Section IV
presents the power system application. Finally, Section V
draws some conclusions and proposes future work.
II. D EFINITIONS AND RESULTS IN SCENARIO APPROACH
Here we present some relevant definitions and results of
the scenario approach [5], [6], [7], [8] for chance-constrained
optimization problems, which will be necessary to present
our approach.
Definition 1 (chance-constrained optimization): A
chance-constrained problem CCP can be defined as
CCP : xâˆ— = arg min cT x s.t. P (Î´ âˆˆ âˆ† : x âˆˆ XÎ´ ) â‰¥ 1 âˆ’ ,
xâˆˆX âŠ†Rd

(1)
where d is the size of the decision variables x, Î´ is a
random variable with support âˆ† included in a measurable
Ïƒ-algebra, XÎ´ denotes the set of feasible solutions, which
depends on multiple uncertainties represented through the
vector of random variables Î´, and  is the risk of violating
the constraints.
As in [6], we will consider throughout this paper the case
where X and XÎ´ are closed convex sets; and we will assume
that the feasibility domain of problem (1) has a nonempty
interior, and that a solution always exists and is unique.
The problem (1) may be hard to solve depending on
the shape of the feasible space XÎ´ , and the probability
distribution of Î´. This probability may even not be known.
Therefore, the scenario approach provides a technique to
solve the problem using only samples of Î´ or equivalently
XÎ´ .
A. Exact feasibility in the scenario approach [6]
The scenario approach is based on enforcing the constraints for a given number of samples of Î´:
Definition 2 (scenario approach): The scenario approach
problem SPN with N samples: Î´ (i) , i âˆˆ N = {1, . . . , N },
can be defined as
\
SPN : xâˆ—N = arg min cT x s.t. x âˆˆ
XÎ´(i) ,
(2)
xâˆˆX âŠ†Rd

iâˆˆN

where XÎ´(i) is the feasible space given that the random
variable takes value Î´ (i) .
The notion of violation probability and support constraints
are key to understand the scenario approach. They can be
defined as follows:
Definition 3 (violation probability): The violation probability of a solution x is V (x) = P (Î´ âˆˆ âˆ† : x âˆˆ
/ XÎ´ ).
âˆ—
N
The solution xN (Î´ ) of (2) and its violation probability
V (xâˆ—N (Î´ N )) are random variables, since they depend on the
set of scenarios sampled Î´ N = (Î´ (1) , . . . , Î´ (N ) ) âˆˆ âˆ†N .
In an abuse of notation, we denote by P (Î´ N âˆˆ âˆ†N :
V (xâˆ—N (Î´ N )) > ) = P (V (xâˆ—N ) > ) the probability (with
respect to the samples Î´ N ) of the violation probability.

Definition 4 (support constraint [5]): Consider the problem without scenario k:
\
SPN,k : xâˆ—N,k = arg min cT x s.t. x âˆˆ
XÎ´(i) ,
xâˆˆX âŠ†Rd

iâˆˆN \{k}

scenario k is a support constraint if cT xâˆ—N,k < cT xâˆ—N .
The set of indices of the support constraints for the
âˆ—
solution xâˆ—N is denoted as SN
. There can be at most d
âˆ—
support constraints [4], |SN | â‰¤ d, where | Â· | denotes the set
âˆ—
cardinality. If |SN
| = d then the problem is said to be fullysupported. These definitions allow to introduce the following
theorem:
Theorem 1: [6] Given a number of samples N , the probability of the violation probability V (xâˆ—N ) exceeding a risk
value  can be bounded by the term Î² as
dâˆ’1  
X
N i
P (V (xâˆ—N ) > ) â‰¤ Î² :=
 (1 âˆ’ )(N âˆ’i) ,
(3)
i
i=0
where equality holds if the problem is fully-supported.
Then, fixing the risk parameter  and Î², this theorem
allows to find the right number of scenarios N to limit the
probability of V (xâˆ—N ) being above .
B. Scenario approach discarding constraints [7]
In [7] a method is proposed to trade feasibility for performance by allowing a number of constraints to be violated.
This allows to get rid of outlier scenarios that would shrink
the feasible space too much.
Definition 5 (scenario approach discarding constraint):
A
with N samples, where R
The scenario approach SPN,R
are selected to be violated using some removal algorithm
A(Â·) such that A(N ) = R, can be defined as:
A
: xâˆ—N,R = arg minxâˆˆX âŠ†Rd cT x
SPN,R
T
s.t. x âˆˆ iâˆˆN \A(N ) XÎ´(i) .

(4)

where any removal algorithm A could be valid. The only
requirement for the following theorem, is that the constraints
removed by algorithm A are almost surely violated. This can
be achieved be testing if removed constraints are effectively
violated, and if not, remove other constraints.
Theorem 2: [7] If the solution xâˆ—N,R almost surely (with
respect to the set of samples Î´ N ) violates the R constraints
removed by A out of the total number of constraints N ; then
the probability of the violation probability V (xâˆ—N ) exceeding
a risk value  can be bounded by Î² as

R+dâˆ’1 
R+dâˆ’1 X N i
âˆ—
P (V (xN,R ) > ) â‰¤ Î² :=
 (1âˆ’)(N âˆ’i).
R
i
i=0
(5)
Note that for the same N the right-hand term of (5) is
larger that the one in (3). Therefore, to achieve the same
bound on P (V (xâˆ—N,R ) > ), the approach with removals
requires a larger number of samples N . The approach in
(4),(5) remedies a drawback in the basic scenario approach
in (2),(3): the probability density of V (xâˆ—N ) may be concentrated close to 0 and so the expected value, E[V (xâˆ—N )]  .

On the other hand, for the optimal solution xâˆ— of (1) we
would expect to have V (xâˆ— ) close to , if that helps to
improve the performance. This means that the basic scenario
approach may be too conservative. The approach in (4),(5)
can produce less conservative solutions with E[V (xâˆ—N,R )]
closer to  [7, Appendix A].
C. Risk given support constraints [8]
In [8] the authors analyze the case of not fully-supported
problems. Instead of having a fixed risk , it is defined as
âˆ—
function of the number of support constraints |SN
| of the
âˆ—
âˆ—
solution xN of (2): (|SN |). Throughout the rest of the paper,
we will make the following assumtion as in [8]:
Assumption 1 (Non-degeneracy): For every N and R,
with probability 1 (with respect to Î´ N ) the solution of (2)
and (4) with all the constraints, except removed constraints
in (4), coincides with the solution where only the support
constraints are kept.
With Assumption 1 in place we have the following result:
Theorem 3: [8] Given Î² âˆˆ (0, 1), for any k = 1, . . . , d
indicating the number of support constraints, the polynomial
equation in  given by
 
N  
X
N
N
Î²
(1 âˆ’ )mâˆ’k âˆ’
(1 âˆ’ )N âˆ’k , (6)
0=
k
k
N +1
m=k

has exactly one solution (k) âˆˆ (0, 1), and we have
âˆ—
P (V (xâˆ—N ) > (|SN
|)) â‰¤ Î².
It can be observed in [8, Figure 1] and in Figure 1 that
the number of samples N computed for a fully-supported
problem, produces too conservative solutions in problems
with a low number k of support constraints, because (k) < 
for a low k. Therefore, the approach in (6) gives a better
bound on the risk than (3).

III. S CENARIO APPROACH DISCARDING CONSTRAINT
GIVEN SUPPORT CONSTRAINTS

On the one hand, the method in Section II-C allows
to determine a better bound on the risk  as a function
of the number of support constraints k: (k). However,
it does not provide a method to get a less conservative
solution if the number of support constraints is low. On
the other hand, the method in Section II-B allows to obtain
potentially less conservative solutions, but it does not take
into account the number of support constraint to get the
bound on the risk. Therefore, in this section we present a
method to react by removing constraints, when having a
not fully-supported problem, and thus an (k) lower than
the  intended. This method is in essence a combination
of the methods in presented in Sections II-B and II-C with
quantitative guarantees.
Consider the problem SPNÌƒA,R , same as in (4), but with a
total number of samples NÌƒ = N + R before removing R
samples. Here NÌƒ denotes the set of all samples; xâˆ—NÌƒ ,R is
âˆ—
the solution of the problem; and SNÌƒ
the set of indices of
,R
its support constraints. Then, again with Assumption 1, we

Fig. 1: Values of (k, R) for a different number R of violated
constraints, with N = 1000, d = 30, Î² = 10âˆ’3 . Continuous
horizontal lines of  for different R represent the bounds
produced by methods described in Section II, in (3) and (5);
while dotted lines represent those of Section III in (7).

have the following theorem, which is the main result and
contribution of this paper:
Theorem 4: Given Î² âˆˆ (0, 1), for any k = 1, . . . , d
indicating the number of support constraints, and R the
number of removed constraints, the equation in 

 
N  
N +R N
Î² X N
(1âˆ’)mâˆ’k âˆ’
(1âˆ’)N âˆ’k ,
0=
k
R
k
N +1
m=k
(7)
has exactly one solution (k, R) âˆˆ (0, 1). If the solution
xâˆ—NÌƒ ,R almost surely (with respect to the sample Î´ NÌƒ ) violates
R constraints; then the probability of the violation probability
V (xâˆ—NÌƒ ,R ) exceeding a risk value  can be bounded by Î²:
âˆ—
P (V (xâˆ—NÌƒ ,R ) > (|SNÌƒ
|, R)) â‰¤ Î².
,R

See Appendix I for the proof.
Note that the polynomial expression
in (7) differs from the

+R
one in (6) by the factor NR
â‰¥ 1. As a consequence, for
an (k) satisfying (6), we will have (k, R) â‰¥ (k) to satisfy
(7). So the risk bound increases as constraints are removed.
Then, it is possible to get solutions closer to the desired
risk, when observing a low number of support constraints.
In Figure 1, it can be observed that the risk of a solution
with a low number of support constraints and R removed
constraints, can be lower than the risk of fully-supported
solutions satisfying all constraints.
Remark 1 (Implementation): For any scenario optimization problem, once N is fixed using an approach like (3)
or (5), the solutions (k, R) of (7) can be computed for all
k and R. These solutions can be stored in a look-up table,
so that they can be quickly accessed for any number k of
support constraints observed and R constraints removed.
A. Illustrative example
In this section we show the effectiveness of the approach
with an illustrative example. Consider the following chanceconstrained optimization problem
min cT x s.t. P (Î´ : ||x||2 â‰¤ Î´) â‰¥ 1 âˆ’ ,

xâˆˆRd

(8)

Fig. 2: Example with random radiuses Î´i .
case
Î´ âˆ¼ N (3, 1)
Î´ âˆ¼ U (0, 1)

exact
II-B (5)
III (7)
II-A (3)
maximum
(N = 1535, (N = 923,
(N = 923)
value
r = 5)
r = 5)
1.35
âˆ’0.21
0.31
0.49
0.05
0.001
0.004
0.007
(a)  = 0.05, d = 30

case
Î´ âˆ¼ N (3, 1)
Î´ âˆ¼ U (0, 1)

exact
II-B (5)
III (7)
II-A (3)
maximum
(N = 4920, (N = 2230,
(N = 2230)
value
r = 17)
r = 17)
1.35
âˆ’0.46
0.31
0.58
0.05
0.0004
0.004
0.008
(b)  = 0.05, d = 100

TABLE I: Values of Î´ for bound Î² = 10âˆ’3 using the
different scenario approaches described in (3), (5), (7). Two
probability distributions are used: the normal distribution
with mean 3 and standard deviation 1: N (3, 1); and the
uniform distribution in (0, 1): U(0, 1). For the scenario
approaches, the values correspond to the mean of 10000 sets
of samples with N samples each.

where Î´ is a random variable, and  is the risk threshold.
This example corresponds to minimizing a linear function
subject to the constraint that the variables are within a sphere
of random radius, see Figure 2. Therefore, when applying
scenario optimization, the sphere with the smallest radius
will be the single support constraint, and thus the number of
support constraints will be k = 1 almost surely.
In Table I we compare the results for two probability
distributions using the approaches described in (3), (5) and
(7), in Sections II-A, II-B and III respectively. In this
example, since the probability distribution of Î´ is known
we can determine the exact maximum value of Î´ such that
||x||2 â‰¤ Î´ =â‡’ P (||x||2 â‰¤ Î´) â‰¥ 1 âˆ’ .
First, it can be observed that the method described in
Section III performs significantly better than the ones from
Sections II-A and II-B. However, it still relatively far away
from the maximum value Î´ . Note that for II-A, negative
values indicate that the problem would be infeasible. When
increasing the dimension d of the problem, while keeping
the number of support constraints k constant, from Table a)
to b), the difference between methods further increases.
IV. P OWER S YSTEM A PPLICATION
In power systems, the optimal power flow consists of solving an optimization problem to determine the set-points of
controllable elements, like the power injection of distributed
energy sources. Additionally, the grid constraints like voltage

limits need to be satisfied, but this may be difficult, because
some parameters in this optimization problem may be uncertain. An example could be distribution grid management,
where typically only a few measurements are available [17],
and thus the actual value of bus loads of the grid may be
unknown. Here we combine the models and settings in [11]
and [13] to build a simulation framework and apply our
scenario approach (7) to power systems.
First, we consider a linear approximation of the voltage
magnitudes corresponding to the Linear Coupled power flow
model [18, Section 5]
|V | = |V0 | + diag( |V0 | )

âˆ’1

(Zp (PG + PL ) + Zq (QG + QL )),
(9)
where PL , QL are the active and reactive loads respectively,
which we consider to be uncertain parameters; PG , QG
are the active and reactive generation, which we optimize;
Zp , Zq are the known impedance matrices of the grid; |V |
is the vector of voltage magnitudes for all nodes; and |V0 |
is the known vector of voltage magnitudes under no load
and generation (PL , QL , PG , QG = 0). Since PL , QL are
unknown, so will be |V |.
When changing the values of the current operating point
PG , QG by increments âˆ†PG , âˆ†QG , we induce a change in
the voltage magnitudes:
âˆ’1

|V |new = |V | + diag( |V0 | )

(Zp âˆ†PG + Zq âˆ†QG ).

(10)

The advantage of the expression (10) over (9) is that the
uncertain parameters PL , QL no longer appear in (10). The
single uncertain paremeter is the vector |V |, since during
the optimization process we have âˆ†PL , âˆ†QL = 0 [11].
Therefore, we only need to generate samples of |V | for the
scenario optimization, see later in (13). Moreover, since |V |
appears as an additive term in (10), this simplifies the process
of identifying support scenarios and scenarios to remove, as
we will see later in (14).
An objective for the optimal power flow could be to
maximize the injection of distributed energy sources, and
thus minimize the energy required from the grid, while
satisfying the voltage limits Vmin , Vmax :
P
max i âˆ†PG,i + âˆ†QG,i
(11)
s.t. Vmin 1 â‰¤ |V |new (âˆ†PG , âˆ†PG ,|V |) â‰¤ Vmax 1,
where 1 is a vector of 1, and |V |new (âˆ†PG , âˆ†PG ,|V |) denotes |V |new as a function of âˆ†PG , âˆ†PG ,|V |, by enforcing
constraint (10). Since |V | in (10) is an uncertain parameter,
the constraints in (11) will be stochastic. We would like to
satisfy these stochastic constraints with a certain probability
guarantee, for example 95%:
P
max i âˆ†PG,i + âˆ†QG,i
s.t.
P (|V | : Vmin 1 â‰¤ |V |new (âˆ†PG , âˆ†PG ,|V |) â‰¤ Vmax 1) â‰¥ 95%.
(12)
Historical data or models of consumption can be used to
(i)
(i)
obtain samples of PL , QL : PL , QL for i âˆˆ {1, . . . , N },
(i)
and compute the samples |V | using (9). Then, using the
approaches in [17],[13], the few real-time measurements

Fig. 3: 123-bus test feeder with location of distributed
generation: a yellow rhombus for solar, a grey parallelogram
for wind. The network image has been taken from [19].

Fig. 4: Percentage of the total generation of each approach
with respect to the Standard scenario.
Case Optimum Expectation
Standard scenario New scenario
max 1.050 Â± 0 1.057 Â± 0.003 1.040 Â± 0.0015 1.041 Â± 0.0014
min 0.950 Â± 0 0.948 Â± 0.003 0.950 Â± 0.0004 0.950 Â± 0.0003

(i)

available can be used to update the samples|V | . With these
samples, we can solve the stochastic optimization problem
(12) using our scenario approach (7). Note that from (10)
the constraints for each scenario i can be represented as
Vmin 1 â‰¤ |V |

(i)

TABLE II: Mean Â± standard deviation during the time period
from 10am to 8pm, of the max and min voltage magnitude
|V |new across all nodes in the grid: meant (maxl (|V |new,t )l ),
and similarly for min and standard deviation.

âˆ’1

+diag(|V0 |)

(Zp âˆ†PG +Zq âˆ†QG ) â‰¤ Vmax 1.
(13)
For the optimization problem with constraints (13), it is
not possible to know beforehand the number of support
constraints. However, it is possible to identify the most
limiting scenarios for each element (Â·)l of these vector
constraints:

(i)
âˆ’1
Vmin âˆ’ mini |V |l â‰¤ diag(|V0 |) (Zp âˆ†PG + Zq âˆ†QG ) l

(i)
âˆ’1
Vmax âˆ’ maxi |V |l â‰¥ diag(|V0 |) (Zp âˆ†PG + Zq âˆ†QG ) l .
(14)
Using (14), it becomes simple to identify which scenarios
are support constraints and which ones will be violated if
removed. Hence, we can apply our scenario approach (7)
using the following steps:
1) Identify the necessary number of scenarios NÌƒ using
(3) with  = 0.05 and Î² = 10âˆ’3 . Initialize the set of
scenarios NÌƒ and the set of removed constraints I = âˆ….
2) Solve the scenario optimization problem (4) using the
set of scenarios NÌƒ and A(NÌƒ ) = I.
3) Observe the number of support constraints k. Compute
the number of scenarios to remove R using (7), such
that (k, R) â‰¤  < (k, R + 1). Identify the indices
{i1 , . . . , iR } of R support constraint looking at (14),
and add them to I: I = I âˆª {i1 , . . . , iR }.
4) Repeat step 2). If the new solution has the same number of support constraints k as the previous solution,
and all constraints in I are violated, finish here. If not,
go back to step 3).
We have tested this new scenario approach (7) in the
benchmark distribution grid 123-bus test feeder [19], see
Figure 3. As in [11], we have allocated distributed energy
sources in some nodes, see Figure 3; and a real-time current

measurement at the branch connecting the feeder to the
main grid, as in [13]. Load samples are constructed by
aggregating load data of several households [20], and generation availability is constructed using real solar irradiation
and wind speed data [11]. We choose the standard voltage
limits Vmin = 0.95, Vmax = 1.05 [11]. We consider four
approaches:
â€¢ Optimum: using the true values of the voltage magnitudes as if they were known.
â€¢ Expectation: using the estimated expected values and
disregarding the uncertainty.
â€¢ Standard scenario: using the standard scenario approach
described in (2),(3).
â€¢ New scenario: using the new scenario approach in (7).
and use them in a simulation to solve the stochastic optimal
power flow (12) once every 15 minutes in the interval from
10am to 8pm of a day.
As it can be observed in Figure (4), both Optimum and
Expectation allow to inject around 10âˆ’15% more renewable
energy than the scenario approaches Standard scenario and
New scenario. Despite that, in Table II it can be observed
how the extreme values of Expectation are continuously
violating the voltage limits: the maximum and minimum
voltage magnitude values for all nodes have means beyond
the limits 0.95, 1.05, even with a gap larger than two standard
deviations in the case of the maximum. This is a consequence
of disregarding the uncertainty in the data. On the other
hand, both Standard scenario and New scenario satisfy the
constraints. Moreover, note in Figure 4 that the New scenario
injects around 1 âˆ’ 2% more energy (even up to 3%) than
the Standard scenario, since some scenarios are removed. In

this case, this improvement could imply millions of profit
if taking into account the huge amount of distribution grids
across the world. An intuitive explanation of what happens,
is that out of many possible load conditions/scenarios in an
electrical grid, there will be only a few that are actually limiting the current solution, the support constraints. Therefore,
if removing some scenarios, the solution will perform better,
but still satisfy the probability guarantee on the risk.

I = {N +1, . . . , N +R}, so that the remaining scenarios are
NÌƒ \I = N . As in Section II-C, we consider having a number
k of support constraints SIâˆ— , i.e., |SIâˆ— | = k, of problem (15):
P (V (xâˆ—I ) > (|SIâˆ— |, R) âˆ§ xâˆ—I âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I)

A PPENDIX I
P ROOF OF T HEOREM 4
This proof combines elements from the proofs in [7], [8].
We start by defining the problem, where samples with indices
in the set I = {i1 , . . . , iR } are removed, with |I| = R:
\
xâˆ—I = arg min cT x s.t. x âˆˆ
XÎ´(i) .
(15)
xâˆˆX âŠ†Rd

iâˆˆNÌƒ \I

Consider also the set of samples violating the I constraints:
NÌƒ
âˆ†NÌƒ
âˆˆ âˆ†NÌƒ : xâˆ—I (Î´ NÌƒ ) âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I} âŠ† âˆ†NÌƒ .
I = {Î´

Since the solution xâˆ—NÌƒ ,R almost surely violates R constraints, we know that, for some I, xâˆ—NÌƒ ,R = xâˆ—I , and
SNÌƒ ,R = SI , where SI is the set of support constraints of
xâˆ—I . Therefore, we have
âˆ—
{Î´ NÌƒ âˆˆ âˆ†NÌƒ : V (xâˆ—NÌƒ ,R (Î´ NÌƒ )) > (|SNÌƒ
|, R)}
,R
S NÌƒ
NÌƒ :
âˆ— NÌƒ
âˆ—
âŠ† I {Î´ âˆˆ âˆ†I V (xI (Î´ )) > (|SI |, R)},

and thus
âˆ—
P (V (xâˆ—NÌƒ ,R ) > (|SNÌƒ
|, R))
,R
P
âˆ—
âˆ—
â‰¤ I P (Î´ NÌƒ âˆˆ âˆ†NÌƒ
I âˆ§ V (xI ) > (|SI |, R))

a)
NÌƒ
âˆ—
âˆ—
= NÌƒ
âˆˆ âˆ†NÌƒ
I âˆ§ V (xI ) > (|SI |, R))
R P (Î´

âˆ—
âˆ—
âˆ—
= NÌƒ
/ XÎ´(i) âˆ€i âˆˆ I),
R P (V (xI ) > (|SI |, R) âˆ§ xI âˆˆ

(16)

where the equality a) is due to all possible combinations
of indices of the removed constraints I. Since the scenario
sampling process is i.i.d, the probability is the same for any
set of indices I with same size.
Now we can look into this last probability term:
P (V (xâˆ—I ) > (|SIâˆ— |, R) âˆ§ xâˆ—I (Î´ NÌƒ ) âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I). Without
loss of generality, we fix the set of removed constraints

d
P

P (V (xâˆ—I ) > (k, R) âˆ§ xâˆ—I âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I âˆ§ |SIâˆ— | =
k=0

c) Pd
âˆ—
âˆ—
= k=0 N
/ XÎ´(i) âˆ€i âˆˆ I
k P (V (xI ) > (k, R) âˆ§ xI âˆˆ
âˆ—
âˆ—
âˆ§ |SI | = k âˆ§ SI = {1, . . . , k}),
=

In this work we have presented an extension of the
scenario approach that allows to sieve out unnecessary constraints, when observing that a problem is not fully supported
and thus too conservative. Our methodology determines
the number of constraints to remove given the number of
support constraints. This allows to improve the performance
of the solution, while preserving the probabilistic guarantees.
We have shown the relevancy of the approach using an
illustrative example; then we have tested its effectiveness in a
real-world power system application for solving the optimal
power flow problem under uncertainty. As future work, it
would be interesting to analyze if tighter bounds can be
derived.

{V (xâˆ—I ) > (k, R) âˆ§ xâˆ—I âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I âˆ§ |SIâˆ— | = k})

k=0
b)

V. C ONCLUSIONS

d
S

=P(

k)

(17)
where equality b) is due to having disjoint sets since the
|SIâˆ— | can only be a single value; and c) is due to all possible
combination of indices of the support constraints SIâˆ— out of
the remaining samples N after removing R from NÌƒ . Again,
since the scenario sampling process is i.i.d, the probability
is the same for any set of indices SIâˆ— of the same size.
Let xâˆ—k be the solution using only the first k scenarios:
T
xâˆ—k = arg minxâˆˆX cT x s.t. x âˆˆ i=1,...,k XÎ´(i) .
With Assumption 1, the solution xâˆ—I is non-degenerate, i.e.,
if SIâˆ— = {1, . . . , k}, then xâˆ—I = xâˆ—k with probability 1, and
we have
P (V (xâˆ—I ) > (k, R) âˆ§ xâˆ—I âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I âˆ§ |SIâˆ— | = k
âˆ—
âˆ§ SI = {1, . . . , k})
d)

= P (V (xâˆ—k ) >T(k, R) âˆ§ xâˆ—k âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I âˆ§ |Skâˆ— | = k
âˆ—
âˆ§ xk âˆˆ i=k+1,...,N XÎ´(i) )
R
T
= ((k,R),1] P (xâˆ—k âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I âˆ§ xâˆ—k âˆˆ i=k+1,...,N XÎ´(i)
V (xâˆ—k ) = Ï… âˆ§ |Skâˆ— | = k)dFk (Ï…)
e) R
= ((k,R),1] (1 âˆ’ Ï…)N âˆ’k Ï… R dFk (Ï…),
(18)
where Fk () = P (V (xâˆ—k ) â‰¤  âˆ§ |Skâˆ— | = k) is the k-th
cumulative density function, i.e., the probability that xâˆ—k is
fully-supported and has violation probability less than .
The equality d) can be proven similarly as in [8, 5.1 Proof
of Theorem 1, proof A=B]. The equality e) comes from
the fact that for a fixed violation probability value Ï…, the
probability of satisfying the N âˆ’ k constraints with indices
{k+1, . . . , N } is (1âˆ’Ï…)N âˆ’k ; and the probability of violating
the R constraints with indices I is Ï… R .
Putting all together we have:
P (V (xâˆ—NÌƒ ,R ) > (k, R))
(16)

N +R
R

P (V (xâˆ—I ) > (k, R) âˆ§ xâˆ—I âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I)
R
(17)(18) N +R Pd
N
=
(1 âˆ’ Ï…)N âˆ’k Ï… R dFk (Ï…).
k=0 k
R
((k,R),1]
(19)
Now we use additional information about Fk (). Similarly
as in [8], we can derive some constraints for any generic
number of scenarios m â‰¥ 0 instead of N :
1 â‰¥ P (V (xâˆ—I ) â‰¥ 0 âˆ§ xâˆ—I âˆˆ
/ XÎ´(i) âˆ€i âˆˆ I)

R
(17)(18) Pmin(d,m) m
1
=
(1 âˆ’ Ï…)mâˆ’k Ï… R dFk (Ï…),
k=0
k
0
â‰¤



where the term min(d, m) reflects that for a number of
scenarios m â‰¤ d, there can only be m support constraints.
So we can derive an upper bound Î³ on P (V (xâˆ—N ) >
(sâˆ—N )): P (V (xâˆ—N ) > (sâˆ—N )) â‰¤ Î³, by optimizing over all
possible Fk (Â·) âˆˆ C âˆ€k, where C is the positive cone of
generalized distribution functions:
N +R
R

Î³ = supFk âˆˆC

d
P
k=0

min(d,m)
P m R 1
(1
k
0
k=0

s.t.

N
k

R
((k,R),1]

(1 âˆ’ Ï…)N âˆ’k Ï… R dFk (Ï…)

âˆ’ Ï…)mâˆ’k Ï… R dFk (Ï…) â‰¤ 1, âˆ€m â‰¥ 0.

(20)
By truncating m â‰¤ M , where M â‰¥ d, the number of
constraints are reduced. Then we get a new problem with
less constraints, whose optimal value Î³M satisfies Î³ â‰¤ Î³M .
Now we consider the dual problem of Î³M [21]:
PM
Î³Ì„M = inf Î»m â‰¥0 m=0 Î»m
 
+R N
N âˆ’k R
s.t. NR
Ï… 1((k,R),1] (Ï…)
k (1 âˆ’ Ï…)
(21)

PM
m
â‰¤ m=k Î»m k (1 âˆ’ Ï…)mâˆ’k Ï… R
âˆ€Ï… âˆˆ [0, 1], âˆ€k = 0, 1, . . . , d
where 1((k,R),1] (Ï…) is the indicator function. The term Ï… R
can be canceled on both sides of the constraint, since for
Ï… = 0 the constraints hold for any Î»m . By weak duality we
have Î³ â‰¤ Î³M â‰¤ Î³Ì„M . This can be verified for any feasible
point Fk of (20) and Î»m of (21):
N +R
R

=

 Pd

k=0

Pd

k=0 0

(21)

R1
k=0 0

â‰¤

Pd

=

PM

m=0

(20)

â‰¤

R1

M
P

Î»m

N
k

R
((k,R),1]


N +R
R

PM

m=k


N
k

(1 âˆ’ Ï…)N âˆ’k Ï… R 1((k,R),1] (Ï…)dFk (Ï…)

Î»m

Pmin(d,m)
k=0

(1 âˆ’ Ï…)N âˆ’k Ï… R dFk (Ï…)

m
k



(1 âˆ’ Ï…)mâˆ’k Ï… R dFk (Ï…)
R1
m
(1 âˆ’ Ï…)mâˆ’k Ï… R dFk (Ï…)
k
0

Î»m .

m=0

(22)
Then,
for
any
feasible
point
Î»
â‰¥
0
of
(21),
we
have
m
PM
Î³ â‰¤ m=0 Î»m . Let us consider the case M = N , and the
candidate solution Î»m = NÎ²+1 âˆ€m. To ensure that this is a
feasible point of (21), we need to find the smallest (k, R)
for every k âˆˆ {0, . . . , d} such that for all Ï… âˆˆ [0, 1]
 
N +R N
N âˆ’k
1((k,R),1] (Ï…)
R
k (1 âˆ’ Ï…)
(23)

P
N
mâˆ’k
â‰¤ NÎ²+1 m=k m
,
k (1 âˆ’ Ï…)
where this equation corresponds to plugging the candidate
solution into the constraint in (21). Now if (7) has exactly
one solution in (k, R) âˆˆ (0, 1), with those (k, R) we get
âˆ—
P (V (xâˆ—NÌƒ ,R ) > (|SNÌƒ
|, R)) â‰¤
,R

N
X

Î²
âˆ’ 0 = Î².
N +1
m=0

The proof that (7) has exactly one solution in  âˆˆ (0, 1),
is analogous to the one in
 [8, 5.3 Proof of Theorem 2]. After
+R
adding the factor NR
the steps of the proof still hold.

R EFERENCES
[1] M. Picallo and F. DoÌˆrfler, â€œSieving out unnecessary constraints in
scenario optimization with an application to power systems,â€ in IEEE
Conf. Decision and Control, Dec 2019.
[2] A. Ben-Tal and A. Nemirovski, â€œRobust convex optimization,â€ Mathematics of Operations Research, vol. 23, no. 4, pp. 769â€“805, 1998.
[3] A. Nemirovski and A. Shapiro, â€œConvex approximations of chance
constrained programs,â€ SIAM J. on Optimization, vol. 17, no. 4, pp.
969â€“996, Dec. 2006.
[4] G. C. Calafiore and M. C. Campi, â€œUncertain convex programs:
randomized solutions and confidence levels,â€ Mathematical Programming, vol. 102, no. 1, pp. 25â€“46, Jan. 2005.
[5] â€”â€”, â€œThe scenario approach to robust control design,â€ vol. 51, no. 5,
pp. 742â€“753, May 2006.
[6] M. C. Campi and S. Garatti, â€œThe exact feasibility of randomized solutions of uncertain convex programs,â€ SIAM J. Optimization, vol. 19,
no. 3, pp. 1211â€“1230, 2008.
[7] â€”â€”, â€œA sampling-and-discarding approach to chance-constrained
optimization: Feasibility and optimality,â€ Journal of Optimization
Theory and Applications, vol. 148, no. 2, pp. 257â€“280, Feb 2011.
[8] â€”â€”, â€œWait-and-judge scenario optimization,â€ Mathematical Programming, vol. 167, no. 1, pp. 155â€“189, Jan 2018.
[9] T. Summers, J. Warrington, M. Morari, and J. Lygeros, â€œStochastic
optimal power flow based on conditional value at risk and distributional robustness,â€ International Journal of Electrical Power & Energy
Systems, vol. 72, pp. 116 â€“ 125, 2015.
[10] E. Dallâ€™Anese, K. Baker, and T. Summers, â€œChance-constrained AC
optimal power flow for distribution systems with renewables,â€ vol. 32,
no. 5, pp. 3427â€“3438, Sept 2017.
[11] M. Picallo, A. Anta, and B. De Schutter, â€œStochastic optimal power
flow in distribution grids under uncertainty from state estimation,â€ in
IEEE Conf. Decision and Control, Dec 2018.
[12] S. Bolognani and F. Drfler, â€œFast scenario-based decision making in
unbalanced distribution networks,â€ in 2016 Power Systems Computation Conference (PSCC), June 2016, pp. 1â€“7.
[13] S. Bolognani, E. Arcari, and F. DoÌˆrfler, â€œA fast method for real-time
chance-constrained decision with application to power systems,â€ IEEE
Control Systems Letters, vol. 1, no. 1, pp. 152â€“157, July 2017.
[14] H. Ming, L. Xie, M. C. Campi, S. Garatti, and P. R. Kumar, â€œScenariobased economic dispatch with uncertain demand response,â€ vol. 10,
no. 2, pp. 1858â€“1868, March 2019.
[15] M. S. Modarresi, L. Xie, M. Campi, S. Garatti, A. Car, A. Thatte, and
P. R. Kumar, â€œScenario-based economic dispatch with tunable risk
levels in high-renewable power systems,â€ pp. 1â€“1, 2018, in press.
[16] L. Roald, M. Vrakopoulou, F. Oldewurtel, and G. Andersson, â€œRiskbased optimal power flow with probabilistic guarantees,â€ International
Journal of Electrical Power & Energy Systems, vol. 72, pp. 66 â€“ 74,
2015.
[17] M. Picallo, A. Anta, A. Panosyan, and B. De Schutter, â€œA two-step
distribution system state estimator with grid constraints and mixed
measurements,â€ in IEEE Power Systems Computation Conference,
June 2018.
[18] S. Bolognani and S. Zampieri, â€œOn the existence and linear approximation of the power flow solution in power distribution networks,â€
vol. 31, no. 1, pp. 163â€“172, 2016.
[19] W. H. Kersting, â€œRadial distribution test feeders,â€ in IEEE/PES Winter
Meeting, vol. 2, 2001, pp. 908â€“912.
[20] R. Pedersen, C. Sloth, G. B. Andresen, and R. Wisniewski, â€œDiSC:
A simulation framework for distribution system voltage control,â€ in
European Control Conference (ECC), 2015, pp. 1056â€“1063.
[21] E. J. Anderson and P. Nash, Linear programming in infinitedimensional spaces: theory and applications. John Wiley & Sons,
1987.

