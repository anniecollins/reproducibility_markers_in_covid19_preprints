A bank salvage model by impulse stochastic controls
Francesco Cordonia

Luca Di Persioa

Yilun Jiangb

arXiv:1910.03056v1 [q-fin.MF] 7 Oct 2019

Abstract
The present paper is devoted to the study of a bank salvage model with finite time
horizon and subjected to stochastic impulse controls. In our model, the bankâ€™s default
time is a completely inaccessible random quantity generating its own filtration, then
reflecting the unpredictability of the event itself. In this framework the main goal is
to minimize the total cost of the central controller who can inject capitals to save the
bank from default. We address the latter task showing that the corresponding quasiâ€“
variational inequality (QVI) admits a unique viscosity solution, Lipschitz continuous
in space and HoÌˆlder continuous in time. Furthermore, under mild assumptions on the
(1,2),p
dynamics the smooth-fit Wloc
property is achieved for any 1 < p < +âˆ.

AMS Classification subjects: 49N25, 49N60, 93E20, 91G80
Keywords or phrases: Bank salvage model, stochastic impulse control, viscosity
solution, inaccessible bankruptcy time, smooth-fit property.

1

Introduction

Mainly motivated by the recent financial credit crisis, starting from 2008-2009 credit
crunch, the financial and mathematical community started investigating and generalize existing models, since previous events have shown that financial models used prior to the crisis
where inadequate to describe and capture main features of financial markets. Therefore
the mathematical and financial communities have focus on developing general and robust
models that are able to properly describe financial markets and their main peculiarities.
From a purely mathematical perspective the above mentioned attention led, among many
other research topics, for instance into the study of general stochastic optimal control problems, where instead of classical type of controls, some more realistic controls have been
considered. Among the most studied type, impulse type controls have to be mentioned,
and regained attention in last decades also due to the many application in finance and economics. In this setting, the controller can intervene on the system at some random time
with a discrete type control, where in this case the control solution is represented by the
couple u = (Ï„n , Kn )n , where Ï„n represents the decision time at which the ocntroller intervene and Kn instead denotes the action taken by the controller. Above type of control
implies that at the intervention time Ï„n the system jumps from the state X(Ï„nâˆ’ ) to the new
state X(Ï„n ) = Î“(X(Ï„n ), Kn ), for a suitable function Î“. Therefore, as standard in optimal
control theory, using the dynamic programming principle, it can be shown that stochastic
impulse control problems can be associated to a quasiâ€“variational Hamiltonâ€“Jacobiâ€“Bellman
equation (HJB) of the form


âˆ‚
(1)
min âˆ’ V âˆ’ L V âˆ’ f, V âˆ’ H V ,
âˆ‚t
where above f is the running cost, L is the infinitesimal generator for the process X and
V is the value function solution to the above HJB equation. Further, H is the nonlocal
a
Department of Computer Science, University of Verona, Strada le Grazie, 15, Verona, 37134, Italy
E-mail addresses: francescogiuseppe.cordoni@univr.it (Francesco Cordoni), luca.dipersio@univr.it (Luca Di
Persio)
b
Department of Mathematics, Penn State University, University Park, PA 16802, USA
E-mail addresses: sjtujyl@gmail.com (Yilun Jiang)

1

Introduction

2

impulse operator that characterize HJB equation for impulse type of control. The particular
form for the HJB implies that two regions can be retrieved, the continuation region where
V > H V and therefore no impulse control is used, and the impulse region where on the
contrary V = H V and the controller intervenes. Solution to equation (1) can be formally
defined so that the value function is in fact a viscosity solution, in a sense to be properly
defined later on, to equation (1). It is clear that, following the above characterization of
the domains for the HJB equation, particular attention must be given to the intervention
boundary. In fact, particular attention is usually given in this field to proving that the
boundary is regular enough; this regularity is referred to in literature as smoothâ€“fit principle.
Several results exist in the smoothâ€“fit principle where the terminal horizon for the control
problem, whereas instead finite horizon problem, and in particular the terminal condition
of the problem, makes less straightforward the derivation of the smoothâ€“fit principle.
At last, we stress that impulse type stochastic control is strictly connected to optimal
stopping problems and optimal switching. The literature on the topic is wide, we refer the
interested reader to [26, 45], or also to [4, 5, 12, 13, 21, 25, 38, 42, 46] for other related
results.
A second crucial financial aspect that emerged to be fundamental in a general financial
formulation after recent crisis there is possible failures of financial entities. In fact, one
of the major lack of classical financial models is that no risk of failure is considered into
the general setting. Recent financial event has shown that no financial operator can be
considered immune from bankruptcy. Therefore it has emerged in last decade an extensive
literature that focus on credit risk modeling, assessing as main object the risk that financial
entities has to face borrowing or lending money to other players that might fail, see, e.g.
[10, 17, 18].
Along aforementioned lines, two main approaches have been developed in literature:
structural approach and intensityâ€“based approach, see, e.g. [7]. Mathematically speaking,
the first scenario consits in considering some default event that can be triggered by the
underlyng process. Typical example are default triggered by some stopping time defined
as a hitting time. Such an approach has been for instance considered in [14, 15, 35]. The
latter instead considers a default event which is completely inaccessible for the probabilistic
reference filtration, so that in order to solve the problem the typical approach is to rely on
filtration enlargment techniques, see, e.g., [6, 40].
The present paper is devoted to study a stochastic optimal control problem of impulse
type, where a financial supervisor controls a system, such as financial operators or also
some banks. The final goal of the controller is to prevent failures, injecting capital intro
the system according to a given criterion to be maximized. The controller has no perfect
information regarding the failure of the bank, so that mathematically speaking the failure
cannot be foreseen by the controller. The supervisor, which can be though for instance as
a central bank, can intervene with some impulse type controls over a finite horizon, so that
the optimal solution is represented by both am intervention time and the quantity to inject
into the system.
Our approach will be based on a intensityâ€“based approach, so that we will assume the
default event to be totally inaccessible from the reference filtration, assuming only a typical
density assumption. This assumptions will allows us to rewrite the system as deterministic finite horizon impulse problem, using the density distribution of the default event, via
enlargement of filtrations techniques. We stress that, due to the terminal condition to be imposed, typically a finite horizon stochastic impulse control problem is more difficult to solve
than infinite horizon impulse control problems. In fact, it exists an exhaustive literature on
stochastic impulse control on infinite time horizon, see, e.g. [4, 5, 12, 21, 25, 38, 42, 46],
whereas very few results exist for the finite dimensional case, see, e.g. [13, 26, 45].
A more financially oriented motivation of the control problem considered in the present
work, has often arise in the last decade, mostly as a consequence of the 2007â€“2008 credit
crunch. This has been for instance the case of Lehman Brothers failure, which has shown
the cascade effect triggered by the default of a sufficiently large and interconnected financial
institution, see, e.g., [29, 30] and references therein. We stress that, particular attention
has to be given not only towards the magnitude of the stressed bankâ€™s financial assets, but
also to its interconnection grade. Indeed, while the exposure with few financial institutions,

The general setting

3

provided its magnitude is reasonable, can be managed by ad hoc politics established on a
one to one relationship basis, the situation could be simply ungovernable in case of a high
number of connections, hidden links and over-structured contracts.
Since above mentioned financial crisis, it has became typical, within the financial oriented
stochastic optimal control theory, to model a given problem up to a random terminal time
instead of considering a fixed, even infinite, horizon. From a modelling point of view, the
aforementioned scenario has lead to consider the stochastic optimal control approach to
model such situations by considering random terminal times, instead of considering a fixed,
or infinite, horizon. Analogously, data analysts as well as mathematicians, have started
to consider problems of bank bailouts, where bankâ€™s default and the consequent contagion
spreading inside the network, may induce serious consequences for decades, see, e.g., [23].
From a government perspective, such type of likely high financial fall out, have pushed
several central banks to establish specific economic actions to help those sectors of the
banking sector of (at least) national interest, under concrete failure risks. As an example, the
latter has been the case of the pro bail-in procedures followed in agreement with the Directive
2014/59/UE (approved last 1st of January, 2016 by the European Union Parliament), and
then applied, e.g., in Italy, Ukraine, etc., see, e.g. [33, 44]. It is relevant to underline that
such actions rely also on the following grades of freedom: the possibility, as an alternative
to internal rescue, to relocate goods as well as legal links to a third party, often called
bridge-bank, or to a bad bank which will collect only a part of assets aiming at maximizing
its long-term value; the hierarchical order of those who are called to bear the bail-in, which
means that the government can decide to put small creditors on the safe side; and the
principle that no shareholder, or creditor, has to bear greater losses than would be expected
if there was an administrative liquidation, namely the no worse off creditor idea.
Similar situations have been recently taken into consideration by a series the Central
European Bank procedures, with particular reference to the well known quantitative easing,
as well as in agreement to the creation of injected currency, see, e.g., [2, 3, 8, 19]. We would
like to underline that quantitative easing type procedures have been experienced also outside
the European Union, as in the case of the actions undertaken by the Japanese Central Bank,
whose intervention has lasted over years, see, e.g. [9, 47, 37], or how has been done by the
US Federal Reserve not only starting from 2008, but also during the Great Depression of
the 1930s, see, e.g., [48, 49, 50, 51, 52].
The main contribution of the present paper is to develop a concrete financial setting that
models the evolution of a financial entity, controlled by an external supervisor who is willing
to lend money in order to maximize a given utility function; see also [11, 15, 20, 35, 43]
for setting in which a financial supervisor aims at controlling a system of banks of general
financial entities. In compete generality, we will assume that the financial entity may fail
at some random time that is inaccessible to the reference filtration, which represents the
controller knowledge. Also, we consider a controller that can act on a system with an
impulseâ€“type control, so that the optimal solution consists in both a random time at which
injecting money into the system and the precise amount of money to inject. We characterize
the value function of the above problem, showing that it must solve in a given viscosity
sense a certain quasiâ€“variational inequality (QVI). At last we will prove that above QVI
admits a unique solution in a viscosity sense and also we provide a regularity results for the
intervention boundary, known in literature as smooth fit principle.
The paper is so organized, Section 2 introduces the general financial and mathematical
setting; then Section 3 prove some regularity results for the value function and Section 4
address the problem of existence and uniqueness of a solution. At last Section 5 is devoted
to the smooth fit principle.

2

The general setting


We will in what follows consider a complete filtered probability space â„¦, F , (Ft )tâˆˆ[0,T ] , P ,

(Ft )tâˆˆ[0,T ] being a filtration satisfying the usual assumptions, namely rightâ€“continuity and
saturation by Pâ€“null sets. Let T < âˆ be a fixed terminal time, and let x, resp. y, denotes
the total value of the investments of a given bank, resp. the total amount of deposit of the

The general setting

4

same bank. We assume that x and y evolve according to the following system of SDEs
(
dx(t) = c1 yÌ‡(t)dt
 + ÂµÌƒ(t)x(t)dt + ÏƒÌƒ(t)x(t)dW (t)
,
(2)
x(t)
yÌ‡(t) = Î» y(t) y(t)

where W (t) is assumed to be a standard Brownian motion adapted to the aforementioned
filtration. In particular, the first term in equation (2) accounts for the increase in X due
to the fact that new deposits are made, where c1 âˆˆ [0, 1] denotes the fractions of deposits
which are actually invested in more or less risky financial operations. We stress that by a
rescaling argument, with no less of generality c1 = 1 it can be assumed. Moreover we define
the value over liability ratio X(t) := x(t)
y(t) . Then, according to eq. (2) and exploiting the
ItoÌ‚-DoÌˆblin formula, we have
(
dX(t) = ((c1 âˆ’ X(t))Î»(X(t)) + ÂµÌƒ(t)X(t)) dt + ÏƒÌƒ(t)X(t)dW (t)
.
(3)
x(0) = x0
We assume the process X to be stopped at completely inaccessible random time Ï„ , not
adapted to the reference filtration (Ft )tâˆˆ[0,T ] . From a financial point of view, assuming
that X represents the financial value of an agent, above assumption reflects the fact that a
bankâ€™s failure cannot be predicted. In particular, let us introduce the filtration (Ht )tâˆˆ[0,T ]
generated by the stopping time Ï„ , namely Ht := 1{Ï„ â‰¤t} . Then we define the augmented
filtration (Gt )tâˆˆ[0,T ] , where Gt := Ft âˆ¨ Ht .
Within this setting it is interesting to consider an external controller, e.g., a central bank,
or an equivalent financial agent acting as a governance institution, with suitable surveillance
rights. Such controller can inject capital in the bank, at random times Ï„n . Then, at that
time Ï„n , the state process X(t) jumps, in particular we have
X(Ï„nâˆ’ ) 6= X(Ï„n ) = X(Ï„nâˆ’ ) + Kn ,
therefore X(t) evolves according to
(
P
dX(t) = ((c1 âˆ’ X(t))Î»(X(t)) + ÂµÌƒ(t)X(t)) dt + ÏƒÌƒ(t)X(t)dW (t) + n:Ï„n â‰¤t Kn
X(0) = x0

.

(4)

The solution to the aforementioned system is represented by a couple u = (Ï„n , Kn )nâ‰¥1 ,
where (Ï„n )nâ‰¥1 is a nonâ€“decreasing sequence of stopping times representing the intervention
times, while (Kn )nâ‰¥0 is a sequence of (Gt )â€“adapted random variables taking values in A âŠ‚
[0, âˆ). In particular the sequence (Kn )nâ‰¥0 indicates the financial actions taken at time Ï„n .
The following is the definition of admissible impulse strategy u.
Definition 2.0.1 (Admissible impulse strategy). The admissible control set U consists of
all the impulse controls u = (Ï„n , Kn )nâ‰¥0 such that
{Ï„i }iâ‰¥1 are Gt adapted stopping times and increasing, i.e Ï„1 < Ï„2 < Â· Â· Â· < Ï„i < Â· Â· Â· ,
(5)

Ki âˆˆ A and Ki âˆˆ GÏ„i , âˆ€ i â‰¥ 1.

Remark 2.1. Equivalently, we will use a different notation, Î¾t (Â·) to express the same space,
i.e. for all 0 â‰¤ t â‰¤ s â‰¤ T ,
X
Î¾t (s) =
Ki
tâ‰¤Ï„i <s

where Ï„i , Ki satisfies (5) and the corresponding admissible control set U [t, T ] consists of all
Î¾t (Â·).
In what follows we will denote for short
Âµ(t, Xt ) := ((c1 âˆ’ X(t))Î»(X(t)) + ÂµÌƒ(t)X(t)) ,
Ïƒ(t, Xt ) := ÏƒÌƒ(t)X(t) ,

The general setting

5

u
so that, for any admissible control u âˆˆ U [t, T ], define Xt,x
(s) as
Z s
Z s
u
u
u
Xt,x
(s) = x +
Âµ(r, Xt,x
(r)) dr +
Ïƒ(r, Xt,x
(r))dW (r) + Î¾t (s)
t

s â‰¥ t,

t

u
which is the unique strong solution of dynamics (4) with initial condition Xt,x
(t) = x. We
aim at solving the following stochastic control problem whose value function is defined as

.
V (t, x) =

sup

J u (t, x) .

(6)

uâˆˆU [t,T ]

where J u (t, x) is the expected cost of the form
Z
.
J (t, x) = E

Ï„ âˆ§T

u

t

u
u
f (Xt,x
(s))ds + g1 (Xt,x
(T ))1{Ï„ â‰¥T } +
u
âˆ’ g2 (Xt,x
(Ï„ ))1{Ï„ <T } âˆ’

X

(7)


(Kn + Îº) ,

tâ‰¤Ï„n â‰¤Ï„ âˆ§T

(8)

where f , resp. g, represents the running cost, resp. the terminal cost, while K + Îº,
Îº > 0, is a suitable constant defining the cost required by the capital injection. Above, we
have denoted by Ï„ the bank default time, with respect to the process X(t). We assume, as
specified above, that Ï„ is a completely inaccessible random time, and it is not adapted to
the reference filtration (Ft )tâˆˆ[0,T ] . Also, recall that (Ht )tâˆˆ[0,T ] is the filtration generated
by the stopping time Ï„ , namely Ht := 1{Ï„ â‰¤t} , whilst (Gt )tâˆˆ[0,T ] is the filtration, namely
Gt := Ft âˆ¨ Ht .
Following the standard literature, see, e.g., [32] both the running and terminal costs are
usually given in terms of suitable utility functions representing the utility gains from the
p
bankâ€™s value. A typical example is f (x) = xp , p âˆˆ (0, 1). As regards the cost K + Îº, it
reflects the fact that injecting an amount K of capital to increase the bankâ€™s liquidity level,
implies a non negligible cost, otherwise such a financial help would be always profitable.
Throughout the work we will make the following assumptions:
Hypothesis 2.2. (i) the function Î» : R â†’ R is Lipschitz continuous, namely there exists a
constant LÎ» > 0 such that
|Î»(x) âˆ’ Î»(y)| â‰¤ LÎ» |x âˆ’ y| ,

âˆ€ x, y âˆˆ R ;

(ii) the functions f , g1 , g2 are Lipschitz continuous, namely there exist constants Lf , lg1
and Lg2 > 0 such that

|f (x) âˆ’ f (y)| â‰¤ Lf |x âˆ’ y| ,
|g1 (x) âˆ’ g1 (y)| â‰¤ Lg1 |x âˆ’ y| ,
|g2 (x) âˆ’ g2 (y)| â‰¤ Lg2 |x âˆ’ y| ,

âˆ€ x, y âˆˆ R ;
âˆ€ x, y âˆˆ R ;
âˆ€ x, y âˆˆ R ;
(9)

We also assume that there exist constants Cf , Cg1 and Cg2 > 0 such that

f (x) < Cf ,

g1 (x) < Cg1 ,

g2 (x) < Cg2 ;

(iii) the functions Âµ(t), Ïƒ(t) âˆˆ C([0, T ]).
(iv) No terminal impulse, i.e.
g1 (x) â‰¥ sup g1 (x + K) âˆ’ K âˆ’ Îº.
K>0

The general setting

6

The boundedness properties for the running and terminal cost can be interpreted in the
following sense: since we are seeking the optimal capital injection strategy for the government
over a finite time horizon, we may think that there is a healthy level U > 0 such that when
the bankâ€™s capital is growing to infinity, then the utility remains flat, so that the government
will have no interest in injecting more capital. As to make an example, we can take
U (x) = U âˆ’ eâˆ’x .
Remark 2.3. A further generalization of the above optimal control problem, consists in
considering a controller having two different ways to influence the evolution of the state
process x, namely
(1) an impulse type control (Ï„n , Kn )n , hence as in equation (4) by injecting capital at
random times Ï„n ;
(2) a continuous type control Î±(t), by choosing at any time t the rate at which x is growing.
In particular an action of type 2 implies that eq. (4) can be reformulated as follows
(
P
dX(t) = ((c1 âˆ’ X(t))Î»(X(t)) + (Âµ(t) âˆ’ Î±(t))X(t)) dt + Ïƒ(t)X(t)dW (t) + n:Ï„n â‰¤t Kn
X(0) = x0

,

where Î± represents the continuous control variable Î±(t) âˆˆ [0, rÌ„], for a suitable constant rÌ„,
where Î± = 0 stands for higher returns and Î± = rÌ„ denotes lower returns. This reflects
the financial assumption that the controller, e.g. a central bank, can change the interest
rate according to macroeconomic variables, as the country inflation level, the forecast of
supranational interest rates, the the marketsâ€™ belief about the health of the financial sector
under the central bank control, etc. In fact, choosing Î± = 0 the bank value grows at rate
Âµ(t), which is strictly greater than Âµ(t) âˆ’ Î±(t) for a given control 0 < Î±(t) â‰¤ rÌ„. We refer
to the above discussion, see also, e.g., [2, 3, 8, 9, 47, 37, 19], for more financially oriented
ideas supporting the latter setting. Accordingly, we can assume that the controller aims at
maximizing a functional of the following type
 Z Ï„ âˆ§T
u,a
u,a
J u,a (t, x) = Et
f (Xt,x
(s), Î±(s))ds + g1 (Xt,x
(T ))1{Ï„ â‰¥T } +
t

X
u,a
âˆ’ g2 (Xt,x
(Ï„ ))1{Ï„ <T } âˆ’
(Kn + Îº) .
tâ‰¤Ï„n â‰¤Ï„ âˆ§T

(10)

In what follows we assume the following density hypothesis on the random time to
hold, hence requiring that the distribution of Ï„ is absolutely continuous with respect to the
Lebesgue measure:
Hypothesis 2.4. For any t âˆˆ [0, T ], there exists a process (Ït (s))tâˆˆ[0,T ] , such that
P ( Ï„ â‰¤ s| Ft ) = 1 âˆ’ Ït (s) ,

(11)

The main idea of the following procedure is to switch from the reference filtration Ft ,
to the default free filtration Gt , by mean of the following lemma, see [7, Lemma 4.1.1].
Lemma 2.5. For any FT -measurable random variable X it holds
E [ X 1T â‰¤Ï„ | Gt ] = 1{Ï„ >t}
with



E [ X 1Ï„ >T | Ft ]
= 1{Ï„ >t} eÎ“t E Xeâˆ’Î“T Ft ,
E [ 1Ï„ >t | Ft ]

Î“t := âˆ’ ln (1 âˆ’ P ( Ï„ â‰¤ t| Ft )) .

(12)

The general setting

7

A typical example, which will be used in what follows, consists in considering a Cox
process, hence taking Ï to be an exponential function of the form
Ït (s) := eâˆ’

Rs
t

Î²(r)dr

,

for a suitable function Î². In this particular case we have that
 Z s
 Rs
âˆ’ t Î²(r)dr
=
Î²(r)dr ,
Î“s := âˆ’ ln e
t

so that the equation (12) reads

E [ X 1T â‰¤Ï„ | Gs ] = 1{Ï„ >s} e

Rs
t

Î²(r)dr

i
h
RT
E Xeâˆ’ t Î²(r)dr Fs .

We can thus prove the following result.
Hypothesis 2.6. Let us assume that Ï„ is a Cox process, namely it is of the form
Ït (s) := eâˆ’

Rs
t

Î²(r)dr

(13)

,

with intensity given by Î².
Remark 2.7. Notice that we could have assumed a more general assumption, often denoted
in literature as density hypothesis, requiring that there exists a process Î² such that
P (Ï„ âˆˆ ds|Ft ) = Î²(s) ,
see, e.g. [7].
Theorem 2.8. Let F be a G -adapted process and let us assume Ï„ to be a Cox process defined
as in equation (13), then it holds
#
"Z
Z T h R
Ï„ âˆ§T
i
r
E
Fr dr Gt = 1{Ï„ >t}
E eâˆ’ t Î²(s)ds Fr Ft dr .
t

t

Proof. Exploiting (2.5) together with (13) we have that
# Z
"Z
T
Ï„ âˆ§T


E 1{Ï„ >r} 1{Ï„ >t} Fr Gt dr =
E
Fr dr Gt =
t

t

= 1{Ï„ >t}
= 1{Ï„ >t}
= 1{Ï„ >t}
= 1{Ï„ >t}

and this completes the proof.

Z
Z
Z
Z

T

E
t
T

e

h

1{Ï„ >r} Fr e

Rt
0

Î²(s)ds

Rt

Î²(s)ds

t
T

e
t
T
t

0

Rt
0

Î²(s)ds

i
Ft dr =



 
E E 1{Ï„ >r} Fr Fr Ft dr =
i
h Rr
E eâˆ’ 0 Î²(s)ds Fr Ft dr =

i
h Rr
E eâˆ’ t Î²(s)ds Fr Ft dr ,

Let us then denote the impulse control for this system by
u = (Ï„1 , Ï„2 , ..., Ï„j , ...; K1 , K2 , ..., Kj , ...) âˆˆ U ,
where 0 â‰¤ Ï„1 â‰¤ Ï„2 â‰¤ ... are Gt stopping times and Kj âˆˆ A is GÏ„j - measurable for all j, for
any u âˆˆ U , then, using (2.6) together with (2.8), the corresponding functional in equation
(7) can be rewritten as
Z T


u
Ït (s) f (X(s)) âˆ’ Î²(s)g2 (X(s)) ds + Ït (T )g1 (X(T ))+
(14)
J (t, x) = Et
t

X
âˆ’
Ït (Ï„n ) (Kn + Îº) ,
tâ‰¤Ï„n â‰¤T

so that the original stochastic control problem, with random terminal time, turns out to be
a stochastic control problem with deterministic terminal time.

On the regularity of the value function

8

Remark 2.9. A different approach would be to consider Ï„ to be Ft â€“adapted, for instance of
the form
Ï„ = inf{t : x(t) â‰¤ 0} ,
which implies that the hypothesis (11) is no longer satisfied and, consequently, the above
mentioned techniques cannot be exploited any longer. Nevertheless, under this setting it is
possible to recover a HJB equation endowed with suitable boundary conditions. We refer to
[24, 39], for a mathematical treatment of this type of stochastic control problems, while in
[35, 36] one can find applications to the mathematical finance scenario.
Theorem 2.10. (Dynamic programming principle) Let (t, x) âˆˆ [0, T ] Ã— R, then it holds
Z Î¸


V (t, x) = sup E
Ït (s) f (X(s)) âˆ’ Î²(s)g2 (X(s)) ds+
uâˆˆU [t,T ]

t

âˆ’

X

Ït (Ï„n ) (Kn + Îº) + Ït (Î¸)V



u
(Î¸, Xt,x
(Î¸))

tâ‰¤Ï„n â‰¤Î¸

,

for any stopping time Î¸ valued in [t, T ].
Proof. See, e.g., [39, 40].
For simplicity, we define the following functions
c(t, s, x) = Ït (s)(f (x) âˆ’ Î²(s)g2 (x))

with

s â‰¥ t,
(15)

g(t, x) = Ït (T )g1 (x),
which will be used throughout the paper.

3

On the regularity of the value function

The present section is devoted to prove regularity properties of the value function. In
particular the next two Lemmas prove respectively that the value function is bounded,
Lipschitz continuity in space and 21 âˆ’HoÌˆlder continuity in time of the value function V .
Lemma 3.1. Let us assume that (2.2) holds, then there exist constants C0 , C1 such that
C1 â‰¥ V (t, x) â‰¥ âˆ’C0 (1 + |x|).
Proof. For simplicity, in what follows, for any fixed (t, x) âˆˆ [0, T ] Ã— R and u âˆˆ U [t, T ], we
u
will denote for short Xt,x
(s), resp. Î¾t (s) by X(s), resp. Î¾(s). Then by Gronwallâ€™s inequality
we have
Z s
Z s
1 + |X(s)| â‰¤ 1 + |x| + |Î¾(s)| +
Ïƒ(r, X(r))dWr + C
(1 + |X(r)|) dr
t
Zt s
â‰¤ 1 + |x| + |Î¾(s)| +
Ïƒ(r, X(r))dWr +

R s C(sâˆ’r) t
Rr
+C t e
1 + |x| + |Î¾(r)| + t Ïƒ(r, X(r))dWr dr

Z s
â‰¤ C 1 + |x| + |Î¾(s)| +
|Î¾(r)|dr+
t

Rs
Rs Rr
+
Ïƒ(r,
X(r))dW
+
Ïƒ(r,
X(r))dW
dr
,
r
r
t
t
t

thus


Z s
E|X(s)| â‰¤ C 1 + E|x| + E|Î¾(s)| + E
|Î¾(r)|dr+
t

Z s
Z s Z r
+E
Ïƒ(r, X(r))dWr + E
Ïƒ(r, X(r))dWr dr .
t

t

t

(16)

On the regularity of the value function

9

On the Other hand, under (2.2), we have
Z s Z r

Z s
E
Ïƒ(r, X(r))dWr + E
Ïƒ(r, X(r))dWr dr
t

â‰¤

E

t

Z

2

s

Ïƒ(r, X(r)) dW r

t

=

Z

s

E|Ïƒ(r, X(r))|2 dr

t

â‰¤
â‰¤

[1 + (s âˆ’ t)]
(
C

Z

1/2

(s âˆ’ t)

s

!1/2

1/2

t

+ (s âˆ’ t)1/2

+ (s âˆ’ t)1/2

+

E|Ïƒ(r, X(r))| dr
2

E|X(r)| dr
t

Z

s

t

t
s

E

t

2

Z

s

Z

1/2

1/2 )

Z

r

Z

2

r

Ïƒ(r, X(r))dWr

E|Ïƒ(r, X(r))|2 drdr

t


Z
â‰¤C 1+

dr

t

s

!1/2

1/2

(17)



E|X(r)|dr ,
t

where we have exploited both the Jensenâ€™s and HoÌˆlderâ€™s inequality, several times. Hence it
follows that


Z s
Z s
E|X(s)| â‰¤ C 1 + E|x| + E|Î¾(s)| + E
|Î¾(r)|dr +
E|X(r)|dr
 t

Zt s
.
|Î¾(r)|dr .
â‰¤ C 1 + E|x| + E|Î¾(s)| + E
t

Again under (2.2), we achieve that
Z T
X
u
|J (t, x)| â‰¤
C(1 + E|X(s)|) ds + C(1 + E|X(T )|) âˆ’
Ït (rn ) (Kn + Îº)
t
tâ‰¤rn â‰¤T
!
Z
T

â‰¤C

1 + |x| + E|Î¾(T )| + E

|Î¾(r)|dr

t

For the trivial control u0 = Î¾t (.) â‰¡ 0, one has that
V (t, x) â‰¥ J u0 â‰¥ âˆ’C0 (1 + |x|) for all(t, x) âˆˆ [0, T ] Ã— R.

(18)

which proves the lower bound of the value function.
The boundedness of c(t, s, x), g(t, x), immediately gives us that value function is bounded,
i.e. there exists C1 > 0 such that
V (t, x) â‰¤ C1 .
(19)
Lemma 3.2. If (2.2) holds, the value function V (t, x) is Lipschitz continuous in x, and
1
2 â€“HoÌˆlder continuous in t, namley there exists a constant C > 0 such that, âˆ€ t1 , t2 âˆˆ [0, T ),
x1 , x2 âˆˆ R,


1
|V (t1 , x1 ) âˆ’ V (t2 , x2 )| â‰¤ C |x1 âˆ’ x2 | + (1 + |x1 | + |x2 |)|t1 âˆ’ t2 | 2 ,

Proof. Again, for simplicity, for any admissible control u âˆˆ U [t, T ], we denote for short
u
u
by Xt,x1 , resp Xt,x2 dropping the explicit dependence on the control u.
, resp Xt,x
Xt,x
2
1
Notice that, applying the ItoÌ‚-DoÌˆblin formula to |Xt,x1 (s) âˆ’ Xt,x2 (s)|2 , and using Gronwallâ€™s
lemma, we can infer that
E|Xt,x1 (s) âˆ’ Xt,x2 (s)| â‰¤ C|x1 âˆ’ x2 | ,

âˆ€ s âˆˆ [t, T ] , x1 , x2 âˆˆ R .

Therefore, by (2.2), for any fixed t âˆˆ [0, T ) and all x1 , x2 âˆˆ R and u âˆˆ U [t, T ],
Z T
|J u (t, x1 ) âˆ’ J u (t, x2 )| â‰¤ E
|c(t, s, Xt,x1 (s)) âˆ’ c(t, s, Xt,x2 (s))|ds+

(20)

t

+ |g(t, Xt,x1 (T )) âˆ’ g(t, Xt,x2 (T ))|
Z T
â‰¤ LE
|Xt,x1 (s) âˆ’ Xt,x2 (s)|ds + C|Xt,x1 (T ) âˆ’ Xt,x2 (T )|
t

â‰¤ C|x1 âˆ’ x2 | ,

(21)
(22)

On the regularity of the value function

10

which implies that
V (t, x1 ) â‰¤ J u (t, x1 ) â‰¤ J u (t, x2 ) + C|x1 âˆ’ x2 |,
and thus
V (t, x1 ) â‰¤ V (t, x2 ) + C|x1 âˆ’ x2 |.
By interchanging x1 and x2 , we get
|V (t, x1 ) âˆ’ V (t, x2 )| â‰¤ C|x1 âˆ’ x2 |.
For the time regularity, first we show that


1
2

E |Xt,x (s) âˆ’ x âˆ’ Î¾t (s)| â‰¤ C (1 + |x|)(s âˆ’ t) + E

Z

t

s


|Î¾t (s) ds|
.

(23)

For notation simplicity, we suppress the subscripts t,x for Xt,x , Î¾t and define
z(s) = X(s) âˆ’ x âˆ’ Î¾(s).
Then by (2.2), we have
|z(s)| â‰¤ C

Z

s

Z

(1 + |X(r)|) dr +

s

Ïƒ(r, X(r)) â‰¤
Z s
Z s
â‰¤C
(1 + |x| + |z(r)| + |Î¾(r)|) dr +
Ïƒ(r, X(r))dWr .
t

t

t

t

By Gronwallâ€™s inequality, we achieve

Z t
|z(s)| â‰¤ C (1 + |x|)(s âˆ’ t) +
|Î¾(r)|dr+
s
Z s
Z s Z
+
Ïƒ(r, X(r)) dWr +
t

t

r

Ïƒ(r, X(r))dWr dr

t



Using (17) and again Gronwallâ€™s, we further get


Z s
Z t
1
E|X(r)| dr
E|z(s)| â‰¤ C (1 + |x|)(s âˆ’ t) +
E|Î¾(r)|dr + (s âˆ’ t) 2 +
t

Z st
1
E|Î¾(r)|dr + (s âˆ’ t) 2 +
â‰¤ C (1 + |x|)(s âˆ’ t) +
s

Z s
+
E(1 + |x| + |Î¾(r)| + |z(r)|) dr

t
Z t
1
2
E|Î¾(r)|dr ,
â‰¤ C (1 + |x|)(s âˆ’ t) +
s

which proves (23).
For all p âˆˆ [0, âˆ), define the control space
ï£±
ï£¼
ï£²
ï£½
X
Up [t, T ] = u âˆˆ U [t, T ] E
(Ït (ri )Ki + Îº) â‰¤ 2C0 (1 + p) + C1 ,
ï£³
ï£¾
tâ‰¤ri <T

where C0 and C1 are the constants in (19) and (18). Notice that another important corollary
of (23) is that for all u âˆˆ U|x| [t, T ],


1
E |Xt,x (s) âˆ’ x âˆ’ Î¾t (s)| â‰¤ C (1 + |x|)(s âˆ’ t) 2 âˆ€ t â‰¤ s â‰¤ T.
(24)

We claim that for all |x| â‰¤ p, the value function V (t, x) satisfies
V (t, x) =

inf

uâˆˆUp [t,T ]

J u (t, x).

On the regularity of the value function

11

This is due to the fact that for any u âˆˆ U [t, T ]\Up [t, T ],
X
J u (t, x) â‰¤ C1 âˆ’ E
(Ït (ri )Ki + Îº) â‰¤ C1 âˆ’ 2C0 (1 + p) âˆ’ C1 < V (t, x) âˆ’ C0 (1 + p).
tâ‰¤ri <T

Fix x âˆˆ R and 0 â‰¤ t1 < t2 < T . For any u2 âˆˆ U|x| [t2 , T ), extend the control to [t1 , T )
by setting
(
Î¾Ëœt1 (s) = 0 âˆ€ s âˆˆ [t1 , t2 ),
Î¾Ëœt1 (s) = Î¾t2 (s)

âˆ€ s âˆˆ [t2 , T ).

.
and call uÌƒ1 = Î¾Ìƒt1 (Â·) âˆˆ U [t1 , T ]. Then we have
V (t1 , x) â‰¤ J uÌƒ1 (t1 , x)
Z t2
c(t1 , s, Xt1 ,x (s)) ds
= J u2 (t2 , x) + E
t1
Z T
[c(t1 , s, Xt1 ,x (s)) âˆ’ c(t2 , s, Xt2 ,x (s))] ds+
+E

(25)

t2

+ E [g(t1 , Xt1 ,x (T )) âˆ’ g(t2 , Xt2 ,x (T ))]

1

â‰¤ J u2 (t2 , x) + C(1 + |x|)|t1 âˆ’ t2 | + C(1 + |x|)(|t1 âˆ’ t2 | 2 )
1

â‰¤ J u2 (t2 , x) + C(1 + |x|)(|t1 âˆ’ t2 | 2 ),
where Xt1 ,x (s), resp Xt2 ,x (s) represents XtuÌƒ11,x , resp Xtu22,x and the second last row in (25) is
achieved by exploiting (23). So we obtain that
1

V (t1 , x) â‰¤ V (t2 , x) + C(1 + |x|)|t1 âˆ’ t2 | 2 .
On the other hand, for any Îµ > 0, there exists u1 âˆˆ U|x| [t1 , T ), such that
Îµ + V (t1 , x) â‰¥ J u1 (t1 , x).
Then we define the impulse controls uÌ‚2 , uÌ„2 âˆˆ U [t2 , T ) by
Î¾Ì‚t2 (s) = Î¾t1 (s) âˆ€ s â‰¥ t2 ,
Î¾Â¯t2 (s) = Î¾t1 (s) âˆ’ Î¾t1 (t2 ) âˆ€ s â‰¥ t2 .
Notice that uÌ‚2 is the impulse control such that at the initial time t2 , there is a impulse of
size Î¾t1 (t2 ) and uÌ„2 is the impulse control mimicing all the impulses in Î¾t1 (Â·) on [t2 , T ). By
denoting xÌ„ = x + Î¾t1 (t2 ), which is Ft2 adapted, we have that
J uÌ‚2 (t2 , x) = J uÌ„2 (t2 , xÌ„) âˆ’ (Î¾t1 (t2 ) + Îº),
and thus
Îµ + V (t1 , x)

â‰¥ J

uÌ‚2

(t2 , x) + E

Z

T

(c(t1 , s, Xt1 ,x (s)) âˆ’ c(t2 , s, Xt2 ,xÌ„ (s)))

t2

+E[g(t1 , Xt1 ,x (T )) âˆ’ g(t2 , Xt2 ,xÌ„ (T ))] ds
X
+
(1 âˆ’ Ït1 (ri ))(Ki + Îº)
+

t1 â‰¤ri <t2
P
ri â‰¥t2 (Ït2 (ri ) âˆ’ Ït1 (ri ))(Ki + Îº)

â‰¥ V (t2 , x) âˆ’ C(1 + |x|)(t2 âˆ’ t1 )+
RT
âˆ’CE|Xt1 ,x (T ) âˆ’ Xt2 ,xÌ„ (T )| âˆ’ C t2 E|Xt1 ,x (s) âˆ’ Xt2 ,xÌ„ (s)| ds
1

â‰¥ V (t2 , x) âˆ’ C(1 + |x|)(t2 âˆ’ t1 ) 2 ,

(26)

Viscosity solution to the Hamiltonâ€“Jacobiâ€“Bellman equation

12

where Xt1 ,x , resp Xt2 ,x represents Xtu11,x , resp XtuÌ„22,x . Notice that in (26), we extensively use
the following inequality
E|Xt1 ,x (s) âˆ’ Xt2 ,xÌ„ (s)|

â‰¤ CE|Xt1 ,x (t2 ) âˆ’ Xt2 ,xÌ„ (t2 )|
= CE|Xt1 ,x (t2 ) âˆ’ x âˆ’ Î¾t1 (t2 )|
1

â‰¤ C(1 + |x|)(t2 âˆ’ t1 ) 2
for all s â‰¥ t2 and u1 âˆˆ U|x| [t1 , T ), where the last row is achieved by (24).
Since (26) holds for all Îµ > 0, we obtain
1

V (t1 , x) â‰¥ V (t2 , x) âˆ’ C(1 + |x|)(t2 âˆ’ t1 ) 2 .
Adding (25), we finally get the 12 âˆ’HoÌˆlder continuity in time, i.e.
1

|V (t1 , x) âˆ’ V (t2 , x)| â‰¤ C(1 + |x|)|t1 âˆ’ t2 | 2 .

4

Viscosity solution to the Hamiltonâ€“Jacobiâ€“Bellman
equation

An application of an ad hoc dynamic programming principle (2.10), see, e.g., [39, 40],
leads to the following quasiâ€“variational inequality (QVI).
i
ï£±
h
ï£²min âˆ’ âˆ‚ V (t, x) âˆ’ L V (t, x) âˆ’ f (x) + Î²(t)(V (t, x) + g2 (x)) , V (t, x) âˆ’ I V (t, x) = 0 ,
âˆ‚t
ï£³

V (T, x) = g1 (x) ,

on [0, T ) Ã— R,

on {T } Ã— R ,

(27)

with I being the nonâ€“local impulse operator defined as
I V (t, x) :=

sup

[V (t, x + K) âˆ’ (K + Îº))] .

KâˆˆA (t,x)

We underline that the problem (27) identifies two distinct regions: the continuation
region
C = {(t, x) âˆˆ [0, T ) Ã— R : V (t, x) > I V (t, x)} ,
and the impulse region or action region
A = {(t, x) âˆˆ [0, T ) Ã— R : V (t, x) = I V (t, x)} .
Let us consider the following function space.
Definition 4.0.1. (Space of polynomially bounded functions).
PB = PB([0, T ] Ã— R) is the space of all measurable function u : [0 : T ] Ã— R â†’ R such that
|u(t, x)| â‰¤ Cu (1 + |x|p )
for some constant p > 0 and Cu > 0, independent of t, x.
Let us introduce in what follows the definition of viscosity solution to the QVI, see eq.
(27), within in the general setting (possibly not continuous).
Definition 4.0.2. A function V âˆˆ PB is said to be a viscosity solution to the QVI (27) if
the following two properties hold:

Viscosity solution to the Hamiltonâ€“Jacobiâ€“Bellman equation

13

(i) viscosity supersolution a function V âˆˆ PB is said to be a viscosity supersolution to
the QVI (27) if âˆ€ (tÌ‚, xÌ‚) âˆˆ [0, T ] Ã— R and Ï† âˆˆ C 1,2 ([0, T ] Ã— R) with
0 = (Vâˆ— âˆ’ Ï†) (tÌ‚, xÌ‚) =

min

(t,x)âˆˆ[0,T )Ã—R

(Vâˆ— âˆ’ Ï†) ,

it holds
ï£±
h
i
âˆ‚
ï£´
ï£²min âˆ’ âˆ‚t
Ï†(t, x) âˆ’ L Ï†(t, x) âˆ’ f (x) + Î²(t)(Ï†(t, x) + g2 (x)) , Vâˆ— (t, x) âˆ’ I Vâˆ— (t, x) â‰¥ 0 ,
ï£´
ï£³min [V (T, x) âˆ’ g (x), V (T, x) âˆ’ I V (T, x)] â‰¥ 0 ,
âˆ—
âˆ—
âˆ—
1

on [0, T ) Ã— R
;

on {T } Ã— R ,

(ii) viscosity subsolution a function V âˆˆ PB is said to be a viscosity subsolution to the
QVI (27) if âˆ€ (tÌ‚, xÌ‚) âˆˆ [0, T ] Ã— R and Ï† âˆˆ C 1,2 ([0, T ] Ã— R) with
0 = (V âˆ— âˆ’ Ï†) (tÌ‚, xÌ‚) =

max

(t,x)âˆˆ[0,T )Ã—R

(V âˆ— âˆ’ Ï†) ,

it holds
ï£±
h
i
âˆ‚
ï£´
ï£²min âˆ’ âˆ‚t
Ï†(t, x) âˆ’ L Ï†(t, x) âˆ’ f (x) + Î²(t)(Ï†(t, x) + g2 (x)) , V âˆ— (t, x) âˆ’ I V âˆ— (t, x) â‰¤ 0 ,
ï£´
ï£³min [V âˆ— (T, x) âˆ’ g (x), V âˆ— (T, x) âˆ’ I V âˆ— (T, x)] â‰¤ 0 ,
1

on [0, T ) Ã— R

on {T } Ã— R ,

(iii) viscosity solution a function V âˆˆ PB is said to be a viscosity solution to the QVI
(27) if it is both a viscosity supersolution and a viscosity subsolution.
In order to prove that the value function V is the viscosity solution to equation (27), we
first need the following
Lemma 4.1. Let (2.2) holds, then we have
V (t, x) â‰¥ I V (t, x) ,
for all t âˆˆ [0, T ), x âˆˆ R.
Proof. Reasoning by contradiction, we first suppose that there exists (t, x) âˆˆ S := [0, T ) Ã—
[0, +âˆ), such that
V (t, x) < I V (t, x),
i.e.,
V (t, x) < sup V (t, x + K) âˆ’ (K + k) ,
KâˆˆA

then there exists also Ç« > 0 and KÌ‚ âˆˆ A , such that
V (t, x) < V (t, x + KÌ‚) âˆ’ (KÌ‚ + k) âˆ’ 2Ç« .
On the other hand, according to equation (6), there exists u âˆˆ U [t, T ] such that
J u (t, x + KÌ‚) > V (t, x + KÌ‚) âˆ’ Ç« .
.
Defining now uÌ‚ = Î¾Ì‚t (Â·) = KÌ‚ + Î¾t (Â·), we have
V (t, x) â‰¥ J uÌ‚ (t, x) = J u (t, x + KÌ‚) âˆ’ (KÌ‚ + k) .
Combining all the estimates above, we have
V (t, x + KÌ‚) âˆ’ (KÌ‚ + k) âˆ’ 2Ç« > V (t, x) > V (t, x + KÌ‚) âˆ’ (KÌ‚ + k) âˆ’ Ç« ,
from which we have the desired contradiction.
Remark 4.2. (4.1) implies that we are considering I V (t, x) as a lower obstacle, which is
given in implicit form, since it depends on the value function V itself.

;

Viscosity solution to the Hamiltonâ€“Jacobiâ€“Bellman equation

14

Theorem 4.3. The value function V (t, x) is a viscosity solution to the QVI (27) on [0, T ]Ã—
R, in the sense of (4.0.2).
Proof. (3.2) implies that the value function is continuous. Therefore the lowerâ€“semicontinuous,
resp. upperâ€“semicontinuous, envelop of V in (4.0.2), does in fact coincide with V . Also, it
is an immediate consequence of (3.1) that V âˆˆ PB.
Let us prove that V (t, x) is a viscosity sub-solution of (14). By (4.1), we know that
V (t, x) â‰¥ I V (t, x), so that in what follows we only need to show that given (t0 , x0 ) âˆˆ
[0, T ) Ã— R such that
V (t0 , x0 ) > I V (t0 , x0 ) ,
(28)
then for every Ï†(t, x) âˆˆ C 1,2 ([0, T ] Ã— [0, +âˆ)) and every t0 , x0 âˆˆ [0, +âˆ), such that Ï† â‰¥ V
for all (t, x) âˆˆ S âˆ© Br ((t0 , x0 )) and V (t0 , x0 ) = Ï†(t0 , x0 ), we want to show that
âˆ’


âˆ‚
Ï†(t0 , x0 ) âˆ’ L Ï†(t0 , x0 ) âˆ’ f (x0 ) + Î²(t0 ) Ï†(x0 ) + g2 (x0 ) â‰¤ 0 .
âˆ‚t

(29)

In fact, if V (t0 , x0 ) â‰¤ I V (t0 , x0 ), then (29) immediately follows.
Choose Ç« > 0 and let u = (Ï„1 , Ï„2 , ...; K1 , K2 , ...) âˆˆ U [t0 , T ] be a Ç«- optimal control, i.e.,
V (t0 , x0 ) < J u (t0 , x0 ) + Ç«.
Since Ï„1 is a stopping time, {Ï‰, Ï„1 (Ï‰) = t0 } is Ft0 - measurable, thus
Ï„1 (Ï‰) = t0 a.s.

or

Ï„1 (Ï‰) > t0 a.s.

If Ï„1 = t0 a.s., Xtu0 ,x0 takes a immediate jump from x0 to the point x0 + K1 and we have
â€²
J u (t0 , x0 ) = J u (t0 , x0 + K1 ) âˆ’ (K1 + k) where uâ€² = (Ï„2 , Ï„3 , ...; K2 , K3 , ...) âˆˆ U [t0 , T ]. This
implies that
â€²

V (t0 , x0 ) â‰¤ J u (t0 , x0 + K1 ) âˆ’ (K1 + k) + Ç« < V (t0 , x0 + K1 ) âˆ’ (K1 + k) â‰¤ I V (t0 , x0 ) + Ç«,
which is a contradiction for Ç« < V (t0 , x0 ) âˆ’ I V (t0 , x0 ). Thus (28) implies that Ï„1 > t0 a.s
for all Ç«- optimal controls such that Ç« < V (t0 , x0 ) âˆ’ I V (t0 , x0 ). For any impulse control
u = (Ï„1 , Ï„2 , ...; K1 , K2 , ...) âˆˆ U [t0 , T ], define
n
o
.
Ï„Ì‚ = Ï„1 âˆ§ (t0 + r) âˆ§ inf t t > t0 , |x(t) âˆ’ x0 | â‰¥ r .

By the dynamic programming principle, for any Ç« > 0, there exists a control u such that
"Z
#
Ï„Ì‚ n
o
R Ï„Ì‚

âˆ’
Î²(s)
ds
V (Ï„Ì‚ , X(Ï„Ì‚ ))) + Ç«.
V (t0 , x0 ) â‰¤ E t0 ,x0
Ït0 (s) f (X(s)) + Î²(s)g2 (x(s)) ds + e t0
t0

(30)

By (30) and the Dynkin formula we have that
V (t0 , x0 ) â‰¤
i
hR n
R
o
Ï„Ì‚
âˆ’ Ï„Ì‚ Î²(s) ds
Ï†(Ï„Ì‚ , X(Ï„Ì‚ ))) + Ç«
â‰¤ E t0 ,x0 t0 Ït0 (s) f (X(s)) + Î²(s)g2 (X(s)) ds + e t0
"Z (
) #
Ï„Ì‚

 
t0 ,x0
= E
ds +
Ït0 (s) f (X(s)) + Î²(s) g2 (X(s)) âˆ’ Ï†(s, X(s)) +
0
"Z t(
) #
Ï„Ì‚
âˆ‚

E t0 ,x0
Ït0 (s)
Ï†(s, X(s)) + L Ï†(s, X(s))
ds + Ï†(t0 , x0 ) + Ç«.
âˆ‚t
t0

(31)

Using that V (t0 , x0 ) = Ï†(t0 , x0 ), we further obtain

E

t0 ,x0

Z

Ï„Ì‚

t0

(



Ït0 (s) f (X(s)) + Î²(s) g2 (X(s)) âˆ’ Ï†(s, X(s)) +

) 

âˆ‚
ds + Ï†(t0 , x0 ) â‰¥ âˆ’Ç«.
+ Ï†(s, X(s)) + L Ï†(s, X(s))
âˆ‚t

(32)

Viscosity solution to the Hamiltonâ€“Jacobiâ€“Bellman equation

15

Divide both sides of (32) by E(Ï„Ì‚ âˆ’ t0 ) and let r â†’ 0, we further get that

âˆ‚
f (x0 ) + Î²(t0 ) g(x0 ) âˆ’ Ï†(t0 , x0 ) + Ï†(t0 , x0 ) + L Ï†(t0 , x0 ) â‰¥ âˆ’Ç«.
âˆ‚t

Since Ç« > 0 is arbitrary, we finally get the desired inequality


âˆ‚
âˆ’ f (x0 ) + Î²(t0 ) Ï†(t0 , x0 ) + g2 (x0 ) âˆ’ Ï†(t0 , x0 ) âˆ’ L Ï†(t0 , x0 ) â‰¤ 0 ,
âˆ‚t

(33)

then V (t, x) is a viscosity sub-solution.
To prove that V (t, x) is also a viscosity super-solution of (14), let us consider Ï† âˆˆ
C 1,2 (S ), and any (t0 , x0 ) âˆˆ S such that Ï† â‰¤ V on Br (t0 , x0 ) and Ï†(t0 , x0 ) = V (t0 , x0 ).
Taking the trivial control u0 = 0 ( no interventions ), calling then corresponding trajectory
o

X(t) = X u0 (t) with x(t0 ) = x0 , and defining Ï„Ì‚ = (t0 + r) âˆ§ inf t t > t0 , |x(t) âˆ’ x0 | > r ,
then, by the dynamic programming principle and the Dynkin formula, we have
"Z
#
Ï„Ì‚ n
R
o
âˆ’ tÏ„Ì‚ Î²(s) ds
t0 ,x0
Ï†(Ï„Ì‚ , X(Ï„Ì‚ )))
V (t0 , x0 ) â‰¥ E
Ït0 (s) f (X(s)) + Î²(s)g2 (X(s)) ds + e 0
t0
"Z (
) #
Ï„Ì‚


ds +
= E t0 ,x0
Ït0 (s) f (x(s)) + Î²(s) g2 (X(s)) âˆ’ Ï†(s, X(s))
t0
) #
"Z (
Ï„Ì‚

âˆ‚
t0 ,x0
Ï†(s, X(s)) + L Ï†(s, X(s))
ds + Ï†(t0 , x0 ) + Ç«.
E
Ït0 (s)
âˆ‚t
t0
Using V (t0 , x0 ) = Ï†(t0 , x0 ), we obtain that

E

t0 ,x0

Z

Ï„Ì‚

t0

(



Ït0 (s) f (X(s)) + Î²(s) g2 (X(s)) âˆ’ Ï†(s, X(s)) +

(34)

) 

âˆ‚
Ï†(s, X(s)) + L Ï†(s, X(s))
ds â‰¤ âˆ’Ç«.
âˆ‚t

Divide both sides of (34) by E[Ï„Ì‚ âˆ’ t0 ] and let r â†’ 0, we obtain

âˆ‚
âˆ’ f (x0 ) + Î²(t0 ) Ï†(t0 , x0 ) + g2 (x0 ) âˆ’ Ï†(t0 , x0 ) âˆ’ L Ï†(t0 , x0 ) â‰¥ 0 .
âˆ‚t

Since we have already proved that V (t, x) â‰¥ I V (t, x), we finally conclude that


âˆ‚
min âˆ’ Ï†(t0 , x0 ) âˆ’ L Ï†(t0 , x0 ) âˆ’ f (x0 ) + Î²(t0 ) Ï†(x0 ) + g2 (x0 ) ,
âˆ‚t

, V (t0 , x0 ) âˆ’ I V (t0 , x0 ) â‰¥ 0 .

(35)

(36)
(37)

Combining (29) and (36), we have that v(t, x) is a viscosity solution of (14). it is worth to
mention that the terminal condition is non trivial. In fact, it has to take into account that
just right before the horizon time T , the controller might act by an impulse control. To this
extent we have to specify that the terminal condition in equation (27) is to be intended as
V (T, x) :=

lim

(t,xâ€² )â†’(T âˆ’ ,x))

V (t, xâ€² ) .

Since (4.1) implies that V (t, x) â‰¥ I V (t, x) for all (t, x) âˆˆ [0, T ) Ã— R, in the limit one has
V (T, x) â‰¥ I V (T, x) for all x âˆˆ R. To show the boundary condition

min V (T, x) âˆ’ g1 (x), V (T, x) âˆ’ I V (T, x) = 0,
(38)

one first consider all the x âˆˆ R such that V (T, x) > I V (T, x). For any sequence (tn , xn ) â†’
(T, x) with (tn , xn ) âˆˆ [0, T ) Ã— R, by continuity one has V (tn , xn ) > I V (tn , xn ) for all n

Viscosity solution to the Hamiltonâ€“Jacobiâ€“Bellman equation

16

large enough. Then for each Îµ > 0 sufficiently small, consider controls un âˆˆ U [tn , T ] such
that
V (tn , xn ) â‰¤ J un (tn , xn ) + Îµ.
It then suffices to show that
"Z
#
T


E
Ïtn (s) f (Xtunn,xn (s)) âˆ’ Î²(s)g2 (Xtunn,xn (s)) ds +

(39)

tn

ï£®

+E ï£°Ïtn (T )g1 (Xtunn,xn (T )) âˆ’

X

tn â‰¤Ï„j â‰¤T

ï£¹

Ïtn (Ï„j ) (Kj + Îº)ï£» â†’ g1 (x)

as n â†’ +âˆ. Notice that since V (t, xâ€² ) > I V (t, xâ€² ) for all (t, xâ€² ) in a neighborhood of (T, x),
for all Î´ > 0 small enough one has


P sup |Xtunn,xn (s) âˆ’ xn | < Î´ â†’ 1 as n â†’ âˆ.
sâˆˆ[tn ,T ]

Suppose that there exists F âˆˆ L1 (P; R) such that
Z

T

tn



Ïtn (s) |f (Xtunn,xn (s))| + Î²(s)|g2 (Xtunn,xn (s))| ds+

Ïtn (T )|g1 (Xtunn,xn (T ))| + |

X

Ïtn (Ï„j ) (Kj + Îº) | â‰¤ F

tn â‰¤Ï„j â‰¤T

for all n large enough, an application of dominant convergence theorem proves (39). So
we conclude that for any (T, x) such that V (T, x) > I V (T, x), one has
V (T, x) â‰¤ g1 (x) + Îµ, âˆ€Îµ > 0

=â‡’

V (T, x) â‰¤ g1 (x).

By a similar approach, one can show that V (T, x) â‰¥ g1 (x) for all x âˆˆ R. This completes the
proof of (38).
We are now to show that the value function is the unique viscosity solution to equation
(27) based on a comparison principle. In order to do that let us introduce a different
definition of viscosity solution, see, e.g. [28], based on the notion of jets.
Definition 4.3.1. Let V : [0, T ] âˆˆ PB a upperâ€“semicontinuous function, then we define
P 2,+ V (s, x) =

n

(p, q, M ) âˆˆ R Ã— R Ã— R :

o
1
V (s, y) â‰¤ V (t, x) + p(t âˆ’ s) + q(x âˆ’ y) + M (x âˆ’ y)2 + o(|t âˆ’ s| + |x âˆ’ y|2 )
2
PÌ„ 2,+ V (s, x) = {(p, q, M ) âˆˆ R Ã— R Ã— R : âˆƒ(tn , xn ) âˆˆ [0, T ] Ã— R : (pn , qn , Mn ) âˆˆ P 2,+ V (tn , xn )
, (tn , xn , V (tn , xn ), pn , qn , Mn ) â†’ (t, x, V (t, x), p, q, M )} .
For lowerâ€“semicontinuous function V , we define
P 2,âˆ’ V (s, x) := âˆ’P 2,+ âˆ’ V (s, x) ,

PÌ„ 2,âˆ’ V (s, x) := âˆ’PÌ„ 2,+ âˆ’ V (s, x) .

We can therefore state the equivalence between the two notion of viscosity solution stated
before.
Proposition 4.4. A function V âˆˆ PB is a viscosity sub, resp. super, solution to equation
(27) if and only if âˆ€ (p, q, M ) âˆˆ PÌ„ 2,+ V (s, x), resp. PÌ„ 2,âˆ’ V (s, x),

1
(40)
min âˆ’ p âˆ’ Âµ(t, x)q âˆ’ Ïƒ 2 (t, x)M âˆ’ f (x) + Î²(t)(V (t, x) + g2 (x)) ,
2

, V (t, x) âˆ’ I V (t, x) â‰¤ 0 ( â‰¥ 0) .
(41)

Viscosity solution to the Hamiltonâ€“Jacobiâ€“Bellman equation

17

Theorem 4.5 (Comparison principle). Suppose that (2.2) is satisfied and that U and V
are, repectively, a viscosity super solution and viscority sub solution to the equation (27).
Assume also that U and V are uniformly continuous, then V â‰¤ U on [0, T ] Ã— R.
Proof. Let us prove the result by contradiction, assuming that
sup (V âˆ’ U ) = Î· > 0 .
[0,T ]Ã—R

For r > 0 let us define
VÌƒ (t, x) := ert V (x, t) ,

UÌƒ (t, x) := ert U (t, x) .

From the theorem hypotheses, that is U and V are viscosity super and sub solution to
equation (27), we immediately have that VÌƒ and UÌƒ are viscosity super and sub solution to

ï£±
ï£´
âˆ‚
ï£´
min
ru(t, x) âˆ’ âˆ‚t
u(t, x) âˆ’ L u(t, x) âˆ’ ert f (x) + ert Î²(t)(V (t, x) + g2 (x)) ,
ï£´
ï£´
ï£²

,
Ëœ
,
u(t,
x)
âˆ’
I
u(t,
x)
= 0 , on [0, T ) Ã— R
ï£´
ï£´
ï£´
ï£´
ï£³
u(T, x) = ert g1 (x) ,
on {T } Ã— R ,
with IËœ being the nonâ€“local impulse operator defined as


IËœu(t, x) := sup
u(t, x + K) âˆ’ ert (K + Îº)) .
KâˆˆA (t,x)

Let us then assume that for x0 âˆˆ R we have that

VÌƒ (T, x0 ) âˆ’ UÌƒ (T, x0 ) > 0 ,
and from the fact that UÌƒ is a viscosity super solution, resp. VÌƒ is a viscosity sub solution,
we have that it exists xÌ„ such that
UÌƒ (T, xÌ„) < IËœUÌƒ (T, xÌ„) ,

resp. VÌƒ (T, xÌ„) > IËœVÌƒ (T, xÌ„) .

Since we also have that VÌƒ (T, xÌ„) â‰¤ ert g1 (xÌ„) and UÌƒ (T, xÌ„) â‰¥ ert g1 (xÌ„), we conclude that
VÌƒ (T, xÌ„) âˆ’ UÌƒ (T, xÌ„) â‰¤ 0 ,
which contradict the assumptions.
Then suppose that there exists (tÌ„, xÌ„) âˆˆ [0, T ) Ã— R, such that
VÌƒ (tÌ„, xÌ„) âˆ’ UÌƒ (tÌ„, xÌ„) > 0 ,
then, analogously to what we have derived above, we have that
UÌƒ (t, x) < IËœUÌƒ (t, x) ,

resp.

VÌƒ (t, x) > IËœVÌƒ (t, x) ,

for t âˆˆ IÎ´ := [tÌ„ âˆ’ Î´, tÌ„ + Î´] and x âˆˆ BÎ´ := [xÌ„ âˆ’ Î´, xÌ„ + Î´].
Therefore taking (t0 , x0 ) âˆˆ IÎ´ Ã— BÎ´ , such that
sup VÌƒ âˆ’ UÌƒ = (VÌƒ âˆ’ UÌƒ )(t0 , x0 ) > 0 ,

IÎ´ Ã—BÎ´

and considering
Ï•n (t, x, y) := VÌƒ (t, x) âˆ’ UÌƒ (t, x) âˆ’ Ìºn (t, x, y) ,
with
Ìºn (t, x, y) = n|x âˆ’ y|2 + |x âˆ’ x0 |4 + |t âˆ’ t0 |2 ,
for any n âˆˆ N there exist a point (tn , xn , yn ) attaining the maximum of Ï•, so that, up to a
subsequence, we have
VÌƒ (tn , xn ) âˆ’ UÌƒ (tn , xn ) â†’ VÌƒ (t0 , x0 ) âˆ’ UÌƒ (t0 , x0 ) ,

as n â†’ âˆ .

(42)

Smooth fit principle on the value function

18

Moreover, since
VÌƒ (t0 , x0 ) âˆ’ UÌƒ (t0 , x0 ) = Ï•n (t0 , x0 , x0 ) â‰¤ Ï•n (tn , xn , xn ) ,
then
VÌƒ (t0 , x0 ) âˆ’ UÌƒ (t0 , x0 ) â‰¤ lim inf Ï•n (t0 , x0 , y0 ) â‰¤ lim sup Ï•n (t0 , x0 , y0 ) â‰¤
nâ†’âˆ

nâ†’âˆ

â‰¤ VÌƒ (tÌ„, xÌ„) âˆ’ UÌƒ (tÌ„, xÌ„) âˆ’ lim inf n|x âˆ’ y|2 + |x âˆ’ x0 |4 + |t âˆ’ t0 |2 .
nâ†’âˆ

Therefore, using the optimality of (x0 , t0 ), we obtain that, considering up to a subsequence it holds (tn , xn , yn ) â†’ (t0 , x0 , x0 ) and n|xn âˆ’ yn | â†’ 0.
Applying the Ishii lemma, we have that there exists (pnV , qVn , MVn ) âˆˆ PÌ„ 2,+ VÌƒ (tn , xn ) and
n
n
(pU , qU
, MUn ) âˆˆ PÌ„ 2,âˆ’ UÌƒ (tn , xn ), such that
pnV âˆ’ pnV = 2(tn t0 ) ,
n
qVn = âˆ‚x Ìºn , qU
= âˆ’âˆ‚y Ìºn ,
and


Mn
0

0
âˆ’Nm



â‰¤ An +

1 n
A ,
2n n

with An = âˆ‚xy Ìºn . Therefore from the viscosity sub-solution property of VÌƒ , resp. the
viscosity super-solution property of UÌƒ , by the Lipschitz continuity of Âµ and Ïƒ in x and
(4.3.1) we have that


r VÌƒ (t0 , x0 ) âˆ’ UÌƒ (t0 , x0 ) â‰¤ 0 ,

which gives the desired contradiction.

We are now able to state the uniqueness result for the viscosity solution.
Corollary 4.6. Let (2.2) hold true, then there exists a unique viscosity solution to equation
(27).
Proof. Let V1 and V2 two viscosity solution to equation (27); then since V1 is a subsolution
and V2 is a supersolution, by comparison principle (4.5) we obtain that V2 â‰¤ V1 . Since it
must also holds the opposite we obtain the claim.

5

Smooth fit principle on the value function

Under further regularity assumptions on the coefficients, to be further specified in a while,
one can prove the regularity property of the value function, with particular reference to
the smooth-fit property through the switching boundaries between action and continuation
regions. This results, known as smoothâ€“fit principle, see, e.g, [27, 22, 25], has already been
(1,2),p
proven to hold in the infinite horizon case. Also, we will prove Wloc
regularity for the
.
value function V (t, x) on any fixed parabolic domain QT = (Î´, T ] Ã— BR (0) for any constants
0 < Î´ < T, R > 0.
In what follows we introduce the definition of the function spaces we are going to use
throughout the section, â„¦ being a bounded open set:
W (0,1),p (â„¦) = {u âˆˆ Lp (â„¦) : uxi âˆˆ Lp (â„¦)},
W (1,2),p (â„¦) = {u âˆˆ W (0,1),p (â„¦) : uxi xj âˆˆ Lp (â„¦)},
n
o
Î±
|u(t,x)âˆ’u(s,y)|
C 0+ 2 ,0+Î± (â„¦Ì„) = u âˆˆ C(â„¦Ì„) : sup(x,t),(y,s)âˆˆâ„¦,(x,t)6=(y,s) (|tâˆ’s|+|xâˆ’y|
,
2 )Î±/2 < +âˆ

Î±
Î±
C 1+ 2 ,2+Î± (â„¦Ì„) = u âˆˆ C(â„¦Ì„) : ut , uxi xj âˆˆ C 0+ 2 ,0+Î± ,

(1,2),p
Wloc (â„¦) = u âˆˆ Lploc (â„¦) : u âˆˆ W (1,2),p (U ) âˆ€ open U with UÌ„ âŠ‚ â„¦Ì„\âˆ‚P â„¦ .

(43)

5.1 Structure of the value function

19

The above notations are similar to the notations used in [26].
Recall that Î²(t) is the hazard rate function defined in (13) and we make the following
assumption:
Hypothesis 5.1. Let Î± âˆˆ (0, 1], we assume that the intensity function Î²(t) âˆˆ C Î±/2 ([0, T ])
Î±
and Ïƒ(s, x) âˆˆ C 0+Î±,0+ 2 (QÌ„T ) satisfying the uniform elliptic condition, i.e.
Ïƒ(s, x) â‰¥ Î´1 > 0
for some constant Î´1 > 0 depending on the domain QT .
Before proceeding to the smooth fit principle, recall that we divide the region [0, T ] Ã— R
into the following regions:
.
C = {(t, x) : V (t, x) > I V (t, x)} ,
.
A = {(t, x) : V (t, x) = I V (t, x)}
and for any open set â„¦ âˆˆ R2 , the parabolic boundary âˆ‚P â„¦ is defined as
. 
âˆ‚P â„¦ = (t, x) âˆˆ â„¦Ì„| âˆ€Îµ > 0, Q((t, x), Îµ) contains points not in â„¦ ,

.
where Q((t0 , x0 ), r) = {(t, x); |x âˆ’ x0 | < r, t < t0 } for all (t0 , x0 , r) âˆˆ R2 Ã— R+ . For any
(t, x) âˆˆ A , define the set
Î˜(t, x) = {Î¾0 | I V (t, x) = V (t, x + Î¾0 ) âˆ’ Î¾0 âˆ’ Îº} .
Notice that in the regularity analysis in Section 2, we already show that V (T âˆ’ t, x) âˆˆ
C 0+1/2,0+1 (â„¦), so we immediately have the following lemma.

Lemma 5.2. (Theorem 4.9,5.9,5.10,and 6.33 in [34]) Under (2.2) and (5.1), for any open
set â„¦ âŠ† C , the linear parabolic PDE
ï£±
ï£² ut âˆ’ L u(t, x) + Î²Ìƒ(t)u(t, x) = fËœ(t, x) in â„¦,
(44)
ï£³ u(t, x) = V (T âˆ’ t, x), on âˆ‚ â„¦.
P
1+Î±/2,2+Î±

admits a unique solution u(t) âˆˆ C 0+Î±/2,0+Î± (â„¦Ì„) âˆ© Cloc
Î²Ìƒ(t) = Î²(T âˆ’ t),

(â„¦) where

fËœ(t, x) = f (x) âˆ’ Î²(t)g2 (x).

Theorem 5.3. (Smooth fit principle) Under (2.2) and (5.1), the value function V (t, x)
(1,2),p
is a unique Wloc (R Ã— (0, T )) viscosity solution to the QVI (27) for any 1 < p < +âˆ.
1,Î³
Furthermore, for any t âˆˆ [0, T ), V (t, Â·) âˆˆ Cloc
(R) for any 0 < Î³ < 1.
Proof. Using the cost function
.
B(K) = K + Îº, âˆ€ K > 0,
which is independent of time and satisfies the subadditivity property, i.e.
B(K1 + K2 ) + Îº = B(K1 ) + B(K2 ), âˆ€ K1 , K2 > 0.

(45)

so that the claim follows from [26] together with (5.2).

5.1

Structure of the value function

In this subsection, we study the general property of the value function V (t, x) under
further assumptions of Ïƒ(t, x), Î²(t), Âµ(t, x), fËœ(t, x) and g1 (x).
Hypothesis 5.4. fËœ(t, x) and g1 (x) are monotonically increasing with
lim fËœ(t, x) = lim g1 (x) = âˆ’âˆ,

xâ†’âˆ’âˆ

xâ†’âˆ’âˆ

lim fËœ(t, x) = U (t) > 0, lim g1 (x) = Ug < âˆ.

xâ†’+âˆ

xâ†’+âˆ

5.1 Structure of the value function

20

Lemma 5.5. Under (5.4), for any t > 0 the value function V (t, x) satisfies
V (t, x1 ) â‰¤ V (t, x2 ) âˆ€ x1 â‰¤ x2 .
Furthermore, there exists L âˆˆ [âˆ’âˆ, +âˆ) such that
[0, T ] Ã— (L, +âˆ) âŠ‚ C .
Proof. First, we show the monotonicity of V (t, x) with respect to x. By applying the same
adapted control u âˆˆ U [t, T ] with different initial values x1 â‰¤ x2 , the solutions satisfies
u
u
a.s. Since fËœ(t, x) is increasing with respect to x, one has J u (t, x1 ) â‰¤ J u (t, x2 )
â‰¤ Xt,x
Xt,x
2
1
for all u âˆˆ U [t, T ], and thus V (t, x1 ) â‰¤ V (t, x2 ) for any x1 â‰¤ x2 .
It remains to show that there exists L âˆˆ [âˆ’âˆ, +âˆ) such that for any fixed t > 0
and any x0 > L, (t, x0 ) âˆˆ C . Fix any t âˆˆ (0, T ), suppose that there exists a sequence
x1 < x2 < ... < xk < ... such that
lim xk = +âˆ and (t, xk ) âˆˆ A , âˆ€ k > 0,

kâ†’+âˆ

and for any k > 0 there exists Î¾k âˆˆ Î˜(t, xk ) such that
V (t, xk ) = V (t, xk + Î¾k ) âˆ’ Î¾k âˆ’ Îº.

(46)

However, since V (t, x) is monotone, uniformly Lipschitz continuous in x and upper bounded
by C1 according to (3.1) and (3.2), for any Îµ > 0 one can choose L large enough such that
V (t, x + Î¾) âˆ’ V (t, x) â‰¤ Îµ, âˆ€ x > L, âˆ€ Î¾ > 0,
contradicted to (46). Notice that since such choice of L is independent of t, we conclude
that there exists L âˆˆ [âˆ’âˆ, +âˆ) such that [0, T ] Ã— (L, +âˆ) âŠ† C .
Lemma 5.6. For any (t0 , x0 ) âˆˆ A , the set Î˜(t0 , x0 ) is nonempty and (t0 , x0 + Î¾0 ) âˆˆ C for
any Î¾0 âˆˆ Î˜(t0 , x0 ).
Proof. Since V is uniformly bounded, one has
lim V (t0 , x + Î¾) âˆ’ B(Î¾) = âˆ’âˆ, lim+ V (t0 , x + Î¾) âˆ’ B(Î¾) = V (t0 , x0 ) âˆ’ Îº.

Î¾â†’+âˆ

Î¾â†’0

Then the condition V (t0 , x0 ) = I V (t0 , x0 ) implies that the supremum in I V (t0 , x0 ) is
achieved in the interior and thus Î˜(t0 , x0 ) is nonempty.
By property (45), for any Î¾0 âˆˆ Î˜(t0 , x0 ) one has
I V (t0 , x0 )

= supÎ¾âˆˆR+ {V (t0 , x0 + Î¾) âˆ’ B(Î¾)}
â‰¥ supÎ¾âˆˆR+ {V (t0 , x0 + Î¾0 + Î¾) âˆ’ B(Î¾0 + Î¾)}
= supÎ¾âˆˆR+ {V (t0 , x0 + Î¾0 + Î¾) âˆ’ B(Î¾)} âˆ’ B(Î¾0 ) + Îº
= I V (t0 , x0 + Î¾0 ) âˆ’ B(Î¾0 ) + Îº.

On the other hand, since I V (t0 , x0 ) + B(Î¾0 ) = V (t0 , x0 + Î¾0 ), we have
V (t0 , x0 + Î¾0 ) â‰¥ I V (t0 , x0 + Î¾0 ) + Îº,
which implies that x + Î¾0 âˆˆ C .
Lemma 5.7. Fix any (t0 , x0 ) âˆˆ A and for any Î¾0 âˆˆ Î˜(t0 , x0 ) , one has
Vx (t0 , x0 ) = Vx (t0 , x0 + Î¾0 ) = 1.

5.1 Structure of the value function

21

Proof. By the definition of Î˜(t, x), Î¾0 is a global maximum of the function Î¾ 7â†’ V (t0 , x0 +
Î¾) âˆ’ B(Î¾). Thus the first order condition yields that
Vx (t0 , x0 + Î¾0 ) = B â€² (Î¾0 ) = 1.
On the other hand, for any Î´ 6= 0, we have
V (t0 , x0 + Î´) â‰¥ I V (t0 , x0 + Î´) â‰¥ V (t0 , x0 + Î´ + Î¾0 ) âˆ’ B(Î¾0 ).
So one has
V (t0 , x0 + Î´ + Î¾0 ) âˆ’ V (t0 , x0 + Î¾0 )
V (t0 , x0 + Î´) âˆ’ V (t0 , x0 )
â‰¥
, Î´>0
Î´
Î´
V (t0 , x0 + Î´ + Î¾0 ) âˆ’ V (t0 , x0 + Î¾0 )
V (t0 , x0 + Î´) âˆ’ V (t0 , x0 )
â‰¤
. Î´ < 0.
Î´
Î´
By (5.3), Vx (t, x) is well defined for all (t, x) âˆˆ (0, T ) Ã— R. Taking Î´ â†’ 0+ and Î´ â†’ 0âˆ’ , one
achieves that
Vx (t0 , x0 ) = Vx (t0 , x0 + Î¾0 ) = 1.

References

22

References
[1] Ad, R., Basei, M., Callegaro, G., Campi, L., and Vargiolu, T. (2019). Nonzero-sum
stochastic differential games with impulse controls: a verification theorem with applications. Mathematics of Operations Research.
[2] Altavilla, Carlo, Giacomo Carboni, and Roberto Motto. Asset purchase programmes
and financial markets: lessons from the euro area. (2015).
[3] Andrade, Philippe, et al. The ECBâ€™s asset purchase programme: an early assessment.
(2016).
[4] Bayraktar, Erhan, Thomas Emmerling, and Jos-Luis Menaldi. â€On the impulse control
of jump diffusions.â€ SIAM Journal on Control and Optimization 51.3 (2013): 2612-2637.
[5] Belak, C., Christensen, S., Seifried, F.T., A general verification result for stochastic
impulse control problems (2017) SIAM Journal on Control and Optimization, 55 (2),
pp. 627-649.
[6] Bielecki, Tomasz R., and Marek Rutkowski. Credit risk: modeling, valuation and hedging. Springer Science & Business Media, 2013.
[7] Bielecki, Tomasz R., Monique Jeanblanc-Picqu, and Marek Rutkowski. Credit risk modeling. Vol. 5. Osaka: Osaka University Press, 2009.
[8] Blattner, Tobias Sebastian, and Michael AS Joyce. Net debt supply shocks in the euro
area and the implications for QE. (2016).
[9] Bowman, David, et al. Quantitative easing and bank lending: evidence from Japan.
Board of Governors of the Federal Reserve System, 2011.
[10] Brigo, Damiano, Massimo Morini, and Andrea Pallavicini. Counterparty credit risk,
collateral and funding: with pricing cases for all asset classes. John Wiley & Sons,
2013.
[11] Capponi, Agostino, and Peng-Chu Chen. â€Systemic risk mitigation in financial networks.â€ Available at SSRN 2293426 (2013).
[12] Chevalier, Etienne, Vathana Ly Vath, and Simone Scotti. â€An optimal dividend and
investment control problem under debt constraints.â€ SIAM Journal on Financial Mathematics 4.1 (2013): 297-326.
[13] Chevalier, Etienne, et al. â€Optimal execution cost for liquidation through a limit order market.â€ International Journal of Theoretical and Applied Finance 19.01 (2016):
1650004.
[14] Cordoni, Francesco, and Luca Di Persio. â€A maximum principle for a stochastic control
problem with multiple random terminal times.â€ arXiv preprint arXiv:1801.07216 (2018).
[15] Cordoni, Francesco, Luca Di Persio, and Luca Prezioso. â€A lending scheme for a system of interconnected banks with probabilistic constraints of failure.â€ arXiv preprint
arXiv:1903.06042 (2019).
[16] Cosso, Andrea. â€Stochastic differential games involving impulse controls and doubleobstacle quasi-variational inequalities.â€ SIAM Journal on Control and Optimization
51.3 (2013): 2102-2131.
[17] Crpey, Stphane. Bilateral counterparty risk under funding constraintsPart I: Pricing.
Mathematical Finance 25.1 (2015): 1-22.
[18] Crpey, Stphane. Bilateral counterparty risk under funding constraintsPart II: CVA.
Mathematical Finance 25.1 (2015): 23-50.

References

23

[19] De Santis, Roberto A. Impact of the asset purchase programme on euro area government
bond yields using market news. (2016).
[20] Eisenberg, Larry, and Thomas H. Noe. â€Systemic risk in financial systems.â€ Management Science 47.2 (2001): 236-249.
[21] Egami, Masahiko. â€A direct solution method for stochastic impulse control problems of
one-dimensional diffusions.â€ SIAM Journal on Control and Optimization 47.3 (2008):
1191-1218.
[22] Masahiko Egami and Kazutoshi Yamazaki, On the continuous and smooth fit principle
for optimal stopping problems in spectrally negative Lvy models, Adv. in Appl. Probab.
, Volume 46, Number 1, 139-167 (2014).
[23] Eichengreen, B., Mody, A., Nedeljkovic, M., Sarno, L. How the Subprime Crisis went
global: Evidence from bank credit default swap spreads (2012) Journal of International
Money and Finance, 31 (5), pp. 1299-1318.
[24] Fleming, Wendell H., and Halil Mete Soner. Controlled Markov processes and viscosity
solutions. Vol. 25. Springer Science & Business Media, 2006.
[25] Xin Guo and Guoliang Wu, Smooth Fit Principle for Impulse Control of Multidimensional Diffusion Processes, SIAM J. Control Optim., 48(2), 594617, (2009)
[26] Yann-Shin Aaron Chen and Xin Guo, Impulse Control of Multidimensional Jump Diffusions in Finite Time Horizon, SIAM J. Control Optim, 51(3), 2638-2663, (2013)
[27] Hernndez-Hernndez, D., Yamazaki, K. Games of singular control and stopping driven
by spectrally one-sided Lvy processes Stochastic Processes and their Applications, 125
(1), pp. 1-38, (2015).
[28] Ishi, H.. â€The maximum principle for semicontinuous functions.â€ Differential and Integral Equations 3.6 (1990): 1001-1014.
[29] Ivashina, V., Scharfstein, D. Bank lending during the financial crisis of 2008. (2010)
Journal of Financial Economics, 97 (3), pp. 319-338.
[30] Kahle, K.M., Stulz, R.M. Access to capital, investment, and the financial crisis (2013)
Journal of Financial Economics, 110 (2), pp. 280-299.
[31] Kang, J., Tang, Y., Value Function Regularity in Option Pricing Problems Under a
Pure Jump Model, (2017) Applied Mathematics and Optimization, 76 (2), pp. 303-321.
[32] Karatzas, I. Optimization Problems in the Theory of Continuous Trading, SIAM J.
Control Optim., 27(6), 12211259. (1989)
[33] Kuznetsova, A., Azarenkova, G., Olefir, I. Implementation of the â€bail-inâ€ mechanism
in the banking system of Ukraine (2017) Banks and Bank Systems, 12 (3), pp. 269-282.
[34] Lieberman, G. M.. Second Order Parabolic Differential Equations. Work Scientific,
River Edge, NJ, 1996.
[35] Lipton, Alexander. Modern Monetary Circuit Theory, Stability of Interconnected Banking Network, and Balance Sheet Optimization for Individual Banks. International Journal of Theoretical and Applied Finance 19.06 (2016): 1650034.
[36] Merton, Robert C. On the pricing of corporate debt: The risk structure of interest
rates. The Journal of finance 29.2 (1974): 449-470.
[37] Miyao, R. The Role of Monetary Policy in Japan: A Break in the 1990s? (2000) Journal
of the Japanese and International Economies, 14 (4), pp. 366-384.
[38] ksendal, Bernt, and Agnes Sulem. â€Optimal stochastic impulse control with delayed
reaction.â€ Applied Mathematics and Optimization 58.2 (2008): 243-255.

References

24

[39] ksendal, Bernt Karsten, and Agnes Sulem. Applied stochastic control of jump diffusions.
Vol. 498. Berlin: Springer, 2005.
[40] Pham, Huyn. Continuous-time stochastic control and optimization with financial applications. Vol. 61. Springer Science & Business Media, 2009.
[41] Pham, Huyn. On some recent aspects of stochastic control and their applications. Probability Surveys 2.506-549 (2005): 1-2.
[42] Pham, Huyn. â€On the smooth-fit property for one-dimensional optimal switching problem.â€ Sminaire de probabilits XL. Springer, Berlin, Heidelberg, 2007. 187-199.
[43] Rogers, Leonard CG, and Luitgard AM Veraart. â€Failure and rescue in an interbank
network.â€ Management Science 59.4 (2013): 882-898.
[44] Sakuramoto, M., Urbani, A. Current basic lines of the discipline of bank crises and unresolved problems: An initial comparison between the solutions accepted in the european
union (with special emphasis on Italy) and in Japan, between the role of banking authorities and the powers of judicial authority (2018) Law and Economics Yearly Review,
7, pp. 4-28.
[45] Tang, Shanjian, and Jiongmin Yong. Finite horizon stochastic optimal switching and
impulse controls with a viscosity solution approach. Stochastics: An International Journal of Probability and Stochastic Processes 45.3-4 (1993): 145-176.
[46] Vath, Vathana Ly, Mohamed Mnif, and Huyn Pham. â€A model of optimal portfolio
selection under liquidity risk and price impact.â€ Finance and Stochastics 11.1 (2007):
51-90.
[47] Voutsinas, Konstantinos, and Richard A. Werner, New Evidence on the Effectiveness
of â€™Quantitative Easingâ€™ in Japan, Center for Banking, Finance and Sustainable Development, School of Management, University of Southampton.
[48] Hoover Institution, Economics Working Paper 14110, Exiting from Low Interest Rates
to Normality: An Historical Perspective, 2014.
[49] Edward J. Pinto, American Enterprise Institute, The 30-Year Fixed Mortgage Should
Disappear, 2016.
[50] Michael Bordo and Arunima Sinha, Economics Working Paper 16113, Hoover Institution, Lesson from the Great Depression that the Fed Might Have Learned: A Comparison of the 1932 Open Market Purchases with Quantitative Easing, 2016
[51] Fawley, Brett W., and Christopher J. Neely, Four stories of quantitative easing, Federal
Reserve Bank of St. Louis Review 95.1 (2013): 51-88.
[52] Blinder, Alan S. Quantitative Easing: Entrance and Exit Strategies (Digest Summary),
Federal Reserve Bank of St. Louis Review 92.6 (2010): 465-479.

