SciPost Physics

Submission

Dynamics of Hot Bose-Einstein Condensates: stochastic Ehrenfest
relations for number and energy damping

arXiv:1908.05809v3 [cond-mat.quant-gas] 13 Dec 2019

Rob G. McDonald1,2 , Peter Barnett1,2 , Fradom Atayee1,2 , Ashton S. Bradley1,2* ,
1 Department of Physics, University of Otago, Dunedin, New Zealand
2 The Dodd-Walls Centre for Photonic and Quantum Technologies
* ashton.bradley@otago.ac.nz
December 16, 2019

Abstract
Describing partially-condensed Bose gases poses a long-standing theoretical challenge. We present
exact stochastic Ehrenfest relations for the stochastic projected Gross-Pitaevskii equation, including both number and energy damping mechanisms, and all projector terms that arise from
the energy cutoff separating system from reservoir. We test the theory by applying it to the
centre of mass fluctuations of a harmonically trapped prolate system, finding close agreement
between c-field simulations and analytical results. The formalism lays the foundation to analytically explore experimentally accessible hot Bose-Einstein condensates.

Contents
1

Introduction

2

2

Background
2.1 Gross-Pitaevskii equation
2.2 Stochastic projected Gross-Pitaevskii equation
2.2.1 Projector
2.2.2 Equations of motion
2.2.3 Energy cutoff and the single-particle basis

3
3
5
5
7
8

3

Stochastic Ehrenfest relations
3.1 Ito form of the SPGPE
3.2 Functional Change of Variables
3.3 One-body operators
3.4 Noise correlations for multiple moments
3.5 Finite-temperature stochastic Ehrenfest relations

8
8
9
10
11
12

4

Application to centre of mass fluctuations
4.1 Stochastic equations for centre of mass
4.2 Analytic and numerical solutions

13
14
15

5

Discussion and Conclusions
5.1 Discussion

18
18
1

SciPost Physics

5.2

Submission

Conclusions

19

A Projector terms
A.1 General operators
A.2 One-body operators

20
20
20

B Centre of mass equations
B.1 Position and momentum
B.2 Dimensionless variable z(t)
B.3 Numerical evaluation of projector terms

21
22
23
23

References

25

1

Introduction

A system of Bose atoms with temperature T undergoes a dramatic change in behavior at the critical
temperature for the formation of a Bose-Einstein condensate (BEC), T c . Far below the BEC transition
T  T c , a nearly pure BEC forms, consisting of a highly occupied many-body quantum state; in this
regime dilute gas BEC are renowned both for their high experimental control, and precise theoretical
description [1]. At temperatures T  T c thermal energy dominates, the quantum statistics are unimportant, and a Boltzman description captures the physical properties of the atoms. When T âˆ¼ T c the
quantum statistics of the atoms are decisive, despite appreciable thermal energy. In a hot BEC T . T c ,
competition between thermal and interaction effects leads to fragmentation of the condensate, and
formation of vortices, solitons, and phononic excitations. A cooling quench across the transition can
inject interesting excitations into the BEC that form as remnants of the broken U(1) symmetry [2, 3],
and rich turbulent dynamics develop from the competition between thermal, quantum, and interaction
effects, posing a challenge for theory.
At low temperatures that contain significant condensate and non-condensate fraction, mean field
theory provides a useful description, upon which the GPE and its generalizations are based. The
Zaremba-Nikuni-Griffin U(1) symmetry breaking approach has proven well suited for practical calculations in this low-temperature regime [4], having the virtue that the interactions between condensate
and thermal cloud, and their respective dynamics, are all included in the dynamical description. However, itâ€™s strength for low temperatures presents a limitation at high temperatures: despite notable successes, e.g. for collective modes [5], the symmetry-breaking ansatz has limited scope for describing
strongly fluctuating systems containing large non-condensate fraction. Fortunately, the scope of the
Gross-Pitaevskii equation (GPE) upon which ZNG is based goes much further than mean-field theory:
GPE-like field equations appear naturally in phase-space representations of Bose gases [6], suggesting
a generalization of quantum optical open systems theory [7] for describing hot Bose gases. Indeed,
various generalized Gross-Pitaevskii theories have been developed for the high temperature regime,
describing many modes that are weakly occupied, interacting, and partially coherent [8, 9]. Devoid of
the symmetry-breaking ansatz, these approaches have advantages for high-temperature work.
One approach capable of describing experiments across the phase transition is known as the
stochastic projected Gross-Pitaevskii equation (SPGPE) [10â€“14]. The SPGPE was developed as a

2

SciPost Physics

Submission

synthesis of quantum kinetic theory [15] and the projected Gross-Pitaevskii equation [16], and provides a tractable approach for numerical simulations of hot matter-wave dynamics that includes all
significant reservoir interaction processes. The SPGPE describes the evolution of a high-temperature
partially condensed system within a classical field approximation, is valid on either side of the critical
point, and has been used to quantitatively model the BEC phase transition [3], and BEC dynamics
observed in high-temperature experiments [17]. The complete SPGPE includes a number-damping
reservoir interaction (of Ginzburg-Landau type) described in previous works [3, 17], and an additional
interaction involving exchange of energy with the reservoir [2]; the latter is a number-conserving interaction that can in principle have a significant influence on dissipative evolution [9, 13, 18, 19], yet
due to technical challenges, its physical effects have thus far been largely unexplored.
Ehrenfestâ€™s theorem [20] relates, for example, the time derivative of the expectation (with respect
to the wavefunction) of momentum and position of a particle with the potential experienced by the
particle. The Ehrenfest relations can be extended to the Gross-Pitaevskii fluid â€” essentially without
modification â€” due to the net cancellation of two-body interaction forces. Previously, development
of the number-damping SPGPE theory was aided by Ehrenfest relations [21]. Such relations for
ensemble averages provide an essential validity check for numerical work, and physical consistency
tests for the reservoir theory, including ensemble averages expected in equilibrium.
In this work we derive stochastic collective equations for the SPGPE including the effects of both
number-damping and energy-damping. These stochastic Ehrenfest relations (SERs) form the extension of Ehrenfest relations to finite-temperature stochastic field theory of Bose-Einstein condensates.
They extend beyond the scope of previously derived relations of this type [21] by explicitly retaining
all noises and cutoff terms. Importantly, for many one-body operators the multiplicative noise in the
energy-damped SPGPE is transformed into additive noise in the collective equations. This simplification opens the way for analytical treatments of a broad class of low-energy excitations in BEC
including solitons, vortices, and collective modes, for both number- and energy-damping decay channels. As a test we apply the Ehrenfest relations to the centre of mass fluctuations of a harmonically
trapped system tightly confined along two spatial dimensions. We find that the analtyic solution of
the SER for the centre of mass is in close agreement with SPGPE simulations. The SPGPE theory
of spinor and multicomponent systems [14] enables these techniques to be applied to systems where
dissipation can only proceed via energy damping.
The paper is structured as follows. The GPE, PGPE, and SPGPE are introduced in Sec. 2, and
the Ehrenfest relations for the GPE and PGPE briefly reviewed. In Sec. 3 we apply Itoâ€™s formula
for change of variables to derive SERs for the SPGPE. We then derive a set of simple fluctuationdissipation relations describing equilibrium ensembles. In Sec. 4 we test the formalism on the centre
of mass motion of a harmonically trapped quasi-1D system. In Sec. 5 we discuss links between our
work and relevant linterature, and give our conclusions.

2
2.1

Background
Gross-Pitaevskii equation

The Gross-Pitaevskii equation is the equation of motion for a scalar complex field evolving according
to the Gross-Pitaevskii Hamiltonian
!
Z
~2 âˆ‡2
1
3
âˆ—
2
H=
d r Ïˆ (r, t) âˆ’
+ V(r, t) + |Ïˆ(r, t)| Ïˆ(r, t),
(1)
2m
2

3

SciPost Physics

Submission

where V(r, t) is an external potential and the interaction strength 1 = 4Ï€~2 a s /m is the two-body
interaction strength in the cold-collision regime [22] via the s-wave scattering length a s and atomic
mass m. The Gross-Pitaevskii equation may be generated by taking the functional derivative of the
Gross-Pitaevskii Hamiltonian
i~

âˆ‚Ïˆ(r, t)
Î´H
= âˆ—
= LÏˆ(r, t),
âˆ‚t
Î´Ïˆ (r, t)

(2)

where the Gross-Pitaevskii operator is
LÏˆ(r, t) â‰¡ âˆ’

!
~2 âˆ‡2
+ V(r, t) + 1|Ïˆ(r, t)|2 Ïˆ(r, t).
2m

(3)

The total particle number
N=

Z

d3 r Ïˆâˆ— (r, t)Ïˆ(r, t),

(4)

is conserved under the Hamiltonian evolution. Observables A(t) of the system that are given by the
expectation value of an operator AÌ‚ are defined by
Z
Z
3
A(t) â‰¡ hAÌ‚i =
d r hÏˆ|AÌ‚|riÏˆ(r, t) =
d3 r Ïˆâˆ— (r, t)hr|AÌ‚|Ïˆi,
(5)
R
for example R(t) = d3 r Ïˆâˆ— (r)rÏˆ(r) is the mean position of the atoms. The internal cancellation
of s-wave interaction forces renders the Ehrenfest relations for the GPE identical to those of the
Schrodinger equation [23]:
dR(t)
dt
dP(t)
dt
dL(t)
dt
dH(t)
dt
dN(t)
dt

=

1
P(t),
m

(6)

= âˆ’ hâˆ‡V(r, t)i ,

(7)

= âˆ’ hr Ã— âˆ‡V(r, t)i ,
*
+
âˆ‚V(r, t)
=
,
âˆ‚t

(8)

= 0,

(9)
(10)

for the position R(t), momentum P(t), angular momentum L(t), energy H(t), and number N(t) respectively. The focus of the present article is to develop a detailed theory of modifications to these
collective equations that occur due to reservoir interactions in a Bose-Einstein condensate.
As is often convenient when changing representations, here we are using |Ïˆi to represent the
abstract state ket associated with the pure-state wavefunction Ïˆ(r) = hr|Ïˆi. In the context of phasespace methods introduced below, it should be noted that we do not use this notation for the manybody quantum state, but just as a convenient shorthand for the wavefunction appearing in individual
trajectories. Many-body expectation values are calculated as ensemble averages over trajectories of
the stochastic field theory [9]. When generalizing the above definitions [(6)â€”(10)] to the many-body
theory as described below, the average hÂ·i refers only to the wavefunction expectation over position
coordinates. The combination of wavefunction and ensemble average will be denoted by hhÂ·ii.
4

SciPost Physics

2.2

Submission

Stochastic projected Gross-Pitaevskii equation

The derivation of the complete SPGPE for scalar BEC appeared in [10]. A later generalization allows
for the possibility of multiple components and spins [14]. The derivation involves finding a master
equation for the coherent region density operator. A series of approximations valid at high temperartures [21] then gives the high temperature regime master equation, which is mapped to an equivalent
equation of motion for the multimode Wigner distribution function W[Ïˆ, Ïˆâˆ— ] using quantum to classical operator correspondences [7, 24]. The result of this is a generalized Fokker-Planck equation
(FPE) of motion for the Wigner function that includes third-order functional derivates. An equation
of motion for a quasi-probability distribution can only be mapped to an SDE if it takes the form of
a Fokker-Planck equation, that is, only contains functional derivatives up to second order and has a
positive semi-definite diffusion matrix. Futher progress can be made by neglecting the third-order
derivatives, an approximation known as the truncated Wigner approximation. Such an approximation is physically well justified at high temperatures where thermal and classical noise dominate over
quantum noise [25]. To establish notation and formulate the problem, we now summarize the key
results.
2.2.1

Projector

The SPGPE requires a clear formulation of a projection operator that formally and numerically projects
the nonlinear GPE dynamics into a low-energy subspace. To define the projector, the external potential is split into a time-invariant part and a time-dependent part V(r, t) â‰¡ V(r) + Î´V(r, t). The time
independent part defines the single-particle Hamiltonian
Hsp â‰¡ âˆ’

~2 âˆ‡2
+ V(r).
2m

(11)

The basis of representation is chosen to be the eigenstates of this Hamiltonian, satisfying Hsp Ï†n (r) =
n Ï†n (r), where n denotes the set of quantum numbers required to completely describe the singleparticle basis states, with corresponding energy eigenvalues n .
The projector can be written in operator form as
X
PÌ‚ =
|nihn|,
(12)
nâˆˆC

where the coherent region C is defined as the set of basis states beneath the cutoff: C â‰¡ {n : n â‰¤ c }.
In position space, this becomes an integral operator projecting an arbitrary function F(r) into C, with
action on the function F(r) written as
Z
Z
X
3 0 âˆ— 0
0
P {F(r)} â‰¡
Ï†n (r) d r Ï†n (r )F(r ) =
d3 r0 Î´(r, r0 )F(r0 ),
(13)
nâˆˆC

where we have made use of the projected Dirac-delta distribution
X
Î´(r, r0 ) â‰¡
Ï†n (r)Ï†âˆ—n (r0 ) = hr|PÌ‚|r0 i.

(14)

nâˆˆC

The orthogonal projector QÌ‚ = 1 âˆ’ PÌ‚, has the action on the function F(r)
Z
X
Q {F(r)} â‰¡
Ï†n (r) d3 r0 Ï†âˆ—n (r0 )F(r0 ),
nâˆˆI

5

(15)

SciPost Physics

Submission

Figure 1: Schematic: separation of the hot Bose gas into a C-region system containing partially
coherent modes with appreciable occupation, and I-region reservoir containing incoherent modes with
small occupation (left); C âˆ’ I coupling via s-wave scattering: Energy-damping reservoir interaction
(center); Number-damping reservoir interaction (right).

where the incoherent region I is defined as I â‰¡ {n : n > c }. Since PÌ‚ is Hermitian, for any two states
|Fi, |Gi, we have hF|PÌ‚|Gi = hF|PÌ‚Gi = hPÌ‚F|Gi.
The classical field is represented as a sum over the basis states Ï†n (r) with weight Î±n (t)
X
Ïˆ(r, t) =
Î±n (t)Ï†n (r),
(16)
nâˆˆC

where the field is now restricted to exist entirely within the coherent region. Without reservoir interactions, the projected Gross-Pitaevskii equation (PGPE) [16] is obtained by taking the projected
functional derivative of H, where these are defined by
X
Î´Ì„
âˆ‚
=
Ï†âˆ—n (r)
,
âˆ‚Î±n
Î´Ì„Ïˆ(r, t) nâˆˆC

X
âˆ‚
Î´Ì„
=
Ï†n (r) âˆ— .
âˆ—
âˆ‚Î±n
Î´Ì„Ïˆ (r, t) nâˆˆC

The projected functional derivative is related to the regular functional derivative by
(
(
)
)
âˆ—
Î´Ì„F[Ïˆ, Ïˆâˆ— ]
Î´Ì„F[Ïˆ, Ïˆâˆ— ]
Î´F[Ïˆ, Ïˆâˆ— ]
âˆ— Î´F[Ïˆ, Ïˆ ]
=P
,
=P
.
Î´Ïˆ(r, t)
Î´Ïˆâˆ— (r, t)
Î´Ì„Ïˆ(r, t)
Î´Ì„Ïˆâˆ— (r, t)

(17)

(18)

In particular, the equation of motion for the c-field Eq. (16) is given by the PGPE:
i~

âˆ‚Ïˆ(r, t)
Î´Ì„H
= âˆ—
= P {LÏˆ(r, t)} ,
âˆ‚t
Î´Ì„Ïˆ (r, t)

(19)

describing Hamiltonian evolution for a field that is formally restricted to the C region. Defining
the caonical momentum Î (r, t) â‰¡ i~Ïˆ(r, t)âˆ— , and projected functional Poisson bracket of any two
functionals F[Ïˆ, Î ], G[Ïˆ, Î ], as
Z
Î´Ì„F Î´Ì„G
Î´Ì„F Î´Ì„G
{F, G} â‰¡
d3 r
âˆ’
,
(20)
Î´Ì„Ïˆ(r) Î´Ì„Î (r) Î´Ì„Î (r) Î´Ì„Ïˆ(r)
the PGPE follows the expected Hamiltonian structure
âˆ‚t Ïˆ(r) = {Ïˆ(r), H},

âˆ‚t Î (r) = {Î (r), H}
6

(21)

SciPost Physics

Submission

Provided Î´V â‰¡ 0, N and H are both formally conserved by the PGPE: âˆ‚t N = {N, H} = 0, âˆ‚t H =
{H, H} = 0. A short account of the former is instructive. Evaluating the projected derivatives, we have
Z
1
{N, H} =
d3 r Ïˆâˆ— (r)(PLÏˆ)(r) âˆ’ Ïˆ(r)(PLÏˆ)âˆ— (r).
(22)
i~
Since P is hermitian, and PÏˆ â‰¡ Ïˆ for projected fields, we then have {N, H} â‰¡ 0. As usual, additional
conserved quantities may exist when the confining potential possesses additional symmetries, and
numerical conservation requires that the basis also respect the symmetry. In practice this requires that
the basis modes are eigenstates of the the symmetry generator.
2.2.2

Equations of motion

The PGPE gives Hamiltonian evolution of the coherent region field in isolation. In SPGPE c-field
theory, the incoherent region is usually assumed to be thermalised and is thus treated as a reservoir that
acts as a damping mechanism for the coherent region. Applying the truncated Wigner approximation
to the Born-Markov master equation for the Bose field leads to the Fokker-Planck equation [10]
"
#
Z

i
âˆ‚W[Ïˆ, Ïˆâˆ— ]
Î´Ì„  i
3
âˆ’ (1 âˆ’ iÎ³) (L âˆ’ Âµ) Ïˆ(r) âˆ’ VÎµ (r)Ïˆ(r) + h.c. W[Ïˆ, Ïˆâˆ— ]
= d r âˆ’
âˆ‚t
~
Î´Ì„Ïˆ(r) ~
"
#
Z
Î³kB T
Î´Ì„(2)
+ d3 r
+ h.c. W[Ïˆ, Ïˆâˆ— ]
~ Î´Ì„Ïˆ(r)Î´Ì„Ïˆâˆ— (r)
"
#
Z
Z
Î´Ì„
Î´Ì„
0
3
3 0 kB T
âˆ— 0
+ d r d r
Îµ(r âˆ’ r )
Ïˆ(r) âˆ— 0 Ïˆ (r ) + h.c. W[Ïˆ, Ïˆâˆ— ]
~
Î´Ì„Ïˆ(r)
Î´Ì„Ïˆ (r )
"
#
Z
Z
Î´Ì„
Î´Ì„
0
0
3
3 0 kB T
(23)
Îµ(r âˆ’ r )
Ïˆ(r)
Ïˆ(r ) + h.c. W[Ïˆ, Ïˆâˆ— ].
âˆ’ d r d r
~
Î´Ì„Ïˆ(r)
Î´Ì„Ïˆ(r0 )
The number-damping interction is parametrised by the number-damping rate Î³ describing two-body
collisions that transfer particles between C and I. For a thermal Bose reservoir the dimensionless rate
Î³ is [11]
#2
" Î²Âµ
âˆ
8a2s X eÎ²Âµ( j+1)
e
Î³= 2
Î¦ 2Î² , 1, j ,
(24)
e c
Î»dB j=1 e2Î²c j
p
P
k
where Î»dB = 2Ï€~2 /mkB T is the thermal de Broglie wavelength, Î² = 1/kB T , Î¦[z, x, a] = âˆ
k=0 z /(a+
x
1
k) is the Lerch transcendent. Energy damping is described by the potential
Z
VÎµ (r) â‰¡ âˆ’~ d3 r0 Îµ(r âˆ’ r0 )âˆ‡0 Â· j(r0 ),
(25)


where j(r) = i~ Ïˆ(r)âˆ‡Ïˆâˆ— (r) âˆ’ Ïˆâˆ— (r)âˆ‡Ïˆ(r) /2m is the current, and the epsilon function
Z
M
Îµ(r) â‰¡
d3 k S (k)eikÂ·r ,
(2Ï€)3

(26)

where S (k) â‰¡ |k|âˆ’1 is the scattering kernel. For identical bosons the rate constant M is given by [10,13]
M=

16Ï€a2s kB T
1
,
Î²(
âˆ’Âµ)
c
~
e
âˆ’1

(27)

A consequence of the high-energy cutoff (c âˆ¼ 3Âµ) used in the SPGPE is that Î³ is approximately independent of position,
simplifying the SPGPE. Typical experimentally relevant values are of order 10âˆ’5 âˆ’ 10âˆ’4 [11].
1

7

SciPost Physics

Submission

while for distinct reservoir species, it is reduced by 1/2 [14]. The scattering potential Eq. (25) describes the reservoir interaction involving transfer of energy and momentum without transfer of particles.
Direct solution of the Fokker-Planck equation of motion (23) is impractical numerically. Working
with this FPE involving only derivatives up to second order, the Wigner function evolution equation
can be mapped to an equivalent SDE for Ïˆ(r) [26], provided the diffusion matrix is positive semidefinite. For the FPE Eq. (23) this condition is always satisfied, and the stochastic projected GrossPitaevskii equation (SPGPE) is [10, 11, 14]
n i
o
i
(S)dÏˆ(r) = P âˆ’ (1 âˆ’ iÎ³)(L âˆ’ Âµ)Ïˆ(r)dt âˆ’ VÎµ (r)Ïˆ(r)dt + dW(r, t) + iÏˆ(r)dU(r, t) ,
~
~

(28)

where the (complex) number-damping noise has the non-zero correlations
hdW(r, t)dW âˆ— (r0 , t)i =

2Î³kB T
Î´(r, r0 )dt,
~

(29)

and the (real) energy-damping noise has non-zero correlations
hdU(r, t)dU(r0 , t)i =

2kB T
Îµ(r âˆ’ r0 )dt.
~

(30)

The notation (S) indicates that the SDE is to be interpreted as a stochastic integral in Stratonovich
form [26], and thus at a given time t the noises are not independent of the fields.
2.2.3

Energy cutoff and the single-particle basis

Before presenting our results, we remark that there exists a variety of interpretations in the literature of
a central feature of C-field theory: what constitutes a cutoff, and how should it be imposed in practice?
In some cases any convenient numerical basis of representation is truncated. However, truncation in
an arbitrary basis will not usually generate a consistent energy cutoff, and some care should be taken
when choosing a basis of representation. In particular, if a highly inappropriate basis of representation
is used, then thermal noise driving the C-field modes will generate thermalization artifacts [21]. In
our approach to the SPGPE we impose the cutoff in the single-particle basis generated by the timeindependent confining potential. There is a clear physical motivation for this choice (clearly articulated
by the pioneers of the PGPE): at sufficiently high energy â€” usually of order 2-3Âµ â€” the interacting
many-body problem is approximately diagonal in the single-particle basis. Thus a well-chosen cutoff
in the single-particle basis is also an approximate energy cutoff for the many-body system, precisely
what is required for its separation into coherent and incoherent subspaces. These considerations will
feature below in our discussion of equilibrium properties of the SPGPE.

3

Stochastic Ehrenfest relations

Ehrenfest relations for the stochastic field can be derived by casting the SPGPE in Ito form. The noises
and fields are then uncorrelated, allowing change of variables using the rules of Ito calculus.

3.1

Ito form of the SPGPE

Recasting the SPGPE in Ito form involves reordering the projected function derivatives in the final
term of the FPE and mapping the equation to a new SDE.
8

SciPost Physics

Submission

The FPE is equivalent to
"
#
Z

âˆ‚W[Ïˆ, Ïˆâˆ— ]
Î´Ì„  i
i
3
= d r âˆ’
âˆ’ (1 âˆ’ iÎ³) (L âˆ’ Âµ) Ïˆ(r) âˆ’ VÎµ (r)Ïˆ(r) + h.c. W[Ïˆ, Ïˆâˆ— ]
âˆ‚t
~
Î´Ì„Ïˆ(r) ~
"
!
#
Z
Z
Î´Ì„
kB T
3
3 0
0
0
0
+ d r âˆ’
âˆ’
d r Îµ(r âˆ’ r )Î´(r, r )Ïˆ(r ) + h.c. W[Ïˆ, Ïˆâˆ— ]
~
Î´Ì„Ïˆ(r)
"
#
Z
Î´Ì„(2)
Î³kB T
3
+ d r
+ h.c. W[Ïˆ, Ïˆâˆ— ]
~ Î´Ì„Ïˆ(r)Î´Ì„Ïˆâˆ— (r)
"
#
Z
Z
Î´Ì„(2)
0
3
3 0 kB T
âˆ— 0
Îµ(r âˆ’ r )
+ d r d r
Ïˆ(r)Ïˆ (r ) + h.c. W[Ïˆ, Ïˆâˆ— ]
~
Î´Ì„Ïˆ(r)Î´Ì„Ïˆâˆ— (r0 )
"
#
Z
Z
Î´Ì„(2)
kB T
0
Îµ(r âˆ’ r0 )
Ïˆ(r)Ïˆ(r
)
+
h.c.
W[Ïˆ, Ïˆâˆ— ]
âˆ’ d3 r d3 r0
~
Î´Ì„Ïˆ(r)Î´Ì„Ïˆ(r0 )

(31)

which maps to the Ito SPGPE
n i
i
(I)dÏˆ(r) = P âˆ’ (1 âˆ’ iÎ³)(L âˆ’ Âµ)Ïˆ(r)dt âˆ’ VÎµ (r)Ïˆ(r)dt
~Z
~
o
kB T
3 0
0
0
âˆ’
d r Îµ(r âˆ’ r )Î´(r, r )Ïˆ(r0 )dt + dW(r, t) + iÏˆ(r)dU(r, t) ,
~

(32)

where the first term in the second line is called the Stratonovich correction. In contrast to the
Stratonovich SPGPE, in the Ito SPGPE [denoted (I)] the noises are always independent of the fields
at a given time t. This formulation has distinct advantages for formal manipulation that we exploit
below.

3.2

Functional Change of Variables

Consider any functional of the projected fields A â‰¡ A[Ïˆ, Ïˆâˆ— , t]. Using the rules of Ito calculus, we can
find the an SDE for A in the form
"
#
Z
âˆ‚A[Ïˆ, Ïˆâˆ— , t]
Î´Ì„A[Ïˆ, Ïˆâˆ— , t]
âˆ—
3
(I)dA[Ïˆ, Ïˆ , t] =
dt + d r
dÏˆ(r) + h.c.
âˆ‚t
Î´Ì„Ïˆ(r)
#
" (2)
Z
Z
Î³kB T
Î´Ì„ A[Ïˆ, Ïˆâˆ— , t]
0
+ d 3 r d 3 r0
)
+
h.c.
dt
Î´(r,
r
~
Î´Ì„Ïˆâˆ— (r0 )Î´Ì„Ïˆ(r)
" (2)
#
Z
Z
âˆ—
kB T
3
3 0 Î´Ì„ A[Ïˆ, Ïˆ , t] âˆ— 0
Ïˆ (r )Ïˆ(r) + h.c. Îµ(r âˆ’ r0 )
+ d r d r
dt
âˆ—
0
~
Î´Ì„Ïˆ (r )Î´Ì„Ïˆ(r)
" (2)
#
Z
Z
âˆ—
kB T
3
3 0 Î´Ì„ A[Ïˆ, Ïˆ , t]
0
âˆ’ d r d r
Ïˆ(r )Ïˆ(r) + h.c. Îµ(r âˆ’ r0 )
dt,
(33)
0
~
Î´Ì„Ïˆ(r )Î´Ì„Ïˆ(r)
where we consistently include all terms up to order dt, including terms quadratic in the noises that
generate second derivatives. We require the property of the epsilon function that it is diagonal in
k-space:
Z
Z
Z


d3 r d3 u F(r)G(u)Îµ(r âˆ’ u) = M d3 k S (k)F F âˆ— (r) âˆ— F [G(r)] ,
(34)
where the Fourier transform is defined as
1
F [ f (r)] â‰¡
(2Ï€)3/2
9

Z

d3 r f (r)eâˆ’ikÂ·r .

(35)

SciPost Physics

Submission

a simplification that we will make use of below. Using
!
âˆ—
Î´Ì„A[Ïˆ, Ïˆâˆ— , t] Î´A[Ïˆ, Ïˆâˆ— , t]
âˆ— Î´A[Ïˆ, Ïˆ , t]
=
âˆ’Q
,
Î´Ïˆ(r)
Î´Ïˆ(r)
Î´Ì„Ïˆ(r)
we rewrite (33) as a stochastic Ehrenfest equation with additional terms due to the projector
Z
2
Î´A[Ïˆ, Ïˆâˆ— , t]
âˆ‚A[Ïˆ, Ïˆâˆ— , t]
dt + Im d3 r
(L âˆ’ Âµ)Ïˆ(r)dt + QH
(I)dA[Ïˆ, Ïˆâˆ— , t] =
A
âˆ‚t
~
Î´Ïˆ(r)
Z
Î´A[Ïˆ, Ïˆâˆ— , t]
2Î³
Î³
(L âˆ’ Âµ)Ïˆ(r)dt + QA
âˆ’ Re d3 r
~
Î´Ïˆ(r)
"
#âˆ—
Z


Î´A[Ïˆ, Ïˆâˆ— , t] âˆ—
3
âˆ’ 2M Im d k S (k)F
Ïˆ (r) F âˆ‡ Â· j(r) dt + QÎµA
âˆ—
Î´Ïˆ (r)
Z
Z
2Î³kB T
Î´(2) A[Ïˆ, Ïˆâˆ— , t]
+
Re d3 r d3 u Î´(u, r) âˆ—
dt + dAÎµ
~
Î´Ïˆ (r)Î´Ïˆ(u)
+ dWÎ³A (t) + dWÎµA (t),

(36)

(37)

where the noise correlations are
!
Î´A[Ïˆ, Ïˆâˆ— , t] 2
Î³
=
d r
+ DA dt,
Î´Ïˆ(r)
ï£«
ï£¶
" (
)# 2
âˆ— , t]
ï£¬ï£¬ï£¬ 8MkB T Z 3 âˆ’1
ï£·ï£·
Î´A[Ïˆ,
Ïˆ
A
A
Îµ
hdWÎµ (t)dWÎµ (t)i = ï£¬ï£¬ï£­
+ DA ï£·ï£·ï£·ï£¸ dt,
d k k F Im
Ïˆ(r)
~
Î´Ïˆ(r)
4Î³kB T
~

hdWÎ³A (t)dWÎ³A (t)i

Z

3

(38)
(39)

and the Hamiltonian, number-damping, and energy-damping drift projector terms are given in Appendix A.1. The number-damping and energy-damping each have a corresponding drift, diffusion,
and trace2 term. It is worth remarking that that the general expression obtained above allows for any
observable. Furthermore, it is well-suited for significant simplification via an ansatz for the wavefunction, provided the integrals may be evaluated. In the remainder of this paper we explore the
consequences of this formulation, providing explicit stochastic equations for particular observables of
interest.

3.3

One-body operators

If we restrict our attention to one-body operators, the projected functional calculus assumes a particularly simple form. Consider a quantity that is the pure-state trace of a one-body operator
Z
âˆ—
A[Ïˆ, Ïˆ ] = hÏˆ|AÌ‚|Ïˆi =
d3 rhÏˆ|AÌ‚|riÏˆ(r),
(40)
where the operator AÌ‚ is independent of Ïˆ, Ïˆâˆ— . We emphasize that this quantity is spatial average for
the pure state wavefunction associated with each trajectory, and does not represent the many-body
expectation value found by tracing over the density matrix (the ensemble average). The non-zero
projected functional derivatives are
Î´Ì„A[Ïˆ, Ïˆâˆ— , t]
Î´AP [Ïˆ, Ïˆâˆ— , t]
= hÏˆ|PÌ‚AÌ‚PÌ‚|ri =
,
Î´Ïˆ(r)
Î´Ì„Ïˆ(r)
Î´Ì„(2) A[Ïˆ, Ïˆâˆ— , t]
Î´(2) AP [Ïˆ, Ïˆâˆ— , t]
0
=
hr
|
PÌ‚
AÌ‚
PÌ‚|ri
=
.
Î´Ïˆâˆ— (r0 )Î´Ïˆ(r)
Î´Ì„Ïˆâˆ— (r0 )Î´Ì„Ïˆ(r)

(41)
(42)

We refer to dAÎµ loosely as the energy-damping trace term, despite the fact it is not strictly a trace; it is the energydamping counterpart to the number-damping trace term, which is a true trace.
2

10

SciPost Physics

Submission

The projected functional derivatives corresponding to the operator AÌ‚ are equivalent to the regular
functional derivatives of the totally projected operator AÌ‚P â‰¡ PÌ‚AÌ‚PÌ‚; the change of variables is then
simple to construct. Again writing in the form of a wave function average with additional projector
terms, the SDE of the observable A is
* +
Z
E
âˆ‚AÌ‚
1 D
1
(I)dA(t) =
dt +
[AÌ‚, HÌ‚sp ] dt + 2Im d3 rhÏˆ|AÌ‚|ri(gn(r) + Î´V(r, t) âˆ’ Âµ)Ïˆ(r)dt
âˆ‚t
i~
~
Z
2Î³kB T  
Î³
Tr AÌ‚PÌ‚ dt
âˆ’ 2Re d3 rhÏˆ|AÌ‚|ri(L âˆ’ Âµ)Ïˆ(r)dt +
~
~
Z
h
iâˆ— 

âˆ’ 2M d3 k S (k)F ImhÏˆ|AÌ‚|riÏˆ(r) F âˆ‡ Â· j(r) dt
+ dWÎ³A (t) + dWÎµA (t)
Î³

Îµ
+ dAÎµ + QH
A + QA + QA ,

(43)

where the noise correlations are
hdWÎ³A (t)dWÎ³A (t)i

=

hdWÎµA (t)dWÎµA (t)i =

!
4Î³kB T D 2 E
Î³
AÌ‚ + DA dt,
~
!
Z
oi 2
h n
8MkB T
+ DÎµA dt,
d3 k kâˆ’1 F Im hÏˆ|AÌ‚|riÏˆ(r)
~

(44)
(45)

and the projector terms dAÎµ âˆ’ QÎµA are given in Appendix A. We have expressed Eq. (43) in terms of
the commutator [AÌ‚, HÌ‚sp ] to show the connection to the standard Ehrenfest relations.

3.4

Noise correlations for multiple moments

When considering more than one moment, one must take care when considering the noise terms that
arise. Let B = B[Ïˆ, Ïˆâˆ— , t] be another moment of the SPGPE with evolution described by Eq. (37). The
correlations between the noises corresponding to A and the noises corresponding to B are
Z
Z
4Î³kB T
Î´Ì„A[Ïˆ, Ïˆâˆ— , t] Î´Ì„B[Ïˆ, Ïˆâˆ— , t]
Re d3 r d3 r0
Î´(r, r0 )dt
~
Î´Ì„Ïˆ(r)
Î´Ì„Ïˆâˆ— (r0 )
" (
)#âˆ—
Z
8MkB T
Î´Ì„A[Ïˆ, Ïˆâˆ— , t]
3
âˆ’1
A
B
hdWÎµ (t)dWÎµ (t)i =
d k k F Im
Ïˆ(r, t)
~
Î´Ì„Ïˆ(r)
" (
)#
Î´Ì„B[Ïˆ, Ïˆâˆ— , t]
Ã—F Im
Ïˆ(r, t) dt
Î´Ì„Ïˆ(r)
hdWÎ³A (t)dWÎ³B (t)i =

(46)

(47)

for number-damping and energy-damping respectively.
The special case of one-body operators allows significant simplification: for moments that are the
expectation of a one-body operator the correlations reduce to
4Î³kB T
RehAÌ‚PÌ‚ BÌ‚idt,
~
Z
oiâˆ—
h n
8MkB T
A
B
hdWÎµ (t)dWÎµ (t)i =
d3 k kâˆ’1 F Im hÏˆ|AÌ‚PÌ‚|riÏˆ(r, t)
~
oi
h n
Ã—F Im hÏˆ| BÌ‚PÌ‚|riÏˆ(r, t) dt,

hdWÎ³A (t)dWÎ³B (t)i =

for number-damping and energy-damping respectively.
11

(48)

(49)

SciPost Physics

3.5

Submission

Finite-temperature stochastic Ehrenfest relations

We consider the Ehrenfest relations for position, momentum, angular momentum, grand canonical
energy, and coherent region particle number. The complete set of stochastic Ehrenfest relations for
the SPGPE are
E
1
2Î³ D
2Î³kB T  
(I)dR j (t) = P j (t)dt âˆ’ Re rÌ‚ j (L âˆ’ Âµ) dt +
Tr rÌ‚ j PÌ‚ dt
m
~
~
R
R
+ dWÎ³ j (t) + dWÎµ j (t)
Î³

+ QrHj + Qr j + QÎµr j + dRÎµj ,

E
D
E
2Î³kB T 
2Î³ D
Tr pÌ‚ j PÌ‚ dt
(I)dP j (t) = âˆ’ âˆ‚ j V(r, t) dt âˆ’ Re pÌ‚ j (L âˆ’ Âµ) dt +
~
~
Z
h
iâˆ— 

âˆ’ ~M d3 k S (k)F âˆ‚ j n(r) F âˆ‡ Â· j(r) dt
P

(50a)

P

+ dWÎ³ j (t) + dWÎµ j (t)
Î³

+ QHpj + Q p j + QÎµp j + dPÎµj ,

(50b)

D
E

E
2Î³ D
(I)dL j (t) = âˆ’ r j+1 âˆ‚ jâˆ’1 âˆ’ r jâˆ’1 âˆ‚ j+1 V(r, t) dt âˆ’ Re lË†j (L âˆ’ Âµ) dt
~
2Î³kB T  Ë† 
+
Tr l j PÌ‚ dt
~Z
h

iâˆ— 

âˆ’ ~M d3 k S (k)F r j+1 âˆ‚ jâˆ’1 âˆ’ r jâˆ’1 âˆ‚ j+1 n(r) F âˆ‡ Â· j(r) dt
L

L

+ dWÎ³ j (t) + dWÎµ j (t)
Î³

+ QlHj + Ql j + QÎµl j + dLÎµj ,
+
*
E

2Î³ D
2Î³kB T 
âˆ‚V(r, t)
dt âˆ’ Re (L âˆ’ Âµ)2 dt +
Tr PÌ‚ (L âˆ’ Âµ) PÌ‚ dt
(I)dK(t) =
âˆ‚t
~
~
Z

2
âˆ’ ~M d3 k S (k) F âˆ‡ Â· j(r) dt

(50c)

+ dWÎ³K (t) + dWÎµK (t)
Î³

Îµ
Îµ
+ QH
K + QK + QK + dK ,
2Î³
2Î³kB T N
(I)dN(t) = âˆ’ Reh(L âˆ’ Âµ)idt +
dt + dWÎ³N (t),
~
~

(50d)
(50e)

where the noise correlators are given by Eqs. (46),(47). This set of equations are our main result. They
take the form of generalized Ehrenfest relations with additional damping and noise terms arising from
the reservoir coupling processes. They provide a starting point for finding analytic descriptions of hot
BEC dynamics, and also provide tests for numerical consistency of SPGPE simulations. We make the
following remarks:
i) Ensemble averages.â€”Neglecting energy-damping and taking the average over the noise (in Ito
form the fields and noises are uncorrelated), we immediately recover the Ehrenfest relations for
the number-damped SPGPE as found in [21]. Those Ehrenfest relations described the evolution
of ensemble avarages, whereas in the present formulation we retain all noises in the collective
equations.
12

SciPost Physics

Submission

ii) Multiplicative noise.â€”Superficially, the multiplicative noise in the SPGPE Eq. (28) may appear
to have been transformed into additive
p noise. However, we emphasize that multiplicative noises
remain present in terms of the form hAÌ‚idW j , since hAÌ‚i is not a noise average.
iii) Additive noise.â€”Reduction to additive noise can be achieved in special cases where the system
can be well-described by a suitable physically motivated ansatz wavefunction. If such an ansatz is
available, reduction to an additive noise SDE provides a significant simplification that can enable
analytical progress [19].
iv) Projector terms.â€”The projector terms are all consistently accounted for, and in general contribute
additional noises. However, provided the basis of projection is properly chosen, their effect is
typically only a small correction. Testing whether such terms are negligible provides a useful
consistency test for a well-chosen cutoff.
v) Thermal equilibrium.â€”Formally it is known that trajectories of the SPGPE will approach a grand
canonical ensemble [10] describing the thermal equilibrium properties of the system. The c-field
ensemble is then drawn from the equilibrium Wigner functional
W[Ïˆ, Ïˆâˆ— ] âˆ exp (âˆ’Î²(H âˆ’ ÂµN)).

(51)

In the SPGPE, the particular ensemble depends upon the ratio M/Î³, with canonical equilibrium
reached in the limit M  Î³, and grand-canonical equilibrium reached in the opposite limit. The
equilibrium ensemble satisfies a set of fluctuation-dissipation relations, as may be derived by
applying the steady-state condition to Eq. (50). In each case there is a balance between thermal
noise and the damping. For example, for pure number damping it is easily shown that hhL âˆ’ Âµii =
kB T N for N â‰¡ Tr PÌ‚ modes in the C-region. The correct balance between damping and noise is
manifest through the absence of the dissipation parameters from such expressions, consistent with
their absence from the equilibrium ensemble Eq. (51). We note that ensemble (in)equivalence [27]
and the choice of an optimal cutoff [28] are both active areas of research.

4

Application to centre of mass fluctuations

As a test of the formalism we consider centre of mass oscillations in a quasi-1D harmonically trapped
system with frequency for transverse trapping Ï‰âŠ¥ such that Ï‰âŠ¥  Ï‰, the frequency for the axial
trap. Our primary aim is to test the validity of our analytical approach against c-field simulations.
The system we choose is particularly simple and thus amenable to analytic treatment of the SERs.
However, we must take some care in interpreting the reservoir theory in this case, as the Bose gas in a
harmonic trap obeys Kohnâ€™s theorem.
Kohnâ€™s theorem states that in a harmonically trapped system the centre of mass undergoes bulk
oscillations about the trap centre at the trapping frequency. While the second-quantized field theory
satisfies Kohnâ€™s theorem, the best available c-field reservoir theory describes the I region as time independent, and hence violates Kohnâ€™s theorem. C-field theory is thus currently best suited to systems
for which a time-independent high-energy thermal reservoir is a reasonable approximation. We emphasize that the low-energy c-field is a dynamical treatment of both condensate and non-condensate;
above a high-energy cutoff the dynamics are typically not included due to technical limitations.
While the time-independent reservoir approximation (TIRA) is not strictly applicable for scalar
BEC in the purely harmonic trap, there are a number of physical systems where it is applicable:
13

SciPost Physics

Submission

Kohnâ€™s theorem does not apply to a scalar Bose gas held in a harmonic trap if the trap becomes non
harmonic at high energy. The theorem is also inapplicable for a harmonically trapped system if the
reservoir consists of second atomic species confined by a different trapping potential, as may occur
during sympathetic cooling. Furthermore, any system that is not harmonically trapped will not obey
Kohnâ€™s theorem, and is thus potentially amenable to the TIRA. Examples systems in non-harmonic
traps for which the theory is applicable include vortex decay in hard-wall confinement [46], soliton
decay in a 1D toroidal trap (where the present approach was first used) [19], and persistent current
formation in a 3D toroidal trap, where SPGPE simulations [17] compare well with experiment [44].
In this work our approach is simply to test the formalism on a simple model system within the
TIRA by integrating out the spatial degrees of freedom to find effective stochastic equations of motion
for the centre of mass. We stress that the TIRA approached used here is physically valid for (at least)
two scenarios if immediate interest: non-harmonic trapping at high energies for a scalar BEC, and
sympathetic cooling involving two BEC components in different harmonic traps [14]3 . An effective
one-dimensional theory can be found in the prolate trapping regime where the reservoir remains three
dimensional4 , and the low-dimensional subspace is well-described by projecting onto the transverse
ground state of the confining potential.
The one dimensional SPGPE assumes an identical functional form to the three dimensional SPGPE,
but with dimensionally reduced damping and noise coefficients [18]. The number-damping term is
only changed by the replacement 1 â†’ 11D , as are the Hamiltonian terms. The scattering kernel in the
1D reduction of Eq. (26) becomes
!
1
|k|aâŠ¥
S 1 (k) = q
(52)
erfcx âˆš ,
2
2
8Ï€aâŠ¥
âˆš
2
where erfcx(q) â‰¡ eq erfc(q) is the scaled complementary error function,
and
a
â‰¡
~/mÏ‰âŠ¥ is the
âŠ¥
âˆš
transverse harmonic oscillator length, much smaller than aÏ‰ = ~/mÏ‰. The system is assumed
to be sufficiently condensed that the centre of mass motion can be approximated using a ThomasFermi wavefunction ansatz. We do not require that this is a good approximation â€” indeed, the hightemperature regime requires that it must not be. We merely require that it should approximate the
centre of mass motion. The Thomas-Fermi wave function allowing for arbitrary variations in the
centre of mass position x(t) and momentum p(t) is
"
#
r r
Âµ
(x âˆ’ x(t))2
ip(t)x
Ïˆ(x) =
1âˆ’
exp
.
(53)
1
~
R2
Using this ansatz, the integrals for Eqs. (50) can be evaluated analytically.5

4.1

Stochastic equations for centre of mass

In the interest of brevity, we outline the derivation here, providing details in Appendix B. We first use
the Thomas-Fermi ansatz Eq. (53) and evaluate the spatial integrals in (50a), (50b) to derive stochastic
equations for x and p that are exact within the Thomas-Fermi approximation. The projector terms,
3

The theory introduced here can be developed into a first-principles treatment for a particular atom number and temperature by self-consistent calculation of the reservoir interaction parameters [3, 13, 17].
4
Without this restriction the complexity of the reservoir interactions increases significantly and we do not pursue this
regime further here.
5
We note that in the basis of harmonic oscillator modes used to represent the C-region the trace terms in the Ehrenfest
relations for position and momentum vanish.

14

SciPost Physics

Submission

given in Appendix B.1, severely constrain exact analytic progress beyond this point. Provided these
terms may be safely neglected, we can arrive at an approximate set of equations that can be solved
analytically. For consistent c-field simulations, neglecting the projector terms in the SERs will always
be a good approximation, since for a well-chosen cutoff the mode population near the cutoff will be
relatively small. Since we are considering equilibrium states, we can assume that the values of x(t) and
p(t) will also be small relative to the characteristic harmonic oscillator length and momentum scales;
we test our assumptions by solving the SPGPE numerically. It is convenient to rewrite the equations
of motion as a single equation of motion for the dimensionless complex variable
r
mÏ‰
i
z(t) =
x(t) + âˆš
p(t),
(54)
2~
2~mÏ‰
and neglect terms of higher order than linear in z(t), zâˆ— (t), to find the simpler stochastic equations given
in Appendix B, Eq. (76). Assuming it is physically consistent to neglect projector terms in (76), (77a),
we arrive at the equation of motion




(I)dz(t) = âˆ’ iÏ‰z(t)dt âˆ’ Î›Î³ + Î›Îµ z(t)dt âˆ’ Î›Î³ âˆ’ Î›Îµ zâˆ— (t)dt
+ dWÎ³z (t) + dWÎµz (t),

(55)

with noise correlations
DÎ³
dt,
(56a)
2~mÏ‰3
mDÎµ
hdWÎµz (t)dWÎµz (t)i = âˆ’
dt.
(56b)
2~Ï‰
The equation of motion describes simple harmonic motion with two sources of damping and noise.
hdWÎ³z (t)dWÎ³z (t)i =

4.2

Analytic and numerical solutions

In this section we present an analytical treatment of the stochastic equations discussed in Section 4.1,
and compare the results with numerical simulations of the 1D SPGPE. The analytic approach offers a
simple intuitive picture of the dynamics of the centre of mass, for both number and energy damping
mechanisms, and for both dissipation and noise.
Neglecting the projector terms, we can write the coupled differential equation as a vector SDE
representing an Ornstein-Uhlenbeck process6
du(t) = âˆ’Î›u(t)dt + BdW(t),
where u(t) = [x(t), p(t)]| , and
"
#
2Î›Î³ âˆ’1/m
Î›=
,
mÏ‰2 2Î›Îµ

ï£®q
ï£¯ï£¯ï£¯ DÎ³
B = ï£¯ï£¯ï£¯ï£° m2 Ï‰4
0

(57)

0
p

m2 DÎµ

ï£¹
ï£ºï£ºï£º
ï£ºï£ºï£º ,
ï£»

(58)

are the drift and diffusion matrices respectively, and dW(t) = [dW1 (t), dW2 (t)]| is a vector of independent real Wiener processes with correlations hdWn (t)dWm (t)i = Î´mn dt. The SDE has the formal
solution
Z t


u(t) = exp [âˆ’Î›t] u(0) +
exp âˆ’Î›(t âˆ’ t0 ) BdW(t0 ),
(59)
0
6

The defining property of an Ornstein-Uhlenbeck process is that the drift and diffusion matrices are independent of the
stochastic field. Since the noise is additive, the distinction between Ito and Stratonovich is irrelevant for Ornstein-Uhlenbeck
processes.

15

SciPost Physics

Submission

âˆ’3

âˆ’3

x 10

3

1
0

âˆ’1
âˆ’2
âˆ’3

3

2

G pp(Ï„ )/(hÌ„mÏ‰)

G xx(Ï„ )/a 2Ï‰

2

âˆ’3

x 10

1
0
âˆ’1
âˆ’2

âˆ’2

âˆ’1

0

1

2

âˆ’3

Ï„ /t Ï‰

x 10

2

G px(Ï„ )/hÌ„

3

1
0
âˆ’1
âˆ’2

âˆ’2

âˆ’1

0

1

2

âˆ’3

âˆ’2

Ï„ /t Ï‰

âˆ’1

0

1

2

Ï„ /t Ï‰

Figure 2: Steady-state time correlations for position-position (left), momentum-momentum (middle)
and momentum-position (right), as determined by numerical solutions of the SPGPE (red dots) and
the analytic solutions (solid blue) Eq. (63a)-Eq. (63c).

where have assumed the initial state u(0) to be deterministic. The mean undergoes exponential decay
hu(t)i = exp [âˆ’Î›t] u(0).
For a system with x(0) = x0 and p(0) = 0, the centre of mass position over time is given by
ï£®
ï£¹
 Î›Î³ âˆ’ Î›Îµ

ï£ºï£º
ï£¯ 
âˆ’(Î›Î³ +Î›Îµ )t ï£¯ï£¯ï£¯
hx(t)i = x0 e
(60)
sin Ï‰Î³Îµ t ï£ºï£ºï£ºï£» ,
ï£¯ï£°cos Ï‰Î³Îµ t +
Ï‰Î³Îµ
q
where we have defined the frequency Ï‰Î³Îµ = Ï‰2 âˆ’ (Î›Î³ âˆ’ Î›Îµ )2 . This simple result has a clear interpretation in terms of the decaying oscillatory motion of the centre of mass with effective damping
rates given by the SPGPE. Note that since we have arrived at a description with additive noise, the
noise does not alter the average coordinate.
To study this regime of energy-damped dynamics numerically, we consider the steady-state correlations given by
G(Ï„) â‰¡
=

lim h[u(t) âˆ’ hu(t)i] [u(t + Ï„) âˆ’ hu(t + Ï„)i]| i

tâ†’âˆ
Z min(t,t+Ï„)





exp âˆ’Î›(t âˆ’ t0 ) BB| exp âˆ’Î›| (t + Ï„ âˆ’ t0 ) dt0 .

(61)

âˆ’âˆ

Fourier transforming with respect to Ï„ in the steady-state, the fluctuation spectra are given by
S(â„¦) =

1
(Î› + iâ„¦)âˆ’1 BB| (Î›| âˆ’ iâ„¦)âˆ’1 .
2Ï€

(62)

The steady-state correlations for position-position, momentum-momentum, and momentum-position
are

 Ï‰ 
kB T 1 âˆ’(Î›Î³ +Î›Îµ )|Ï„|
Î³Îµ
G xx (Ï„) = âˆ’
e
sin Ï‰Î³Îµ |Ï„| âˆ’ sinâˆ’1
,
(63a)
Nm Ï‰Ï‰Î³Îµ
Ï‰



mkB T Ï‰ âˆ’(Î›Î³ +Î›Îµ )|Ï„|
âˆ’1 Ï‰Î³Îµ
G pp (Ï„) =
e
sin
Ï‰
|Ï„|
+
sin
,
(63b)
Î³Îµ
N Ï‰0Î³Îµ
Ï‰


kB T 1 âˆ’(Î›Î³ +Î›Îµ )|Ï„|
G px (Ï„) =
e
sin Ï‰0Î³Îµ Ï„ ,
(63c)
0
N Ï‰Î³Îµ
16

SciPost Physics

Submission

respectively. The steady-state spectra for position-position, momentum-momentum, and momentumposition are
S xx (â„¦) =
S pp (â„¦) =
S px (â„¦) =

Î›Îµ (4Î›Î³ Î›Îµ + Ï‰2 ) + Î›Î³ â„¦2
2kB T
,
NÏ€mÏ‰2 (4Î›Î³ Î›Îµ + Ï‰2 )2 âˆ’ 2(Ï‰2 âˆ’ 2(Î›2Îµ + Î›2Î³ ))â„¦2 + â„¦4
Î›Î³ (4Î›Î³ Î›Îµ + Ï‰2 ) + Î›Îµ â„¦2
2kB T m
,
NÏ€ (4Î›Î³ Î›Îµ + Ï‰2 )2 âˆ’ 2(Ï‰2 âˆ’ 2(Î›2Îµ + Î›2Î³ ))â„¦2 + â„¦4
(Î›Î³ + Î›Îµ )â„¦
2ikB T
,
NÏ€ (4Î›Î³ Î›Îµ + Ï‰2 )2 âˆ’ 2(Ï‰2 âˆ’ 2(Î›2Îµ + Î›2Î³ ))â„¦2 + â„¦4

(64a)
(64b)
(64c)

respectively.
We now test our analytical description against SPGPE simulations. While the SPGPE can be
used for quantitative modelling [17, 29, 30] here our aim is simply to test our analytic solutions of the
SPGPE using the SERs. We thus choose parameters that are representative of BEC experiments, and
leave a first principles treatment of reservoir interactions [18] for future work.
We perform simulations of the 1D SPGPE [18] with the initial condition given by Eq. (53) with
x(0) = p(0) = 0. We use a chemical potential of Âµ = 100~Ï‰, an energy cutoff of c = 250~Ï‰, a
temperature of T = 500~Ï‰/kB , an interaction strength of 11D = 0.01~Ï‰aÏ‰ , an energy-damping rate of
M = 0.0005a2Ï‰ , and a number-damping rate of Î³ = 0.001. We chose values for the damping rates such
that Î›Îµ â‰ˆ Î›Î³ and thus neither damping process is dominant over the other. Timescales are considered
in units of the harmonic oscillator time period tÏ‰ â‰¡ 2Ï€/Ï‰.
We compare our analytic solutions with the numerical data from equilibrated SPGPE simulations.
In Fig. 2 we show the steady-state correlation functions for an ensemble of 5000 trajectories7 . We
see that the analytic and numeric results show excellent agreement for short times with differences
becoming more pronounced for larger Ï„. Similarly, the steady-state spectra for position-position,
momentum-momentum, and momentum-position are shown in Fig. 3, where the numeric spectra are
obtained using the Wiener-Khinchin theorem applied to the numeric steady-state correlations. The
bulk oscillation seen in Fig. 2 is the Kohn mode, as seen from the peak at â„¦ â‰¡ Ï‰ in Fig. 3. The
spectral linewidth represents the decay time of the two-time correlation function, determined by Î›Îµ
and Î›Î³ , the energy and number damping rates. Again we see that the analytic and numeric results show
good agreement. To assess the validity of neglecting projector terms in our analytical treatment, we
evaluate their contribution numerically in Appendix B.3, finding that indeed the projector correction
is negligible.

7

When calculating the correlations from the numeric data, we have assumed that the system has reached equilibrium
after five trap cycles t = 5tÏ‰ , and used ergodic averaging over the remaining time interval t = 5tÏ‰ . With respect to the
dissipation timescale (Î›Î³ + Î›Îµ )âˆ’1 , the timescale of averaging is equivalent to t = 2.78(Î›Î³ + Î›Îµ )

17

SciPost Physics

Submission

âˆ’3

âˆ’3

x 10

5

S pp(â„¦)/(hÌ„m)

3
2
1

0
âˆ’2

5

4

S xx(â„¦) Ã— Ï‰/a 2Ï‰

4

âˆ’3

x 10

|S px(â„¦)| /(ma 2Ï‰ )

5

3
2
1

âˆ’1

0

1

2

0
âˆ’2

â„¦/Ï‰

âˆ’1

0

â„¦/Ï‰

1

2

x 10

4
3
2
1

0
âˆ’2

âˆ’1

0

1

2

â„¦/Ï‰

Figure 3: Steady-state spectra for position-position (left), momentum-momentum (middle) and
momentum-position (right), as determined by numerical solutions of the SPGPE (red dots) and the
analytic solutions (solid blue) Eq. (64a)-Eq. (64c).

5
5.1

Discussion and Conclusions
Discussion

The SERs derived here using projected functional calculus contain many projector terms, posing a
technical challenge. As an application of projected functional calculus, our approach bears comparison
with that of Opanchuk et al [31], where a number of useful functional relations were derived for
Wigner phase-space methods [6] involving projected fields. The action of the projector was reduced
to the action of matrix operations, as is always possible in a finite basis. While not without its own
technical challenges, our approach has the advantage that the equations of motion have an obvious
link with the continuum limit recovered for a high cutoff.
An alternate stochastic reservoir theory, namely the Stoof SGPE [32], has been used in several
studies of finite-temperature BEC dynamics [33â€“37]. While the SGPE lacks a projection operator of
the form used in the present work, our aims are similar in spirit to the work of Duine et al. [38] applying
path-integral techniques to the Stoof SGPE to find effective stochastic equations for a reduced set of
variables. However, the explicit high-energy cutoff in the SPGPE necessitates a different technical
approach, with significant differences appearing in the resulting stochastic equations. As the energydamping mechanism is absent from the Stoof SGPE, an interesting future direction is to identify
further experimentally accessible regimes capable of distinguishing between the two approaches [30].
A related question receiving recent attention is that of ensemble equivalence [27]; in general the
equilibrium ensemble generated by the SPGPE will be affected by the relative strengths of number
and energy damping processes.
In applications of the SPGPE, the energy cutoff must be chosen such that the bulk of the coherent
region modes are significantly occupied compared to the modes in the incoherent region. The relative
occupation at the cutoff thus determines the presence of spurious dynamics due to the projector, and
this population can typically be chosen to be of order unity. Ultimately, large projector corrections
generate spurious dynamics and for a consistent treatment the cutoff should be chosen such that the
projector corrections are small.

18

SciPost Physics

5.2

Submission

Conclusions

We have developed a set of exact stochastic Ehrenfest relations (SERs) for the complete stochastic projected Gross-Pitaevskii equation [10], an equation of motion which has significant application in the
study of finite-temperature Bose-Einstein condensates [3, 9, 11]. In addition to the number-damping
process, the SPGPE contains a number-conserving dissipative mechanism that transfers energy between the system and reservoir. Our main result, the SERs, retain the stochastic nature of the SPGPE
and explicitly contain terms that result from both number- and energy-damping processes.
We tested our stochastic Ehrenfest equations in two ways. Considering the centre of mass motion of a finite-temperature quasi-1D condensate near equilibrium, we tracked the size of the largest
projector corrections and saw they are indeed small. We also compared the steady-state correlations
of position and momentum to analytic solutions derived by neglecting the projector corrections, finding excellent agreement. Our chosen test system has the weakness that the centre of mass motion in
a purely harmonic trap is not strictly amenable to the reservoir theory due to a violation of Kohnâ€™s
theorem, However, our treatment is physically relevant for non-harmonic trapping, multicomponent
systems, and other systems of interest that physically violate Kohnâ€™s theorem, provided a low-energy
fraction is harmonically trapped. Indeed, since the thermal equilibrium properties involve small excursions from equilibrium, the confining potential is only required to be locally harmonic near the trap
minimum and any number of non-harmonic effects may intrude at larger distances. The centre of mass
motion thus provides an excellent formal and numerical test of the SERs, being one of the simplest
states of motion to handle analytically.
We have shown that SERs can be used to obtain analytic equations that agree with numerical
solutions of the full SPGPE and offer some physical insight into the open system dynamics. Future
work will explore systems involving analytically tractable excitations such as vortex decay in hardwall confinement [46], soliton [39] and phase-slip dynamics [40] in toroidal confinement, sympathetic
cooling [41, 42], spinor BECs [43], and quantum turbulence in non-harmonic traps [44â€“47].

Acknowledgements
We thank Matthew Reeves and Sam Rooney for valuable discussions.
Funding information ASB was supported by the Marsden Fund (Contract UOO1726), and the
Dodd-Walls Centre for Photonic and Quantum Technologies.

19

SciPost Physics

A
A.1

Submission

Projector terms
General operators

For general operator AÌ‚, the drift projector terms are
!
Z
âˆ—
2
H
3
âˆ— Î´A[Ïˆ, Ïˆ , t]
dt,
QA = âˆ’ Im d r (1n(r) + Î´V(r, t))Ïˆ(r)Q
~
Î´Ïˆ(r)
!
Z
2Î³
Î´A[Ïˆ, Ïˆâˆ— , t]
Î³
QA =
Re d3 r (1n(r) + Î´V(r, t))Ïˆ(r)Qâˆ—
dt,
~
Î´Ïˆ(r)
!#âˆ—
"
Z


Î´A[Ïˆ, Ïˆâˆ— , t]
Îµ
3
âˆ—
F âˆ‡ Â· j(r) dt,
QA = 2M Im d k S (k)F Ïˆ (r)Q
âˆ—
Î´Ïˆ (r)
the number-damping, and energy-damping diffusion projector terms are
!
Z
4Î³kB T
Î´A[Ïˆ, Ïˆâˆ— , t] âˆ— Î´A[Ïˆ, Ïˆâˆ— , t]
Î³
DA = âˆ’
Re
Q
,
d3 r
~
Î´Ïˆâˆ— (r)
Î´Ïˆ(r)
"
!# 2
Z
âˆ—
8MkB T
Îµ
3
âˆ— Î´A[Ïˆ, Ïˆ , t]
DA =
dt d k S (k) F Im Ïˆ(r)Q
~
Î´Ïˆ(r)
!#
"
#âˆ— "
Z
âˆ—
âˆ—
16MkB T
Î´A[Ïˆ, Ïˆ , t]
3
âˆ— Î´A[Ïˆ, Ïˆ , t]
,
âˆ’
dt d k S (k)F Im
Ïˆ(r) F Im Ïˆ(r)Q
~
Î´Ïˆ(r)
Î´Ïˆ(r)

(65a)
(65b)
(65c)

(66a)

(66b)

and the epsilon term is
"
#
Z
Z
âˆ—
kB T
3
3 0 Î´Ì„A[Ïˆ, Ïˆ , t]
0
0
dA = âˆ’
d r d r
Î´(r, r )Ïˆ(r ) + h.c. Îµ(r âˆ’ r0 )dt
~
Î´Ì„Ïˆ(r)
#
" (2)
Z
Z
âˆ—
kB T
3
3 0 Î´Ì„ A[Ïˆ, Ïˆ , t] âˆ— 0
d r d r
+
Ïˆ (r )Ïˆ(r) + h.c. Îµ(r âˆ’ r0 )dt
âˆ—
0
~
Î´Ì„Ïˆ (r )Î´Ì„Ïˆ(r)
" (2)
#
Z
Z
kB T
Î´Ì„
A[Ïˆ, Ïˆâˆ— , t]
3
3 0
0
âˆ’
d r d r
Ïˆ(r )Ïˆ(r) + h.c. Îµ(r âˆ’ r0 )dt.
~
Î´Ì„Ïˆ(r0 )Î´Ì„Ïˆ(r)
Îµ

A.2

(67)

One-body operators

For the special case where AÌ‚ is a one-body operator, the projector corrections take a simpler form. In
this case we find the drift projector terms
Z
2
H
(68a)
QA = âˆ’ Im d3 rhÏˆ|AÌ‚QÌ‚|ri(1n(r) + Î´V(r, t))Ïˆ(r)dt
~
Z
2Î³
Î³
QA =
Re d3 rhÏˆ|AÌ‚QÌ‚|ri(1n(r) + Î´V(r, t))Ïˆ(r)dt
(68b)
~
Z
h
iâˆ— 

QÎµA = 2M Im d3 k S (k)F hr|QÌ‚AÌ‚|ÏˆiÏˆâˆ— (r) F âˆ‡ Â· j(r) dt,
(68c)
diffusion projector terms
4Î³kB T
Î³
DA = âˆ’
hAÌ‚QÌ‚AÌ‚i
~
Z
h
i2
8MkB T
Îµ
dt d3 k S (k) F ImhÏˆ|AÌ‚QÌ‚|riÏˆ(r)
DA =
~
Z
h
iâˆ— h
i
16MkB T
âˆ’
dt d3 k S (k)F ImhÏˆ|AÌ‚|riÏˆ(r) F ImhÏˆ|AÌ‚QÌ‚|riÏˆ(r) ,
~
20

(69)

(70)

SciPost Physics

Submission

and the epsilon term
Z
Z
kB T
3
dA = âˆ’
dt d r d3 r0 hÏˆ|AÌ‚PÌ‚|riÎ´(r, r0 )Ïˆ(r0 )Îµ(r âˆ’ r0 ) + h.c.
~
Z
Z
kB T
3
dt d r d3 r0 hr|PÌ‚AÌ‚PÌ‚|r0 iÏˆâˆ— (r)Ïˆ(r0 )Îµ(r âˆ’ r0 ) + h.c.
+
~
Îµ

B

(71)

Centre of mass equations

Integrating over the Thomas-Fermi ansatz, the SERs for position and momentum take the form of a
pair of coupled stochastic differential equations for the centre of mass position and momentum
(I)dx(t) =

1
Î³mÏ‰2
p(t)dt âˆ’
x(t)3 dt âˆ’ 2Î›Î³ x(t)dt + dWÎ³x (t)
m
~
Î³
Îµ
Îµ
+ dWÎµx (t) + qH
x + q x + q x + dx dt,

(I)d p(t) = âˆ’ mÏ‰2 x(t)dt âˆ’

Î³mÏ‰2

(72)
p

x(t)2 p(t)dt âˆ’ 2Î›Îµ p(t)dt + dWÎµ (t)
~
Î³
p
+ dWÎ³ (t) + qHp + q p + qÎµp + d pÎµ dt.

(73)

Here the noise correlations are
hdWÎ³x (t)dWÎ³x (t)i
p

=

!
DÎ³
4Î³kB T x(t)2
Î³
+
+ d x dt,
N~
m2 Ï‰4
Î³
d p dt,
4Âµ1 Î³kB T
p(t)x(t)dt,
âˆ’
g1 ~
dÎµx dt,


m2 DÎµ + dÎµp dt,

=

dÎµx,p dt,

=

p

hdWÎ³ (t)dWÎ³ (t)i =
p

hdWÎ³x (t)dWÎ³ (t)i =
hdWÎµx (t)dWÎµx (t)i =
p
p
hdWÎµ (t)dWÎµ (t)i
p
hdWÎµx (t)dWÎµ (t)i

(74a)
(74b)
(74c)
(74d)
(74e)
(74f)

and the drift and diffusion rates are
2Î³Âµ
4mÏ‰2 kB T
4kB T
, DÎ³ =
Î›Î³ , DÎµ =
Î›Îµ ,
5~
N
mNTF
r
!
Z âˆ
3Ï‰M~
Âµ
|q|aâŠ¥ (sin(q) âˆ’ q cos(q))2
Î›Îµ =
dq
erfcx
,
âˆš
21RaâŠ¥ mÏ€3 0
q4
R 2

Î›Î³ =

(75)

derived from the effective one dimensional SPGPE [18] by integrating over the Thomas-Fermi ansatz.
In terms of the dimensionless phase-space amplitude Eq. (54) the equation of motion becomes




(I)dz(t) = âˆ’ iÏ‰z(t)dt âˆ’ Î›Î³ + Î›Îµ z(t)dt âˆ’ Î›Î³ âˆ’ Î›Îµ zâˆ— (t)dt
z
z
z
z
+ dWÎ³,1
(t) + dWÎµ,1
(t) + dWÎ³,2
(t) + dWÎµ,2
(t)
Î³

+ qzH dt + qz dt + qÎµz dt + dzÎµ dt,

21

(76)

SciPost Physics

Submission

where the noises have non-zero correlations
z
z
hdWÎ³,1
(t)dWÎ³,1
(t)i

=

z
z
hdWÎ³,2
(t)dWÎ³,2
(t)i =
z
z
hdWÎµ,1
(t)dWÎµ,1
(t)i =
z
z
hdWÎµ,2
(t)dWÎµ2
(t)i =
z
z
hdWÎµ,1
(t)dWÎµ2
(t)i =

!
mÏ‰ DÎ³
Î³
+ d x dt,
2~ m2 Ï‰4
1
Î³
âˆ’
d p dt,
2~mÏ‰
mÏ‰ Îµ
d dt,
2~ x

1  2
âˆ’
m DÎµ + dÎµp dt,
2~mÏ‰
i Îµ
d dt,
2~ x,p

(77a)
(77b)
(77c)
(77d)
(77e)

and the projector terms are given below. The projector terms are relatively simple for this SPGPE
describing a BEC in an oblate parabolic trap with only one effective C-region dimension [18]. We first
consider the position and momentum terms separately, and then give the terms for the dimensionless
complex variable Eq. (54).

B.1

Position and momentum

Noting that
r

~(nc + 1) âˆ—
Î±nc (t)Ï†âˆ—nc +1 (x),
2mÏ‰
r
~mÏ‰(nc + 1) âˆ—
Î±nc (t)Ï†âˆ—nc +1 (x),
hÏˆ| pÌ‚QÌ‚|xi = âˆ’i
2
hÏˆ| xÌ‚QÌ‚|xi =

the projector and epsilon terms for x and p are
r
(
)
Z
11 2(nc + 1)
H
âˆ—
âˆ—
qx = âˆ’
Im Î±nc (t) dxÏ†nc +1 (x)Ïˆ(x)n(x) ,
N
~mÏ‰
r
(
)
Z
2(nc + 1)
Î³ 11 Î³
âˆ—
âˆ—
Re Î±nc (t) dxÏ†nc +1 (x)Ïˆ(x)n(x) ,
qx =
N
~mÏ‰
r
Z
oiâˆ— 
h n

2~(nc + 1)
Îµ M
qx =
dk S 1 (k)F Im Î±âˆ—nc (t)Ï†âˆ—nc +1 (x)Ïˆ(x) F âˆ‚ x j(x) ,
N
mÏ‰
2Î³kB T (nc + 1)
2
Î³
dx = âˆ’
Î±nc (t) ,
2
N mÏ‰ Z
oi 2
h n
âˆ—
âˆ—
Îµ 4MkB T (nc + 1)
dx =
dkS
(k)
F
Im
Î±
(t)Ï†
(x)Ïˆ(x)
,
1
n
n
+1
c
c
N 2Z
mÏ‰ Z
kB T
dxÎµ = âˆ’
dx dx0 hÏˆ| xÌ‚PÌ‚|xiÎ´(x, x0 )Ïˆ(x0 )Îµ(x âˆ’ x0 ) + h.c.
N~
Z
Z
kB T
+
dx dx0 hx|PÌ‚ xÌ‚PÌ‚|x0 iÏˆâˆ— (x)Ïˆ(x0 )Îµ(x âˆ’ x0 ) + h.c.,
N~

22

(78)
(79)

(80a)
(80b)
(80c)
(80d)
(80e)

(80f)

SciPost Physics

Submission

and
qHp
Î³

qp
qÎµp
Î³

dp
dÎµp

d pÎµ

B.2

r

(
)
Z
2mÏ‰(nc + 1)
âˆ—
âˆ—
Re Î±nc (t) dxÏ†nc +1 (x)Ïˆ(x)n(x) ,
~
r
(
)
Z
11 Î³ 2mÏ‰(nc + 1)
âˆ—
âˆ—
=
Im Î±nc (t) dxÏ†nc +1 (x)Ïˆ(x)n(x) ,
N
~
Z
oiâˆ— 
h n

Mp
2~mÏ‰(nc + 1) dk S 1 (k)F Re Î±âˆ—nc (t)Ï†âˆ—nc +1 (x)Ïˆ(x) F âˆ‚ x j(x) ,
=
N
2Î³mÏ‰kB T (nc + 1)
2
Î±nc (t) ,
=âˆ’
N2
Z
oi 2
h n
4MkB T
âˆ—
âˆ—
=
F
Re
Î±
(t)Ï†
(x)Ïˆ(x)
dkS
(k)
mÏ‰(n
+
1)
c
1
n
n
+1
c
c
N2
n h n
oi
o!
p
âˆ—
âˆ—
âˆ—
âˆ’ 8~mÏ‰(nc + 1)Re F Re Î±nc (t)Ï†nc +1 (x)Ïˆ(x) F [âˆ‚ x n(x)] ,
Z
Z
kB T
dx dx0 hÏˆ| pÌ‚PÌ‚|xiÎ´(x, x0 )Ïˆ(x0 )Îµ(x âˆ’ x0 ) + h.c.
=âˆ’
N~
Z
Z
kB T
dx dx0 hx|PÌ‚ pÌ‚PÌ‚|x0 iÏˆâˆ— (x)Ïˆ(x0 )Îµ(x âˆ’ x0 ) + h.c..
+
N~
11
=
N

(81b)
(81c)
(81d)

(81e)

(81f)

Dimensionless variable z(t)

The projector corrections for the dimensionless variable phase-space amplitude z(t) are
Z
i11 p
H
âˆ—
qz =
nc + 1Î±nc (t) dxÏ†âˆ—nc +1 (x)Ïˆ(x)n(x),
~N
Z
p
Î³ Î³11
âˆ—
qz =
nc + 1Î±nc (t) dxÏ†âˆ—nc +1 (x)Ïˆ(x)n(x),
~N
Z
h
iâˆ— 
p

âˆ—
Îµ iM
nc + 1Î±nc (t) dk S 1 (k)F Ï†âˆ—nc +1 (x)Ïˆ(x) F âˆ‚ x j(x) ,
qz =
N
Î³kB T (nc + 1)
2
Î³
dz = âˆ’
Î±nc (t) ,
2
~N
Z
oi 2
h n
2Mk
T
(nc + 1)
B
Îµ,a
âˆ—
âˆ—
dkS
(k)
F
Im
Î±
(t)Ï†
(x)Ïˆ(x)
,
dz =
1
nc
nc +1
~N 2
Z
oi 2
h n
2MkB T
dzÎµ,b =
dk S 1 (k) (nc + 1) F Re Î±âˆ—nc (t)Ï†âˆ—nc +1 (x)Ïˆ(x)
2
~N
r
oiâˆ—
o!
8~(nc + 1) n h n âˆ—
âˆ—
Re F Re Î±nc (t)Ï†nc +1 (x)Ïˆ(x) F [âˆ‚ x n(x)] ,
+
mÏ‰
Z
Z
kB T
dzÎµ = âˆ’
dx dx0 hÏˆ|zÌ‚PÌ‚|xiÎ´(x, x0 )Ïˆ(x0 )Îµ(x âˆ’ x0 ) + h.c.
N~
Z
Z
kB T
+
dx dx0 hx|PÌ‚zÌ‚PÌ‚|x0 iÏˆâˆ— (x)Ïˆ(x0 )Îµ(x âˆ’ x0 ) + h.c.
N~

B.3

(81a)

(82a)
(82b)
(82c)
(82d)
(82e)

(82f)

(82g)

Numerical evaluation of projector terms

With the exception of the epsilon correction Eq. (82g), all the cutoff terms are a result of mode mixing between the highest energy coherent mode and the lowest energy incoherent mode. In the limit
23

SciPost Physics

Submission

0.1

i=1
i=2

0.06

( i)

E z (t)

0.08

0.04

0.02

0
0

2

4

6

8

10

t/t Ï‰

Figure 4: The mean relative cutoff term magnitudes, Eq. (83), for qzH (blue) and dzÎµ (green) over time
determined numerically for an ensemble of 1000 trajectories.

of imposing a very high energy cutoff, the populations of the modes above the cutoff approach zero
and hence all the cutoff terms go to zero. For a well-chosen but finite cutoff the integrals involving
the overlap of the lowest energy incoherent mode Ï†nc +1 (x) and the coherent field wave function Ïˆ(x)
should be small, as Ï†nc +1 (x) is highly oscillatory and the mode population is also small by definition.
We claim that for a well-chosen cutoff the cutoff terms are small enough such that they may be neglected, and we justify this in two ways. Firstly, we consider the magnitude of a selection of the cutoff
terms by calculating them numerically. Second, we consider the analytic solutions that can be found
by neglecting the cutoff terms and show that these agree well with simulations of the 1D SPGPE.
When considering the cutoff terms involving mode mixing at the cutoff (i.e. all except the epsilon
correction), we note that only the Hamiltonian cutoff term qzH Eq. (82a) does not have one of the
damping rates as a multiplying factor. As the damping rates have a typical value several orders of
magnitude less than unity, it is reasonable to expect that of all these terms, the Hamiltonian cutoff
term will be the largest. If we show that qzH is small enough to be neglected then we can reason that
Î³
Î³
qz Eq. (82b), qÎµz Eq. (82c), dz Eq. (82d), dzÎµ |(1) Eq. (82e), and dzÎµ |(2) Eq. (82f) are smaller still and so
can certainly be neglected also.
The epsilon term dzÎµ Eq. (82g) is distinct from the other terms, as it is not a result of mode mixing
at the cutoff. We expect the two terms in the epsilon term to almost cancel, as it is clear this is the case
in the limit that the projector becomes the identity. This is an important result of the earlier step where
we found that writing the SPGPE in Ito form resulted in an extra term; without this extra term the
epsilon term would in general be non-negligible, and in fact diverges in the infinite cutoff limit. We
thus monitor the magnitudes of qzH and dzÎµ over the course of an ensemble of numerical trajectories.
We define the relative cutoff term magnitudes by
Ez(1) (t) = qzH (t)/zÌ‡(t) ,

Ez(2) (t) = |dzÎµ (t)/zÌ‡(t)| ,

(83)

noting that |zÌ‡(t)| is strictly non-zero for harmonic motion. If these values remain significantly less than
unity, then we may conclude that the effects of the cutoff terms are negligible. For the simulations
of section 4.2, example relative cutoff term magnitudes are shown in Fig. 4, where the initial state is
Eq. (53) with x(0) = p(0) = 0 and we have taken an ensemble average over 1000 trajectories. While
the relative magnitudes can reach as high as âˆ¼ 0.1 early in the dynamics, we see that once the system
24

SciPost Physics

Submission

has equilibrated they approach a steady-state of order âˆ¼ 0.01.

References
[1] J. R. Anglin and W. Ketterle, Bose-Einstein condensation of atomic gases, Nature 416(6877),
211 (2002), doi:10.1038/416211a.
[2] J. R. Anglin and W. H. Zurek, Vortices in the Wake of Rapid Bose-Einstein Condensation, Phys.
Rev. Lett. 83(9), 1707 (1999), doi:10.1103/PhysRevLett.83.1707.
[3] C. N. Weiler, T. W. Neely, D. R. Scherer, A. S. Bradley, M. J. Davis and B. P. Anderson, Spontaneous vortices in the formation of Boseâ€“Einstein condensates, Nature 455(7215), 948 (2008),
doi:10.1038/nature07334.
[4] E. Zaremba, T. Nikuni and A. Griffin, Dynamics of Trapped Bose Gases at Finite Temperatures,
Journal of Low Temperature Physics 116(3-4), 277 (1999), doi:10.1023/A:1021846002995.
[5] B. Jackson and E. Zaremba,
Quadrupole Collective Modes in Trapped FiniteTemperature Bose-Einstein Condensates, Physical Review Letters 88(18), 180402 (2002),
doi:10.1103/PhysRevLett.88.180402.
[6] M. J. Steel, M. K. Olsen, L. I. Plimak, P. D. Drummond, S. M. Tan, M. J. Collett, D. F. Walls
and R. Graham, Dynamical quantum noise in trapped Bose-Einstein condensates, Phys. Rev. A
58(6), 4824 (1998), doi:10.1103/PhysRevA.58.4824.
[7] C. W. Gardiner and P. Zoller, Quantum Noise, Springer, 2nd edn. (1999).
[8] N. P. Proukakis and B. Jackson, Finite-temperature models of Boseâ€“Einstein condensation, J.
Phys. B: At. Mol. Opt. Phys. 41(20), 203002 (2008), doi:10.1088/0953-4075/41/20/203002.
[9] P. B. Blakie, A. S. Bradley, M. J. Davis, R. J. Ballagh and C. W. Gardiner, Dynamics and
statistical mechanics of ultra-cold Bose gases using c-field techniques, Advances in Physics
57(5), 363 (2008), doi:10.1080/00018730802564254.
[10] C. W. Gardiner and M. J. Davis, The stochastic Grossâ€“Pitaevskii equation: II, J. Phys. B: At.
Mol. Opt. Phys. 36(23), 4731 (2003), doi:10.1088/0953-4075/36/23/010.
[11] A. S. Bradley, C. W. Gardiner and M. J. Davis, Bose-Einstein condensation from a rotating
thermal cloud: Vortex nucleation and lattice formation, Phys. Rev. A 77(3), 033616 (2008),
doi:10.1103/physreva.77.033616.
[12] S. J. Rooney, P. B. Blakie and A. S. Bradley,
Numerical method for the
stochastic projected Gross-Pitaevskii equation,
Phys. Rev. E 89(1), 013302 (2014),
doi:10.1103/PhysRevE.89.013302.
[13] S. J. Rooney, P. B. Blakie and A. S. Bradley, Stochastic projected Gross-Pitaevskii equation,
Phys. Rev. A 86(5), 053634 (2012), doi:10.1103/PhysRevA.86.053634.
[14] A. S. Bradley and P. B. Blakie,
Stochastic projected Gross-Pitaevskii equation
for spinor and multicomponent condensates,
Phys. Rev. A 90(2), 023631 (2014),
doi:10.1103/PhysRevA.90.023631.
25

SciPost Physics

Submission

[15] C. W. Gardiner and P. Zoller,
Quantum kinetic theory. III. Quantum kinetic master equation for strongly condensed trapped systems, Phys. Rev. A 58(1), 536 (1998),
doi:10.1103/PhysRevA.58.536.
[16] M. J. Davis, S. A. Morgan and K. Burnett, Simulations of Bose Fields at Finite Temperature,
Phys. Rev. Lett. 87(16), 160402 (2001), doi:10.1103/PhysRevLett.87.160402.
[17] S. J. Rooney, T. W. Neely, B. P. Anderson and A. S. Bradley, Persistent-current formation in
a high-temperature Bose-Einstein condensate: An experimental test for classical-field theory,
Phys. Rev. A 88(6), 063620 (2013), doi:10.1103/PhysRevA.88.063620.
[18] A. S. Bradley, S. J. Rooney and R. G. McDonald, Low-dimensional stochastic projected GrossPitaevskii equation, Phys. Rev. A 92(3), 033631 (2015), doi:10.1103/PhysRevA.92.033631.
[19] R. G. McDonald and A. S. Bradley, Reservoir interactions during Bose-Einstein condensation:
Modified critical scaling in the Kibble-Zurek mechanism of defect formation, Phys. Rev. A 92(3),
033616 (2015), doi:10.1103/PhysRevA.92.033616.
[20] P. Ehrenfest, Bemerkung uÌˆber die angenaÌˆherte GuÌˆltigkeit der klassischen Mechanik innerhalb
der Quantenmechanik, Z. Phys. 45(7-8), 455 (1927).
[21] A. S. Bradley, P. B. Blakie and C. W. Gardiner, Properties of the stochastic Grossâ€“Pitaevskii
equation: finite temperature Ehrenfest relations and the optimal plane wave representation, J.
Phys. B: At. Mol. Opt. Phys. 38(23), 4259 (2005), doi:10.1088/0953-4075/38/23/008.
[22] F. Dalfovo, S. Giorgini, L. P. Pitaevskii and S. Stringari, Theory of Bose-Einstein condensation
in trapped gases, Rev. Mod. Phys. 71(3), 463 (1999), doi:10.1103/RevModPhys.71.463.
[23] B. M. Caradoc-Davies, Vortex Dynamics in Bose-Einstein Condensates, Ph.D. thesis, University
of Otago (2000).
[24] A. Norrie, A Classical Field Treatment of Colliding Bose-Einstein Condensates, Ph.D. thesis,
University of Otago (2005).
[25] W. H. Zurek, Decoherence, chaos, quantum-classical correspondence, and the algorithmic arrow of time, Physica Scripta T76(1), 186 (1998), doi:10.1238/physica.topical.076a00186.
[26] C. W. Gardiner, Stochastic Methods, Springer, 4th edition edn. (2009).
[27] J. Pietraszewicz, E. Witkowska and P. Deuar, Continuum of classical-field ensembles in Bose
gases from canonical to grand canonical and the onset of their equivalence, Physical Review A
96(3), 033612 (2017), doi:10.1103/PhysRevA.96.033612.
[28] J. Pietraszewicz and P. Deuar, Classical fields in the one-dimensional Bose gas: Applicability and determination of the optimal cutoff, Physical Review A 98(2), 023622 (2018),
doi:10.1103/PhysRevA.98.023622.
[29] S. J. Rooney, A. S. Bradley and P. B. Blakie, Decay of a quantum vortex: Test of nonequilibrium theories for warm Bose-Einstein condensates, Phys. Rev. A 81(2), 023630 (2010),
doi:10.1103/PhysRevA.81.023630.

26

SciPost Physics

Submission

[30] S. J. Rooney, A. J. Allen, U. ZuÌˆlicke, N. P. Proukakis and A. S. Bradley, Reservoir interactions of a vortex in a trapped three-dimensional Bose-Einstein condensate 93(6), 063603 (2016),
doi:10.1103/PhysRevA.93.063603.
[31] B. Opanchuk and P. D. Drummond, Functional Wigner representation of quantum dynamics of Bose-Einstein condensate, Journal of Mathematical Physics 54(4), 042107 (2013),
doi:10.1063/1.4801781.
[32] H. T. C. Stoof,
Coherent Versus Incoherent Dynamics During Bose-Einstein Condensation in Atomic Gases,
Journal of Low Temperature Physics 114(1-2), 11 (1999),
doi:10.1023/A:1021897703053.
[33] S. P. Cockburn and N. P. Proukakis, The stochastic Gross-Pitaevskii equation and some applications, Laser Physics 19(4), 558 (2009), doi:10.1134/S1054660X09040057.
[34] S. P. Cockburn, H. E. Nistazakis, T. P. Horikis, P. G. Kevrekidis, N. P. Proukakis and D. J.
Frantzeskakis, Matter-Wave Dark Solitons: Stochastic versus Analytical Results, Physical Review Letters 104(17), 174101 (2010), doi:10.1103/PhysRevLett.104.174101.
[35] S. P. Cockburn, A. Negretti, N. P. Proukakis and C. Henkel, Comparison between microscopic methods for finite-temperature Bose gases, Physical Review A 83(4), 043619 (2011),
doi:10.1103/PhysRevA.83.043619.
[36] S. P. Cockburn, H. E. Nistazakis, T. P. Horikis, P. G Kevrekidis, N. P Proukakis and
D. J Frantzeskakis, Fluctuating and dissipative dynamics of dark solitons in quasicondensates,
Physical Review A 84(4), 043640 (2011), doi:10.1103/PhysRevA.84.043640.
[37] D. Gallucci, S. P. Cockburn and N. P. Proukakis, Phase coherence in quasicondensate experiments: An ab initio analysis via the stochastic Gross-Pitaevskii equation, Physical Review A
86(1), 013627 (2012), doi:10.1103/PhysRevA.86.013627.
[38] R. A. Duine and H. T. C. Stoof, Stochastic dynamics of a trapped Bose-Einstein condensate,
Physical Review A 65(1), 25 (2001), doi:10.1103/PhysRevA.65.013603.
[39] R. G. McDonald and A. S. Bradley, Brownian motion of a matter-wave bright soliton
moving through a thermal cloud of distinct atoms, Phys. Rev. A 93(6), 063604 (2016),
doi:10.1103/PhysRevA.93.063604.
[40] A. Kumar, S. Eckel, F. Jendrzejewski and G. K. Campbell, Temperature-induced decay of
persistent currents in a superfluid ultracold gas, Physical Review A 95(2), 021602 (2017),
doi:10.1103/PhysRevA.95.021602.
[41] M. J. Edmonds, K. L. Lee and N. P. Proukakis, Kinetic model of trapped finite-temperature binary condensates, Physical Review A 91(1), 011602 (2015), doi:10.1103/PhysRevA.91.011602.
[42] F. Jauffred, R. Onofrio and B. Sundaram, Simulating sympathetic cooling of atomic mixtures in
nonlinear traps, Physics Letters A 381(34), 2783 (2017), doi:10.1016/j.physleta.2017.06.046.
[43] Y. Liu, E. Gomez, S. Maxwell, L. Turner, E. Tiesinga and P. Lett, Number Fluctuations and
Energy Dissipation in Sodium Spinor Condensates, Physical Review Letters 102(22), 225301
(2009), doi:10.1103/PhysRevLett.102.225301.
27

SciPost Physics

Submission

[44] T. W. Neely, A. S. Bradley, E. C. Samson, S. J. Rooney, E. M. Wright, K. J. H. Law, R. CarreteroGonzaÌlez, P. G. Kevrekidis, M. J. Davis and B. P. Anderson, Characteristics of Two-Dimensional
Quantum Turbulence in a Compressible Superfluid, Phys. Rev. Lett. 111(23), 235301 (2013),
doi:10.1103/PhysRevLett.111.235301.
[45] N. Navon, A. L. Gaunt, R. P. Smith and Z. Hadzibabic, Emergence of a turbulent cascade in a
quantum gas, Nature 539(7627), 72 (2016), doi:10.1038/nature20114.
[46] G. Gauthier, M. T. Reeves, X. Yu, A. S. Bradley, M. A. Baker, T. A. Bell, H. Rubinsztein-Dunlop,
M. J. Davis and T. W. Neely, Giant vortex clusters in a two-dimensional quantum fluid, Science
364(6447), 1264 (2019), doi:10.1126/science.aat5718.
[47] S. P. Johnstone, A. J. Groszek, P. T. Starkey, C. J. Billington, T. P. Simula and K. Helmerson, Evolution of large-scale flow from turbulence in a two-dimensional superfluid, Science 364(6447),
1267 (2019), doi:10.1126/science.aat5793.

28

