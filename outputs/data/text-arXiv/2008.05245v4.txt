Covid-19 and Flattening the Curve: a Feedback Control Perspective

I. I NTRODUCTION
Defining and implementing social distancing protocols
(SD) is a significant challenge with economical, political,
and scientific considerations. The definition of a clear or
optimal goal remains unclear. As an example, consider the
direct reduction of deaths by Covid-19. Imposing this goal
requires the harshest measures possible, for an indefinite
period of time. According to the available models [1] a
monotonic relationship exists between this cost function
and the SD level. Yet, this strategy has many potential
drawbacks. First, extreme levels of lockdown are unsustainable in the long run, due to the vast range of pernicious
secondary effects (e.g. poverty [2], mental illnesses [3])
which in turn are themselves associated with a rise in
mortality. Additionally, relaxing or lifting control after a
harsh lockdown may lead to a second wave, possibly more
critical than the first one [4]. Another strategy would be
to let the epidemic spread freely (red curve in Fig. 2) to
get herd immunity as fast as possible. This is also hardly
acceptable, as it would lead to higher mortality [5], and to a
prolonged stress of the health care system. The ‚Äúflattening
the curve‚Äù strategy provides a third option, which promises
to combine the benefits of the two extremes [6], [7]. The
key idea (of which Fig. 2 provides a visual representation)
is to allow some level of disease spreading, while ensuring
that people seeking medical assistance can access the health
care system.
A vast pre-Covid-19 pandemic literature [8] on designing controllers for dealing with epidemics already exists.
However, none of these works tackled the curve flattening
1 F. Di Lauro and I.Z. Kiss are with Department of Mathematics, University of Sussex, Falmer, Brighton BN1 9QH, UK, and acknowledge support
from the Leverhulme Trust for the Research Project Grant RPG2017-370.
2 D. Rus is with the MIT Computer Science and Artificial Intelligence Laboratory, Massachusetts Institute of Technology, Cambridge, MA, USA. 3 C.
Della Santina is with the Cognitive Robotics Department, Delft University
of Technology, 2628 CD Delft, The Netherlands, and with the Institute of
Robotics and Mechatronics, German Aerospace Center (DLR), Oberpfaffenhofen, Germany. Contacts cosimodellasantina@gmail.com.

Input
Mapping

Abstract‚Äî Many of the control policies that were put into
place during the Covid-19 pandemic had a common goal: to
flatten the curve of the number of infected people so that its
peak remains under a critical threshold. This letter considers
the challenge of engineering a strategy that enforces such a goal
using control theory. We introduce a simple formulation of the
optimal flattening problem, and provide a closed form solution.
This is augmented through nonlinear closed loop tracking of
the nominal solution, with the aim of ensuring close-to-optimal
performance under uncertain conditions. A key contribution of
this paper is to provide validation of the method with extensive
and realistic simulations in a Covid-19 scenario, with particular
focus on the case of Codogno - a small city in Northern Italy
that has been among the most harshly hit by the pandemic.

Output
Mapping

arXiv:2008.05245v4 [eess.SY] 22 Oct 2020

Francesco Di Lauro1 , IstvaÃÅn ZoltaÃÅn Kiss1 , Daniela Rus2 , Cosimo Della Santina3

ƒ±, s

Low Dimensional System

Trajectory
Tracking

¬Ø, ƒ±ÃÑ, sÃÑ

Optimal
Solution

ƒ±ÃÑ(0), ƒ±th

Fig. 1. Block diagram of the strategy proposed in this paper. The input
and output maps reduce the high-dimensional dynamics of the outbreak to
a simpler evolution of few salient characteristics, namely the prevalence
of infected and susceptible ƒ±, s, which are sensible to changes in the
level of SD, modelled here as different values of the transmission rate of
infection Œ≤. A nonlinear feedback controller acts within this representation
implementing trajectory tracking of an optimal control policy.

goal, since no pandemics before threatened to overburden
the healthcare system on such a large scale. In the context
of Covid-19, open loop optimal control is proposed in [9] for
selecting the optimal timing of a time-limited lockdown, and
in [10] the authors find a trade-off between number of deaths
and damage to the economy. Yet, feed-forward strategies
are quite prone to uncertainties naturally associated with
epidemics [11]. More robust strategies have been proposed,
relying on feedback control. A linear controller is proposed
in [12]. A fast switching strategy with duty cycle selected
through a slow feedback is discussed in [13]. In [14],
the loop is closed by periodically re-planning the optimal
action, in a model-predictive-control fashion. An explicit
formulation of curve flattening is instead provided in [15],
where an open loop strategy is devised so to optimally reduce
the infectious peak. An interesting alternative is discussed
in [16], where a trade-off between the health care and the
socio-economic cost of the pandemic is proposed, and the
limited capacity level of intensive care units is imposed as
a constraint. Both these solutions are open loop.
This letter investigates the use of feedback control theory as a tool for engineering an effective curve flattening
strategy. We wish to design a simple rule that can be
implemented on a local level, without the need of accessing
specialized facilities to run complex optimization routines.
We perform extensive simulations of epidemics on networks [1], [17], with conditions inspired by real Covid-19
scenarios. This is as far as we know the first time that
such analysis is carried out for Covid-19 control related
research. We remark that the acceptable level of ‚Äúcurve
flattening‚Äù is to be decided by policy makers, based upon
cost-benefit analysis. However, once an optimal curve has

Infected Subjects

Critical Increase in Deaths
No Social
Distancing
Maximum Healthcare Capacity
Curve Flattening
Total Lockdown
Time

Fig. 2. The aim of this work is to devise a control strategy that achieves
the curve flattening goal, which should result in a curve similar to the green
one. The two alternative extreme cases are shown as comparison: the result
of no SD is shown in red, and of full lockdown in yellow.

been identified, this letter offers a novel, theoretically-backed
strategy that guarantees that the goal of controlling the
epidemic curve is achieved.
II. BACKGROUND : M ODEL OF THE E PIDEMICS WITH
DYNAMIC I NTERVENTIONS
Consider a fixed population of N individuals, and a
disease spreading among them, through direct contacts. Each
individual can be in either of three states: (i) susceptible,
meaning that they can be infected by the pathogen; (ii)
infected, meaning that they contracted the pathogen and
they can now infect other susceptible people; (iii) recovered -and therefore immune, or removed. We denote with
S(t), I(t), R(t) the number of people at time t who are
susceptible, infected or recovered, respectively. We have that
S(t) + I(t) + R(t) = N . We can therefore neglect the study
of R, as its value can always be recovered from S, I and N .
If the population is well mixed, the evolution of the disease
can be described by the SIR model
sÃá(t) = ‚àíŒ≤ƒ±(t)s(t),

ƒ±Ãá(t) = +Œ≤ƒ±(t)s(t) ‚àí Œ≥ƒ±(t),

(1)

where s(t) and ƒ±(t) are the system state, indicating respectively the number of susceptible S(t) and infectious I(t),
divided by the total population N . Note that, despite its
simplicity, the SIR model has proven able to match real data
when applied to Covid-19 [7], [15], [18], and it is therefore
widely used in the literature. Without loss of generality, we
consider that, at t = 0, s + ƒ± = 1. The constant Œ≥ ‚â• 0
defines the transition rate from the pool of infected, to the
compartment of recovered/removed. Œ≤ is the rate at which an
infected individual makes disease-transmitting contacts with
other people. When SD policies are imposed, the value of
Œ≤ varies, 0 < Œ≤min ‚â§ Œ≤ ‚â§ Œ≤max , with Œ≤min corresponding
to total lockdown. Therefore Œ≤ is the control input of (1).
III. C ONTROL S TRATEGY
We propose here a control strategy acting on system
(1). As shown by Fig. 1, this architecture is made of two
components: (i) an optimal open loop action, and (ii) a
feedback controller implementing trajectory tracking.
A. Optimal curve flattening under nominal conditions
Our aim here is to introduce a nominal strategy (‚ÄúOptimal
Solution‚Äù in Fig. 1) for optimally flattening the epidemic
curve ƒ±(t), so to keep the number of infected people ƒ±
within the maximum capacity of the health care system,
ƒ±th > 0. This can, for instance, be evaluated by considering
the percentage of people that will need Intensive Care

Units (ICUs), which are probably the most critically limited
resources. As discussed in the introduction, enforcing this
constraint is of paramount importance, since exceeding it
may provoke a critical failure of the healthcare system,
leading to a substantial increase in the number of deaths
not only from the disease, but also from uncorrelated health
issues. On the other hand, we want to keep the level of
restriction on the population as low as possible, to minimise
secondary negative effects. Note that the curve flatting goal is
the result of a careful balance between competing interests,
and as such we decide to explicitly impose it as a goal.
We consider the case of a constant Œ≤. This simplification
is instrumental in making the optimal control problem more
manageable.
We summarize the above considerations through the optimization problem
s.t. 0 < ƒ±(t) ‚â§ ƒ±th ‚àÄt and (1).

max Œ≤,
Œ≤‚ààR

(2)

We now propose a Lemma introducing a general solution to
this optimal control problem.
Lemma 1. The following is the closed form solution of (2)
Œ≤=‚àí



Œ≥
1 1 ‚àí ƒ±th
W‚àí1 ‚àí
,
1 ‚àí ƒ±th
e 1 ‚àí ƒ±(0)

(3)

where W‚àí1 is the Lambert W function [19], branch ‚àí1.
Proof. Since the cost function is linear in the optimization
parameter, the optimal value is to be found on the boundary
of the feasible set, i.e. Œ≤ has to be such that maxt ƒ±(t) = ƒ±th .
The maximum value of ƒ± is given by the non-trivial
solution of ƒ±Ãá(t) = 0. Combining this condition with the
second equation in (1) yields s+ = Œ≥/Œ≤. Further, we can
combine the first two lines of (1) into dƒ±/ds = Œ≥/(Œ≤s) ‚àí 1.
This nonlinear ordinary differential equation can be solved
together with the initial condition s(0) = 1 ‚àí ƒ±(0), ƒ±(0), to
get
ƒ±(s) =

Œ≥
ln
Œ≤



s
1 ‚àí ƒ±(0)


‚àí s + 1.

(4)

By inverting ƒ±(s+ ) for Œ≤, we get the desired optimal value
such that maxt ƒ±(t) = ƒ±th . The following is a solution for
all integer values of j,
Œ≤=‚àí

Œ≥
Wj
1 ‚àí ƒ±th


‚àí

1 1 ‚àí ƒ±th
e 1 ‚àí ƒ±(0)


,

(5)

where Wj (aÃÑ) is the j‚àíth branch of the Lambert W function
[19]. Each of the branches is built as the solution of aÃÑ =
Wj eWj . Among all of them, only W‚àí1 , W0 have domain
within the real line. Moreover, it is always the case that
W0 > W‚àí1 , which in turn assures that the larger value of Œ≤
is always reached for j = ‚àí1, concluding the proof.
It is worth noting that the argument of W‚àí1 is always
between ‚àí1/e and 0 since 0 ƒ±(0) ‚â§ ƒ±th . This is exactly the
range of arguments for which the ‚àí1 branch of the Lambert
function is well defined [19].
B. Trajectory tracking controller
The following Lemma introduces the tracking controller
(‚ÄúTrajectory Tracking‚Äù in Fig. 1) implementing the reactive

Dead

pD
IR

1

pD
Recovered

EI

2

n

EI

2

Infected

n

Exposed

2

n

Susceptible

(a) Infected ƒ±

Time

(b) Social Distancing Œ≤

Fig. 3. Two executions of the proposed control architecture when applied to
system (1). Two different choices of control gains œài and œàs are considered.
The other parameters are Œ≥ = 0.1, Œ≤max = 0.22, ƒ±ÃÑ(0) = 0.1, ƒ±th = 0.12,
ƒ±(0) = 0.14. Susceptibles are not shown for the sake of space.

change of the SD level Œ≤. Note that in principle this
controller is agnostic to the choice of the reference to be
tracked, and it is introduced as such.
Lemma 2. The feedback loop composed by the control
action
Œ≤(s, ƒ±, t) = +œài (ƒ±ÃÑ ‚àí ƒ±) ‚àí œàs (sÃÑ ‚àí s) +

sÃÑ ƒ±ÃÑ
Œ≤ÃÑ
sƒ±

(6)

and the SIR model (1), is such that (s, ƒ±) converges exponentially fast to (sÃÑ, ƒ±ÃÑ), ‚àÄœài , œàs ‚àà R, œàs > 0, œài ‚â• 0, and if
sÃÑ, ƒ±ÃÑ, Œ≤ÃÑ is a solution of (1).

Fig. 4. Pictorial representation of SEIRD dynamics on a network. The
process is a continuous-time Markov chain. Each infected (and infectious)
node spreads the disease to its susceptible neighbors at rate Œ≤n until no
longer infectious. A node that has been successfully infected, becomes first
exposed, then infectious itself. Its ultimate destiny is either dying (with
probability pD ), or fully recovering (with probability 1 ‚àí pD ). The rate of
each event is given on the continuous arrows.

controller

Œ≤(s, ƒ±, t) = œài (ƒ±ÃÑ ‚àí ƒ±) ‚àí œàs (sÃÑ ‚àí s) +

sÃÑƒ±ÃÑ
Œ≤ÃÑ
[sƒ±]‚àû


Œ≤max
,

(10)

Œ≤min

where  > 0 is a small constant, and [a]ul is is equal to l or
u if a < l or a > u respectively, and equal to a otherwise.
Fig. 3 reports two examples of application of the algorithm
to the SIR model (1).

with Œ±p > Œ≥, Œ±d > 0 being the gains of a PD-like
action. This produces the closed loop dynamics eÃà = ‚àí(Œ≥ +
Œ±d (‚àíŒ≥x ‚àí xÃá)xÃá)eÃá ‚àí Œ±p (‚àíŒ≥x ‚àí xÃá)xÃáe, where e = xÃÑ ‚àí x. By
hypothesis Œ≥ + Œ±d (‚àíŒ≥x ‚àí xÃá)xÃá > 0 and Œ±p (‚àíŒ≥x ‚àí xÃá)xÃá > 0.
Therefore, both e and eÃá converge exponentially to zero [20],
which in turn assures that (s, ƒ±) converges exponentially to
(sÃÑ, ƒ±ÃÑ). We need to show now that (6) and (9) are equivalent.
¬® = (Œ≥ xÃÑ+ xÃÑ)
Àô xÃÑ‚àíŒ≥
Àô
Àô We then take
First, we use (8) to obtain xÃÑ
xÃÑ.
œàs = Œ±p /Œ≥ and œài = Œ±d ‚àí Œ±p /Œ≥. Finally, we combine these
three equations with (7) and (9). This leads to (6), therefore
concluding the proof.

IV. N ETWORK C ONTROL
A. Network Model
We implement two important features in a refined model:
(i) people interact through heterogeneous contact structures,
i.e. the population is not well-mixed, and (ii) real epidemics
have an intrinsic degree of stochasticity, so they cannot be
exactly described by (1). We therefore consider stochastic
epidemics on networks [1], [17]. A network is a pair (V, E),
where V is a set of N nodes (or vertices), and E is a
set of edges (or links) connecting nodes, i.e. tuples {u, v},
where u, v ‚àà V . A population contact structure is modelled
by a network in which nodes represent individuals, and
links are associated with routes of disease transmission
between individuals. We consider undirected networks, such
that {u, v} ‚àà E ‚áê‚áí {v, u} ‚àà E. Figs. 1, 4, 5, show
pictorial representations of networks. Here, we focus on a
particular well-known class of random networks, i.e. ErdoÃãsReÃÅnyi [21], generated as follows: start with N isolated
nodes, consider each unique pair of two distinct nodes and
connect them with probability 0 ‚â§ p ‚â§ 1. Hence, the
probability of a node having k neighbors follows a binomial
distribution B(N ‚àí1, p), E(k) = p(N ‚àí1) being the average
degree. Such networks may be considered a very first order
approximation of realistic contact structures, as they display
sufficient heterogeneity and are easy to implement [1].

We want our control action to remain limited when acting
on a neighborhood of sƒ± = 0. Also, it is not meaningful to
act on the system by changing Œ≤ to values smaller than the
one associated with total lockdown Œ≤min > 0, or greater than
the one representing no social distancing Œ≤max > Œ≤min . We
therefore introduce the following modification on the ideal

B. Epidemic model on Network
We consider a SEIRD model for disease spreading, in
which, at any time, each node has to be in one of five states
representing its status with respect to the disease: susceptible
(S), exposed (E), infected/infectious (I), recovered (R) or
deceased (D). Fig. 4 illustrates the possible transitions of
a susceptible node that is in contact with two infectious

Proof. Consider the linear change of coordinates x = ‚àí(ƒ± +
s)/Œ≥. Adding up the two equations in (1), yields ƒ±Ãá+ sÃá = ‚àíŒ≥ƒ±.
We can therefore establish the change of coordinates
ƒ± = xÃá,

s = ‚àíŒ≥x ‚àí xÃá.

(7)

Combining the latter, with the second equations in (1) allows
writing the following equivalent formulation of the SIR
dynamics
xÃà = ‚àí(Œ≥x + xÃá)xÃáŒ≤ ‚àí Œ≥ xÃá.

(8)

We take the following control action
Œ≤(x, xÃá) = ‚àí

Œ≥ xÃÑÀô + xÃÑ¬®
+ Œ±p (xÃÑ ‚àí x) + Œ±d (xÃÑÀô ‚àí xÃá),
(Œ≥x + xÃá)xÃá

(9)

neighbors. Compared to a SIR model (see Sec. II), we add
an exposed class to account for individuals who have been
infected but are not yet infectious (biologically known as
incubation phase). We also allow for infected individuals to
either survive or die. Outbreaks are modeled as Markovian
processes on the generated network, in which a node I
infects, via links, its S neighbors at a constant rate Œ≤n ,
turning them in E. At a constant rate Œ≥E , an E node becomes
I. I nodes stop being infectious independently at a constant
rate Œ≥I , after which they have two possibilities: either they
fully recover (R), with probability 1 ‚àí pD , or they die with
probability pD (D). Nodes in state R and D play no further
role in the dynamics. Further, pD depends on the prevalence
of the disease, to model increased mortality in case of
saturation of the health care system. Control interventions
in this model are implemented as changes in the value of
Œ≤n . At time t = 0, I(0) = N ƒ±(0)  N randomly chosen
nodes are infected. The remaining ones are initialized as
susceptible. We use a Gillespie algorithm [22] adapted to
networks [1] to simulate this process. In Fig 5 we show a
realization of an outbreak on a network of modest size, to
highlight how the topology impacts the dynamics.
C. Input and Output Maps
To connect the controller to the network model, we
introduce two maps, as shown in Fig. 1. Such mappings
are general, and they could be used in conjunction with
different control techniques relying on similar input-output
description of the pandemic. The output map extracts s and
ƒ± from the full state of the network by counting as s the
fraction of nodes either S or E, and as ƒ± the fraction of
I. The input map provides expressions for the control input
on the network level Œ≤n given the output of the controller
Œ≤(s, ƒ±, t). With the aim of evaluating the input map, we turn
to the adaptation of Œ≤ to networks. From (1) we get
N ƒ±Ãá = Œ≤N ƒ±s ‚àí Œ≥N ƒ± ‚áí IÀô = Œ≤I

S
‚àí Œ≥I.
N

(11)

The term Œ≤IS/N represents the total infectious pressure in
the ODE model. This quantity drives the whole infectious
process, and it is crucial that the map preserves it. On the
network, the infectious pressure is given by the infectious
pressure Œ≤n times the number of links between infected
and susceptible nodes, which is a random variable that
depends on which nodes are infected/recovered and on the
topology of the network. Therefore, implementing an exact
mapping would require to impose a different SD level
on each individual, depending on the degree of its social
interactions. Although well defined in theory, this is clearly
not implementable in practice. To overcome this issue,
we introduce the so-called mean-field approximation [1],
[17]. On average, an infected node is connected to E [k]
neighbors, of which we assume that a proportion S/N is
susceptible. Hence, we set the number of S ‚àí I links as
E [k] IS/N . We derive Œ≤n as a simple linear function of Œ≤
Œ≤n I(t)E [k]

S(t)
Œ≤
Œ≤
' I(t)S(t) ‚áí Œ≤n '
.
N
N
E [k]

(12)

This is a valid first-order approximation, that is known to
give an upper estimate of the true S ‚àí I link count (see

Fig. 5. Simulation of a SEIRD outbreak on a ErdoÃãs-ReÃÅnyi network of
size 200, with average degree E [k] = 7. A single node at day 1 spreads
infection to its neighbors (red edges), which in turn become first exposed,
then infected, and eventually recover or die. The network is drawn in such
a way that nodes with fewer links are on the periphery. The effect of the
topology on the disease is particularly evident on such nodes, as only a few
of them gets infected compared to central ones.

[1], [17]), which in our case can only translate in a more
conservative control strategy. This expression connects a SIR
model (1) to a stochastic SIR on networks, rather than a
stochastic SEIRD, as we want. Hence, we need to add an
additional layer that conciliates Œ≥E and Œ≥I with Œ≥ in the SIR
model. To do so, we first consider the time to full recovery
(or death) of an individual who has been infected in a SEIRD
model. This is a random variable exponentially distributed
E Œ≥I
with rate Œ≥Œ≥I +Œ≥
. We set the controller Œ≥ to this value. To
E
find the infection rate, we use the definition of R0 [1] for
both models, i.e. R0 = Œ≤Œ≥ for the SIR, and R0 = Œ≥Œ≤ÃÉI for
SEIRD (we momentarily use Œ≤ÃÉ to distinguish it from the Œ≤
in the SIR), and we impose that they are equal. This yields
E
. Finally, combining this expression with (12),
Œ≤ÃÉ = Œ≤ Œ≥IŒ≥+Œ≥
E
gives Œ≤n as
Œ≤n =

Œ≤ÃÉ
Œ≤ Œ≥I + Œ≥E
=
.
E [k]
Œ≥E E [k]

(13)

V. S IMULATIONS
On top of the complexity introduced by the network
dynamics, we consider several non-ideal behaviors to better
approximate a real-world scenario. Note that none of these
effects are considered in the controller design, and therefore
are to be seen as uncertainties.
‚Ä¢ Unknown random delay affects measurements, which
changes every time the controller is executed. This
models the difficulties in getting on-line estimates of
prevalence through daily swab tests.
‚Ä¢ Policy update is allowed at a fixed rate, to mimic real
life scenarios in which policy makers are reluctant to
apply different degrees of restrictions too frequently.
‚Ä¢ Quantization of the possible levels of Œ≤. Policy makers
can realistically implement only limited control actions.
We use 5 distinct, equally spaced, levels, from Œ≤min >
0 to Œ≤n . We set Œ≤min = 0.25Œ≤. This is based on the
analysis of Italian mobility data [23].

TABLE I
PARAMETERS USED FOR SIMULATIONS IN S EC . V.
Œ≤n
Œ≥E
Œ≥I
N
Tf (days)
I0
S0
E[k]

0.0227
0.25
0.1428
16000
240
800
15200
19

Œ≤min
delay (days)
noise (signal)
Hospitalization rate
ƒ±th (%)
pD if ƒ± ‚â§ ƒ±th
pD if ƒ± ‚â§ ƒ±th
policy update (days)

0.0057
N ({3, 7, 20}, 1)
N (0, 0.1)
0.02
0.025
0.005
0.02
{1, 7, 15}

We introduce measurement noise of the signal, proportional to its value, to model uncertainty in the estimation
of the prevalence when the epidemic is out of control.
For the tuning of the model parameters we consider
the case of Codogno, which has been the first city in
Lombardy with a diagnosed case of Covid-19. We have
used Google data for the number of people in Codogno and
the hospital capacity. We considered realistic parameters for
incubation period [24], infectious period [24], hospitalization
rate [25], [26], infection fatality rate [27], and social network
connectivity [28]. All the parameters are reported in Table I.
The initial condition is set to I0 = 800, to model a delayed
recognition of the presence of the disease, and simulations
are run for Tf = 240 days.
Figs. 6 and 7 show the evolution of infected ƒ±, deaths
D/N , and prescribed SD Œ≤, for the case where policy can
change once a week and delay between testing and results
is on average 4 days. We report the results when using the
proposed feedback action Œ≤(t, s, ƒ±) and, as comparison, the
evolution of the uncontrolled epidemics (Œ≤ = Œ≤max ) and of
a one on-off intervention lasting for 60 days, during which
Œ≤ = Œ≤min . Susceptible percentages s are not shown for the
sake of space. We aggregate results from 100 simulations,
each one run on a different network realization.
We evaluate the performances of the controller in various
settings, in which we act on two main parameters, namely,
the delay in knowledge of the status and the frequency
at which the control policy can be changed. The former
one can take values of {3, 7, 20} days, while the latter
moves between {1, 7, 15} days. We consider all the possible
combinations of these parameters. We cannot report here the
complete results of our simulations, for the sake of space. We
report instead some relevant performance indexes in Fig. 8
- namely the reduction in social distancing compared to 60
days full lockdown, and reduction in deaths with respect
to not applying any strategy. We observe that the controller
performs well on average even in the most extreme cases.
Yet, we observe increased dispersion as we increase delays
and reaction times. The use of the controller consistently
induces a reduction of over 32% of deaths in the worst case,
and, in the best tested case, of 63%.
‚Ä¢

VI. D ISCUSSION
Our approach resulted in a strategy able to keep the curve
below the health care capacity when uncertainty is low, with
increased variability when delays and other inaccuracies in
measuring become important. From this analysis, it appears
clear that is crucial to have a reliable estimate of the current
prevalence of the disease. This is of course the downside
of closed loop strategies, i.e. that the controller becomes

(a) Infected ƒ±

(b) Deaths D/N
Fig. 6. Prevalence of infected and dead nodes for the considered simulation
scenario. It is shown here the case in which the policy changes only once
every week, and the average delay in measurements is set to 3 days. All
the other values are as in Tab. I.

Fig. 7. Level of SD Œ≤ as a function of time. The average output of
the controller across 100 simulations, when policy changes every 7 days
and delays in data are 3 days, is shown together with its lower and upper
quartiles (Q1-Q3). We also report for comparison a 60 days full-lockdown
strategy, and the feedforward action Œ≤ÃÑ.

less reliable as the quality of measurements deteriorates.
Instead, it is worth noting that, given low delays in data,
updating policies every 15 days has a limited impact on
the performance of the controller. Interestingly, increasing
delays (or control updates frequency), does not have a
major impact on the average performance of simulations,
in terms of reduction of mortality. However, this result
might be misleading, because the variance between different
realisations gets higher as the delay increases, meaning that
the controller becomes unreliable if applied to an individual
realisation. This suggests that the crucial quantity for control
is on-line prevalence estimation. Therefore, this analysis
confirms that, when implementing control policies based on
daily testing data, policy makers should ideally have access
to the exact state of the system. Clearly, this is far from being
a realistic assumption. Still, our results prove that periodic

0.53

0.59

0.62

20

0.53

0.62

0.65

7

15

0.34
[0.30, 0.37]

0.42
[0.38, 0.49]

0.45
[0.33, 0.56]

7

0.37
[0.33, 0.41]

0.43
[0.33, 0.52]

0.43
[0.28, 0.59]

20

0.51
[0.43, 0.59]

0.46
[0.20, 0.65]

0.43
[0.28, 0.60]

Policy update (days)

15

7

3

7

0.57

1

0.54

Delay in data (days)

0.52

1

Delay in data (days)

3

Policy update (days)

7

0.55

0.56

0.59

20

0.47

0.44

0.58

7

15

3

0.27
[0.24, 0.30]

0.30
[0.26, 0.36]

0.31
[0.20, 0.40]

7

0.29
[0.25, 0.33]

0.38
[0.29, 0.46]

0.42
[0.27, 0.58]

20

0.50
[0.40, 0.58]

0.59
[0.43, 0.73]

0.66
[0.47, 0.88]

15

0.62

7

0.59

1

0.56

Delay in data (days)

3

1

Delay in data (days)

(a) Reduction in Œ≤, for ƒ±(0) 6= ƒ±ÃÑ(0) (b) Reduction in D, for ƒ±(0) 6= ƒ±ÃÑ(0)

Policy update (days)

Policy update (days)

(c) Reduction in Œ≤, for ƒ±(0) = ƒ±ÃÑ(0) (d) Reduction in D, for ƒ±(0) = ƒ±ÃÑ(0)
Fig. 8. Heat maps reporting (a) the average reduction in Œ≤, normalised
RT
by 0 f Œ≤h (t)dt in the reference scenario, and (b) the average reduction
in deaths, normalised by the average number of deaths in the reference
scenario, across different conditions. Colors in (b) follow the width of the
fist and third percentile (reported in the cells under the average). Both the
indices are defined so that the smaller the better.

loop closure can still be a viable solution also in a more
realistic setting - although we are in no position to claim
any definitive result in this direction.
At the same time, we observe a relevant outcome in
all our simulations, namely that when control acts on an
outbreak that has already reached a significant proportion
of the population, the advisable strategy is to go into full
lockdown until the epidemic curve is brought down to
acceptable levels, and then to gradually relax and adjust
control measures, according to the estimated prevalence.
VII. C ONCLUSIONS AND F UTURE W ORK
This preliminary work showed that a simple feedback
action can improve the robustness and the effectiveness of
an optimal policy for epidemic control, even in presence
of quite non ideal behaviors in the system and in measuraments. The effectiveness of strategies based on control for
dealing with epidemics is still an open topic, with respected
academics having opposite positions [8], [29]. We do not
aim here to give a final solution to the problem. On the
contrary, we want to give our perspective to this important
discussion by providing a new piece to this intricate puzzle.
Future work will be devoted to use more reliable input maps
(and possibly theoretical models for the controller), improve
control design with robust and adaptive techniques, include
other sources of lags and uncertainties, use more realistic
network models - possibly dynamic networks, the ultimate
goal being engineering a sound model that could be useful
when it comes to decision making for governments.
R EFERENCES
[1] I. Z. Kiss, J. C. Miller, and P. L. Simon, Mathematics of Epidemics
on Networks: from exact to approximate models. Springer, 2017.

[2] A. Goolsbee and C. Syverson, ‚ÄúFear, lockdown, and diversion:
comparing drivers of pandemic economic decline 2020,‚Äù tech. rep.,
National Bureau of Economic Research, 2020.
[3] A. I. Bhuiyan et al., ‚ÄúCovid-19-related suicides in bangladesh due
to lockdown and economic factors: case study evidence from media
reports,‚Äù International Journal of Mental Health and Addiction, 2020.
[4] S. Xu and Y. Li, ‚ÄúBeware of the second wave of covid-19,‚Äù The
Lancet, vol. 395, no. 10233, pp. 1321‚Äì1322, 2020.
[5] R. Armstrong et al., ‚ÄúOutcomes from intensive care in patients with
covid-19: a systematic review and meta-analysis of observational
studies,‚Äù Anaesthesia, vol. 75, no. 10, pp. 1340‚Äì1349, 2020.
[6] N. Ferguson et al., ‚ÄúReport 9: Impact of non-pharmaceutical interventions (npis) to reduce covid19 mortality and healthcare demand,‚Äù
2020.
[7] L. Thunstrom et al., ‚ÄúThe benefits and costs of flattening the curve
for covid-19,‚Äù Available at SSRN 3561934, 2020.
[8] C. Nowzari, V. M. Preciado, and G. J. Pappas, ‚ÄúAnalysis and control
of epidemics: A survey of spreading processes on complex networks,‚Äù
IEEE Control Systems Magazine, vol. 36, no. 1, pp. 26‚Äì46, 2016.
[9] F. Di Lauro, I. Z. Kiss, and J. Miller, ‚ÄúThe timing of one-shot
interventions for epidemic control,‚Äù medRxiv, 2020.
[10] Djidjou-Demasse et al., ‚ÄúOptimal covid-19 epidemic control until
vaccine deployment,‚Äù medRxiv, 2020.
[11] F. Di Lauro et al., ‚ÄúThe impact of network properties and mixing on control measures and disease-induced herd immunity in
epidemic models: a mean-field model perspective,‚Äù arXiv preprint
arXiv:2007.06975, 2020.
[12] G. Giordano et al., ‚ÄúModelling the covid-19 epidemic and implementation of population-wide interventions in italy,‚Äù Nature Medicine,
pp. 1‚Äì6, 2020.
[13] M. Bin et al., ‚ÄúOn fast multi-shot epidemic interventions for post lockdown mitigation: Implications for simple covid-19 models,‚Äù arXiv
preprint arXiv:2003.09930, 2020.
[14] J. KoÃàhler and y. others, journal=arXiv preprint arXiv:2005.03580,
‚ÄúRobust and optimal predictive control of the covid-19 outbreak,‚Äù
[15] D. H. Morris et al., ‚ÄúOptimal, near-optimal, and robust epidemic
control,‚Äù arXiv preprint arXiv:2004.02209, 2020.
[16] A. Charpentier et al., ‚ÄúCovid-19 pandemic control: balancing detection policy and lockdown intervention under icu sustainability,‚Äù arXiv
preprint arXiv:2005.06526, 2020.
[17] Pastor-Satorras et al., ‚ÄúEpidemic processes in complex networks,‚Äù
Reviews of modern physics, vol. 87, no. 3, p. 925, 2015.
[18] C. Saad-Roy et al., ‚ÄúImmune life history, vaccination, and the dynamics of sars-cov-2 over the next 5 years,‚Äù Science, 2020.
[19] R. M. Corless et al., ‚ÄúOn the lambert w function,‚Äù Advances in
Computational mathematics, vol. 5, no. 1, pp. 329‚Äì359, 1996.
[20] D. Calzolari et al., ‚ÄúExponential convergence rates of nonlinear
mechanical systems: The 1-dof case with configuration-dependent
inertia,‚Äù IEEE Control Systems Letters, vol. 5, no. 2, pp. 445‚Äì450,
2020.
[21] B. BollobaÃÅs, Random Graphs. Cambridge Studies in Advanced
Mathematics, Cambridge University Press, 2 ed., 2001.
[22] D. T. Gillespie, ‚ÄúExact stochastic simulation of coupled chemical
reactions,‚Äù The Journal of Physical Chemistry, vol. 81, no. 25,
pp. 2340‚Äì2361, 1977.
[23] E. Pepe et al., ‚ÄúCovid-19 outbreak response, a dataset to assess
mobility changes in italy following national lockdown,‚Äù Scientific
data, vol. 7, no. 1, pp. 1‚Äì7, 2020.
[24] Y. Ling et al., ‚ÄúPersistence and clearance of viral RNA in 2019 novel
coronavirus disease rehabilitation patients,‚Äù Chinese medical journal,
vol. 133, pp. 1039‚Äì1043, may 2020.
[25] World Health Organisation, ‚ÄúMedia statement: Knowing the risks
for covid-19,‚Äù 2020. https://www.who.int/indonesia/news/detail/0803-2020-knowing-the-risk-for-covid-19.
[26] G. Grasselli, A. Pesenti, and M. Cecconi, ‚ÄúCritical Care Utilization
for the COVID-19 Outbreak in Lombardy, Italy: Early Experience and
Forecast During an Emergency Response,‚Äù JAMA, vol. 323, pp. 1545‚Äì
1546, 04 2020.
[27] G. Meyerowitz-Katz and L. Merone, ‚ÄúA systematic review and metaanalysis of published research data on COVID-19 infection-fatality
rates,‚Äù International Journal of Infectious Diseases, sep 2020.
[28] A. Melegaro et al., ‚ÄúWhat types of contacts are important for the
spread of infections? using contact survey data to explore european
mixing patterns,‚Äù Epidemics, vol. 3, no. 3, pp. 143 ‚Äì 151, 2011.
[29] F. Casella, ‚ÄúCan the covid-19 epidemic be controlled on the basis of
daily test reports,‚Äù arXiv preprint arXiv:2003.06967, 2020.

