1

Detection of Line Artefacts in Lung Ultrasound
Images of COVID-19 Patients via Non-Convex
Regularization
Oktay KarakusÃß, Member, IEEE, Nantheera Anantrasirichai, Member, IEEE, Amazigh Aguersif,
Stein Silva, Adrian Basarab, Senior Member, IEEE, Alin Achim, Senior Member, IEEE

arXiv:2005.03080v3 [eess.IV] 9 Sep 2020

Abstract
In this paper, we present a novel method for line artefacts quantification in lung ultrasound (LUS) images
of COVID-19 patients. We formulate this as a non-convex regularisation problem involving a sparsity-enforcing,
Cauchy-based penalty function, and the inverse Radon transform. We employ a simple local maxima detection
technique in the Radon transform domain, associated with known clinical definitions of line artefacts. Despite being
non-convex, the proposed technique is guaranteed to convergence through our proposed Cauchy proximal splitting
(CPS) method, and accurately identifies both horizontal and vertical line artefacts in LUS images. In order to
reduce the number of false and missed detection, our method includes a two-stage validation mechanism, which is
performed in both Radon and image domains. We evaluate the performance of the proposed method in comparison
to the current state-of-the-art B-line identification method, and show a considerable performance gain with 87%
correctly detected B-lines in LUS images of nine COVID-19 patients.
Index Terms
Lung Ultrasound, COVID-19, Line Artefacts, Radon Transform, Cauchy-based penalty.

I. I NTRODUCTION

T

HE outbreak of SARS-CoV-2 at the end of 2019 has rapidly spread to multiple countries on all continents,
within the span of just few months. As of the beginning of August 2020, there have been more than 18 million
confirmed cases globally with a death toll of more than 700 thousands people, and these numbers are continuously
growing. Current approaches to diagnose COVID-19 are based on real-time reverse-transcriptase polymerase chain
reaction, which became the gold standard for confirming the infection. However, the sensitivity of this approach is
low, and it is mainly useful at the inception of COVID-19.
Some medical imaging modalities, including Computed Tomography (CT) and X-ray, play a major role in
confirming positive COVID-19 patients, but use ionising radiation and require patient movement. On the other
hand, medical ultrasound is a technology that has advanced tremendously in recent years and is increasingly used
for lung problems that previously needed large X-ray or CT scanners. Indeed, lung ultrasound (LUS) can help in
assessing the fluid status of patients in intensive care as well as in deciding management strategies for a range of
conditions, including COVID-19 patients.
LUS can be conducted rapidly and repeatably at the bedside to help assess COVID-19 patients in intensive
care units (ICU), and in emergency settings [1]‚Äì[3]. LUS provides real-time assessment of lung status and its
dynamic interactions, which are disrupted in pathological states. In the right clinical context, LUS information can
contribute to therapeutic decisions based on more accurate and reproducible data. Additional benefits include a
reduced need for CT scans and therefore shorter delays, lower irradiation levels and cost, and above all, improved
patient management and prognosis due to innovative LUS quantitative and integrative analytical methods.
This work was supported in part by the UK Engineering and Physical Sciences Research Council (EPSRC) under grant EP/R009260/1, in
part by an EPSRC Impact Acceleration Award (IAA) from the University of Bristol, and in part by a Leverhulme Trust Research Fellowship
to Achim (INFHER).
Oktay KarakusÃß, Nantheera Anantrasirichai and Alin Achim are with the Visual Information Laboratory, University of Bristol, Bristol BS1
5DD, U.K. (e-mail: o.karakus@bristol.ac.uk; n.anantrasirichai@bristol.ac.uk; alin.achim@bristol.ac.uk)
Amazigh Aguersif and Stein Silva are with Service de ReÃÅanimation, CHU Purpan, 31300, Toulouse, France. (e-mail: amazighaguersif@gmail.com; silvastein@me.com)
Adrian Basarab is with IRIT, University of Toulouse, CNRS UMR 5505, Toulouse, France. (e-mail: adrian.basarab@irit.fr)

2

The common feature in all clinical conditions, both local to the lungs (e.g. pneumonia) and those manifesting
themselves in the lungs (e.g. kidney disease [4]), is the presence in LUS of a variety of line artefacts. These include
so-called A-,B-, and Z-lines, whose detection and quantification is of extremely significant clinical relevance.
Bilateral B-lines are commonly present in lung with interstitial oedema. Sub-pleural septal oedema is postulated to
provide a bubble-tetrahedron interface, generating a series of very closed spaced reverberations at a distance below
the resolution of ultrasound which is interpreted as a confluent vertical echo which does not fade with increasing
depth [4]‚Äì[6]. The presence or absence of B-lines in thoracic ultrasonography, as well as their type and quantity,
can be used as a marker of COVID-19 disease [1], [7]‚Äì[10]. As reported in [7] and [9], a thick and irregularly
shaped (broken) pleural line, and the existence of focal, multifocal, and/or confluent vertical B-lines are important
indicators of the stage of COVID-19, whilst A-lines become visible predominantly during the recovery phase.
A clinical limitation when using LUS is that quantification of line artefacts relies on visual estimation and thus
may not accurately reflect generalised fluid overload or the severity of conditions such as interstitial lung disease
or severe pneumonia. Moreover, currently the technique is operator-dependent and requires specialist training.
Therefore, reliable image processing techniques that improve the visibility of lines and facilitate line detection
in speckle images are essential. However, only a few automatic approaches have been reported in the literature
[4], [11]‚Äì[14]. The method in [11] employs angular features and thresholding (AFT). A B-line is detected in a
particular image column if each feature exceeds a predefined threshold. The method in [12] uses alternate sequential
filtering (ASF). A repeated sequential morphological opening and closing approach is applied to the mask until
potential B-lines are separated. In [4], an inverse problem based method has been proposed for line detection in
ultrasound images, referred to as the Pulmonary Ultrasound Image analysis method (PUI) hereafter. It involves
`p -norm regularisation, which promotes sparsity via small norm orders p > 0, and is shown to be suitable for the
detection of B-line, as well as of other line artefacts, including Z-lines and A-lines. More recently, deep learning
approaches have also been employed in order to detect and localise line artefacts in LUS [15], [16]. The method
in [15] in particular is able to detect in real-time the presence of B-lines and requires only a small amount of
annotated training images.
In this paper, we present a new LUS image analysis system based on a sophisticated non-convex regularisation
method for automatic quantification of line artefacts, and validate it on the novel coronavirus (SARS-CoV-2) induced
pneumonia. The proposed non-convex regularisation scheme, which we prefer to call Cauchy proximal splitting
(CPS) can be guaranteed to converge following [17], whilst benefiting from the advantages offered by a non-convex
penalty function. Furthermore, following reconstruction via CPS, a novel automatic line artefacts quantification
procedure is proposed, which offers an unsupervised framework for the detection of horizontal (pleural, and either
sub-pleural or A-lines), and vertical (B-lines) line artefacts in LUS measurements of several COVID-19 patients.
The performance of the proposed algorithm is compared to the state-of-the-art B-line detection method, PUI [4].
We show B-line quantification performance of 87% with a gain of around 8% over PUI [4].
The remainder of the paper is organised as follows: the clinical relationship between LUS line artefacts and
COVID-19 disease is presented in Section II. The Cauchy proximal splitting algorithm and the proposed line
artefact detection method are presented in detail in Sections III and IV, respectively. Section V presents the LUS
data sets of COVID-19 patients, whilst experimental results and discussions are presented in Section VI. Section
VII concludes the paper with remarks and future work directions.
II. L INE A RTEFACTS AND C OVID -19
A. Line Artefacts in LUS
Lung ultrasound, is a non-invasive, easy-to-perform, radiation-free, fast, cheap and highly reliable technique,
which is currently employed for objective monitoring of pulmonary congestion [18]. The technique requires
ultrasound scanning of the anterior right and left chest, from the second to the fifth intercostal space, in multiple
intercostal spaces [19]. The soft tissues of the chest wall and the aerated lung are separated by a pleural line, which
is thin, hyperechoic and curvilinear.
Due to the presence in the lung of transudates, the air content decreases and the lung density increases. When this
happens, the acoustic difference between the lung and the surrounding tissues is reduced, and the ultrasound beam
is reflected multiple times at higher depths. This phenomenon creates discrete vertical hyperechoic reverberation
artefacts (B-lines), that arise from the pleural line [21]. The presence of a few scattered B-lines can be normal,

3

B
B

Fig. 1. Lung ultrasound images (top row) and visible line artefacts overlaid on them (bottom row). There are two A-lines in the image on
the left. There are two B-lines and a single A-line in the image on the right.

and is sometimes encountered in healthy subjects, especially in the lower intercostal spaces. Multiple B-lines are
considered sonographic sign of lung interstitial syndrome, and their number increases along with decreasing air
content and increase in lung density [22]. Note that the B-lines are counted as one if they originate from the same
point on the pleural line.
A-line artefacts are repetitive horizontal echoic lines with equidistant intervals, which are also equal to the
distance between skin and pleural line [23]. The A-lines indicate sub-pleural air, which completely reflects the
ultrasound beam. The length of an A-line can be roughly the same as the pleural line, but it can also be shorter, or
even not visible because of sound beam attenuation through the lung medium. An example depicting the A- and
B-line artefacts in LUS is presented in Fig. 1.
B. Clinical Significance for COVID-19 Patients
As previously mentioned, line artefacts are highly likely to be observed during SARS-CoV-2 infection in LUS
images. Detection of such lines helps to rapidly and repeatably assess COVID-19 patients at the bedside, in ICU or
in emergency services. Due to its efficacy in diagnosing adult respiratory distress syndrome (ARDS) and pneumonia,
LUS has been extensively used to evaluate COVID-19 patients [9]. There are several important clinical findings
associated to LUS line artefacts in COVID-19 patients, such as:
‚Ä¢ A thick and irregularly shaped pleural line,
‚Ä¢ Focal, multifocal and confluent B-lines,

4

A-lines in the recovery phase.
Specifically, depending on the stage of the disease and severity of the lung injury, line artefacts with different
structures are visible in LUS for COVID-19 patients. In early stages and mild cases, focal B-lines are common. In
progressive stage and for critically ill patients, one main characteristic is the alveolar interstitial syndrome. Patients
with pulmonary fibrosis are most likely to have a thickened pleural line and uneven B-line artefacts. A-lines are
generally observed in patients during the recovery stage [9].
‚Ä¢

III. N ON - CONVEX REGULARISATION FOR L INE A RTEFACTS D ETECTION
A. Line Artefacts and the LUS Image Formation Model
The LUS image formation model involving line artefacts can be expressed as [4]
Y = CX + N

(1)

where Y is the ultrasound image, N is additive white Gaussian noise (AWGN) and C = R‚àí1 is the inverse Radon
transform operator. X(r, Œ∏) refers to lines as a distance r from the centre of Y , and an orientation Œ∏ from the
horizontal axis of Y .
In image processing applications, computing the integral of the intensities of image Y (i, j) (where i and j refer
to the pixel locations with respect to rows, and columns, respectively) over the hyperplane perpendicular to Œ∏,
corresponds to the Radon transform X(r, Œ∏) of the given image Y . It can also be defined as a projection of the
image along the angles, Œ∏. Hence, for a given image Y , the general form of the Radon transform (X = RY = C T Y )
is
Z
X(r, Œ∏) =
Y (i, j)Œ¥(r ‚àí i cos Œ∏ ‚àí j sin Œ∏)didj
(2)
R2

where Œ¥(¬∑) is the Dirac-delta function.
The inverse Radon transform (Y = CX ) of the projected image X can be obtained from the filtered backprojection [24] algorithm as
g(r, Œ∏) = F ‚àí1 [|v|F [X(r, Œ∏)]]
Z œÄZ
Y (i, j) =
g(r, Œ∏)Œ¥(r ‚àí i cos Œ∏ ‚àí j sin Œ∏)drdŒ∏
0

(3)
(4)

R

where v is the radius in Fourier transform, and F [¬∑] and F ‚àí1 [¬∑] refer to forward and inverse Fourier transforms,
respectively. In this work, discrete operators R and C are used as described in [25].
B. Non-Convex Regularisation with a Cauchy Penalty
In this section, we propose the use of the Cauchy distribution in the form of a non-convex penalty function for
the purpose of inverting the image formation model given in (1). The Cauchy distribution is one of the special
members of the Œ±-stable distribution family which is known to be heavy-tailed and to promote sparsity in various
applications [26]‚Äì[28]. It thus fits our problem of detecting a few lines in an image well. Contrary to the general
Œ±-stable family, it has a closed-form probability density function, which is given by [17]
Œ≥
p(x) ‚àù 2
(5)
Œ≥ + x2
where Œ≥ is the scale (or the dispersion) parameter, which controls the spread of the distribution.
Considering the model in (1) with the Cauchy prior given in (5), based on a Maximum A Posteriori estimation
formulation, the proposed method reconstructs X via [17]
!
kY ‚àí CXk22 X
Œ≥
XÃÇCauchy = arg min
‚àí
log
.
(6)
X
2œÉ 2
Œ≥ 2 + Xij2
i,j

5

Pl. Line
B-line

Fig. 2. Schematic view of the proposed line artefact quantification algorithm.

The function to be minimised is composed of two terms. The first is an `2 -norm data fidelity term resulting from
the AWGN assumption. The second is the non-convex Cauchy-based penalty function originally proposed in [17]:


Œ≥
.
(7)
œà(x) = ‚àí log
Œ≥ 2 + x2
In order to solve the minimisation problem in (6) by using proximal algorithms such as the forward-backward
(FB) or the alternating direction method of multipliers (ADMM), the proximal operator of the Cauchy based penalty
function should be defined. In the related recent publication [17], we proposed a closed-form expression for the
proximal operator of the Cauchy based penalty function (7)



kx ‚àí uk22
Œ≥
¬µ
proxCauchy (x) = arg min
‚àí log
.
(8)
u
2¬µ
Œ≥ 2 + u2
The solution to this minimisation problem can be obtained by taking the first derivative of (8) in terms of u and
setting it to zero. Hence we have
u3 ‚àí xu2 + (Œ≥ 2 + 2¬µ)u ‚àí xŒ≥ 2 = 0.

(9)

The solution to the cubic function given in (9) can be obtained through Cardano‚Äôs method as [17]
x2
,
3

2x3 x 2
q ‚Üê xŒ≥ 2 +
‚àí
Œ≥ + 2¬µ ,
27
3
q
p
3
s ‚Üê q/2 + p3 /27 + q 2 /4,
q
p
3
t ‚Üê q/2 ‚àí p3 /27 + q 2 /4,
x
z ‚Üê + s + t.
3
¬µ
where z is the solution to proxCauchy (x).
p ‚Üê Œ≥ 2 + 2¬µ ‚àí

(10)
(11)
(12)
(13)
(14)

6

C. Cauchy Proximal Splitting
The use of a proximal operator corresponding to the proposed penalty function would enable the use of a proximal
splitting algorithm to solve the optimisation problem in (6). In particular, an optimisation problem of the form
arg min(f1 + f2 )(x)
x

(15)

can be solved via the FB algorithm. From the definition [29], provided f2 : RN ‚Üí R is L-Lipchitz differentiable
with Lipchitz constant L and f1 : RN ‚Üí R, then (15) can be solved iteratively as


¬µ
(n+1)
(n)
(n)
x
= proxf1 x ‚àí ¬µ 5 f2 (x ) ,
(16)

where the step size ¬µ is set within the interval 0, L2 . In our case, the function f2 is the data fidelity term and
2
2
takes the form of ky‚àíCxk
from (6) whilst the function f1 corresponds to the Cauchy based penalty function œà ,
2œÉ 2
proven in [17] to be twice continuously differentiable.
Observing (6), it can be easily deduced that since the penalty function œà is non-convex, the overall cost function is
also non-convex in general. Hence, in order to avoid local minimum point estimates, one should ensure convergence
of the proximal splitting algorithm employed. To this effect, we have formulated the following theorem in [17],
which we recall here for completeness.
Theorem 1. Let the twice continuously differentiable and2 non-convex regularisation function œà be the function f1
2
and the L-Lipchitz differentiable data fidelity term ky‚àíCxk
be the function f2 . The iterative FB sub-solution to the
2œÉ 2
optimisation problem in (6) is


¬µC T (Cx(n) ‚àí y)
x(n+1) = prox¬µCauchy x(n) ‚àí
(17)
œÉ2
where 5f2 (x(n) ) =

C T (Cx(n) ‚àíy)
.
œÉ2

If the condition
‚àö

¬µ
(18)
2
holds, then the sub-solution of the FB algorithm is strictly convex, and the FB iteration in (17) converges to the
global minimum.
Œ≥‚â•

For the proof of the theorem, we refer the reader to [17]. In order to comply with the condition imposed by
the theorem, two approaches are possible: (i) the step size ¬µ can be set following estimation of Œ≥ directly from
the observations, (ii) the scale parameter Œ≥ can be set, for cases when the Lipchitz constant L is computed or
if estimating Œ≥ requires computationally
expensive
calculations. In this paper, we follow the second option, i.e.
‚àö

¬µ
(calculate L) ‚Üí (set ¬µ ‚àà 0, L2 ) ‚Üí (set Œ≥ ‚â• 2 ).
Based on Theorem 1, Algorithm 1 presents the proposed CPS algorithm for solving (6).
Algorithm 1 The CPS Algorithm
1: Input: Input image, Y and M axIter
‚àö

¬µ
2
2: Input: ¬µ ‚àà 0, L
and Œ≥ ‚â• 2
3: Output: X
4: Set: i = 0 and X (0)
5: do
6:
u(i) = X (i) ‚àí ¬µC T (CX (i) ‚àí Y )
7:
X (i+1) = prox¬µCauchy (u(i) ) from (14)
8:
i++
kX (i) ‚àí X (i‚àí1) k
9: while
> Œµ or i < M axIter
kX (i‚àí1) k

7

IV. L INE A RTEFACT Q UANTIFICATION
The proposed line artefact detection method in this paper comprises of three main stages with seven different
steps within. Figure 2 depicts the proposed algorithm, in which coloured boxes represent states: 1) Pre-processing
and non-convex regularisation (red box), 2) Detecting Line Artefacts (orange box), and 3) Validation (green box).
We discuss each stage in detail in the sequel.
A. Pre-processing and Non-convex Regularisation
The first stage of the detection method is the pre-processing and non-convex regularisation, which covers the
first three steps.
Step 1) Image sequence to Image(s): The given LUS image sequence is decomposed into image frames to be
processed. If the image sequence includes some informing text or other scanner related information, all these are
removed, so that only ultrasound can be processed by the following steps.
Step 2) Pre-processing for regularisation: A pre-processing step is then applied to each image frame before
employing the non-convex regularisation algorithm. Specifically, the pre-processing procedure includes a transformation in the image domain, which creates a ‚Äùprobe centred‚Äù image. An example of this procedure is presented
in Figure 3. An image frame extracted from an image sequence (set of frames, or video) is first considered. Then,
the probe centre of the considered image frame is located in the centre of a new template image. In Figure 3-(b)
the probe centred image corresponding to the image frame in (a) is shown. The reason behind this operation is
coming from a process we apply for detecting candidate B-lines in Radon transform domain. Note that a similar
idea has been proven to be successful in an application of ship wake detection of synthetic aperture radar imaging
of the sea surface in [30], [31]. An example for the effect of the procedure in this step in Radon space is also
shown in Figures 3-(c) and (d). As it can be clearly seen from (d), the corresponding peak points in Radon domain
(corresponding to candidate B-lines in image domain) for probe centred image are located in the middle of the
vertical Radon domain axis, whilst they cover a larger area in (c). This helps to limit the search area in Radon
domain to a smaller useful range, which increases the detection accuracy and reduces the number of false detection
because of noisy peak points in Radon domain. Although this procedure doubles the input image size, which causes
a higher computational load, this is counterbalanced by a significant increase in detection performance.
Step 3) Non-Convex regularisation: The probe centred image obtained in Step 2 is subsequently fed as the input
LUS image Y of the model in (1). Thence, the proposed non-convex regularisation with the Cauchy based penalty
function in (6) is performed to promote sparsity of the linear structures in the Radon domain. The output of the 3rd
step in the 1st stage of the algorithm consists in the reconstructed Radon space information of the linear structures,
XÃÇCauchy .
B. Detecting Line Artefacts
The second stage in the line artefact detection algorithm is the detection of all horizontal and vertical lines in
Radon domain, which includes the steps from 4 to 6 in Figure 2.
Step 4) Pre-processing for Line Detection in Radon Domain: Following on from Step 2, Radon space information
reconstructed via the CPS algorithm is then used to detect candidate horizontal (pleural, sub-pleural or A) and vertical
(B) lines. The pre-processing step consists of limiting search areas in Radon domain for both horizontal and vertical
linear structures. Note that all the detected peak points in this stage are first considered as ‚Äùcandidate lines‚Äù, since
a thresholding/validation procedure is performed in the following steps. Furthermore, all detected B-lines become
final only after the validation process performed in Step 7.
Deciding upper and lower borders for search areas has a crucial importance in the detection process. Selecting a
large value increases the searching area, which simultaneously increases not only the number of possible candidate
linear structures, but also the possibility of false detection of noisy peaks. Conversely, selecting small values may
cause lines to fall outside of the search area, leading to an increase of the number of missed detections. Hence, we
use borders of the search areas defined as:
M
,
(19)
Horizontal lines search area ‚Üí r ‚â§
4
M
B-lines search area ‚Üí r ‚â§
,
(20)
16

8

(a)

(b)

(c)

(d)

Fig. 3. A visual representation of Step 2 in the proposed line artefact detection algorithm. (a) Simulated US image. (b) Simulated ‚Äùprobe
centred‚Äù image. (c) Radon transform of (a). (d) Radon transform of (b). Dotted lines in (c) and (d) refer to search area limitation performed
in Step 4. In (c), Radon space components Œ∏ and r are also shown.

where M is the size of the probe centred LUS image Y (M √ó M ). These borders were experimentally set to lead to
the best detection results. Since the vertical lines generally start from the probe centre, the search area for vertical
lines become naturally smaller than the horizontal ones.
Step 5) Pleural (Horizontal) Line Detection: As mentioned above, the second stage of the line artefact quantification method proposed in this study addresses the identification of several linear structures, corresponding to
both horizontal lines (pleural, and either sub-pleural or A-lines) and vertical B-lines. The method first detects the
pleural line to locate the lung space where line artefacts occur. Since the pleural line is generally horizontal, we
limit the searching angle Œ∏p within the range [60‚ó¶ , 90‚ó¶ ]. Then, the horizontal search area given above is scanned
for detecting the local peaks of the reconstructed Radon information. All detected local peak points are candidate
horizontal lines. Firstly, we select the maximum intensity local peak, which is the closest to the Radon domain
vertical axis centre. The corresponding peak point is set as the detected pleural line. Following the pleural detection,
the proposed method then searches m more horizontal lines without classifying them yet as sub-pleural or A-lines.
The user defined value m refers to the number of horizontal lines (except the pleural line) to be searched. The
same detection procedure is then employed for detecting m other horizontal lines.
Step 6) B-line Detection: Following the detection of horizontal lines, the procedure for B-line identification starts
with detecting the vertical lines in the image by limiting the search angle Œ∏p within the range [‚àí60‚ó¶ , 60‚ó¶ ]. This
is done by first searching for local peaks and adopting them as candidate B-lines. At this point, there is a high
number of candidate B-lines, most of which are just local peaks not corresponding to true B-lines. Hence, in order

9

Possibly Pleural line

Possibly B-line

Possibly Sub-pleural
or
A-line

B-line searching area

Horizontal line searching area

Fig. 4. An example of Radon domain processing for Stage-2 of the proposed line artefact method.

to eliminate potential false detections, a thresholding operation is needed. Similar to [4], the proposed method uses
the following threshold procedure:
if X(rv , Œ∏v ) > hlung
2
Keep candidate point (rv , Œ∏v ),
else
Eliminate candidate point (rv , Œ∏v ).
end

(21)

where rv and Œ∏v are the detected peak coordinates in Radon space, and hlung refers to the distance between the
pleural line and the bottom of the image. Although the definition of B-lines assumes that they extend to the bottom
of the ultrasound image, in some cases this might not be true because of amplitude attenuation, which is not
compensated perfectly. Hence, selecting the threshold as hlung /2 has proven to be adequate in [4]. Following the
thresholding operation, we reduce the number of candidate B-lines and the final detected number of B-lines is
decided after the validation process in Step 7. An example of Radon domain processing for steps 4, 5 and 6 in
Stage-2 of the proposed line artefact method is shown in Figure 4.
C. Validation
The third and last stage of the line artefact quantification method is the validation, which consists of Step 7 in
Fig. 2.
Step 7) Validation: Even though we use a thresholding operation to eliminate erroneous peak detections in Radon
space, in order to reduce the number of false detection of B-lines, we perform another validation step, this time
in the image domain. Specifically, the validation of the candidate B-lines starts by calculating a measure index F ,
which is given by:
I¬Øline
F = ¬Ø
‚àí 1,
(22)
ILU S

10

where I¬Øline is the average intensity over the detected candidate B-line, and I¬ØLU S is the average image intensity. The
F index quantifies linear structures in the image domain, and results in higher values for brighter linear structures
and lower values for less visible ones, and possibly false detections. Therefore, deciding a margin will help to
reduce the possibility of false confirmations. Hence, candidate B-lines which do not follow:
F > Fval ,

(23)

are discarded, whereas the remaining B-lines are validated as the final detection results. To this end, please note
that setting a high Fval value might lead to discarding correct linear structures (missed detection), whilst a lower
Fval value might increase the number of false detections. On the other hand, since every single LUS image has
different levels of intensity, they have different I¬ØLU S values. Therefore, in order to create a fair margin, we should
take into account the average image intensity in calculating the decision criterion. Hence, the corresponding margin
is subsequently assumed to be between 25% and 50% after a trial-error procedure, according to



3¬Ø
Fval = min 0.5, max 0.25, ILU S
.
(24)
2
TABLE I
C LINICAL CHARACTERISTICS OF COVID-19

PATIENTS .

Patient
No

Sex

Age
(years)

BMI
(kg/m2)

COVID19 first
symptoms

ICU admission

LUS acquisition

1
2
3
4
5
6
7
8
9

M
M
M
M
F
F
M
M
F

68
51
77
68
58
67
61
54
79

28
26.9
25.3
24.9
34.5
36.5
23.4
32.1
40.8

15/03/2020
18/03/2020
16/03/2020
26/03/2020
03/04/2020
03/04/2020
25/03/2020
26/03/2020
08/04/2020

19/03/2020
25/03/2020
18/03/2020
01/04/2020
08/04/2020
08/04/2020
09/04/2020
07/04/2020
16/04/2020

06/04/2020
06/04/2020
06/04/2020
06/04/2020
08/04/2020
08/04/2020
09/04/2020
09/04/2020
16/04/2020

Mechanical PaO2/FiO2
(mmHg)
Ventilation
Yes
Yes
Yes
Yes
No
Yes
Yes
Yes
Yes

42
340
207
87
161
184
85
230
113

An example demonstration of the validation step is depicted in Fig. 5. From the figure, it can be clearly seen
that even though a thresholding operation is performed in Radon space in step 6 (Eq. (21)), there are still three
detected candidate B-lines, two of which are clearly false detections. However, applying the validation operation
in this step helps to discard these two false positives as illustrated in the right hand side sub-figure.
V. DATA S ET
The datasets employed in this study correspond to nine COVID-19 patients, with clinical details provided in
Table I. In particular, we examined 6 male and 3 female patients aged between 51 and 79 years old. All patients
were admitted to ICU and 8 of them required mechanical ventilation support.
All patients underwent LUS assessment by investigators who did not take part in their clinical management.
Investigators used standardised criteria and followed a pattern analysis. Lung ultrasound was performed with a
Philips CX-50 general imaging ultrasound machine (Koninklijke Philips, Amsterdam, Netherlands) and a 1- to
5-MHz bandwidth convex probe. The exploration depth was set at 13 cm. All patients were investigated in the
semirecumbent position.
The anterior chest wall was delineated from the clavicles to the diaphragm and from the sternum to the anterior
axillary lines. The lateral chest was delineated from the axillary zone to the diaphragm and from the anterior to
the posterior axillary line. Each chest wall was divided into three lung regions. The pleural line was defined as a
horizontal hyperechoic line visible 0.5 cm below the rib line. A normal pattern was defined as the presence, in every

11

Fig. 5. An example demonstrating the validation procedure in Step 7. Figure on the left refers to the detection result without validation,
whilst the right one is with the validation. The F index values for the detected B-lines from left to right are -0.235, 0.677, and 0.198,
respectively. The corresponding validation criterion Fval is 0.25 for this example.

lung region, of a lung sliding with A lines (A profile). Losses of aeration were described as B-profile. Alveolar
consolidation was defined as the presence of poorly defined, wedge-shaped hypoechoic tissue structures (C profile).
Each of the 12 lung regions examined per patient was classified in one of these profiles to define specific quadrants.
VI. R ESULTS AND D ISCUSSIONS
We consider the experimental part of this paper from two separate angles. Firstly, we evaluated the proposed line
artefacts quantification method on LUS images of several COVID-19 patients, described in details in Section V.
We also compared our method to the state-of-the-art B-line identification method PUI [4]. Secondly, we highlight
the image sequence processing capability of the proposed method for LUS measurements corresponding to five
patients.
The first example demonstrates the use of the non-convex Cauchy based penalty function and the proposed line
artefacts quantification method for 100 different LUS images of nine COVID-19 patients. The B-line detection
performance was measured using several metrics regrouped in Table II.
Table III presents the B-line quantification results for the proposed method and PUI [4] in terms of the metrics
given in Table II, based on manual detections given by two clinical doctors experts in LUS. These quantitative
results reveal that the proposed method improves B-line identification performance by 8% when compared to PUI.
Both methods had the same false detection performance whilst the missed detection performance of the proposed
method is around 8% less then PUI. The main important reason for this performance can be expressed via the
proposed validation mechanism in the proposed methodology (Step 7), which is not performed in PUI. As illustrated
in Fig. 5, our approach successfully discards non-B-line detections and reduces the percentage of missed detections
by up to 5%. Furthermore, FŒ≤ metric clearly demonstrates that the proposed method is better for three different
weighting performed for recall and precision metrics.
Figure 6 shows a receiver operating characteristic (ROC) curve, which illustrates the performances of the Bline identification methods via TPR and FPR. We considered the existence of B-lines and the non-existence of
B-lines as positive and negative classes, respectively. The ROC curve shows that the proposed method significantly
outperforms PUI. This also confirms the robust characteristics of the proposed approach since it achieves high recall
(sensitivity) and area under curve (AUC) values.
Figure 7 shows the line artefact quantification results for various frames captured for different patients. The
detected horizontal lines were drawn on the LUS images with red coloured lines, whilst vertical lines were drawn
with green (yellow for ground truth annotations) coloured lines. Each row in Figure 7 represents the original, the
expert annotated detection results, and PUI results, respectively. When examining each example LUS image along
with the detection results, we can state that for the LUS images in (a), (b), (c) and (e) the proposed method detects

12

TABLE II
D ESCRIPTIONS OF PERFORMANCE COMPARISON METRICS

Expression
True Positive (TP)
True Negative (TN)
False Positive (FP)
False Negative (FN)
Recall
Precision
Specificity
True Positive Rate (TPR)
False Positive Rate (FPR)
% Detection Accuracy
% Missed Detection
% False Detection
FŒ≤
Positive Likelihood
Ratio (LR+)

Description
Correct confirmation of B-lines.
Correct discard of invisible lines
False detection
Missed detection
TP/(TP+FN)
TP/(TP+FP)
TN/(TN + FP)
Equivalent to Recall
(1 - Specificity)
100(TP+TN)/(TP+FP+TN+FN)
100(FN)/(TP+FP+TN+FN)
100(FP)/(TP+FP+TN+FN)
(1 + Œ≤ 2 )Precision√óRecall/(Œ≤ 2 Precision + Recall)
Recall/(1-Specificity)

TABLE III
P ERFORMANCE METRICS FOR B- LINE QUANTIFICATION

Performance
Metric
% Detection Accuracy
% Missed Detection
% False Detection
Specificity
Recall
Precision
F1 Index
F2 Index
F0.5 Index
LR+
Area under curve (AUC)
The average number of B-lines
(Ground Truth) = 1.520
Average Detected B-lines
NMSE of number of
detected B-lines

The Proposed
Method

PUI
[4]

87.349%
5.422%
7.229%
7.692%
94.118%
92.308%
0.932
0.938
0.927
1.020
0.963

78.916%
13.855%
7.229%
14.286%
84.868%
91.489%
0.881
0.861
0.901
0.990
0.931

1.550

1.410

0.151

0.243

all correct B-lines and pleural lines correctly. The performance of PUI is better than the proposed method for LUS
image in (d), whilst it includes few missed detections for LUS images in (b) and (e).
Another important metric shown in Table III is the average number of detected B-lines over all the 100 LUS
images. One can observe that the proposed method‚Äôs average B-line value is closer to the correct number of average
B-lines with a normalised mean square error (NMSE) of 0.151, whilst PUI has an NMSE of 0.243. Among all
100 LUS images utilised in this study, the maximum number of B-lines in a single frame is 4 (Figure 7-(e)). The
proposed method detects all of these correctly whereas PUI achieves a maximum of 3 correctly detected B-lines
in a single frame.
Finally, we tested the merits of the proposed method in processing LUS image sequences. Specifically, we fed

13

1
The Proposed Method
PUI [4]

True positive rate

0.9
AUC = 0.931
0.8
AUC = 0.963

0.7

0.6

0.5
0

0.2

0.4

0.6

0.8

1

False positive rate
Fig. 6. Performance comparison of the B-line identification methods through a ROC curve.

the algorithm with a sequence of frames (201 frames for each sequence), the line detection method was run on
a frame by frame basis, and an image sequence was generated including the detected line artefacts. For this test,
we used 5 out of 9 patients. Specifically, for each patient, we used a single lung region measurement. An example
detection result for ten randomly selected LUS frames is given in Fig. 8 along with the expert annotated ground
truth results. When examining the results, we can clearly see that for all ten randomly selected frames, the proposed
method detects B-lines and pleural lines with 100% accuracy.
Despite being based on the optimisation of a non-convex cost function, the advantage of the proposed methodology
in processing image sequences is its guaranteed convergence, which is achieved with a reasonably low computational
cost. In Fig. 9-(a), we show the mean processing time per frame for all five image sequences we utilised in this
study. On examining Fig. 9-(a), one can clearly see that the processing time for a single frame is around 11-13
seconds. The method is implemented in Matlab R2019a on a laptop computer (Intel i7-2.7 GHz processor with 16
GB RAM). Note that the relatively long computational time could be hugely reduced following code optimization
and eventual parallelization.
Figure 9-(b) shows the mean of the detected B-lines per frame for all five patients. From this figure, one can see
that the average number of B-lines for different COVID-19 patients is generally around 1-1.5, which is correlated
with the average number of correct B-lines (1.520) over all 100 LUS images employed in the previous experiment.
VII. C ONCLUSION
Along with other medical imaging modalities, including CT and X-ray, lung ultrasound imaging has played an
ever increasing role in confirming positive COVID-19 patients. Indeed, due to its applicability at the bedside and
real time capability in assessing lungs status, LUS has quickly become a modality of choice during the SARSCoV-2 outbreak. Line artefacts in LUS provide vital information on the stage and progression of COVID-19.
Hence, automating the detection of B-lines will widen the applicability of LUS whilst reducing the need for expert
interpretation and will benefit doctors, nurses, patients and their families alike.
In this paper, we proposed a novel non-convex regularisation based line artefacts quantification method with
applications in LUS evaluation of COVID-19 patients. The proposed method poses line detection as an inverse
problem and exploits Radon space information for promoting linear structures. We utilised a non-convex Cauchybased penalty function, which guarantees convergence to global minima when using the Cauchy proximal splitting
algorithm.
Experimental results demonstrate an excellent line detection performance for 100 LUS images showing several
B-line structures, observed in nine COVID-19 patients. The performance evaluation of the proposed algorithm was

14

(a)

(b)

(c)

(d)

(e)

(f)

(g)

(h)

(i)

(j)

(k)

(l)

(m)

(n)

(o)

(p)

(q)

(r)

(s)

(t)

Fig. 7. Detection results. (a)-(e) Original Images. (f)-(j) Ground truth. (k)-(o) The proposed method. (p)-(t) PUI [4].

conducted in comparison to the state-of-the-art PUI method in [4]. Objective results demonstrate that the proposed
method outperforms PUI by around 8% in terms of B-line detection accuracy. It is also important to note that
the proposed method is completely unsupervised. On the assumption that annotated data is not available freely, an
unsupervised method such as the proposed one will always have advantages over (weakly, semi- or fully) supervised
methods.
Despite our current un-optimised Matlab implementation, the proven convergence properties of the proposed
algorithm enable the computation of a single LUS frame in around 12 seconds. This determines the processing
of LUS image sequences in a reasonable amount of time with a very good performance. Further optimisation
of our algorithms for achieving real-time performance and their implementation on mobile platforms, and further
evaluations in other acquisition settings are part of our current research endeavours.
ACKNOWLEDGMENT
The authors would like to thank Dr HeÃÅleÃÄne Vinour, Dr Sihem Bouharaoua and Dr BeÃÅatrice Riu for help with data
collection. They would also like to thank Prof. Olivier Lairez, from Toulouse University Hospital, who facilitated
the initiation of this collaborative effort.
R EFERENCES
[1] A. Thomas, G. Haljan, and A. Mitra, ‚ÄúLung ultrasound findings in a 64-year-old woman with COVID-19,‚Äù CMAJ, vol. 192, no. 15,
pp. E399‚ÄìE399, 2020.

15

Fig. 8. The proposed image sequence processing results for a single patient, for selected 10 example frames. The 1st and 3rd rows refer to
the proposed method results, whilst 2nd and 4th rows are ground truth annotated results by an expert. Specifically, from left to right at the
first two rows, frames numbers are 35, 53, 82, 87, and 110 whilst the last two rows refer to frames 121, 160, 172, 186, and 201.
2.5
Patient 1
Patient 2
Patient 3
Patient 4
Patient 5

13.5

13

12.5

12

11.5

Average detected B-lines per frame

Average processing time per frame

14

2

1.5

1
Patient 1
Patient 2
Patient 3
Patient 4
Patient 5

0.5

11
0

50

100

Frame

(a)

150

200

0

50

100

150

200

Frame

(b)

Fig. 9. Image sequence processing results. Running mean plots for (a) processing time per frame, and (b) detected number of B-lines.

[2] S. Silva, D. A. Aissa, P. Cocquet, L. Hoarau, J. Ruiz, F. Ferre, D. Rousset, M. Mora, A. Mari, O. Fourcade et al., ‚ÄúCombined thoracic
ultrasound assessment during a successful weaning trial predicts postextubation distress,‚Äù Anesthesiology: The Journal of the American
Society of Anesthesiologists, vol. 127, no. 4, pp. 666‚Äì674, 2017.
[3] B. Bataille, G. Rao, P. Cocquet, M. Mora, B. Masson, J. Ginot, S. Silva, and P.-E. Moussot, ‚ÄúAccuracy of ultrasound B-lines score
and E/Ea ratio to estimate extravascular lung water and its variations in patients with acute respiratory distress syndrome,‚Äù Journal of
clinical monitoring and computing, vol. 29, no. 1, pp. 169‚Äì176, 2015.
[4] N. Anantrasirichai, W. Hayes, M. Allinovi, D. Bull, and A. Achim, ‚ÄúLine detection as an inverse problem: application to lung ultrasound
imaging,‚Äù IEEE transactions on medical imaging, vol. 36, no. 10, pp. 2045‚Äì2056, 2017.

16

[5] C. F. Dietrich, G. Mathis, M. Blaivas, G. Volpicelli, A. Seibel, D. Wastl, N. S. Atkinson, X.-W. Cui, M. Fan, and D. Yi, ‚ÄúLung B-line
artefacts and their use,‚Äù Journal of thoracic disease, vol. 8, no. 6, p. 1356, 2016.
[6] G. Soldati, M. Demi, R. Inchingolo, A. Smargiassi, and L. Demi, ‚ÄúOn the physical basis of pulmonary sonographic interstitial syndrome,‚Äù
Journal of Ultrasound in Medicine, vol. 35, no. 10, pp. 2075‚Äì2086, 2016.
[7] G. Soldati, A. Smargiassi, R. Inchingolo, D. Buonsenso, T. Perrone, D. F. Briganti, S. Perlini, E. Torri, A. Mariani, E. E. Mossolani
et al., ‚ÄúProposal for international standardization of the use of lung ultrasound for patients with COVID-19: A simple, quantitative,
reproducible method,‚Äù Journal of Ultrasound in Medicine, 2020.
[8] D. Buonsenso, A. Piano, F. Raffaelli, N. Bonadia, K. D. G. Donati, and F. Franceschi, ‚Äúnovel coronavirus disease-19 pnemoniae: a case
report and potential applications during COVID-19 outbreak,‚Äù European review for medical and pharmacological sciences, vol. 24, pp.
2776‚Äì2780, 2020.
[9] Q.-Y. Peng, X.-T. Wang, L.-N. Zhang, C. C. C. U. S. Group et al., ‚ÄúFindings of lung ultrasonography of novel corona virus pneumonia
during the 2019‚Äì2020 epidemic,‚Äù Intensive Care Medicine, p. 1, 2020.
[10] L. Vetrugno, T. Bove, D. Orso, F. Barbariol, F. Bassi, E. Boero, G. Ferrari, and R. Kong, ‚ÄúOur Italian experience using lung
ultrasound for identification, grading and serial follow-up of severity of lung involvement for management of patients with COVID-19,‚Äù
Echocardiography, vol. 37, no. 4, pp. 625‚Äì627, 2020.
[11] L. J. Brattain, B. A. Telfer, A. S. Liteplo, and V. E. Noble, ‚ÄúAutomated b-line scoring on thoracic sonography,‚Äù Journal of Ultrasound
in Medicine, vol. 32, no. 12, pp. 2185‚Äì2190, 2013.
[12] R. Moshavegh, K. L. Hansen, H. M. S√∏rensen, M. C. Hemmsen, C. Ewertsen, M. B. Nielsen, and J. A. Jensen, ‚ÄúNovel automatic
detection of pleura and B-lines (comet-tail artifacts) on in vivo lung ultrasound scans,‚Äù in Medical Imaging 2016: Ultrasonic Imaging
and Tomography, vol. 9790. International Society for Optics and Photonics, 2016, p. 97900K.
[13] W. F. Weitzel, J. Hamilton, X. Wang, J. L. Bull, A. Vollmer, A. Bowman, J. Rubin, G. H. Kruger, J. Gao, M. Heung et al., ‚ÄúQuantitative
lung ultrasound comet measurement: method and initial clinical results,‚Äù Blood purification, vol. 39, no. 1-3, pp. 37‚Äì44, 2015.
[14] R. Moshavegh, K. L. Hansen, H. M√∏ller-S√∏rensen, M. B. Nielsen, and J. A. Jensen, ‚ÄúAutomatic detection of B-Lines in invivo lung
ultrasound,‚Äù IEEE transactions on ultrasonics, ferroelectrics, and frequency control, vol. 66, no. 2, pp. 309‚Äì317, 2018.
[15] R. J. van Sloun and L. Demi, ‚ÄúLocalizing B-lines in lung ultrasonography by weakly-supervised deep learning, in-vivo results,‚Äù IEEE
Journal of Biomedical and Health Informatics, 2019.
[16] X. Wang, J. S. Burzynski, J. Hamilton, P. S. Rao, W. F. Weitzel, and J. L. Bull, ‚ÄúQuantifying lung ultrasound comets with a convolutional
neural network: Initial clinical results,‚Äù Computers in biology and medicine, vol. 107, pp. 39‚Äì46, 2019.
[17] O. KarakusÃß, P. Mayo, and A. Achim, ‚ÄúConvergence guarantees for non-convex optimisation with Cauchy-based penalties,‚Äù arXiv preprint
arXiv:2003.04798, 2020.
[18] R. A. Sherman, ‚ÄúCrackles and comets: Lung ultrasound to detect pulmonary congestion in patients on dialysis is coming of age,‚Äù 2016.
[19] Z. Jambrik, S. Monti, V. Coppola, E. Agricola, G. Mottola, M. Miniati, and E. Picano, ‚ÄúUsefulness of ultrasound lung comets as a
nonradiologic sign of extravascular lung water,‚Äù The American journal of cardiology, vol. 93, no. 10, pp. 1265‚Äì1270, 2004.
[20] F. Mallamaci, F. A. Benedetto, R. Tripepi, S. Rastelli, P. Castellino, G. Tripepi, E. Picano, and C. Zoccali, ‚ÄúDetection of pulmonary
congestion by chest ultrasound in dialysis patients,‚Äù JACC: Cardiovascular Imaging, vol. 3, no. 6, pp. 586‚Äì594, 2010.
[21] L. Gargani and G. Volpicelli, ‚ÄúHow I do it: lung ultrasound,‚Äù Cardiovascular ultrasound, vol. 12, no. 1, p. 25, 2014.
[22] M. Trezzi, D. Torzillo, E. Ceriani, G. Costantino, S. Caruso, P. T. Damavandi, A. Genderini, M. Cicardi, N. Montano, and C. Cogliati,
‚ÄúLung ultrasonography for the assessment of rapid extravascular water variation: evidence from hemodialysis patients,‚Äù Internal and
emergency medicine, vol. 8, no. 5, pp. 409‚Äì415, 2013.
[23] D. A. Lichtenstein, G. A. MezieÃÄre, J.-F. Lagoueyte, P. Biderman, I. Goldstein, and A. Gepner, ‚ÄúA-lines and B-lines: lung ultrasound
as a bedside tool for predicting pulmonary artery occlusion pressure in the critically ill,‚Äù Chest, vol. 136, no. 4, pp. 1014‚Äì1020, 2009.
[24] A. C. Kak and M. Slaney, Principles of computerized tomographic imaging. IEEE press New York, 1988.
[25] B. T. Kelley and V. K. Madisetti, ‚ÄúThe fast discrete Radon transform. I. Theory,‚Äù IEEE Transactions on Image Processing, vol. 2,
no. 3, pp. 382‚Äì400, 1993.
[26] T. Wan, N. Canagarajah, and A. Achim, ‚ÄúSegmentation of noisy colour images using Cauchy distribution in the complex wavelet
domain,‚Äù IET Image Processing, vol. 5, no. 2, pp. 159‚Äì170, 2011.
[27] T. Yang, O. KarakusÃß, and A. Achim, ‚ÄúDetection of ship wakes in SAR imagery using Cauchy regularisation,‚Äù arXiv preprint
arXiv:2002.04744, 2020.
[28] O. KarakusÃß and A. Achim, ‚ÄúOn solving SAR imaging inverse problems using non-convex regularisation with a Cauchy-based penalty,‚Äù
arXiv preprint arXiv:2005.00657, 2020.
[29] P. L. Combettes and J.-C. Pesquet, ‚ÄúProximal splitting methods in signal processing,‚Äù in Fixed-point algorithms for inverse problems
in science and engineering. Springer, 2011, pp. 185‚Äì212.
[30] O. KarakusÃß, I. Rizaev, and A. Achim, ‚ÄúShip wake detection in SAR images via sparse regularization,‚Äù IEEE Transactions on Geoscience
and Remote Sensing, vol. 58, no. 3, pp. 1665‚Äì1677, March 2020, 10.1109/TGRS.2019.2947360.
[31] M. D. Graziano, M. D‚ÄôErrico, and G. Rufino, ‚ÄúWake component detection in X-band SAR images for ship heading and velocity
estimation,‚Äù Remote Sensing, vol. 8, no. 6, p. 498, 2016.
[32] O. Karakus and O. Achim. QuantLUS - CPS v1.0. [Online]. Available: https://doi.org/10.5523/bris.z47pfkwqivfj2d0qhyq7v3u1i

