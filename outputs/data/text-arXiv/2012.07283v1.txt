arXiv:2012.07283v1 [cs.LG] 14 Dec 2020

Towards Accurate Spatiotemporal COVID-19 Risk Scores
using High Resolution Real-World Mobility Data
SIRISHA RAMBHATLAâˆ— , SEPANTA ZEIGHAMIâˆ— , KAMERON SHAHABI, CYRUS SHAHABI,
and YAN LIU, University of Southern California, USA
As countries look towards re-opening of economic activities amidst the ongoing COVID-19 pandemic, ensuring
public health has been challenging. While contact tracing only aims to track past activities of infected users,
one path to safe reopening is to develop reliable spatiotemporal risk scores to indicate the propensity of
the disease. Existing works which aim to develop risk scores either rely on compartmental model-based
reproduction numbers (which assume uniform population mixing) or develop coarse-grain spatial scores
based on reproduction number (R0) and macro-level density-based mobility statistics. Instead, in this paper,
we develop a Hawkes process-based technique to assign relatively fine-grain spatial and temporal risk scores
by leveraging high-resolution mobility data based on cell-phone originated location signals. While COVID-19
risk scores also depend on a number of factors specific to an individual, including demography and existing
medical conditions, the primary mode of disease transmission is via physical proximity and contact. Therefore,
we focus on developing risk scores based on location density and mobility behaviour. We demonstrate the
efficacy of the developed risk scores via simulation based on real-world mobility data. Our results show that
fine-grain spatiotemporal risk scores based on high-resolution mobility data can provide useful insights and
facilitate safe re-opening.
CCS Concepts: â€¢ Information systems â†’ Spatial-temporal systems; â€¢ Computing methodologies â†’
Modeling and simulation.
Additional Key Words and Phrases: COVID-19, Spatiotemporal Risk Scores, Mobility Data, Disease Spread
Simulation
ACM Reference Format:
Sirisha Rambhatla, Sepanta Zeighami, Kameron Shahabi, Cyrus Shahabi, and Yan Liu. 2020. Towards Accurate
Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data. 1, 1 (December 2020),
27 pages. https://doi.org/10.1145/nnnnnnn.nnnnnnn

1 INTRODUCTION
As the Coronavirus Disease, COVID-19, becomes a long-term challenge in our day-to-day lives,
planning and learning effective ways to navigate the disease has become critical. In the earlier
phases of the disease when there were relatively small number of cases, contact tracing â€“ identifying
people who may have come into contact with an infected individual â€“ served as an effective tool to
mitigate disease spread [25]. However, as the number of cases reach record levels, and a general
sense of pandemic fatigue sets in, it has become important to develop practical tools for navigating
the disease safely to resume normal activities [15, 42, 43].
COVID-19 transmits through contacts between individuals. It spreads in a population due to
infected people moving and co-locating with people susceptible to the disease [33]. For such
susceptible individuals, infection risk boils down to going to locations with high probability of
co-locating with infected individuals [18]. Thus, one approach towards allowing safe resumption of
âˆ— Both

authors contributed equally to this research.

Authorsâ€™ address: Sirisha Rambhatla, sirishar@usc.edu; Sepanta Zeighami, zeighami@usc.edu; Kameron Shahabi, kyshahab@
usc.edu; Cyrus Shahabi, shahabi@usc.edu; Yan Liu, yanliu.cs@usc.edu, University of Southern California, 941 Bloom Walk,
Los Angeles, California, USA, 90089.
2020. XXXX-XXXX/2020/12-ART $15.00
https://doi.org/10.1145/nnnnnnn.nnnnnnn

2

Rambhatla and Zeighami, et al.

normal activities is assigning risk scores for different regions to show the danger in each area. This
can be used both for policy making at the government level as well as individual decision making
(e.g., to avoid high-risk areas). To this end, the risk-scores provided need to be (1) spatiotemporally
fine-grained, (2) reliable, and (3) accurately evaluated.
Fine-Grained Risk-Scores using mobility patterns. Coarse-grain risk scores and reproduction number estimates at county or state level are not readily usable for public policy decisions at
finer spatial and temporal scales [6, 23]. Analogous to traffic congestion prediction for transportation applications (e.g., car navigation) where high-resolution information such as average speed at
a specific freeway segment at a particular time is critical to avoid potential congested routes, risk
scores need to be local to an area to influence decision making [28]. In other words, coarse-grain
risk scores are akin to reporting average speed of cars for an entire city, which provides no useful
information for both individual and policy-making plans. Nevertheless, such information becomes
increasingly useful with finer granularity, both spatially and temporally. This improvement in
spatiotemporal resolution has also led to recent advances in traffic prediction [32].
Motivated from this insight, we focus on developing finer-grain spatiotemporal risk scores
leveraging the real-world mobility patterns from one area in a city to another. Recent works which
primarily focus on disease forecasting, consider coarse-grain mobility densities (at county-level)
[9], or densities at certain point-of-interests within a city [7], potentially due to lack of access to
fine-grained data. In this work, we leverage actual mobility â€“ as opposed to relying on popularity
of an area (density) â€“ using Origin-Destination (OD) mobility graphs [3].
In contrast to traffic flow forecasting where the aim is to predict future traffic flow from the
current flow, predicting risk score has an additional challenge of forecasting infections from the
current spatial density and mobility behavior. That is, rather than predicting future mobility as is
done for traffic forecasting, model needs to predict the future chance of infection that relies on both
mobility behavior and rate of infection. To this end, we leverage a Hawkes process-based modelling
procedure to predict future infections based on mobility patterns. Here, the Hawkes process-based
modelling, which is extensively used to model event-based infection spread, provides a flexible way
to incorporate the mobility data while allowing for explicit modelling of disease transmission [9].
In addition to the mobility-based model which leverages high-resolution location densities, we also
develop a variant of our model which utilizes the mobility of infections from one region to another,
i.e. infection mobility to aid infection and risk predictions. We show that use of high-resolution
mobility patterns along with infection mobility leads to improved infection and risk prediction.
Reliable Risk Scores. Popular disease prediction models employ compartmental modelling
based on the classical Susceptible-Infected-Removed (SIR) model [26] to explicitly model disease
transmission. Although popular in practice due to their simplicity, these models rely on the homogeneous population mixing (i.e., each person has equal probability of coming into contact with
another individual) to learn the model parameters, and thus leading to coarse-grain reproduction
number (R0) estimates [4, 24, 36, 38, 46]. Nevertheless these are useful when finer-grain data is
not available, and recent works leverage time-varying models to develop dynamic reproduction
number for relatively finer scales, assuming homogeneous mixing [28].
One way to relax the homogeneous mixing assumption is to employ self-excitation-based Hawkes
point process models [14, 34] which are mathematically related to the compartmental models [39].
To this end, a recent work [9] leverages the flexibility of the Hawkes process models to incorporate
the demographic and mobility density indices for COVID-19 prediction. As a result, existing models
either a) do not incorporate high-resolution mobility data [9], or b) use compartmental models
which assume homogeneous mixing [28]. In this work, we show that incorporating high-resolution
mobility data along with Hawkes process-based modeling leads to more reliable fine-grained risk
scores.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

3

Accurately Evaluating the Risk Scores. Another challenge in research on accurately modeling
the spread of the disease is not having access to reliable fine-grain infection statistics. This is due to
inaccurately reporting the number of infection in the real-world as not everyone who gets infected
is tested for the virus [41]. To address this, existing work either a) ignore this issue and use the
reported number of infections as ground truth [4, 9, 28, 36] or try to circumvent it by b) using the
number of deaths to study the spread of the disease [9]. In the former case, judging the accuracy of
the model becomes difficult as it is not tested on the ground truth. In the latter case, the model will
not be able to model how infections occur, but rather it only models number of deaths. Furthermore,
fine-grained statistic for infection location is not publicly available. That is, at best we can know
number of infections per county using public sources, which makes it difficult to assign risk scores
to different locations (e.g., a zipcode or shopping center) within it.
To summarize, there are three main limitations with existing methods a) they assume homogeneous mixing of population i.e., do not incorporate mobility information, and/or b) assign
coarse-grain scores (at county level at best) and c) they are difficult to evaluate. As a result, there is
a need to build a technique to assign COVID-19 risk scores which is a) informative (fine-grain and
time-varying), b) reliable (considers in-homogeneous mixing) and c) accurately evaluated.
1.1

Our Approach

To address these challenges, we develop a Hawkes process-based spatiotemporal risk measure,
dubbed LocationRisk@T, which utilizes the high-resolution mobility patterns in a city available via
cell-phone location signals [2] (a location signal is a record containing the location of the device at
a particular point in time). We specifically show that such fine-grained mobility information can be
used to assign risk scores that closely track the future infections in a region. We corroborate the
efficacy of LocationRisk@T by showing its ability to track infections on simulated disease spread
on real-world mobility for months of December 2019, January and March 2020.
In particular, to evaluate LocationRisk@T, we use an agent-based simulation to compute the
ground-truth number of infections. Our simulation, called SpreadSim, uses location signals from
large number of cell-phones across the US. SpreadSim simulates how the disease spreads across the
population by utilizing this real-world high-resolution mobility patterns. Since SpreadSim utilizes
the real-world data of peopleâ€™s movement, it can generate infection patterns for the population
that are closer to the real-world. Furthermore, since the infection are generated by the simulation,
we have access to the ground truth number of infections which allows for accurate evaluation of
LocationRisk@T.
Overall, our disease transmission simulation uses real-world mobility patterns and co-locations
to emulate the spread of disease in real-world. Our point-process-based prediction model then
leverages the mobility patterns to forecast future infections, the resulting intensity function of the
Hawkes process-based model yields the risk score. Our main contributions are as follows.
â€¢ SpreadSim: A Disease Spread Simulation Using Real-World Location Signals. We
build a co-location-based disease spread model using real-world location signals. SpreadSim
emulates the disease transmission process in the real-world to generate infection patterns,
and can be of independent interest for analysis of disease spread and intervention policies.
â€¢ LocationRisk@T: High-resolution Spatiotemporal Risk Scores. As opposed to previous works which utilize coarse-grain location density indices, we first develop a mobilityaware Hawkes process-based model â€“ LocationRisk@Tğ‘€ğ‘œğ‘ â€“ which leverages the highresolution mobility patterns between different regions of a city to predict infections and
assign spatiotemporal risk scores. Subsequently, we develop LocationRisk@Tğ‘€ğ‘œğ‘ + , which

4

Rambhatla and Zeighami, et al.

also accounts for the movement of infected population to improve the performance of the
model.
â€¢ Analyze the disease spread patterns. We leverage SpreadSim and LocationRisk@T to
analyze the differences in disease spread at different conditions of real-world mobility rates,
namely, before and after the March 2020 lockdown. Our results on cities across United States
demonstrate that high-resolution mobility data can be used as a reliable public health tool to
assess potential risk associated with parts of a city over time.
One possible application of LocationRisk@T risk score is to use it to reduce foot traffic to areas
of high risk during the time the predicted risk score is high. Furthermore, since LocationRisk@T
risk score leverages region-specific aggregate mobility patterns, it preserves privacy of device
owners. In other words, although our SpreadSim, for evaluation purposes, utilizes individual-level
co-locations, our LocationRisk@T risk prediction model can be used to assign risk scores while
keeping the user data private.
1.2

Overview and Organization

Our approach can be summarized as follows.
First, our agent-base simulation, SpreadSim, uses real-world location signals to generate infection
patterns. Specifically, SpreadSim takes as input location trajectories of a number of individuals, as
well as parameters that control how the disease spreads between the individuals to simulate how
the infection progresses in the population over time. Finally, it outputs a list of infected individuals
during the simulation together with the time and location they became infected. The details of
SpreadSim are discussed in Sec. 2.
Second, our LocationRisk@T takes as input the infection statistics (aggregate data, not individualsâ€™
locations or co-locations) that were generated from the simulation. It uses the statistics for the first
ğ‘› days of the simulation, for a parameter ğ‘›, to learn a model that is able to accurately predict number
of infections for different locations, as well as provide a risk score for each location. Infection
statistics from day ğ‘› until the end of the simulation are used to evaluate the learned model. The
details of LocationRisk@T are discussed in Sec. 3.
The rest of the paper is organized as follows. In Sec. 4, we present the results of the analysis
over different months for different cities across the United States. We also discuss related works in
context of the proposed technique in Sec. 5, and conclude our discussion in Sec. 6.
2

SPREADSIM

Our agent-based simulation, SpreadSim, uses real-world mobility data and parameters from the
existing literature on how COVID-19 spreads in a population to generate realistic infection patterns
in the population. SpreadSim consists of a set of agents, collectively referred to as the population.
Some agents are initially infected. Each agent moves and co-locates with other agents based on
real-world fine-grain mobility data provided by Veraset [2]. As the agents move based on the
location signal data (described in Sec. 2.1), according to their co-locations, they get infected and
spread the disease following a variation of the SIR model and using incubation and generation
periods of COVID-19 reported in the literature. The output of SpreadSim is the information on
which agents get infected, when and where. Thus, SpreadSim is comprised of three components.
(1) The location of each agent at each point in time is determined by a predefined mobility pattern.
(2) The spread of the disease amongst the agents is determined by a transmission model. (3) Who
is initially infected is determined by the initialization conditions. We next discuss each of the
components and the relevant implementation details.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

5

Fig. 1. No. of location signals per Day in Manhat- Fig. 2. Distribution of location signals in Manhattan in Dec
2019.
tan in Dec 2019.

2.1

Mobility Pattern

The mobility pattern determines where each agent is at each point in time during the simulation.
We use real-world location signals provided by Veraset [2]. Veraset [2] is a data-as-a-service
company that provides anonymized population movement data collected through GPS signals of
cell-phones across the US. We were provided access to this dataset for the months of December,
January and (from 5th to 26th of) March. For a single day in December, there are 2,630,669,304
location signals across the US. Each location signal corresponds to a device_id and there are
28,264,106 device_ids across the US in that day. We assume each device_id corresponds to a
unique individual . Fig. 1 shows the number of daily location signals recorded in the month of Dec.
2019 in the area of Manhattan, New York. Furthermore, Fig. 2 shows the distribution of location
signals across individuals in Manhattan in Dec 2019. A point (ğ‘¥, ğ‘¦) in Fig. 2 means that ğ‘¥ percent
of the individuals have at least ğ‘¦ location signals in the month of Dec. in Manhattan. Using this
real-world location data, we are able to create infection patterns for different cities and at different
periods of time. This allows us to study the hypotheses that concern the spread of the disease for
different cities and at different times.
Detailed statistics about the subset of the Veraset data we used for our experiments are discussed
in Sec. 4. Here, we discuss our general approach of using real-world location signals for SpreadSim,
independently of the actual dataset used. We consider a dataset such that each record in the dataset
consists of an anonymized user_id, latitude, longitude and timestamp and is a location signal
of the user with id user_id at the specified time and location. We consider each individual to be
an agent in the simulation and for each agent, we have access to their latitude and longitude for
various timestamps. Sorting this by time, we obtain a trajectory of location signals of an agent over
time, denoted by the sequence âŸ¨ğ‘ 1, ğ‘ 2, ..., ğ‘ğ‘˜ âŸ©. For two consecutive location signals, ğ‘ğ‘– and ğ‘ğ‘–+1 of an
agent at times ğ‘¡ğ‘– and ğ‘¡ğ‘–+1 , we assume the agent is at the location specified by ğ‘ğ‘– from time ğ‘¡ğ‘– to ğ‘¡ğ‘–+1 .
Using this interpolation, together with our location data, we have access to the location of every
agent at every point in time during the simulation. We note that, although more sophisticated
interpolations are possible, this falls beyond the scope of this paper, since our focus is on providing
risk scores for different locations.
2.2

Transmission Model

Agents belong to either one of the following compartments: Susceptible (S), Infected and Not
Spreading (INS), Infected and Spreading (IS) and Isolated or Recovered (R). An agent is said to be
infected if they are in either INS or IS compartments. Intuitively, a susceptible agent can contract
the disease, an INS agent is infected but cannot spread the disease, an IS agent is infected and can

6

Rambhatla and Zeighami, et al.

x

ma

Fig. 3. Transmission Model

Fig. 4. Transmission of disease through a co-location.
Arrows show movement in time.

spread the disease and an Isolated or Recovered agent cannot spread the disease or contract it
anymore. Figs. 3 and 4 illustrate the transmission model.
2.2.1 Compartments. All agents are initially Susceptible, with the exception of the agents that are
infected initially as discussed in Sec. 2.3.1. We call the compartment an agent is in the agentâ€™s status.
Assume an agent gets infected at time ğ‘¡ based on the dynamics discussed in Sec. 2.2.2. Thus, at
time ğ‘¡, the agent changes its status from Susceptible to Infected and Not Spreading. Consequently,
at time ğ‘¡ + ğ‘¡ğ¼ğ‘† , the agent becomes Infected and Spreading. Furthermore, at time ğ‘¡ + ğ‘¡ğ‘… , the agent
becomes Isolated or Recovered, where ğ‘¡ğ¼ğ‘† âˆ¼ N (ğœ‡ğ¼ğ‘† , ğœğ¼ğ‘† ) and ğ‘¡ğ‘… âˆ¼ N (ğœ‡ğ‘… , ğœğ‘… ), where ğœ‡ğ¼ğ‘† , ğœğ¼ğ‘† , ğœ‡ğ‘…
and ğœğ‘… are the parameters of the model. These parameters can be set based on existing research on
COVID-19 [17, 21, 31]. For instance, [21] mentions that â€œ 1% of transmission would occur before 5
days and 9% of transmission would occur before 3 days prior to symptom onsetâ€, while [31] finds
that incubation period (time from infection until onset of symptoms) has mean 5.2 days. Using this,
we can find the parameter for the model that match the empirical evidence the best. We discuss the
specific parameter setting used in our experiments in Sec. 4. We note that, first, N (Â·) is a truncated
normal distribution, such that if the sampled ğ‘¡ğ¼ğ‘† or ğ‘¡ğ‘… are less than zero, they are discarded and a
new sample is obtained. Furthermore, if ğ‘¡ğ‘… < ğ‘¡ğ¼ğ‘† , the agent never spreads the disease, and moves
directly from INS to the R compartment (the probability of either of these happening is very low
based on the parameter setting chosen).
2.2.2 Transmission Dynamics. Only IS agents infect other agents, and only S agents get infected.
Simply put, if an IS agent is within distance ğ‘‘ğ‘šğ‘ğ‘¥ of an S agent for duration at least ğ‘¡ğ‘šğ‘–ğ‘› then,
with probability ğ‘, the IS agent infects the S agent. ğ‘‘ğ‘šğ‘ğ‘¥ , ğ‘¡ğ‘šğ‘–ğ‘› and ğ‘ are the parameters of the
transmission model. The model is designed to mimic how the disease spreads in the physical world,
following the works of [5, 10, 44], where prolonged close-range contacts is the main source of
transmission of the disease. Specifically, consider an IS agent, ğ‘¢, and an S agent ğ‘£. At any time, ğ‘¡,
during the simulation, consider the situation when the distance between ğ‘¢ and ğ‘£ becomes at most
ğ‘‘ğ‘šğ‘ğ‘¥ (i.e., distance between ğ‘¢ and ğ‘£ was larger than ğ‘‘ğ‘šğ‘ğ‘¥ right before time ğ‘¡) from time ğ‘¡ until
time at least ğ‘¡ + ğ‘¡ğ‘šğ‘–ğ‘› . Then, a number, uniformly at random, is generated in the range [0, 1]. If the
number is at most ğ‘, then ğ‘¢ infects ğ‘£. When ğ‘£ becomes infected, as explained in Sec. 2.2.1, its status
changes from S to INS, and eventually to IS and R.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

2.3

7

Initialization and Implementation

2.3.1 Initialization. . For a parameter ğ‘›ğ‘–ğ‘›ğ‘–ğ‘¡ , we infect ğ‘›ğ‘–ğ‘›ğ‘–ğ‘¡ number of agents at the beginning of
the simulation uniformly at random. The initial infections are treated as if the agent was infected
by another agent. That is, an initially infected agent has initially the INS status and becomes IS
after time ğ‘¡ğ¼ğ‘† and recovered after ğ‘¡ğ‘… , where ğ‘¡ğ¼ğ‘† and ğ‘¡ğ‘… are sampled from the normal distributions
discussed before.
2.3.2 Implementation. Our implementation SpreadSim first sorts all the location signals based on
time. Subsequently, location signals are processed one by one in the order of time. Every location
signal corresponds to an agent moving from an old location to a new location. As such, if the agent
is susceptible, we check if there are any IS agents within ğ‘‘ğ‘šğ‘ğ‘¥ of the new location. If the agent
is IS, we check if there are any S agents within its ğ‘‘ğ‘šğ‘ğ‘¥ . We call it a co-location if an two agents
are within ğ‘‘ğ‘šğ‘ğ‘¥ distance of each other. Next, for any co-location between an S agent ğ‘¢ and an IS
agent ğ‘£, we check if it lasts for at least ğ‘¡ğ‘šğ‘–ğ‘› . If it does, then, with probability ğ‘, we infect ğ‘¢. We
use a grid to index the location of the agents. Given a new location signal at a new location, (ğ‘¥, ğ‘¦),
we perform a range search on the grid to find agents within ğ‘‘ğ‘šğ‘ğ‘¥ of (ğ‘¥, ğ‘¦). For each agent that
matches the range search predicate, we then check if their co-location lasts for at least ğ‘¡ğ‘šğ‘–ğ‘› . This
can be optimized further by building a multidimensional index on both time and location.
3

LEARNING SPATIOTEMPORAL RISK SCORES WITH LOCATIONRISK@T

We now describe our Hawkes process model, LocationRisk@T, which leverages location data along
with mobility patterns in a particular region to assign spatiotemporal risk scores. For a given city,
we first form clusters ğ‘ âˆˆ C using ğ‘˜-means clustering algorithm based on location signals in the
city. The number of such clusters can be chosen according to the desired spatial resolution 1 .
3.1

Mobility-aware Modelling

LocationRisk@T leverages the Origin-Destination (OD) matrix to represent the flow between two
clusters ğ‘ and ğ‘ â€² in a city. OD matrices are a popular way to encode spatial traffic flow information
between two nodes in a transportation graph [3]. Specifically, let Gğ‘¡ (ğ‘‰ , ğ¸) denote a directed graph,
where the edge weight ğ‘¤ğ‘–â†’ğ‘— (ğ‘¡) encodes the traffic volume from cluster ğ‘– to ğ‘— between time (ğ‘¡ âˆ’ 1)
and ğ‘¡. The OD matrix ğ‘Š (ğ‘¡) âˆˆ R | C |Ã— | C | represents the traffic flows between different clusters ğ‘ âˆˆ C
in a city at time ğ‘¡. Here, the diagonal elements ğ‘¤ğ‘–â†’ğ‘– (ğ‘¡) denote the traffic generated in a cluster ğ‘–.
We use this traffic flow information to inform LocationRisk@T.
We form the the mobility feature vector at time ğ‘¡, ğ’ğ‘¡Gğ‘ âˆˆ R ğ‘“ , elements of which encode the
different mobility features derived from the OD matrix ğ‘Š . Here, we develop two Hawkes processbased models a) LocationRisk@Tğ‘€ğ‘œğ‘ , and b) LocationRisk@Tğ‘€ğ‘œğ‘ + , depending upon the traffic flow
features. For LocationRisk@Tğ‘€ğ‘œğ‘ we set

âŠ¤
ğ’ğ‘ğ‘¡ = ğ‘¤ğ‘â†’ğ‘ (ğ‘¡), ğ‘¤ğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡), ğ‘¤ ğ‘“ ğ‘Ÿğ‘œğ‘šâˆ’ğ‘ (ğ‘¡) ,
(LocationRisk@Tğ‘€ğ‘œğ‘ Features)
where
ğ‘¤ğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡) :=

âˆ‘ï¸
ğ‘ â€² âˆˆ C\ğ‘

ğ‘¤ğ‘ â€² â†’ğ‘ (ğ‘¡)

and

ğ‘¤ ğ‘“ ğ‘Ÿğ‘œğ‘šâˆ’ğ‘ (ğ‘¡) :=

âˆ‘ï¸

ğ‘¤ğ‘â†’ğ‘ â€² (ğ‘¡),

ğ‘ â€² âˆˆ C\ğ‘

and â€œ\â€²â€² denotes the set difference operator. In effect, LocationRisk@Tğ‘€ğ‘œğ‘ considers the net traffic
to and from a clusters along with the location signalsâ€™ density, while being agnostic to the infections
in each cluster.
1 Provided

each cluster contains adequate number of location signals and infections for reliable learning.

8

Rambhatla and Zeighami, et al.

To make the model infection-aware, we design LocationRisk@Tğ‘€ğ‘œğ‘ + which has additional
mobility-based features to account for the infections at the origin cluster. Let ğ¼ğ‘ (ğ‘¡) denote the
infections in cluster ğ‘ at time ğ‘¡, and further let ğ¼ âˆ’ğ‘ (ğ‘¡) denote the total infections (over all clusters)
except those in cluster ğ‘, i.e.,
âˆ‘ï¸
ğ¼ âˆ’ğ‘ (ğ‘¡) =
ğ¼ğ‘ â€² (ğ‘¡).
ğ‘ â€² âˆˆ C\ğ‘

We formulate the infection mobility to a cluster ğ‘ as
ğ¼ğ‘šğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡) :=

ğ‘¤ğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡)
 Â· ğ¼ âˆ’ğ‘ (ğ‘¡).
ğ‘¤ğ‘¡ğ‘œâˆ’ğ‘ â€² (ğ‘¡) + ğ‘¤ ğ‘“ ğ‘Ÿğ‘œğ‘šâˆ’ğ‘ â€² (ğ‘¡)

Ã
ğ‘ â€² âˆˆ C\ğ‘

Here, ğ¼ğ‘šğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡) captures the proportion of infections travelling to a cluster ğ‘. Similarly, we also
form ğ¼ğ‘šğ‘œ ğ‘“ âˆ’ğ‘ (ğ‘¡) to weigh the total number of infections in a cluster ğ‘ by the ratio of self-mobility
and traffic from other clusters.
ğ‘¤ğ‘â†’ğ‘ (ğ‘¡)
ğ¼ğ‘šğ‘œ ğ‘“ âˆ’ğ‘ (ğ‘¡) :=
Â· ğ¼ğ‘ (ğ‘¡).
ğ‘¤ğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡)
With these features, we form the feature set for LocationRisk@Tğ‘€ğ‘œğ‘ + as follows.

âŠ¤
ğ’ğ‘ğ‘¡ = ğ‘¤ğ‘â†’ğ‘ (ğ‘¡), ğ‘¤ğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡), ğ‘¤ ğ‘“ ğ‘Ÿğ‘œğ‘šâˆ’ğ‘ (ğ‘¡), ğ¼ğ‘šğ‘¡ğ‘œâˆ’ğ‘ (ğ‘¡), ğ¼ğ‘šğ‘œ ğ‘“ âˆ’ğ‘ (ğ‘¡)
(LocationRisk@Tğ‘€ğ‘œğ‘ + Features)
3.2

Incorporating Mobility Features into Hawkes Process

Now, given the daily infections at each cluster ğ‘ âˆˆ C, i.e. a realization of a point process ğ‘ğ‘ (ğ‘¡)
on [0,ğ‘‡ ] for ğ‘‡ < âˆ, at timestamps Tğ‘ = {ğ‘¡ 1ğ‘ , ğ‘¡ 2ğ‘ , . . . ğ‘¡ğ‘›ğ‘ }, we model the rate of new cases at time ğ‘¡,
ğœ†ğ‘ (ğ‘¡) associated with a cluster ğ‘ by incorporating the corresponding traffic mobility features ğ’ğ‘ğ‘¡
developed in Sec. 3.1 as
âˆ‘ï¸
ğ‘¡
ğ‘¡ âˆ’Î”
ğœ†ğ‘ (ğ‘¡) = ğœ‡ğ‘ +
ğ‘…ğ‘ ğ‘— (ğ’ğ‘ğ‘— , ğœƒ ) ğ‘¤ğ‘ğ‘™ (ğ‘¡ğ‘– âˆ’ ğ‘¡ ğ‘— ),
(1)
ğ‘¡ >ğ‘¡ ğ‘— ,ğ‘¡ ğ‘— âˆˆ T

where, ğœ‡ğ‘ is known as the background rate, and captures the inherent proclivity of a cluster to
produce infections. We use Weibull distribution, ğ‘¤ğ‘ğ‘™ (Â·) with shape ğ›¼ and scale ğ›½ to model the
inter-event time, which specifies the influence of past events. The time-delay parameter Î” is used
to account for the delay between the mobility and the infections.
The mobility features are used to model the time-varying cluster-dependent reproduction number
ğ‘…ğ‘ğ‘¡ (ğ’ğ‘ğ‘¡ âˆ’Î”, ğœƒ ). In particular, we model the dynamic reproduction number ğ‘…ğ‘ğ‘¡ as a Poisson regression
task [9], including the traffic-flow based mobility features for each cluster as
ğ‘¡

ğ‘¡ âˆ’Î”

ğ‘¬ğ‘… [ğ‘…ğ‘ ğ‘— |ğ’ğ‘ğ‘—

ğ‘¡ âˆ’Î”

, ğœƒ ] = exp(ğœƒ âŠ¤ ğ’ğ‘ğ‘—

),

(2)

where ğ‘¬ [Â·] denotes the expectation operator.
The mobility and cluster-dependent reproduction number ğ‘…ğ‘ğ‘¡ (ğ’ğ‘ğ‘¡ âˆ’Î”, ğœƒ ) can be viewed as the
average number of secondary infections caused by a primary infection (in the Granger sense
[12, 19, 45]). In addition, the first term ğœ‡ğ‘ helps in modelling the effect of factors not captured by
the mobility-dependent second term.
Overall, LocationRisk@T incorporates the actual high-resolution mobility patterns within a
city, which enables us to learn informative spatiotemporal risk scores (developed in Sec. 3.4). As
compared to related mobility-based methods (such as [9]) which rely only on mobility density,
LocationRisk@T leverage fine-grained flow information. The main task now is to infer the model
parameters ğœƒ of LocationRisk@T using the mobility features and the infections. We now describe
the Expectation Maximization-based inference procedure to learn ğœƒ .

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

9

Algorithm 1 LocationRisk@T: Mobility-based Hawkes process Model using Poisson Regression
|T |
Input: The timestamps set Tğ‘ = {ğ‘¡ ğ‘ğ‘— } ğ‘—=
1 for each cluster ğ‘ âˆˆ C (e.g. daily infections in each
cluster within a city). Daily Origin-Destination matrix {ğ‘Š (ğ‘¡)}}ğ‘‡ğ‘¡=0 consisting of mobility
| C |, | T |
patterns within a city to form mobility features {ğ’ğ‘ğ‘¡ }ğ‘=
1,ğ‘¡ =0 . Weibull shape and scale parameters
ğ›¼ and ğ›½, time delay parameter Î”, and the tolerance parameter ğ›¿.
C
Output: Estimates ğœƒ and {ğœ‡ğ‘ }ğ‘=
1.

Initialize: ğœ‡ğ‘ â† 0.5 for all ğ‘ âˆˆ C, ğ‘…ğ‘ğ‘¡ â† 1 for all ğ‘ âˆˆ C and ğ‘¡ âˆˆ T , ğ‘‡ â† max T , and ğ‘˜ = 1.
while âˆ¥Î”ğœƒ âˆ¥ â‰¥ ğ›¿ and âˆ¥Î”ğœ‡ğ‘ âˆ¥ â‰¥ ğ›¿ for all ğ‘ âˆˆ C do
Expectation Step:
for âˆ€ ğ‘– â‰¥ ğ‘— and 0 < ğ‘–, ğ‘— < ğ‘‡ and âˆ€ ğ‘ âˆˆ C do
if i>j then
ğ‘¡
ğ‘¡ âˆ’Î”
ğ‘…ğ‘ ğ‘— (ğ’ğ‘ğ‘— , ğœƒ ) ğ‘¤ğ‘ğ‘™ (ğ‘¡ âˆ’ ğ‘¡ ğ‘— )
ğ‘ğ‘ (ğ‘–, ğ‘—) =
ğœ†ğ‘ (ğ‘¡ğ‘– )
else if i = j then
ğœ‡ğ‘
ğ‘ğ‘ (ğ‘–, ğ‘–) =
ğœ†ğ‘ (ğ‘¡ğ‘– )
end
Maximization Step:

Ã | C | Ãğ‘›
âŠ¤ ğ’ğ‘¡ ğ‘— âˆ’Î” âˆ’ exp(ğœƒ âŠ¤ ğ’ğ‘¡ ğ‘— âˆ’Î” )
ğ‘ƒ
(
ğ‘—)ğœƒ
Update ğœƒ :
ğœƒ^ â† arg max ğ‘=
ğ‘
ğ‘
ğ‘
ğ‘—=1
1
ğœƒ
Ãğ‘› ğ‘ğ‘ (ğ‘–,ğ‘–)
Update ğœ‡ğ‘ s:
ğœ‡^ğ‘ â† ğ‘–=1 ğ‘‡ for all ğ‘ âˆˆ C.
ğ‘˜ â†ğ‘˜ +1
end

3.3

Expectation Maximization-based Inference Procedure

We adopt an Expectation Maximization-based approach to infer the parameters ğœƒ . Our algorithm
(outlined in Algorithm 1) provides an iterative way to evaluate the maximum-likelihood estimates
of LocationRisk@T. We begin by introducing latent variables ğ‘Œ in order to model the unobserved
variables of our model.
To this end, we begin
by writing the likelihood L (Î˜; ğ‘‹ ) for


 Hawkes process
| Tğ‘ |, | C |
| C |, | T |
C
ğ‘
ğ‘¡
given data ğ‘‹ = {ğ‘¡ ğ‘— } ğ‘—=1,ğ‘=1, {ğ’ğ‘ }ğ‘=1,ğ‘¡ =1 and model parameters Î˜ = {ğœ‡ğ‘ }ğ‘=1, ğœƒ as
L (Î˜; ğ‘‹ ) =

|C| Ã–
ğ‘›
Ã–

ğœ†ğ‘ (ğ‘¡ğ‘– ) expâˆ’

âˆ«ğ‘‡
0

ğœ†ğ‘ (ğ‘¡ )ğ‘‘ğ‘¡

.

(3)

ğ‘=1 ğ‘–=1

For the EM procedure, we introduce latent variables ğ‘Œğ‘–ğ‘ğ‘— to indicate that an event ğ‘— is an off-spring
event ğ‘– in cluster ğ‘, and ğ‘Œğ‘–ğ‘–ğ‘ to denote that it was generated by a background event (in ğ‘), to formulate
the complete data log-likelihood as
log(L (Î˜; ğ‘‹, ğ‘Œ )) =

| C | âˆ‘ï¸
ğ‘›
âˆ‘ï¸
ğ‘=1 ğ‘–=1

ğ‘Œğ‘–ğ‘–ğ‘

log(ğœ‡ğ‘ ) + ğ‘Œğ‘–ğ‘ğ‘—

âˆ« ğ‘‡
Â© âˆ‘ï¸
Âª
ğ‘¡ ğ‘— âˆ’Î”
ğ‘¡ğ‘—
log Â­
ğ‘…ğ‘ (ğ’ğ‘ , ğœƒ ) ğ‘¤ğ‘ğ‘™ (ğ‘¡ âˆ’ ğ‘¡ ğ‘— ) Â® âˆ’
ğœ†ğ‘ (ğ‘¡)ğ‘‘ğ‘¡ .
0
Â«ğ‘¡ğ‘– >ğ‘¡ ğ‘— ,ğ‘¡ ğ‘— âˆˆT
Â¬
(4)

10

Rambhatla and Zeighami, et al.

3.3.1 Expectation Step. Since both log(L (Î˜; ğ‘‹, ğ‘Œ )) and ğ‘Œ are random variables, at the ğ‘˜-th iteration
in the E-step we evaluate the expectation function ğ‘„ (Î˜, Î˜ğ‘˜âˆ’1 ) as
ğ‘„ (Î˜, Î˜ğ‘˜âˆ’1 ) = ğ‘¬ğ‘Œ [log(L (Î˜; ğ‘‹, ğ‘Œ ))|ğ‘‹, Î˜ğ‘˜âˆ’1 ],
âˆ«
=
log(L (Î˜; ğ‘‹, ğ‘Œ ))ğ‘“ (ğ‘Œ |ğ‘‹, Î˜ğ‘˜âˆ’1 )ğ‘‘ğ‘Œ ,

(5)

where Î˜ğ‘˜âˆ’1 are the estimated parameters at the (ğ‘˜ âˆ’ 1)-th iteration, and ğ‘“ (ğ‘Œ |ğ‘‹, Î˜ğ‘˜âˆ’1 ) is the
conditional distribution of ğ‘Œ given ğ‘‹ and Î˜ğ‘˜âˆ’1 . Specifically, as in [9], we estimate the probability
ğ‘ğ‘ (ğ‘–, ğ‘—) as follows
ğ‘¡

ğ‘ğ‘ (ğ‘–, ğ‘—) := ğ‘¬ğ‘Œ [ğ‘Œğ‘–ğ‘ğ‘— |ğ‘‹, Î˜ğ‘˜âˆ’1 ] =

ğ‘¡ âˆ’Î”

ğ‘…ğ‘ ğ‘— (ğ’ğ‘ğ‘—

, ğœƒ ) ğ‘¤ğ‘ğ‘™ (ğ‘¡ âˆ’ ğ‘¡ ğ‘— |ğ›¼, ğ›½)
ğœ†ğ‘ (ğ‘¡ğ‘– )

and ğ‘ğ‘ (ğ‘–, ğ‘–) as
ğœ‡ğ‘
.
ğœ†ğ‘ (ğ‘¡ğ‘– )

ğ‘ğ‘ (ğ‘–, ğ‘–) := ğ‘¬ğ‘Œ [ğ‘Œğ‘–ğ‘–ğ‘ |ğ‘‹, Î˜ğ‘˜âˆ’1 ] =

3.3.2 Maximization Step. Based on the probabilities ğ‘ğ‘ (ğ‘–, ğ‘—) and ğ‘ğ‘ (ğ‘–, ğ‘–), we estimate the parameters
by maximizing ğ‘„ (Î˜, Î˜ğ‘˜âˆ’1 ) in (5) w.r.t. to each parameter2 . With this, we arrive at the following
update steps for each parameter [9]. Specifically, we learn the parameters ğœƒ via Poisson regression
as
!
| C | âˆ‘ï¸
ğ‘›
âˆ‘ï¸
ğ‘¡
âˆ’Î”
ğ‘¡
âˆ’Î”
ğ‘—
ğ‘—
âŠ¤
âŠ¤
ğœƒ^ := arg max
ğ‘ƒğ‘ ( ğ‘—)ğœƒ ğ’ğ‘
âˆ’ exp(ğœƒ ğ’ğ‘ ) ,
ğœƒ

where ğ‘ƒğ‘ ( ğ‘—) =
parameters:

Ãğ‘›

ğ‘–=ğ‘—+1 ğ‘ğ‘ (ğ‘–,

ğ‘—=1

ğ‘—), and the following closed form update for the background rate

ğœ‡^ğ‘ := arg max
ğœ‡ğ‘

3.4

ğ‘=1

ğ‘›
âˆ‘ï¸

âˆ«
ğ‘ğ‘ (ğ‘–, ğ‘–) log(ğœ‡ğ‘ ) âˆ’

ğ‘‡

ğœ‡ğ‘ ğ‘‘ğ‘¡ =
0

ğ‘–=1

ğ‘›
âˆ‘ï¸

ğ‘ğ‘ (ğ‘–,ğ‘–)
ğ‘‡ .

ğ‘–=1

Characterizing Risk

The dynamic reproduction number (commonly referred to as ğ‘…0) has been used to assign risk
scores to communities [28]. Indeed as explored by [9], the reproduction number is dependent on
the mobility density over time. However, since the reproduction number is highly sensitive to
parameter choices and models [11, 30], LocationRisk@T leverages both the dynamic reproduction
number ğ‘…ğ‘ğ‘¡ and the background rate ğœ‡ğ‘ associated with a cluster ğ‘ to assign risk scores. Specifically,
we propose a spatiotemporal risk score based on the intensity function ğœ†ğ‘ (ğ‘¡) of LocationRisk@T.
Let Î› âˆˆ R | C |Ã—ğ‘‡ be a matrix where Î›(ğ‘, ğ‘¡) = ğœ†ğ‘ (ğ‘¡). Then, we define our risk score ğœŒ âˆˆ [0, 1] for a
cluster ğ‘ at time ğ‘¡ as
ğœ†ğ‘ (ğ‘¡) âˆ’ â€² minâ€² Î›(ğ‘ â€², ğ‘¡ â€²)
ğ‘ âˆˆ C,ğ‘¡ âˆˆğ‘‡
ğ‘…ğ‘–ğ‘ ğ‘˜ ğ‘†ğ‘ğ‘œğ‘Ÿğ‘’ ğœŒğ‘ (ğ‘¡) =
.
(6)
â€²
maxâ€² Î›(ğ‘ , ğ‘¡ â€²) âˆ’ â€² minâ€² Î›(ğ‘ â€², ğ‘¡ â€²)
â€²
ğ‘ âˆˆ C,ğ‘¡ âˆˆğ‘‡

ğ‘ âˆˆ C,ğ‘¡ âˆˆğ‘‡

This essentially scales the intensity function of the disease relative to the intensities in other clusters
over time, and alleviates the issues associated with calculating accurate reproduction number.
2 The

Weibull shape and scale parameters ğ›¼ and ğ›½ can also be learned by adding additional EM-based update steps when
adequate data samples are available, i.e. | T | is large enough; see [9]. Since we run our simulation over relatively shorter
time scales, in our formulation we set ğ›¼ and ğ›½ based on grid-search.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data
City
San Francisco
Miami
Chicago
Houston

December
116Ã—106
75Ã—106
135Ã—106
135Ã—106

January
96Ã—106
105Ã—106
175Ã—106
182Ã—106

March
61Ã—106
64Ã—106
107Ã—106
105Ã—106

City
San Francisco
Miami
Chicago
Houston

Table 1. Total No. location signals per Month

Parameter
ğ‘‘ğ‘šğ‘ğ‘¥
ğ‘¡ğ‘šğ‘–ğ‘›
ğ‘
ğ‘›ğ‘–ğ‘›ğ‘–ğ‘¡
ğœ‡ğ¼ğ‘†
ğœğ¼ğ‘†
ğœ‡ğ‘…
ğœğ‘…

4

December
62Ã—103
42Ã—103
76Ã—103
69Ã—103

January
72Ã—103
55Ã—103
106Ã—103
97Ã—103

11
March
55Ã—103
46Ã—103
90Ã—103
78Ã—103

Table 2. No. Agents per Month

Description
Maximum distance for a co-location
Minimum duration for infection
Probability of infection
Number of agents initially infected
Average number of days for an agent to become IS from infection
Std. deviation of number of days for an agent to become IS from infection
Average number of days for an agent to become R from infection
Std. deviation of number of days for an agent to become R from infection
Table 3. SpreadSim Parameter Setting

Value
âˆ¼ 11ğ‘š
1â„
1
1,000
5
1
12
2.4

EXPERIMENTAL RESULTS

We now evaluate and compare the performance of our proposed method with competing techniques
based on the accuracy of their infection and risk prediction over different months and cities in the
United States (US).
4.1

Data

The statistics of our dataset is summarised in Tables 1 and 2. We obtained the data from Veraset [2] a
data-as-a-service company that provides anonymized population movement data collected through
GPS signals of cell-phones across the US. The obtained dataset consists of location signals across the
US for the time-periods December 1, 2019 to January 31, 2020, as well as March 5, 2020 to March 26,
2020. For each of the cities or counties considered, we first use a range defined by a rectangle that
roughly covers the area of the city or county to select the location signals that fall within the area.
Each record in the dataset consists of anonymized_device_id, latitude, longitude, timestamp
and horizontal accuracy. We assume each anonymized_device_id corresponds to a unique
individual. We discard any location signal with horizontal accuracy of worse than 25 meters.
Furthermore, we filter out individuals with less than 100 location signals for every one-month
period considered.
4.2

Experimental Setup

We run SpreadSim described in Sec. 2 for the areas around the cities of San Francisco (and the bay
area), Miami (Miami-Dade county), Chicago (Cook county) and Houston (Harris county) over the
Infection and Risk Prediction for San Franciscoâ€“Bay Area, CA
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 2, 3)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
0.272
0.138
0.073
0.224
0.131
0.313
0.136
0.115
0.091

MAE(ğœŒ all )
0.037
0.257
0.046

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 12)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
0.615
0.162
0.117
0.048
0.340
0.139
0.067
0.038
0.140
0.123
0.045
0.040

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 12)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.284
0.197
0.168
0.139
0.758
0.157
0.169
0.142
0.281
0.126
0.101
0.112

Table 4. Predicting (5-day) Infections and Risk for San Franciscoâ€“Bay Area, CA. The table shows the error in
predicted infections (I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for
Dec â€˜19, Jan â€˜20, and Mar â€˜20 for the top-5 clusters.

12

Rambhatla and Zeighami, et al.

Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

Fig. 5. Comparing the Risk across months in different regions of San Franciscoâ€“Bay Area, CA. Panels (a),
(b), and (c) show the evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19,
Jan â€˜20, and Mar â€˜20, respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20,
respectively. In addition, panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of
location signals, infections and risk, across clusters over months, respectively. We observe that while the risk
for months of Dec and Jan show similar trends for different days, the month of Mar has lower risk later in
the month, which can be attributed to the drop in mobility; see cluster 12 (best viewed digitally).

available days in December 2019, January 2020, and March 2020. The results for more cities across
the US can be found in Appendix A. For each city and month, SpreadSim starts on day 1 and ends
on the last day of the month, generating a disease spread pattern based on activities of the agents.
For each experiment, we use the last 5 days as our test set to evaluate LocationRisk@Tâ€™s infection
and risk prediction performance.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

13

Infection and Risk Prediction for Miami, FL
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 2, 12)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
0.383
0.189
0.121
0.058
0.162
0.164
0.087
0.043
0.092
0.146
0.064
0.040

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 18)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.216
0.285
0.102
0.075
0.196
0.178
0.064
0.076
0.152
0.163
0.031
0.054

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 12)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.365
0.227
0.244
0.154
1.229
0.219
0.235
0.147
0.308
0.128
0.117
0.110

Table 5. Predicting (5-day) Infections and Risk for Miami, FL. The table shows the error in predicted infections
(I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for Dec â€˜19, Jan â€˜20, and
Mar â€˜20 for the top-5 clusters.

4.2.1 SpreadSim Parameters. For SpreadSim, the parameter setting is shown in Table 3. We set ğœ‡ğ¼ğ‘†
to 5 similar to the mean incubation period reported in [31], and ğœğ¼ğ‘† = 1 since [21] observed that
most infections occur within 3 days of symptom onset. The work in [21] reports â€œInfectiousness
was estimated to decline quickly within 7 daysâ€, so we set ğœ‡ğ‘… to ğœ‡ğ¼ğ‘† + 7. We use a larger value for ğœğ‘…
to account for the fact that some people may self-isolate after the onset of the symptoms. We use a
value for ğ‘‘ğ‘šğ‘ğ‘¥ larger than the common 2 meter (m) recommendation for social distancing as the
discussion in [5] shows how infections can happen through co-locations with a larger separation
between individuals if the co-location lasts for a long enough duration. Thus, we also set ğ‘¡ğ‘šğ‘–ğ‘› to
1 hour, larger than the 15 minute minimum threshold mentioned by [44]. Moreover, because we
consider co-locations that are at least 1h, we set ğ‘ = 1, as the probability of infection becomes
higher when co-locations last for long periods.
Furthermore, note that the accuracy of our location data is to about 25m, which is larger than
the value we used for ğ‘‘ğ‘šğ‘ğ‘¥ . Thus, the inaccuracy in our location data can affect who gets infected
in the simulation. However, this does not impact the quality of the infection patterns generated,
because the 25m accuracy still ensures that an agent in the same area as the infected agent will get
infected. For instance, if an infected person is in a shopping mall, the other infected agents will still
be in the shopping mall.
Finally, we note that although we have made every effort to design SpreadSim such that it follows
the transmission dynamics of COVID-19, existing inaccuracies in the transmission model do not
affect the observations made in this paper. This is because, firstly, SpreadSim is used to generate
the ground-truth. The models predicting risk-scores are both trained and evaluated against on
this ground-truth data. Secondly, SpreadSim is used consistently across all the baselines and our
proposed models, and thus our evaluation is fair.
4.2.2 Baselines. We analyze the performance of LocationRisk@Tğ‘€ğ‘œğ‘ and LocationRisk@Tğ‘€ğ‘œğ‘ + â€“
the two variants which utilize the fine-grain mobility-flow information (as described in Sec. 3.1)
along with Hawkesğ·ğ‘’ğ‘› , which relies only on the mobility density in the clusters and is the state-ofthe-art approach for spatiotemporal modeling of COVID-19 from mobility data [9]. Specifically,
Hawkesğ·ğ‘’ğ‘› uses the location signals at the clusters, with the mobility density feature defined as


ğ’ğ‘ğ‘¡ = ğ‘¤ğ‘â†’ğ‘ (ğ‘¡) .
(Hawkesğ·ğ‘’ğ‘› Features)
4.2.3 Metrics. We evaluate the techniques on two main criteria â€“ a) infection prediction, to judge
the model fit, and b) risk prediction to analyze the efficacy of using the proposed risk metric in Eq. (6)
as a reliable indicator for predicting potential risk associated with a region over time. For infection
prediction we use mean relative absolute error (relative-MAE) between the predicted infection
trajectory and the true infections (R-MAE(I)) as the performance metric. This relative measure
accounts for the scale differences (in number of infections) across different clusters. In addition, we
also report the standard deviation of the predicted infection trajectory (ğœ(I)) corresponding to
our relative-MAE metric. For risk prediction, we report the mean absolute error (MAE) between

14

Rambhatla and Zeighami, et al.

Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

Fig. 6. Comparing the Risk across months in different regions of Miami, FL. Panels (a), (b), and (c) show the
evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19, Jan â€˜20, and Mar â€˜20,
respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20, respectively. In addition,
panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of location signals, infections
and risk, across clusters over months, respectively. We observe that while the risk for months of Dec and Jan
show similar trends for different days, the month of Mar has lower risk later in the month, which can be
attributed to the drop in mobility; see cluster 1 (best viewed digitally).

the the predicted risk and the infections (scaled between 0 and 1) on the test set (MAE(ğœŒ test )) and
overall (MAE(ğœŒ all )).

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

15

Infection and Risk Prediction for Chicago (Cook County), IL
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 2, 7)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
0.536
0.165
0.080
0.337
0.151
0.071
0.162
0.126
0.053

MAE(ğœŒ all )
0.041
0.038
0.035

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 9)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
0.941
0.177
0.075
0.238
0.129
0.037
0.174
0.118
0.045

MAE(ğœŒ all )
0.048
0.053
0.071

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 9)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
1.005
0.142
0.215
0.342
0.098
0.173
0.209
0.083
0.071

MAE(ğœŒ all )
0.143
0.144
0.078

Table 6. Predicting (5-day) Infections and Risk for Chicago (Cook County), IL. The table shows the error in
predicted infections (I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for
Dec â€˜19, Jan â€˜20, and Mar â€˜20 for the top-5 clusters.

4.2.4 Pre-processing steps. We use Origin-Destination (OD) matrix ğ‘Š (ğ‘¡) as a means to gauge the
traffic-flow characteristics on day ğ‘¡. The OD matrix is a |C| Ã— |C| matrix where |C| is the number
of clusters. In our experiments we set |C| = 15. The entry ğ‘¤ğ‘–â†’ğ‘— (ğ‘¡) on the ğ‘–-th row and the ğ‘—-th
column of ğ‘Š (ğ‘¡) is calculated as the total count of consecutive location signals, ğ’¸ and ğ’¸â€², over all
individuals, such that ğ’¸ is in cluster ğ‘– and ğ’¸â€² is in cluster ğ‘—; see also Sec. 3.1.
Next, we use a 6-day moving median filter to smooth the infection and mobility traces. Empirically,
we find that such a smoothing helps to counter the dominance of a cluster with sudden rise in cases
on the learned model. All mobility features are standardized, meaning that we subtract the mean
and divide by the standard deviation.
4.2.5 Parameter Choices. The main parameters of the model are the Weibull parameters (ğ›¼, ğ›½)
and the time delay parameter Î”. For each city and month, we choose set of parameters (ğ›¼, ğ›½, Î”)
which yields the best relative-MAE on infection prediction. For a fair comparison, all techniques
are provided with the same set of parameters for a city and month.
4.3

Results

We show the infection prediction performance measured in terms of R-MAE and the risk prediction
performance in terms of the MAE between the evaluated risk and scaled infections for top-5 clusters
(in terms of location signals) of the metropolitan areas of San Francisco, Miami, Chicago and
Houston in Tables 4, 5, 6, and 7, respectively. We provide additional results for the metro areas
of Los Angeles, New York, Seattle, and Salt lake County in Appendix A. For each of these cities,
LocationRisk@Tğ‘€ğ‘œğ‘ + yields the best infection prediction performance across all months considered.
Furthermore, our models LocationRisk@Tğ‘€ğ‘œğ‘ and LocationRisk@Tğ‘€ğ‘œğ‘ + are also more robust (ğœŒ test
performance) and yield superior performance overall for risk prediction as compared to the densityonly baseline of Hawkesğ·ğ‘’ğ‘› . Note that like any learning model, the prediction capabilities are
sensitive to the amount of available infections. As a result, the prediction accuracy for clusters with
small number of infections is not high. Arguably, the risk scores for clusters with large number of
infections matter more, and for low-infection levels contact tracing may be a more effective tool.
In addition, in Figs. 5 6, 7, and 8 panels (a-c)(i-iii) we provide visualizations of the predicted
spatiotemporal risk by LocationRisk@Tğ‘€ğ‘œğ‘ + corresponding to Tables 4, 5, 6, and 7, respectively, for
day 10, 15, and 20 of the months of Dec. 2019, Jan. 2020, and Mar. 2020. Furthermore, in panel (d)
(i-iii) in each of these figures, we compare the corresponding average mobility density, infections
and the predicted risk across all clusters (in a city) for these months. Note that here the risk scores
are scaled from [0, 1] for each month, where a darker color represents a higher risk score relative to
the risk in that month. From Figs. 5 6, 7, and 8 we note an interesting trend that the similar mobility
patterns of the months of Dec. 2019 and Jan. 2020 (except for scale), leads to similar disease spread
patterns, and ultimately similar risk scores. The month of Mar. 2020, however, is different for each
of these cities from Dec. 2019 and Jan. 2020 across the board. Recall that the stay-at-home order
was implemented in the middle of the Mar. 2020 [1], hence our March dataset includes mobility
patterns before, during and after the lock-down. Consequently, we observe higher mobility density

16

Rambhatla and Zeighami, et al.

Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

Fig. 7. Comparing the Risk across months in different regions of Chicago (Cook county), IL. Panels (a), (b),
and (c) show the evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19, Jan â€˜20,
and Mar â€˜20, respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20, respectively.
In addition, panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of location signals,
infections and risk, across clusters over months, respectively. We observe that while the risk for months of
Dec and Jan show similar trends for different days, the month of Mar has lower risk later on, which can be
attributed to the drop in mobility; see cluster 6 (best viewed digitally).

during the beginning of the month (which results in higher infections early on). However, as the
mobility drops (panel (d-i), there is a corresponding drop in the infections (panel (d-ii), and the risk

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

17

scores by LocationRisk@Tğ‘€ğ‘œğ‘ + (panel (d-iii)). Here, LocationRisk@Tğ‘€ğ‘œğ‘ + â€™s risk scores track the
infections, emerging as a reliable spatiotemporal risk metric.
Lastly, another important observation is regarding the high-risk areas for each city. Our results
using LocationRisk@Tğ‘€ğ‘œğ‘ + corroborates our intuition that popular destinations in a city are riskier.
For instance, for the metro area of San Francisco, the actual downtown area turns out to be
high-risk. This trend can also be observed in other cities as well. Here, the superior performance
of LocationRisk@Tğ‘€ğ‘œğ‘ + over Hawkesğ·ğ‘’ğ‘› and LocationRisk@Tğ‘€ğ‘œğ‘ for both infection and risk
prediction can be attributed to modeling the infection mobility in addition to the location signal
density and mobility. Incorporating the infection mobility as opposed to just relying on popularity
of an area, as in case of Hawkesğ·ğ‘’ğ‘› , allows LocationRisk@Tğ‘€ğ‘œğ‘ + to improve infection prediction
performance by being cognizant of the past infections in different areas in a city. As a result,
LocationRisk@Tğ‘€ğ‘œğ‘ + underscores the importance of bringing together mobility patterns and
infection spread prediction model to assign high-resolution risk scores.
5
5.1

RELATED WORK
Disease Prediction and Mobility Indicators

Most popular disease prediction models employ compartmental models since they allow explicit modeling of the transmission characteristics. These mainly include variants of the classical
Susceptible-Infected-Removed (SIR) model [26], such as the S-Exposed-IR (SEIR) model and its variants, which primarily aim to add additional latent states to the SIR model [35]. Popular in practice
due to their simplicity, these models rely on the homogeneous population mixing to learn the model
parameters, and have been used to predict reproduction number (R0) at coarser granularity for
counties, states and entire countries [4]. Although useful to communicate the disease characteristics
at early stages, coarse-grain risk scores and reproduction number estimates at county or state level
are not readily usable for public policy decisions at finer spatial and temporal scales [6, 23]. On the
other hand, Hawkes process-based point process disease spread models have also emerged as an
alternative way to model COVID-19 spread [9]. Even though mathematical similarities between
compartmental models and Hawkes process-based models exist, Hawkes process-based modeling
does not involve complex parameter estimation, model identifiability and mis-specification as in
the case of SEIR model [13, 22, 29, 37, 40].
Moving away from homogeneous mixing models therefore involves analyzing the specific
mobility patterns, and utilizing these covariates in disease spread prediction. To this end, the
study in [9] leverages the flexibility of the Hawkes process models to incorporate the demographic
and mobility indices for COVID-19 prediction. Their work shows that the dynamic reproduction
number correlates with the time-delayed mobility density at the county-level across United States,
where R0 is viewed as a proxy for the risk associated with a region. Although such coarse-grain
risk scores are useful in policy decisions for a country or a state, these may not be informative
enough for city-level planning. To this end, [28] use dynamic (time-varying) reproduction number
to assign risk scores to communities using a compartmental based model (assume homogeneous
mixing), but do not consider mobility features. To this end, LocationRisk@T leverages the Poisson
Regression-based reproduction number modelling proposed by [9] to incorporate the mobility
patterns provided by OD matrices, and infection mobility covariates to develop the spatiotemporal
risk scores, as discussed in Sec. 3 and 4.
5.2

Agent-Based Models and Simulations

Various agent-based simulations are used to model the spread of a disease in a population [8, 15,
16, 20, 27]. They generate synthetic contacts to simulate human contacts using contact matrices,
where a pre-defined probability of contact between individuals in different groups of the society

18

Rambhatla and Zeighami, et al.
Infection and Risk Prediction for Houston (Harris County), TX
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 2, 5)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
0.357
0.145
0.097
0.208
0.133
0.112
0.159
0.113
0.070

MAE(ğœŒ all )
0.055
0.063
0.076

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 10)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.022
0.206
0.085
0.074
0.276
0.135
0.040
0.082
0.204
0.132
0.044
0.070

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 10)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.285
0.166
0.200
0.115
0.457
0.107
0.102
0.076
0.256
0.093
0.071
0.066

Table 7. Predicting (5-day) Infections and Risk for Houston (Harris County), TX. The table shows the error in
predicted infections (I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for
Dec â€˜19, Jan â€˜20, and Mar â€˜20 for the top-5 clusters.

is used to decide whether there is contact between individuals at any point in time. Furthermore,
their goal is to study different intervention policies. SpreadSim is different from the existing work
in two aspects. First, we use real-world location signals to model human mobility. This allows us
to create realistic infection patterns in a population that changes over time based on the mobility
and is different for different populations. The existing simulations are incapable of capturing this
because they generate contacts between individuals synthetically. Second, we use SpreadSim only
as a means of generating realistic infection information to allow us to evaluate LocationRisk@T.
6

CONCLUSIONS AND FUTURE WORK

In this work, we demonstrated that time-varying location-based risk scores can be a valuable public
health tool to facilitate safe reopening of normal activities. The existing risk scores (based on
reproduction number learned using compartmental models) either do not provide the information
at spatial and time resolutions to be useful, or rely on uniform mixing of population, which is be
unrealistic in practice.
We developed LocationRisk@T, a Hawkes process based model for infection and risk forecasting,
where we incorporate actual mobility patterns along with mobility of infected population from
different regions of city to assign spatiotemporal risk scores at relatively finer temporal and spatial
scales. Subsequently, we demonstrated the applicability of model by, SpreadSim, which simulates
the disease spread over actual mobility data from months of Dec. 2019, Jan. 2020, and Mar. 2020
across cities in the United States. Our risk scores emerge as a reliable metric while tracking the
infections in a city. One limitation of our approach is that even though we rely on real-world
co-locations, the disease spread mechanism is based on simulation, which is agnostic to any real
physical barriers or other factors which may influence disease spread.
We plan to extend our work in three directions. First, we intend to develop individual-level
user-specific risk scores by combining user trajectory prediction models with our spatiotemporal
risk prediction model. Next, we plan to address the privacy issues associated with assigning userspecific risk scores. Finally, incorporating demographics and electronic medical records (EMR)
data, considering spatiotemporal Hawkes process models [45] and deep learning based models for
long-term forecasting capability, also constitute our future work.
ACKNOWLEDGEMENTS
This research has been funded in part by NSF grants IIS-1910950, CNS-2027794, and IIS-1254206,
the USC Integrated Media Systems Center (IMSC), and unrestricted cash gifts from Microsoft. We
would also like to acknowledge Veraset for providing us with high fidelity location signals. Any
opinions, findings, and conclusions or recommendations expressed in this material are those of the
author(s) and do not necessarily reflect the views of the sponsors.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

19

Fig. 8. Comparing the Risk across months in different regions of Houston (Harris County), TX. Panels (a),
(b), and (c) show the evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19,
Jan â€˜20, and Mar â€˜20, respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20,
respectively. In addition, panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of
location signals, infections and risk, across clusters over months, respectively. We observe that while the risk
for months of Dec and Jan show similar trends for different days, the month of Mar has lower risk later in
the month, which can be attributed to the drop in mobility; see cluster 5 (best viewed digitally).

20

Rambhatla and Zeighami, et al.

REFERENCES
[1] 2020. Stay-at-home order. https://covid19.ca.gov/stay-home-except-for-essential-needs/#:~:text=All%20individuals%
20living%20in%20the,the%20Questions%20%26%20Answers%20below). Accessed: 2020-11-10.
[2] 2020. Veraset Website. https://www.veraset.com/about-veraset. Accessed: 2020-10-25.
[3] Torgil Abrahamsson. 1998. Estimation of origin-destination matrices using traffic counts-a literature survey. (1998).
[4] Andrea L. Bertozzi, Elisa Franco, George Mohler, Martin B. Short, and Daniel Sledge. 2020. The challenges of modeling
and forecasting the spread of COVID-19. Proceedings of the National Academy of Sciences 117, 29 (2020), 16732â€“16738.
https://doi.org/10.1073/pnas.2006520117 arXiv:https://www.pnas.org/content/117/29/16732.full.pdf
[5] Erin Bromage. 2020. The Risks-Know Them-Avoid Them. Erin Bromage: COVID-19 Musings (2020).
[6] Aroon Chande, Seolha Lee, Mallory Harris, Quan Nguyen, Stephen J. Beckett, Troy Hilley, Clio Andris, and Joshua S.
Weitz. 2020. Real-time, interactive website for US-county-level COVID-19 event risk assessment. Nature Human
Behaviour (2020). https://doi.org/10.1038/s41562-020-01000-9
[7] Serina Chang, Emma Pierson, Pang Wei Koh, Jaline Gerardin, Beth Redbird, David Grusky, and Jure Leskovec. 2020.
Mobility network models of COVID-19 explain inequities and inform reopening. Nature (2020), 1â€“6.
[8] Sheryl L Chang, Nathan Harding, Cameron Zachreson, Oliver M Cliff, and Mikhail Prokopenko. 2020. Modelling
transmission and control of the COVID-19 pandemic in Australia. arXiv preprint arXiv:2003.10218 (2020).
[9] Wen-Hao Chiang, Xueying Liu, and George Mohler. 2020. Hawkes process modeling of COVID-19 with mobility leading indicators and spatial covariates. medRxiv (2020). https://doi.org/10.1101/2020.06.06.20124149
arXiv:https://www.medrxiv.org/content/early/2020/06/08/2020.06.06.20124149.full.pdf
[10] Derek K Chu, Elie A Akl, Stephanie Duda, Karla Solo, Sally Yaacoub, Holger J SchÃ¼nemann, Amena El-harakeh,
Antonio Bognanni, Tamara Lotfi, Mark Loeb, et al. 2020. Physical distancing, face masks, and eye protection to prevent
person-to-person transmission of SARS-CoV-2 and COVID-19: a systematic review and meta-analysis. The Lancet
(2020).
[11] Paul L Delamater, Erica J Street, Timothy F Leslie, Y Tony Yang, and Kathryn H Jacobsen. 2019. Complexity of the
basic reproduction number (R0). Emerging infectious diseases 25, 1 (2019), 1.
[12] Michael Eichler, Rainer Dahlhaus, and Johannes Dueck. 2017. Graphical modeling for multivariate hawkes processes
with nonparametric link functions. Journal of Time Series Analysis 38, 2 (2017), 225â€“242.
[13] Neil D Evans, Lisa J White, Michael J Chapman, Keith R Godfrey, and Michael J Chappell. 2005. The structural
identifiability of the susceptible infected recovered model with seasonal forcing. Mathematical biosciences 194, 2 (2005),
175â€“197.
[14] CP Farrington, MN Kanaan, and NJ Gay. 2003. Branching process models for surveillance of infectious diseases
controlled by mass vaccination. Biostatistics 4, 2 (2003), 279â€“295.
[15] Neil Ferguson, Daniel Laydon, Gemma Nedjati Gilani, Natsuko Imai, Kylie Ainslie, Marc Baguelin, Sangeeta Bhatia,
Adhiratha Boonyasiri, ZULMA Cucunuba Perez, Gina Cuomo-Dannenburg, et al. 2020. Report 9: Impact of nonpharmaceutical interventions (NPIs) to reduce COVID19 mortality and healthcare demand. (2020).
[16] Neil M Ferguson, Derek AT Cummings, Christophe Fraser, James C Cajka, Philip C Cooley, and Donald S Burke. 2006.
Strategies for mitigating an influenza pandemic. Nature 442, 7101 (2006), 448â€“452.
[17] Luca Ferretti, Chris Wymant, Michelle Kendall, Lele Zhao, Anel Nurtay, Lucie Abeler-DÃ¶rner, Michael Parker, David
Bonsall, and Christophe Fraser. 2020. Quantifying SARS-CoV-2 transmission suggests epidemic control with digital
contact tracing. Science 368, 6491 (2020).
[18] Center for Disease Control (CDC). 2020. Coronavirus Disease 2019 (COVID-19): Daily Activities and Going Out.
https://www.cdc.gov/coronavirus/2019-ncov/daily-life-coping/going-out.html. Accessed: 2020-11-12.
[19] Clive WJ Granger. 1969. Investigating causal relations by econometric models and cross-spectral methods. Econometrica:
journal of the Econometric Society (1969), 424â€“438.
[20] M Elizabeth Halloran, Neil M Ferguson, Stephen Eubank, Ira M Longini, Derek AT Cummings, Bryan Lewis, Shufu Xu,
Christophe Fraser, Anil Vullikanti, Timothy C Germann, et al. 2008. Modeling targeted layered containment of an
influenza pandemic in the United States. Proceedings of the National Academy of Sciences 105, 12 (2008), 4639â€“4644.
[21] Xi He, Eric HY Lau, Peng Wu, Xilong Deng, Jian Wang, Xinxin Hao, Yiu Chung Lau, Jessica Y Wong, Yujuan Guan,
Xinghua Tan, et al. 2020. Temporal dynamics in viral shedding and transmissibility of COVID-19. Nature medicine 26,
5 (2020), 672â€“675.
[22] Nicolas Hengartner and Paul Fenimore. 2018. Quantifying Model Form Uncertainty of Epidemic Forecasting Models
from Incidence Data. Online Journal of Public Health Informatics 10, 1 (2018).
[23] Harvard Global Health Institute. 2020. Key Metrics for COVID Suppression. https://globalepidemics.org/key-metricsfor-covid-suppression/. Accessed: 2020-11-12.
[24] Nitin Kamra, Yizhou Zhang, Sirisha Rambhatla, Chuizheng Meng, and Yan Liu. 2020. PolSIRD: Modeling Epidemic
Spread under Intervention Policies and an Application to the Spread of COVID-19. arXiv:q-bio.PE/2009.01894

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

21

[25] Matt J Keeling, T Deirdre Hollingsworth, and Jonathan M Read. 2020. Efficacy of contact tracing for the containment
of the 2019 novel coronavirus (COVID-19). Journal of Epidemiology & Community Health 74, 10 (2020), 861â€“866.
https://doi.org/10.1136/jech-2020-214051 arXiv:https://jech.bmj.com/content/74/10/861.full.pdf
[26] William Ogilvy Kermack and Anderson G McKendrick. 1927. A contribution to the mathematical theory of epidemics.
Proceedings of the royal society of london. Series A, Containing papers of a mathematical and physical character 115, 772
(1927), 700â€“721.
[27] Cliff C Kerr, Robyn M Stuart, Dina Mistry, Romesh G Abeysuriya, Gregory Hart, Katherine Rosenfeld, Prashanth
Selvaraj, Rafael C Nunez, Brittany Hagedorn, Lauren George, et al. 2020. Covasim: an agent-based model of COVID-19
dynamics and interventions. medRxiv (2020).
[28] Mehrdad Kiamari, Gowri Ramachandran, Quynh Nguyen, Eva Pereira, Jeanne Holm, and Bhaskar Krishnamachari.
2020. COVID-19 Risk Estimation using a Time-varying SIR-model. 1st ACM SIGSPATIAL International Workshop on
Modeling and Understanding the Spread of COVID-19 (2020).
[29] Conor Kresin, Frederic Paik Schoenberg, and George Mohler. 2020. Comparison of the Hawkes and SEIR models for
the spread of Covid-19. (2020).
[30] Jing Li, Daniel Blakeley, et al. 2011. The failure of R 0. Computational and mathematical methods in medicine 2011
(2011).
[31] Qun Li, Xuhua Guan, Peng Wu, Xiaoye Wang, Lei Zhou, Yeqing Tong, Ruiqi Ren, Kathy SM Leung, Eric HY Lau,
Jessica Y Wong, et al. 2020. Early transmission dynamics in Wuhan, China, of novel coronavirusâ€“infected pneumonia.
New England Journal of Medicine (2020).
[32] Yaguang Li, Rose Yu, Cyrus Shahabi, and Yan Liu. 2018. Diffusion Convolutional Recurrent Neural Network: DataDriven Traffic Forecasting. In International Conference on Learning Representations. https://openreview.net/forum?id=
SJiHXGWAZ
[33] Melika Lotfi, Michael R Hamblin, and Nima Rezaei. 2020. COVID-19: Transmission, prevention, and potential
therapeutic opportunities. Clinica Chimica Acta (2020).
[34] Sebastian Meyer, Leonhard Held, and Michael HÃ¶hle. 2015. Spatiotemporal analysis of epidemic phenomena using the
R package surveillance. Statistics-Computation 1411.0416 (2015).
[35] Andrew C Miller, Nicholas J Foti, Joseph A Lewnard, Nicholas P Jewell, Carlos Guestrin, and Emily B Fox. 2020.
Mobility trends provide a leading indicator of changes in SARS-CoV-2 transmission. medRxiv (2020). https://doi.org/
10.1101/2020.05.07.20094441 arXiv:https://www.medrxiv.org/content/early/2020/05/11/2020.05.07.20094441.full.pdf
[36] George Mohler, Frederic Schoenberg, Martin B Short, and Daniel Sledge. 2020. Analyzing the World-Wide Impact of
Public Health Interventions on the Transmission Dynamics of COVID-19. arXiv preprint arXiv:2004.01714 (2020).
[37] Dave Osthus, Kyle S Hickmann, PetruÅ£a C Caragea, Dave Higdon, and Sara Y Del Valle. 2017. Forecasting seasonal
influenza with a state-space SIR model. The annals of applied statistics 11, 1 (2017), 202.
[38] Sen Pei and Jeffrey Shaman. 2020. Initial Simulation of SARS-CoV2 Spread and Intervention Effects in the Continental
US. medRxiv (2020).
[39] Marian-Andrei Rizoiu, Swapnil Mishra, Quyu Kong, Mark Carman, and Lexing Xie. 2018. SIR-Hawkes: linking epidemic
models and Hawkes processes to model diffusions in finite populations. In Proceedings of the 2018 World Wide Web
Conference. 419â€“428.
[40] Kimberlyn Roosa and Gerardo Chowell. 2019. Assessing parameter identifiability in compartmental dynamic models
using a computational approach: application to infectious disease transmission models. Theoretical Biology and Medical
Modelling 16, 1 (2019), 1.
[41] New York Times. 2020. Actual Coronavirus Infections Vastly Under counted, C.D.C. Data Shows. https://www.nytimes.
com/2020/06/27/health/coronavirus-antibodies-asymptomatic.html. Accessed: 2020-10-27.
[42] New York Times. 2020. As the Coronavirus Surges, a New Culprit Emerges: Pandemic Fatigue. https://www.nytimes.
com/2020/10/17/us/coronavirus-pandemic-fatigue.html. Accessed: 2020-10-29.
[43] New York Times. 2020. As Virus Surges in Europe, Resistance to New Restrictions Also Grows. https://www.nytimes.
com/2020/10/09/world/europe/coronavirus-europe-fatigue.html. Accessed: 2020-10-29.
[44] W Joost Wiersinga, Andrew Rhodes, Allen C Cheng, Sharon J Peacock, and Hallie C Prescott. 2020. Pathophysiology,
transmission, diagnosis, and treatment of coronavirus disease 2019 (COVID-19): a review. Jama 324, 8 (2020), 782â€“793.
[45] Baichuan Yuan, Hao Li, Andrea L Bertozzi, P Jeffrey Brantingham, and Mason A Porter. 2019. Multivariate spatiotemporal hawkes processes and network reconstruction. SIAM Journal on Mathematics of Data Science 1, 2 (2019),
356â€“382.
[46] Difan Zou, Lingxiao Wang, Pan Xu, Jinghui Chen, Weitong Zhang, and Quanquan Gu. 2020. Epidemic Model Guided
Machine Learning for COVID-19 Forecasts in the United States. medRxiv (2020).

22

A

Rambhatla and Zeighami, et al.

ADDITIONAL EXPERIMENTAL RESULTS

We ran our experiments, with the same setup described in Sec. 4, but for the areas around four more
cities, namely Los Angeles, Seattle (King county), New York (Manhattan) and Salt Lake county. The
statistics of these datasets can be found in Tables 8 and 9. The results are presented in Tables 10, 11,
12 and 13 and Figs. 9, 10, 11 and 12.
An interesting observation, in cities of New York (Manhattan) and Salt lake County shown in
Fig 11 and Table 12, and Fig 12 and Table 13, respectively, is that an increased mobility in Mar. 2020
leading to a large number of infections decreases modelâ€™s capacity to predict later on when the
infections drop. This is because the Hawkes process model tends to attribute the infections to the
background rate ğœ‡ğ‘ rather than the mobility-dependent ğ‘…ğ‘ğ‘¡ . This leads to poor infection prediction
performance (for all methods) since the model anticipates infections to happen at the relatively
large background rate. In practice, such a modality can be avoided by using longer traces like [9].
Nevertheless, our risk scores (6) based on the intensity function ğœ†ğ‘ (ğ‘¡) (1) are still faithful to the
infections since they take into account both the background rate and the mobility-dependence. This
in fact highlights the advantages and reliability of the proposed risk score metric. In addition, our
risk score for Manhattan (New York) also illustrates its applicability for fine-grained spatiotemporal
risk assignment.
City
Los Angeles
Seattle
New York
Salt Lake

December
331 Ã— 106
53Ã—106
41Ã—106
31Ã—106

January
282Ã—106
66Ã—106
36Ã—106
39Ã—106

March
171Ã—106
38Ã—106
21Ã—106
29Ã—106

City
Los Angeles
Seattle
New York
Salt Lake

Table 8. Total No. location signals per Month

December
159Ã—103
29Ã—103
40Ã—103
16Ã—103

January
171Ã—103
38Ã—103
41Ã—103
22Ã—103

March
131Ã—103
32Ã—103
32Ã—103
23Ã—103

Table 9. No. Agents per Month

Infection and Risk Prediction for Los Angeles, CA
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 2, 5)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
0.249
0.099
0.105
0.235
0.088
0.164
0.095
0.083
0.068

MAE(ğœŒ all )
0.047
0.195
0.062

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 5)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
0.526
0.091
0.148
0.117
0.077
0.193
0.106
0.074
0.103

MAE(ğœŒ all )
0.101
0.166
0.077

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 5)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
0.517
0.054
0.162
0.133
0.184
0.037
0.180
0.096
0.163
0.037
0.130
0.136

Table 10. Predicting (5-day) Infections and Risk for Los Angeles, CA. The table shows the error in predicted
infections (I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for Dec â€˜19, Jan
â€˜20, and Mar â€˜20 for the top-5 clusters.
Infection and Risk Prediction for Seattle, WA
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 2, 12)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
0.424
0.213
0.097
0.039
0.259
0.198
0.075
0.038
0.227
0.195
0.077
0.032

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 12)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.190
0.312
0.110
0.067
0.756
0.267
0.100
0.052
0.614
0.254
0.085
0.055

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 12)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.518
0.173
0.179
0.109
1.329
0.168
0.206
0.115
0.504
0.131
0.155
0.104

Table 11. Predicting (5-day) Infections and Risk for Seattle, WA. The table shows the error in predicted
infections (I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for Dec â€˜19, Jan
â€˜20, and Mar â€˜20 for the top-5 clusters.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

23

Fig. 9. Comparing the Risk across months in different regions of Los Angeles, CA. Panels (a), (b), and (c) show
the evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19, Jan â€˜20, and Mar â€˜20,
respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20, respectively. In addition,
panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of location signals, infections
and risk, across clusters over months, respectively. We observe that while the risk for months of Dec and Jan
show similar trends for different days, the month of Mar has lower risk. This can be attributed to the drop in
mobility.

24

Rambhatla and Zeighami, et al.

Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

Fig. 10. Comparing the Risk across months in different regions of Seattle, WA. Panels (a), (b), and (c) show
the evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19, Jan â€˜20, and Mar â€˜20,
respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20, respectively. In addition,
panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of location signals, infections
and risk, across clusters over months, respectively. We observe that while the risk for months of Dec and Jan
show similar trends for different days, the month of Mar has lower risk. This can be attributed to the drop in
mobility.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

25

Infection and Risk Prediction for New York (Manhattan), NY
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 2, 16)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.045
0.270
0.076
0.067
0.210
0.170
0.035
0.058
0.145
0.162
0.021
0.061

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 18)
R-MAE(I) ğœ(I) MAE(ğœŒ test )
2.529âˆ—
0.508âˆ—
0.080âˆ—
1.068
0.356
0.060
0.448
0.294
0.037

MAE(ğœŒ all )
0.092âˆ—
0.089
0.080

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 2, 11)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
7.173
0.482
0.311
0.199
7.446
0.492
0.344
0.205
4.440
0.370
0.248
0.174

Table 12. Predicting (5-day) Infections and Risk for New York (Manhattan), NY. The table shows the error in
predicted infections (I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for
Dec â€˜19, Jan â€˜20, and Mar â€˜20 for the top-5 clusters. âˆ— The model is essentially a constant model based on the
ğœ’ 2 statistic.

Infection and Risk Prediction for Salt Lake County, UT
Model
Hawkesğ·ğ‘’ğ‘›
LocationRisk@Tğ‘€ğ‘œğ‘
LocationRisk@Tğ‘€ğ‘œğ‘ +

December â€˜19
(ğ›¼, ğ›½, Î”) = (2, 3, 17)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
0.813âˆ—
0.409âˆ—
0.137âˆ—
0.069âˆ—
0.197
0.298
0.070
0.062
0.189
0.287
0.069
0.059

January â€˜20
(ğ›¼, ğ›½, Î”) = (2, 3, 19)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.390
0.430
0.162
0.087
0.624
0.335
0.110
0.072
0.429
0.308
0.088
0.066

March â€˜20
(ğ›¼, ğ›½, Î”) = (2, 3, 13)
R-MAE(I) ğœ(I) MAE(ğœŒ test ) MAE(ğœŒ all )
1.694
0.363
0.238
0.162
1.133
0.308
0.198
0.141
1.064
0.307
0.234
0.167

Table 13. Predicting (5-day) Infections and Risk for Salt Lake County, UT. The table shows the error in
predicted infections (I), the corresponding standard deviation, risk (ğœŒ) for the test set, and over all days for
Dec â€˜19, Jan â€˜20, and Mar â€˜20 for the top-5 clusters. âˆ— The model is essentially a constant model based on the
ğœ’ 2 statistic.

26

Rambhatla and Zeighami, et al.
Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

Fig. 11. Comparing the Risk across months in different regions of Manhattan (New York), NY. Panels (a),
(b), and (c) show the evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19,
Jan â€˜20, and Mar â€˜20, respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20,
respectively. In addition, panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of
location signals, infections and risk, across clusters over months, respectively. We observe that while the risk
for months of Dec and Jan show similar trends for different days, the month of Mar has lower risk. This can
be attributed to the drop in mobility.

Towards Accurate Spatiotemporal COVID-19 Risk Scores using High Resolution Real-World Mobility Data

Day 15

Day 20

(a-i)

(a-ii)

(a-iii)

(b-i)

(b-ii)

(b-iii)

(c-i)

(c-ii)

(c-iii)

(d-i)

(d-ii)

(d-iii)

Mar. â€˜20

Jan. â€˜20

Dec. â€˜19

Day 10

27

Fig. 12. Comparing the Risk across months in different regions of Salt Lake County, UT. Panels (a), (b), and
(c) show the evaluated risk (ğœŒ) for each cluster (marked via numbers) for the months of Dec â€˜19, Jan â€˜20, and
Mar â€˜20, respectively. The panels (i), (ii), and (iii) show the risk varying over day 10, 15, and 20, respectively.In
addition, panel (d-i), (d-ii), and (d-iii) show the comparison between the average number of location signals,
infections and risk, across clusters over months, respectively. We observe that while the risk for months of
Dec and Jan show similar trends for different days, the month of Mar has lower risk. This can be attributed to
the drop in mobility.

