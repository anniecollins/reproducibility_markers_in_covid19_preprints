Improved log-Gaussian approximation for over-dispersed
Poisson regression: application to spatial analysis of
COVID-19
Daisuke Murakami1*, Tomoko Matsui2

1Department

of Statistical Data Science, Institute of Statistical Mathematics, Tachikawa, Tokyo, Japan

2Department

of Statistical Modeling, Institute of Statistical Mathematics, Tachikawa, Tokyo, Japan

*Corresponding author
E-mail: dmuraka@ism.ac.jp

Abstract
In the era of open data, Poisson and other count regression models are increasingly
important. Provided this, we develop a closed-form inference for an over-dispersed Poisson regression,
especially for (over-dispersed) Bayesian Poisson wherein the exact inference is unobtainable. The
approach is derived via mode-based log-Gaussian approximation. Unlike closed-form alternatives, it
remains accurate even for zero-inflated count data. Besides, our approach has no arbitrary parameter
that must be determined a priori. Monte Carlo experiments demonstrate that the estimation error of
the proposed method is a considerably smaller estimation error than the closed-form alternatives and
as small as the usual Poisson regressions. We obtained similar results in the case of Poisson additive
mixed modeling considering spatial or group effects. The developed method was applied for analyzing
COVID-19 data in Japan. This result suggests that influences of pedestrian density, age, and other
factors on the number of cases change over periods.

1

Introduction
Currently, a wide variety of count data are corrected through sensors and used for smart
urban and regional management (see Soomro et al., 2019). For example, in 2020â€“2021 when the
coronavirus disease (COVID-19) spread globally, the daily number of people infected with
coronavirus was monitored worldwide, and countermeasures were considered based on the
observations (Viner et al., 2020).
Poisson and other regression models for count data have been used for analyzing the
number of COVID-19 cases (e.g., Oztig and Askin, 2020; VokÃ³ and Pitter, 2020) or other diseases
(e.g., Wakefield, 2007; Lee and Neocleous, 2010). These regression models have also been used in
ecology (e.g., Ver Hoef and Boveng, 2007; LindÃ©n and MÃ¤ntyniemi, 2011), criminology (e.g., Osgood,
2000; Piza, 2012), and other fields.
Recently, Bayesian Poisson regression, which assumes Poisson distribution for the count
data and Gaussian priors for latent variables describing spatial, group, and other effects, is widely used
in applied studies. Owing to the lack of contiguity between the Poisson and Gaussian distributions, an
approximate inference is necessary for the estimation. Unfortunately, the Markov Chain Monte Carlo
method can be slow for large samples. Faster approximations have been developed for count data
regression in a context of additive modeling (e.g., Wood, 2011; RodrÃ­guez-Ãlvarez et al., 2015), mixed
effects modeling (Pinheiro and Bates, 2011), and Gaussian process (e.g., Diggle et al., 1998; Rue et
al., 2009). These approaches do not provide closed-form solutions.
Exceptionally, Chan and Dong (2011) and Chan and Vasconcelos (2011) proposed closedform approximations for Poisson regression. Their approaches have the following advantages:
(i)

Easy to implement and extend. The Gaussian process model and other models for Gaussian data
are readily transferred for count data modeling.

(ii) Computationally efficient. Unlike alternatives, numerical optimization is not needed.
(iii) Poisson regression estimates are unidentifiable or identifiable only weakly for certain data
configuration (Silva and Tenreyro, 2010). As we will illustrate later, this property considerably
worsen the accuracy of Poisson regression estimates especially for small samples with many
zeros. The linear approximation is free from such difficulty and more stable.
Breslow (1984) and El-Sayyad (1973) proposed relevant closed-form approximations, too. Given the
current situation wherein a wide range of researchers and practitioners use count data, these fast, stable,
and practical approaches will become increasingly important. Unfortunately, these approximations
have the following disadvantages:

2

(iv) They have poor approximation accuracy for zero-inflated data (i.e., counts with many zeros) as
we will demonstrate later. Zero-inflation is a special type of over-dispersion (Ver Hoef and
Boveng, 2007). Thus, a closed-form approach accurately describing over-dispersion is needed.
(v) An arbitrary parameter, which is used to avoid taking the logarithm of zero, must be determined
a priori. The value is known to have substantial impact on the modeling result (Bellego and Pape,
2019). A closed-form approach without such an arbitrary parameter is needed.
Given that, we develop a closed-form approximation for the over-dispersed Poisson
regression, especially (over-dispersed) Bayesian Poisson regression, that has (i)â€“(ii) and overcomes
(iii)â€“(iv).

Methods
Improved log-Gaussian approximation
The mode of a log-Gaussian distribution grows slower than the mean whereas the mode
and mean of a Poisson distribution grow at the same rate. Therefore, mean-based log-Gaussian
approximation, such as the Taylor approximation use in Chan and Dong (2011), can have poor
approximation accuracy around the mode, which is the distribution center. Considering the success of
Laplace or other mode-based approximations in previous studies, it is reasonable to accurately
approximate Poisson distribution around the mode. This study first introduces a mode-based
approximation achieving it.
We first consider the following Poisson model for count variables ğ‘Œğ‘– |ğ‘– âˆˆ {1, â€¦ ğ‘}:
ğ‘Œğ‘– ~ğ‘ƒğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘›(ğœ†ğ‘– ),

ğœ†ğ‘– = ğ‘§ğ‘– exp(ğœ‡ğ‘– ),

(1)

where ğœ‡ğ‘– is represents the mean, which may be specified by a regression model with/without a
Gaussian prior. ğ‘§ğ‘– is a given offset variable. ğ‘Œğ‘– is known to have two modes {ğœ†ğ‘– âˆ’ 1, ğœ†ğ‘– } for
integer-valued ğœ†ğ‘– . Later, we will use the center of the two modes ğ‘€ğ‘œğ‘‘ğ‘’ğ‘ [ğ‘Œğ‘– ] = ğœ†ğ‘– âˆ’ 0.5.
Our objective is to approximate Eq. (1) by using the following log-Gaussian model for
variables ğ‘¦ğ‘– |ğ‘– âˆˆ {1, â€¦ ğ‘}:
ğ‘¦ğ‘– + ğ‘~ğ‘™ğ‘œğ‘”ğ‘ (ğœ‡ğ‘–(ğº) ,

1
)
ğ‘¦ğ‘– + ğ‘

(2)

where ğœ‡ğ‘–(ğº) represents the mean, and c is a constant required to avoid taking the logarithm of zero.
1
ğ‘¦ğ‘– +ğ‘

is an approximate variance for a log-transformed Poisson random deviate (see El-Sayyad, 1973).

3

We approximate the Poisson model (Eq. (1)) using the log-Gaussian model (Eq. (2)) so
that the mode ğ‘€ğ‘œğ‘‘ğ‘’[ğ‘¦ğ‘– ] under Eq. (2) equals the mode center ğ‘€ğ‘œğ‘‘ğ‘’ğ‘ [ğ‘Œğ‘– ] of the Poisson model. The
following condition is obtained from the mode matching ğ‘€ğ‘œğ‘‘ğ‘’ğ‘ [ğ‘Œğ‘– ] = ğ‘€ğ‘œğ‘‘ğ‘’[ğ‘¦ğ‘– ]:
ğ‘§ğ‘– exp(ğœ‡ğ‘– ) âˆ’ 0.5 = exp (ğœ‡ğ‘–(ğº) âˆ’

1
) âˆ’ ğ‘.
ğ‘¦ğ‘– + ğ‘

(3)

Eq. (3) suggests that ğœ‡ğ‘– and ğœ‡ğ‘–(ğº) do not generally have a linear relationship. Exceptionally, they
have the following linear relationship if ğ‘ = 0.5:
ğœ‡ğ‘–(ğº) = log(ğ‘§ğ‘– ) + ğœ‡ğ‘– +

1
.
ğ‘¦ğ‘– + 0.5

(4)

While existing studies have determined ğ‘ somewhat arbitrary, ğ‘ = 0.5 is found to be a necessary
for applying the linear approximation under our assumption.
Let us substitute ğ‘ = 0.5 and Eq. (4) into Eq. (2). Then, we obtain the following logGaussian model approximating the Poisson model:
ğ‘¦ğ‘– + 0.5~ğ¿ğ‘œğ‘”ğ‘ (log(ğ‘§ğ‘– ) + ğœ‡ğ‘– +

1
1
).
,
ğ‘¦ğ‘– + 0.5 ğ‘¦ğ‘– + 0.5

(5)

By organizing Eq. (5), we have the following model:
log(ğ‘¦ğ‘–âˆ— ) ~ğ‘ (ğœ‡ğ‘– ,
where ğ‘¦ğ‘–âˆ— =

ğ‘¦ğ‘– +0.5
ğ‘§ğ‘–

1
),
ğ‘¦ğ‘– + 0.5

(6)

1

exp (âˆ’ ğ‘¦ +0.5). In short, the log-Gaussian distribution approximates the Poisson
ğ‘–

distribution around the mode center.
Unfortunately, the mode-based approximation is available if only ğœ†ğ‘– = ğ¸[ğ‘Œğ‘– ] â‰¥ 0.5 ,
which assures the non-negativity of ğ‘€ğ‘œğ‘‘ğ‘’ğ‘ [ğ‘Œğ‘– ]. If ğœ†ğ‘– < 0.5, the mode of the Poisson and logGaussian distributions behave somewhat differently: the Poisson mode is always zero while the mode
of the log-Gaussian distribution gradually converges to zero as ğœ†ğ‘– (or ğœ‡ğ‘– ) declines. Mode-based
approximation is not suitable in this case. By contrast, the mean of the two distributions both converge
to zero as ğœ†ğ‘– (or ğœ‡ğ‘– ) approaches zero.
Thus, for ğ¸[ğ‘Œğ‘– ] < 0.5, we rely on a mean-based approximation based on the following
0.5

relationship, which is obtained from ğ¸[ğ‘¦ğ‘–âˆ— ] = exp (ğœ‡ğ‘– + ğ‘¦ +0.5) (see Eq. 6):
ğ‘–

ğ¸[ğ‘¦ğ‘–âˆ— ] exp (âˆ’

0.5
) = ğ¸[ğ‘Œğ‘– ].
ğ‘¦ğ‘– + 0.5

4

(7)

Eq. (7) implies that, when approximating the Poisson mean using ğ‘¦ğ‘–âˆ— , it should be rescaled by
0.5

multiplying exp (âˆ’ ğ‘¦ +0.5). By applying the rescaling for Eq. (6), we have the following mean-based
ğ‘–

approximation:
log(ğ‘¦ğ‘–âˆ—âˆ— ) ~ğ‘ (ğœ‡ğ‘– ,
where ğ‘¦ğ‘–âˆ—âˆ— =

ğ‘¦ğ‘– +0.5
ğ‘§ğ‘–

1
),
ğ‘¦ğ‘– + 0.5

(8)

1+0.5

exp (âˆ’ ğ‘¦ +0.5). Because of the disadvantage of the mean-based approximation
ğ‘–

explained in the beginning of this section, we assume Eq .(6) as long as ğ¸[ğ‘Œğ‘– ] â‰¥ 0.5 (i.e., the modecenter is available) while Eq. (8) otherwise.
Still, ğ¸[ğ‘Œğ‘– ] = ğœ†ğ‘– is unknown a priori. Considering the property that ğ‘ƒ(ğ‘Œğ‘– < 0.5) =
ğ‘ƒ(ğ‘Œğ‘– = 0), we approximate ğ‘ƒ(ğ¸[ğ‘Œğ‘– ] < 0.5) using the ratio ğ‘Ÿ of zero counts in {ğ‘Œ1 , â€¦ , ğ‘Œğ‘ }. Given
the approximation, Eqs. (6) and (8) are applied with probabilities ğ‘Ÿ and 1 âˆ’ ğ‘Ÿ, respectively. By
combining these equations using r, our proposed approximation is formulated as
1
),
ğ‘¦ğ‘– + 0.5

log(ğ‘¦ğ‘–+ ) ~ğ‘ (ğœ‡ğ‘– ,
where ğ‘¦ğ‘–+ =

ğ‘¦ğ‘– +0.5
ğ‘§ğ‘–

(9)

1+0.5ğ‘Ÿ

exp (âˆ’ ğ‘¦ +0.5 ), which yields Eq. (6) if ğ‘Ÿ = 0 and Eq. (8) if ğ‘Ÿ = 1. If all counts
ğ‘–

are non-zero, the mode-based approximation is applied for all the samples. As the share of zero counts
increases, the mean-based approximation is emphasized.

Property of the proposed approximation
Table 1 summarizes closed-form approximations for the Poisson regression models. These
methods perform approximations through the estimation of a linear regression model using the logtransformed explained variables and the inverse weight based on ğ‘¦ğ‘– . These practical methods will be
useful for not only researchers but also practitioners. However, existing methods are accurate only for
a moderate to large ğœ‡ğ‘– (Chan and Vasconcelos, 2011). In other words, they should not be used for
counts with many zeros. Besides, the c parameter, which has a considerable impact on analysis result,
must be determined a priori (see the Introduction section). These drawbacks inhibit the practical use
of these approximations.

5

Table 1: Closed-form approximations for the Poisson regression model Eq. (1). c is a tuning parameter
that must be determined a priori. For the offset variable, ğ‘§ğ‘– = 1 is assumed.
Explained variables
Method

Value of the tuning
Weight

(pseudo-data)
Posterior approx. (EL-Sayyad, 1973)

log(ğ‘¦ğ‘– + ğ‘)

parameter ğ‘ used

1
ğ‘¦ğ‘– + ğ‘

0.0

1
ğ‘¦ğ‘– + ğ‘

1.0

Taylor approx. (Chan and Dong, 2011)
Log-Gamma approx.

log(ğ‘¦ğ‘– + ğ‘) âˆ’

ğ‘
ğ‘¦ğ‘– + ğ‘

(Chan and Vasconcelos, 2011)
Our approximation

log(ğ‘¦ğ‘– + 0.5) âˆ’

1
1 + 0.5ğ‘Ÿ
ğ‘¦ğ‘– + 0.5 ğ‘¦ğ‘– + 0.5

In contrast, our method does not have any unknown tuning parameters. Because of the
mode matching, the proposed method accurately approximates the mode of the Poisson distribution
irrespective of ğœ‡ğ‘– . As we will show later, this property dramatically improves the approximation
accuracy for zero-inflated count data.
Note that our mode-matching method is akin to the Laplace approximation, which is based
on the mode-matching of a Gaussian distribution and the target distribution. Considering studies
demonstrating the accuracy of the Laplace approximation, our mode-based approach is expected to be
accurate as well.

Results: Monte Carlo experiments
Case 1: Basic over-dispersed Poisson regression model
This section compares the estimation accuracy of the proposed approximation (Proposed)
with standard Poisson regression (Poisson), over-dispersed Poisson regression (odPoisson), and
negative binomial regression alternatives (NB). We also compare ours with the posterior
approximation of EL-Sayyad (1973) (Posterior) and the Taylor approximation of Chan and
Vasconcelos (2011) (Taylor).

6

The simulated count data ğ‘¦ğ‘– is generated from the over-dispersed Poisson regression with
mean ğœ†ğ‘– and the overdispersion parameter ğœ 2 :
ğ‘¦ğ‘– ~ğ‘œğ‘‘ğ‘ƒğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘›(ğœ†ğ‘– , ğœ 2 ),

ğœ†ğ‘– = exp(ğ›½0 + ğ‘¥ğ‘–,1 ğ›½1 + ğ‘¥ğ‘–,2 ğ›½2 ),

(10)

where ğ‘¥ğ‘–,1 and ğ‘¥ğ‘–,2 are generated from standard normal distributions N(0, 1), and {ğ›½1 , ğ›½2 } =
{2.0, 0.5}. We refer to ğ›½1 as a strong and ğ›½2 as a weak coefficient. ğœ 2 = 1 implies the standard
Poisson regression without over-dispersion while ğœ 2 > 1 means over-dispersion. The ğ›½0 parameter
implicitly controls the ratio of zero counts; a smaller ğ›½0 value yields more zero counts.
The coefficient estimation accuracy is compared across models while varying ğ›½0 âˆˆ
{âˆ’2, âˆ’1, 0, 1, 1}, ğœ 2 âˆˆ {1, 5}, and ğ‘ âˆˆ {50, 200}. In each case, the simulations were iterated 500
times and the root mean squared error (RMSE) and the mean bias are evaluated:
500

500
1
(ğ‘–ğ‘¡ğ‘’ğ‘Ÿ)
ğ‘…ğ‘€ğ‘†ğ¸[ğ›½ğ‘˜ ] = âˆš âˆ‘
(ğ›½Ì‚ğ‘˜
âˆ’ ğ›½ğ‘˜ )2 ,
ğ‘
ğ‘–ğ‘¡ğ‘’ğ‘Ÿ=1

1
(ğ‘–ğ‘¡ğ‘’ğ‘Ÿ)
âˆ‘ (ğ›½Ì‚ğ‘˜
ğµğ‘–ğ‘ğ‘ [ğ›½ğ‘˜ ] =
âˆ’ ğ›½ğ‘˜ )
ğ‘

(11)

ğ‘–ğ‘¡ğ‘’ğ‘Ÿ=1

(ğ‘–ğ‘¡ğ‘’ğ‘Ÿ)
where ğ›½Ì‚ğ‘˜
is the estimated ğ›½ğ‘˜ in the iter-th iteration.

The evaluated RMSE and bias values are plotted in Figs 1 and 2 in a case without
overdispersion ğœ 2 = 1.0 whereas Figs 3 and 4 in cases with overdispersion ğœ 2 = 5.0. Posterior and
Taylor tend to have large RMSEs and biases across cases, and the errors inflate if ğ‘¦ğ‘– has many zero
values (i.e., small ğ›½0 ). These approximations do not work for zero-inflated count data. In contrast, the
RMSE values for the proposed method are as small as the exact Poisson and odPoisson specifications
across cases. Poisson, odPoisson, and NB have very large RMSE values if the counts are overdispersed (ğœ 2 = 5.0) and have many zero values (small ğ›½0 ); this is attributable to the identification
problem explained in the â€œIntroductionâ€ section. Proposed, which does not suffer from this problem,
advantageous in terms of stability. Although the bias of the proposed method tends to be larger than
that of Poisson and odPoisson, the value is still considerably smaller than that of Posterior and Taylor.
It is suggested that the proposed method estimates regression coefficients accurately, especially for
zero-inflated small data. Fig 5 shows the coefficient standard error (SE) estimates. If ğ‘¦ğ‘– has less zero
values (i.e., large ğ›½0 ), the SEs estimated from the proposed method are similar to those of odPoisson,
especially in the over-dispersion case. In contrast, the proposed method indicated smaller SEs if ğ‘¦ğ‘–
had many zero values (i.e., small ğ›½0 ). Considering the better estimation accuracy of the proposed
method for small ğ›½0 , the smaller SEs might suggest the stability of the proposed method.

7

Figure 1: RMSE of the regression coefficients in cases without overdispersion (ğœ 2 = 1.0)

Figure 2: Bias of the regression coefficients in cases without overdispersion (ğœ 2 = 1.0)

8

Figure 3: RMSE of the regression coefficients in cases with overdispersion (ğœ 2 = 5.0)

Figure 4: Bias of the regression coefficients in cases with overdispersion (ğœ 2 = 5.0)

9

Figure 5: Means of the coefficient standard errors (ğ‘ = 200)

Case 2: Model with spatial effects
To verify the expandability of the proposed model, this section applies the proposed method
to estimate a spatial regression model, which has been widely used to analyze spatial phenomena in
the environment, economy, and epidemic. We consider the following model:
ğ‘¦ğ‘– ~ğ‘œğ‘‘ğ‘ƒğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘›(ğœ†ğ‘– , ğœ 2 ),

ğœ†ğ‘– = exp(ğ›½0 + ğ‘¥ğ‘–,1 ğ›½1 + ğ‘¥ğ‘–,2 ğ›½2 + ğ‘ ğ‘– ),

(12)

where {ğ›½1 , ğ›½2 } = {2, 0.5} and ğœ 2 = 5. ğ‘ ğ‘– is a process capturing a spatially dependent pattern of the
data. Following Murakami and Griffith (2015), it is modeled by assuming random effects whose
spatial dependence exponentially decays relative to the Euclidean distance between the geometric
centers of the two zones. Equation (11) is an over-dispersed Poisson mixed-effects model (MEM) that
considers spatial dependence. The model is estimated by applying the maximum likelihood (ML)
estimation for the Poisson MEM (Poisson), an over-dispersed Poisson MEM (odPoisson), the Taylor
approximate Poisson MEM (Taylor), and our specification (Proposed). Taylor and Proposed fitted
linear MEMs using the transforming explained variables and weight variables (see Table 1). All
models

were

estimated

using

the

R

package

mgcv

(https://cran.r-

project.org/web/packages/mgcv/index.html).
We assumed ğ›½0 âˆˆ {âˆ’2, âˆ’1, 0, 1, 1} and ğ‘ âˆˆ {50, 200}. In each case, the models were
estimated 500 times, and the estimation accuracies were compared. Figs 6 and 7 display the estimated

10

RMSEs and biases, respectively. When N = 50, odPoisson took extremely large RMSEs due to its
singular estimation. Poisson and Taylor also had large RMSEs. In contrast, the proposed method tends
to have smaller RMSE values. The proposed method may be a better choice for small samples. Even
for N = 200, the RMSEs and biases of Proposed were as small as those of Poisson and odPoisson. The
estimation accuracy of the proposed method was verified in the case of spatial regression.
Fig 8 compares the coefficient standard errors. For a large ğ›½0 , the SEs obtained from the
proposed method are similar to odPoisson, which proposes approximates. While odPoisson has larger
SEs for small ğ›½0 , it is attributable to the singular fit. The proposed method stabilizes it and make the
SEs small. Finally, Fig 9 compares the estimation accuracy for the spatially dependent process ğ‘ ğ‘– .
This figure shows that the proposed method tends to estimate the process more accurately than
alternatives.
Note that we performed another Monte Carlo experiment assuming group effects, which
model heterogeneity across groups instead of the spatially dependent effects. As summarized in
Appendix S1, the RMSEs and biases are as small as Poisson and odPoisson for N = 200 and smaller
for N = 50. The SEs are similar to odPoisson for large ğ›½0 and smaller for small ğ›½0 .
In short, the proposed method provides an accurate and stable approximation for an overdispersed Poisson MEM.

Figure 6: RMSE of the regression coefficients (model with spatial effects)

11

Figure 7: Bias of the regression coefficients (model with spatial effects)

Figure 8: Means of the coefficient standard errors (ğ‘ = 200)

Figure 9: RMSE of the estimated spatial effects

12

Results: COVID-19 analysis
Outline
This section employs the developed approximation to an analysis of the COVID-19
(coronavirus disease 2019) pandemic. Since the first case was detected in Wuhan, China, in December
2019, the coronavirus spread. As of February 1, 2021, the cumulative number of confirmed cases is
103.41 million, while the confirmed death toll is 2.25 million. To achieve effective infection control
for not only COVID-19 but also pandemics/endemics in the future, it is important to investigate the
determinants behind the disaster.
Fig 10 plots the number of daily cases in Japan between February 1, 2020, and January 29,
2021. The number peaked around April 2020, August 2020, and January 2021, respectively. Based on
the time trend, we refer to February 1 â€“ May 31 as the first wave, June 1 â€“ September 30 as the second
wave, and October 1 â€“ January 29, 2021, as the third wave. Fig 11 displays the spatial plots of the
daily new cases by prefecture. This figure shows the tendency of the number of infected people to
become large near Tokyo and Osaka, which are major urban areas.

First
wave

Feb 1

(Apr)

Second
wave

Jun 1
2020

(Aug)

Third
wave

Oct 1

Jan 29
2021

Figure 10: Daily number of cases across Japan

13

February 15

April 15

July 15

Osaka

Number of
Infected people
2000
Tokyo
1500

August 15

October 15

December 15
1000

500

0

Figure 11: Number of cases by prefecture

We performed a regression analysis exploring the determinants of the increase/decrease in
each wave. The explained variables are the number of daily cases by prefecture by generation every
decade. The sample sizes were 51,336, 50,508, and 50,094 for the three waves respectively.
Unfortunately, the counts were zero-inflated; 89.0 % (45,696 samples), 77.1 % (38,954 samples), and
49.7 % (24,873 samples) of samples are zeros.
For the zero-inflated COVID-19 data, we fit Eq. (13) approximating an over-dispersed
Poisson additive mixed model:
4

log(ğ‘¦ğ‘–âˆ— )

= ğ›½0 + ğ‘¥ğ‘– ğ›½1 + âˆ‘ ğ‘”ğ‘–,ğ‘™ + ğ‘ ğ‘– + ğœ€ğ‘– ,
ğ‘™=1

where ğ‘¦ğ‘–âˆ— =

ğ‘¦ğ‘– +0.5
ğ‘§ğ‘–

exp (âˆ’

1.5

ğœ€ğ‘– ~ğ‘ (0,

ğœ2
),
ğ‘¦ğ‘– + 0.5

(13)

) , where ğ‘¦ğ‘– is the number of daily new cases. ğ›½0 and ğ›½1 are

ğ‘¦ğ‘– +0.5

regression coefficients. To scale the mean function according to the population, the offset variable ğ‘§ğ‘–
is given by the prefectural population. The explanatory variable ğ‘¥ğ‘– is the prefectural pedestrian
density by day, which is relative to January 13, 2020 (source: Apple Mobility Trends:
https://covid19.apple.com/mobility). The density is estimated based on the number of route searches
by Apple map users. For further detail, see the source page. ğ‘”ğ‘–,ğ‘™ represents the l-th group-wise random
effect. We consider the effects by week (ğ‘”ğ‘–,1 ), days of the week (ğ‘”ğ‘–,2 ), generation (ğ‘”ğ‘–,3 ), and prefecture

14

(ğ‘”ğ‘–,4 ). In addition, a Moran coefficient-based spatial random effect ğ‘ ğ‘– is included to eliminate residual
spatial dependence (Murakami and Griffith, 2015).
The model was estimated using the R package spmoran (Version 0.2.1; https://cran.rproject.org/web/packages/spmoran/index.html).

Results
Table 1 summarizes the estimated parameters. The estimated coefficients of pedestrian
density become positively significant in the second and third waves. Self-restraint was estimated to
reduce the number of cases after June. Based on the estimated residual standard error (ğœ 2 ), the residual
variance was over-dispersed, and the tendency became stronger over time.

Table 1: Parameter estimates. See Figure 12 for the fitting on the number of cases.
First wave
Est.

t value

-16.60 -220.24

Const (ğ›½0 )
Pedestrian density (ğ›½1 )
Residual S.E. (ğœ 2 )
Log-Likelihood

-0.38

-7.68

Est.

***

t value

-16.68 -114.03

***

0.23

3.48

***
***

Est.

t value

-14.88 -115.94
0.15

3.34

1.67

1.91

-71375

-100418

-93152

2nd wave
Pred.
value

Number of cases

Third wave

1.40

1st wave
Pred.
value

Second wave

3rd wave
Pred.
value

Number of cases

Number of cases

Figure 12: Comparison of the observed and predicted number of cases

15

***
***

Ã— First

0.2

Second
Third

1.0

0.0

0.0

-0.2
Ã— First
Second
Third

Ã— First
Earlier week

Later week

Week

Second
Third

-0.4
Sat

Mon

Wed

Days of the week

Fri

-1.0

20s

40s

60s

80s

Generation

Figure 13: Estimated group effects (week, days of the week, generation)

Fig 13 plots the estimated group effects by week, days of the week, and generation. The
estimated week-wise effects show that the increase in cases lasts longer in later waves. Control of the
infection spread might be getting more difficult over waves. Regarding the days of the week, Monday
has the lowest while Thursday, Friday, and Saturday have higher values. The difference is attributable
to some business reasons such as the closing of hospitals and PCR test sites. The estimated generation
effects have considerable differences across waves. In the first wave, people who are in the working
generation (the 20s - 50s) tend to be infected. Commuting and/or meeting in the office might trigger
the infection. In the second wave, the 20â€™s group has a strong tendency of being infected as compared
to the elders, therefore, more self-restriction is needed. In the third wave, not only the 20s but also the
30s â€“ 50s have high chances of being infected. Infection might spread again across the working
generation.
Fig 14 plots the estimated prefecture-wise independent effects and spatially dependent
effects. The former estimates local hotspots while the latter, global hotspots. The estimated prefecturewise effects suggest that prefectures including major cities (Tokyo, Osaka, Fukuoka) and Hokkaido
are local hotspots. More countermeasures might be required in these prefectures. On the other hand,
based on the estimated spatially dependent effects, there is a global hotspot around Tokyo, and the
influences grow over waves. Control of the infection spread from Tokyo might have been important
to mitigate the third wave.

16

Prefecture-wise
effects
(First wave)

Spatially dependent
effects
(First wave)

1.6
1.2
0.8

1.6

Prefecture-wise
effects
(Second wave)

1.2
0.8

Prefecture-wise
effects
(Third wave)

1.6
1.2
0.8

0.4

0.4

0.0

0.0

0.0

-0.4

-0.4

-0.4

-0.8

-0.8

-0.8

-1.2

-1.2

-1.2

-1.6

-1.6

-1.6

1.6
1.2
0.8

Spatially dependent
effects
(Second wave)

1.6
1.2
0.8

0.4

Spatially dependent
effects
(Third wave)

1.6
1.2
0.8

0.4

0.4

0.0

0.0

0.0

-0.4

-0.4

-0.4

-0.8

-0.8

-0.8

-1.2

-1.2

-1.2

-1.6

First wave

0.4

-1.6

Second wave

-1.6

Third wave

Figure 14: Estimated group effects by prefecture (top) and spatially dependent effects (bottom).

Discussion
This study develops a practical log-Gaussian approximation for Poisson regression models.
Considering its simplicity, computational efficiency, and applicability to zero-inflated data, it will be
useful for researchers as well as practitioners.
Exploring the expandability of our approach is an important future task. For example, our
approach might be useful for spatial and spatiotemporal interpolation of count data by combining it
with Gaussian process models without additional computation and implementation costs. Our
approach might also be useful for fast count data assimilation by combining it with a state-space model.
Improving approximation accuracy would also be an interesting research endeavor. If a closed-form
approximation comparable with non-closed-form alternatives regarding not only RMSE but also bias
is developed, it will be extremely useful in practice.

Acknowledgements
This work was supported by JSPS KAKENHI Grant Numbers JP18H01556 and 18H03628, and JSTMirai Program Grant Number JP1124793, Japan.

17

Reference
1. Breslow NE. Extraâ€Poisson variation in logâ€linear models. J Roy Stat Soc C 1984; 33(1): 38-44.
2. Bellego C, Pape LD. Dealing with logs and zeros in regression models. SSRN: 3444996
[Preprint]. 2019 Available from: https://papers.ssrn.com/sol3/papers.cfm?abstract_id=3444996
3. Chan AB, Dong D. Generalized Gaussian process models. Proceedings of the IEEE conference
on computer vision and pattern Recognition 2011; 5995688: 2681-8.
4. Chan AB, Vasconcelos N. Counting people with low-level features and Bayesian regression.
IEEE Trans Image Process 2011; 21(4): 2160-77.
5. Diggle PJ, Tawn JA, Moyeed RA. Modelâ€based geostatistics. J Roy Stat Soc C 1998; 47(3): 299350.
6. El-Sayyad GM. Bayesian and classical analysis of Poisson regression. J Roy Stat Soc B 1973;
35(3): 445-51.
7. Lee D, Neocleous T. Bayesian quantile regression for count data with application to
environmental epidemiology. J Roy Stat Soc C 2010; 59(5): 905-20.
8. LindÃ©n A, MÃ¤ntyniemi S. Using the negative binomial distribution to model overdispersion in
ecological count data. Ecology 2011; 92(7): 1414-21.
9. Murakami D, Griffith DA. Random effects specifications in eigenvector spatial filtering: a
simulation study. J Geogr Syst 2015; 17(4): 311-331.
10. Osgood DW. Poisson-based regression analysis of aggregate crime rates. J Quant Criminol 2000;
16(1): 21-43.
11. Oztig LI, Askin OE. Human mobility and coronavirus disease 2019 (COVID-19): a negative
binomial regression analysis. Public health 2020; 185: 364-367.
12. Pinheiro JC, Bates DM. Mixed-Effects Models in S and S-PLUS. New York: Springer; 2000.
13. RodrÃ­guez-Ãlvarez MX, Lee DJ, Kneib T, DurbÃ¡n M, Eilers P. Fast smoothing parameter
separation in multidimensional generalized P-splines: the SAP algorithm. Stat Comput 2015(5);
25: 941-957.
14. Rue H, Martino S, Chopin N. Approximate Bayesian inference for latent Gaussian models by
using integrated nested Laplace approximations. J Roy Stat Soc B 2009; 71(2): 319-92.
15. Silva JS, Tenreyro S, On the existence of the maximum likelihood estimates in Poisson
regression. Econ Lett 107(2): 310-312
16. Soomro K, Bhutta MN M, Khan Z, Tahir MA. Smart city big data analytics: An advanced review.
Wiley Interdiscip. Rev Data Min Knowl Discov 2019(5); 9: e1319.

18

17. Ver Hoef JM, Boveng PL. Quasiâ€Poisson vs. negative binomial regression: how should we model
overdispersed count data? Ecology 2007; 88(11): 2766-2772.
18. Viner RM, Russell S, Croker H, Packer J, Ward J, Stansfield C, et al. School closure and
management practices during coronavirus outbreaks including COVID-19: a rapid systematic
review. Lancet Child Adolesc Health 2020; 4(5): 397-404.
19. VokÃ³ Z, Pitter JG. The effect of social distance measures on COVID-19 epidemics in Europe: an
interrupted time series analysis. GeroScience 2020; 42(4): 1075-1082.
20. Wakefield J. Disease mapping and spatial regression with count data. Biostatistics 2007; 8: 158183.
21. Wood SN. Fast stable restricted maximum likelihood and marginal likelihood estimation of
semiparametric generalized linear models. J Roy Stat Soc B 2011; 73(1): 3-36.
22. Wood SN. Generalized additive models: an introduction with R. Boca Raton: CRC press; 2017.

Supporting information
Appendix S1: Monte Carlo experiments assuming group-wise
random effects
This section examines the estimation accuracy of the proposed model, assuming a Poisson
MEM with group-wise random effects. The synthetic data is generated by an over-dispersed Poisson
MEM defined as
ğ‘¦ğ‘– ~ğ‘œğ‘‘ğ‘ƒğ‘œğ‘–ğ‘ ğ‘ ğ‘œğ‘›(ğœ†ğ‘– , ğœ 2 ),

ğœ†ğ‘– = exp(ğ›½0 + ğ‘¥ğ‘–,1 ğ›½1 + ğ‘¥ğ‘–,2 ğ›½2 + ğ‘”ğ‘– ),

(A-1)

where {ğ›½1 , ğ›½2 } = {2, 0.5} and ğœ 2 = 5. ğ‘”ğ‘– represents the group-wise random intercept. Samples
were randomly assigned to three groups for N = 50 (16.7 samples per group) and 10 groups for N =
200 (20 samples per group). The value of ğ‘”ğ‘– was sampled from a standard normal distribution.
Following the Monte Carlo experiments section, the Poisson MEM (Poisson), an overdispersed Poisson MEM (odPoisson), the Taylor approximate Poisson MEM (Tayor), and our
specification (Proposed) are estimated by the likelihood maximum, and their estimation accuracies are
compared while varying ğ›½0 âˆˆ {âˆ’2, âˆ’1, 0, 1, 1} and ğ‘ âˆˆ {50, 200}. In each case, the models were
estimated 500 times.
Figs A-1 and A-2 summarize the estimated RMSEs ansd biases. Proposed tends to have
smaller RMSEs than Poisson, odPoisson, and Taylor in cases with small samples (N = 50) while as
small as Poisson and odPoisson in cases with N = 200. Although Bias tends to be larger than Poisson

19

and odPoisson, they are much smaller than Taylor. Fig A-3 compares SEs. The result is consistent
with another simulation assuming spatial dependence (see the Monte Carlo experiment section); the
SEs estimated from Proposed are similar for odPoisson for large ğ›½0 and smaller for small ğ›½0 .
Regarding the group effects estimates, the accuracy of Proposed is as same as odPoisson and better
than Taylor and Poisson.
Overall, the results suggest that the proposed method accurately approximates the overdispersed Poisson MEM with group effects.

Figure A-1: RMSE of the regression coefficients (model with group effects)

20

Figure A-2: Bias of the regression coefficients (model with group effects)

Figure A-3: Means of the coefficient standard errors (ğ‘µ = ğŸğŸğŸ)

Figure A-4: RMSE of the estimated group effects

21

