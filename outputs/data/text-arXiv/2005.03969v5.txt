Methods for forecasting the effect of exogenous risks on stock markets
Karina Arias-Calluaria,1 , Fernando Alonso-Marroquina , Morteza. N. Najafib and Michael HarrÃ©c
a School

of Civil Engineering, The University of Sydney, Australia
of Physics, University of Mohaghegh Ardabili, Ardabil, Iran
c Complex Systems Research Group, Faculty of Engineering, The University of Sydney, Australia

arXiv:2005.03969v5 [q-fin.ST] 10 Jul 2020

b Department

ARTICLE INFO

Abstract

Keywords:
Probability theory
Anomalous diffusion
Data analysis
Diffusion
Stochastic processes

Markets are subjected to both endogenous and exogenous risks that have caused disruptions to
financial and economic markets around the globe, leading eventually to fast stock market declines.
In the past, markets have recovered after any economic disruption. On this basis, we focus on the
outbreak of COVID-19 as a case study of an exogenous risk and analyze its impact on the Standard
and Poorâ€™s 500 (S&P500) index. We assumed that the S&P500 index reaches a minimum before
rising again in the not-too-distant future. Here we present two cases to forecast the S&P500 index.
The first case uses an estimation of expected deaths released on 02/04/2020 by the University of
Washington. For the second case, it is assumed that the peak number of deaths will occur 2-months
since the first confirmed case occurred in the USA. The decline and recovery in the index were
estimated for the following three months after the initial point of the predicted trend. The forecast is a
projection of a prediction with stochastic fluctuations described by ğ‘-gaussian diffusion process with
three spatio-temporal regimes. Our forecast was made on the premise that any market response can
be decomposed into an overall deterministic trend and a stochastic term. The prediction was based
on the deterministic part and for this case study is approximated by the extrapolation of the S&P500
data trend in the initial stages of the outbreak. The stochastic fluctuations have the same structure as
the one derived from the past 24 years. A reasonable forecast was achieved with 85% of accuracy.

1. Introduction
In the investigation of the stock market dynamics, there
are two well-defined approaches: the â€œdescriptive" and â€œstructural" models [1]. Nowadays, these models attempt to capture the endogenous and exogenous systemic risks of market
movements[1, 2, 3, 4]. Endogenous risks have been modeled
in a microeconomic fashion by considering the interactions
between agents and how these change over time, causing
non-linear disruptions even if system parameters change in a
smooth fashion [5, 6, 7]. New â€œdescriptive models" present
endogenous systemic risks as a dynamic factor affected by
the flow of market orders and time scale [2], excessive profits, and excessive losses [8] and large positive or negative
variation in stock markets index [9, 10] due to market activity. The recent â€œstructural models" which are based on
physical model systems such as a combination of oscillation
within a basin of free energy or external force [3, 11], spin
glasses [12], and kinetic Ising model to model stock market
network [13] proposed a natural non-equilibrium system. In
most cases, they introduce the exogenous systemic risks as
a global risk component which evolves all the time affecting
prices of traded assets. The effects of these systemic risks are
likely causes of abrupt changes at the macro-level of market
dynamics [14, 15, 16, 17].
In both systemic risks (endogenous and exogenous) the
market response can be decomposed into two parts, a response function that models changes in the overall trend of
the system, called the skeleton [18], and the other is the
stochastic term [19]. In this work, we analyse the nonlinkarina.ariascalluari@uni.sydney.edu.au
ORCID (s):
1 https://orcid.org/0000-0001-6013-5490

K Arias Calluari et al.: Preprint submitted to Elsevier

ear properties of both of these terms.
The endogenous systemic risks are an inherent part of
the nonlinear dynamics of a market and may have detectable
precursor signals that act as warnings similar to those used
in other nonlinear systems such as climate and ecology [20].
As an example, the 1987 market crash is likely an endogenous event [21], as it had a measurably different effect on
market dynamics than the September 11 attacks [22] and the
1995 Kobe earthquake [21] which pose systemic exogenous
risks to markets. The last two events cannot be endogenized
into market prices by â€˜rationalâ€™ agents ahead of time because
they are not foreseeable [23].
This paper presents the solution of a critical outstanding
problem in finding how the market is coupled to the globe,
and how exogenous and unpredictable global events produce
deterministic trends in the market. In Section 2, we decompose the price return into a deterministic component and a
ğ‘-stationarity fluctuating term. In Section 3, the solution was
applied to the forecasting of S&P500 indexâ€™s response due
to the outbreak of COVID-19. In Section 4, we present a
discussion on how this model provides an overview of the
impacts of an exogenous market shock that can be used as a
reference in developing predictive models with more accuracy.

2. The Model
For this analysis, it is assumed that COVID-19 poses systematic exogenous risks that affect stock markets behaviour.
Therefore, our forecast models considered epidemiological
research results to project the impact of COVID-19. Epidemiological researchers from around the world have proPage 1 of 9

Methods for forecasting the effect of exogenous risk on stock markets

ğ‘‹(ğ‘¡) = ğ¼(ğ‘¡0 + ğ‘¡) âˆ’ ğ¼(ğ‘¡0 ).

(1)

In earlier work we used a detrended fluctuation approach
[39] to decompose the price return ğ‘‹(ğ‘¡) into a deterministic
component ğ‘‹(ğ‘¡) and a stationary fluctuating component ğ‘¥(ğ‘¡)
K Arias Calluari et al.: Preprint submitted to Elsevier

10 8

I(t)
s(t) cum

3500

d(t)

3000

cum

Inflection
2500
10 6
2000

I(t)

Cumulative

1500

10 4

1000

500

10 2

/20

/20

05
/04

/20

29
/03

/20

22
/03

/20

15
/03

/20

08
/03

/20

01
/03

/20

23
/02

/20

16
/02

/20

09
/02

02
/02

/20

0

26
/01

duced an extensive array of analyses in order to model the
spread, growth, peak, and ultimately the decline of the disease [24, 25, 26, 27, 28]. For countries like China, Japan,
Italy, and Iran, their epidemiological curve of COVID-19
progression displays a peak before the second month since
the first cases were detected [29, 30, 31]. In countries like
the UK, Australia and Germany, the governments have taken
mitigation measures to slow the impact [25, 24].The simultaneous reaction of governments, companies, consumers and
media, have created a demand and supply shock, making
COVID-19 a qualitatively different economic crisis than previous crises [32]. This economic â€˜wedgingâ€™ of falling supply
and demand is caused by rapidly escalating unemployment
decreasing consumer demand where, in the US for example, 17 million Americans have applied for unemployment
insurance in the first three weeks of the crisis [33], and businesses are closing their doors reducing the supply of manufactured goods across the globe [34]. As a consequence
financial markets around the world have fallen precipitously
and market volatility is at near-all-time highs [35]. For example the S&P500 has registered the worst one-day fall in
the last 24 years and the third biggest percentage loss in its
history.
In the uncertain environment of COVID-19 it is difficult to
forecast the fluctuations of the S&P500 index. We then need
assumptions such as the mortality rates due to COVID-19
or the duration of the current shutdown of economic activity. Our central assumption is based on a predicted peak for
COVID-19 deaths. Current results in Figure 1 based on the
daily World Health Organization reports [36] show that the
S&P500 responds to the inflection points of the cumulative
amount of deaths and confirmed cases with no lag. This fact
supports our assumption that when a peak number of deaths
occurs, the market reaches a stationary point.
We developed two cases to forecast the fluctuations of
the S&P 500. In the first case the peak number was located
on the 23rd of May by the University of Washington [37].
The second case is where the peak number of deaths is considered 2-months since the first death occurred [38]. After
this point we expect a recovery period as economic activity
starts to return to normal. To construct the forecast, we assume that the stock market index can be decomposed into
a deterministic trend and a stationary stochastic fluctuation.
The statistics of the fluctuation have been obtained by analyzing the S&P500 index during the 24 year period from
January 1996 to March 2020 [39]. ğ¼(ğ‘¡0 ) is the initial point
of the stock market index for some time point ğ‘¡0 , and the index ğ¼(ğ‘¡) for ğ‘¡ > ğ‘¡0 is its time evolution. In these predictions
we take ğ‘¡0 = 24âˆ•03âˆ•2020 and ğ‘¡0 = 28âˆ•02âˆ•2020 for the two
different forecast. The price return at time ğ‘¡ is defined by:

time(dd/mm/yy)

Figure 1: The S&P500 decreased after the WHO (World
Health Organization) reported an increment in confirmed
cases ğ‘ (ğ‘¡) and number of deaths ğ‘‘(ğ‘¡) due to COVID-19. The
increments in the number of cases are represented with a
black filled point, which are an abrupt change of slope of
the first derivative of ğ‘ (ğ‘¡)ğ‘ğ‘¢ğ‘š and ğ‘‘(ğ‘¡)ğ‘ğ‘¢ğ‘š .

ğ‘‹(ğ‘¡) = ğ‘‹(ğ‘¡) + ğ‘¥(ğ‘¡).

(2)

The trend ğ‘‹(ğ‘¡) was obtained by averaging the index over a
moving time window. The size of the window was one year,
that was optimized to guarantee that the fluctuations around
the trend exhibit stationary behavior. The governing equation of this stationary behaviour is [40]:
ğœ•ğ‘
ğœ• 2 ğ‘2âˆ’ğ‘
= ğœ‰ğ·
,
(3)
ğœ•ğ‘¡
ğœ•ğ‘¥2
By using a curve-fitting analysis on the S&P500 data over
the past 24 years (see Appendix), we show that the probability density function (PDF) of the detrended price is well
described by the functional form:
(
)
1
ğ‘¥
ğ‘(ğ‘¥, ğ‘¡) =
ğ‘”ğ‘
,
(4)
(ğ·ğ‘¡)1âˆ•ğ›¼
(ğ·ğ‘¡)1âˆ•ğ›¼
ğ‘¡1âˆ’ğœ‰

where ğ›¼ = 3âˆ’ğ‘
. Being ğ·, ğ‘ and ğ›¼ time-dependent fitting
ğœ‰
exponents which analysis is displayed in Figure A.8. The ğ‘”ğ‘
term is the ğ‘-Gaussian function defined as:
ğ‘”ğ‘ (ğ‘¥) =

1
ğ‘’ (âˆ’ğ‘¥2 )
ğ¶ğ‘ ğ‘

(5)
1

and the ğ‘-exponential function is ğ‘’ğ‘ (ğ‘¥) = [1 + (1 âˆ’ ğ‘)ğ‘¥] 1âˆ’ğ‘
that reduces to the exponential function when ğ‘ â†’ 1. The
normalization constant ğ¶ğ‘ for 1 < ğ‘ < 3 is given by:
âˆš
ğœ‹ Î“((3 âˆ’ ğ‘)âˆ•(2(ğ‘ âˆ’ 1)))
ğ¶ğ‘ =
.
(6)
ğ‘âˆ’1
Î“(1âˆ•(ğ‘ âˆ’ 1))
Page 2 of 9

Methods for forecasting the effect of exogenous risk on stock markets

3500

China retaliated US
imposed tariffs

3000

Trump's
tax reform

2500

I(t)

Trump elected
president

2000
The dot-com
bubble

Chinese
market
turbulence

Housing
boom peaks

1500

Brexit
referendum

SP500 float
adjustment
S&P E-mini
futures

1000

Russian
Crisis

H-K.
returned
to China

World
trade
centre
attacks

TARP passed
collapsed
Obama elected
president

COVID-19
outbreak
Trump
tweeted
"I am a
Tariff Man"

S&P downgrade
Greek

WorldCom's
bankruptcy

20
01/

01/

18
01/
01/

16
01/
01/

14
01/
01/

12
01/
01/

10
01/
01/

08
01/

01/

06
01/
01/

04
01/
01/

02
01/
01/

00
01/

01/

98
01/
01/

01/

01/

96

500

time(dd/mm/yy)

Figure 2: The S&P500 index ğ¼(ğ‘¡) from 02/01/96 to 24/03/20 (24 years). In this data set the largest daily percentage loss of
âˆ’11.98% was registered on 16/03/20. Some other key events are also shown for reference.
The cumulative distribution function (CDF) of the PDF Eq.(4)
of the detrended price return is;
ğ‘¥

ğ¹ (ğ‘¥, ğ‘¡) =

âˆ«âˆ’âˆ

(7)

ğ‘(ğ‘¥, ğ‘¡) ğ‘‘ğ‘¥.

The complementary of the CDF is used here to quantify risk
under extreme events [41]. This is defined as probability that
ğ‘‹ âˆ’ ğ‘‹ lies outside the interval [âˆ’ğ‘¥, ğ‘¥] is
ğ‘¥

ğ‘ƒ (ğ‘‹(ğ‘¡) âˆ’ ğ‘‹(ğ‘¡) > |ğ‘¥|) = 1 âˆ’

âˆ«âˆ’ğ‘¥

ğ‘(ğ‘¥, ğ‘¡) ğ‘‘ğ‘¥.

(8)

For this paper we introduce the standarization of the ğ‘-error
function
ğ‘¥

erf ğ‘ (ğ‘¥) = 2

âˆ«0

ğ‘”ğ‘ (ğ‘¦)ğ‘‘ğ‘¦

(9)

The standard error function is a special case of the ğ‘-error
function for ğ‘ = 1. Considering this definition, Eq.(8) is
written as:
ğ‘ƒ (ğ‘‹(ğ‘¡) âˆ’ ğ‘‹(ğ‘¡) > |ğ‘¥|) = 1 âˆ’ erf ğ‘ (ğ‘¥âˆ•(ğ·ğ‘¡)1âˆ•ğ›¼ ).

(10)

We use Eq.(10) to develop a forecast of the market based
on the historical fluctuations in the S&P500. Figure 2 shows
K Arias Calluari et al.: Preprint submitted to Elsevier

some key dates over the last 24 years of the S&P500. The
market dynamics consists of periods of a bull market (systematic increase of the index) and a bear market (systematic decrease). The crashes in this plot are discontinuous.
They occur in a very short period of time that we attribute
as noise that it is added to the deterministic component. For
example, during the Global Financial Crisis (GFC) there is
a long-term decline in the value of the S&P500 that we can
interpret as the deterministic trend, but near the point where
Lehman Brothers collapses there is a discontinuous market
crash. In fact, there are several very large daily price movements that are not always attributable to a specific event.
These â€˜crashesâ€™ (both up and down) are more similar to large
stochastic movements, not a part of the deterministic component of the market dynamics.

3. Effect of COVID-19 to S&P500
To establish the effect of COVID-19 on the market we
assume that it has a deterministic, exogenous impact. This
impact is assumed to be a response function that corresponds
to a COVID-19 induced bear market followed by a smooth
transition to a bull market. As a further refinement we asPage 3 of 9

Methods for forecasting the effect of exogenous risk on stock markets

Ìƒ ||
ğ¼(ğ‘¡)
= 0.
|
ğ‘‘ğ‘¡ ||ğ‘¡ +60 days
0

(11)

3400
3000
i.

2200

iii.
ii.

i*.

1400
1000

iii*.

600
120

100

80

60

40

20

0
03/
2

0
24/

0

03/
2
04/

02/
2
13/

01/
2

0

200

24/

I(t)

0.4

Zone B

0

Zone A

Crossover

0.2

Zone B

-0.2

-0.4

Zone C

Zone B

-0.6

-0.8

10 -2

10 -1

10 0

10 1

10 2

10 3

Figure 4: Three different zones were determined based on
an abrupt slope change of ğ›¼ and ğ‘ values. The circles represent the end points of the strong super-diffusion regime
(zone A) from ğ‘¡0 to ğ‘¡ = 35 minutes. The remaining area
during the first 35 minutes to 28 days corresponds to a weak
super-diffusion regime (zone B). A normal diffusion process
is reach after thirty days. The gray dashed lines represent the
transitions between each zones.

3800

1800

0.6

t (days)

4200

2600

0.8

x

sume that this transition is dictated by a key quantitative factor: the estimated date on which the mortality rate peaks.
Our first estimation of this trend (a private communication
between authors on April 2, 2020) was based on the timeframe from 31âˆ•01âˆ•2020 to 24âˆ•03âˆ•2020 in which a bearmarket decline in ğ¼(ğ‘¡) had already been observed. For the
Ìƒ the parabola and
construction of the deterministic trend ğ¼(ğ‘¡)
hyperbola functions were used. For the parabola three conditions were applied and are illustrated in Figure 3: (i) The
Ìƒ 0 ), (ii) the slope
initial point of the predicted trend at ğ‘¡0 is ğ¼(ğ‘¡
Ìƒ
of ğ¼(ğ‘¡) at ğ‘¡0 is obtained from a linear fitting during the interval 31âˆ•01âˆ•2020 to 24âˆ•03âˆ•2020, (iii) the point where the
recovery is predicted at 60 days satisfies ğ¼Ìƒâ€² (ğ‘¡0 +60 days) = 0,
i.e.

Time (days)
Figure 3: A downward trend followed by a market recovery
is estimated by applying a parabolic fitting (magenta line)
and hyperbola fitting (blue line). Three steps were applying
to define each deterministic trend. The step ii is the same for
both cases.
For the hyperbola three similar conditions were applied: The
slope of the market recovery (bull market) (iâˆ— ) is assume to
be 0.5 of the slope of the marketâ€™s collapse similar to the previous crashes that have occurred over the past 24-years. The
slope (ii) is the same as the parabola and point (iiiâˆ— ) is the
intersection of the slopes (iâˆ— ) and (ii). For both methods the
point (iii) was based on the public information available by
the University of Washington where the death rate was estimated to peak on 24/05/2020 (60 days from ğ‘¡0 )). To obtain
this prediction of the trend we assumed that there is no time
lag between the peak of mortality rate and the time where
the market starts to recover.
Up to this point we have evaluated the systemic risk as
the deterministic aspect of the market evolution, which is ofK Arias Calluari et al.: Preprint submitted to Elsevier

ten neglected by analysts in the determination of the impact
of exogenous events such as the COVID-19 pandemic. In
what follows we evaluate the risk associated with the stochastic fluctuations of the index by â€˜dressingâ€™ the deterministic
risk with a ğ‘-Gaussian diffusion process. In a previous publication [40] we found that the ğ‘-Gaussian fluctuations of
the S&P500 index around the trend have distinctive superdiffusion spatio-temporal regimes (â€˜spaceâ€™ refers to the size
of the fluctuations). To allow long-term forecasting on the
order of days, we have extended the analysis for longer times.
Three well-defined regimes are observed in Fig. 4,
â€¢ Zone A: Strong superdiffusion process with short-time
correlations
â€¢ Zone B: Weak superdiffusion process with weak time
correlations
â€¢ Zone C: Normal diffusion process with no time correlations.
These zones are well-distinguished in time, where Zone
A goes from 0 to 38 minutes, Zone B from 10 days to 28 days
and after a crossover period Zone C starts at 30 days (Fig. 4).
Note that the time series tends to a classical diffusion process
for large times, in agreement with the classical Central Limit
Theorem. See [40] for a complete analysis of these zones and
their derivation.
Two techniques were used to calculated the optimal ğ‘ for
each ğ‘(ğ‘¥, ğ‘¡), one focusing on the PDF and the other focusing
Page 4 of 9

Methods for forecasting the effect of exogenous risk on stock markets

on each CDF of detrended price return. For the first technique two methods were used. The least square method and
ğ‘-moments method. The least square method applies Eq.(4)
as the fitting function. The ğ‘-moments method uses a system of two equations and two variables, ğ‘ and ğ›¼. The first
equation is given by the â€œsecond moment" or variance âŸ¨ğ‘¥2 âŸ©.
The second equation refers to the â€œescort second moment"
or ğ‘-variance âŸ¨ğ‘¥2 âŸ©ğ‘2 . In general, the ğ‘-moments are applied
to PDFs with asymptotic decays because they provide finite
values [42]. The second technique is based on each CDF,
where a least squares method is applied using Eq.(18). The
quality of the fitting models was evaluated after reproducing
the time evolution of ğ¶ğ·ğ¹ (ğ‘¥, ğ‘¡) with the time-dependent fitting parameters previously obtained, then we compare them
with the ğ¶ğ·ğ¹ of detrended price return. The best results
were obtained with the second technique, which displays a
smoothness and more accurate time evolution of the ğ¶ğ·ğ¹
of detrended price (Figure 5).

ğ‘¡ â†’ âˆ.
Then, we construct a forecast of S&P500 using two predicted trends, the parabola and the hyperbola shown in Fig.6.
We note that these trends are approximations based upon the
prices for the following trading days. For that reason both
trends were re-calculated using ğ‘¡0 = 28âˆ•02âˆ•2020; the date
on which the first death occurred in USA; and ğ¼Ìƒâ€² (60) = 0;
two months after the first case was confirmed. These new
trends display a better performance, notably the hyperbola
which fits better than the others.
The uncertainty was modeled with the analytical form
of the detrended price by replacing the ğ›¼(ğ‘¡), ğ‘(ğ‘¡), and ğ·(ğ‘¡)
calculated in the Appendix into Eq.(4) with their numerical
estimates. Once the stochastic term is simulated it is added
into the deterministic trend to see the full stochastic path of
ğ¼(ğ‘¡).
4200
3800
3400
3000

I(t)

2600
2200
1800
1400
1000

/20
/08

/20

11

/07

/20

22

/07

/20

02

/06

/20

12

/20

/05
23

/20

/05
03

/20

/04
13

/20

/03

/03

24

/20
/02

04

/20

13

/01
24

04

/01

/20

600

Time (days)

Figure 5: Comparison of time evolutions of ğ¶ğ·ğ¹ ğ‘  between
the price return of detrended stock market data and the analytical model which considers the time-dependent fitting parameter obtained from the second technique.
We extend the analysis of this derivation in the supplementary materials section.
The corresponding ğ‘, ğ›¼ and ğ· values that fit each of these
equations are displayed in Fig.A.8(a-c-d). The ğ‘ and ğ›½ values were calculated directly after fitting Eq.(18). The ğ›¼ values are calculated as the power law of the ğ›½ value, by averaging the power law over a moving time window smaller than
the transition zone. The ğ· value is calculated by replacing ğ›¼
in Eq.(16). The results for ğ‘, ğ›¼ and ğ· obtained by applying
the least squares method of the CDFs are consistent with the
ones calculated focused on the PDFs. The convergence of
ğ‘ â†’ 1 and ğ›¼ â†’ 2 shows that the PDF of ğ‘¥ is Gaussian when
K Arias Calluari et al.: Preprint submitted to Elsevier

Figure 6: The decline and recovery on four different trends
due to COVID-19 are observed. The first forecast method
considers ğ‘¡0 = 24âˆ•03âˆ•2020 and the second one ğ‘¡0 =
28âˆ•02âˆ•2020. For both cases a parabola and hyperbola fitting was used, considering the method previously illustrated
in Fig. 3. The hyperbola method with ğ‘¡0 = 28âˆ•02âˆ•2020
displays the most accurate result at the moment.
Figure 7 shows the forecast result identifying the range
of possibilities during the marketâ€™s decline and subsequent
recovery. The predicted trend was plotted as a hyperbola
with ğ‘¡0 = 28âˆ•02âˆ•2020 (Figure 6). The uncertainty is presented by a shaded contour plot with a scale from 0 to 1.
These values represent the probability of a possible variation of ğ‘ƒ (ğ‘‹ âˆ’ ğ‘‹ > |ğ‘¥|) which can be visualized as a â€œcone
of uncertaintyâ€. This probabilistic path of the S&P500 over
the following 60 days (2 months) shows the evolution of the
PDF of ğ¼(ğ‘¡), which diffuses as ğ‘¡ increases. Also we see that
the real data for index after ğ‘¡0 (the dashed line) lies within a
Page 5 of 9

Methods for forecasting the effect of exogenous risk on stock markets

be developed by formulating the governing equations that
allows transition from strong- to weak- superdiffusion and
converging to a normal diffusion process for large times, as
dictated by the classical Central Limit Theorem. However,
this method opens up a potential opportunity for risk control
in other areas such as climatology, seismology (earthquakes)
and communication networks, where large multivariate data
sets provide a window on the dynamics of the underlying
system.

5. ACKNOWLEDGMENTS
We acknowledge the Australian Research Council grant
DP170102927. K.A.C. thanks The Sydney Informatics Hub
at The University of Sydney for providing access to HPCArtemis for financial data processing. We thanks Sornette,
Constantino Tsallis and Christian Beck for inspiring discussions.

References
Figure 7: The decline and recovery on ğ¼(ğ‘¡) due to COVID19 is observed from 28âˆ•02âˆ•20 to the following 2 months. A
downward and upward market predicted trend is calculated
by applying a hyperbolic fitting with no time lag. The uncertainty is represented by a scale from 0 to 1, where represent
the ğ‘ƒ (ğ‘‹ âˆ’ ğ‘‹ > |ğ‘¥|) of each contour line. The economy will
start its recovery after this epidemic peak of deaths
tiny interval in the vicinity of the predicted trend, mainly in
the most probable (dark) regions, verifying that our model is
working and is reliable for forecasting with 85% of accuracy.
We construct a forecasting based on essential public information provided by the University of Washington on their
web page[36]. A good forecasting is always an iterative process that can be daily updated considering new factors and
changes.

4. Conclusions
In summary, we have presented a model of the stochastic
and systematic risk in the stock market and applied it to forecast the stock market response to COVID-19. We have assumed that the stochastic risk is a ğ‘-Gaussian diffusion process. The systemic risk is the deterministic aspect of the market evolution that is often neglected by market analysts but
here we have assumed that COVID-19 has a deterministic,
exogenous impact on the market. We have dressed this nonlinear skeleton with a ğ‘-Gaussian diffusion process that we
developed in previous work. The response function we have
used for forecasting is a simple behavioural model based on
the assumption that markets recover once prices drop to sufficiently low enough levels, in future work it can be improved
by developing better tools to evaluate systematic risk using
behavioural [43] or macroeconomic [44] models. In addition, our stochastic method is still heuristic and it needs to
K Arias Calluari et al.: Preprint submitted to Elsevier

[1] K. Anand, J. Khedair and R. KÃ¼hn, Physical Review E, 2018, 97,
052312.
[2] F. Patzelt and J.-P. Bouchaud, Physical Review E, 2018, 97, 012304.
[3] A. M. Puertas, M. A. SÃ¡nchez-Granero, J. Clara-Rahola, J. E.
Trinidad-Segovia and F. J. de las Nieves, Physical Review E, 2020,
101, 032307 .
[4] J.-E. Molina-MuÃ±oz, A. Mora-Valencia and J. Perote, Physica A: Statistical Mechanics and its Applications, 2020, 124876.
[5] D. H. Wolpert, M. HarrÃ©, E. Olbrich, N. Bertschinger and J. Jost,
Physical Review E, 2012, 85, 036102.
[6] M. S. HarrÃ© and T. Bossomaier, Entropy, 2014, 16, 5102â€“5121 .
[7] N. Chen, X. Jin, X. Zhuang and Y. Yuan, Physica A: Statistical Mechanics and its Applications, 2019, 123897.
[8] M. Denys, T. Gubiec, R. Kutner, M. Jagielski and H. E. Stanley, Physical Review E, 2016, 94, 042305.
[9] D. Valenti, G. Fazio and B. Spagnolo, Physical Review E, 2018, 97,
062307.
[10] R. Chowdhury, M. Mahdy, T. N. Alam, G. D. Al Quaderi and M. A.
Rahman, Physica A: Statistical Mechanics and its Applications, 2020,
124444.
[11] M. Garcia, A. M. Pereira, J. Acebal and A. B. de MagalhÃ£es, Physica
A: Statistical Mechanics and its Applications, 2020, 124365.
[12] C. Kuyyamudi, A. S. Chakrabarti and S. Sinha, Physical Review E,
2019, 99, 052306.
[13] D.-T. Hoang, J. Jo and V. Periwal, Physical Review E, 2019, 99,
042114 .
[14] J.-P. Onnela, A. Chakraborti, K. Kaski and J. Kertesz, Physica A: Statistical Mechanics and its Applications, 2003, 324, 247â€“252.
[15] M. HarrÃ©, Proceedings of the International Conference on Social
Modeling and Simulation, plus Econophysics Colloquium 2014,
2015, pp. 15â€“25.
[16] O. Deev and Å . LyÃ³csa, Physica A: Statistical Mechanics and its Applications, 2020, 124035.
[17] L. Chen, Q. Han, Z. Qiao and H. E. Stanley, Physica A: Statistical
Mechanics and its Applications, 2020, 542, 122653.
[18] C. H. Hommes, Financial markets as nonlinear adaptive evolutionary
systems, Taylor & Francis, 2001.
[19] C. Feng, J. Tan, Z. Jiang and S. Chen, Physica A: Statistical Mechanics and its Applications, 2020, 545, 123797.
[20] T. M. Lenton, Nature Climate Change, 2011, 1, 201â€“209.
[21] D. Sornette, in Extreme events in nature and society, Springer, 2006,
pp. 95â€“119.
[22] M. HarrÃ© and T. Bossomaier, EPL (Europhysics Letters), 2009, 87,
18009 .

Page 6 of 9

Methods for forecasting the effect of exogenous risk on stock markets
[23] G. Buccheri, S. Marmi and R. N. Mantegna, Physical Review E, 2013,
88, 012806.
[24] R. M. Anderson, H. Heesterbeek, D. Klinkenberg and T. D.
Hollingsworth, The Lancet, 2020, 395, 931â€“934.
[25] S. L. Chang, N. Harding, C. Zachreson, O. M. Cliff and
M. Prokopenko, arXiv preprint arXiv:2003.10218, 2020.
[26] R. A. Neher, R. Dyrdak, V. Druelle, E. B. Hodcroft and J. Albert,
Swiss Medical Weekly, 2020, 150, year.
[27] C. Li, L. J. Chen, X. Chen, M. Zhang, C. P. Pang and H. Chen, Eurosurveillance, 2020, 25, year.
[28] S. Luding, A simple qualitative multi-scale corona model (a report),
2020.
[29] V. Surveillances, China CDC Weekly, 2020, 2, 113â€“122.
[30] D. Fanelli and F. Piazza, Chaos, Solitons & Fractals, 2020, 134,
109761.
[31] M. Abdi, Infection Control & Hospital Epidemiology, 2020, 1â€“5.
[32] N. Fernandes, Economic effects of coronavirus outbreak (COVID-19)
on the world economy, 2020.
[33] S. Chaney and D. Harrison, U.S. Jobless Claims Soar for Third
Straight Week, 2020, https://www.wsj.com/articles/u- s- surge- i
n-unemployment-claims-expected-to-continue-11586424605.
[34] S. Donnan, C. Rauwald, J. Deaux and I. King, A Covid-19 Supply
Chain Shock Born in China Is Going Global, 2020, https://www.bloo
mberg.com/news/articles/2020-03-20/a-covid-19-supply-chain-sho
ck-born-in-china-is-going-global.

[35] W. Watts, Coronavirus stock-market volatility is creating the largest
daily price swings since 1929 crash, 2020, https://www.marketwatch.
com/story/stock-market-investors-have-to-go-back-to-1929-to-fi
nd-daily-swings-this-wild-2020-04-07.

[36] W. H. Organization, Coronavirus disease (COVID-2019) situation reports, 2020, https://www.who.int/emergencies/diseases/novel-coron
avirus-2019/situation-reports.
[37] T. I. for Health Metrics and E. (IHME), COVID-19 Projections, 2020,
http://www.healthdata.org/covid/data-downloads.
[38] C.-C. Lai, T.-P. Shih, W.-C. Ko, H.-J. Tang and P.-R. Hsueh, International journal of antimicrobial agents, 2020, 105924.
[39] K. Arias-Calluari, M. Najafi, M. S. HarrÃ©, F. Alonso-Marroquin et al.,
arXiv preprint arXiv:1910.01034, 2019.
[40] F. Alonso-Marroquin, K. Arias-Calluari, M. HarrÃ©, M. N. Najafi and
H. J. Herrmann, Physical Review E, 2019, 99, 062313.
[41] M. Haas and C. Pigorsch, Encyclopedia of Complexity and Systems
Science, 2009, 4, 3404â€“3435.
[42] C. Tsallis, A. R. Plastino and R. F. Alvarez-Estrada, Journal of Mathematical Physics, 2009, 50, 043303.
[43] S. Bikhchandani and S. Sharma, IMF Staff papers, 2000, 47, 279â€“310.
[44] M. Gertler, N. Kiyotaki and A. Prestipino, in Handbook of Macroeconomics, Elsevier, 2016, vol. 2, pp. 1345â€“1425.

A. Supplementary materials
The probability density function (PDF) of the detrended
price is well described by the functional form:
(âˆš )
âˆš
ğ‘(ğ‘¥, ğ‘¡) = ğ›½ ğ‘”ğ‘
ğ›½ğ‘¥ ,
(12)
where, ğ›½ = (ğ·ğ‘¡)âˆ’2âˆ•ğ›¼ , allows to recovery Eq.(4).
Then, a system of two equations based on variance âŸ¨ğ‘¥2 âŸ©
and ğ‘-variance âŸ¨ğ‘¥2 âŸ©ğ‘2 were used to obtain the ğ‘ and ğ›½ values.
The variance âŸ¨ğ‘¥2 âŸ© has a finite value for ğ‘ < 5âˆ•3;
âŸ¨ğ‘¥2 âŸ© =

1
.
ğ›½(5 âˆ’ 3ğ‘)

(13)

The normalized ğ‘-variance âŸ¨ğ‘¥2 âŸ©ğ‘ is defined as [42]
âŸ¨ğ‘¥ âŸ©ğ‘ =

âˆ«âˆ’âˆ ğ‘¥2 ğ‘(ğ‘¥, ğ‘¡)ğ‘ ğ‘‘ğ‘¥
âˆ

âˆ«âˆ’âˆ ğ‘(ğ‘¥, ğ‘¡)ğ‘ ğ‘‘ğ‘¥

,

K Arias Calluari et al.: Preprint submitted to Elsevier

1
ğ¶ğ‘
ğ¾(ğ›½, ğ‘) â‰¡
[1 âˆ’ (1 âˆ’ ğ‘)ğ›½ğ‘¥ ] 1 âˆ’ ğ‘ ğ‘‘ğ‘¥ = âˆš ,
âˆ«âˆ’âˆ
ğ›½
âˆ

2

and also the second moment of ğ‘¥ is proportional to ğœ•ğ›½ğ¾(ğ›½, ğ‘),
so the analytical solution of the numerator is:
ğ‘
âˆ
ğœ•
2
2 1âˆ’ğ‘
ğ¾(ğ›½, ğ‘) = âˆ’
ğ‘¥ [1 âˆ’ (1 âˆ’ ğ‘)ğ›½ğ‘¥ ]
ğ‘‘ğ‘¥
âˆ«âˆ’âˆ
ğœ•ğ›½
1
= âˆ’ ğ›½ âˆ’3âˆ•2 ğ¶ğ‘
2
Then, the analytical solution of the denominator is:
âˆ

âˆ«âˆ’âˆ

ğ‘(ğ‘¥, ğ‘¡)ğ‘ ğ‘‘ğ‘¥ =

3âˆ’ğ‘
2

Inserting this identity into the Eq.(14), we obtain:
âŸ¨ğ‘¥2 âŸ©ğ‘2 =

1
.
(3 âˆ’ ğ‘)ğ›½

(15)

The equation system is defined by Eqs(13) and (15) and is
used to calculate ğ›½ and ğ‘ as a function of time. The ğ›¼ and ğ·
values are calculated using:
(16)

ğ›½ = (ğ·ğ‘¡)âˆ’2âˆ•ğ›¼

We divide the data of S&P500 in overlapping time windows
not longer than the transition zones. In each window the
exponent of the power law relation is calculated and then
the Eq.(16) is used to calculate ğ· and ğ›¼. The results for ğ‘,ğ›¼
and ğ›½ are shown in Subfigures a-1,b-1,c-1 and d-1.
In Subfigure a-1 an abrupt transition in ğ‘ is noticed when
ğ‘¡ = 30 days. This abrupt change leads to a discontinuity in
the fitted function ğ‘(ğ‘¡).
We have used an alternative method to extract the parameters, for which this discontinuity is absent. This method is
based on the fitting of the ğ¹ (ğ‘¥, ğ‘¡) of real price return ğ‘¥. The
analytical expression of ğ¹ (ğ‘¥, ğ‘¡) is obtained in terms of the
erf ğ‘ (ğ‘¥, ğ‘¡). First, Eq.(7) is replaced in Eq.(8),
ğ‘ƒ (ğ‘‹(ğ‘¡) âˆ’ ğ‘‹(ğ‘¡) > |ğ‘¥|) = 2 âˆ’ 2ğ¹ (ğ‘¥, ğ‘¡).

(17)

Then,
âˆš Eq.(17) and Eq.(10) are compared, resulting to
(ğ‘  = ğ‘¥ ğ›½);
ğ¹ (ğ‘¥, ğ‘¡) = 0.5 +

erf ğ‘ (ğ‘ )
2

(18)

Where,

âˆ

2

In general, the q-moments are calculated on PDFs with heavy
tails because they provide finite values. The q-moments and
the standard moments are equal for ğ‘ = 1.
To obtain the analytical solution of the integral in the
numerator and denominator of Eq.( 14), we notice that

(14)

âˆš
[
]
2 ğ›½
1 1 3
2
erf ğ‘ (ğ‘ ) =
ğ‘¥ 2 ğ¹1 ,
, , (1 âˆ’ ğ‘)ğ‘  . (19)
ğ¶ğ‘
2 ğ‘âˆ’1 2
Page 7 of 9

1.2

1.8

a-1

a-2

1.7

Methods for forecasting the effect of exogenous risk on stock markets

1

1.6
1.5

0.8

1.4
0.6
1.3
0.4

1.2

0.2

1.1
1

0
0

10 2

0.5

1

10 2

b-1
Zone B

(t)

10 -2

1.5

Zone B

10 -2

10 -2

10 -4

10 -4

10 -1

10 0

10 1

10 2

10 3

Zone C

0

10

10 -2

10 2

b-2

Zone C

10 0

10 -6
10 -3

10 0

10 -6
10 -3

10 -2

10 -1

10 0

10 1

10 2

10 3

t(days)
2.1

c-1

2

2

1.9

1.9

(t)

(t)

2.1

1.8

1.8

1.7

1.7

1.6

1.6

1.5

c-2

1.5
0 10

40

70

100

140

0

20

40

t(days)
0.5

80

100

120

140

100

120

140

d-2

d-1

0.5

0.4

D(t)

0.4

D(t)

60

t(days)

0.3

0.3

0.2

0.2

0.1

0.1
20

40

60

80

100

120

t(days)

140

20

40

60

80

t(days)

Figure A.8: Calculation of ğ‘ and ğ›½ by applying a Equation system [Eqs(13) and (15)] and fittings of ğ¹ (ğ‘¥, ğ‘¡). (a-1, a-2)
Estimation of ğ‘(ğ‘¡) value, for (a-1) a normalization of units was made. (b-1,b-2) The value of ğ›½ âˆ¼ ğ‘¡âˆ’2âˆ•ğ›¼ . (c-1,c-2) The
exponent of the power law relation of ğ›½ vs ğ‘¡ per time window is calculated as ğ›¼(ğ‘¡). (d-1,d-2) The ğ· value is calculated by
replacing ğ›¼ in Eq.(16). The convergence to a Normal distribution function is observed when ğ‘¡ â†’ âˆ with ğ‘ = 1 and ğ›¼ = 2.
(coefficients are in Table 1)
K Arias Calluari et al.: Preprint submitted to Elsevier

Page 8 of 9

Methods for forecasting the effect of exogenous risk on stock markets

ğ‘

ğ›½

ğ›¼

ğ·

Fitting ğ‘(ğ‘¥, ğ‘¡)
ğ‘ = 0.556 Â± 0.012
ğ‘ = 1.485 Â± 0.041
ğ‘1 = 0.009 Â± 3.09(10)âˆ’4 ğ‘š1 = âˆ’1.23 Â± 0.01
ğ‘2 = 0.008 Â± 3.5(10)âˆ’5 ğ‘š2 = âˆ’1.10 Â± 0.01
ğ‘3 = 0.010 Â± 2.66(10)âˆ’4 ğ‘š3 = âˆ’1.06 Â± 0.02
ğ‘1 = 0.027 Â± 0.001 ğ‘1 = 1.620 Â± 0.003
ğ‘2 = 0.004 Â± 0.002 ğ‘2 = 1.839 Â± 0.009
ğ‘3 = 2.00 Â± 0.000
ğ‘1 = 0.008 Â± 0.015 ğ‘1 = 0.130 Â± 0.002
ğ‘2 = âˆ’0.001 Â± 7.14(10)âˆ’5 ğ‘2 = 0.445 Â± 0.004

Fitting ğ¹ (ğ‘¥, ğ‘¡)
ğ‘ = 0.005 Â± 0.001
ğ‘ = 2.473 Â± 0.158
ğ‘ = 1.811 Â± 0.031
ğ‘1 = 0.010 Â± 3.5(10)âˆ’5 ğ‘š1 = âˆ’1.32 Â± 0.01
ğ‘2 = 0.003 Â± 7.5(10)âˆ’4 ğ‘š2 = âˆ’1.23 Â± 0.05
ğ‘3 = 0.007 Â± 8.77(10)âˆ’4 ğ‘š3 = âˆ’0.97 Â± 0.01
ğ‘1 = 0.035 Â± 0.001 ğ‘1 = 1.553 Â± 0.002
ğ‘2 = 0.008 Â± 0.001 ğ‘2 = 1.831 Â± 0.007
ğ‘3 = 2.00 Â± 0.000
ğ‘1 = 0.022 Â± 0.010 ğ‘1 = 0.098 Â± 0.001
ğ‘3 = 2.308(10)âˆ’6 Â± 0.765(10)âˆ’7
ğ‘2 = âˆ’3.30(10)âˆ’4 Â± 1.00(10)âˆ’5
ğ‘1 = 0.012 Â± 0.005 ğ‘0 = 0.363 Â± 0.072
ğ‘2 = âˆ’0.002 Â± 6.85(10)âˆ’5 ğ‘2 = 0.525 Â± 0.007

Table 1: Coefficients values of fittings
The Eq.(18) is used to calculate ğ‘ and ğ›½ value as a function
of time. The ğ›¼ values are calculated again with Eq.(16) by
overlapping time windows, and then, ğ· is obtained by replacing ğ›¼ in 16.
These results are shown in the second column of Figure A.8.
The Subfigure (a-2) does not display an abrupt transition of
ğ‘ value. For ğ›½, ğ›¼ and ğ· the transitions are smooth in each
zone.

K Arias Calluari et al.: Preprint submitted to Elsevier

Page 9 of 9

