Impact of Pre-symptomatic Transmission on Epidemic Spreading in Contact
Networks:
A Dynamic Message-passing Analysis
Bo Li1, ‚àó and David Saad1, ‚Ä†

arXiv:2010.14598v3 [physics.soc-ph] 6 May 2021

1

Non-linearity and Complexity Research Group, Aston University, Birmingham, B4 7ET, United Kingdom
Infectious diseases that incorporate pre-symptomatic transmission are challenging to monitor,
model, predict and contain. We address this scenario by studying a variant of a stochastic
susceptible-exposed-infected-recovered model on arbitrary network instances using an analytical
framework based on the method of dynamic message-passing. This framework provides a good
estimate of the probabilistic evolution of the spread on both static and contact networks, offering a significantly improved accuracy with respect to individual-based mean-field approaches while
requiring a much lower computational cost compared to numerical simulations. It facilitates the
derivation of epidemic thresholds, which are phase boundaries separating parameter regimes where
infections can be effectively contained from those where they cannot. These have clear implications
on different containment strategies through topological (reducing contacts) and infection parameter
changes (e.g., social distancing and wearing face masks), with relevance to the recent COVID-19
pandemic.

I.

INTRODUCTION

Rapid spreading of infectious diseases has had a devastating impact on societies throughout human history but
has become more critical in modern society due to dense
population in urban areas and the increase in human
mobility facilitated by global transportation networks.
A recent threat is the spread of the COVID-19 disease
caused by the SARS-CoV-2 virus, which has led to a pandemic with severe impact on public health and the global
economy. One prominent feature of this disease is that
the presymptomatic and asymptomatic viral carriers can
spread the disease as well, which poses a big challenge
to contact tracing and disease containment [1‚Äì4]. Therefore, it is crucial to understand the signiÔ¨Åcance of these
undetected transmissions and estimate their impact. Of
particular importance are parameter regimes where preand asymptomatic infections result in a complete breakdown of our ability to identify infected individuals and
contain the spread.
Numerous studies that investigate the spread of the
COVID-19 disease aim at predicting the causes of the
spreading processes and examine the eÔ¨Äectiveness of nonpharmaceutical intervention strategies [5‚Äì7]. It is common to model the evolution of the population mass of
each group (e.g., susceptible, exposed, infected, and recovered) by deterministic diÔ¨Äerential equations [4, 5, 8].
While being simplistic and tractable, such a method assumes homogeneous mixing of the population (in a city or
within an age group) and neglects the social contact network structures of the speciÔ¨Åc instance investigated [9].
Large scale agent-based simulations are also widely used,
which provide a more detailed picture of the spreading
processes but are very computationally demanding and

‚àó
‚Ä†

b.li10@aston.ac.uk
d.saad@aston.ac.uk

suÔ¨Äer from a lack of principled understanding [10‚Äì13]. To
obtain a reliable statistical description of the process, one
has to increase the number of samples signiÔ¨Åcantly as the
system size increases, which makes the computation prohibitive for large systems. Analytical treatments to the
epidemic spreading processes on heterogeneous contact
networks are valuable both in providing solutions in speciÔ¨Åc instances and in exploring the typical macroscopic
behavior of an ensemble of systems with similar characteristics; the latter also results in generic and intuitive
understanding.
In this paper, we analyze diseases spreading with
presymptomatic transmission such as COVID-19 by
studying a variant of stochastic susceptible-exposedinfected-recovered (SEIR) model on contact networks, in
which nodes in exposed states can also spread the disease without showing symptoms. For simplicity, the contact networks are viewed as static, serving as substrates
on which the disease spreads. We derive the dynamic
message-passing (DMP) equations for this model, which
provide a good approximation to the complex stochastic
spreading dynamics on general networks and facilitates
theoretical analyses [14‚Äì18]. Based on this framework,
we derive the epidemic thresholds and their dependence
on diÔ¨Äerent intervention methods. The emphasis of this
paper is to provide a more accurate description of the
complex spreading dynamics through DMP to obtain a
more intuitive physical picture and to clarify the eÔ¨Äects
of some containment strategies.
The remainder of the paper is organized as follows. We
introduce the SEIR model in Sec. II, and derive the dynamical equations in Sec. III. We then perform a linear
stability analysis of the dynamical equations in Sec. IV,
based on which the epidemic thresholds are obtained and
analyzed in Sec. V. In Sec. VII, we show that nonbacktracking centrality can be used to predict the outbreak
proÔ¨Åle. In Sec. VIII, we investigate the eÔ¨Äects of reducing contacts on slowing down the spread of the disease.

2
Finally, we summarize our Ô¨Åndings and discuss some limitations and outlook.
II.

THE MODEL

The contact network is represented by a graph G(V, E),
where V is the set of nodes and E is the set of edges. We
assume that the network has only one connected component. Each individual resides on a node, assuming one
of four states, susceptible (S), exposed (E), infected (I)
and recovered (R) at any particular time step. We assume that a node in the exposed state has contracted the
disease but has not developed symptoms yet. Unlike the
usual SEIR model [19], the exposed nodes can also spread
the disease. The dynamical process of the modiÔ¨Åed SEIR
model in discrete time is deÔ¨Åned in the form of transition
probabilities of states of neighboring nodes (say i and j)
and the state evolution of an individual node i,
Œ±ji

S(i) + E(j) ‚àí‚àí‚Üí E(i) + E(j),

(1)

S(i) + I(j) ‚àí‚àí‚Üí E(i) + I(j),

(2)

Œ≤ji

ŒΩi

E(i) ‚àí‚Üí I(i),

(3)

I(i) ‚àí‚Üí R(i),

(4)

¬µi

where Œ±ji (Œ≤ji ) is the probability that node j being in the
exposed(infected) state transmits the disease to its susceptible neighboring node i at a certain time step. We
assume that each time step corresponds to one day, keeping in mind that a Ô¨Åner time scale can also be considered.
At each time step, an existing exposed node i becomes
infected (i.e., develops symptoms) with probability ŒΩi ,
while an existing infected node i recovers with probability ¬µi . Therefore, the average periods of incubation and
recovery are 1/ŒΩi and 1/¬µi , respectively. At a certain
time step, the symptom-development and recovery processes are assumed to occur after possible transmission
activities. Since we will contrast the properties of the
SEIR and SIR models, we also introduce the transition
probabilities of the latter,
Œ≤ji

S(i) + I(j) ‚àí‚àí‚Üí I(i) + I(j),

(5)

I(i) ‚àí‚Üí R(i),

(6)

¬µi

which has been widely studied in the literature [9]. We
remark that both models are Markovian processes, implying an exponential distribution for both symptomdevelopment and recovery times, which may not be fully
realistic for many diseases including COVID-19 [9, 20].
Nevertheless, they both represent relevant models that
provide insights, oÔ¨Äer an approximate and eÔ¨Äective description of the spreading process and are amenable to
analysis.
The epidemiological parameters depend on the nature
of the disease and the intervention strategies being imposed; they are usually estimated based on observations

and can be subject to a high degree of uncertainty. As
for COVID-19, the average incubation period is about
5.2 days [3, 21]. Infectiousness is estimated to start
from 2.3 days before the onset of symptoms [3], while
it is argued [22] that infectiousness can start much earlier (one needs to look back at 5 days to catch 97% of
presymptomatic infections). The time needed for the
symptoms to disappear depends on disease severity of
the patient. In Ref. [3], it is inferred that infectiousness declines rapidly within 7 days. In [23], it is found
(from patients with mostly mild COVID-19) that viral
subgenomic RNA, which provide evidence of replicative
intermediates of the virus, were detectable up to 8 days
after the onset of symptoms. In this paper, we deÔ¨Åne
the recovered (R) state where the exposed and/or infected individual eÔ¨Äectively looses infectiousness, irrespective of whether the symptoms persist or not. Therefore, an infected individual who has been put into isolation and can no longer infect others is also categorized to
be in state R. To address the COVID-19 disease, we set
ŒΩi = 1/5, ¬µi = 1/8 according to these previous Ô¨Åndings.
The transmission probabilities Œ±ji , Œ≤ji are more diÔ¨Écult to estimate. Based on estimates from previous studies [2], we set Œ±ji = Œ≤ji /2 in some experiments but will
also consider other parameter combinations in establishing the epidemic thresholds phase diagram. For simplicity, we also assume that the parameters are homogeneous,
i.e., Œ±ij = Œ±, Œ≤ij = Œ≤, ŒΩi = ŒΩ, ¬µi = ¬µ, while any infection
and/or recovery parameter distributions can also be accommodated. Various intervention strategies have diÔ¨Äerent impacts on these epidemiological parameters.
Our model can be easily extended to accommodate
other aspects of disease modeling. Some studies report cases where infected individuals remain asymptomatic throughout the course of the infection; however,
these cases seem to have a much lower secondary attack
rate [24, 25]. To keep the analysis simple, we do not
consider asymptomatic individuals who do not become
infected prior to recovery but brieÔ¨Çy discuss how the
frameworks used could accommodate such cases in Appendix B. We also discuss the extension to a model with
an additional compartment where the exposed individual
is non-contagious for a period of time, and derive the corresponding DMP equations in Appendix C. Despite the
simplicity assumptions made, the proposed SEIR model
captures the essential characteristics of presymptomatic
transmission and constitutes an eÔ¨Äective approximation
of the realistic spreading dynamics.

III.
A.

THEORETICAL FRAMEWORKS

Individual-Based Mean-Field Approach

Since the exact solutions of the stochastic spreading
processes Eqs. (1)-(4) are diÔ¨Écult to obtain, various approximation methods have been developed to tackle such
complex dynamics [9]. A simple method is the individual-

3
based mean-Ô¨Åeld (IBMF) approach [9, 26], which expresses the evolution of the marginal distribution PœÉi (t)
that each node i belongs to state œÉ by assuming the independence on the probabilities of neighboring nodes.
Consider the SEIR model deÔ¨Åned in Sec. II. For node i
being in the susceptible state S, it will remain in state S
in the next time step if none of its neighbors transmits an
infection signal to node Q
i. In the
 IBMF framework, this

occurs with probability k‚àà‚àÇi 1 ‚àí Œ±ki PEk (t) ‚àí Œ≤ki PIk (t) ,
where ‚àÇi denotes the set of nodes adjacent to node i.
Therefore the evolution of the marginal probability node
i in state S is given by
PSi (t + 1) = PSi (t)

Y

k‚àà‚àÇi


1 ‚àí Œ±ki PEk (t) ‚àí Œ≤ki PIk (t) . (7)

The probability of node i in the exposed state E increases
if there is an infection signal from its neighbors, while it
decreases with rate ŒΩi (probability of transforming into
state I) as infection symptoms appear. The corresponding IBMF dynamical equation is
PEi (t + 1) =(1 ‚àí ŒΩi )PEi (t)


Y

i
k
k
+PS (t) 1 ‚àí
1 ‚àí Œ±ki PE (t) ‚àí Œ≤ki PI (t) , (8)
k‚àà‚àÇi

Similarly, the evolution of

PIi (t)

and

PRi (t)

are given by

PIi (t + 1) =(1 ‚àí ¬µi )PIi (t) + ŒΩi PEi (t),

PRi (t

+ 1)

=PRi (t)

+

¬µi PIi (t).

(9)
(10)

This approach has been used to investigate similar
models addressing the COVID-19 pandemic [27, 28].
However, the drastic simpliÔ¨Åcation based on the independence assumption of probabilities may lead to large
approximation errors [26]. One source of errors comes
from the mutual infection eÔ¨Äect due to this decorrelation
assumption [17, 29]. For instance, suppose that a node
i, having probability PEi (t) in the exposed state, infects
its susceptible neighboring node k at time t, then node
k can also reinfect node i at time t + 1 with some probability, which is an artifact of neglecting the correlation
between nodes i and k. Such eÔ¨Äects need to be correctly
accounted for to improve accuracy.
B.

Dynamic Message-passing Approach

The dynamic message-passing approach, an algorithm
that originates from the statistical physics literature [14‚Äì
16] avoids the mutual infection eÔ¨Äect by considering the
irreversible complete trajectories of the system. Formally, the DMP equations can be derived from the belief
propagation equations of dynamical trajectories, which is
especially useful when the correct set of dynamical variables are diÔ¨Écult to determine straightforwardly [16, 30].

In this section, we provide an intuitive derivation of the
DMP equations of the SEIR model, while we give the
more formal derivation based on belief propagation in
Appendix A.
Similar to the IBMF approach, the DMP method aims
at deriving the evolution of the marginal distributions.
Consider the marginal probability PSi (t) of node i being
at state S at time t, it is given by
Y
PSi (t) = PSi (0)
Œ∏k‚Üíi (t),
(11)
k‚àà‚àÇi

where Œ∏k‚Üíi (t) is the probability that node i has not contracted the disease from node k up to time t. We have
made the assumption that the probability which node i
has not contracted the
Q disease from its neighbors up to
time t factorizes as k‚àà‚àÇi Œ∏k‚Üíi (t). This assumption is
valid in tree graphs but constitutes a good approximation in many loopy networks [16].
The message Œ∏k‚Üíi decreases if node k transmits the
infection signal to node i, which occurs with probability
Œ±ki if node k is in state E or with probability Œ≤ki if node
k is in state I. Therefore, it follows the update rule
Œ∏k‚Üíi (t + 1) =Œ∏k‚Üíi (t) ‚àí Œ±ki œà k‚Üíi (t) ‚àí Œ≤ki œÜk‚Üíi (t), (12)
where œà k‚Üíi (t) is the probability that k is in state E but
has not transmitted the infection signal to node i, and
œÜk‚Üíi (t) is the cavity probability (on a graph where node
i is absent - a cavity) that k is in state I but has not
transmitted the infection signal to node i up to time t.
The message œÜk‚Üíi decreases if node k transmits the
infection signal to node i or changes from state I into
state R; note that the two processes can occur at the
same time step. On the other hand, it increases if node
k changes from state E into I. Therefore, it is updated
according to


œÜk‚Üíi (t + 1) = 1 ‚àí Œ≤ki 1 ‚àí ¬µk œÜk‚Üíi (t)

+ 1 ‚àí Œ±ki ŒΩk œà k‚Üíi (t).

(13)

Similarly, the message œà k‚Üíi (t) decreases if node k
transmits the infection signal to node i or changes from
state E into state I, while it increases if node k changes
from state S into E. In computing the probability increment due to the latter case, one needs to exclude the contribution from node i to node k in the previous time steps
to avoid the eÔ¨Äect of mutual infection. This is achieved
through deÔ¨Åning
Y
Œ∏l‚Üík (t),
(14)
PSk‚Üíi (t) = PSk (0)
l‚àà‚àÇk\i

which is computed in the cavity graph assuming that
node i has been removed. Then the message œà k‚Üíi (t)
follows the update rule

4
(a)

150

(15)

Upon
computing
the
messages
{Œ∏k‚Üíi (t), œÜk‚Üíi (t), œà k‚Üíi (t), PSi‚Üíj (t)} from the update
rules, the marginal probability PSi (t) can be obtained by
Eq. (11). The marginal probabilities of other states can
also be determined as
PRi (t + 1) =PRi (t) + ¬µi PIi (t),
PIi (t
PEi (t

+ 1)
+ 1)

(16)

=(1 ‚àí ¬µi )PIi (t) + ŒΩi PEi (t),
=1 ‚àí PSi (t + 1) ‚àí PIi (t + 1)

(17)
‚àí

PRi (t

+ 1),
(18)

We assume that the nodes are either in susceptible or exposed states at time t = 0, such that the initial conditions
are solely determined by PSi (0) as
œà i‚Üíj (0) = 1 ‚àí PSi (0),

(19)

Œ∏i‚Üíj (0) = œÜi‚Üíj (0) = 0,

(20)

PEi (0) = 1 ‚àí PSi (0),

(21)

PIi (0)

=

PRi (0)

= 0.

(22)

If node i is selected as the initial exposed node, the initial
condition is simply set as PEi (0) = 1, PSi (0) = PIi (0) =
PRi (0) = 0. Based on the initial data, the messages are
solved by updating the DMP Equations (12)-(15) forward in time, after which the marginal probabilities are
determined by Equations (11), (16), (17)and (18). The
computational complexity of the DMP algorithm is linear in the number of time steps and in number of edges
as O(|E|T ). Therefore, the DMP approach saves a signiÔ¨Åcant amount of computational resources compared to
Monte Carlo (MC) simulations, which requires many realizations to obtain reliable results. On the other hand, it
is more demanding than the IBMF approach which deals
with node-wise variables rather than edge-wise variables.
Nevertheless, if the network is sparse, i.e., the average
degree hdi = 2|E|/N ‚â™ N , then the DMP approach has
the same order of computational complexity as the IBMF
approach. This is relevant to the case of disease spreading as the number of close contacts each person has is
limited [31], except for super-spreaders.
C.

(b) 200

Evaluation on Contact Networks

Here we evaluate the eÔ¨Äectiveness of the developed
theories on contact networks, which are either artiÔ¨Åcially generated or adapted from some realistic human
contact data. The realistic contact networks are taken
from data sets obtained in the SocioPatterns collaboration [32], where the temporal face-to-face human contacts
are projected to static contact networks as described in
Appendix D.

population


œà k‚Üíi (t + 1) =(1 ‚àí Œ±ki ) 1 ‚àí ŒΩk œà k‚Üíi (t)


+ PSk‚Üíi (t) ‚àí PSk‚Üíi (t + 1) .

susceptible
exposed
infected
recovered

100
50
0
0

20

40

60

80

100

t

Figure 1. (a) Structure of a contact network in the workplace
taken from the SocioPatterns data (WP2015). The color of
a node represents the department that the individual belongs
to. (b) Evolution of the average population of each state. The
parameters used are ŒΩ = 0.2, ¬µ = 0.125, Œ≤ = 0.016, Œ± = Œ≤/2.
At time t = 0, there are 5 exposed nodes. The trajectories
predicted by the DMP approach (represented by lines) match
well with those from MC simulations (averaged over 104 realizations, represented by dots).

Many realistic contact networks exhibit community
structures. For instance, in workplaces, people usually
interacts more frequently with other people from the
same department compared to those from other departments; in schools, students from the same class also interacts more frequently. An exemplar contact network in
the workplace (WP2015) from the SocioPatterns data is
depicted in Fig. 1(a). We run the DMP algorithm for this
contact network by randomly selecting 5 nodes as the initial exposed nodes and iterating for T = 100 time steps.
The evolution of the population of each compartment is
shown in Fig. 1(b). The number of exposed or infected
cases Ô¨Årst rises and then decreases, and eventually dies
out when herd immunity is reached. The trajectories predicted by the DMP approach match well with those from
MC simulations in this case.
As another example, we evaluate the eÔ¨Écacy of our
framework on random regular graphs, where all nodes
have the same degree and are connected randomly. Only
one node is selected as the initial exposed node, and the
system is simulated for T = 30 time steps. The results are
shown in Fig. 2, exhibiting a much better approximation
accuracy of the DMP approach compared to IBMF. Due
to the eÔ¨Äect of mutual infection, both IBMF and DMP
tend to overestimate the outbreak.
In Fig. 3, we systematically compare the results between theories and MC simulation, showing that DMP
provides a much better approximation than the IBMF
approach. It is found that the prediction errors of both
theoretical approaches generally increase with the epidemiological parameter Œ≤, and also depend on the number of initial exposed nodes. Intuitively, large values of Œ≤
lead to larger growth rates of the infections, in which case
a small approximation error in early time steps could be
ampliÔ¨Åed in late times. For large Œ≤, the prediction errors typically decrease as the number of initial exposed
nodes increases. One possible reason is that the infections
spread out from a unique source are correlated, so that
the independence assumption in the IBMF and DMP ap-

5

0.6

0.0

0.0

0.3
i

0.6

0.9

by MC

0.0

(d)
i
i

i

i

PI (t)

0.6

by MC

A.

8
8

16

24

32

t

Figure 2. Comparison between theory and MC simulation
(averaged over 104 realizations). The underlying network is a
random regular graph with N = 100, d = 10. The parameters
used are T = 30, ŒΩ = 0.2, ¬µ = 0.125, Œ≤ = 0.03, Œ± = Œ≤/2. At
time t = 0, there is only one exposed node. The accuracy
of the DMP approximation is much better than the IBMF
approach.

prediction error

IBMF
DMP

0.12

Œ≤ = 0.02
Œ≤ = 0.03
Œ≤ = 0.04

0.08

IBMF
DMP

0.06

Œ≤ = 0.005
Œ≤ = 0.01
Œ≤ = 0.015

0.04

0.04
0.00

(b) 0.08

prediction error

(a) 0.16

LINEARIZED DYNAMICS AND STABILITY

0.9

IBMF
DMP
MC

00

0.9

by MC

0.6

16

i

0.3

i

24

[PE (t) +

0.3
0.0

0.3

32

PI (t)]

by theory

0.9

0.0

IV.
0.0

PE (t)

0.6

PI (t)

0.3

i

i

PE (t)

0.3

PS (t)

(c)

approximation accuracy deteriorates signiÔ¨Åcantly when
the localization of nonbacktracking centrality is present,
an eÔ¨Äect we will discuss below.

0.9

by theory

0.6

PS (t)

(b)

identity
IBMF
DMP

0.9

by theory

(a)

Linearized Dynamics of the DMP Equations

The fate of the spreading processes depends on the epidemiological parameters. For large transmission probabilities Œ≤ and Œ±, the disease can spread out to a large
fraction of the network, while it tends to die out quickly
for small transmission probabilities. There exist thresholds for these parameters, above which the epidemic outbreaks occur. One commonly used method to determine
epidemic thresholds is to examine whether the diseasefree state is linearly stable to small perturbations [9, 34].
SpeciÔ¨Åcally, the initial disease-free state is perturbed
inÔ¨Ånitesimally as PSi (0) = 1 ‚àí «´i ; if such perturbation
diverges, then the outbreak tend to spread out globally.
At the initial stage, the message Œ∏k‚Üíi (t), which denotes
the probability node k has not passed the infection signal
to node i, can also be expressed as Œ∏k‚Üíi (t) = 1 ‚àí Œ¥ k‚Üíi (t).
At time t + 1, we have
Œ∏k‚Üíi (t + 1) =1 ‚àí Œ¥ k‚Üíi (t + 1)
=1 ‚àí Œ¥

0.02

2

4

6

8

10

no. of initial exposed nodes

0.00

k‚Üíi

(t) ‚àí Œ±ki œà

(23)
k‚Üíi

k‚Üíi

(t) ‚àí Œ≤ki œÜ

(t),

which implies
2

4

6

8

10

no. of initial exposed nodes

Œ¥ k‚Üíi (t + 1) = Œ¥ k‚Üíi (t) + Œ±ki œà k‚Üíi (t) + Œ≤ki œÜk‚Üíi (t), (24)
Figure 3. Comparison between theory and MC simulation for
different
the prediction error is calculated
P parameters,
P where
i
i
1
as NT
œÉ‚àà{S,E,I}
i,t |Psimulation,œÉ (t)‚àíPtheory,œÉ (t)|. The parameters used are T = 30, ŒΩ = 0.2, ¬µ = 0.125, Œ± = Œ≤/2. Each
data point is averaged over 5 instances with different sets of
randomly selected initial exposed nodes. (a) Random regular graph with N = 100, d = 10. (b) Contact network in
the workplace taken from the SocioPatterns data (WP2015).
The prediction errors depend on the number of initial exposed
nodes and the epidemiological parameter Œ≤.

proaches deteriorates [33], e.g., the assumption that the
messages in Eq. (11) factorize does not hold strictly. On
the other hand, if there are multiple initial seeds that trigger the outbreak, the infection signals into a node will be
less correlated, which partly preserves the decorrelation
assumption.
The network topology also impacts on the approximation accuracy of the theories as shown in Appendix E. As
mentioned before, DMP avoids the mutual infection by
excluding one step backtracking interaction, it does not
take into account mutual infections due to backtracking
of multiple steps, which can be non-negligible in networks
with many short loops. In Appendix E, we Ô¨Ånd that the

where Œ¥ k‚Üíi (t), œà k‚Üíi (t) and œÜk‚Üíi (t) have small values.
Expanding Eq. (14) and keeping Ô¨Årst order of œà k‚Üíi (t)
and œÜk‚Üíi (t) leads to
PSi‚Üíj (t + 1) ‚âàPSi‚Üíj (t) ‚àí

X 

Œ±ki œà k‚Üíi (t) + Œ≤ki œÜk‚Üíi (t) .

k‚àà‚àÇi\j

(25)

Then œà k‚Üíi (t + 1) in Eq. (15) can be approximated as
œà i‚Üíj (t + 1) ‚âà (1 ‚àí Œ±ij )(1 ‚àí ŒΩi )œà i‚Üíj (t)
X 

Œ±ki œà k‚Üíi (t) + Œ≤ki œÜk‚Üíi (t) .
+

(26)

k‚àà‚àÇi\j

Equations (26) and (13) constitute a linear dynamical
system of the messages {œÜi‚Üíj (t), œà i‚Üíj (t)}.
In the following, we use homogeneous parameters
Œ±ij = Œ±, Œ≤ij = Œ≤, ŒΩi = ŒΩ, ¬µi = ¬µ. To make the linearized dynamical equations more compact, we introduce
the 2|E| √ó 2|E| nonbacktracking (NB) matrix with elements
Bi‚Üíj,k‚Üíl = Œ¥il (1 ‚àí Œ¥jk ),

(27)

6
which are non-zero if and only if the directed edge i ‚Üí j
follows right after edge k ‚Üí l, i.e., in a conÔ¨Åguration like
k ‚Üí l(= i) ‚Üí j, but edge i ‚Üí j does not backtrack to
node k [35]. Then Eqs. (26) and (13) can be written in
the matrix form as




œà(t)
œà(t + 1)
,
(28)
=J
œÜ(t)
œÜ(t + 1)
where the J is the Jacobian matrix of the dynamical
system deÔ¨Åned as

J =



(1 ‚àí Œ±)(1 ‚àí ŒΩ)I + Œ±B
Œ≤B
(1 ‚àí Œ±)ŒΩI
(1 ‚àí Œ≤)(1 ‚àí ¬µ)I



, (29)

where I is the 2|E|-dimensional identity matrix. The
spectral radius œÅ(J ) of the Jacobian J determines the
growth rate of the fastest mode of the linearized dynamics. The appearance of the NB matrix B in the linearized
dynamical equation is rooted in the fact that the one-step
backtracking infection is excluded in the DMP equations
(e.g., through Eq. (14)), therefore it also appears in other
algorithms for complex networks based on linearizing belief propagation, such as the applications in community
detection [36] and percolation [37].

B.

Spectral Properties of the Jacobian

The condition that œÅ(J ) ‚â• 1 corresponds to an exponential growth of the linearized dynamics in Eq. (28),
which implies that the disease is likely to spread out
globally. The solution of œÅ(J ) = 1 marks the phase
boundary of the epidemiological parameters. Since the
matrix elements of J are non-negative, the PerronFrobenius theorem asserts that (i) its leading eigenvalue
Œªmax
(deÔ¨Åned as the eigenvalue having the largest real
J
part) equals its spectral radius œÅ(J ) and therefore is
real and non-negative and (ii) there exists an eigenvector
with non-negative and nonzero elements corresponding
to Œªmax
[38].
J
Consider the eigenvalue equation of the Jacobian matrix J ,
 
 
u
u
,
(30)
= ŒªJ
J
v
v
which can be simpliÔ¨Åed to
(1 ‚àí Œ±)ŒΩ
v=
u,
ŒªJ ‚àí (1 ‚àí Œ≤)(1 ‚àí ¬µ)
ŒªJ ‚àí (1 ‚àí Œ±)(1 ‚àí ŒΩ)
Bu =
u.
(1‚àíŒ±)ŒΩ
Œ± + Œ≤ ŒªJ ‚àí(1‚àíŒ≤)(1‚àí¬µ)

(31)
(32)


 

(1‚àíŒ±)ŒΩ
It implies that ŒªJ ‚àí(1‚àíŒ±)(1‚àíŒΩ) / Œ±+Œ≤ ŒªJ ‚àí(1‚àíŒ≤)(1‚àí¬µ)
is an eigenvalue of the NB matrix B with eigenvector u,

denoted as ŒªB . The Perron-Frobenius theorem also guarof B is real and
antees that the leading eigenvalue Œªmax
B
non-negative. It can be shown that the leading eigenvalue
Œªmax
is related to Œªmax
as shown in Appendix F
J
B
Œªmax
=
J


1
(1 ‚àí Œ±)(1 ‚àí ŒΩ) + (1 ‚àí Œ≤)(1 ‚àí ¬µ) + Œ±Œªmax
B
2 
2
1
+
(1 ‚àí Œ±)(1 ‚àí ŒΩ) ‚àí (1 ‚àí Œ≤)(1 ‚àí ¬µ) + Œ±Œªmax
B
2
1/2
max
.
(33)
+ 4(1 ‚àí Œ±)ŒΩŒ≤ŒªB

In this way, we relate the dynamical properties of the
SEIR model to the epidemiological parameters and network structure properties, where the latter is subtly conveyed through the eigenvalue Œªmax
B . This is in contrast
to the growth rate given by the commonly used basic reproduction number R0 , deÔ¨Åned as the expected number
of secondary cases caused by a single randomly-selected
exposed individual when the rest of the population are
susceptible. In the SEIR model considered here, the R0
is estimated to be (see Appendix G)


Œ± Œ≤
R0 = hdi
,
(34)
+
ŒΩ
¬µ
which only depends on the averaged degree hdi, but neglects possible higher order structures of the contact networks. It has long been recognized that the R0 measure
is deÔ¨Åcient in network epidemiology [9, 26].
Another useful measure is the eÔ¨Äective reproduction
number R(t), which has a similar deÔ¨Ånition to R0 but is
based on the expected secondary infections to the remaining susceptible population at time t [19]. The network
structure and dynamical model play a role in determining R(t), as the real-time susceptible population needs to
be estimated, which is diÔ¨Écult to carry out analytically.
In general, applying R(t) requires solving the dynamics
and it is more suitable as an indicator for monitoring the
spread (e.g., as in Ref. [39]), which diÔ¨Äers from the role
of R0 or the epidemic threshold as predictors.
The computation of the leading eigenvalue Œªmax
can be
B
demanding as the NB matrix is of size 2|E| √ó 2|E|, which
is a large matrix if the underlying network is relatively
dense. It has been observed that the spectrum of B can
be obtained from a much smaller matrix of size 2N √ó
2N [36, 40]


0 D ‚àí IN
,
(35)
M=
‚àíIN
A
where IN is the N -dimensional identity matrix, D is the
diagonal matrix of node degrees with elements Dij =
di Œ¥ij , and A is the adjacency matrix with elements satisfying Aij = 1 if (i, j) ‚àà E and Aij = 0 otherwise.
Intuitively speaking, the reduction of complexity comes
from compressing the edge-based data, e.g., œÜi‚Üíj (t) and
œà i‚Üíj (t), to node-based data [36] as shown in Appendix H.
This allows us to work with networks of relatively large
sizes.

7
(a)

‚àû)

Determining the Critical Points


1
(36)
(1 ‚àí ŒΩ) + (1 ‚àí ¬µ) + Œ±Œªmax
A
2

1/2
2
1
+ 4ŒΩŒ≤Œªmax
,
(1 ‚àí ŒΩ) ‚àí (1 ‚àí ¬µ) + Œ±Œªmax
+
A
A
2

Œªmax
J MF =

which relates the maximal eigenvalue Œªmax
J MF of the Jacobian matrix J MF of the IBMF equations in Sec. III A
and the adjacency matrix A of the network. Solving
max
Œªmax
J MF (Œ≤, Œ±, ŒΩ, ¬µ, ŒªA ) = 1 yields the epidemic threshold
as predicted by the IBMF approach.
The epidemic thresholds obtained by the two theoretical approaches are to be contrasted with those obtained
from numerical simulations, where the large time limit is
taken such that the outbreaks saturate and the Ô¨Ånal state
of each node i is either susceptible or recovered. The fraction of nodes
P that have been infected is an order parameter r = i PRi (‚àû)/N deÔ¨Åning the phase transition from
localized infections to global epidemics. Since statistical
Ô¨Çuctuation is large near criticality, one can estimate the
critical point through the variability measure [41]
p
hr2 i ‚àí hri2
Cr =
,
hri

(37)

which peaks at the critical point.
B.

Phase Transition in Random Regular Graphs

As an example, we consider random regular graphs of
degree d = 10, where the leading eigenvalues of the matrices A and B have exact expressions as Œªmax
= d =
A
10, Œªmax
= d ‚àí 1 = 9, irrespective of the network size,
B
as described in Appendix H. We also Ô¨Åx the values of
ŒΩ and ¬µ, let Œ± = Œ≤/2 and consider the phase transition
by varying Œ≤. It is shown in Fig. 4(a) that a signiÔ¨Åcant
fraction of the systems nodes are aÔ¨Äected by the epidemic
outbreak above the critical point Œ≤c . In Fig. 4(b), we pinpoint the critical point Œ≤c from MC simulations through
the variability measure Cr , and compare them to those
obtained via the IBMF and the DMP approaches, where
it is observed that the DMP approach provides a much
better estimation. In Appendix H we observed that the
epidemic has a small probability to die out even for large
Œ≤, a behavior that also appears in the SIR model [41]

Œ≤c

N = 1600

0.010

N = 6400

0.009

0.6

0.3

10

3

N

10

4

i

Equation (33) gives rise to the epidemic threshold as
predicted by the DMP approach through the solution of
max
max
Œªmax
=
J (Œ≤, Œ±, ŒΩ, ¬µ, ŒªB ) = 1, keeping in mind that ŒªJ
œÅ(J ).
The same derivation can also be applied to the IBMF
equations, as shown in Appendix H, leading to

IBMF
DMP
MC

0.011

1.2

N = 800
N = 3200

i

PR (

A.

(b)

N = 400

0.6

Cr

EPIDEMIC THRESHOLD

/N

V.

0.0
0.000

0.008

Œ≤

0.016

0.0
0.000

0.008

Œ≤

0.016

Figure 4. Phase transition behavior of the SEIR model in
random regular graphs of degree d = 10. The parameters are
ŒΩ = 0.2, ¬µ = 0.125, Œ± = Œ≤/2, while Œªmax
= 10, Œªmax
= 9.
A
B
The systems are initiated with 5 exposed nodes and are simulated for a sufficiently long time such that every node that
has contracted the disease has recovered. In both (a) and (b),
the three vertical lines correspond to the critical points Œ≤c obtained via different approaches, and different lines correspond
to networks of different sizes. In both the IBMF and the DMP
approaches, Œ≤c is the same for networks of different sizes as
the degree is fixed. In MC simulation, Œ≤c is obtained through
the largest network
P i (N = 6400) considered. (a) Order parameter r =
i PR (‚àû)/N as a function of Œ≤, obtained in
MC simulations.
(b) Variability of the order parameter, i.e.,
p
Cr = hr 2 i ‚àí hri2 /hri, as a function of Œ≤. Since the variability Cr obtained in simulations (data points in circle markers)
is subject to fluctuations, we apply curve fitting to the experimental data using Gaussian processes with a radial basis
function kernel (the fitted curves are shown in solid lines) [44].
The maximum point of Cr in the fitted curve (diamond-shape
marker) is marked as the critical point obtained from MC simulations. Inset of (b) shows that the critical point Œ≤c obtained
in MC simulations approaches the one obtained by the DMP
approach as the network size increases.

and may impact on the estimation of Œ≤c through simulations [29]. This is not captured by the theories which only
consider averaged quantities. It would be an interesting
future direction to study the deviations from the mean
behaviors [42] and possible heterogeneous structures [43].

VI. EXPLORING PHASE DIAGRAM AND THE
IMPACT OF INTERVENTION STRATEGIES

In this section, we explore phase diagrams in diÔ¨Äerent scenarios via the DMP approach and examine the
impact of some intervention strategies. Any speciÔ¨Åc intervention strategy will have an eÔ¨Äect on the system parameters, and therefore inÔ¨Çuence the dynamics. Here, we
primarily examine their impact on epidemic thresholds in
the asymptotic limit. In particular, we expect that various social distancing measures eÔ¨Äectively reduce Œ≤ and
Œ±. Some intervention strategies may inÔ¨Çuence the transmission probabilities Œ≤ and Œ± in diÔ¨Äerent manners, so
we consider the phase diagrams in parameter subspace
spanned by Œ≤ and Œ±, rather than keeping a Ô¨Åxed ratio
between them.
The critical line separating the parameter regions of
localized infections and global outbreaks, obtained by

8
max
solving Œªmax
J (Œ≤, Œ±, ŒΩ, ¬µ, ŒªB ) = 1 for Œ±, has the following
expression


Œ±c (Œ≤) =ŒΩ Œ≤(Œªmax
+ ¬µ ‚àí 1) ‚àí ¬µ /
B

Œ≤(1 ‚àí ¬µ)(1 ‚àí ŒΩ) + Œ≤Œªmax
B (¬µ + ŒΩ ‚àí 1)

max
‚àí ¬µ(ŒªB + ŒΩ ‚àí 1) .
(38)

While there is no presymptomatic transmission in the
SIR model deÔ¨Åned by Eqs. (5) and (6), we can compare
with the expression obtained for the critical transmission
probability [29]
Œ≤cSIR =

¬µ
.
Œªmax
+
¬µ‚àí1
B

(39)

As a comparison, we sketch the phase boundaries Œ±c (Œ≤)
of the SEIR model and Œ≤ = Œ≤cSIR of the SIR model for
certain ŒΩ, ¬µ and Œªmax
in Fig. 5(a). The epidemic will
B
not spread globally when the parameters are in both regions (I) and (II) in the SIR model. In contrast, the
disease will die out only in region (I) in the SEIR model.
Particular caution is needed in region (II), where Œ≤ is
small enough so that it is safe for the SIR model, but
the presymptomatic transmission is suÔ¨Éciently signiÔ¨Åcant (i.e., Œ± > Œ±c (Œ≤)) to cause a global epidemic.
A.

C.

Diseases with Different Incubation Periods

Similarly, when ¬µ and Œªmax
are Ô¨Åxed, varying ŒΩ will
B
only impact on the intersects of the phase boundaries
with the Œ±-axis but not those with the Œ≤-axis, as seen
in Fig. 5(d). Physically, diÔ¨Äerent ŒΩ values correspond to
diseases with diÔ¨Äerent incubation periods. For smaller
ŒΩ, the exposed nodes have a longer time to infect their
neighbors, which makes it more diÔ¨Écult to combat the
epidemic spreading.

Cases For Œ± = 0 and Œ≤ = 0

Consider the special case Œ± = 0, solving Œ±c (Œ≤) = 0
gives
Œ≤cSEIR |Œ±=0

¬µ
,
= max
ŒªB + ¬µ ‚àí 1

(40)

which coincides with Œ≤cSIR . It indicates that the intersection of the two critical lines occurs at Œ± = 0 (as shown
in Fig. 5(a)) is a general phenomenon. Physically, this
special case corresponds to the traditional SEIR model
where the exposed nodes are not infectious, which has
the same epidemic thresholds with the SIR model, irrespective of the incubation period 1/ŒΩ.
Similarly, consider the special case Œ≤ = 0, then
Œ±SEIR
|Œ≤=0 =
c

ŒΩ
,
Œªmax
+
ŒΩ ‚àí1
B

(41)

which is eÔ¨Äectively the critical point of an SIR model
viewing the state I as ‚Äúrecovered‚Äù, as expected. Equations (40) and (41) explain some of the behaviors in
Fig. 5(b)(c)(d), as explained below.
B.

is independent of ¬µ), as seen in Fig. 5(b). Physically,
since diÔ¨Äerent values of ¬µ represent diÔ¨Äerent recovery
rates, increasing ¬µ can be eÔ¨Äectively realized by isolating
all nodes in state I before they recover. If such a policy can be executed strictly and timely, it corresponds
to a large ¬µ that can signiÔ¨Åcantly expand the parameter
region of the epidemic-free phase, leaving a lot of Ô¨Çexibility in implementing social distancing measures (i.e.,
many usual social interactions can still be allowed). Nevertheless, if the presymptomatic transmission probability
Œ± is large enough, e.g., Œ± > Œ±SEIR
|Œ≤=0 , then isolating the
c
patients in state I alone is insuÔ¨Écient to slow down the
spread; in this case, identifying nodes in state E through
contact tracing or mass testing, and/or implementing
stricter social distancing measure become necessary.

Effect of Increasing ¬µ and Quick Isolation of
Symptomatic Individuals

When ŒΩ and Œªmax
are Ô¨Åxed, varying ¬µ will only afB
fect the intersects of the phase boundary on the Œ≤-axis
(Œ≤cSEIR |Œ±=0 depends on ¬µ) but not the Œ±-axis (Œ±SEIR
|Œ≤=0
c

D.

Approximation of the Phase Boundary

Finally, although the phase boundary Œ±c (Œ≤) of the
SEIR model is in general nonlinear, the cases considered
in Fig. 5 exhibit an almost linear relation, except for a
very small Œªmax
B . This can be seen more explicitly in
the limit of large Œªmax
B , where one of the suÔ¨Écient conditions is that the network has a large average degree (e.g.,
Œªmax
= d ‚àí 1 in random regular graphs), and requires the
B
transmission probability Œ≤ and Œ± to be small enough for
the disease to die out. Under the condition of large Œªmax
B
and small Œ≤, Eq. (38) can be approximated as
ŒΩ
ŒΩ(Œªmax
+ ¬µ ‚àí 1)
B
Œ≤ + max
,
max
¬µ(ŒªB + ŒΩ ‚àí 1)
ŒªB + ŒΩ ‚àí 1
ŒΩ
ŒΩ
‚âà ‚àí Œ≤ + max .
(42)
¬µ
ŒªB

Œ±c (Œ≤) ‚âà ‚àí

Equation (42) explains the phenomena shown in Fig. 5(c)
that when ŒΩ and ¬µ are Ô¨Åxed but Œªmax
is reduced, the
B
epidemic-free region expands, but the slope of the phase
boundary remains roughly unchanged. Physically, reducing Œªmax
can be achieved by limiting the number of conB
tacts between nodes, as will be shown in Sec. VIII.
A similar linear relation of the phase boundary can
be obtained by the condition R0 = 1, where R0 satisÔ¨Åes
Eq. (34), yielding
ŒΩ
ŒΩ
0
,
Œ±R
c (Œ≤) = ‚àí Œ≤ +
¬µ
hdi

(43)

9
(a)

(b)
0.024

0.024

II

Œ±

0.016

III

0.008

I

0.000
0.000

0.015

0.030

Œ≤

(c) 0.08

ŒªBmax = 9
ŒªBmax = 7
ŒªBmax = 5
ŒªBmax = 3

Œ±

0.06

0.04

0.000
0.00

0.000
0.000

0.15

0.15

ŒΩ = 0.2
ŒΩ = 0.4
ŒΩ = 0.8
ŒΩ=1

0.016

0.00
0.00

0.10

0.10

0.024

0.008

Œ≤

Œ≤

(d)

0.02

0.05

0.05

Œ±

Œ±

0.016

0.008

¬µ = 0.125
¬µ = 0.25
¬µ = 0.5
¬µ=1

0.015

Œ≤

0.030

Figure 5. Phase diagrams of the SEIR model in the (Œ≤, Œ±)plane. In panels (b)(c)(d), the critical lines are obtained by
solving Eq. (38). (a) The parameters used are ŒΩ = 0.2, ¬µ =
0.125, Œªmax
= 9. The phase boundary separating region (I)
B
from the others is given by Eq. (38), while the line separating region (II) and region (III) is Œ≤ = Œ≤cSIR , where Œ≤cSIR is
given by Eq. (39). The transmission probabilities Œ≤, Œ± can
be reduced by imposing measures such as maintaining social distance and wearing face mask. (b) The parameters
used are ŒΩ = 0.2, Œªmax
= 9. The arrow points to the diB
rection of change in phase boundary due to increasing ¬µ,
which enlarges the disease-free region and can be realized
by identifying and isolating nodes in state I more effectively.
(c) The parameters used are ŒΩ = 0.2, ¬µ = 0.125. The arrow points to the direction of change in phase boundary due
to increasing Œªmax
B , which can be realized by reducing contacts (self-isolation, lock-down). (d) The parameters used are
¬µ = 0.125, Œªmax
= 9. Different ŒΩ values correspond to diseases
B
with different incubation periods.

which coincides with Eq. (42) if we identify Œªmax
as hdi.
B
It turns out that the condition Œªmax
=
hdi
holds
approxB
imately for Poisson random graphs [45], as will also be
shown in Sec. VIII. Therefore, the critical line obtained
via the basic reproduction number is a good estimation
in dense Poisson random graphs, but may become a poor
approximation otherwise.

VII. PREDICTION OF OUTBREAK PROFILE
BY THE NONBACKTRACKING CENTRALITY

Similar to the eigenvalues, the eigenvectors of the Jacobian matrix also provide valuable information on the
dynamics. Consider
P the eigen-decomposition of the Jacobian as J = a ŒªaJ Œæ a (Œæ ‚àí1 )a , and note that the messages can be decomposed
using the eigenvectors as bases,
 P
i.e., œà(t), œÜ(t) = a ca (t)Œæ a . In light of the linearized
dynamics, the component cmax (t) corresponding to the
max
leading eigenvalue Œªmax
> 1
J , will dominate when ŒªJ
as the system evolves. Therefore, we can use the leading eigenvector Œæ max of the Jacobian J to predict the


outcome œà(T ), œÜ(T ) of the dynamics.
According to Eq. (31), the two components of Œæ max =
(uÃÉ, vÃÉ) are proportional to each other, i.e., vÃÉ ‚àù uÃÉ. Thus,
it is suÔ¨Écient to examine one component only. In what
follows, we consider uÃÉ, which is the leading eigenvector
of the NB matrix B according to Eqs. (32) and (33).
Furthermore, we are ultimately interested in the marginal
probabilities, which relate to the incoming messages to
each node as seen in Eq. (11). In the linearized dynamics,
the probability of newly infection of node i is given by
PSi (t) ‚àí PSi (t + 1) ‚âà

X

k‚àà‚àÇi


Œ±œà k‚Üíi (t) + Œ≤œÜk‚Üíi (t) . (44)

Therefore, we need to consider the incoming vector of the
leading eigenmode uÃÉ
X
uÃÉin
uÃÉk‚Üíi ,
(45)
i :=
k‚àà‚àÇi

which is known as the nonbacktracking centrality [45].
Interestingly, in addition to the leading eigenvalue Œªmax
B ,
the NB centrality uÃÉin can be obtained through the much
smaller matrix M [36] as shown in Appendix H. The NB
centrality has been shown to play an important role in
percolation and SIR model in networks [37, 43, 46].
of newly infection
Eq. (44), the probability
 onk‚Üíi

PBased
k‚Üíi
Œ±œà
(t)
+
Œ≤œÜ
(t)
can
be
identiÔ¨Åed as the
k‚àà‚àÇi
incoming vectors of the messages as Œ±œàiin (t) + Œ≤œÜin
i (t),
which will be increasingly more aligned with uÃÉin
as
time
i
evolves. Thus, we can use uÃÉin to predict the relative
strengths of the outbreak, indicated by {1 ‚àí PSi (t)}. Figure 6(a) demonstrates that, for Œ≤ large enough, the evolution of correlation coeÔ¨Écient œÅ between uÃÉin and the
proÔ¨Åle of the outbreak on the WP2015 network generally
increases with time. For small Œ≤ = 0.002, the correlation
remains low as the disease will die out. For a rather large
Œ≤ = 0.016, the correlation coeÔ¨Écient œÅ increases rapidly
in the initial stage of the development of the spreading,
and then decreases to a lower level. This is because for a
very large Œ≤, most nodes are likely to be infected eventually, irrespective of the spatial structure of the network.
As shown in Fig. 6(b), such relation between œÅ and Œ≤ is
also observed in other networks, including a graph generated by a stochastic block model (SBM) and a scale-free
network (SF) with degree exponent Œ≥ = 2 (details of the
networks will be discussed in Sec. VIII).
Similarly, the IBMF approach dictates that the leading eigenvector of the adjacency matrix A (known as
the eigenvector centrality [45]) is a predictor of the outbreak proÔ¨Åle [28]. Comparison between diÔ¨Äerent centrality measures is brieÔ¨Çy discussed in Appendix E, where the
NB centrality generally provides a better prediction than
the eigenvector centrality. As was mentioned before, the
DMP approach only avoids the eÔ¨Äect of mutual infection
due to one-step backtracking, and the approximation accuracy can deteriorate if counteracting the eÔ¨Äect of onestep backtracking is insuÔ¨Écient. This is of particular concern when the NB centrality uÃÉin displays the localization

10
(a)

(b)

0.50

Œ≤ = 0.004
Œ≤ = 0.008

0.4

Œ≤ = 0.016

in

in

œÅ(uÃÉ , 1

œÅ(uÃÉ , 1 ‚àí PS (‚àû))

Œ≤ = 0.002

0.6

0.2
0.0
0

1.00
0.75

0.8

‚àíP

S (t))

1.0

20

40

60

80

100

0.25

SBM
SF, Œ≥ = 2
WP2015

0.00
0.000

t

0.006

0.012

Œ≤

0.018

Figure 6. Correlation coefficient œÅ between the nonbacktracking centrality uin
i and the outbreak profile, measured by the
probability that each node i has been infected, i.e., 1 ‚àí PSi (t).
The parameters are ŒΩ = 0.2, ¬µ = 0.125. At time t = 0, there
are 5 initial exposed nodes. (a) Correlation coefficient œÅ of
the spread on the WP2015 network as a function of time. (b)
Correlation coefficient œÅ as a function of Œ≤ in different networks in the large time limit, where the spreading processes
have saturated. Each data point is averaged over 5 instances
with different sets of randomly selected initial exposed nodes.

phenomenon, where the centrality values of a few nodes
are much larger than the others [45, 47]. In Appendix E
we demonstrated the degradation of the approximation
power of the DMP equations and the NB centrality in
random networks with a relatively large planted clique
(i.e., a complete subgraph), which possesses the localization property [45]; we also observed a poor approximation accuracy in one of the contact networks from the
SocioPatterns data, recorded in a high school in 2013
(HS2013) [48], where the NB centrality uÃÉin is more localized on a few communities.
VIII.

EFFECT OF REDUCING CONTACTS

In addition to the social distancing rules that lower
the transmission probabilities Œ≤ and Œ±, reducing social
contacts between individuals is also an eÔ¨Äective measure to slow down the spread of the disease. We examine its eÔ¨Äects in the static contact networks considered
here, by removing edges between nodes. Such a measure
will change the network structure and reduce the leading
eigenvalue Œªmax
of the matrix B, which can enlarge the
B
epidemic-free region in the parameter space as shown in
Fig. 5(c). In general, the leading eigenvalue Œªmax
can
B
depend intricately on the network structure. In the special case of conÔ¨Åguration model where the node degrees
follow a given distribution P (d) and the nodes are wired
randomly, it is found in Refs. [36, 45] that Œªmax
can be
B
approximated as
Œªmax
‚âà
B

hd2 i ‚àí hdi
,
hdi

(46)

which already indicates that even in the high degree limit,
the epidemic thresholds obtained by R0 in Eq. (43) do
not generally coincide with those obtained in the DMP
approach in Eq. (42). SpeciÔ¨Åcally, the second moment
of the degree distribution is also relevant for epidemic

thresholds in uncorrelated random networks [9], which is
not captured by Eq. (43). A more reÔ¨Åned approximation
taking into account the relation of degrees of neighboring nodes is given in Ref. [47]. The accuracy of these
approximations depends on the validity of the uncorrelated random network assumption and/or the presence of
localization of NB centrality [47] (see also Appendix H 4).
Due to the dilution of connections between nodes,
a network may become disconnected, resulting in fragmented components [49]; if such cases happen, we keep
the largest connected component in the following experiment. In Fig. 7(a), Erd≈ës‚ÄìR√©nyi (ER) random graphs
and networks generated via a stochastic block model
(SBM) are considered. A network generated by SBM
has 4 communities, where each community comprises
50 nodes; node i in community a is connected to cab
nodes of community b on average. Here, we consider
cab = 4, ‚àÄa 6= b and caa = 10, ‚àÄa 6= 1, while diÔ¨Äerent values of c11 are considered. When c11 = 10, all four communities are statistically equivalent, and the node degrees
follow a Poisson distribution, similar to the ER random
graphs. For such Poisson random graphs, Œªmax
‚âà hdi
B
according to Eq. (46), which is justiÔ¨Åed experimentally
by the numerical results of Fig. 7(a). On the other hand,
Œªmax
deviates from hdi in SBM networks with c11 > 0.
B
The networks become sparser when edges are removed
randomly, and Œªmax
decreases linearly with hdi. A quasiB
linear decreasing trend is also observed in the random
edge removal experiments in contact networks from the
SocioPatterns collaboration as shown in Fig. 7(b), as well
as in scale-free networks where the node degrees follow
Pdmax
the power-law distribution P (d) = d‚àíŒ≥ / d=dmin d‚àíŒ≥ , as
shown in Fig. 7(c).
of scale-free
In Fig. 7(c), the leading eigenvalues Œªmax
B
networks can deviate signiÔ¨Åcantly from hdi, especially
for more heterogeneous networks with a small Œ≥ value.
Therefore, predicting the cause of the spread through
R0 becomes very unreliable in scale-free networks, an effect which has been observed in network epidemiology
studies [9]. Physically, there exist a small number of
hubs (i.e., nodes with very large degrees) in scale-free
networks, which can be viewed as super-spreaders that
signiÔ¨Åcantly facilitate the spread of the disease. In light
of this, restricting contacts of these high-degree nodes
preferentially can eÔ¨Äectively reduce Œªmax
as shown in
B
Fig. 7(d), and consequently lower the epidemic thresholds.

IX.

DISCUSSION AND OUTLOOK

In this paper, we studied the SEIR model with
presymptomatic transmissions, a feature of the COVID19 disease, in both artiÔ¨Åcial and realistic contact networks through the dynamic message-passing method.
The DMP approach provides a much better approximation compared to the IBMF approach while being much
less computationally demanding than MC simulations,

11
45

ŒªBmax

30

(b) 60

SBM, c11 = 30
SBM, c11 = 20
SBM, c11 = 10
ER

40

ŒªBmax

(a)



d

20

15

(c) 24

ŒªBmax

16

8

 16

d

00

24

(d) 24

Œ≥=2
Œ≥ = 2.5
Œ≥=3
Œ≥ = 3.5

d

16

ŒªBmax

00

8
0
0

PS2014
HS2013
WP2015
WP2013

d

4

 8

d

20

d

30

Œ≥ = 2, i. i. d.
Œ≥ = 2, h = 2
Œ≥ = 2, h = 4

d

8
0
0

12

10

4

 8

d

12

Figure 7. Leading eigenvalue Œªmax
of the nonbacktracking
B
matrix B vs average degree hdi of the network. The rightmost dot of a curve represents the original network, while
other dots correspond to the networks obtained by removing existing edges while keeping the largest connected component. Edges are removed randomly in panels (a)(b)(c),
while edges adjacent to high-degree nodes are removed preferentially in panel (d). (a) ER random graph and networks
generated through SBM with N = 200. (b) Contact networks extracted from data in the SocioPatterns collaboration, including a network in a primary school (PS2014) [50],
in a high school (HS2013) [48] and workplaces (WP2013,
WP2015) [51, 52]. (c) Scale-free networks generated from the
configuration model. The network size is N = 400 and the
node degree is limited with d < dmax = 100. (d) Scale-free
network with Œ≥ = 2 (same as the one in panel (c)). In the
edge removal process, a node i is firstly selected according
dh

to the probability pi = P idh , h > 0, which is biased toward
i i
high-degree nodes; then one of the edges adjacent to node i
is randomly selected and removed. Different fractions of removed edges result in networks of different average degrees
hdi.

which is the most prominent feature of this method. The
linear stability analysis of the DMP equations gives rise
to the epidemic thresholds and phase diagrams of the
models, where their dependence on epidemiological parameters and the network structure are elucidated. A
larger presymptomatic transmission probability value Œ±
leads to a lower critical point Œ≤c , which makes the strategy of blocking only symptomatic transmission less effective. We also show that diÔ¨Äerent intervention strategies impact on the epidemic thresholds in diÔ¨Äerent manners. The inÔ¨Çuence of network structure on the epidemic
thresholds is represented by the leading eigenvalue Œªmax
B
of the nonbacktracking matrix B, which encodes more
subtle structural information in contrast to the average

number of contacts hdi appearing in the basic reproduction number R0 . Additionally, we demonstrated that
the nonbacktracking centrality uÃÉin related to the leading eigenvector of the matrix B can eÔ¨Äectively predict
the relative strength of the outbreak.
On the other hand, it is worthwhile mentioning some
limitations of the DMP method. Firstly, as the DMP
approach is based on the decorrelation assumption of the
infection signals, it may become a less accurate approximation when the correlations between trajectories are
non-negligible, which can happen when there is a single
initial exposed node seeding the dynamics and/or there
are many short loops in the network. Second, the approximation accuracy of the DMP approach also deteriorates
when counteracting the one-step backtracking reaction is
insuÔ¨Écient to avoid the eÔ¨Äect of mutual infection; this
eÔ¨Äect has been observed in networks where the nonbacktracking centrality exhibits a localization phenomenon as
shown in Appendix E. It is an interesting future direction
to further characterize the condition of nonbacktracking
centrality localization, its impact on spreading processes
and possible improvements [47].
‚ÄòThe theoretical frameworks were mostly applied to
contact networks in some speciÔ¨Åc scenarios or those exhibiting particular characteristics, such as the presence
of community structure or high-degree hubs. The applications on a wider scale (e.g., in a city) require considering additional network characteristics, such as the
mixing pattern of diÔ¨Äerent age groups [31], the household structure, and so on [53]. Additional states, such as
hospitalized and dead, can also be considered in order to
model the pressure on public-health services and social
cost. Since presymptomatic transmissions make it more
diÔ¨Écult to contain the disease by dealing with the symptomatic cases only, an extension of particular interest is
to examine the eÔ¨Äectiveness and limitation of (manual
or digital) contact tracing [39, 54, 55], mass testing and
other strategies which can identify exposed individuals
that have not shown symptoms. The DMP equations developed here will also beneÔ¨Åt future works which aim at
optimal deployment of resources (e.g., vaccines) to contain the spread of epidemics with presymptomatic transmissions [30, 33, 56].

ACKNOWLEDGMENTS

B.L. and D.S. acknowledge support from European
Union‚Äôs Horizon 2020 research and innovation program
under the Marie Sk≈Çodowska-Curie grant agreement
No. 835913. D.S. acknowledges support from the EPSRC program grant TRANSNET (EP/R035342/1).

12
Appendix A: Deriving DMP Equations From Dynamic Belief Propagation
1.

Belief Propagation Equations of Trajectories

In this Appendix, we derive the DMP equations from the principled dynamic belief propagation established in
Ref. [16]. It is based on the message mi‚Üíj (~œÉi |~œÉj ), which is the cavity probability of the dynamical trajectory
~œÉi = [œÉi0 , ..., œÉiT ] (where œÉit ‚àà {S, E, I, R}) of node i in the cavity graph in which node j has been removed. Since
the transition between states is irreversible (only permitted in the order S ‚Üí E ‚Üí I ‚Üí R), the trajectory ~œÉi can be
parametrized by three transition times (œÑi , œâi , Œµi ) as ~œÉi = |S0 SSEœÑi EEIœâi IIIRŒµi RRT i.
The dynamic belief propagation for the modiÔ¨Åed SEIR model takes the following form
mi‚Üíj (œÑi , œâi , Œµi |œÑj , œâj , Œµj ) =

X

WSEIR

Y

k‚àà‚àÇi\j

{œÑk ,œâk ,Œµk }k‚àà‚àÇi\j

mk‚Üíi (œÑk , œâk , Œµk |œÑi , œâi , Œµi ),

(A1)

where WSEIR is the transition kernel

WSEIR = PEi (0)I(œÑi = 0) + PSi (0)I(œÑi > 0)
√ó

œÑY
i ‚àí2


Y
1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ )I(œâk ‚â• t‚Ä≤ + 1) ‚àí Œ≤ki I(œâk ‚â§ t‚Ä≤ )I(Œµk ‚â• t‚Ä≤ + 1)

t‚Ä≤ =0 k‚àà‚àÇi



Y
√ó 1‚àí
1 ‚àí Œ±ki I(œÑk ‚â§ œÑi ‚àí 1)I(œâk ‚â• œÑi ) ‚àí Œ≤ki I(œâk ‚â§ œÑi ‚àí 1)I(Œµk ‚â• œÑi )
k‚àà‚àÇi

√ó

 œâY
i ‚àí2

t‚Ä≤‚Ä≤ =œÑi

  ŒµY

i ‚àí2
Y
(1 ‚àí ŒΩi ) ŒΩi
(1 ‚àí ¬µi ) ¬µi I(œÑi < œâi < Œµi )
I(œÑk < œâk < Œµk ).
t‚Ä≤‚Ä≤‚Ä≤ =œâi

The marginal of a trajectory of node i is computed as
X
Y
WSEIR
mi (œÑi , œâi , Œµi ) =
mk‚Üíi (œÑk , œâk , Œµk |œÑi , œâi , Œµi ),
{œÑk ,œâk ,Œµk }k‚àà‚àÇi

(A2)

k‚àà‚àÇi

(A3)

k‚àà‚àÇi

The cavity probability of a trajectory has the following properties
mi‚Üíj (œÑi , œâi , Œµi + 1|¬∑) = (1 ‚àí ¬µi )mi‚Üíj (œÑi , œâi , Œµi |¬∑),
1 ‚àí ŒΩi i‚Üíj
m
(œÑi , œâi , Œµi |¬∑)I(Œµi > œâi + 1),
mi‚Üíj (œÑi , œâi + 1, Œµi |¬∑) =
1 ‚àí ¬µi
mi‚Üíj (œÑi , œâi + 1, Œµi + 1|¬∑) = (1 ‚àí ŒΩi )mi‚Üíj (œÑi , œâi , Œµi |¬∑),

(A4)
(A5)
(A6)

where similar relations hold for mi (œÑi , œâi , Œµi ). In addition, if œÑj ‚â• œÑi , we have
mi‚Üíj (œÑi , œâi , Œµi |œÑj , ¬∑, ¬∑) = mi‚Üíj (œÑi , œâi , Œµi |T, œâj , Œµj ),
2.

‚àÄT ‚â• œÑi .

(A7)

Deriving the Messages and Probability of Being in State S

The cavity probability of node i being in state S at time t is obtained by tracing over the probability of trajectories
mi‚Üíj in the cavity graph (assuming node j is absent by setting œÑj = T ),
PSi‚Üíj (t) =

X

œÑi ,œâi ,Œµi

I(t < œÑi < œâi < Œµi )mi‚Üíj (œÑi , œâi , Œµi |T, ¬∑, ¬∑),

where a similar relation holds between PSi (t) and mi (œÑi , œâi , Œµi ).
Using the above deÔ¨Ånition, we compute the cavity probability PSi‚Üíj (t + 1) as

(A8)

13

PSi‚Üíj (t + 1) =

X

X X

œÑi >t+1 œâi >œÑi Œµi >œâi

X

=

mi‚Üíj (œÑi , œâi , Œµi |T, ¬∑, ¬∑)

X X

X

WSEIR

œÑi >t+1 œâi >œÑi Œµi >œâi {œÑk ,œâk ,Œµk }k‚àà‚àÇi\j

Y  X

=PSi (0)

k‚àà‚àÇi\j

√ó

t
Y

t‚Ä≤ =0

=:PSi (0)



œÑk ,œâk ,Œµk

Y

k‚àà‚àÇi\j

mk‚Üíi (œÑk , œâk , Œµk |œÑi , œâi , Œµi )

I(œÑk < œâk < Œµk )mk‚Üíi (œÑk , œâk , Œµk |T, ¬∑, ¬∑)


1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ )I(œâk ‚â• t‚Ä≤ + 1) ‚àí Œ≤ki I(œâk ‚â§ t‚Ä≤ )I(Œµk ‚â• t‚Ä≤ + 1)

Y

Œ∏k‚Üíi (t + 1),

(A9)

k‚àà‚àÇi\j

Q
Q
where we have replaced k‚àà‚àÇi\j mk‚Üíi (œÑk , œâk , Œµk |œÑi , œâi , Œµi ) in the second line by k‚àà‚àÇi\j mk‚Üíi (œÑk , œâk , Œµk |T, ¬∑, ¬∑) (a
property imposed by the transition kernel and Eq. (A7)) and traced over the œÑi , œâi , Œµi [16]; the message Œ∏k‚Üíi (t + 1) is
deÔ¨Åned as
X

Œ∏k‚Üíi (t + 1) :=

œÑk ,œâk ,Œµk

I(œÑk < œâk < Œµk )mk‚Üíi (œÑk , œâk , Œµk |T, ¬∑, ¬∑)


t 
Y
‚Ä≤
‚Ä≤
‚Ä≤
‚Ä≤
1 ‚àí Œ±ki I(œÑk ‚â§ t )I(œâk ‚â• t + 1) ‚àí Œ≤ki I(œâk ‚â§ t )I(Œµk ‚â• t + 1) ,
√ó

(A10)

t‚Ä≤ =0

which has the physical meaning of the cavity probability that node k (in either exposed or infected state) has not
transmitted the infection signal to node i up to time t + 1. In order to eliminate the explicit dependence on the
microscopic trajectories, we compute the iteration scheme of Œ∏k‚Üíi (t + 1) as
Œ∏k‚Üíi (t + 1) ‚àí Œ∏k‚Üíi (t) =

X

œÑk ,œâk ,Œµk

√ó
√ó

t‚àí1
Y

t‚Ä≤ =0



I(œÑk < œâk < Œµk )mk‚Üíi (œÑk , œâk , Œµk |¬∑)



1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ )I(œâk ‚â• t‚Ä≤ + 1) ‚àí Œ≤ki I(œâk ‚â§ t‚Ä≤ )I(Œµk ‚â• t‚Ä≤ + 1)


‚àí Œ±ki I(œÑk ‚â§ t)I(œâk ‚â• t + 1) ‚àí Œ≤ki I(œâk ‚â§ t)I(Œµk ‚â• t + 1)

=: ‚àí Œ±ki œà k‚Üíi (t) ‚àí Œ≤ki œÜk‚Üíi (t),
(A11)


t‚àí1
Y
X
k‚Üíi
‚Ä≤
‚Ä≤
‚Ä≤
‚Ä≤
œÜ
(t) :=
I(œÑk < œâk < Œµk )
1 ‚àí Œ±ki I(œÑk ‚â§ t )I(œâk ‚â• t + 1) ‚àí Œ≤ki I(œâk ‚â§ t )I(Œµk ‚â• t + 1)
œÑk ,œâk ,Œµk

t‚Ä≤ =0

√ó mk‚Üíi (œÑk , œâk , Œµk |¬∑)I(œâk ‚â§ t)I(Œµk ‚â• t + 1),
(A12)


t‚àí1
Y
X
k‚Üíi
‚Ä≤
‚Ä≤
‚Ä≤
‚Ä≤
œà
(t) :=
I(œÑk < œâk < Œµk )
1 ‚àí Œ±ki I(œÑk ‚â§ t )I(œâk ‚â• t + 1) ‚àí Œ≤ki I(œâk ‚â§ t )I(Œµk ‚â• t + 1)
œÑk ,œâk ,Œµk

t‚Ä≤ =0

√ó mk‚Üíi (œÑk , œâk , Œµk |¬∑)I(œÑk ‚â§ t)I(œâk ‚â• t + 1)

t‚àí1
Y
X
=
I(œÑk < œâk < Œµk )
1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ ) mk‚Üíi (œÑk , œâk , Œµk |¬∑)I(œÑk ‚â§ t)I(œâk ‚â• t + 1),
œÑk ,œâk ,Œµk

t‚Ä≤ =0

(A13)

where we have introduced the message œÜk‚Üíi (t) (the cavity probability that k is in state I but has not transmitted
the infection signal) and œà k‚Üíi (t) (the cavity probability that k is in state E but has not transmitted the infection
signal).
The message œÜk‚Üíi (t) is computed as

14

k‚Üíi

œÜ

(t) =

X

I(œÑk < œâk < Œµk )

t‚àí2
Y



‚Ä≤
‚Ä≤
‚Ä≤
‚Ä≤
1 ‚àí Œ±ki I(œÑk ‚â§ t )I(œâk ‚â• t + 1) ‚àí Œ≤ki I(œâk ‚â§ t )I(Œµk ‚â• t + 1)

t‚àí2
Y



‚Ä≤
‚Ä≤
‚Ä≤
‚Ä≤
1 ‚àí Œ±ki I(œÑk ‚â§ t )I(œâk ‚â• t + 1) ‚àí Œ≤ki I(œâk ‚â§ t )I(Œµk ‚â• t + 1)

t‚Ä≤ =0

œÑk ,œâk ,Œµk



√ó 1 ‚àí Œ±ki I(œÑk ‚â§ t ‚àí 1)I(œâk ‚â• t) ‚àí Œ≤ki I(œâk ‚â§ t ‚àí 1)I(Œµk ‚â• t)


k‚Üíi
√óm
(œÑk , œâk , Œµk |¬∑) I(œâk ‚â§ t ‚àí 1)I(Œµk ‚â• t + 1) + I(Œµk ‚â• t + 1)Œ¥œâk ,t
=

X

I(œÑk < œâk < Œµk )

t‚Ä≤ =0

œÑk ,œâk ,Œµk
k‚Üíi


(œÑk , œâk , Œµk |¬∑) 1 ‚àí Œ≤ki I(œâk ‚â§ t ‚àí 1)I(Œµk ‚â• t + 1)

t‚àí2
Y
X
 k‚Üíi
‚Ä≤
+
I(œÑk < t < Œµk )
1 ‚àí Œ±ki I(œÑk ‚â§ t ) m
(œÑk , t, Œµk |¬∑) 1 ‚àí Œ±ki I(œÑk ‚â§ t ‚àí 1)

√óm

t‚Ä≤ =0

œÑk ,Œµk

=(1 ‚àí Œ≤ki )(1 ‚àí ¬µk )œÜk‚Üíi (t ‚àí 1) +

X

I(œÑk < t < Œµk )

t‚àí1
Y

t‚Ä≤ =0

œÑk ,Œµk




1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ ) mk‚Üíi (œÑk , t, Œµk |¬∑),

(A14)

where the second term in the last line needs to be simpliÔ¨Åed.
To proceed further, we Ô¨Årst compute the update rule of œà k‚Üíi (t) as

X

œà k‚Üíi (t) =

I(œÑk < œâk < Œµk )

t‚àí2
Y

t‚Ä≤ =0

œÑk ,œâk ,Œµk



1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ )





k‚Üíi
√ó 1 ‚àí Œ±ki I(œÑk ‚â§ t ‚àí 1) m
(œÑk , œâk , Œµk |¬∑) I(œÑk ‚â§ t ‚àí 1)I(œâk ‚â• t + 1) + Œ¥œÑk ,t I(œâk ‚â• t + 1)
= (1 ‚àí Œ±ki )
√óm
let

k‚Üíi

X

I(œÑk < œâk < Œµk )

t‚àí2
Y

t‚Ä≤ =0

œÑk ,œâk ,Œµk



1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ )

(œÑk , œâk , Œµk |¬∑)I(œÑk ‚â§ t ‚àí 1)I(œâk ‚â• t + 1) +

‚Ä≤
œâk =œâk
+1,Œµk =Œµ‚Ä≤k +1

X

œâk ,Œµk

I(t < œâk < Œµk )mk‚Üíi (t, œâk , Œµk |¬∑)

===============‚áí
= (1 ‚àí Œ±ki )

X

I(œÑk < œâk‚Ä≤ < Œµ‚Ä≤k )

t‚àí2
Y

t‚Ä≤ =0

‚Ä≤ ,Œµ‚Ä≤
œÑk ,œâk
k



1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ )

√ó (1 ‚àí ŒΩk )mk‚Üíi (œÑk , œâk , Œµk |¬∑)I(œÑk ‚â§ t ‚àí 1)I(œâk‚Ä≤ ‚â• t) +
= (1 ‚àí Œ±ki )(1 ‚àí ŒΩk )œà

k‚Üíi

= (1 ‚àí Œ±ki )(1 ‚àí ŒΩk )œà

k‚Üíi

(t ‚àí 1) +

X

œâk ,Œµk

X

œâk ,Œµk

I(t < œâk < Œµk )mk‚Üíi (t, œâk , Œµk |¬∑)

I(t < œâk < Œµk )mk‚Üíi (t, œâk , Œµk |¬∑)


(t ‚àí 1) ‚àí PSk‚Üíi (t) ‚àí PSk‚Üíi (t ‚àí 1) .

We observed that the message œà k‚Üíi (t) can also be expressed in another form

(A15)

15

œà k‚Üíi (t) =

X

t‚àí2
Y

I(œÑk < œâk < Œµk )

t‚Ä≤ =0

œÑk ,œâk ,Œµk




1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ )



√ó 1 ‚àí Œ±ki I(œÑk ‚â§ t ‚àí 1) mk‚Üíi (œÑk , œâk , Œµk |¬∑)


√ó I(œÑk ‚â§ t ‚àí 1)I(œâk ‚â• t) + Œ¥œÑk ,t I(œâk ‚â• t) ‚àí Œ¥œâk ,t I(œÑk ‚â§ t ‚àí 1)
X

= 1 ‚àí Œ±ki œà k‚Üíi (t ‚àí 1) +
I(t < œâk < Œµk )mk‚Üíi (t, œâk , Œµk |¬∑)
œâk ,Œµk

‚àí

X

I(œÑk < t < Œµk )

t‚àí1
Y

t‚Ä≤ =0

œÑk ,Œµk



1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ ) mk‚Üíi (œÑk , t, Œµk |¬∑)



= 1 ‚àí Œ±ki œà k‚Üíi (t ‚àí 1) ‚àí PSk‚Üíi (t) ‚àí PSk‚Üíi (t ‚àí 1)

t‚àí1
Y
X
‚àí
I(œÑk < t < Œµk )
1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ ) mk‚Üíi (œÑk , t, Œµk |¬∑),
œÑk ,Œµk

(A16)

t‚Ä≤ =0

Comparing Eq. (A15) and Eq. (A16) yields

X

œÑk ,Œµk

I(œÑk < t < Œµk )

t‚àí1
Y

t‚Ä≤ =0


1 ‚àí Œ±ki I(œÑk ‚â§ t‚Ä≤ ) mk‚Üíi (œÑk , t, Œµk |¬∑) = (1 ‚àí Œ±ki )ŒΩk œà k‚Üíi (t ‚àí 1),

(A17)

Inserting Eq. (A17) into Eq. (A14) gives the update rule of œÜk‚Üíi (t)
œÜk‚Üíi (t) = (1 ‚àí Œ≤ki )(1 ‚àí ¬µk )œÜk‚Üíi (t ‚àí 1) + (1 ‚àí Œ±ki )ŒΩk œà k‚Üíi (t ‚àí 1),

(A18)

which closes the update rules of the messages Œ∏i‚Üíj , œÜi‚Üíj , œà i‚Üíj and PSi‚Üíj . Collecting the incoming messages to node
i gives rise to the marginal probability of node i being in state S
Y
PSi (t) = PSi (0)
Œ∏k‚Üíi (t).
(A19)
k‚àà‚àÇi

3.

Probabilities of Being in State E, I, R

Finally, we consider the marginal probabilities of node i in state E, I, R, deÔ¨Åned as
PEi (t) =

X

I(œÑi ‚â§ t < œâi < Œµi )mi (œÑi , œâi , Œµi ),

(A20)

I(œÑi < œâi ‚â§ t < Œµi )mi (œÑi , œâi , Œµi ),

(A21)

X

I(œÑi < œâi < Œµi ‚â§ t)mi (œÑi , œâi , Œµi ),

(A22)

X

I(œÑi < œâi < Œµi ‚â§ t + 1)mi (œÑi , œâi , Œµi )

œÑi ,œâi ,Œµi

PIi (t) =

X

œÑi ,œâi ,Œµi

PRi (t) =

œÑi ,œâi ,Œµi

We Ô¨Årst compute
PRi (t + 1) =

œÑi ,œâi ,Œµi

= PRi (t) +

X

œÑi ,œâi

and notice that

I(œÑi < œâi ‚â§ t)mi (œÑi , œâi , t + 1),

(A23)

16

X

(1 ‚àí ¬µi )PIi (t) = (1 ‚àí ¬µi )
X

=

œÑi ,œâi ,Œµi

œÑi ,œâi ,Œµi

I(œÑi < œâi ‚â§ t < Œµi )mi (œÑi , œâi , Œµi )

I(œÑi < œâi ‚â§ t < Œµi )mi (œÑi , œâi , Œµi + 1)

let Œµ‚Ä≤i =Œµi +1

========‚áí
X
=
I(œÑi < œâi ‚â§ t < Œµ‚Ä≤i ‚àí 1)mi (œÑi , œâi , Œµ‚Ä≤i )
œÑi ,œâi ,Œµ‚Ä≤i

X 

=

œÑi ,œâi ,Œµ‚Ä≤i

I(œÑi < œâi ‚â§ t <
X

= PIi (t) ‚àí
¬µi PIi (t) =

X

œÑi ,œâi

œÑi ,œâi

Œµ‚Ä≤i )


‚àí Œ¥Œµ‚Ä≤i ,t+1 I(œÑi < œâi ‚â§ t) mi (œÑi , œâi , Œµ‚Ä≤i )

I(œÑi < œâi ‚â§ t)mi (œÑi , œâi , t + 1),

I(œÑi < œâi ‚â§ t)mi (œÑi , œâi , t + 1),

(A24)
(A25)

where we have made use of the property Eq. (A4). Inserting Eq. (A25) into Eq. (A23) gives rise to
PRi (t + 1) = PRi (t) + ¬µi PIi (t).

(A26)

Similarly, we compute
PIi (t + 1) =

X

œÑi ,œâi ,Œµi

I(œÑi < œâi ‚â§ t + 1 < Œµi )mi (œÑi , œâi , Œµi ),

= (1 ‚àí ¬µi )PIi (t) +

X

œÑi ,Œµi

I(œÑi ‚â§ t)I(Œµi > t + 1)mi (œÑi , t + 1, Œµi ),

(A27)

and make use of the property Eq. (A6) to compute
(1 ‚àí ŒΩi )PEi (t) = (1 ‚àí ŒΩi )
=

X

œÑi ,œâi ,Œµi

X

œÑi ,œâi ,Œµi

I(œÑi ‚â§ t < œâi < Œµi )mi (œÑi , œâi , Œµi )

I(œÑi ‚â§ t < œâi < Œµi )mi (œÑi , œâi + 1, Œµi + 1)

let œâi‚Ä≤ =œâi +1,Œµ‚Ä≤i =Œµi +1

==============‚áí
X
I(œÑi ‚â§ t < œâi‚Ä≤ ‚àí 1)I(œâi‚Ä≤ < Œµ‚Ä≤i )mi (œÑi , œâi‚Ä≤ , Œµ‚Ä≤i )
=
œÑi ,œâi‚Ä≤ ,Œµ‚Ä≤i

=


X 
I(œÑi ‚â§ t < œâi‚Ä≤ ) ‚àí Œ¥œâi‚Ä≤ ,t+1 I(œÑi ‚â§ t) I(œâi‚Ä≤ < Œµ‚Ä≤i )mi (œÑi , œâi‚Ä≤ , Œµ‚Ä≤i )

œÑi ,œâi‚Ä≤ ,Œµi

= PEi (t) ‚àí
ŒΩi PEi (t) =

X

œÑi ,Œµi

X

œÑi ,Œµ‚Ä≤i

I(œÑi ‚â§ t)I(Œµi > t + 1)mi (œÑi , t + 1, Œµ‚Ä≤i ),

I(œÑi ‚â§ t)I(Œµi > t + 1)mi (œÑi , t + 1, Œµi ).

(A28)
(A29)

Inserting Eq. (A29) into Eq. (A27) gives rise to
PIi (t + 1) = (1 ‚àí ¬µi )PIi (t) + ŒΩi PEi (t).

(A30)

Upon obtaining PSi (t + 1), PIi (t + 1), PRi (t + 1), the probability PEi (t + 1) is given by the normalization condition
PEi (t + 1) = 1 ‚àí PSi (t + 1) ‚àí PIi (t + 1) ‚àí PRi (t + 1),
which closes the DMP equations.

(A31)

17
Appendix B: Modeling Asymptomatic Transmission

As for the COVID-19 epidemic, there are patients who remain asymptomatic prior to recovery. Here, we discuss
how to accommodate potential disease transmissions due to having asymptomatic individuals in our framework.
Patients who do not exhibit symptoms at the time of exposure but developed symptoms at a later time are termed
presymptomatic as described in the main text. There are many possible scenarios to model asymptomatic infections.
One example is that each individual has a certain probability to become either asymptomatic or presymptomatic upon
contracting the virus, in which case an additional asymptomatic state is required to model such stochastic transitions.
The DMP equations can be derived accordingly, but will diÔ¨Äer from those in this study.
Another perspective is based on the observation that whether an exposed individual will develop symptoms or not
seems to vary from person to person, based on age and pre-existing medical condition, e.g., children are more likely
to have mild or no symptoms [24]. In light of this, one can assign each node i a label ‚Ñìi (either probabilistically or
according to additional existing information information), such that ‚Ñìi = 1 if the individual is expected to develop
symptoms when exposed and ‚Ñìi = 0 otherwise. Nodes with diÔ¨Äerent labels may have diÔ¨Äerent epidemiological
parameters. The disease transmission dynamics still obeys the transition rules of Sec. II, and the DMP equations
in Sec. III B also apply. The only diÔ¨Äerence is that when a node i is in state I, one should interpret it as infected
with symptoms if ‚Ñìi = 1, or asymptomatic if ‚Ñìi = 0. In this way, our theoretical framework can readily accommodate
asymptomatic transmission, except that a weighted-version of nonbacktracking is needed to accommodate diÔ¨Äerent
characteristics of symptomatic and asymptomatic individuals.

Appendix C: Modeling Non-contagious presymptomatic Period in SCEIR Model

Another extension of the model is to take into account a possible non-contagious presymptomatic state when the
viral load is too small to infect others. To accommodate this eÔ¨Äect, we introduce an additional compartment called
contracted (C) and deÔ¨Åne the corresponding SCEIR model. In this model, an individual in state S (say node i) who
contracts the virus will Ô¨Årstly assume state C (non-contagious and non-symptomatic), after which that person will
turn into state E (contagious and non-symptomatic) with rate Œªi , and subsequently to states I and R with rates ŒΩi
and ¬µi , respectively. Similar to the SEIR model, we also denote the transmission probabilities from node j in state E
(state I) to a susceptible node i as Œ±ji (Œ≤ji ).
Following a similar derivation from dynamic belief propagation as above, the DMP equations for the SCEIR model
admit the following form
PSi‚Üíj (t + 1) = PSi (0)

X

Œ∏k‚Üíi (t + 1),

(C1)

k‚àà‚àÇi\j
k‚Üíi

k‚Üíi

Œ∏
(t + 1) = Œ∏
(t) ‚àí Œ±ki œà k‚Üíi (t) ‚àí Œ≤ki œÜk‚Üíi (t),
œà k‚Üíi (t + 1) = (1 ‚àí Œ±ki )(1 ‚àí ŒΩk )œà k‚Üíi (t) + Œªk PCk‚Üíi (t),
œÜk‚Üíi (t + 1) = (1 ‚àí Œ≤ki )(1 ‚àí ¬µk )œÜk‚Üíi (t) + (1 ‚àí Œ±ki )ŒΩk œà k‚Üíi (t),


PCk‚Üíi (t + 1) = (1 ‚àí Œªk )PCk‚Üíi (t) ‚àí PSk‚Üíi (t + 1) ‚àí PSk‚Üíi (t) ,

(C2)
(C3)
(C4)
(C5)

where the messages {PSi‚Üíj , Œ∏k‚Üíi , œà k‚Üíi , œÜk‚Üíi } bear the same physical meanings as those in the SEIR model, while
PCk‚Üíi (t) is the cavity probability that node k is in state C in the absence of node i. Upon obtaining these messages,
the marginal probabilities of a node in each state can be computed as
PSi (t + 1) = PSi (0)
PCi (t + 1) =
PRi (t
PIi (t
PEi (t

+ 1) =
+ 1) =
+ 1) =

X

Œ∏k‚Üíi (t + 1),

k‚àà‚àÇi


(1 ‚àí Œªi )PCi (t) ‚àí PSi (t + 1) ‚àí PSi (t) ,
PRi (t) + ¬µi PIi (t),
(1 ‚àí ¬µi )PIi (t) + ŒΩi PEi (t),
1 ‚àí PSi (t + 1) ‚àí PCi (t + 1) ‚àí PIi (t + 1)

which starts from certain initial condition PœÉi (0), œÉ ‚àà {S, C, E, I, R}.

(C6)
(C7)

‚àí PRi (t + 1),

(C8)
(C9)
(C10)

18
Appendix D: Contact Networks
1.

Realistic Networks

The realistic contact networks are taken from data sets obtained from the SocioPatterns collaboration website [32],
where the face-to-face contacts were recorded through wearable sensors over a certain period. Each data set contains
a lists of active contacts between two individuals lasting for 20 seconds and the membership information of each
individual (belonging to a class or department). To build the contact network, we Ô¨Årst aggregate the contacts
between any two individuals i and j, and consider the link between node i and node j as active if the cumulative
contact duration between them in the recording period is not less than 60 seconds. A more precise treatment is to
retain the information of contact duration in the transmission probabilities Œ≤ji , Œ±ji . However, this results in a graph
with a weighted nonbacktracking (NB) matrix, which complicates the analysis. For simplicity, we only preserve the
topological information of the resulting networks, keeping in mind that the contact duration information can also be
incorporated in our framework. In this paper, we consider contact networks in a primary school (PS2014) [50], a high
school (HS2013) [48] and workplaces (WP2013, WP2015) [51, 52].
2.

Artificial Networks

ArtiÔ¨Åcially generated networks are also considered in this paper, including Erd≈ës‚ÄìR√©nyi (ER) random graphs, random networks with community structures, scale-free networks and random networks with planted subgraph structures.
a.

Random Networks with Community Structure

Random networks with community structures are generated through the stochastic block model. It is speciÔ¨Åed by a
list of population of each block (n1 , n2 , ..., nr ) and a r √ó r symmetric probability matrix Pab , where r is the number of
blocks. Suppose node i is assigned to block a and node j is assigned to block b, then node i and node j are connected
with probability Pab . The average number of neighbors of node i (assigned to block a) belonging to block b is given
by
(
Paa (na ‚àí 1) if a = b,
cab =
(D1)
Pab nb
otherwise.
b.

Scale-free Networks

The scale-free networks are generated through the conÔ¨Åguration model. We Ô¨Årst generate a degree sequence
(d1 , d2 , ..., dN ) of size N where each element follows the power law distribution
d‚àíŒ≥
P (di ) = Pdmaxi

dj =dmin

d‚àíŒ≥
j

,

(D2)

where dmin and dmax are the minimum and maximum of the admissible degrees. In this study, we set dmin = 5 and
dmax = 100, considering the maximal number of people that one contacts can not be arbitrarily large. After assigning
a degree to each node, we randomly connect diÔ¨Äerent nodes such that each node i has di connections. The resulting
graph may have a few self-loops and multiple edges between two nodes, which are simply removed to form a simple
graph.
c.

Random Networks with Planted Subgraph Structures

We also look at random networks with planted subgraph structures, primarily for the purpose of examining the
eÔ¨Äect of localization. Following [45], we consider the ER random graph (with average degree hdi) with a planted hub
(of degree dh ), which is constructed by adding a hub to the existing ER network through creating connections from the
hub to dh randomly selected nodes. When dh is large enough, i.e., dh > hdi(hdi + 1), it is argued that the eigenvector
centrality (i.e., the leading eigenvector of the adjacency matrix) is localized at the hub, while the nonbacktracking

19

30

60
t

90

i

i

16

PI (t)]

24

(c) 40

8
00

[PE (t) +

32

RRG, no. of seeds = 2
IBMF
DMP
MC

i

8
00

i

i

16

PI (t)]

24

(b) 40

[PE (t) +

32

RRG, no. of seeds = 1
IBMF
DMP
MC

i

i

i

[PE (t) +

i

PI (t)]

(a) 40

30

60

90

32
24

RRG, no. of seeds = 5
IBMF
DMP
MC

16
8
00

30

t

60

90

t

P
Figure 8. Evolution of the average number of individuals in state E or I, i.e., i [PEi (t) + PIi (t)] vs t. The underlying network is
a random regular graph with N = 100, d = 10. The parameters are T = 100, ŒΩ = 0.2, ¬µ = 0.125, Œ≤ = 0.03, Œ± = Œ≤/2. The initial
exposed nodes are randomly selected. (a) One initial exposed node. (b) Two initial exposed nodes. (a) Five initial exposed
nodes. In general, when there are more initial seeds, the approximation accuracy of the theory becomes better.

centrality does not suÔ¨Äer from localization [45]. The intuition behind the localization of eigenvector centrality is that
the hub and its neighbors are reinforcing each other, similar to the mutual infection eÔ¨Äect of the IBMF approach to
epidemic spreading. The NB centrality avoids this problem due to the hub by forbidding one-step backtracking.
On the other hand, it is noticed in [45] that a relatively large clique (i.e., a complete subgraph) can cause the NB
centrality to localize as well. Therefore, we consider the ER random graph (with average degree hdi) with a planted
clique (of size Nclique ), which is constructed by randomly selecting Nclique nodes of the existing ER network to form
a complete subgraph. For the original ER graph, the leading eigenvalue of the NB matrix B is given by Œªmax
‚âà hdi.
B
In the presence of the clique, the leading eigenvalue satisÔ¨Åes Œªmax
> Nclique ‚àí 2, which can easily exceed hdi for
B
large Nclique , so that the NB centrality is dictated by the clique [45]. There are also other subgraph structures that
can cause the NB centrality to localize, such as dense subgraphs and overlapping hubs [47]. The intuition behind
the localization of the NB centrality is that there is a subgraph sharing many neighbors, and avoiding one-step
backtracking is insuÔ¨Écient to counteract the self-reinforcement among them.

Appendix E: Additional Experiments
1.

Approximation Accuracy of the Theory on Different Networks

In this Appendix, we give more examples of spreading processes experiments to support the Ô¨Åndings in the main
text. In Fig. 8, it is shown that the approximation accuracy of the theories improves as the number of initial exposed
nodes increases; we expect that it also depends on the locations of the initial seeds.
In Fig. 9, we examine the theoretical results on ER random networks with diÔ¨Äerent average degrees and/or diÔ¨Äerent
planted subgraph structures. We remark that there is no absolute fair comparison among diÔ¨Äerent networks, as they
have diÔ¨Äerent dependencies on the epidemiological parameters (e.g., as in Fig. 3 of the main text). Here, we Ô¨Åx the
values of ŒΩ, ¬µ and let Œ± = Œ≤/2, and choose Œ≤ such that approximately 70% of the population have contracted the
disease in the Ô¨Ånal time T = 100. Fig. 9 demonstrates that the IBMF approach becomes a better approximation when
the network is denser. This implies that the DMP approach is superior to the IBMF approach, especially in sparsely
connected networks. When the average degree becomes higher, the trajectories obtained by the IBMF equations are
approaching those by the DMP equations. In the limit of very dense random networks, the mass-action approximation
becomes a good approximation [9]. As mentioned before, a planted hub of relatively large degree can cause the leading
eigenvector of the adjacency matrix A to localize [45], which impairs the accuracy of the IBMF approach. We show
in Fig. 9(b) that such a planted hub does not have a noticeable eÔ¨Äect on the approximation accuracy of the DMP
approach. However, a planted clique which can cause the nonbacktracking centrality to localize [45, 47], does impair
the approximation accuracy of the DMP approach, as shown in Fig. 9(c).
In Fig. 9, we examine the theories on the networks extracted from contact data obtained in the SocioPatterns
collaboration. The approximation accuracy of the HS2013 network is much poorer than the other networks, which
may be attributed to the weakly localization of the nonbacktracking centrality as shown in Fig. 13.

60

i

00

90

30

d

10)

10
60

5

IBMF
DMP
MC

15
00

90

30

d

20)

(f) 40

24
IBMF
DMP
MC
60

16
8
00

90

30

t

60

 ‚âà

90

t

32

[PEi (t) + PIi (t)]

20

30

 ‚âà

ER(

(e) 40

IBMF
DMP
MC

30

00

d

t

i

[PEi (t) + PIi (t)]

40

ER(

60

[PEi (t) + PIi (t)]

 ‚âà

15

t

(d)

30

i

30

45

  ‚âà ) + clique

ER(

i

IBMF
DMP
MC

(c) 60

i

i

15
00

i

5

i

30

d

PI (t)]

45

i

IBMF
DMP
MC

i

i

  ‚âà ) + hub

ER(

(b) 60

5

PI (t)]

d

[PE (t) +

 ‚âà )

ER(

[PE (t) +

30

i

PI (t)]

45

[PE (t) +

(a) 60

20

90

ER(

d

40)

32
24
16
8
00

t

30

IBMF
DMP
MC
60

90

t

P i
i
Figure 9.
i [PE (t) + PI (t)] vs t. The networks are ER random graphs of size N = 200 with different average degrees and/or
different planted subgraph structures. The systems start with 5 initial exposed nodes. The parameters are T = 100, ŒΩ =
0.2, ¬µ = 0.125, Œ± = Œ≤/2, while Œ≤ is selected such that in the final time T = 100, approximately 70% of the population has
contracted the disease. Comparing panels (a),(d),(e),(f), it is observed that the IBMF approach becomes a better approximation
when the network is denser (i.e., hdi is larger). In panel (b), a planted hub of degree dh = 40 is created in the networks; the
DMP approach is still a rather good approximation in this case. In panel (c), a planted clique (or complete subgraph) of size
Nclique = 20 is created in the networks; the approximation accuracy of the DMP approach is comparable poorer than other
networks.
Œ≤ = 0.01

0.09

Œ≤ = 0.013

relative frequency

(b)10-1

0.12

10-2

Œ≤ = 0.0115

10-3

1‚àí

i

i

PS (t)/N

(a)

0.06

10-4

0.00
0

Œ≤ = 0.01
Œ≤ = 0.0115
Œ≤ = 0.013

10-5

0.03

100

200

300

t

400

500

10-6

101

102
103
outbreak size

Figure 10. Evolution and distribution of the epidemic outbreak on a random regular graph with N = 6400, d = 10 in MC
simulation. The systems start with 5 initial exposed nodes. The parameters are ŒΩ = 0.2, ¬µ = 0.125,
PŒ± = Œ≤/2. The critical point
is given by Œ≤c ‚âà 0.0115. (a) Fraction of nodes that has contracted the disease, defined as 1 ‚àí i PSi (t)/N , as a function of
P
time. (b) Distribution of outbreak size at large time, i.e., i PRi (‚àû).

2.

Evolution and Distribution of the Epidemic Outbreak

P
In Fig. 4 of the main text, the normalized outbreak size at large time r = i PRi (‚àû)/N was used to identify the
critical point Œ≤c of the SEIR model. In Fig. 10(a), we show the transient evolution
of the normalized outbreak size,
P
which is deÔ¨Åned by the fraction of nodes that has contracted the disease as 1 ‚àí i PSi (t)/N . The normalized outbreak
size increases only gently near criticality, while it grows rapidly above the critical point Œ≤c .
As the epidemic outbreaks are triggered by a few initial seeds, there is always a small probability that the disease
will die out before spreading out further (e.g., the infected node transforming into state R much faster than average,
or the infection signal not being transmitted to neighbors). This can also happen when Œ≤ > Œ≤c , indicating that there
are some instances where the outbreak size is small although the system is in the global-epidemic phase, as shown in
Fig. 10(b). This phenomenon has been observed in the SIR model [29, 41]. While the theoretical frameworks only
concern the average behaviors, they do not capture such variability of trajectories due to stochastic Ô¨Çuctuations. A
detailed theoretical investigation into these aspects will be an interesting topic for future studies.

21

0.25

uÃÉ

in

eig(A)
degree

0.00
20

40

60

80

œÅ(centrality, 1

œÅ(centrality, 1

0.50

0



ER(

d=5

) + hub

(c)

0.75

‚àíP

0.75

1.00

S (t))

(b)

100

0.50
uÃÉ

0.25
0.00
0

t

1.00



ER(

d=5

) + clique

0.75

‚àíP

)

S (t))

d=5

in

eig(A)
degree

20

40

60

80

100

œÅ(centrality, 1



ER(

1.00

‚àíP

S (t))

(a)

0.50
uÃÉ in

0.25
0.00
0

eig(A)
degree

20

t

40

60

80

100

t

Figure 11. Correlation coefficient œÅ between various centrality measures and the outbreak profile 1 ‚àí PS (t), as a function of
time. Here, eig(A) stands for the eigenvector centrality and uÃÉin is the NB centrality. The networks and the parameter settings
correspond to those in Figs. 9(a)(b)(c).

3.

Nonbacktracking Centrality

As mentioned in the main text and in Sec. E 1, the degradation in accuracy of the approximation of the theory
(IBMF or DMP method) is correlated with the localization phenomenon of the corresponding centrality measure,
where the centrality values of a few nodes are much larger than the others. We have showcased this in Fig. 9
by considering some planted subgraph structures in a random network. We further examine the prediction of the
centrality measures on the outbreak proÔ¨Åles in these planted random networks. In Fig. 11(a), it is shown that in
the ER graph, both the eigenvector centrality and the NB centrality (coming from the linear approximation of the
IBMF and DMP approaches), as well as the degree, are good predictors of the outbreak proÔ¨Åle, despite the poor
approximation of the full nonlinear IBMF approach in Fig. 9(a). On the other hand, a planted hub causing the
eigenvecter centrality to localized, degrades its prediction accuracy as shown in Fig. 11(b), while the NB centrality
appears to be a much better predictor. In the presence of a clique, the NB centrality also predicts the outbreak poorly
as shown in Fig. 11(c) due to the localization phenomenon.
In all three cases, the degree appears to be a good predictor of the outbreak proÔ¨Åle; in random networks, having
more neighbors usually implies a higher chance to contract the disease. However, this does not hold in general, e.g.,
consider a hub connected to many dangling nodes but linked to the bulk of the network through only a few edges,
such a hub node is not likely to be at high risk as indicated by its degree.
It has been shown in Fig. 12 that the approximation accuracy of the HS2013 network is much poorer than the other
networks from the SocioPatterns data sets. In Fig. 13, we show the NB centralities on the corresponding networks.
Comparing to other networks, the NB centrality uÃÉin of HS2013 concentrates on two communities, which may cause
the approximation of the DMP equations to be less accurate.

Appendix F: Additional Details on The Derivation of Epidemic Threshold
1.

Perron-Frobenius Theorem

For a non-negative matrix X which satisÔ¨Åes Xij ‚â• 0, the Perron-Frobenius (PF) theorem asserts that (i) the
spectral radius œÅ(X) is an eigenvalue of X, which implies that the leading eigenvalue of X (deÔ¨Åned as the eigenvalue
having the largest real part) satisÔ¨Åes Œªmax
= œÅ(X), which is real and non-negative and (ii) there is a nonnegative and
X
nonzero vector u (satisfying ui ‚â• 0, u 6= 0) such that Xu = œÅ(X)u; more properties of the leading eigenvalue and
eigenvector can be deduced if the matrix X is irreducible [38].

2.

Leading Eigenvalue of the Jacobian of the DMP Equations

In the main text, we have shown that the eigenvalue of the Jacobian J and the eigenvalue of the nonbacktracking
matrix has the relation
ŒªB =

ŒªJ ‚àí (1 ‚àí Œ±)(1 ‚àí ŒΩ)
(1‚àíŒ±)ŒΩ
Œ± + Œ≤ ŒªJ ‚àí(1‚àíŒ≤)(1‚àí¬µ)

,

(F1)

22
WP2013

i

10
5
00

i

15

PI (t)]

20

30

60

WP2015

(b)

IBMF
DMP
MC

i

i

i

[PE (t) +

i

PI (t)]

25

[PE (t) +

(a)

40
30
20
10
00

90

IBMF
DMP
MC

30

t

PS2014

(d)

30

40

IBMF
DMP
MC

i

20

60

i

40

10
00

90

HS2013

80

PI (t)]

IBMF
DMP
MC

i

i

i

[PE (t) +

i

PI (t)]

50

[PE (t) +

(c)

60
t

30

60

20
00

90

t

30

60

90

t

P i
i
Figure 12.
i PE (t) + PI (t) vs t. The networks are extracted from contact data obtained in the SocioPatterns collaboration.
The systems start with 5 initial exposed nodes. The parameters are T = 100, ŒΩ = 0.2, ¬µ = 0.125, Œ± = Œ≤/2, while Œ≤ is selected
such that in the final time T = 100, approximately 70% of the population has contracted the disease. The approximation
accuracy of the HS2013 network is much poorer than the other networks.
(a)

WP2013

(b)

WP2015

(c)

PS2014

(d)

HS2013

Figure 13. NB centrality uÃÉin of contact networks from the SocioPatterns data. The marker size of node i is proportional to
the NB centrality value uÃÉin
i .

which can be solved for ŒªJ , leading to

1
¬±
ŒªJ = (1 ‚àí Œ±)(1 ‚àí ŒΩ) + (1 ‚àí Œ≤)(1 ‚àí ¬µ) + Œ±ŒªB
2

q
2
¬±
(1 ‚àí Œ±)(1 ‚àí ŒΩ) ‚àí (1 ‚àí Œ≤)(1 ‚àí ¬µ) + Œ±ŒªB + 4(1 ‚àí Œ±)ŒΩŒ≤ŒªB .

(F2)

23

¬µ = 0.01
¬µ = 0.02
¬µ = 0.04

0.045

Œ±

0.030

0.015

0.000
0.000

0.015

Œ≤

0.030

Figure 14. Phase boundary of the SEIR model in the (Œ≤, Œ±)-plane. The parameters used are ŒΩ = 0.05, Œªmax
= 2.
B

From this relation, one can Ô¨Ågure out the principal eigenvalue of J . Noticing that Œªmax
= œÅ(J ) ‚â• 0, Œªmax
= œÅ(B) ‚â• 0
J
B
+
due to the Perron-Frobenius theorem, we can focus on ŒªJ and ŒªB ‚àà R since the eigenmode with a fastest growth rate
will not be realized by negative or complex eigenvalue of J . We also assume that œÅ(J ) and œÅ(B) are non-zero. To
simplify the notation,
denote a = (1 ‚àí Œ±)(1 ‚àí ŒΩ), b = (1 ‚àí Œ±)ŒΩ,

 c = (1 ‚àí Œ≤)(1 ‚àí ¬µ), all of which are nonnegative, such
p
+
that ŒªJ (ŒªB ) = 12 a + c + Œ±ŒªB + (a ‚àí c + Œ±ŒªB )2 + 4bŒ≤ŒªB . We Ô¨Årst consider the case ŒªB > 0


dŒª+
(a ‚àí c + Œ±ŒªB ) + 2bŒ≤
Œ±
J
Œ±
1+ p
=
dŒªB
2
(a ‚àí c + Œ±ŒªB )2 + 4bŒ≤ŒªB


(a ‚àí c + Œ±ŒªB )
Œ±
1+ p
>
2
(a ‚àí c + Œ±ŒªB )2 + 4bŒ≤ŒªB
> 0,

where we have made use of the fact that

2bŒ≤
Œ±

(a‚àíc+Œ±ŒªB )
(a‚àíc+Œ±ŒªB )2 +4bŒ≤ŒªB

> 0 and ‚àö

(F3)

< 1 by assuming ŒªB > 0. It implies that

maxŒªB >0 Œª+
J (ŒªB )

+
+
max
= Œª+
J (ŒªB ). Furthermore, it can be easily shown that ŒªJ (x) ‚â• ŒªJ (‚àíx) for x ‚â• 0, which leads
+
+
max
the fact that ‚àÄŒªB < 0, Œª+
J (ŒªB ) < ŒªJ (|ŒªB |) < ŒªJ (ŒªB ). Hence, we can conclude that the maximal eigenvalue of J
+
max
max
given by ŒªJ = ŒªJ (ŒªB ), i.e.,

Œªmax
=
J


1
(1 ‚àí Œ±)(1 ‚àí ŒΩ) + (1 ‚àí Œ≤)(1 ‚àí ¬µ) + Œ±Œªmax
B
2 q
2
1
+
(1 ‚àí Œ±)(1 ‚àí ŒΩ) ‚àí (1 ‚àí Œ≤)(1 ‚àí ¬µ) + Œ±Œªmax
+ 4(1 ‚àí Œ±)ŒΩŒ≤Œªmax
B
B .
2

to
is

(F4)

max
The epidemic threshold is obtained by solving Œªmax
J (Œ≤, Œ±, ŒΩ, ¬µ, ŒªB ) = 1. The resulting phase boundaries are in
general nonlinear, which is more prominent in networks with sparse structures (especially relevant when contact and
travel restrictions are enforced) and for disease with a long incubation period. We illustrate this in an example in
Fig. 14.

3.

Epidemic Threshold by the IBMF Approach

Similar to the DMP approach, we can also derive the epidemic thresholds through the individual-based mean-Ô¨Åeld
(IBMF) approach. The initial disease-free state is perturbed inÔ¨Ånitesimally as PSi (0) = 1 ‚àí «´i , in which case the
probabilities PEi (t) and PIi (t) are also of order «´i in the initial stage. We expand Eq. (8) and neglect terms of higher
order of «´i , leading to
X

PEi (t + 1) ‚âà (1 ‚àí ŒΩi )PEi (t) + PSi (t)
Œ±ki PEk (t) + Œ≤ki PIk (t) .
(F5)
k‚àà‚àÇi

Equations (F5) and (9) constitute a linear dynamical system of the probabilities {PEi (t), PIi (t)}. They can be written
in the matrix form as

24


PE (t + 1)
PI (t + 1)



= J MF



PE (t)
PI (t)



,

where the 2N √ó 2N Jacobian matrix J MF is deÔ¨Åned as


(1 ‚àí ŒΩ)I + Œ±A
Œ≤A
MF
,
J
=
ŒΩI
(1 ‚àí ¬µ)I

(F6)

(F7)

where I is the identity matrix and A is the adjacency matrix of the graph. The spectral radius œÅ(J MF ) determines
the growth rate of the fastest mode of Eq. (F6). Due to the Perron-Frobenius theorem, œÅ(J MF ) equals the leading
MF
eigenvalue Œªmax
, which is related to the leading eigenvalue Œªmax
of the adjacency matrix of the graph. A
A
J MF of J
similar argument as in the DMP approach results in
Œªmax
J MF =


1
(1 ‚àí ŒΩ) + (1 ‚àí ¬µ) + Œ±Œªmax
A
2 q
2
1
+
(1 ‚àí ŒΩ) ‚àí (1 ‚àí ¬µ) + Œ±Œªmax
+ 4ŒΩŒ≤Œªmax
A
A .
2

(F8)

max
The epidemic threshold is obtained by solving Œªmax
J MF (Œ≤, Œ±, ŒΩ, ¬µ, ŒªA ) = 1.

Appendix G: Basic Reproduction Number of The SEIR Model

In this appendix, we provide a simple estimation of the basic reproduction number R0 for the SEIR model under
investigation, which is deÔ¨Åned as the expected number of secondary infections from a single infection in a population
where all subjects are susceptible. We assume at time t = 0, a node randomly chosen from the network is exposed to
the virus. The exposed node has hdi susceptible neighbors on average; the average number of neighbors it infects is
computed as
R0 = hdi

‚àû 
X
t=1

(1 ‚àí ŒΩ)t‚àí1 Œ± +

t
X


(1 ‚àí ŒΩ)œâ‚àí2 ŒΩ(1 ‚àí ¬µ)t‚àíœâ Œ≤ ,

(G1)

œâ=2

where œâ is the time that the initial exposed node turns into the infectious state and we have assumed that at the
same step, the process E ‚Üí I or I ‚Üí R occurs after the infection being transmitted. The above expression can be
simpliÔ¨Åed as



1‚àíŒΩ t‚àí1
t‚àí2


(1
‚àí
¬µ)
1
‚àí
‚àû
1‚àí¬µ
X
(1 ‚àí ŒΩ)t‚àí1 Œ± +
R0 =hdi
ŒΩŒ≤
1‚àíŒΩ
1 ‚àí 1‚àí¬µ
t=1

‚àû 
X
(1 ‚àí ¬µ)t‚àí1 ‚àí (1 ‚àí ŒΩ)t‚àí1
t‚àí1
ŒΩŒ≤
(1 ‚àí ŒΩ) Œ± +
=hdi
ŒΩ ‚àí¬µ
t=1



1
ŒΩŒ≤
1
Œ±
+
‚àí
=hdi
ŒΩ
ŒΩ ‚àí¬µ ¬µ ŒΩ


Œ± Œ≤
=hdi
.
(G2)
+
ŒΩ
¬µ
The R0 deÔ¨Åned in this way only captures the average number of contacts through hdi, but neglects higher order
structures of the contact networks which could be very heterogeneous.
Appendix H: The Leading Eigenvalue and Eigenvector of Matrix B
1.

Reduction from Matrix B to Matrix M

In the main text, we claimed that the spectrum of the 2|E| √ó 2|E| nonbacktracking matrix can be obtained from a
much smaller 2N √ó 2N matrix M deÔ¨Åned as

25
M=



0 D ‚àí IN
‚àíIN
A



,

(H1)

where IN is the N -dimensional identity matrix. The reduction to Eq. (H1) is a manifest of the Ihara-Bass formula [57],
where an intuitive derivation of the reduction can be found in Ref. [36]. The Ihara-Bass formula has also been
generalized to weight graphs and linked to Bethe free energy in belief propagation [40], which is relevant in our study
when heterogeneous transmission probabilities {Œ≤ij , Œ±ij } are considered.
For completeness, we provide a derivation using the matrix notation in this section. To this end, we deÔ¨Åne the
N √ó 2|E| source matrix S and target matrix T
(
1 if node i is the source of directed edge e, i.e., ‚àÉj, e = i ‚Üí j,
Sie =
(H2)
0 otherwise,

Tie =

(

1 if node i is the target of directed edge e, i.e., ‚àÉj, e = j ‚Üí i,
0 otherwise,

(H3)

and a 2|E| √ó 2|E| auxiliary matrix
J=



0
I2|E|

I2|E|
0



,

(H4)

where I2|E| is the 2|E|-dimensional identity matrix. We further index the set of directed edges according to the order
(e1 , ...e|E| , e|E|+1 , ...e2|E| ) such that for n ‚â§ |E|, en = i ‚Üí j, one has en+|E| = j ‚Üí i. Under this notation, the
nonbacktracking matrix B can be written as
B = S ‚ä§ T ‚àí J.

(H5)

ST ‚ä§ = T S ‚ä§ = A,
SS ‚ä§ = T T ‚ä§ = D,
SJ = T ,
T J = S,

(H6)
(H7)

It can also be easily veriÔ¨Åed that

The key element of the derivation in Ref. [36] is that for a given 2|E|-dimensional u, one deÔ¨Ånes the corresponding
N -dimensional incoming and outgoing vectors
X
X
uin
uj‚Üíi ,
uout
=
ui‚Üíj ,
(H8)
i =
i
j‚àà‚àÇi

j‚àà‚àÇi

which can be expressed in the matrix form as
uin = T u,

uout = Su.

(H9)

Consider the vectors (Bu)out and (Bu)in , written in the matrix form as
SBu = S(S ‚ä§ T ‚àí J)u = SS ‚ä§ T u ‚àí SJu
= DT u ‚àí T u = (D ‚àí IN )(T u),
‚ä§

(H10)

‚ä§

T Bu = T (S T ‚àí J)u = T S T u ‚àí T Ju
= A(T u) ‚àí (Su),

(H11)

where we have made used of the relations in Equations (H6) and (H7). The above expressions can be written as







Su
Su
0 D ‚àí IN
S 0
,
(H12)
=: M
Bu =
Tu
Tu
‚àíIN
A
0 T
where we identify the matrix M deÔ¨Åned in Eq. (H1). Now suppose u is an eigenvector of B with eigenvalue ŒªB , then
Eq. (H12) leads to




Su
Su
.
(H13)
= ŒªB
M
Tu
Tu

26
  out 
u
Su
or
is the eigenvector of M with eigenvalue ŒªB . Therefore, we can work with the
Tu
uin
much smaller matrix M for computing the spectrum of the nonbacktracking matrix B.
in
Physically, this reduction comes from compressing the edge-based data {ui‚Üíj } to node-based data {uout
i , ui }. In
the context of spreading processes, they correspond to edge-based messages and node-based marginal probabilities,
e.g., the cavity probability PSi‚Üíj in the linearized dynamics satisÔ¨Åes
X 

Œ±œà k‚Üíi (t) + Œ≤œÜk‚Üíi (t) ,
(H14)
PSi‚Üíj (t + 1) ‚âà PSi‚Üíj (t) ‚àí
which implies that



k‚àà‚àÇi\j

while the marginal probability satisÔ¨Åes
PSi (t + 1) ‚âà PSi (t) ‚àí
where the probability of newly infection
messages as Œ±œà in (t) + Œ≤œÜin (t).
2.

P

k‚àà‚àÇi

X

Œ±œà k‚Üíi (t) + Œ≤œÜk‚Üíi (t) ,

(H15)

k‚àà‚àÇi

 k‚Üíi

Œ±œà
(t) + Œ≤œÜk‚Üíi (t) corresponds to the incoming vectors of the

Eigenvalues and Eigenvectors of Matrix M

Consider the eigenvalue equation of M
 out 

  out 
u
u
0 D ‚àí IN
,
=
Œª
M
‚àíIN
A
uin
uin

(H16)

or explicitly
(

(D ‚àí IN )uin = ŒªM uout ,
‚àíuout + Auin = ŒªM uin .

The above equations can be reduced to a nonlinear eigenvalue problem
 2

ŒªM I ‚àí ŒªM A + (D ‚àí I) uin = 0,

(H17)

(H18)

and implies a relation between the outgoing-component uout and the incoming-component uin of the eigenmode as
uout
=
i

di ‚àí 1 in
u .
ŒªM i

(H19)

In the main text, it is argued that the leading eigenvector of the matrix B (denoted as uÃÉ), and the corresponding
incoming vector uÃÉin = T uÃÉ (i.e., the nonbacktracking centrality), are useful in predicting the outcome of the epidemics.
From the analysis in this section, both the leading eigenvalue Œªmax
and the nonbacktracking centrality uÃÉin can be
B
obtained through the matrix M , which signiÔ¨Åcantly reduces the computational complexity. The Perron-Frobenius
theorem guarantees that the leading eigenvector uÃÉ of the matrix B can be chosen to be non-negative, so does the
nonbacktracking centrality uÃÉin .
3.

Exact Expression in Random Regular Graphs

The leading eigenvalue of the matrix M can be computed exactly for random regular graphs. We Ô¨Årst notice that
the smallest eigenvalue of the Laplacian matrix L = D ‚àí A of a graph is Œªmin
= 0 [58]. For regular graphs with degree
L
d, we have D = dI, and therefore L commutes with A. It suggests that the largest eigenvalue of A is
Œªmax
= d.
A

(H20)



d‚àí1
uin ,
Au = ŒªM +
ŒªM

(H21)

Equation (H18) can be expressed as
in

27
which implies that


ŒªM +

d‚àí1
ŒªM



is an eigenvalue of the adjacency matrix A with eigenvalue uin , denoted as ŒªA . The

eigenvalue ŒªM of M is related to ŒªA as
ŒªM =



q
1
ŒªA ¬± Œª2A ‚àí 4(d ‚àí 1) .
2

Therefore, the leading eigenvalue Œªmax
of M , which is equal to the leading eigenvalue Œªmax
M
B , is identiÔ¨Åed as


q

1 max
max
max 2 ‚àí 4(d ‚àí 1)
Œª
+
Œª
Œªmax
=
Œª
=
M
B
A
2 A
= d ‚àí 1.
4.

(H22)

(H23)

Approximations of the Œªmax
in Uncorrelated Random Networks
B

For uncorrelated random networks, approximate expressions of the leading eigenvalue Œªmax
can be derived, which
B
can be useful for estimating epidemics properties in large networks. In the annealed approximation where only the
information of the degree distribution P (d) is retained, Œªmax
is approximated as [36, 45]
B
Œªmax,an
‚âà
B

hd2 i ‚àí hdi
.
hdi

(H24)

In a more reÔ¨Åned approximation assuming uncorrelated networks but taking into neighborhood information, Œªmax
is
B
approximated as [47]
P
ij (di ‚àí 1)Aij (dj ‚àí 1)
max,un
P
.
(H25)
ŒªB
‚âà
i di (di ‚àí 1)

To examine the validity of the uncorrelated random network assumption, we consider the degree correlation coeÔ¨Écient [49]
max

d
1 X
rd = 2
kl(ekl ‚àí qk ql ),
œÉ

(H26)

k,l=1

where ekl is the element of the degree correlation matrix (i.e., the probability of Ô¨Ånding an edge connecting two nodes
(k)
of degree k and degree l), qk = kPhdi
(with P (k) being the degree distribution) is the probability of Ô¨Ånding an edge
Pdmax 2 2
Pdmax
is the variance of the measure q. The neutrality
whose one end has degree k, and œÉ 2 = k=1 k 2 qk ‚àí
k=1 k qk
condition rd = 0 needs to be (at least roughly) satisÔ¨Åed for a network to be uncorrelated.
In Table. I, we examine the approximations oÔ¨Äered by Eqs (H24) and (H25) for the networks considered in this
paper. In general, Œªmax,un
provides a better approximation than Œªmax,an
, both of which predict Œªmax
quite well
B
B
B
when rd is low. The two cases with a relatively poor approximation (especially for Œªmax,an
)
are
the
SBM
network
B
with c11 = 30 and the ER network with a clique. These two networks exhibit high values of the degree correlation
coeÔ¨Écient rd , violating the assumption of uncorrelated random network. On the other hand, the existence of dense
subgraph structures can cause localization of the NB centrality, which also makes the approximation inaccurate. In
light of this, it has been proposed in Ref. [47] to identify some characteristic subgraph structures for an improved
approximation of Œªmax
B .

[1] Yixuan Wang, Yuyi Wang, Yan Chen, and Qingsong
Qin, ‚ÄúUnique epidemiological and clinical features of the
emerging 2019 novel coronavirus pneumonia (COVID-19)
implicate special control measures,‚Äù Journal of Medical

Virology 92, 568‚Äì576 (2020).
[2] Ruiyun Li, Sen Pei, Bin Chen, Yimeng Song, Tao Zhang,
Wan Yang, and Jeffrey Shaman, ‚ÄúSubstantial undocumented infection facilitates the rapid dissemination of

28
network
ER(hdi ‚âà 20)
SBM, c11 = 10
SBM, c11 = 20
SBM, c11 = 30
WP2013
WP2015
PS2014
HS2013
SF, Œ≥ = 2
SF, Œ≥ = 2.5
SF, Œ≥ = 3
SF, Œ≥ = 3.5
ER(hdi ‚âà 5)
ER(hdi ‚âà 5) + hub
ER(hdi ‚âà 5) + clique

N
200
200
200
200
91
213
242
326
400
400
400
400
200
200
200

hdi
20.09
21.94
24.64
27.15
8.55
21.22
36.65
20.47
13.29
10.18
8.4
7.48
5.2
5.54
7.05

Œªmax
B
20
21.79
26.19
33.26
10.17
24.49
42.18
25.19
24.43
16.75
11.27
8.55
5.02
6.05
18.15

max,an
ŒªB
20.02
21.8
25.38
29.9
10.26
24.2
40.64
23.38
25.9
17.87
12.14
8.88
5.1
6.48
11.09

max,un
ŒªB
20
21.8
25.8
31.59
10.08
24.34
41.57
23.64
24.48
16.83
11.36
8.67
5.04
6.08
15.31

rd
-0.0182
-0.0041
0.2419
0.4274
-0.0525
0.0432
0.1993
0.0774
-0.0773
-0.06
-0.0653
-0.0347
-0.0582
-0.0575
0.6146

Table I. Approximation of the leading eigenvalue Œªmax
of the NB matrix.
B

[3]

[4]

[5]

[6]

[7]

[8]

[9]

novel coronavirus (sars-cov-2),‚Äù Science 368, 489‚Äì493
(2020).
Xi He, Eric H. Y. Lau, Peng Wu, Xilong Deng, Jian
Wang, Xinxin Hao, Yiu Chung Lau, Jessica Y. Wong,
Yujuan Guan, Xinghua Tan, et al., ‚ÄúTemporal dynamics in viral shedding and transmissibility of COVID-19,‚Äù
Nature Medicine 26, 672‚Äì675 (2020).
Seyed M. Moghadas, Meagan C. Fitzpatrick, Pratha Sah,
Abhishek Pandey, Affan Shoukat, Burton H. Singer, and
Alison P. Galvani, ‚ÄúThe implications of silent transmission for the control of COVID-19 outbreaks,‚Äù Proceedings
of the National Academy of Sciences 117, 17513‚Äì17515
(2020).
Marino Gatto, Enrico Bertuzzo, Lorenzo Mari, Stefano
Miccoli, Luca Carraro, Renato Casagrandi, and Andrea
Rinaldo, ‚ÄúSpread and dynamics of the COVID-19 epidemic in italy: Effects of emergency containment measures,‚Äù Proceedings of the National Academy of Sciences
117, 10484‚Äì10491 (2020).
Matteo Chinazzi, Jessica T. Davis, Marco Ajelli, Corrado
Gioannini, Maria Litvinova, Stefano Merler, Ana Pastore y Piontti, Kunpeng Mu, Luca Rossi, Kaiyuan Sun,
et al., ‚ÄúThe effect of travel restrictions on the spread of
the 2019 novel coronavirus (COVID-19) outbreak,‚Äù Science 368, 395‚Äì400 (2020).
Xingjie Hao, Shanshan Cheng, Degang Wu, Tangchun
Wu, Xihong Lin, and Chaolong Wang, ‚ÄúReconstruction of the full transmission dynamics of COVID-19 in
wuhan,‚Äù Nature 584, 420‚Äì424 (2020).
Seyed M. Moghadas, Affan Shoukat, Meagan C. Fitzpatrick, Chad R. Wells, Pratha Sah, Abhishek Pandey,
Jeffrey D. Sachs, Zheng Wang, Lauren A. Meyers, Burton H. Singer, et al., ‚ÄúProjecting hospital utilization
during the COVID-19 outbreaks in the united states,‚Äù
Proceedings of the National Academy of Sciences 117,
9122‚Äì9126 (2020).
Romualdo Pastor-Satorras, Claudio Castellano, Piet
Van Mieghem, and Alessandro Vespignani, ‚ÄúEpidemic
processes in complex networks,‚Äù Rev. Mod. Phys. 87,

925‚Äì979 (2015).
[10] N Ferguson, D Laydon, G Nedjati Gilani, N Imai,
K Ainslie, M Baguelin, S Bhatia, A Boonyasiri, ZULMA
Cucunuba Perez, G Cuomo-Dannenburg, et al., ‚ÄúReport
9: Impact of non-pharmaceutical interventions (NPIs)
to reduce covid19 mortality and healthcare demand,‚Äù
https://spiral.imperial.ac.uk:8443/handle/10044/1/77482
10.25561/77482.
[11] David Adam, ‚ÄúSpecial report: The simulations driving
the world‚Äôs response to COVID-19,‚Äù Nature 580, 316‚Äì318
(2020).
[12] Ofir Reich, Guy Shalev, and Tom Kalvari, ‚ÄúModeling COVID-19 on a network:
super-spreaders,
testing and containment,‚Äù
medRxiv
(2020),
10.1101/2020.04.30.20081828.
[13] Nicholas G. Davies, Adam J. Kucharski, Rosalind M. Eggo, Amy Gimma, W. John Edmunds,
Thibaut Jombart, Kathleen O‚ÄôReilly, Akira Endo, Joel
Hellewell, Emily S. Nightingale, et al., ‚ÄúEffects of
non-pharmaceutical interventions on COVID-19 cases,
deaths, and demand for hospital services in the uk: a
modelling study,‚Äù The Lancet Public Health 5, e375‚Äìe385
(2020).
[14] Brian Karrer and M. E. J. Newman, ‚ÄúMessage passing
approach for general epidemic models,‚Äù Phys. Rev. E 82,
016101 (2010).
[15] Andrey Y. Lokhov, Marc M√©zard, Hiroki Ohta, and
Lenka Zdeborov√°, ‚ÄúInferring the origin of an epidemic
with a dynamic message-passing algorithm,‚Äù Phys. Rev.
E 90, 012801 (2014).
[16] Andrey Y. Lokhov, Marc M√©zard, and Lenka Zdeborov√°, ‚ÄúDynamic message-passing equations for models
with unidirectional dynamics,‚Äù Phys. Rev. E 91, 012811
(2015).
[17] Munik Shrestha, Samuel V. Scarpino, and Cristopher
Moore, ‚ÄúMessage-passing approach for recurrent-state
epidemic models on networks,‚Äù Phys. Rev. E 92, 022821
(2015).
[18] Wei Wang, Ming Tang, H Eugene Stanley, and Lidia A

29

[19]

[20]

[21]

[22]

[23]

[24]

[25]

[26]
[27]

[28]
[29]

[30]

[31]

Braunstein, ‚ÄúUnification of theoretical approaches for
epidemic spreading on complex networks,‚Äù Reports on
Progress in Physics 80, 036603 (2017).
Matt J. Keeling and Pejman Rohani, Modeling Infectious
Diseases in Humans and Animals (Princeton University
Press, 2008).
Liang Tian, Xuefei Li, Fei Qi, Qian-Yuan Tang, Viola
Tang, Jiang Liu, Zhiyuan Li, Xingye Cheng, Xuanxuan
Li, Yingchen Shi, Haiguang Liu, and Lei-Han Tang,
‚ÄúHarnessing peak transmission around symptom onset for
non-pharmaceutical intervention and containment of the
COVID-19 pandemic,‚Äù Nature Communications 12, 1147
(2021).
Qun Li, Xuhua Guan, Peng Wu, Xiaoye Wang, Lei Zhou,
Yeqing Tong, Ruiqi Ren, Kathy S.M. Leung, Eric H.Y.
Lau, Jessica Y. Wong, et al., ‚ÄúEarly transmission dynamics in wuhan, china, of novel coronavirus-infected
pneumonia,‚Äù New England Journal of Medicine 382,
1199‚Äì1207 (2020), pMID: 31995857.
Peter Ashcroft, Jana S Huisman, Sonja Lehtinen, Judith A Bouman, Christian L Althaus, Roland R Regoes,
and Sebastian Bonhoeffer, ‚ÄúCOVID-19 infectivity profile
correction,‚Äù Swiss Med Wkly. 2020;150:w20336 (2020),
10.4414/smw.2020.20336.
Ranawaka A.P.M. Perera, Eugene Tso, Owen T.Y. Tsang,
Dominic N.C. Tsang, Kitty Fung, Yonna W.Y. Leung,
Alex W.H. Chin, Daniel K.W. Chu, Samuel M.S. Cheng,
Leo L.M. Poon, Vivien W.M. Chuang, and Malik Peiris,
‚ÄúSARS-CoV-2 virus culture and subgenomic RNA for respiratory specimens from patients with mild coronavirus
disease,‚Äù Emerging Infectious Diseases 26, 11 (2020).
Wee Chian Koh, Lin Naing, Liling Chaw, Muhammad Ali Rosledzana, Mohammad Fathi Alikhan, Sirajul Adli Jamaludin, Faezah Amin, Asiah Omar, Alia
Shazli, Matthew Griffith, Roberta Pastore, and Justin
Wong, ‚ÄúWhat do we know about SARS-CoV-2 transmission? a systematic review and meta-analysis of the secondary attack rate and associated risk factors,‚Äù PLOS
ONE 15, e0240205 (2020).
Oyungerel Byambasuren, Magnolia Cardona, Katy Bell,
Justin Clark, Mary-Louise McLaws, and Paul Glasziou,
‚ÄúEstimating the extent of asymptomatic COVID-19 and
its potential for community transmission: Systematic review and meta-analysis,‚Äù Official Journal of the Association of Medical Microbiology and Infectious Disease
Canada 5, 223‚Äì234 (2020).
Mina Youssef and Caterina Scoglio, ‚ÄúAn individual-based
approach to SIR epidemics in contact networks,‚Äù Journal
of Theoretical Biology 283, 136 ‚Äì 144 (2011).
Baichuan Mo, Kairui Feng, Yu Shen, Clarence Tam,
Daqing Li, Yafeng Yin, and Jinhua Zhao, ‚ÄúModeling
epidemic spreading through public transit using timevarying encounter network,‚Äù arXiv:2004.04602 (2020).
Lasko Basnarkov, ‚ÄúSeair epidemic spreading model of
covid-19,‚Äù Chaos, Solitons & Fractals 142, 110394 (2021).
Andreas Koher, Hartmut H. K. Lentz, James P. Gleeson,
and Philipp H√∂vel, ‚ÄúContact-based model for epidemic
spreading on temporal networks,‚Äù Phys. Rev. X 9, 031017
(2019).
Hanlin Sun, David Saad, and Andrey Y. Lokhov, ‚ÄúCompetition, collaboration, and optimization in multiple interacting spreading processes,‚Äù Phys. Rev. X 11, 011048
(2021).
Jo√´l Mossong, Niel Hens, Mark Jit, Philippe Beutels,

[32]
[33]

[34]
[35]

[36]

[37]
[38]
[39]

[40]

[41]

[42]
[43]
[44]

[45]

[46]
[47]

[48]

Kari Auranen, Rafael Mikolajczyk, Marco Massari, Stefania Salmaso, Gianpaolo Scalia Tomba, Jacco Wallinga,
et al., ‚ÄúSocial contacts and mixing patterns relevant to
the spread of infectious diseases,‚Äù PLoS Medicine 5, e74
(2008).
http://www.sociopatterns.org/.
F. Altarelli, A. Braunstein, L. Dall‚ÄôAsta, J. R. Wakeling, and R. Zecchina, ‚ÄúContaining epidemic outbreaks
by message-passing techniques,‚Äù Phys. Rev. X 4, 021024
(2014).
Mari√°n Bogu√±√° and Romualdo Pastor-Satorras, ‚ÄúEpidemic spreading in correlated complex networks,‚Äù Phys.
Rev. E 66, 047104 (2002).
We remark that there are other conventions used when
defining the NB matrix in the literature; a common convention corresponds to the transpose of B defined in
Eq. (27) [36].
Florent Krzakala, Cristopher Moore, Elchanan Mossel,
Joe Neeman, Allan Sly, Lenka Zdeborov√°, and Pan
Zhang, ‚ÄúSpectral redemption in clustering sparse networks,‚Äù Proceedings of the National Academy of Sciences
110, 20935‚Äì20940 (2013).
Brian Karrer, M. E. J. Newman, and Lenka Zdeborov√°,
‚ÄúPercolation on sparse networks,‚Äù Phys. Rev. Lett. 113,
208702 (2014).
Roger A. Horn and Charles R. Johnson, Matrix Analysis,
2nd ed. (Cambridge University Press, New York, 2012).
Adriana Reyna-Lara, David Soriano-Pa√±os, Sergio
G√≥mez, Clara Granell, Joan T. Matamalas, Benjamin
Steinegger, Alex Arenas, and Jes√∫s G√≥mez-Garde√±es,
‚ÄúVirus spread versus contact tracing: Two competing
contagion processes,‚Äù Phys. Rev. Research 3, 013163
(2021).
Yusuke Watanabe and Kenji Fukumizu, ‚ÄúGraph zeta
function in the bethe free energy and loopy belief propagation,‚Äù in Advances in Neural Information Processing
Systems 22 , edited by Y. Bengio, D. Schuurmans, J. D.
Lafferty, C. K. I. Williams, and A. Culotta (Curran Associates, Inc., 2009) pp. 2017‚Äì2025.
Panpan Shu, Wei Wang, Ming Tang, and Younghae
Do, ‚ÄúNumerical identification of epidemic thresholds for
susceptible-infected-recovered model on finite-size networks,‚Äù Chaos: An Interdisciplinary Journal of Nonlinear
Science 25, 063104 (2015).
Ginestra Bianconi, ‚ÄúRare events and discontinuous percolation transitions,‚Äù Phys. Rev. E 97, 022314 (2018).
Reimer K√ºhn and Tim Rogers, ‚ÄúHeterogeneous microstructure of percolation in sparse networks,‚Äù EPL (Europhysics Letters) 118, 68003 (2017).
Carl Edward Rasmussen and Christopher K. I. Williams,
Gaussian Processes for Machine Learning, Adaptive
computation and machine learning (The MIT Press,
2006).
Travis Martin, Xiao Zhang, and M. E. J. Newman, ‚ÄúLocalization and centrality in networks,‚Äù Phys. Rev. E 90,
052808 (2014).
T. Rogers, ‚ÄúAssessing node risk and vulnerability in epidemics on networks,‚Äù EPL (Europhysics Letters) 109,
28005 (2015).
Romualdo Pastor-Satorras and Claudio Castellano, ‚ÄúThe
localization of non-backtracking centrality in networks
and its physical consequences,‚Äù Scientific Reports 10,
21639 (2020).
Rossana Mastrandrea, Julie Fournet, and Alain Barrat,

30

[49]
[50]

[51]

[52]
[53]

‚ÄúContact patterns in a high school: A comparison between data collected using wearable sensors, contact diaries and friendship surveys,‚Äù PLOS ONE 10, e0136497
(2015).
A.L. Barab√°si and M. P√≥sfai, Network Science (Cambridge University Press, Cambridge, United Kingdom,
2016).
Valerio Gemmetto, Alain Barrat, and Ciro Cattuto,
‚ÄúMitigation of infectious disease at school: targeted class
closure vs school closure,‚Äù BMC Infectious Diseases 14,
695 (2014).
Mathieu G√©nois, Christian L. Vestergaard, Julie Fournet,
Andr√© Panisson, Isabelle Bonmarin, and Alain Barrat,
‚ÄúData on face-to-face contacts in an office building suggest a low-cost vaccination strategy based on community
linkers,‚Äù Network Science 3, 326‚Äì347 (2015).
Mathieu G√©nois and Alain Barrat, ‚ÄúCan co-location be
used as a proxy for face-to-face contacts?‚Äù EPJ Data Science 7, 11 (2018).
Kiesha Prem, Alex R. Cook, and Mark Jit, ‚ÄúProjecting social contact matrices in 152 countries using contact
surveys and demographic data,‚Äù PLOS Computational

Biology 13, e1005697 (2017).
[54] Ginestra Bianconi, Hanlin Sun, Giacomo Rapisardi, and
Alex Arenas, ‚ÄúMessage-passing approach to epidemic
tracing and mitigation with apps,‚Äù Phys. Rev. Research
3, L012014 (2021).
[55] Antoine Baker, Indaco Biazzo, Alfredo Braunstein, Giovanni Catania, Luca Dall‚ÄôAsta, Alessandro Ingrosso, Florent Krzakala, Fabio Mazza, Marc M√©zard, Anna Paola
Muntoni, Maria Refinetti, Stefano Sarao Mannelli,
and Lenka Zdeborov√°, ‚ÄúEpidemic mitigation by statistical inference from contact tracing data,‚Äù (2020),
arXiv:2009.09422.
[56] Andrey Y. Lokhov and David Saad, ‚ÄúOptimal deployment of resources for maximizing impact in spreading
processes,‚Äù Proceedings of the National Academy of Sciences 114, E8138‚ÄìE8146 (2017).
[57] Hyman Bass, ‚ÄúThe Ihara-Selberg zeta function of a
tree lattice,‚Äù International Journal of Mathematics 03,
717‚Äì797 (1992).
[58] Chris Godsil and Gordon Royle, Algebraic Graph Theory
(Springer New York, 2001).

