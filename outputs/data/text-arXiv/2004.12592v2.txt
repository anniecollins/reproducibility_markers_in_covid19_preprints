Robust Screening of COVID-19 from Chest X-ray via Discriminative
Cost-Sensitive Learning
Tianyang Lia,b,âˆ— , Zhongyi Hanc,âˆ— , Benzheng Weia,b,âˆ—âˆ— , Yuanjie Zhengd , Yanfei Honga , Jinyu Conga,b ,
Wei Zhange , Xue Zhue , Xuxiang Lue and Haifeng Weif
a Center

for Medical Artificial Intelligence, Shandong University of Traditional Chinese Medicine, Qingdao 266112, China
Academy of Chinese Medical Sciences, Shandong University of Traditional Chinese Medicine, Qingdao 266112, China
c School of Software, Shandong University, Jinan 250101, China
d School of Information Science and Engineering, Shandong Normal University, Jinan 250358, China
e Department of Pulmonary Disease, Affiliated Hospital of Shandong University of Traditional Chinese Medicine, Jinan 250014, China
f Department of Medical Imaging, Affiliated Hospital of Shandong University of Traditional Chinese Medicine, Jinan 250014, China

arXiv:2004.12592v2 [eess.IV] 21 May 2020

b Qingdao

ARTICLE INFO

ABSTRACT

Keywords:
COVID-19
chest X-ray
fine-grained classification
cost-sensitive learning

This paper addresses the new problem of automated screening of coronavirus disease 2019 (COVID19) based on chest X-rays, which is urgently demanded toward fast stopping the pandemic. However,
robust and accurate screening of COVID-19 from chest X-rays is still a globally recognized challenge
because of two bottlenecks: 1) imaging features of COVID-19 share some similarities with other
pneumonia on chest X-rays, and 2) the misdiagnosis rate of COVID-19 is very high, and the misdiagnosis cost is expensive. While a few pioneering works have made much progress, they underestimate
both crucial bottlenecks. In this paper, we report our solution, discriminative cost-sensitive learning
(DCSL), which should be the choice if the clinical needs the assisted screening of COVID-19 from
chest X-rays. DCSL combines both advantages from fine-grained classification and cost-sensitive
learning. Firstly, DCSL develops a conditional center loss that learns deep discriminative representation. Secondly, DCSL establishes score-level cost-sensitive learning that can adaptively enlarge the
cost of misclassifying COVID-19 examples into other classes. DCSL is so flexible that it can apply
in any deep neural network. We collected a large-scale multi-class dataset comprised of 2,239 chest
X-ray examples: 239 examples from confirmed COVID-19 cases, 1,000 examples with confirmed bacterial or viral pneumonia cases, and 1,000 examples of healthy people. Extensive experiments on the
three-class classification show that our algorithm remarkably outperforms state-of-the-art algorithms.
It achieves an accuracy of 97.01%, a precision of 97%, a sensitivity of 97.09%, and an F1-score of
96.98%. These results endow our algorithm as an efficient tool for the fast large-scale screening of
COVID-19.

of nucleic acid detection kits are problematic [47]. For example, the quantity of nucleic acid kits is limited in many
As COVID-19 continues to affect our world, automated
countries or regions, resulting in the slower screening of new
screening of coronavirus disease 2019 (COVID-19) is urcoronary pneumonia [54]. Many patients with new corogently needed to realize large-scale screening to combat it.
nary pneumonia cannot be tested in time and thus cannot be
Since the outbreak of COVID-19 in December 2019 to date,
admitted to the hospital, which accelerates the widespread
more than 5,083,278 people have been infected around the
of the novel virus. On the contrary, medical imaging exworld. And more than 329,668 deaths from the virus have
aminations can help clinical to carry out disease detection
been recorded according to the World Health Organization.
conveniently and quickly, and thus make patients be treated
Fast and large-scale screening is necessary to cut off the source timely. Accordingly, medical imaging examinations with
of infection. However, the rapidly growing amount of COVIDsymptom observation are widely used for the early diagnosis
19 cases makes global medical resources unbearable. Autoof COVID-19 worldwide [25].
mated screening systems can correspondingly assist in speedX-rays have unique advantages of light, quick, and availing up screening and would reduce the workload of radioloability in the screening of COVID-19. On the one hand, reggists. Therefore, it is urgent to realize the automated screenular X-ray machines can be accessed in most primary hosing of COVID-19 that helps to accelerate the large-scale screen- pitals where CT scanners are insufficient. Most ambulatory
ing and alleviate the global shortage of medical resources.
care facilities have deployed X-ray units as basic diagnostic
Nowadays, medical imaging examinations, such as chest
imaging. Most importantly, the easily accessible X-ray exCT, X-ray, play an essential role in the diagnosis process of
amination is beneficial for fast large-scale screening. On the
COVID-19. Clinically, although nucleic acid detection is the
other hand, the radiation dose of X-ray is a few hundredths of
gold standard, the availability, stability, and reproducibility
the chest CT [12, 22]. One statistic from the San Francisco
âˆ— These authors contributed equally to this work.
bay area shows that hospitals add one more case of cancer
âˆ—âˆ— Corresponding author.
for every 400 to 2,000 additional routine chest CT examiwbz99@sina.com (B. Wei)
nations [42]. This statistic indicates that a single chest CT
ORCID (s): 0000-0001-9640-4947 (B. Wei)
examination increases the lifetime risk of cancer by 0.05%

1. Introduction

Tianyang Li et al.: Preprint submitted to Elsevier

Page 1 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

- 0.25%. Also, the X-ray examination is more economical
than CT.
Therefore, this paper addresses the novel task of automated screening of COVID-19 from chest X-rays. However,
robust and accurate screening has two crucial bottlenecks.
Firstly, the imaging features of COVID-19 cases share some
similarities with other pneumonia cases on chest X-rays. Even
radiologists cannot distinguish them based on chest CT accurately without other inspection methods [47], let alone based
on chest X-rays. The second bottleneck is that the misdiagnosis rate of COVID-19 is very high. High misdiagnosis
rate of COVID-19 has a prohibitive cost that is not only delaying the timely treatment of patients but also causing the
widespread of the virus with high social costs. Misdiagnosis cost sensitivity should be fully considered in the automated screening of COVID-19. Therefore, these limitations
impedes the accurate screening of COVID-19 patients from
the susceptible population.
While a few pioneering works have made much progress,
they neglect both crucial bottlenecks. All of them adopted
common machine learning classifiers. For example, both
Hassanien et al. [18] and Sethy et al. [36] used support vector machines (SVM) to screen COVID-19 based on extracted
features. Farooq et al. [11], Narin et al. [33], Wang et al. [46]
and etc adopted popular deep neural networks with a minor
modification of network architecture. More interestingly,
Zhang et al. [54] viewed this screening task as an anomaly
detection problem and proposed to use existing anomaly detection techniques. However, in fact, the screening of COVID19 is a fine-grained cost-sensitive classification problem, as
mentioned before. Only from this perspective can we design
a satisfactory solution. Therefore, in this study, we attempt
to design an efficient solution to combat the bottlenecks.
In this paper, we propose an innovative discriminative
cost-sensitive learning (DCSL) for the robust screening of
COVID-19 from chest X-rays. DCSL combines both advances from fine-grained classification and cost-sensitive learning techniques. To overcome the subtle difference bottleneck, we propose a conditional center loss function to learn
the discriminative representation between fine-grained classes.
By combing with vanilla loss function, the conditional center loss can discover a weighted center for each class and
efficiently enlarge the inter-class manifold distance as well
as enhancing the intra-class compactness in deep representation space. To combat the cost sensitivity, we propose scorelevel cost-sensitive learning. It introduces a score-level cost
matrix to reshape the classifier confidences by modifying the
classifier output, such that the COVID-19 examples have the
maximum score, and the other classes have a substantially
lower score. Based on the domain knowledge that the costs
between misclassifying COVID-19 into different classes or
misclassifying other classes into COVID-19 are not equal,
we define new score-level costs to encourage the correct classification of COVID-19 class. We combine both advances
into a deep neural network with end-to-end optimization,
successfully achieving fine-grained cost-sensitive screening
of COVID-19. A series of experiments show that our algoTianyang Li et al.: Preprint submitted to Elsevier

rithm remarkably outperforms previous methods.
The contributions of this work include:
â€¢ For the first time, we formulate the task of screening
of COVID-19 from chest X-ray as a fine-grained costsensitive classification problem. Accordingly, we propose a practical solution, discriminative cost-sensitive
learning, that achieves much high screening accuracy.
â€¢ We propose a new conditional center loss that considers the class-conditional information when learning the center points per class. The conditional center
loss successfully overcomes the bottleneck of feature
similarities.
â€¢ We propose a new score-level cost-sensitive learning
that introduces a domain knowledge-based cost matrix
to enlarge the cost of misclassifying COVID-19 examples into other classes. It greatly reduces the misdiagnosis rate.
The remainder of this paper is organized as follows. Section 2 presents the related works in terms of artificial intelligence assisted analysis of COVID-19 and involved methodologies. Section 3 gives in detail the proposed discriminative
cost-sensitive learning. Section 4 presents detailed descriptions of collected datasets, experiment settings, and exhaustive results. Section 5 concludes this work comprehensively.

2. Related Works
This section shows related works about the automated
screening of COVID-19 and involved algorithms of our work.

2.1. Automated Medical Image Analysis about
COVID-19
To take part in the global fight against COVID-19, many
studies have designed AI-empowered technologies for improving the clinical diagnosis efficiency. Shi et al. [38] comprehensively summarized lots of emerging works, including
automated screening [47, 51, 39, 24, 41, 15, 16, 23, 56], patient severity assessment [21], infection quantification [37],
and infection area segmentation [6, 15]. Among them, automated screening received the most attention, involving chest
X-ray based and chest CT based works. Since 3D CT scans
have spatial complexity, existing CT based works have proposed to design three types of solutions, including patchbased methods [47, 51, 39, 24], slice-based methods [41, 15,
16, 23], and 3D CT-based method [56]. As we mentioned
before, CT has some disadvantages of expensive, high radiation, and inaccessibility, thus lots of screening works are
based on 2D chest X-rays.
We comprehensively review chest X-rays based methods
as follows. Hassanien et al. [18] used a multi-level threshold
segmentation algorithm to crop lung areas and adopted SVM
to classify COVID-19 and normal cases based on 40 chest Xrays. Ozturk et al. [34] ensembled several feature extraction
algorithms and used a stacked autoencoder with principal
component analysis to make decisions. They showed that
Page 2 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

handcrafted features based classifiers perform better than deep
models on small data. Several studies applied popular deep
learning techniques for the screening of COVID-19. Hemdan et al. [20] validated multiple popular deep models and
demonstrated their effectiveness on this new task. Farooq et
al. [11] utilized the residual networks (ResNet) to validate
the screening performance of COVID-19. Narin et al. [33]
tested an inception architecture (Inceptionv3) on the screening task. They showed that pre-trained models are useful.
The VGG16 and VGG19 networks are adopted by Hall et
al. [17] and Apostolopoulos et al. [3], respectively. Khalifa
et al. [27] used generative adversarial networks and a finetuned deep transfer learning model, achieving promising and
effective performance. Their results also confirm that chest
X-rays based screening of COVID-19 has great research significance.
Moreover, several studies designed specialized solutions
for the screening of COVID-19 according to the characteristics of the task. Afshar et al. [2] adopted a capsule network
for handling small data. Abbas et al. [1] designed a Decompose, Transfer, and Compose (DeTraC) network based
on class decomposition for enhancing low variance classifiers and facilitating more flexibility to their decision boundaries. Wang et al. [47] proposed a new deep network called
COVID-Net, which consists of stacked residual blocks for
achieving easily training and deepening the architectures.
To improve diagnostic performance, Ghosha et al. [14] used
Bayesian convolutional neural networks to estimate uncertainty. More interestingly, Zhang et al. [54] viewed this screening task as an anomaly detection problem and proposed to
use existing anomaly detection techniques. Specifically, they
used a hybrid loss that combines a binary cross-entropy loss
and a deviation loss to assign anomaly scores to COVID-19
examples. While a few pioneering works have made great
progress, they neglect both cost sensitivity and fine-grained
bottlenecks. To the best of our knowledge, it is the first
time that we insightfully view the screening of COVID-19
from chest X-rays as a fine-grained cost-sensitive classification problem.

2.2. Involved Methods of Our Work
2.2.1. Fine-Grained Classification
The goal of fine-grained classification is to classify data
belonging to multiple subordinate categories, e.g., COVID19, common pneumonia, normal chest X-rays. The facing
problem of fine-grained classification is that these subordinate categories naturally exist small inter-class variations
and large intra-class variations. The common solutions of
this problem can be organized into three main paradigms, including 1) localization-classification networks based methods [55, 29, 48], 2) external information-based methods [43,
50, 8], and 3) end-to-end feature coding-based methods [30,
10]. Localization-classification networks based methods first
learn part-based detectors or segmentation model to localize salient parts for improving the final recognition accuracy.
However, this type of paradigm needs additional part annotations. External information-based methods leverage exterTianyang Li et al.: Preprint submitted to Elsevier

nal information, i.e., web data [43], multi-modality [50], or
human-computer interactions [8].
Different from the previous two paradigms, end-to-end
feature coding-based methods learn a more discriminative
feature representation directly [13]. Among them, several
works specifically designed extra useful loss functions for
learning discriminative fine-grained representations. For instance, the contrastive loss is designed for dealing with the
relationship of paired example points effectively [44]. Triplet
loss correspondingly constructs loss functions for example
triplet [35]. However, contrastive loss and triplet loss are
required that the number of training pairs or triplets dramatically grows, with slow convergence and instability. Center
loss is proposed to solve this issue by minimizing the deep
feature distances of intra-class only [49]. This loss function
learns a center for each class and pulls the deep features of
the same class to their centers efficiently. However, center
loss easily suffers from the issue of class imbalance. Therefore, in this paper, we propose to learn a new conditional center loss with joint balance optimization for the robust screening of COVID-19.

2.2.2. Cost-Sensitive Learning
Cost-sensitive learning is a learning method that considers the cost of misclassification, and its purpose is to minimize the total cost [31]. In the classical machine learning
setting, the costs of classification errors of different classes
are equal. Unfortunately, the costs are not equal in many
real-world tasks. For example, in COVID-19 screening, the
cost of erroneously diagnosing a COVID-19 patient to be
healthy may be much higher than that of mistakenly diagnosing a COVID-19 patient to be common pneumonia. Costsensitive learning is proposed to handle this problem and
has attracted much attention from the machine learning and
data mining communities [57]. Existing works on misclassification costs can be categorized into two classes, including example-dependent cost [52, 53, 4] and class-dependent
cost [5, 9, 32]. Example-dependent cost-based methods consider the misclassification cost of each example and are required example-level annotations, which are impractical in
real-world tasks. Therefore, most methods are focused on
class-dependent costs. Cost-sensitive learning is also suitable to handle the problem of class imbalance [28]. In this
study, we introduce a score-level cost-sensitive learning approach based on an expert-provided cost matrix to improve
the screening accuracy of COVID-19 from chest X-rays.

3. Methodology
In this section, we first introduce the necessary notations
and the objective for the task of screening of COVID-19
from chest X-rays (See Section 3.1). We then present the
newly-proposed discriminative cost-sensitive learning (DCSL)
framework, which consists of a conditional center loss (See
Section 3.2) and a score-level cost-sensitive learning approach
(See Section 3.3). We finally combine the two novel modules to construct the DCSL framework for the fine-grained
cost-sensitive classification problem (See Section 3.4).
Page 3 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

Figure 1: Overview of the proposed discriminative cost-sensitive learning (DCSL) framework. Based on a data pool of clinical
X-rays, a comprehensive analysis is conducted to obtain the class-conditional information (class balance weight). In the training
period, we randomly draw a batch of data to optimizer softmax cross-entropy and conditional center loss with the class-conditional
information. Specifically, an input image is firstly processed by a backbone network, which mainly includes convolutional layers (Conv) and fully-connected layers (FC). After that, deep features are obtained to minimize conditional center loss. Score-level
costs are applied to the outputs from the final output layer to get the final cost-sensitive prediction.

3.1. Problem Setting
The task of COVID-19 screening is under the familiar
supervised learning setting where the learner receives a sample of ğ‘š labeled training examples {(ğ‘¥ğ‘– , ğ‘¦ğ‘– )}ğ‘š
drawn from
ğ‘–=1
a joint distribution ğ‘„ defined on î‰„ Ã— î‰…, where î‰„ is the example set of 2D chest X-ray images, and î‰… is the label set of
patient conditions, such as COVID-19, common pneumonia,
others. î‰… is {0, 1} in binary classification and {1, â€¦ , ğ‘›} in
multi-class classification. Specifically, ğ‘¥ğ‘– is any chest X-ray
image of one patient, and ğ‘¦ğ‘– is the label of this patient. We
denote by ğ‘„Ì‚ the empirical distribution.
We denote by îˆ¸ âˆ¶ î‰… Ã— î‰… â†’ â„ any loss function defined
over pairs of labels, such as 0-1 loss, cross-entropy loss, etc.
For binary classification, we denote by ğ‘“ âˆ¶ î‰„ â†’ {0, 1}
a scoring function, which induces a labeling function â„ğ‘“ âˆ¶
î‰„ â†’ î‰… where â„ğ‘“ âˆ¶ ğ‘¥ â†’ arg maxğ‘¦âˆˆî‰… [ğ‘“ (ğ‘¥)]ğ‘¦ . For any distribution ğ‘„ on î‰„ Ã—î‰… and any labeling function â„ğ‘“ , we denote
îˆ¾ğ‘„ (â„ğ‘“ ) = E(ğ‘¥,ğ‘¦)âˆ¼ğ‘„ îˆ¸(â„ğ‘“ (ğ‘¥), ğ‘¦) the expected risk. Our objective is to select a hypothesis ğ‘“ out of a hypothesis set îˆ²
with a small expected risk îˆ¾ğ‘„ (â„ğ‘“ ) on the target distribution.

3.2. Conditional Center Loss
This section presents the newly-proposed conditional center loss. To better understand the role of conditional center
loss, we first consider the softmax based cross-entropy loss

Tianyang Li et al.: Preprint submitted to Elsevier

(softmax loss) that is presented as follows.
ğ‘’ ğ‘¦ğ‘– ğ‘– ğ‘¦ğ‘–
1âˆ‘
,
log âˆ‘
ğ‘Šğ‘—ğ‘‡ ğ’™ğ‘– +ğ‘ğ‘—
ğ‘›
ğ‘š ğ‘–=1
ğ‘’
ğ‘—=1
ğ‘š

îˆ¸ğ‘† = âˆ’

ğ‘Š ğ‘‡ ğ’™ +ğ‘

(1)

where ğ’™ğ‘– âˆˆ Rğ‘‘ (to reduce abuse notations) denotes the ğ‘–th
deep feature of the X-ray image ğ‘¥ğ‘– , belonging to the class ğ‘¦ğ‘– .
ğ‘Šğ‘— âˆˆ Rğ‘‘ denotes the ğ‘—th column of the weights ğ‘Š âˆˆ Rğ‘‘Ã—ğ‘›
in the last fully-connected layer, and ğ‘ âˆˆ Rğ‘› is the bias term.
ğ‘š and ğ‘› are the size of mini-batch and the number of classes,
respectively. Intuitively, the softmax loss first computes the
probability of correct classification and then takes the logarithm of this probability. Since the logarithm value of probability is negative, a minus sign is added in front of it. While
the softmax loss is good at common object recognition tasks,
it cannot learn enough discriminative features in processing
fine-grained classification tasks in which significant intraclass variations exist.
According to our in-depth analysis of the characteristics
of the screening of COVID-19 from chest X-rays, we, with
keen insight, view it as a fine-grained classification problem. As we discussed before, the center loss has advantages
of flexibility, easy-to-implement, and stability. Therefore,
we initially leverage the center loss to learn more discriminative features. The goal of center loss is to directly improve the intra-class compactness, which is conducive to the
Page 4 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

discriminative feature learning. Center loss is widely embedded between the fully connected layers of deep neural
networks for decreasing the intra-class variations in the representation space (the dimension is two). It is commonly appeared with softmax loss and used for face recognition and
fine-grained classification. The center loss function is formulated as follows.
ğ‘š

(2)

ğ‘ğ‘¦ğ‘¡+1 = ğ‘ğ‘¦ğ‘¡ âˆ’ ğ›¼ â–³ ğ’„ ğ‘— , âˆ€ ğ‘¦ğ‘– = ğ‘— , in which ,
ğ‘–

(3)

âˆ‘ğ‘š

= ğ‘—) â‹… (ğ’„ ğ‘— âˆ’ ğ’™ğ‘– )
,
âˆ‘ğ‘š
1 + ğ‘–=1 ğ›¿(ğ‘¦ğ‘– = ğ‘—)

ğ‘–=1 ğ›¿(ğ‘¦ğ‘–

(4)

where ğ›¿ is an indicator function in which ğ›¿ = 1 if the condition is satisfied, and ğ›¿ = 0 if not. ğ‘¡ denotes the iteration of
training. The final joint loss function is given by
îˆ¸ğ‘†ğ¶ = îˆ¸ğ‘† + ğœ†ğ¶ îˆ¸ğ¶
1âˆ‘
âˆ’ğ‘’ ğ‘¦ğ‘– ğ‘– ğ‘¦ğ‘–
+ ğœ†ğ¶ âˆ¥ ğ’™ğ‘– âˆ’ ğ’„ ğ‘¦ğ‘– âˆ¥22 ) ,
(log âˆ‘
ğ‘Šğ‘—ğ‘‡ ğ’™ğ‘– +ğ‘ğ‘—
ğ‘›
ğ‘š ğ‘–=1
ğ‘—=1 ğ‘’
ğ‘š

=

ğ‘Š ğ‘‡ ğ’™ +ğ‘

(5)
where ğœ†ğ¶ is used for balancing the joint loss function.
While the joint loss function has achieved great success
in practice, however, it quickly losses efficiency in the class
imbalance situation. In other words, the center loss does
not work in the screening task of COVID-19 according to
our observations. After an in-depth analysis, we found that
the problem is that the learned center points are unrepresentative. To handle this problem, we propose a conditional
center loss that considers the class-conditional information
when updating the center points and optimizing the center
loss. We denote by ğ‘¤ğ‘— the weight of ğ‘—th class, and ğ‘¤ğ‘— is computed by the ratio between the number of ğ‘—th classâ€™s training
examples and the total training examples. The update equation of center points is reformulated by
ğ‘ğ‘¦ğ‘¡+1 = ğ‘ğ‘¦ğ‘¡ âˆ’ ğ›¼ğ‘¤ğ‘— â–³ ğ’„ ğ‘— , âˆ€ ğ‘¦ğ‘– = ğ‘— , in which ,
ğ‘–

ğ‘–

(6)

âˆ‘ğ‘š
â–³ğ’„ ğ‘— =

ğ‘–=1 ğ‘¤ğ‘— ğ›¿(ğ‘¦ğ‘– = ğ‘—) â‹… (ğ’„ ğ‘— âˆ’ ğ’™ğ‘– )
âˆ‘
1+ ğ‘š
ğ‘–=1 ğ›¿(ğ‘¦ğ‘– = ğ‘—)

ğ‘š
âˆ’ğ‘¤ğ‘— ğ‘’ ğ‘¦ğ‘– ğ‘– ğ‘¦ğ‘–
1âˆ‘
+ ğ‘¤ğ‘— ğœ†ğ¶ âˆ¥ ğ’™ğ‘– âˆ’ ğ’„ ğ‘¦ğ‘– âˆ¥22 ) .
(log âˆ‘
=
ğ‘Šğ‘—ğ‘‡ ğ’™ğ‘– +ğ‘ğ‘—
ğ‘›
ğ‘š ğ‘–=1
ğ‘’
ğ‘—=1

where the ğ’„ ğ‘¦ğ‘– denotes the ğ‘¦ğ‘– th class center of deep features.
The center is updated according to the mini-batch data. And
it is computed by averaging the features of the corresponding
classes. A scalar ğ›¼ is used to control the learning rate of the
centers. The update equation of ğ’„ ğ‘¦ğ‘– is represented as follows.

â–³ğ’„ ğ‘— =

îˆ¸ğ‘†ğ¶ = îˆ¸ğ‘† + ğœ†ğ¶ îˆ¸ğ¶
ğ‘Š ğ‘‡ ğ’™ +ğ‘

1âˆ‘
âˆ¥ ğ’™ğ‘– âˆ’ ğ’„ ğ‘¦ğ‘– âˆ¥22 ,
îˆ¸ğ¶ =
ğ‘š ğ‘–=1

ğ‘–

total screening accuracy. The reason is that it makes the
center loss learn more balance center points and thus enhances the intra-class compactness to obtain discriminative
deep features. Accordingly, the conditional center loss with
softmax loss is represented as follows.

,

(7)

Meanwhile, we found that embedding the clas-conditional
information into the center loss can significantly improve the
Tianyang Li et al.: Preprint submitted to Elsevier

(8)
The conditional center loss can effectively handle the problem that imaging features of COVID-19 share some similarities with other pneumonia on chest X-rays by enlarging their
feature distance in high-level representation space.

3.3. Score-Level Cost-Sensitive Learning
The goal of cost-sensitive learning is to classify examples from essential classes such as COVID-19 correctly. We
propose a score-level cost-sensitive learning module that can
efficiently learn robust feature representations for both the
critical and common classes. It thus can enhance the accuracy of COVID-19 without unduly sacrificing the precision
of the overall accuracy. Generally speaking, we introduce
a handcrafted cost matrix whose design is based on clinical expert experience and then incorporate it after the output layer of deep neural networks. In this manner, we can
directly modify the learning process to incorporate classdependent costs during training and testing, without affecting the training and testing time of the original network. We
will show that the proposed algorithm can efficiently work
for the screening of COVID-19 and can be inserted into any
deep neural networks. In this section, we first present the traditional cost-sensitive learning, which usually adds the cost
matrix into the loss functions. We then detail the score-level
cost-sensitive learning with an advanced learning strategy.
Formally, we denote by ğœ‰ â€² the cost matrix whose diagâ€² represents the benefit for a correct prediction. We
onal ğœ‰ğ‘,ğ‘
also denote by ğœ‰ğ‘,ğ‘ the misclassification cost of classifying
an example belonging to a class ğ‘ into a different class ğ‘. The
expected risk defined on the target distribution ğ‘„ is given by
îˆ¾(ğ‘|ğ‘¥) =

âˆ‘

â€²
ğœ‰ğ‘,ğ‘
ğ‘ƒ (ğ‘|ğ‘¥) ,

(9)

ğ‘

where ğ‘ƒ (ğ‘|ğ‘¥) is the posterior probability over all possible
classes given an example ğ‘¥. The goal of a classifier is to
minimize the expected risk îˆ¾(ğ‘|ğ‘¥), however, which cannot
be reached in practice. Thus, we use its empirical distribution of ğ‘„Ì‚ to minimize the empirical risk as follows.
Ì‚ )=E
îˆ¾(ğ‘“
(ğ‘¥,ğ‘¦)âˆ¼ğ‘„Ì‚ îˆ¸(â„ğ‘“ (ğ‘¥ğ‘– ), ğ‘¦ğ‘– )
1âˆ‘
îˆ¸(ğœ‰ â€² , ğ‘“ (ğ‘¥ğ‘– ), ğ‘§ğ‘– ) ,
ğ‘š ğ‘–=1
ğ‘š

=

(10)

Page 5 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

(a) Normal

(b) COVID-19

(c) Viral Pneumonia

(d) Bacterial Pneumonia

Figure 2: The visualization of representative chest X-ray images from the collected dataset. They show high similarities.

where ğ‘“ (â‹…) denotes a neural netowrk and ğ‘“ (ğ‘¥ğ‘– ) is the neural
netowrk output. ğ‘§ğ‘– âˆˆ Rğ‘› denotes the one-hot of the label ğ‘¦ğ‘– .
For neural networks, loss function îˆ¸ can be a cross-entropy
loss function with softmax, which is penalized by the cost
matrix ğœ‰ â€² as follows.
ğ‘Š ğ‘‡ ğ’™ +ğ‘

ğ‘’ ğ‘¦ğ‘ ğ‘– ğ‘¦ğ‘
1âˆ‘ â€²
ğœ‰ğ‘,ğ‘ log âˆ‘
,
îˆ¸(ğœ‰ ) = âˆ’
ğ‘Šğ‘ğ‘‡ ğ’™ğ‘– +ğ‘ğ‘
ğ‘›
ğ‘š ğ‘–=1
ğ‘=1 ğ‘’
ğ‘š

â€²

(11)

where ğ’™ denote the deep feature from the output of the penultimate layer. The entries of a handcrafted cost matrix usually
have the form of
{
â€² = 0,
ğ‘ = ğ‘,
ğœ‰ğ‘,ğ‘
â€²
(12)
ğœ‰ =
â€²
ğœ‰ğ‘,ğ‘ âˆˆ R, ğ‘ â‰  ğ‘ .
Inserting such a cost matrix into loss function can increase
the corresponding loss value of an important class. However, such a manner would make the training process of neural networks unstable and can lead to non-convergence [28].
Therefore, we propose an alternative cost-sensitive learning.
To make the learning process more stable and convergence, we propose a new score-level cost matrix ğœ‰ to modify
the output of the last layer of a convolutional neural network
(CNN). As shown in Figure 1, the location of the score-level
cost matrix is after the output layer, and before the loss layer
with softmax. We introduce the new score-level costs to encourage the correct classification of essential classes. Therefore, the CNN output ğ‘“ (ğ‘¥ğ‘– ) is modified using the cost matrix
as follows.
ğ‘œğ‘– = ğœ‰ğ‘“ (ğ‘¥ğ‘– ) ,

(13)

where ğ‘“ (ğ‘¥ğ‘– ) âˆˆ R1Ã—ğ‘› and ğœ‰ âˆˆ Rğ‘›Ã—ğ‘› , such that ğ‘œğ‘– âˆˆ R1Ã—ğ‘› .
During the training process, the output weights are modified
by the score-level cost matrix to reshape the classifier confidences such that the desired class has the maximum score,
and the other classes have a considerably low score. Note
that the score-level costs perturb the classifier confidences.
Such perturbation allows the classifier to give more attention
to the desired classes. In practice, all cost values in ğœ‰ are positive, which enables a smooth training process. When using
the score-level cost matrix, the cross-entropy loss function
Tianyang Li et al.: Preprint submitted to Elsevier

Algorithm 1 DCSL Algorithm.
Input:
Ì‚
Training data (ğ‘¥, ğ‘¦) âˆ¼ ğ‘„;
Initialize parameters ğœƒ in backbone layers, parameters
ğ‘Š , ğ‘ in the output layer, and ğ’„ ğ‘ |ğ‘ = 1, 2, ..., ğ‘›;
Hyperparameter class balance weight ğ‘¤, ğœ‰, ğœ†ğ¶ and ğ›¼;
The learning rate ğœ‚;
The number of iteration ğ‘¡.
Output: The parameters ğœƒ, ğ‘Š , ğ‘.
1: while not converge do
2:
ğ‘¡â‡ğ‘¡+1
3:
Obtain batch ğ‘¥ğ‘
4:
Obtain deep features ğ’™ğ‘
5:
Obtain outputs ğ‘œğ‘– = ğœ‰(ğ‘Š ğ’™ğ‘ + ğ‘)
6:
Compute the joint loss by îˆ¸ğ‘¡ğ·ğ¶ğ‘†ğ¿ (ğ’™ğ‘ , ğ‘œğ‘– , ğ’„ ğ‘¡ğ‘ , ğ‘¤ğ‘ , ğœ†ğ¶ )
7:
8:
9:
10:
11:

Update ğ‘ğ‘—ğ‘¡+1 â‡ ğ‘ğ‘ğ‘¡ âˆ’ ğ›¼ğ‘¤ğ‘ â‹… â–³ğ’„ ğ‘¡ğ‘
Update ğ‘Š â‡ ğ‘Š âˆ’ ğœ‚âˆ‡îˆ¸ğ‘¡ğ·ğ¶ğ‘†ğ¿
Update ğ‘ â‡ ğ‘ âˆ’ ğœ‚âˆ‡îˆ¸ğ‘¡ğ·ğ¶ğ‘†ğ¿
Update ğœƒ â‡ ğœƒ âˆ’ ğœ‚âˆ‡îˆ¸ğ‘¡ğ·ğ¶ğ‘†ğ¿
end while

with softmax is finally can be revised by
ğœ‰(ğ‘Š ğ‘‡ ğ’™ +ğ‘ )

ğ‘’ ğ‘¦ğ‘ ğ‘– ğ‘¦ğ‘
1âˆ‘
log âˆ‘
.
ğœ‰(ğ‘Šğ‘ğ‘‡ ğ’™ğ‘– +ğ‘ğ‘ )
ğ‘›
ğ‘š ğ‘–=1
ğ‘’
ğ‘=1
ğ‘š

îˆ¸(ğœ‰) = âˆ’

(14)

3.4. Discriminative Cost-Sensitive Learning
Combining the conditional center loss and the score-level
cost-sensitive learning, we propose the discriminative costsensitive learning (DCSL) framework. As shown in Figure 1, given a chest X-ray image ğ‘¥ğ‘– , DCSL first uses a backbone network parameterized by ğœƒ to extract deep features
ğ’™ğ‘– which is used for finding the center points and optimizing the conditional center loss. DCSL then uses an output
layer parameterized with ğ‘Š and ğ‘ to obtain the output vector ğ‘“ (ğ‘¥ğ‘– ), where ğ‘“ is a scoring function and is consisted of
the backbone and the output layer. DCSL finally applies the
score-level cost matrix on the output ğ‘“ (ğ‘¥ğ‘– ) to obtain the new
output ğ‘œğ‘– , which is inputted into the joint loss layer when
training and into the softmax layer when testing. The joint
Page 6 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

loss is revised by
îˆ¸ğ·ğ¶ğ‘†ğ¿ = îˆ¸(ğœ‰) + ğœ†ğ¶ îˆ¸ğ¶
âˆ’ğœ‰ğ‘¤ğ‘ (ğ‘Šğ‘¦ğ‘‡ ğ’™ğ‘– +ğ‘ğ‘¦ğ‘ )

ğ‘’
1âˆ‘
log âˆ‘
=
ğ‘›
ğ‘š ğ‘–=1
ğ‘š

ğ‘

ğœ‰(ğ‘Šğ‘ğ‘‡ ğ’™ğ‘– +ğ‘ğ‘ )

ğ‘=1 ğ‘’

+ ğ‘¤ğ‘ ğœ†ğ¶ âˆ¥ ğ’™ğ‘– âˆ’ ğ’„ ğ‘¦ğ‘– âˆ¥22 ) .
(15)

The workflow of learning and optimization of DCSL is
shown in Algorithm 1.

4. Experiments
We evaluate our algorithm on a newly-collected dataset
against state-of-the-art algorithms. The code and dataset
will be publicly available.

4.1. Data and Set-up
To evaluate the performance of our method on screening
of COVID-19, we collected a multi-class multi-center chest
X-ray dataset. This dataset includes 2,239 examples with
image-level labels. Specifically, we collected the dataset from
three different sources. The first source is from a GitHub collection of chest X-rays of patients diagnosed with COVID191 . The second source is from a Kaggle dataset2 , which
is thoroughly collected from the websites of 1) Radiological Society of North America (RSNA), 2) Radiopaedia, and
4) Italian Society of Medical and Interventional Radiology
(SIRM). The third source is from a collection of X-ray images of bacterial and viral pneumonia [26]. The collected
data consists of 239 chest X-rays with confirmed COVID19, 1,000 chest X-rays with confirmed bacterial and viral
pneumonia, and 1,000 examples of healthy condition. We
selected out low-quality images in the dataset to prevent unnecessary classification errors. Representative Chest X-ray
images of different classes are illustrated in Figure 2, which
shows the subtle differences between different classes as well
as proving the necessity of fine-grained classification.
In our experiments, we conduct a three-class classification task for better verifying the proposed SCSL algorithm
in the screening task. The first class is healthy X-ray images, the second class is confirmed COVID-19 X-ray images, and the third class is other confirmed pneumonia X-ray
images, which include both bacterial and viral pneumonia.
We employ standard five-fold cross-validation on the dataset
for performance evaluation and comparison. The dataset is
divided into five groups. Among them, four groups are used
for training the deep neural networks, and the last group is
used for testing the performance. This procedure is repeated
five times until the indices of all of the subjects are obtained.
The evaluation metrics include accuracy, precision, sensitivity, and F1 score.
In order to verify the effectiveness of our proposed algorithm, we compare our designed DCSL algorithm with state1 https://github.com/ieee8023/covid-chestxray-dataset.
2 https://www.kaggle.com/andrewmvd/convid19-x-rays

Tianyang Li et al.: Preprint submitted to Elsevier

of-the-art methods: COVID-Net [46], VGG19 [40], Inceptionv3 [45], ResNet50 [19]. COVID-Net is a newly-proposed
deep convolutional neural network tailored for the detection
of COVID-19 from chest X-rays. VGG19, Inceptionv3, and
ResNet50 are popular convolutional neural networks which
have made great success in various tasks.
We implement our algorithm in Keras. We use the common VGG16 network as the backbone [40]. The original
VGG16 network has 16 layers. There are 13 convolutional
layers with a small filter with a size of 3 Ã— 3 for extracting deep features. Five max-pooling layers with 2 Ã— 2 kernel are deployed after each block of the convolutional layers. We set the output shape of the features of the last convolutional layer to be 7 Ã— 7 Ã— 512 and flatten them. The
original fully connected layers of VGG16 are removed and
replaced by two trainable fully-connected layers. The channel numbers of the two fully-connected layers are 256 and
three, respectively. Since the collected dataset is too small to
obtain promising results through training the deep network
from scratch, we use a transfer learning strategy, i.e., the parameters of the convolutional layers are initialized from the
pre-trained model3 on ImageNet [7]. Also, all the compared
algorithms are implemented according to their open-source
codes with pretraining. The chest X-ray images were resized
into 224 Ã— 224 Ã— 3. We also use an augmentation strategy to
expand the dataset: each random-selected example is rotated
by 15 degrees clockwise or counterclockwise. The ğœ†ğ¶ is set
as 0.05. ğ›¼ is set to one without loss of generality. Adam optimizer is used with an initial learning rate of 1e-3. We set
the training epoch to 40.

Figure 3: An illustration of the score-level cost matrix designed according to the clinical expert experience.

The score-level cost matrix is designed according to the
clinical expert experience as following. First of all, the cost
of misclassifying COVID-19 is higher than misclassifying
other classes. Among them, the cost of misclassifying COVID19 into healthy patients is higher than the cost of misclassifying COVID-19 into other pneumonia patients. Second,
the cost of misclassifying other pneumonia is smaller than
the cost of misclassifying COVID-19. Specifically, the cost
of misclassifying other pneumonia into COVID-19 is higher
than the cost of misclassifying other pneumonia into healthy
patients. Third, the cost of misclassification of healthy people is smaller than in the previous two situations. Among
3 https://github.com/fchollet/deep-learning-models/releases

Page 7 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

them, the cost of misclassifying a healthy person into COVID19 is greater than the cost of misclassifying a healthy person
into other pneumonia. Accordingly, the final score-level cost
matrix is designed as illustrated in Figure 3.
Table 1
Classification results of multiple algorithms on three classes:
normal, COVID-19, and other pneumonia.
Method
VGG19
Inceptionv3
ResNet50
COVID-Net
DCSL (Ours)

Accuracy

Precision

0.9196
0.9107
0.9107
0.9330
0.9701

0.9238
0.9113
0.9135
0.9339
0.9700

(a) DCSL

Sensitivity
0.9196
0.9107
0.9107
0.9330
0.9709

F1-score
0.9200
0.9105
0.9104
0.9332
0.9698

(b) COVID-Net

Figure 4: The confusion matrixes of DCSL and COVID-Net.

ing of COVID-19 from chest X-rays. Table 1 reports the
results of our algorithm and compared algorithms. Our algorithm obtains a classification accuracy of 97.1%, a precision of 97.0%, a sensitivity of 97.09%, and an F1-score
of 96.98%. Our algorithm remarkably outperforms COVIDNet [46], which achieves state-of-the-art results before our
work. Also, our algorithm significantly outperforms all the
compared algorithms on all the metrics. As shown in Figure 2, even both the complex lung structures and indiscernible
infection areas lead to unusual difficulties; our algorithm still
obtains accurate performance, which demonstrates its robust
strengths.
Figure 4 displays the confusion matrixes of our algorithm and COVID-Net. Owing to our score-level cost-sensitive
learning, we achieve 100% accuracy in the class of COVID19. Such a result demonstrates the effectiveness of incorporating the score-level matrix after the output layer of deep
neural networks to modify the learning process. Figure 5
presents the sensitivities of each class, where our algorithm
achieves 100% sensitivity of COVID-19, which is much higher
than compared methods. These results once verify the advantages of score-level cost-sensitive learning. Both Figure 4 and Figure 5 show that our algorithm also achieves
the highest accuracy in other classes, which demonstrates
the critical role of conditional center loss that can improve
the intra-class compactness evenly.
We further perform statistical analysis to ensure that the
experimental results have statistical significance. A paired
t-test between the COVID-Net and our algorithm is at a 5%
significance level with a p-value of 0.010. This analysis result clearly shows that the improvement of our method is
noticeable. The p-values of the VGG19, Inceptionv3, and
ResNet50 models are less than 0.05, which proves that popular classifiers are not suitable for the task of screening COVID19 from chest X-rays. These analyses verify that our insight
that viewing the screening of COVID-19 from chest X-rays
as a fine-grained cost-sensitive classification task is correct.

4.3. Analysis

Figure 5: An illustration of the sensitivities values of each
class.

Table 2
This table shows the results of the ablation study of DCSL on
the accuracy, precision, sensitivity, and F1-score.
Method
Softmax Loss
Softmax Loss+CL
Softmax Loss+CCL

Accuracy

Precision

0.9163
0.9208
0.9721

0.9173
0.9229
0.9723

Sensitivity
0.9162
0.9207
0.9721

F1-score
0.9158
0.9208
0.9721

4.2. Results
The proposed discriminative cost-sensitive learning algorithm (DCSL) achieves the highest results on the screenTianyang Li et al.: Preprint submitted to Elsevier

This section further gives in-depth ablation studies to
demonstrate the effect of conditional center loss (CCL) and
score-level cost-sensitive learning (SLCSL), respectively. We
construct four ablation models based on the backbone network VGG-16. The first model is only using the cross-entropy
loss with softmax called as Softmax Loss. The second model
combines center loss and cross-entropy loss with softmax
called as Softmax+Center Loss. Similarly, the third model
combines conditional center loss and softmax loss called as
Softmax Loss + CCL. The final model is our algorithm
DCSL that combines score-level cost-sensitive learning, conditional center loss, and softmax loss.
Generally speaking, our final model DCSL achieves the
best performance than the other ablation models, as shown in
Figure 6. These confusion matrixes strongly prove that our
algorithm can accurately screen COVID-19 from chest Xrays without any missing case. Both Figure 8 and Figure 9
demonstrate the convergence and stability of DCSL in the
Page 8 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

(a) Softmax Loss

(b) Softmax+Center Loss

(c) Softmax Loss + CCL

(d) DCSL

Figure 6: The confusion matrixes of ablation studies from Softmax Loss, Softmax+Center Loss, Softmax Loss + Conditional
Center Loss (CCL), and DCSL. Our algorithm shows a higher and balance performance.

(a) Softmax Loss (b) Softmax+Center Loss

(a) Softmax Loss

(b) Softmax Loss + CCL

Figure 7: The t-SNE visualization of deep features from the
training data. The feature distribution of using Softmax Loss
+ Conditional Center Loss (CCL) are more discriminative than
using Softmax Loss only. The points of different colors denote
the deep features from different classes (0: normal; 1: COVID19; 2: other pneumonia).

training and validation period. These excellent results show
that our algorithm successfully achieves accurate and robust
screening of COVID-19 from chest X-rays. These extensive
results once verify the correctness of our insight that this task
is a fine-grained cost-sensitive classification problem.

(a) Softmax Loss (b) Softmax+Center Loss

(c) DCSL

Figure 8: Accuracy curves in the training and validation period. They show that DCSL has higher accuracy with stable
convergence.

4.3.1. Conditional Center Loss
Table 2 reports the results of out ablation study on different loss functions. Our conditional center loss (Softmax
Loss + CCL) remarkably outperforms the center loss and
softmax loss. These results demonstrate the importance of
considering the class-conditional information when updating the center points and optimizing the center loss. Figure 7 presents the t-SNE visualization of deep features from
the training data. It verifies that the conditional center loss
Tianyang Li et al.: Preprint submitted to Elsevier

(c) DCSL

Figure 9: Loss curves in the training and validation period. It
can be observed that DCSL has great stability and fast convergence.

can contribute to improving the intra-class compactness.
Moreover, Figure 6 shows that the conditional center loss
has fewer mistakes and achieves a balance performance on
the three classes. Also, Both Figure 8 and Figure 9 show
that the conditional center loss has excellent stability and fast
convergence. In summary, the conditional center loss has a
significant impact on the performance of our proposed architecture. When the conditional center loss is not used, the result of classification is obviously decreased, and the learned
deep features contain significant intra-class variations.

4.3.2. Score-Level Cost-Sensitive Learning
Another goal of this work is to enhance the sensitivity
of COVID-19 without decreasing the overall classification
accuracy. Although all the results have verified the advantages of score-level cost-sensitive learning, we should dissect its strengths. Figure 6 shows that using score-level costsensitive learning achieves zeros mistake of the COVID-19
class. Moreover, Figure 10 demonstrates that DCSL makes
the 100% sensitivity in COVID-19 without decreasing the
overall classification accuracy. Experimental results show
that DCSL can significantly improve the sensitivity and precision of COVID-19.
To conclude, cost-sensitive learning plays a crucial role
in the screening of COVID-19. During the global outbreak
of COVID-19, the cost of misclassifying COVID-19 patients
into other types of pneumonia or even healthy people are
much higher than the cost of misclassifying other classes.
The proposed score-level cost-sensitive learning has significantly improved the sensitivity of COVID-19, proving our
hypothesis that cost-sensitive learning is very suitable for the
Page 9 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning

Figure 10: Classification results of the ablation studies from
Softmax Loss, Softmax+Center Loss (CL), Softmax Loss +
Conditional Center Loss (CCL), and DCSL. Owning to the
score-level cost-sensitive learning, we achieve the highest sensitivity on COVID-19 class. The conditional center loss also
plays a vital role in the improvement of performance. These
results demonstrate the effectiveness of DCSL.

new task.

5. Conclusion
In this paper, we reported a new attempt for the finegrained cost-sensitive screening of COVID-19 from chest
X-rays. We proposed a novel discriminative cost-sensitive
learning (DCSL) that includes a conditional center loss function and a score-level cost-sensitive learning module. To the
best of our knowledge, this is the first method that formulates this novel application as a fine-grained cost-sensitive
classification problem. Extensive results have demonstrated
that DCSL can achieve reliable and accurate results. Indepth analyses have revealed the effectiveness and potential
of DCSL as a clinical tool to relieve radiologists from laborious workloads, such that contribute to the quickly large-scale
screening of COVID-19.

Acknowledgment
This work was partly funded by Natural Science Foundation of China (No.61872225); Introduction and Cultivation
Program for Young Creative Talents in Colleges and Universities of Shandong Province (No.173); the Natural Science Foundation of Shandong Province (No.ZR2019ZD04,
No.ZR2015FM010); the Project of Science and technology
plan of Shandong Higher Education Institutions Program (N
o.J15LN20); the Project of Shandong Province Medical and
Health Technology Development Program (No.2016WS0577).

References
[1] Abbas, A., Abdelsamea, M.M., Gaber, M.M., 2020. Classification of
covid-19 in chest x-ray images using detrac deep convolutional neural
network. arXiv preprint arXiv:2003.13815 .

Tianyang Li et al.: Preprint submitted to Elsevier

[2] Afshar, P., Heidarian, S., Naderkhani, F., Oikonomou, A., Plataniotis, K.N., Mohammadi, A., 2020. Covid-caps: A capsule networkbased framework for identification of covid-19 cases from x-ray images. arXiv preprint arXiv:2004.02696 .
[3] Apostolopoulos, I.D., Mpesiana, T.A., 2020. Covid-19: automatic
detection from x-ray images utilizing transfer learning with convolutional neural networks. Physical and Engineering Sciences in
Medicine , 1.
[4] Brefeld, U., Geibel, P., Wysotzki, F., 2003. Support vector machines
with example dependent costs, in: European Conference on Machine
Learning, Springer. pp. 23â€“34.
[5] Breiman, L., Friedman, J., Stone, C.J., Olshen, R.A., 1984. Classification and regression trees. CRC press.
[6] Chen, J., Wu, L., Zhang, J., Zhang, L., Gong, D., Zhao, Y., Hu, S.,
Wang, Y., Hu, X., Zheng, B., et al., 2020. Deep learning-based model
for detecting 2019 novel coronavirus pneumonia on high-resolution
computed tomography: a prospective study. medRxiv .
[7] Deng, J., Dong, W., Socher, R., Li, L.J., Li, K., Fei-Fei, L., 2009.
Imagenet: A large-scale hierarchical image database, in: 2009 IEEE
conference on computer vision and pattern recognition, Ieee. pp. 248â€“
255.
[8] Deng, J., Krause, J., Stark, M., Fei-Fei, L., 2015. Leveraging the
wisdom of the crowd for fine-grained recognition. IEEE transactions
on pattern analysis and machine intelligence 38, 666â€“676.
[9] Domingos, P., 1999. Metacost: A general method for making classifiers cost-sensitive, in: Proceedings of the fifth ACM SIGKDD international conference on Knowledge discovery and data mining, pp.
155â€“164.
[10] Dubey, A., Gupta, O., Raskar, R., Naik, N., 2018. Maximum-entropy
fine grained classification, in: Advances in Neural Information Processing Systems, pp. 637â€“647.
[11] Farooq, M., Hafeez, A., 2020. Covid-resnet: A deep learning framework for screening of covid19 from radiographs. arXiv preprint
arXiv:2003.14395 .
[12] Furlow, B., 2010. Radiation dose in computed tomography. Radiologic Technology 81, 437â€“450.
[13] Ge, R., Yang, G., Chen, Y., Luo, L., Feng, C., Zhang, H., Li, S., 2019.
Pv-lvnet: Direct left ventricle multitype indices estimation from 2d
echocardiograms of paired apical views with deep neural networks.
Medical image analysis 58, 101554.
[14] Ghoshal, B., Tucker, A., 2020. Estimating uncertainty and interpretability in deep learning for coronavirus (covid-19) detection.
arXiv preprint arXiv:2003.10769 .
[15] Gozes, O., Frid-Adar, M., Greenspan, H., Browning, P.D., Zhang, H.,
Ji, W., Bernheim, A., Siegel, E., 2020a. Rapid ai development cycle
for the coronavirus (covid-19) pandemic: Initial results for automated
detection & patient monitoring using deep learning ct image analysis.
arXiv preprint arXiv:2003.05037 .
[16] Gozes, O., Frid-Adar, M., Sagie, N., Zhang, H., Ji, W., Greenspan,
H., 2020b. Coronavirus detection and analysis on chest ct with deep
learning. arXiv:2004.02640.
[17] Hall, L., Goldgof, D., Paul, R., Goldgof, G.M., 2020. Finding covid19 from chest x-rays using deep learning on a small dataset .
[18] Hassanien, A.E., Mahdy, L.N., Ezzat, K.A., Elmousalami, H.H., Ella,
H.A., 2020. Automatic x-ray covid-19 lung image classification system based on multi-level thresholding and support vector machine.
medRxiv .
[19] He, K., Zhang, X., Ren, S., Sun, J., 2016. Deep residual learning
for image recognition, in: Proceedings of the IEEE conference on
computer vision and pattern recognition, pp. 770â€“778.
[20] Hemdan, E.E.D., Shouman, M.A., Karar, M.E., 2020. Covidx-net: A
framework of deep learning classifiers to diagnose covid-19 in x-ray
images. arXiv preprint arXiv:2003.11055 .
[21] Huang, L., Han, R., Ai, T., Yu, P., Kang, H., Tao, Q., Xia, L., 2020.
Serial quantitative chest ct assessment of covid-19: Deep-learning approach. Radiology: Cardiothoracic Imaging 2, e200075.
[22] Huda, W., 2007. Radiation doses and risks in chest computed tomography examinations. Proceedings of the American Thoracic Society

Page 10 of 11

Robust Screening of COVID-19 from Chest X-ray via Discriminative Cost-Sensitive Learning
4, 316â€“320.
[23] Jin, C., Chen, W., Cao, Y., Xu, Z., Zhang, X., Deng, L., Zheng, C.,
Zhou, J., Shi, H., Feng, J., 2020a. Development and evaluation of an
ai system for covid-19 diagnosis. medRxiv .
[24] Jin, S., Wang, B., Xu, H., Luo, C., Wei, L., Zhao, W., Hou, X., Ma,
W., Xu, Z., Zheng, Z., et al., 2020b. Ai-assisted ct imaging analysis
for covid-19 screening: Building and deploying a medical ai system
in four weeks. medRxiv .
[25] Jin, Y.H., Cai, L., Cheng, Z.S., Cheng, H., Deng, T., Fan, Y.P., Fang,
C., Huang, D., Huang, L.Q., Huang, Q., et al., 2020c. A rapid advice
guideline for the diagnosis and treatment of 2019 novel coronavirus
(2019-ncov) infected pneumonia (standard version). Military Medical
Research 7, 4.
[26] Kermany, D.S., Goldbaum, M., Cai, W., Valentim, C.C., Liang, H.,
Baxter, S.L., McKeown, A., Yang, G., Wu, X., Yan, F., et al., 2018.
Identifying medical diagnoses and treatable diseases by image-based
deep learning. Cell 172, 1122â€“1131.
[27] Khalifa, N.E.M., Taha, M.H.N., Hassanien, A.E., Elghamrawy, S.,
2020. Detection of coronavirus (covid-19) associated pneumonia based on generative adversarial networks and a fine-tuned deep
transfer learning model using chest x-ray dataset. arXiv preprint
arXiv:2004.01184 .
[28] Khan, S.H., Hayat, M., Bennamoun, M., Sohel, F.A., Togneri, R.,
2017. Cost-sensitive learning of deep feature representations from
imbalanced data. IEEE transactions on neural networks and learning
systems 29, 3573â€“3587.
[29] Lin, D., Shen, X., Lu, C., Jia, J., 2015a. Deep lac: Deep localization,
alignment and classification for fine-grained recognition, in: Proceedings of the IEEE conference on computer vision and pattern recognition, pp. 1666â€“1674.
[30] Lin, T.Y., RoyChowdhury, A., Maji, S., 2015b. Bilinear cnn models for fine-grained visual recognition, in: Proceedings of the IEEE
international conference on computer vision, pp. 1449â€“1457.
[31] Ling, C.X., Sheng, V.S., 2008. Cost-sensitive learning and the class
imbalance problem.
[32] Maloof, M.A., 2003. Learning when data sets are imbalanced and
when costs are unequal and unknown, in: ICML-2003 workshop on
learning from imbalanced data sets II, pp. 2â€“1.
[33] Narin, A., Kaya, C., Pamuk, Z., 2020. Automatic detection of coronavirus disease (covid-19) using x-ray images and deep convolutional
neural networks. arXiv preprint arXiv:2003.10849 .
[34] Ozturk, S., Ozkaya, U., Barstugan, M., 2020. Classification of coronavirus images using shrunken features. medRxiv .
[35] Schroff, F., Kalenichenko, D., Philbin, J., 2015. Facenet: A unified
embedding for face recognition and clustering, in: Proceedings of
the IEEE conference on computer vision and pattern recognition, pp.
815â€“823.
[36] Sethy, P.K., Behera, S.K., 2020. Detection of coronavirus disease
(covid-19) based on deep features .
[37] Shan+, F., Gao+, Y., Wang, J., Shi, W., Shi, N., Han, M., Xue, Z.,
Shen, D., Shi, Y., 2020. Lung infection quantification of covid-19 in
ct images with deep learning. arXiv preprint arXiv:2003.04655 .
[38] Shi, F., Wang, J., Shi, J., Wu, Z., Wang, Q., Tang, Z., He, K., Shi,
Y., Shen, D., 2020a. Review of artificial intelligence techniques in
imaging data acquisition, segmentation and diagnosis for covid-19.
arXiv:2004.02731.
[39] Shi, F., Xia, L., Shan, F., Wu, D., Wei, Y., Yuan, H., Jiang, H., Gao,
Y., Sui, H., Shen, D., 2020b. Large-scale screening of covid-19 from
community acquired pneumonia using infection size-aware classification. arXiv preprint arXiv:2003.09860 .
[40] Simonyan, K., Zisserman, A., 2014.
Very deep convolutional networks for large-scale image recognition. arXiv preprint
arXiv:1409.1556 .
[41] Song, Y., Zheng, S., Li, L., Zhang, X., Zhang, X., Huang, Z., Chen,
J., Zhao, H., Jie, Y., Wang, R., et al., 2020. Deep learning enables
accurate diagnosis of novel coronavirus (covid-19) with ct images.
medRxiv .
[42] Storrs, C., 2013. Do ct scans cause cancer? Scientific American 309,

Tianyang Li et al.: Preprint submitted to Elsevier

30â€“33.
[43] Sun, X., Chen, L., Yang, J., 2019. Learning from web data using
adversarial discriminative neural networks for fine-grained classification, in: Proceedings of the AAAI Conference on Artificial Intelligence, pp. 273â€“280.
[44] Sun, Y., Chen, Y., Wang, X., Tang, X., 2014. Deep learning face representation by joint identification-verification, in: Advances in neural
information processing systems, pp. 1988â€“1996.
[45] Szegedy, C., Vanhoucke, V., Ioffe, S., Shlens, J., Wojna, Z., 2016. Rethinking the inception architecture for computer vision, in: Proceedings of the IEEE conference on computer vision and pattern recognition, pp. 2818â€“2826.
[46] Wang, L., Wong, A., 2020. Covid-net: A tailored deep convolutional
neural network design for detection of covid-19 cases from chest radiography images. arXiv preprint arXiv:2003.09871 .
[47] Wang, S., Kang, B., Ma, J., Zeng, X., Xiao, M., Guo, J., Cai, M.,
Yang, J., Li, Y., Meng, X., et al., 2020. A deep learning algorithm using ct images to screen for corona virus disease (covid-19). medRxiv
.
[48] Wei, X.S., Xie, C.W., Wu, J., Shen, C., 2018. Mask-cnn: Localizing
parts and selecting descriptors for fine-grained bird species categorization. Pattern Recognition 76, 704â€“714.
[49] Wen, Y., Zhang, K., Li, Z., Qiao, Y., 2016. A discriminative feature
learning approach for deep face recognition, in: European conference
on computer vision, Springer. pp. 499â€“515.
[50] Xu, H., Qi, G., Li, J., Wang, M., Xu, K., Gao, H., 2018. Fine-grained
image classification by visual-semantic embedding., in: IJCAI, pp.
1043â€“1049.
[51] Xu, X., Jiang, X., Ma, C., Du, P., Li, X., Lv, S., Yu, L., Chen, Y., Su,
J., Lang, G., et al., 2020. Deep learning system to screen coronavirus
disease 2019 pneumonia. arXiv preprint arXiv:2002.09334 .
[52] Zadrozny, B., Elkan, C., 2001. Learning and making decisions when
costs and probabilities are both unknown, in: Proceedings of the seventh ACM SIGKDD international conference on Knowledge discovery and data mining, pp. 204â€“213.
[53] Zadrozny, B., Langford, J., Abe, N., 2003. A simple method for costsensitive learning .
[54] Zhang, J., Xie, Y., Li, Y., Shen, C., Xia, Y., 2020. Covid-19 screening
on chest x-ray images using deep learning based anomaly detection.
arXiv preprint arXiv:2003.12338 .
[55] Zhang, N., Donahue, J., Girshick, R., Darrell, T., 2014. Part-based
r-cnns for fine-grained category detection, in: European conference
on computer vision, Springer. pp. 834â€“849.
[56] Zheng, C., Deng, X., Fu, Q., Zhou, Q., Feng, J., Ma, H., Liu, W.,
Wang, X., 2020. Deep learning-based detection for covid-19 from
chest ct using weak label. medRxiv .
[57] Zhou, Z.H., Liu, X.Y., 2010. On multi-class cost-sensitive learning.
Computational Intelligence 26, 232â€“257.

Page 11 of 11

