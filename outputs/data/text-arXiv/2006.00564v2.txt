Hamiltonian structure of compartmental
epidemiological models
Angel Ballesteros1 , Alfonso Blasco1 , Ivan Gutierrez-Sagredo1,2
1
2

Departamento de FÄ±Ìsica, Universidad de Burgos, 09001 Burgos, Spain

Departamento de MatemaÌticas y ComputacioÌn, Universidad de Burgos, 09001 Burgos, Spain

arXiv:2006.00564v2 [math.DS] 20 Jul 2020

e-mail: angelb@ubu.es, ablasco@ubu.es, igsagredo@ubu.es

Abstract
Any epidemiological compartmental model with constant population is shown to be a Hamiltonian
dynamical system in which the total population plays the role of the Hamiltonian function. Moreover,
some particular cases within this large class of models are shown to be bi-Hamiltonian. New interacting
compartmental models among different populations, which are endowed with a Hamiltonian structure,
are introduced. The Poisson structures underlying the Hamiltonian description of all these dynamical
systems are explicitly presented, and their associated Casimir functions are shown to provide an efficient
tool in order to find exact analytical solutions for epidemiological models, such as the ones describing
the dynamics of the COVID-19 pandemic.

Keywords: epidemics, compartmental models, dynamical systems, Hamiltonian systems, Poisson structures,
Casimir functions

Contents
1 Introduction

2

2 Generalized SIR model

5

2.1

A unified Hamiltonian description for the generalized SIR model . . . . . . . . . . . . . . . .

5

2.2

A note regarding models with non-constant population . . . . . . . . . . . . . . . . . . . . . .

9

3 Hamiltonian structure of compartmental models
3.1

Generalized SEIR model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

9
11

4 Models for N interacting SIR populations

12

5 N interacting compartmental models

13

6 Bi-Hamiltonian structure of epidemic models

15

6.1

Endemic SIRS

. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . .

6.2

A SIR model with a vaccination function

. . . . . . . . . . . . . . . . . . . . . . . . . . . . .

15
16

7 Exact analytical solutions from Casimir functions

17

8 Concluding remarks

19

1

1

Introduction

The recent COVIDâ€“19 pandemic has showed that a deeper understanding of the dynamics of the outbreaking
and spreading of an infectious disease is necessary [1, 2, 3, 4, 5, 6]. Specially urgent is the need for models
that accurately predicts the first stages of an epidemic outbreak [7], in order to guide a safe reopening of
countries and thus avoiding new outbreaks that could be devastating [8].
The origin of the mathematical modeling for epidemics can be traced back to the works of Daniel
Bernouilli regarding the spreading of smallpox [9]. Since then the field of mathematical epidemiology has
experienced a great development, mainly in the form of very concrete models describing epidemics with
specific features [10, 11]. Among them, the so-called compartmental models [12, 13, 14, 15, 16] are based
on the classification of the individuals of a given total population in a number of compartments, each of
them representing a different stage in the infectious process. In these models, population transitions among
different compartments can be assumed to be either deterministic or stochastic. For deterministic models, the movement from one compartment to another is governed by an ordinary differential equation. So,
mathematically, these compartmental models are just systems of (nonlinearly) coupled ordinary differential
equations (ODEs).
Among these models, a prominent role is played by the original SIR model proposed by Kermack and
McKendrick [17], which is expressed by a 3-dimensional dynamical system defined by
SÌ‡(t) = âˆ’Î² S(t) I(t),
Ë™ = Î² S(t) I(t) âˆ’ Î± I(t),
I(t)

(1)

RÌ‡(t) = Î± I(t),
which is subjected to the initial conditions S(0) = S0 , I(0) = I0 and R(0) = R0 . In this very schematic
model the population is divided into 3 compartments:
â€¢ Susceptible individuals S(t): not infected individuals at time t who could potentially be infected.
â€¢ Infected individuals I(t): infected individuals at time t which can spread the disease at time t0 > t.
â€¢ Recovered individuals R(t): this compartment really contains 2 subgroups:
â€“ Individuals that have been infected at time t0 < t in the past and have developed immunization
to the disease.
â€“ Individuals that have died at time t0 < t.
The original SIR model assumes that both the transmission rate Î² (the probability of any susceptible
individual being infected when meeting an infected individual) and the recovery rate Î± are constants. Moreover, it is also assumed that the immunization is perpetual, so recovered individuals cannot be reinfected.
Of course, since there is no transference from the recovered compartment to the other two ones, deaths are
considered as â€™recoveredâ€™ individuals. Moreover, the SIR model also assumes that the total population is
constant, since
SÌ‡ + IË™ + RÌ‡ = 0,
(2)
and thus
S + I + R = N.

(3)

Note that there is no loss of generality in assuming that N = 1 and therefore thinking of S, I and R as
fractions of the total population. This will be the case during the rest of the paper, unless otherwise stated.
To be more precise, this model should be interpreted as describing an epidemic whose dynamics is fast
enough in order to assume that the size of the population is constant (so no â€˜vital dynamicsâ€™ are considered)
and such that the recovered individuals are immunized for a long enough time. In this way the change in
the total population by causes different from the infection can be neglected. The dynamics of this simple
model, which is given in Figure 2, can be schematically represented by the diagram depicted in Figure 1.

2

Note that in this kind of diagrams, an arrow going out from a given compartment implies a negative sign for
the corresponding term in the r.h.s. of the differential equation for the derivative of the population for such
compartment. Since each arrow provides two terms with opposite signs, any model constructed through an
arbitrary number of arrows between pairs of compartments will be such that the total population is constant
(the sum over all compartments of all the terms at the r.h.s. of the system of ODEs vanishes).
1.0

0.8

Î²SI
S

S(t)

0.6

I

I(t)
R(t)

0.4

0.2

Î±I
R

10

Figure 1: Schematic diagram for the SIR system.

20

30

40

t

Figure 2: Typical dynamics of the SIR system for Î² =
1, Î± = 0.1. The infection grows to reach its peak, and
then the infection disappears.

Despite its great simplicity, the SIR model of Kermack and McKendric has proved to provide the essential
qualitative features of several complex epidemics. In fact, it has been proved to give an accurate quantitative
description of the COVIDâ€“19 pandemic for some countries [18]. A generalization of the original SIR model
that is sensible for viral infections [19, 20] (see also [21, 22]) consists in substituting the constant transmission
rate by a function that depends on the sum of susceptible and infected populations, namely
Ï†(S + I)
,
S+I

Î²(S + I) =

(4)

with Ï† : R+ â†’ R+ an strictly positive function such that
0



Ï† (x) â‰¥ 0,

Ï†(x)
x

0
â‰¤ 0.

(5)

In what follows we will consider this generalization, since all our results will also hold in this case.
A large number of compartmental models have been proposed, most of them being extensions of the
original SIR system since more complex epidemics may require extra terms in the system of ODEs. For
instance, endemic diseases characterized by a non-permanent immunization could be considered, in which
an extra arrow connecting the R and S compartments has to appear in the diagram generalizing Figure 1.
Other diseases may present a passive immunity, like maternal passive immunity, in which newborns receive
maternal antibodies. This feature is typically modeled by adding an extra compartment to the model. All
these models have been shown to be successful in order to model complex epidemics, and they are usually
solved through standard numerical techniques for nonlinear systems of ODEs.
It is also well-known [23] that the original SIR system (1) admits a Hamiltonian description (for the sake
of completeness, a summary of the basics on the theory of Hamiltonian dynamical systems is provided in
the Appendix). In this approach, the Hamiltonian function is just the total population
H1 = S + I + R ,

(6)

and the the SIR dynamical system is obtained as the Hamiltonâ€™s equations
SÌ‡ = {S, H1 }1 ,

IË™ = {I, H1 }1 ,

3

RÌ‡ = {R, H1 }1 ,

(7)

with respect to the Poisson structure
{S, I}1 = 0,

{S, R}1 = âˆ’Î²S I,

{I, R}1 = âˆ’Î± I + Î² S I.

(8)

Moreover, Nutku also proved [23] that the SIR system is bi-Hamiltonian, since there does exist a second
Poisson structure
{S, I}2 = âˆ’Î² S I, {S, R}2 = Î²S I, {I, R}2 = âˆ’Î² S I,
(9)
which is compatible with the first one (in the sense that {Â·, Â·} = {Â·, Â·}1 + {Â·, Â·}2 is a well-defined Poisson
structure, see the Appendix), together with a second Hamiltonian function which is not the total population,
namely
Î±
(10)
H2 = âˆ’R âˆ’ log(S) ,
Î²
but nevertheless the SIR dynamical system can be again written as the Hamiltonâ€™s equations
SÌ‡ = {S, H2 }2 = âˆ’Î²SI,

IË™ = {I, H2 }2 = Î²SI âˆ’ Î±I,

RÌ‡ = {R, H2 }2 = Î±I.

(11)

From the previous expressions it is easy to check that {f, H1 }2 = 0 for all f (S, I, R), so H1 is a Casimir
function for {Â·, Â·}2 . A Casimir function for {Â·, Â·}1 is given by
C1 = S + I âˆ’ 1 âˆ’

Î±
log(S) ,
Î²

(12)

which coincides with (10) in the hypersurface of constant population M = H1âˆ’1 (1), i.e. H2 |M = C1 |M . In
this case we could have taken C1 as the second Hamiltonian function. However, we choose not to do so since
this will no longer be true in some of the examples presented in this paper. The fact that Casimir functions
provide additional integrals for the dynamics is one of the essential features of the Hamiltonian description
of dynamical systems.
The aim of this paper is to show that a Hamiltonian structure in which the total population plays the role
of the Hamiltonian function can be defined for a very large class of (deterministic) compartmental epidemiological models, including certain systems of interacting populations which, to the best of our knowledge,
have not been previously considered in the literature. In general, interacting models should be relevant
in the context of the current COVIDâ€“19 pandemic, where some regions/countries can be described by the
same dynamical models of the infection, although with different parameters, and the exchange of individuals
among regions must be taken into account for the joint evolution of the pandemic. We stress that, in general,
the Poisson structures defining the Hamiltonian structures here presented could be helpful in order to find
exact analytical solutions for the corresponding epidemiological models provided that the associated Casimir
functions are found.
The structure of the paper is the following. In Section 2 we study the most general compartmental
model with three compartments and constant population, which we call the generalized SIR model, and we
show that this is indeed a Hamiltonian system. Some outstanding instances of this model are considered
and, moreover, we show that some compartmental models with non-constant population are equivalent to
this system. In Section 3 we prove our main result stating that every compartmental model with constant
population is Hamiltonian. In Section 4 we introduce a family of models consisting in an arbitrary number
of generalized SIR systems whose compartments also interact by the exchange of individuals from one
population to another, and the Hamiltonian structure for these interacting models with constant joint total
population is presented. In Section 5 we show that an analogous result is valid, under a mild assumption,
by taking arbitrary compartmental models as building blocks for the interacting system. In Section 6 we
explicitly present the bi-Hamiltonian structure of several compartmental models, in particular of the SIR
model with a vaccination function and the endemic SIRS system. Finally, in Section 7 we find exact analytical
solutions for some of the examples previously considered, which reduce to the exact analytical solution of the
SIR model when the relevant parameters vanish. A Section including some comments and open questions
closes the paper.

4

2

Generalized SIR model

The basic SIR system (1) of Kermack and McKendrick can be extended in order to include more general
interactions among the susceptible, infected and recovered compartments. In fact, the most general 3dimensional dynamical system containing the original SIR (with the generalized transmission rate Î²(S + I)
given by (4)) and maintaining the total population constant, which we call the generalized SIR system, can
be written as
SÌ‡ = âˆ’Î²SI âˆ’ Ï•Sâ†’I (S, I, R) âˆ’ Ï•Sâ†’R (S, I, R),
IË™ = Î²SI âˆ’ Î±I + Ï•Sâ†’I (S, I, R) âˆ’ Ï•Iâ†’R (S, I, R),

(13)

RÌ‡ = Î±I + Ï•Sâ†’R (S, I, R) + Ï•Iâ†’R (S, I, R),
where Ï•Aâ†’B (S, I, R) represents the transfer function from the compartment A to the compartment B,
which in general are allowed to be arbitrary functions of S, I and R. Obviously the original terms of the
SIR system could be absorbed in Ï•Aâ†’B (S, I, R), but for the sake of clarity we choose not to do so. This
system is represented by the following schematic diagram:
Î²SI
S

I

Ï•Sâ†’I (S, I, R)
Ï•Iâ†’R (S, I, R)

Ï•Sâ†’R (S, I, R)

Î±I
R

where the direction of an arrow simply shows the transference of individuals given by the positive part of the
corresponding function. Of course, composition of arrows is allowed, and blue arrows are the corresponding
ones to the original SIR model.
Indeed, such a generic system does not need to be biologically relevant, since not all choices for Ï•Aâ†’B (S, I, R)
describe sensible epidemiological models. However, different choices of these functions do lead to systems
catching key features of different epidemiological situations. In any case, in the sequel we show that such a
generalized SIR (13) system admits a unified description as a Hamiltonian system.

2.1

A unified Hamiltonian description for the generalized SIR model

For concreteness, we consider the generalized SIR model (13), with Î² = Î²(S + I) of the form (4) and
Î± constant. However we should stress that the following result is valid for Î±(S, I) and Î²(S, I) arbitrary
functions of S and I. We have the following
Proposition 1. The generalized SIR system given by (13) is a Hamiltonian system, with respect to the
Hamiltonian function
H(S, I, R) = S + I + R
(14)
and the Poisson algebra defined by the fundamental Poisson brackets given by
{I, R} = âˆ’Î±I + Î²SI + Ï•2 (S, I),
{S, R} = âˆ’Î²SI + Ï•1 (S, I),
{S, I} = 0,

(15)

with
Ï•1 = âˆ’Ï•Sâ†’I âˆ’ Ï•Sâ†’R ,
Ï•2 = Ï•Sâ†’I âˆ’ Ï•Iâ†’R .
5

(16)

Proof. Hamiltonâ€™s equations for (14) and (15) read
SÌ‡ = {S, H} = âˆ’Î²SI + Ï•1 (S, I),
IË™ = {I, H} = Î²SI âˆ’ Î±I + Ï•2 (S, I),

(17)

RÌ‡ = {R, H} = Î±I âˆ’ Ï•1 (S, I) âˆ’ Ï•2 (S, I),
which agrees with (13) under the identification (16). Moreover, it is easy to check that {Â·, Â·} is a well-defined
Poisson structure, since the Jacobi identity
Jac(S, I, R) = {{S, I}, R} + {{R, S}, I} + {{I, R}, S} = 0 ,

(18)

holds. The total phase space for the system is thus R3+ . However, the fact that the Hamiltonian function
H : R3+ â†’ R+ is conserved along trajectories
HÌ‡ = SÌ‡ + IË™ + RÌ‡ = 0,

(19)

together with the fact that the Hamiltonian is just the total population implies that the dynamics of the
system takes place on M = Hâˆ’1 (1) (recall that local coordinates S, I, R are interpreted as fractions of
the total population, which is conserved). Therefore, the restriction of any function F : R3+ â†’ R+ to the
hypersurface M is given by F |M = F (S, I, 1 âˆ’ I âˆ’ S), thus proving that the Hamiltonian system allows to
include arbitrary functions of R.
With this notation, which is the one that we will use throughout the paper, the explicit dependence of
R can be avoided, and the generalized SIR model is represented by the following diagram:
Î²SI
S

I
Ï•2 (S, I)

Î±I

Ï•1 (S, I)
R

Note that the fact that Ï•1 (S, I) and Ï•2 (S, I) can be arbitrary functions of S, I, while satisfying Jac(S, I, R) =
0, can be traced back to the fact that {S, I} vanishes (15).
The following particular examples will play an important role in the rest of the paper.
Example 1 (Original SIR model). The original SIR system (1) is recovered by setting Î²(S + I) = Î² and
Ï•1 (S, I) = Ï•2 (S, I) = 0.
â™¦
Example 2 (Endemic SIRS model). An endemic disease is characterized by a non-permanent immunization,
in such a way that the individuals that have been infected can be re-infected after a sufficiently large
amount of time. A simple model capturing this feature is recovered from (17) by setting Ï•1 (S, I) = ÂµI and
Ï•2 (S, I) = âˆ’ÂµI. The ODE system becomes
SÌ‡ = âˆ’Î²SI + Âµ I,
IË™ = Î²SI âˆ’ (Î± + Âµ)I,

(20)

RÌ‡ = Î±I.
The SIRS endemic model, whose typical dynamics is shown in Figure 4, is represented by the diagram
of Figure 3.
â™¦

6

0.8

S(t)

0.6

Î²SI

I(t)

S

0.4

I

R(t)

ÂµI
0.2

ÂµI

Î±I

10

20

30

40

50

t

R
Figure 4: Typical dynamics of the endemic SIRS system (Î² = 1, Î± = 0.1, Âµ = 0.1). Similarly to the original
SIR (Figure 2) the infection disappears. However, due
to the temporal immunization, the susceptible population does not vanish for t large, thus making future
outbreaks possible.

Figure 3: Endemic SIRS diagram.

Example 3 (SIR model including a vaccination function). Systems that model vaccinated populations are
specially interesting, since they allow to design optimal vaccination strategies (see for example [24, 25]).
Setting Ï•1 (S, I) = âˆ’v(S, I) and Ï•2 (S, I) = 0 in the generalized SIR (17) we have the system
SÌ‡ = âˆ’Î²SI âˆ’ v(S, I),
IË™ = Î²SI âˆ’ Î±I,

(21)

RÌ‡ = Î±I + v(S, I).
If v : R2+ â†’ R+ is a strictly positive function, this model describes a population that is receiving a vaccination
during the epidemic outbreak. The diagram of a SIR model including vaccination, together with an example
of its dynamics are given in Figures 5 and 6, respectively.

1.0

0.8

Î²SI

S(t)

0.6

S

I(t)

I

R(t)

0.4

0.2

v(S, I)

Î±I
R

Figure 5: A simple vaccination model.

10

20

30

40

50

t

Figure 6: A simple modification of the original SIR
with vaccination function âˆ S (Î² = 1, Î± = 0.1, v =
0.1). The dynamics are similar to Figure 2, but with
a smaller infection peak.

The following choices for the vaccination function will play a prominent role in the following: a) v(S, I) =
vI and b) v(S, I) = vS, with v âˆˆ R+ .
â™¦
Example 4 (SIR with vital dynamics). Models that include vital dynamics, i.e. models that take into
account the deaths and newborns in the population during the epidemics, do also fit in the generalized SIR
system (13), provided that the total population remains constant. The dynamical system for such a model
7

is given by
SÌ‡ = âˆ’Î²SI + (dS S + dI I + dR R) âˆ’ dS S ,
{z
}
|
Ï•1 (S,I)

IË™ = Î²SI âˆ’ Î±I âˆ’ dI I ,
|{z}

(22)

Ï•2 (S,I)

RÌ‡ = Î±I âˆ’

,

dR R
|{z}

Ï•1 (S,I)+Ï•2 (S,I)

where dS , dI , dR are the death rates for each compartment, and the born rate is adjusted to keep the
population constant. In fact, if dS = dI = dR = d, then the newborns would be proportional to the total
population S + I + R, which is usually the assumption used for these kind of models. This system is thus
represented by the diagram
Î²SI
dS S

dI I

S

I

dS S + dI I + dR R

Î±I
R
dR R

In order to rewrite this model in the form (15) we just have to set
Ï•1 (S, I) = dI I + dR (1 âˆ’ S âˆ’ I),

(23)

Ï•2 (S, I) = âˆ’dI I,

and we also have to restrict the dynamics to H = S + I + R = 1. The diagram of the system is given in
Figure 7 while a possible dynamics is presented in Figure 8.
â™¦

0.8

I(t)

S

I
âˆ’dI I

dI I + dR R

S(t)

0.6

Î²SI

0.4

R(t)

0.2

Î±I

20

40

60

80

100

t

R
Figure 7: A SIR system with vital dynamics.

Figure 8: The qualitative behavior of the solutions for
this system is similar to the endemic SIRS (see Figure
4). The inclusion of new susceptible individuals makes
the disease to become endemic, and the disease does
not disappear in the long term. (Î² = 1, Î± = 0.1, dS =
dR = 0.01, dI = 0.2).
8

2.2

A note regarding models with non-constant population

All the models considered so far have a constant population. However, some models with a non-constant
population can be also considered in this framework. Let us set S(t)+I(t)+R(t) = N (t) the total population,
which is a non-constant function of time. Thus we have


d S(t) + I(t) + R(t)
= 0,
(24)
dt
N (t)
so let us define
s(t) =

S(t)
,
N (t)

i(t) =

I(t)
,
N (t)

r(t) =

R(t)
.
N (t)

(25)

If we assume an exponential growth of the total population, we have that
NÌ‡ (t) = (b âˆ’ d)N (t).

(26)

For instance this is the case for models including vital dynamics with equal death rates for each compartment.
Under this assumption, the dynamics of a generalized SIR model with non-constant population reads
SÌ‡ = bN âˆ’ dS âˆ’ Î²

SI
+ Ï•1 (S, I),
N

SI
IË™ = Î²
âˆ’ Î±I âˆ’ dI + Ï•2 (S, I),
N
RÌ‡ = Î±I âˆ’ dR âˆ’ Ï•1 (S, I) âˆ’ Ï•2 (S, I).

(27)

If Ï•1 , Ï•2 are linear functions (most of the models do consider this assumption), we have that
ds
SÌ‡N âˆ’ S NÌ‡
=
= âˆ’Î²si + b âˆ’ ds + Ï•1 (s, i) âˆ’ (b âˆ’ d)s,
|
{z
}
dt
N2
Ï•Ìƒ1 (s,i)

Ë™ âˆ’ I NÌ‡
di
IN
=
= Î²si âˆ’ Î±i âˆ’di + Ï•2 (s, i) âˆ’ (b âˆ’ d)i,
|
{z
}
dt
N2

(28)

Ï•Ìƒ2 (s,i)

dr
RÌ‡N âˆ’ RNÌ‡
=
= Î±i âˆ’d(1 âˆ’ s âˆ’ i) âˆ’ Ï•1 (s, i) âˆ’ Ï•2 (s, i) âˆ’ (b âˆ’ d)(1 âˆ’ s âˆ’ i),
{z
}
|
dt
N2
âˆ’Ï•Ìƒ1 (s,i)âˆ’Ï•Ìƒ2 (s,i)

where 1 âˆ’ s âˆ’ i = r. Clearly the condition
d
(s + i + r) = 0,
dt

(29)

is thus satisfied. In this way, any generalized SIR model with Ï•1 , Ï•2 linear and with a non-constant population
with exponential growth, turns out to be equivalent to a generalized SIR model (17) with constant population.
Therefore, all the results presented in this paper are also valid for this type of systems.

3

Hamiltonian structure of compartmental models

In general, being Hamiltonian is quite a restrictive property for a dynamical system. However, we have just
proved that the generalized SIR model (13) is Hamiltonian with no restrictions, and this suggests that a
deeper understanding of this result should be possible. In fact, it turns out that this is a particular case of a
much more general finding, which essentially states that any compartmental model with constant population
is a Hamiltonian system.

9

Proposition 2. Let
xÌ‡Âµ = f Âµ (x1 , . . . , xM âˆ’1 ),

Âµ âˆˆ {1, . . . , M }

(30)

be a system of ODEs, such that
xÌ‡1 + Â· Â· Â· + xÌ‡M = 0.

(31)

This system is a Hamiltonian system, with
H=

M
X

xÂµ ,

(32)

Âµ=1

and fundamental Poisson brackets given by
{xÂµ , xÎ½ } = 0,

âˆ€Âµ, Î½ âˆˆ {1, . . . , M âˆ’ 1}

{x , x } = f (x , . . . , xM âˆ’1 ),
Âµ

M

Âµ

1

Âµ âˆˆ {1, . . . , M âˆ’ 1}.

(33)

Proof. Clearly, there are only M âˆ’ 1 independent equations, since
xÌ‡M = âˆ’xÌ‡1 âˆ’ Â· Â· Â· âˆ’ xÌ‡M âˆ’1 .

(34)

Hamiltonâ€™s equations read
xÌ‡Âµ = {xÂµ , H} = {xÂµ , xM } = f Âµ (x1 , . . . , xM âˆ’1 ),

âˆ€Âµ âˆˆ {1, . . . , M âˆ’ 1}

(35)

so the dynamical system is recovered from the Hamiltonian structure, and all Jacobi identities are satisfied
since {{Â·, Â·}, Â·} = 0, because the subalgebra defined by x1 , . . . , xM âˆ’1 is Abelian:
Âµ Î½ M
{x
, x }, x } + {
Jac(xÂµ , xÎ½ , xM ) = {

{xM , xÂµ }
| {z }

âˆ’f Âµ (x1 ,...,xM âˆ’1 )

, xÎ½ } + { {xÎ½ , xM } , xÂµ } = 0.
| {z }

(36)

f Î½ (x1 ,...,xM âˆ’1 )

From this result, and taking into account that the Hamiltonian is a conserved quantity, we straightforwardly deduce the following
Corollary 1. Every compartmental model with constant population is a Hamiltonian system.
Moreover, we have that Proposition 1 is just a particular case of the previous Proposition 2, with M = 3,
x1 = S, x2 = I and x3 = R. Moreover, Proposition 2 shows that the generalized SIR system (13) can be
naturally written as a Hamiltonian system for two extra Poisson structures, in both cases by keeping the
same Hamiltonian. The first Poisson structure corresponds to take x3 = I and reads
{S, I} = âˆ’Î²S(1 âˆ’ S âˆ’ R) + Ï•1 (S, R),
{S, R} = 0,

(37)

{I, R} = âˆ’Î±(1 âˆ’ S âˆ’ R) + Ï•1 (S, R) + Ï•2 (S, R),
while the second one corresponds to x3 = S and is given by
{S, I} = Î±I âˆ’ Î²(1 âˆ’ I âˆ’ R)I âˆ’ Ï•2 (I, R),
{S, R} = âˆ’Î±I + Ï•1 (I, R) + Ï•2 (I, R),

(38)

{I, R} = 0.
The existence of different Poisson structures will be relevant in the following Section, since each of them will
allow us to define different interacting SIR models.

10

3.1

Generalized SEIR model

As an application of the result presented above, namely that every compartmental epidemiological model
with constant population is a Hamiltonian system, we present the Hamiltonian structure for the SEIR system
[13]. This model differs from SIR in the existence of an extra compartment, E, representing the individuals
that have been exposed to the infection but are not infective yet. Therefore, this model accounts for infections
that present an incubation period. As we did for the SIR model, we can define a family of generalized SEIR
systems, defined by the following system of ODEs
SÌ‡ = âˆ’Î²SI + Ï•1 (S, E, I),
EÌ‡ = Î²SI âˆ’ E + Ï•2 (S, E, I),
IË™ = âˆ’Î±I + E + Ï•3 (S, E, I),

(39)

RÌ‡ = Î±I âˆ’ Ï•1 (S, I) âˆ’ Ï•2 (S, I) âˆ’ Ï•3 (S, E, I),
where Ï•i (S, E, I) are arbitrary functions of S, E, I. This system is represented by the diagram
Î²SI
S

Ï•1 (S, E, I)

Ï•2 (S, E, I)

E

E

Ï•3 (S, E, I)

R

I
Î±I

Of course the original SEIR is recovered when Ï•i (S, E, I) = 0. The analogue of Examples 2-4 can be defined
in a similar way.
The fundamental Poisson brackets that endow the generalized SEIR model with a Hamiltonian structure
are
{S, R} = âˆ’Î²SI + Ï•1 (S, E, I),
{I, R} = âˆ’Î±I + E + Ï•3 (S, E, I),

(40)

{E, R} = Î²SI âˆ’ E + Ï•2 (S, E, I).
{S, I} = 0,

{E, S} = 0,

{E, I} = 0,

which is a particular case of Proposition 2 with M = 4 and xM = R. Again, three more different Poisson
structures giving rise to the same dynamical system are possible by setting xM = S, xM = E or xM = I. In
all the cases the Hamiltonian is just the total population
H = S + E + I + R,

(41)

and it is straightforward to show that Hamiltonâ€™s equation are just (39). Similarly to the SIR case, given that
the dynamics take place on Hâˆ’1 (1), arbitrary functions of R are indeed included in (39), and therefore this
is the most general 4-dimensional compartmental model with constant population containing the original
SEIR system.

11

4

Models for N interacting SIR populations

The aim of this Section is to show that we can define an epidemiological Hamiltonian system providing the
dynamics of N populations P1 , . . . , PN , each of them presenting the â€˜internalâ€™ dynamics of a generalized
SIR model (13), and such that the N populations interact through an arbitrary transference from one
compartment of Pa to the same compartment of Pb . We stress that the model will allow for the transference
function to be an arbitrary function Ï„ab (Sa , Ia , Sb , Ib ) of the variables of the populations involved. For the
sake of brevity, we only present the results for the case in which the interacting compartments are Ra
(recovered individuals) which is the model constructed from the Hamiltonian description (1). However, the
brackets (37) and (38) allow to construct Hamiltonian interacting systems with interacting compartments
Ia and Sa , respectively.
Proposition 3. Let us consider the Hamiltonian system defined by the 3N-dimensional Poisson algebra with
fundamental Poisson brackets
{Ia , Ra } = âˆ’Î±a Ia + Î²a Sa Ia + Ï•a,2 (Sa , Ia ),
{Sa , Ra } = âˆ’Î²a Sa Ia + Ï•a,1 (Sa , Ia ),

(42)

{Sa , Ia } = 0,
{Ra , Rb } = âˆ’Ï„ab (Sa , Ia , Sb , Ib ),

for a, b âˆˆ {1, . . . , N } and b 6= a, while the remaining Poisson brackets vanish. The Hamiltonian function
H=

N
X

Hk (Sk , Ik , Rk ) =

k=1

N
X

(Sk + Ik + Rk ) ,

(43)

k=1

defines a dynamical system with N interacting populations P1 , . . . , PN , each of them evolving according to
the dynamics of a generalized SIR model (17). The generalized SIR dynamics for each population can be
arbitrary and, in particular, different for each population. Each pair of populations Pa and Pb interact by
means of the transference of recovered individuals from Ra to Rb given by Ï„ab (Sa , Ia , Sb , Ib ).
Proof. Hamiltonâ€™s equations are computed from the Hamiltonian function and the Poisson brackets:
N
X

SÌ‡a = {Sa , H} =


 {S
(
{S
a , Sk } + 
a , Ik } + {Sa , Rk }) = {Sa , Ra } = âˆ’Î²a Sa Ia + Ï•a,1 (Sa , Ia ),

k=1

IË™a = {Ia , H} =

N
X



 {I
(
{I
a , Sk } + 
a , Ik } + {Ia , Rk }) = {Ia , Ra } = Î²a Sa Ia âˆ’ Î±a Ia + Ï•a,2 (Sa , Ia ),

k=1

RÌ‡a = {Ra , H} =

N
X

({Ra , Sk } + {Ra , Ik } + {Ra , Rk }) = {Ra , Sa } + {Ra , Ia } +

k=1

N
X

(44)
{Ra , Rk }

k=1

= Î±a Ia âˆ’ Ï•a,1 (Sa , Ia ) âˆ’ Ï•a,2 (Sa , Ia ) âˆ’

N
X

Ï„ak (Sa , Ia , Sk , Ik ).

k6=a

Therefore, the dynamics of each population Pa is that of a generalized SIR model, with arbitrary Î±a , Î²a ,
Ï•a,1 (Sa , Ia ) and Ï•a,2 (Sa , Ia ) for each of them. Moreover, the population Pa interact with the population Pb
by means of the transfer function Ï„ab (Sa , Ia , Sb , Ib ) between Ra and Rb .
The proof that (42) indeed defines a Poisson algebra is a direct consequence of the fact that {f1 , f2 } âŠ‚
C âˆž (S1 , I1 , . . . , SN , IN ) for any smooth functions f1 , f2 , and C âˆž (S1 , I1 , . . . , SN , IN ) is a Poisson commutative
subalgebra.
Note that the total population for this system is indeed kept constant under the chosen interactions,
since
ï£«
ï£¶
N
N
X
X
ï£­âˆ’
SÌ‡ + IË™ + RÌ‡ =
Ï„ak (Sa , Ia , Sk , Ik )ï£¸ = 0,
(45)
a=1

k6=a

12

where we have used the skew-symmetry of the set of functions Ï„ab (Sa , Ia , Sb , Ib ) under the exchange a â†” b.
For example, taking N = 3 in the previous Proposition we obtain the system represented by the following
diagram
S2

S3
Ï•2,1 (S2 , I2 )

Î²2 S2 I2

Ï•3,1 (S3 , I3 )
Î²3 S3 I3

Ï„32 (S3 , I3 , S2 , I2 )

Ï•2,2 (S2 , I2 )

R2

Ï•3,2 (S3 , I3 )

R3

I2

I3
Î±2 I2

Î±3 I3

Ï„21 (S2 , I2 , S1 , I1 )

Ï„13 (S1 , I1 , S3 , I3 )
R1

Ï•1,1 (S1 , I1 )

Ï•1,2 (S1 , I1 )

Î±1 I1

S1

I1
Î²1 S1 I1

An example of the dynamics for this kind of interacting systems is presented in Figure 9.

5

N interacting compartmental models

The previous Section presents the case of N interacting generalized SIR systems. We recall that in Section 3
we have proved that any compartmental model with constant population can be also written as a Hamiltonian
system in a similar manner. Therefore, it seems natural to wonder whether we can define interacting
Hamiltonian systems based on more general epidemiological models. This is indeed the case, if the dynamical
system defining the dynamics of each population depends only on M âˆ’ 1 out of the M compartments, in the
form described in the following
Proposition 4. Consider a system of M Ã— N ODEs given by
âˆ’1
xÌ‡Âµa = faÂµ (x1a , . . . , xM
),
a

xÌ‡M
a =âˆ’

M
âˆ’1
X
Âµ=1

âˆ€Âµ âˆˆ {1, . . . , M âˆ’ 1},

âˆ’1
faÂµ (x1a , . . . , xM
)âˆ’
a

N
X

a âˆˆ {1, . . . , N }

âˆ’1
âˆ’1
Ï„ab (x1a , . . . , xM
, x1b , . . . , xM
),
a
b

âˆ€a âˆˆ {1, . . . , N },

b 6= a.

(46)

b=1

This system is Hamiltonian with respect to the Poisson structure
{xÂµa , xÎ½a } = 0,
Âµ 1
M âˆ’1
{xÂµa , xM
),
a } = fa (xa , . . . , xa
M
{xM
a , xb }

=

âˆ’1
âˆ’1
âˆ’Ï„ab (x1a , . . . , xM
, x1b , . . . , xM
),
a
b

13

(47)

S(t)

I(t)

R(t)

1.2
1.0

0.8

0.8
0.6

0.6
0.4

0.4
0.2

0.2

5

10

15

20

25

t

30

5

10

15

20

25

30

5

10

15

20

25

30

1.2
2.5

1.0

0.8

2.0

0.6

1.5

0.4

1.0

0.2

0.5

5

10

15

20

25

30

Figure 9: Dynamics of an interacting system with 3 populations, with interaction function Ï„ab = Îº(Sa +
Sb + Ia âˆ’ Ib ). Top-left: First population. Top-right: Second population. Bottom-left: Third population.
Bottom-right: Total population. (Î²a = 1, Î±a = 0.1, Îº = 0.1, S1 (0) = 0.8, I1 (0) = 0.1, R1 (0) = 0.1, S2 (0) =
0.7, I2 (0) = 0.3, R2 (0) = 0, S3 (0) = 0.5, I3 (0) = 0.1, R3 (0) = 0.4).
and the Hamiltonian function
H=

M
N X
X

xÂµa .

(48)

a=1 Âµ=1

Proof. Hamiltonâ€™s equations read
xÌ‡Âµa = {xÂµa , H} =

N X
M
X

{xÂµa , xÎ½b } =

b=1 Î½=1
M
xÌ‡M
a = {xa , H} =

N X
M
X

N X
M
X

âˆ’1
âˆ’1
Î´ab Î´ Î½M faÂµ (x1a , . . . , xM
) = faÂµ (x1a , . . . , xM
),
a
a

Âµ 6= M,

b=1 Î½=1
Î½
{xM
a , xb }

b=1 Î½=1

=

N X
M
X

âˆ’1
âˆ’1
âˆ’1
âˆ’Î´ab faÎ½ (x1a , . . . , xM
) âˆ’ Î´ M Î½ Ï„ab (x1a , . . . , xM
, x1b , . . . , xM
)
a
a
b



b=1 Î½=1

=âˆ’

M
âˆ’1
X
Î½=1

âˆ’1
faÎ½ (x1a , . . . , xM
)âˆ’
a

N
X

âˆ’1
âˆ’1
Ï„ab (x1a , . . . , xM
, x1b , . . . , xM
),
a
b

b=1

(49)
âˆ’1
which coincides with (46). The fact that {x1a , . . . , xM
} are Abelian Poisson subalgebras for all a âˆˆ
a
{1, . . . , N } implies that all the Jacobi identities are trivially satisfied, since the only non-trivial Poisson
brackets are contained in some product of this commutative subalgebras, and therefore {{g, g 0 }, g 00 } = 0 for
any functions g, g 0 , g 00 .

Note that we have assumed that the functions defining the dynamical system do not depend of xM .
This is similar to the assumption in Proposition 2, but there we argued that the system is the most general
14

for models with constant population, since we can restrict the dynamics to Hâˆ’1 (1) and we could write
xM = 1 âˆ’ x1 âˆ’ . . . âˆ’ xM âˆ’1 . This is no longer true for interacting systems, since the population of each Pa is
not conserved. However, note that the total population for the complete system is indeed conserved, since
N X
M
X
a=1 Âµ=1

xÌ‡Âµa

=

N X
N
X

âˆ’1
âˆ’1
Ï„ab (x1a , . . . , xM
, x1b , . . . , xM
) = 0,
a
b

(50)

a=1 b=1

âˆ’1
âˆ’1
due to the skew-symmetry of Ï„ab (x1a , . . . , xM
, x1b , . . . , xM
) under the exchange a â†” b.
a
b

6

Bi-Hamiltonian structure of epidemic models

As it was mentioned in the Introduction, the original SIR system is bi-Hamiltonian [23]. In fact, some
specific generalizations of this system were proved to be bi-Hamiltonian in [26]. In this Section we show that
the systems given in Examples 2-3 are bi-Hamiltonian. Moreover, by coupling N of those bi-Hamiltonian
systems we obtain different families of 3N -dimensional bi-Hamiltonian systems.

6.1

Endemic SIRS

Proposition 5. The system given in Example 2, with Î± and Î² constants, is bi-Hamiltonian with respect to
the following two compatible Poisson structures and Hamiltonian functions:
ï£±
ï£²Hamiltonian: H1 = S + I + R,
(51)
ï£³Poisson structure: {S, I} = 0, {S, R} = âˆ’Î²S I + Âµ I, {I, R} = Î² S I âˆ’ (Î± + Âµ) I.
1
1
1

ï£±
ï£²Hamiltonian: H2 = âˆ’ R +

Î±
Î²


log(Î²S âˆ’ Âµ) ,
(52)

ï£³
Poisson structure: {S, I}2 = âˆ’Î² S I + Âµ I,

{S, R}2 = Î²S I âˆ’ Âµ I,

{I, R}2 = âˆ’Î² S I + Âµ I.

Proof. The dynamical system (20) is obtained as
SÌ‡ = {S, H1 }1 = {S, H2 }2 = âˆ’Î²SI + Âµ I,
IË™ = {I, H1 }1 = {I, H2 }2 = Î²SI âˆ’ (Î± + Âµ)I,

(53)

RÌ‡ = {R, H1 }1 = {R, H2 }2 = Î±I.
Also it is easy to check that {f, H1 }2 = 0, so H1 is a Casimir function for {Â·, Â·}2 . Obviously {Â·, Â·}1 is a Poisson
structure because it is a particular case of (15). The Jacobi identity for the brackets {Â·, Â·}2 is fulfilled
Jac2 (S, I, R) = {{S, I}2 , R}2 + {{R, S}2 , I}2 + {{I, R}2 , S}2 = {âˆ’Î² S I + Âµ I, H1 }2 = 0,

(54)

since H1 is a Casimir function for {Â·, Â·}2 . Finally, the two Poisson structures are compatible since the brackets
{S, I} = {S, I}1 + {S, I}2 = âˆ’Î²SI + Âµ I,
{S, R} = {S, R}1 + {S, R}2 = 0,

(55)

{I, R} = {I, R}1 + {I, R}2 = âˆ’Î±I,
again define a Poisson structure with vanishing Jacobi identity. In fact, this is the generalization to Âµ 6= 0
of the Poisson structure considered in [23].
Several bi-Hamiltonian endemic SIRS systems as the ones considered in the previous Proposition can be
coupled to each other by keeping a Hamiltonian description similar to the one given by Proposition 3. It is
therefore natural to wonder whether this description maintains the bi-Hamiltonian structure for the coupled
system. This is indeed the case, as we prove in the following
15

Proposition 6. The particular case of the Hamiltonian system defined in Proposition 3, with Î±a and Î²a
constants, Ï•a,1 = Âµa Ia , Ï•a,2 = âˆ’Âµa Ia and Ï„ab (Sa , Ia , Sb , Ib ) = Ï„ab , is bi-Hamiltonian, with the second
Poisson structure given by the non-zero fundamental Poisson brackets
{Sa , Ia }2 = âˆ’Î²a Sa Ia + Âµa Ia ,
{Sa , Ra }2 = Î²a Sa Ia âˆ’ Âµa Ia ,

(56)

{Ia , Ra }2 = âˆ’Î²a Sa Ia + Âµa Ia ,
{Ra , Rb }2 = Ï„ab ,
and the Hamiltonian being
H2 = âˆ’

N 
X

Rk +

k=1


Î±k
log(Î²k Sk âˆ’ Âµk ) .
Î²k

(57)

Proof. The system defined by the second Hamiltonian structure is given by
SÌ‡a = {Sa , H2 }2 = âˆ’Î²a Sa Ia + Âµa Ia ,
IË™a = {Ia , H2 }2 = Î²a Sa Ia âˆ’ (Î±a + Âµa )Ia ,
RÌ‡a = {Ra , H2 }2 = Î±a Ia âˆ’

N
X

(58)

Ï„ak ,

k6=a

which coincides with (44) setting Ï•a,1 = Âµa Ia , Ï•a,2 = âˆ’Âµa Ia and Ï„ab (Sa , Ia , Sb , Ib ) = Ï„ab .
The proof that {Â·, Â·}2 is a Poisson structure is straightforward since the N Jacobi identities involving
variables from a single population are satisfied by Proposition 5, while the rest of the Jacobi identities are
fulfilled just by noting that {{X, Y }, Z} = 0 whenever X, Y, Z do not belong to the same population, due
to the fact that the only non-vanishing bracket among different populations is a constant function.
Finally, the compatibility between {Â·, Â·}1 and {Â·, Â·}2 is proven by computing the Jacobi identities for
{Sa , Ia } = {Sa , Ia }1 + {Sa , Ia }2 = âˆ’Î²a Sa Ia + Âµa Ia ,
{Sa , Ra } = {Sa , Ra }1 + {Sa , Ra }2 = 0,

(59)

{Ia , Ra } = {Ia , Ra }1 + {Ia , Ra }2 = âˆ’Î±a Ia ,
which was already proven in Proposition 5.

6.2

A SIR model with a vaccination function

Similar results to those of Propositions 5 and 6 can be obtained for the system from Example 3 a) and b),
corresponding to a SIR system in which the susceptible population is vaccinated with a rate proportional to
I and S, respectively. In particular, these systems are bi-Hamiltonian, and N such systems can be coupled
by preserving a bi-Hamiltonian structure for the corresponding 3N -dimensional system. As the proofs of
these results are similar to those of Propositions 5 and 6 we omit them for the sake of brevity.
Proposition 7. The system given in Example 3 a), with Î± and Î² constants and setting v(S, I) = vI, is
bi-Hamiltonian with respect to the following two compatible Poisson structures and Hamiltonian functions:
ï£±
ï£²Hamiltonian: H1 = S + I + R,
(60)
ï£³Poisson structure: {S, I} = 0, {S, R} = âˆ’Î²S I âˆ’ v I, {I, R} = Î² S I âˆ’ Î± I.
1
1
1

ï£±
ï£²Hamiltonian: H2 = âˆ’ R +
ï£³

(Î±+v)
Î²


log(Î²S + v) ,

Poisson structure: {S, I}2 = âˆ’Î² S I âˆ’ v I,

(61)
{S, R}2 = Î²S I + v I,

16

{I, R}2 = âˆ’Î² S I âˆ’ v I.

Proposition 8. The particular case of the Hamiltonian system defined in Proposition 3, with Î±a and Î²a
constants, Ï•a,1 = âˆ’va Ia , Ï•a,2 = 0 and Ï„ab (Sa , Ia , Sb , Ib ) = Ï„ab , is bi-Hamiltonian, with the second Poisson
structure defined by the non-zero fundamental Poisson brackets
{Sa , Ia }2 = âˆ’Î²a Sa Ia âˆ’ va Ia ,
{Sa , Ra }2 = Î²a Sa Ia + va Ia ,
{Ia , Ra }2 = âˆ’Î² Sa Ia âˆ’ va Ia ,

(62)

{Ra , Rb }2 = Ï„ab ,
and the Hamiltonian


N 
X
(Î±k + vk )
H2 = âˆ’
Rk +
log(Î²k Sk + vk ) .
Î²k

(63)

k=1

Proposition 9. The system given in Example 3 b), with Î± and Î² constants, setting v(S, I) = vS, is biHamiltonian with respect to the following two compatible Poisson structures and Hamiltonian functions:
ï£±
ï£²Hamiltonian: H1 = S + I + R,
(64)
ï£³Poisson structure: {S, I} = 0, {S, R} = âˆ’Î²S I âˆ’ v S, {I, R} = Î² S I âˆ’ Î± I.
1
1
1




ï£±
v
1
Î± âˆ’v
ï£²Hamiltonian: H2 = âˆ’ R + Î±
) ,
Î² log S âˆ’ Î² log I = âˆ’ R + Î² log(S I
(65)
ï£³
Poisson structure: {S, I}2 = âˆ’Î² S I, {S, R}2 = Î²S I, {I, R}2 = âˆ’Î² S I.
Proposition 10. The particular case of the Hamiltonian system defined in Proposition 3, with Î±a and Î²a
constants, Ï•a,1 = âˆ’va Sa , Ï•a,2 = 0 and Ï„ab (Sa , Ia , Sb , Ib ) = Ï„ab , is bi-Hamiltonian, with the second Poisson
structure defined by the non-zero fundamental Poisson brackets
{Sa , Ia }2 = âˆ’Î²a Sa Ia ,
{Sa , Ra }2 = Î²a Sa Ia ,
{Ia , Ra }2 = âˆ’Î² Sa Ia ,

(66)

{Ra , Rb }2 = Ï„ab ,
and the Hamiltonian
H2 = âˆ’


N 
X
Î±k
vk
Rk +
log Sk âˆ’
log Ik .
Î²k
Î²k

(67)

k=1

Note that in Propositions 5, 7 and 9 the second Hamiltonian H2 is not a Casimir for the first Poisson
algebra {Â·, Â·}1 . However, in each case the Casimir of this first Poisson algebra is obtained from H2 by
substituting R â†’ S + I, so these two functions indeed coincide on the hypersurface of constant population.
Obviously, this Casimir could have been taken equivalently as the second Hamiltonian function. However,
this is no longer true for the interacting case.

7

Exact analytical solutions from Casimir functions

Although the exact integrability of different epidemiological models has attracted some attention (see for
instance [27, 28]), only recently the exact analytical solution of the original SIR system has been found
[11, 29]. In this Section we show that the Hamiltonian structure is useful in order to find exact analytical
solutions for the systems from Examples 2 â€“ 3, which are generalizations of the original SIR system. In
particular, we use the fact that any 3-dimensional Poisson manifold has one Casimir function in order to
reduce the 3-dimensional dymensional system to a 1-dimensional problem, which can be always integrated
by quadratures.
For all the following systems, we solve the differential equations for the initial conditions S(0) = S0 ,
I(0) = 1 âˆ’ S0 and R(0) = 0. This is equivalent to consider the dynamics restricted to the symplectic leaf
given by the value C = 0 of the Casimir function.
17

Example 5 (Analytical solution of the SIRS endemic model). Recall from Proposition 5 that a Casimir
function for the system of Example 2 is given by



Î±
Î²S âˆ’ Âµ
C = âˆ’ R + log
,
(68)
Î²
Î²S0 âˆ’ Âµ
where we have fixed the level set C = 0 onto which the dynamics takes place by means of the abovementioned
initial conditions. From here we have that


Î²S âˆ’ Âµ
Î±
.
(69)
R = âˆ’ log
Î²
Î²S0 âˆ’ Âµ
The conservation of the Hamiltonian (the total population is constant under the dynamics) allows us to
write


Î²S âˆ’ Âµ
Î±
.
(70)
I = 1 âˆ’ S âˆ’ R = 1 âˆ’ S + log
Î²
Î²S0 âˆ’ Âµ
Therefore, the first equation from (20) reads




Âµ
Î²S âˆ’ Âµ
SÌ‡ = S âˆ’
âˆ’Î² + Î²S âˆ’ Î± log
,
Î²
Î²S0 âˆ’ Âµ
and therefore
Z

S

S0



(71)

dÎ¶


 = t.
Î²Î¶âˆ’Âµ
Î¶âˆ’
âˆ’Î² + Î²Î¶ âˆ’ Î± log Î²S
0 âˆ’Âµ

(72)

Âµ
Î²

Setting
ï£«
Z
ï£­
Î£(t) =

ï£¶âˆ’1

S

S0

dÎ¶


Î¶âˆ’

Âµ
Î²



 ï£¸
Î²Î¶âˆ’Âµ
âˆ’Î² + Î²Î¶ âˆ’ Î± log Î²S
0 âˆ’Âµ

(t)

we have that the solution of the SIRS endemic system (20) is given by
ï£±
S(t) = Î£(t)
ï£´
ï£´


ï£²
Î²Î£(t)âˆ’Âµ
I(t) = 1 âˆ’ Î£(t) + Î±
log
.
 Î²S0 âˆ’Âµ
 Î²
ï£´
ï£´
Î²Î£(t)âˆ’Âµ
Î±
ï£³ R(t) = âˆ’ log

(73)

(74)

Î²S0 âˆ’Âµ

Î²

â™¦
Example 6 (Analytical solution of the SIR model with vaccination rate âˆ I). The procedure to find an
exact solution to the system from Example 3 a) is similar. Recall from Proposition 7 that the Casimir reads



(Î± + v)
Î²S + v
C =âˆ’ R+
log
,
(75)
Î²
Î²S0 + v
so


Î²S + v
(Î± + v)
log
.
(76)
R=âˆ’
Î²
Î²S0 + v
The very same integration procedure shows that the solution of the system from Example 3 a) reads
ï£±
ï£´
ï£´ S(t) = Î£(t)


ï£²
Î²Î£(t)+v
I(t) = 1 âˆ’ Î£(t) + (Î±+v)
log
,
Î²
 Î²S0 +v
ï£´
ï£´
ï£³ R(t) = âˆ’ (Î±+v) log Î²Î£(t)+v
Î²

(77)

Î²S0 +v

where now Î£(t) is defined by
ï£«
Z

ï£¶âˆ’1

S

Î£(t) = ï£­
S0

dÎ¶

(Î¶ + Î²v ) âˆ’Î² + Î²Î¶ âˆ’ (Î± + v) log

Î²Î¶+v
Î²S0 +v

ï£¸

(t).

(78)
â™¦

18

Example 7 (Analytical solution of the SIR model with vaccination rate âˆ S). The system from Example
3 b) presents a further complication, and we can only obtain the analytical solution in terms of two inverse
functions. From Proposition 9 we have that the Casimir, with the appropriate initial conditions, reads
C =R+

Î±
S
v
1âˆ’Sâˆ’R
log
âˆ’ log
.
Î²
S0
Î²
I0

If we denote the solution of the equation C = 0 by R(t) = Ï(S(t)), we have that
!âˆ’1
Z S
dÎ¶
(t),
Î£(t) =
S0 âˆ’Î²Î¶(1 âˆ’ Î¶ âˆ’ Ï(Î¶)) âˆ’ vÎ¶
and the solution of the system from Example 3 b) is
ï£±
ï£´
ï£² S(t) = Î£(t)
I(t) = 1 âˆ’ Î£(t) âˆ’ Ï(t) .
ï£´
ï£³
R(t) = Ï(Î£(t))

(79)

(80)

(81)

â™¦
Note that in all these examples the limit Âµ â†’ 0 or v â†’ 0 is well defined and leads to the analytic solution
to the original SIR system given in [11, 29]. This is a general fact for the generalized SIR system (13),
since it can be thought of as an integrable deformation of the original SIR model (1), and therefore it can
be expressed as a Hamiltonian system for a Poisson structure which is a deformation of (8). In turn, the
corresponding Casimir functions are always deformations of (10) in terms of the parameters Âµ and v.

8

Concluding remarks

Compartmental models are widely used to model the dynamics of epidemics. In this work we have proved
that any compartmental model with constant population is a Hamiltonian system in which the total population plays the role of the Hamiltonian function. This general result implies that all the analytical and
geometrical tools connected with Hamiltonian systems can be applied in order to tackle epidemiological
dynamics. Moreover, we have also showed that a large number of models with non-constant population can
be transformed into effective models with constant population, so all the previous results hold also for them.
We have also found that compartmental models can be coupled, by keeping a Hamiltonian structure,
in order to define interacting systems among different populations whose individuals can be interchanged.
Moreover, three models which are generalizations of the original Kermack and McKendrick model have been
proven to be bi-Hamiltonian, and their interacting analogues are shown to give rise to large families of
bi-Hamiltonian systems.
As a direct application of the Hamiltonian structures here presented, we have obtained the exact analytic
solutions for these three bihamiltonian models by making use of Casimir function of each corresponding
Poisson algebra. This method indeed leads to the solutions found in [29] for certain limiting cases, which
are obtained provided the appropriate parameters vanish. Such Poisson-algebraic approach to analytical
solutions for epidemiological models is indeed worth to be explored for other systems here presented, and
becomes specially useful when the dimension and the number of parameters of the model increase, since
analytic solutions have the potential to greatly simplify the analysis of the dynamical role played by each
parameter. We stress that this approach strongly relies upon the characterization and explicit computation
of the Casimir functions of the Poisson structure associated to each model, a problem which is currently
under investigation.
Moreover, the Hamiltonian nature of compartmental systems opens the path to the use of symplectic
integrators [30, 31] as a natural and efficient tool in order to face the integration problem for these systems.
Therefore, the use of the latter as benchmarks in order to compare the accurateness and efficiency of ordinary
integrators versus symplectic integrators is also worth to be investigated.
19

Finally, the Hamiltonian structure here presented allows us to apply the well-known machinery of integrable deformations of Hamiltonian systems in order to define new compartmental models as integrable
deformations of the dynamical systems here studied, including coupled ones. In particular, deformations
based on Poisson coalgebras [32] provide a suitable arena in order to face this problem by following the same
techniques that have been previously used, for instance, in order to get integrable deformations and coupled
versions of Lotka-Volterra, Lorenz, RoÌˆssler and Euler top dynamical systems [33, 34, 35]. Work on this line
is in progress and will be presented elsewhere.

Appendix. Hamiltonian and bi-Hamiltonian systems
Let M be a smooth manifold and let us denote its algebra of smooth functions by C âˆž (M ). A Poisson structure
V2
V2
V2
on M is given by a bivector field Ï€ âˆˆ Î“( T M ) such that [Ï€, Ï€] = 0, where [Â·, Â·] : Î“( T M ) Ã— Î“( T M ) â†’
V3
Î“( T M ) is the Schouten-Nijenjuis bracket. A Poisson manifold (M, Ï€) is a manifold endowed with a
Poisson structure. The Poisson bivector defines a Lie algebra structure on C âˆž (M ) by means of the Poisson
bracket
{Â·, Â·} : C âˆž (M ) Ã— C âˆž (M ) â†’ C âˆž (M ),
(82)
defined by {f1 , f2 } = (df1 âŠ— df2 )(Ï€) for any f1 , f2 âˆˆ C âˆž (M ).
A Poisson structure on M induces a vector bundle morphism Ï€Ìƒ ] : T âˆ— M â†’ T M from the cotangent bundle
âˆ—
]
M â†’ Tm M is not in general an isomorphism,
: Tm
to the tangent bundle of M . The linear morphism Ï€Ìƒm
since the Poisson structure can be degenerate. We call the rank of the Poisson structure Ï€ at m âˆˆ M to
]
, which is always even due to the skew-symmetry of Ï€. This vector bundle
the rank of the linear map Ï€Ìƒm
morphism defines a morphism between the respective spaces of sections of such bundles Î“(T âˆ— M ) = â„¦1 (M )
and Î“(T M ) = X(M ), which we denote by Ï€ ] : â„¦1 (M ) â†’ X(M ). This morphism induces a map from
functions to vector fields, given by
Ï€ ] â—¦ d : C âˆž (M ) â†’ X(M )
f â†’ Ï€ ] (df ) = Xf

(83)

for any f âˆˆ C âˆž (M ). The vector field Xf is called the Hamiltonian vector field associated to f . We say that
C âˆˆ C âˆž (M ) is a Casimir function if its exterior derivative belongs to the kernel of Ï€ ] , i.e. Ï€ ] (dC) = 0. In
terms of the Poisson bracket we have that {C, f } = 0 for all f âˆˆ C âˆž (M ).
Given a Poisson manifold (M, Ï€) and a smooth function H : M â†’ R called the Hamiltonian, the
dynamical evolution of any any function is given by the Hamiltonâ€™s equations
fË™ = hÏ€ ] (dH), f i.

(84)

A Poisson manifold together with a Hamiltonian function is called a Hamiltonian system. In this way, it
is clear that the evolution of a Hamiltonian system is given geometrically by the integral curves of the
Hamiltonian vector field Xf . In terms of the Poisson bracket, Hamiltonâ€™s equations read
fË™ = {f, H}.

(85)

Given two Poisson structures Ï€1 and Ï€2 on the same manifold M we say that they are compatible if
Ï€ = Ï€1 + Ï€2 is a Poisson structure. In fact, if there are two compatible Poisson structures on M we can find
an infinite number of them, since
Ï€ = (1 âˆ’ Î»)Ï€1 + Î»Ï€2
(86)
is a Poisson structure. This family of Poisson structures is called the Poisson pencil.
Definition 1. Let Ï€1 and Ï€2 be two compatible Poisson structures on M . A Hamiltonian system is called
a bi-Hamiltonian system if there exist two Hamiltonian functions H1 and H2 such that their Hamiltonian
vector fields coincide.

20

Essentially, bi-Hamiltonian systems are Hamiltonian systems whose (unique) dynamics can be endowed
with two different Hamiltonian structures. We have that
XH1 = Ï€1] (dH1 ) = Ï€2] (dH2 ) = XH2

(87)

Therefore, Hamiltonâ€™s equations read
fË™ = hÏ€1] (dH1 ), f i = hÏ€2] (dH2 ), f i,

(88)

fË™ = {f, H1 }1 = {f, H2 }2 .

(89)

or equivalently,

Among Hamiltonian systems, those that posses a sufficient number of conserved quantities are particularly
interesting, since these quantities can be used to find the solutions of the system.
Definition 2. Let (M, Ï€) be a Poisson manifold such that rank Ï€ = 2n â‰¤ dim M on a dense open subset
D of M . A Hamiltonian system on M is completely integrable (in the Liouville sense) if there exist n âˆ’ 1
functions f1 , . . . , fnâˆ’1 âˆˆ C âˆž (M ) such that the set {H, f1 , . . . , fnâˆ’1 } is functionally independent, i.e.
dH âˆ§ df1 âˆ§ . . . âˆ§ dfnâˆ’1 6= 0

(90)

on D, and Poisson commuting, i.e.
{H, fa } = 0,

{fa , fb } = 0

(91)

for all a, b âˆˆ {1, . . . , n âˆ’ 1}.
Furthermore, the Hamiltonian system is called maximally superintegrable if, additionally, there exist
g1 , . . . , gnâˆ’1 âˆˆ C âˆž (M ) such that
dH âˆ§ df1 âˆ§ . . . âˆ§ dfnâˆ’1 âˆ§ dg1 âˆ§ . . . âˆ§ dgnâˆ’1 6= 0,

(92)

{H, ga } = 0.

(93)

and

Functions that Poisson commute with the Hamiltonian are called additional first integrals. Therefore, a
system is completely integrable if it admits n âˆ’ 1 functionally independent additional first integrals, while
it is maximally superintegrable if it admits 2n âˆ’ 2. For completely integrable systems, Liouville-Arnold
theorem guarantees that the solution can be found by quadratures if the canonical transformation to actionangle coordinates is known. Maximally superintegrable systems are particular cases of completely integrable
systems for which the dynamics is strictly unidimensional.
For Hamiltonian systems defined on an arbitrary Poisson manifold (M, Ï€) the notions of complete and
maximal superintegrability are intimately related to the Casimir structure of the Poisson manifold, which is
a geometrical property of (M, Ï€) independent of the particular Hamiltonian system under consideration. In
particular, any Casimir function is a first integral for any Hamiltonian system defined on (M, Ï€).

Acknowledgements
This work has been partially supported by Agencia Estatal de InvestigacioÌn (Spain) under grants MTM201679639-P (AEI/FEDER, UE) and PID2019-106802GB-I00 / AEI / 10.13039/501100011033, and by Junta de
Castilla y LeoÌn (Spain) under grants BU229P18 and BU091G19.

References
[1] B. F. Maier and D. Brockmann. Effective containment explains subexponential growth in recent confirmed
COVID-19 cases in China. Science (80-. )., 746(May):eabb4557, 2020. doi:10.1126/science.abb4557.

21

[2] D. Fanelli and F. Piazza. Analysis and forecast of COVID-19 spreading in China, Italy and France. Chaos,
Solitons and Fractals, 134:109761, 2020. arXiv:2003.06031, doi:10.1016/j.chaos.2020.109761.
[3] G. Barmparis and G. Tsironis. Estimating the infection horizon of COVID-19 in eight countries with a datadriven approach. Chaos, Solitons & Fractals, 135:109842, 2020. doi:10.1016/j.chaos.2020.109842.
[4] F. NdaÄ±Ìˆrou, I. Area, J. J. Nieto, and D. F. Torres. Mathematical Modeling of COVID-19 Transmission Dynamics
with a Case Study of Wuhan. Chaos, Solitons & Fractals, 135:109846, 2020. doi:10.1016/j.chaos.2020.109846.
[5] C. Yang and J. Wang. A mathematical model for the novel coronavirus epidemic in Wuhan, China. Math.
Biosci. Eng., 17(3):2708â€“2724, 2020. doi:10.3934/mbe.2020148.
[6] M. KochanÌczyk, F. Grabowski, and T. Lipniacki. Dynamics of COVID-19 pandemic at constant and timedependent contact rates. Math. Model. Nat. Phenom., 15:28, 2020. doi:10.1051/mmnp/2020011.
[7] G. Chowell, L. Sattenspiel, S. Bansal, and C. Viboud. Mathematical models to characterize early epidemic
growth: A review. Phys. Life Rev., 18:66â€“97, 2016. doi:10.1016/j.plrev.2016.07.005.
[8] K. Prem, Y. Liu, T. W. Russell, A. J. Kucharski, R. M. Eggo, N. Davies, S. Flasche, S. Clifford, C. A. Pearson,
J. D. Munday, S. Abbott, H. Gibbs, A. Rosello, B. J. Quilty, T. Jombart, F. Sun, C. Diamond, A. Gimma,
K. van Zandvoort, S. Funk, C. I. Jarvis, W. J. Edmunds, N. I. Bosse, J. Hellewell, M. Jit, and P. Klepac. The
effect of control strategies to reduce social mixing on outcomes of the COVID-19 epidemic in Wuhan, China: a
modelling study. Lancet Public Heal., pages 261â€“270, 2020. doi:10.1016/S2468-2667(20)30073-6.
[9] D. Bernoulli. Essai dâ€™une nouvelle analyse de la mortaliteÌ causeÌe par la petite veÌrole, et des avantages de
lâ€™inoculation pour la preÌvenir. Hist. lâ€™Acad., Roy. Sci., pages 1â€“45, 1760.
[10] A. Korobeinikov and P. K. Maini. Non-linear incidence and stability of infectious disease models. Math. Med.
Biol., 22(2):113â€“128, 2005. doi:10.1093/imammb/dqi001.
[11] J. C. Miller. A Note on the Derivation of Epidemic Final Sizes. Bull. Math. Biol., 74(9):2125â€“2141, 2012.
doi:10.1007/s11538-012-9749-6.
[12] H. W. Hethcote. Asymptotic behavior in a deterministic epidemic model. Bull. Math. Biol., 35(5-6):607â€“614,
1973. doi:10.1007/BF02458365.
[13] M. Y. Li, J. R. Graef, L. Wang, and J. Karsai. Global dynamics of a SEIR model with varying total population
size. Math. Biosci., 160(2):191â€“213, 1999. doi:10.1016/S0025-5564(99)00030-9.
[14] H. W. Hethcote.
The Mathematics of Infectious Diseases.
Soc. Ind. Appl. Math., 42(4):599â€“
653, 2007.
http://www.jstor.org/discover/10.2307/2653135?uid=3739736{&}uid=2{&}uid=4{&}uid=
3739256{&}sid=21104838342357.
[15] H. Boujakjian. Modeling the Spread of Ebola with SEIR and Optimal Control. SIAM Undergrad. Res. Online,
9:1â€“12, 2016. doi:10.1137/16s015061.
[16] J. C. Miller. Mathematical models of SIR disease spread with combined non-sexual and sexual transmission
routes. Infect. Dis. Model., 2(1):35â€“55, 2017. arXiv:1609.08108, doi:10.1016/j.idm.2016.12.003.
[17] W. O. Kermack and A. G. McKendrick. A contribution to the mathematical theory of epidemics. Proc. R. Soc.
London. Ser. A, Contain. Pap. a Math. Phys. Character, 115(772):700â€“721, 1927. doi:10.1098/rspa.1927.0118.
[18] E. B. Postnikov. Estimation of COVID-19 dynamics â€˜on a back-of-envelopeâ€™: Does the simplest SIR model
provide quantitative parameters and predictions? Chaos, Solitons and Fractals, 135, 2020. doi:10.1016/j.
chaos.2020.109841.
[19] V. Capasso and G. Serio. A generalization of the Kermack-McKendrick deterministic epidemic model. Math.
Biosci., 42(1-2):43â€“61, 1978. doi:10.1016/0025-5564(78)90006-8.
[20] F. Brauer. Models for the spread of universally fatal diseases. J. Math. Biol., 28(4):451â€“462, 1990. doi:
10.1007/BF00178328.
[21] F. Brauer. The Kermack-McKendrick epidemic model revisited. Math. Biosci., 198(2):119â€“131, 2005. doi:
10.1016/j.mbs.2005.07.006.

22

[22] F. Brauer and C. Castillo-Chavez. Mathematical Models in Population Biology and Epidemiology, volume 40 of
Texts in Applied Mathematics. Springer New York, New York, NY, 2012. doi:10.1007/978-1-4614-1686-9.
[23] Y. Nutku. Bi-Hamiltonian structure of the Kermack-McKendrick model for epidemics, 1990. doi:10.1088/
0305-4470/23/21/013.
[24] M. Banerjee, A. Tokarev, and V. Volpert. Immuno-epidemiological model of two-stage epidemic growth. Math.
Model. Nat. Phenom., 15:27, 2020. arXiv:2003.14152, doi:10.1051/mmnp/2020012.
[25] B. Buonomo. Effects of information-dependent vaccination behavior on coronavirus outbreak: insights from a
SIRI model. Ric. di Mat., apr 2020. doi:10.1007/s11587-020-00506-8.
[26] H. GuÌˆmral and Y. Nutku. Poisson structure of dynamical systems with three degrees of freedom. J. Math.
Phys., 34(12):5691â€“5723, dec 1993. doi:10.1063/1.530278.
[27] M. C. Nucci and P. G. Leach. An integrable SIS model. J. Math. Anal. Appl., 290(2):506â€“518, 2004. doi:
10.1016/j.jmaa.2003.10.044.
[28] P. G. L. Leach and K. Andriopoulos. Application of Symmetry and Symmetry Analyses to Systems of First-Order
Equations Arising from Mathematical Modelling in Epidemiology. Proc. Inst. Math. NAS Ukr., 50(1):159â€“169,
2004.
[29] T. Harko, F. S. Lobo, and M. K. Mak. Exact analytical solutions of the Susceptible-Infected-Recovered (SIR)
epidemic model and of the SIR model with equal death and birth rates. Appl. Math. Comput., 236(0):184â€“194,
2014. arXiv:1403.2160, doi:10.1016/j.amc.2014.03.030.
[30] H. Yoshida. Construction of higher order symplectic integrators. Phys. Lett. A, 150(5-7):262â€“268, 1990. doi:
10.1016/0375-9601(90)90092-3.
[31] J. M. Sanz-Serna. Symplectic integrators for Hamiltonian problems: an overview. Acta Numer., 1:243â€“286, jan
1992. doi:10.1017/S0962492900002282.
[32] A. Ballesteros and O. Ragnisco. A systematic construction of completely integrable Hamiltonians from coalgebras. J. Phys. A: Math. Gen., 31(16):3791â€“3813, 1998. arXiv:solv-int/9802008, doi:10.1088/0305-4470/31/
16/009.
[33] A. Ballesteros, A. Blasco, and F. Musso. Integrable deformations of Lotka-Volterra systems. Phys. Lett. Sect.
A Gen. At. Solid State Phys., 375(38):3370â€“3374, 2011. arXiv:1106.0805, doi:10.1016/j.physleta.2011.07.
055.
[34] A. Ballesteros, A. Blasco, and F. Musso. Integrable deformations of RoÌˆssler and Lorenz systems from Poissonâ€“Lie
groups. J. Differ. Equ., 260(11):8207â€“8228, 2016. arXiv:1601.03357, doi:10.1016/j.jde.2016.02.014.
[35] A. Ballesteros, J. C. Marrero, and Z. Ravanpak. Poissonâ€“Lie groups, bi-Hamiltonian systems and integrable
deformations. J. Phys. A: Math. Theor., 50(14):145204, apr 2017. arXiv:1609.07438, doi:10.1088/1751-8121/
aa617b.

23

