rspa.royalsocietypublishing.org

Research

Estimating the effective
reproduction number for
heterogeneous models using
incidence data
D. C. P. Jorge1 , J. F. Oliveira2 , J. G. V.

Article submitted to journal

arXiv:2102.12637v1 [q-bio.PE] 25 Feb 2021

Subject Areas:
Mathematical modeling, Differential
equations, Applied mathematics
Keywords:

Miranda3 , R. F. S. Andrade2,3 and S. T. R.
Pinho3
1 Instituto de F√≠sica Te√≥rica, Universidade Estadual

Paulista - UNESP, R. Dr. Teobaldo Ferraz 271, S√£o
Paulo 01140-070, Brazil

Effective reproduction number,

2 Center of Data and Knowledge Integration for Health

Mathematical models,

(CIDACS), Instituto Gon√ßalo Moniz, Funda√ß√£o

Meta-population models , COVID-19

Oswaldo Cruz, Salvador, Bahia, Brazil
3 Instituto de F√≠sica, Universidade Federal da Bahia,

Author for correspondence:

Salvador, Bahia, Brazil

Daniel Cardoso Pereira Jorge
e-mail: danielcpjorge98@gmail.com

The effective reproduction number, R(t), is a central
point in the study of infectious diseases. It establishes
in an explicit way the extent of an epidemic spread
process in a population. The current estimation
methods for the time evolution of R(t), using
incidence data, rely on the generation interval
distribution, g(œÑ ), which is usually obtained from
empirical data or already known distributions from
the literature. However, there are systems, especially
highly heterogeneous ones, in which there is a lack of
data and an adequate methodology to obtain g(œÑ ). In
this work, we use mathematical models to bridge this
gap. We present a general methodology for obtaining
an explicit expression of the reproduction numbers
and the generation interval distributions provided
by an arbitrary compartmental model. Additionally,
we present the appropriate expressions to evaluate
those reproduction numbers using incidence data.
To highlight the relevance of such methodology, we
apply it to the spread of Covid-19 in municipalities
of the state of Rio de janeiro, Brazil. Using two metapopulation models, we estimate the reproduction
numbers and the contributions of each municipality
in the generation of cases in all others. Our results
point out the importance of mathematical modelling
to provide epidemiological meaning of the available
data.
¬© The Author(s) Published by the Royal Society. All rights reserved.

1. Introduction

2

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

The human population gets along with different microorganisms. Some of them lead to
transmitted diseases that result in epidemics, even pandemics such as SARS-Cov-2. It is very
important to define reliable measures to characterize the spread of those pathogens, both at the
beginning and in the course of epidemics.
The reproduction number R(t) indicates the number of new infections that result from a single
infected individual at any time t. When it is greater than 1, each infected individual tends to
generate more than one infected individuals resulting in the occurrence of an epidemic outbreak.
The reproduction number is usually known from its initial value, when all of the population
is susceptible, known as the basic reproduction number R0 . Due to the recovery of infected
individuals, a portion of the population becomes immune to the disease, thus, herd immunity
begins to emerge in the population. This acts as a barrier to the transmission of the disease, so
R(t) takes into account the evolution of the number of susceptible individuals in the population
and is usually referred as the effective reproduction number. It provides us with information on
how disease transmission occurs during the outbreak it is an important metric to make healthcare
managers aware of the current level of the disease propagation.
By considering heterogeneities in the homogeneous compartmental models, the reproduction
number is affected. Indeed different classes of infected individuals can lead to different
contributions for the generation of new infections. A lot of studies have taken the heterogeneity
into account when dealing with the basic reproduction number R0 [1,2], however, this is not the
same for the effective reproduction number, R(t).
To study reproduction number, the renewal equation, a Lotka-Euler type equation [3], is
usually used. This equation emerges from the mathematical models dynamics and can be derived
using infection-age models. This type of modelling comes from the study of age-structured
population growth and was first used within the scope of mathematical demography with the
aim of modeling the birth dynamics due to the offspring produced by an individual over its
lifespan. Analogously, the same methodology can be applied to the infectious diseases scenario
by modelling the generation of new infected individuals during the infection period of those
previously infected [4]. Infection-age models are the origins of the widely known SIR and SEIR
models developed by Kermack-Mckendrick [5]. Most known compartment ODE models for
infectious diseases have their infection-age identical counterparts. The advantage with respect
to the infection-age models is that they allow us to have access to the distribution of the infected
individuals during the infectious period.
The estimation of the reproduction number in the course of an outbreak usually rely on the
daily count of new cases along with the renewal equation. This approach uses the generation
interval distribution, also called the serial interval or generation time distribution, and was
popularized by [3]. Several works indicate how to obtain this distribution through empirical
data [6‚Äì9] or from other known distributions and models [3,10‚Äì13]. However, these distributions
rely on epidemiological and empirical studies and several systems are very difficult to analyse or
even do not have the required data for the envisaged evaluation. Moreover, highly heterogeneous
systems do not have a general methodology for estimating the reproduction number and its
generation interval distribution [14‚Äì17].
In this study, we use mathematical models to bridge the gap between the reported cases
and the reproduction number. Therefore, we present a methodology that derives reproduction
numbers and the generation interval distribution for an arbitrary compartment mathematical
model. With such methodology, we can investigate highly heterogeneous systems using
appropriate models and evaluate their reproduction numbers. With that in mind, apply the
method to a meta-population model to analyse the role of spatial heterogeneity in the spreading
of COVID-19 in the Brazilian territory.
Our work is separated as follow: in section 2, we introduce heterogeneity by allowing the
existence of different groups of individuals in a population that can be sorted into compartments

2. Reproduction number in a heterogeneous population
(a) A general infection-age model
In a heterogeneous population, individuals can be discernible by age-groups, spatial locations,
behaviour, different susceptibility to diseases or any other factor that may distinguish them
for one another. In this section, we consider a general heterogeneous model that separates the
individuals in m homogeneous compartments. For the purpose of evaluating the reproduction
number, we first consider a sub-set of variables encompassing the infected compartments, i.e.,
those compartments containing individuals that carry the etiologic agent in their organisms.
These compartments are denoted by x(t, œÑ ) = (x1 (t, œÑ ), ..., xn (t, œÑ )), where t and œÑ indicate,
respectively, the calendar time and the infection-age, the time elapsed since they got the infection.
Of course the condition x(t, œÑ ) = 0 for œÑ > t must be satisfied. If m = mi + m0 , where mi and
m0 indicate the number of infected and non-infected compartments in the homogeneous model,
n = mi . Therefore, x represents the number of individuals in each compartment at a specific
calendar time ‚Äút‚Äù and at infection age ‚ÄúœÑ ‚Äù. x entries can be called the infection-age distributions.
The total number of individuals in each compartment, denoted as Xi (t), can be obtained by
integrating xi (t, œÑ ) with respect of œÑ from zero to infinity, where X(t) = (X1 (t), ..., Xn (t)). For
simplicity, we will be using matrix notation in some hequations.iThe matrices and vectors will

be identified by using bold font, whereby M (y, z) = Mij (y, z) . Also, as usual, integrals and
derivatives with respect of scalar variables operate componentwise.
Drawing a parallel with Van den Driessche‚Äôs next generation method [19], we distinguish the
new infections from the other compartment flows, defining F (t) = (F(t), ..., Fn (t)) as the rate
of appearance of new infections and V(t, œÑ ) = (V1 (t, œÑ ), ..., Vn (t, œÑ )) as the rate of transfer into
compartments. Therefore, F (t) describes the flow from non-infected compartments into infected
ones and depends on X(t). On the other hand,V(t, œÑ ) is related to the flow between infected
compartments or from infected to non-infected ones and must depend on x(t, œÑ ). Thus, an usual
infection-age model can be written as:
‚àÇ
‚àÇ 
+
x(t, œÑ ) = ‚àí V(t, œÑ ),
‚àÇt
‚àÇœÑ
x(t, œÑ = 0) =F (t).

(2.1)
(2.2)

Infection-age models are partial differential equations (PDE) that takes into account the time
elapsed since the infection œÑ . The equations (2.1) and (2.2) can usually be linked to their respective
ODE models, and in fact the Kermack-Mckendrick SIR and SEIR models [5] are the special cases
of their infection-age correspondents. This modeling allows us to have access to the distribution
of the infected during the infectious period, which enable us to estimate the number of active
infected individuals and the reproduction number along the outbreak using the reported data.
Integrating (2.1) from zero to infinity of with respect of œÑ we obtain:
d
X(t) = F (t) ‚àí
dt

Z‚àû
0

V(t, œÑ )dœÑ,

(2.3)

3

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

[18], considering then a very general heterogeneous model that can be reduced to most models in
literature. We use this general formulation to develop our methodology to obtain the reproduction
numbers and expressions that correlate it to actual data. Then, in section 3, we apply it to a
specific scenario related to the role of the inter-municipal commuter flow of people and extract
its reproduction number and the generation interval distribution. In section 4 and 5 we use
actual data of the emerging SARS-Cov-2 coronavirus pandemic in the municipalities of the state
of Rio de Janeiro, Brazil, to estimate the reproduction numbers that emerge from the system.
Additionally, we reconstruct the time series of cases from the contributions of each municipality
in the propagation of the disease.

d
u(œâ) = ‚àíV(œâ),
dœâ

(2.4)

where V i (œâ) = Vi (t0 + œâ, œÑ0 + œâ). In epidemic models, VÃÑi (œâ) are usually linear equations, making
this system easy to solve. In that case, the system can be represented as:
‚àÇV
d
u=‚àí
u,
dœâ
‚àÇu

(2.5)

u(œâ) = Œì (œâ) u(0),

(2.6)

h
i
‚àÇ
where ‚àí ‚àÇV
‚àÇu = ‚àí ‚àÇuj V i (œâ) is the matrix of the linear system. Assuming that there are no
infected individuals prior to t = 0, we only need to take into account the solution where t > œÑ ,
leading to œâ = œÑ , t = œÑ + t0 and œÑ0 = 0. The solution for a linear system can be written as

where Œì (œâ) = Œì (t, œÑ ), is the fundamental matrix obtained by solving (2.4). Therefore, we identify
F (t0 ) = u(0) in (2.2). So, (2.6) becomes
x(t, œÑ ) = Œì (t, œÑ ) F (t ‚àí œÑ ).

(2.7)

For a linear V(t, œÑ ), Œì (œÑ ) components are exponential functions. Equation (2.7) can also be
used to express the solution of a general non-linear V(t, œÑ ), but if it is not the case, such system
will not be considered in this work. On the other hand, we can also assume that Fi (t) can be
written as
Fi (t) =

n Z‚àû
X
0

j

‚Ñ¶ij (t, œÑ ) xj (t, œÑ )dœÑ,

(2.8)

in which ‚Ñ¶(t, œÑ ) is related to the generation of infected individuals in "i" due to "j". If ‚Ñ¶ does not
depend on œÑ , as in ODE models, it assumes the form of
‚Ñ¶(t) =

i
h ‚àÇ
Fi (t)
‚àÇxj

(2.9)

Most system in literature satisfies (2.7) and (2.8), thus the method in this work is very general
and can be applied to a wide range of models.

(b) Obtaining the reproduction numbers
To estimate the reproduction number using the reported data of new infections, we need to link
them with the equations of the model. This can be done by substituting (2.7) in (2.8). Arranging
the equation we get
F (t) =
for

Z‚àû
0

A(t, œÑ )F (t ‚àí œÑ )dœÑ,

(2.10)

4

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

which is the correspondent to the sub-set of equations for the infected variables of the ODE model.
Therefore, even though we are dealing with an infection-age model, one can simply build F and
V from an ODE system and apply the methodology in this work. We demonstrate this for usual
ODE models in the Supplementary Material 1.
Since Fi (t) and Vi (t, œÑ ) are well defined, we proceed to solving equation (2.1) using the
method of integration along the characteristic line. Thus, the left side of the equation (2.1)
indicates that the characteristics of those PDE‚Äôs are lines of slope 1, which implies that t = œÑ + c
with c being an arbitrary constant. We fix a point (t0 ,œÑ0 ) and introduce a variable œâ such that
ui (s) = xi (t0 + œâ, œÑ0 + œâ) are functions that provide the values of the compartment densities
along the characteristic. After straightforward calculations [4], we obtain

A(t, œÑ ) = ‚Ñ¶(t, œÑ )Œì (t, œÑ ).

(2.11)

Jij (t) =

Z‚àû
0

Aij (t, œÑ )Fj (t ‚àí œÑ )dœÑ,

(2.12)

P
it becomes clear that Fi (t) = n
j Jij (t). Thus, it is possible to quantify the influence of the
infections occurred in one compartment new ones in another compartment. To obtain the
expected number of new infections in Xi a newly infected individual form Xj is expected to
generate, thus the reproduction number, we integrate Aij (t, œÑ ) from zero to infinity with respect
to œÑ , as in [10].
Rij (t) =

Z‚àû
0

Aij (t, œÑ )dœÑ.

(2.13)

R is usually called the next-generation matrix, where its entries corresponds to the
reproduction numbers of the system [14]. It is remarkable that, for a ODE model where V is
linear, the next-generation matrix evaluated at the free-disease fixed point R|x0 , is equivalent to
the one developed in [19]. Naturally from (2.13), we define
Aij (t, œÑ )
gij (t, œÑ ) = R‚àû
,
0 Aij (t, œÑ )dœÑ

(2.14)

where gij (t, œÑ ) is normalized and denoted as the generation interval distribution [3,10]. Thus, it
is related to the flow of individuals between infected compartments and their recover process.
We assume a generation interval distribution depending on t and œÑ , which is general enough to
be applied to models whose dynamics can change over time. Therefore, using (2.13) and (2.14) in
(2.12) we obtain:
Jij (t) = Rij (t)

Z‚àû
0

gij (t, œÑ ) Fj (t ‚àí œÑ )dœÑ.

(2.15)

It is important to highlight that Rij (t) is not necessarily the number of new infected in Xi
generated by Xj . Instead, the meaning of Rij (t) is linked to the generation of new infected ones
in ‚Äúi‚Äù, Fi (t), due to infected individuals previously generated in ‚Äúj‚Äù, Fj (t ‚àí œÑ ), regardless of what
stage of the disease these infected individuals who entered ‚Äúj‚Äù are at instant t. That is the case
because a new infected individual may generate new infections through out many stages of the
disease. In the SEIR model, for example, all of the new infections are in the E compartment, but
the individual only becomes infective when it goes to the I. To access the reproduction number
a newly infected in Xj is expected to generate to all of the other compartments, we can just sum
the Rij over i, defining
Rj (t) =

n
X
i

Rij (t).

(2.16)

Through out this work, the over-line represents the merge of the first index , in this case, in the
P
form of a sum. This lead us to analogously define Aj = n
i Aij , whereby its integral from zero to
infinity with respect to œÑ is Rj . Thus, we are able to write

where J j (t) =

Pn
i

J j (t) = Rj (t)
Jij (t) and

Z‚àû
0

g j (t, œÑ ) Fj (t ‚àí œÑ )dœÑ,

(2.17)

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

The functions Aij (t, œÑ ), analogously to [10], are referred as the rate of new infections in Xi due
to Xj previous infections at a calendar time t and infection-age œÑ , whereby Aij (t, œÑ > t) ‚â° 0. So,
we can describe the new cases in "Xi " from the cases that occurred previously in all the groups.
In fact, (2.10) is a general form for the widely known renewal equation, [3,10], actually a sum of
renewal equations. Thus, by defining the number of new infections in the "i" compartment due to
"j" previews infections as

5

Pn
i

Rij (t)gij (t, œÑ )
Pn
i Rij (t)

6

(2.18)

Therefore, J j (t) is the total number of new infections generated by previews infections in
Xj . It is interesting that the generation interval distribution g j (t, œÑ ) takes the form of a weighted
average in which the gij (t, œÑ ) are the weights.
Thus, the implementation of the proposed method in this work amounts to: identifying the
terms F and V from a model; using them to find ‚Ñ¶ and Œì ; obtaining A and integrating to get R
and g. Further in this work we present applications of the method and estimations using actual
data. Examples of the method in different types of models can be found on the Supplementary
Material 1.

(c) The total reproduction number
After obtaining the reproduction numbers of the constituents of the system, we now intend to
define a reproduction number for the whole system. The number of new infections in a group,
Fi (t), can be described as a fraction of the total number of cases from all groups, F T (t) =
Pn
i Fi (t) such that
Fi (t) = Œ±i (t)F T (t).

(2.19)

Since Œ±i (t) is the proportion of the total number of cases that Fi (t) represents, the condition
P
1 = i Œ±i (t) must be satisfied. Thus, using (2.10) with (2.19), we obtain:
F T (t) = RT (t)

Z‚àû
0

g T (t, œÑ )F T (t ‚àí œÑ )dœÑ,

(2.20)

where RT (t) = Œ± ¬∑ R is the reproduction number of the system and
g T (t, œÑ ) =

P

i Œ±i (t)Ri (t) g i (œÑ )

P

i Œ±i (t)Ri (t)

.

(2.21)

Since RT (t) is the scalar product between Œ± and R, we can interpret it as the projection of
the R over the fractions Œ± forming a weighted average. Thus, it is interesting to note that we can
describe the system as an average of its heterogeneities. Since the definition of the total number of
reproductions RT is very general, it is not always meaningful. For example, if we form a system
of two independent dynamics, that is, (Rij = 0 for i 6= j) it is still possible to obtain a RT , even
if there is no meaning to it. The Œ±i (t) functions are the key for analysing the feasibility of a total
reproduction number that has a dynamical meaning.
We focus our attention on a case where the Œ±i (t) appears naturally in the equations. If ‚Ñ¶ij (t, œÑ )
can be separated in a function of t depending on the "i" index and another function of t and œÑ
depending on the "j" index, then it can be written as
h
i
‚Ñ¶ = Œ± ‚äó ‚Ñ¶ = Œ±i (t)‚Ñ¶ j (t, œÑ )

(2.22)

P
P
where ‚äó represents a tensor product. We define ‚Ñ¶ j = i ‚Ñ¶ij , and noticed that Aj = k ‚Ñ¶ k Œìkj e
A = Œ± ‚äó A. Thus, ‚Ñ¶ and A can be separated in proportions, Œ± and ‚Ñ¶. In fact, the above equation
also impacts (2.16) and (2.17) which can be factorized in terms of R = Œ± ‚äó R e J = Œ± ‚äó J .
Using (2.18) we can also get gij (t, œÑ ) = g j (t, œÑ ). Furthermore, because the next generation matrix
is obtained from a tensor product of vectors, the largest eigenvalue of R corresponds to the scalar
product of R e Œ±, that is RT . Thus, in these systems the total reproduction number assessed at the
disease-free equilibrium point, t = 0, corresponds to the basic reproduction number, RT (0) = R0 .
Also, in that case, the RT is the spectral radius of R, as in [19]. This is very common in disease
transmission models, in fact the SIR and SEIR model are examples of this case.

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

Aj (t, œÑ )
g j (t, œÑ ) = R‚àû
=
0 Aj (t, œÑ )dœÑ

(d) Estimations with real data

7

Bi (t) = œÅi

Z t+‚àÜt
t

Fi (t0 )dt0 ,

Tij (t) = œÅi

Z t+‚àÜt
t

Jij (t0 )dt0 .

(2.23)

Therefore Bi (t) are the reported cases in Xi , where œÅi is a constant related to a higher or
lower notification, due to sub/super-notification. Analogously we define Tij (t) as the number
of reported cases in Xi due to previous cases in Xj . By assuming that Rij , gij (t, œÑ ) and Fi are
approximately constants during a ‚àÜt interval, we use (2.15) and (2.8) to derive

Tij (t) = Rij (t)

t
X
œÅi
gij (t, œÑ )Bj (t ‚àí œÑ )‚àÜt
œÅj

(2.24)

œÑ =0

P
for Bi (t) = n
j Tij . (2.24) is a general form for the discrete version of the renewal equation. In fact,
by using (2.20) we are able to recover a well known result in literature [17]
RT (t) = Pt

œÅi
œÑ =0 œÅj

where BT (t) =

Pn
i

Bi (t).

BT (t)

g T (t, œÑ )BT (t ‚àí œÑ )‚àÜt

,

(2.25)

3. Explicit expression of R(t) for two meta-population models

In this section we analyse two meta-population models detailed in Supplementary Material 2.
The methodology developed on this study is applied to both models to obtain the correspondent
reproduction numbers and generation interval distributions, see Supplementary Material 1 for
detailed calculations.

(a) SIR-type meta-population model
In this section we will consider a meta-population model takes into account groups of spatially
separated "island" populations with some level of interaction. Such models are widely used for
systems in which the movement of individuals between meta-populations is considered [20‚Äì26].
Since each population is connected with the others, the system can be interpreted as a network
for which the nodes represent the meta-populations and the weight of their edges represent
the intensity of the movement between them. This type of model does not describe the daily
movement of individuals explicitly, but as an interaction of the meta-populations. It is suitable
when the population sizes are not permanently affected by the flow of individuals, as in the case
of commuter movement between locations of residence, work and study. This type of movement
is obligatory cyclical, predictable and recurring regularly, most of the time on a daily basis. In this
model, we assumed that each meta-population i, with Ni individuals, has its own transmission
rate Œ≤i (t). Also, the movement of individuals between meta-populations is taken into account,
where we introduce Œ¶ij (t) as the density of flow between the populations i and j. That is, the
amount of i resident individuals commuting from i to j divided by the total population of i,
Ni . The parameters Œ≤i (t) and Œ¶ij (t) are time dependent, so we can incorporate the changes in the
behavior of the populations on those variables.In Supplementary Material 2 we derive this model,
inspired by [26], and in Supplementary Material 1 we obtain the corresponding reproduction
numbers and generation interval distribution for it, which reads:

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

So far, we‚Äôve developed a general framework to estimate the reproduction numbers from the rate
of new infections F. However, when we deal with real data what we have is the collection of all
of the new infections in an ‚àÜt period of time, which leads to the definition of B and T .

Rij (t) = Si (t)

gij (œÑ ) = g(œÑ ) = Œ≥ e‚àíŒ≥ œÑ .

8

(3.1)

Here Œªij is related to the transmission of the disease from a meta-population ‚Äúi‚Äù to other metapopulation ‚Äúj‚Äù and is derived based on simple assumptions about the commuter movement
of individuals in the network, see Supplementary Material 2. Notably, if we isolate the metapopulations from the network, Œ¶ij (t) = 0, for all i and j, then the reproduction numbers and the
generation interval distributions becomes identical to the classical SIR model [10].

(b) A meta-population model for Covid-19 (SEIIR)
The classical SIR model is a very simple and qualitative approach to disease transmission
dynamics, but it does not provide the best description for most diseases. For now on, we will
be focusing on a model for a specific disease, the SARS-Cov-2 coronavirus. In this case, the
transmission can be facilitated by the existence of individuals whose symptoms are very weak
or even nonexistent [27], therefore, this heterogeneity can change the dynamics. In order to have
consistence description of this aspect, it is wise to assume that the existence of two classes of
infected individuals, the symptomatic and the asymptomatic/undetected ones, as considered
in a general model for the SARS-Cov-2 coronavirus [28]. Therefore, we now take into account
infected individuals who do not need to be hospitalized and are not recorded in official registered
data, thus becoming undetectable. For the sake of simplicity, we will refer to those individuals
only as asymptomatic ones, for simplicity. In Supplementary Material 2 we proceed to derive
this model, based in the meta-population SIR-type approach described in the previous section. In
Supplementary Material 1 the expressions for the reproduction number and generation interval
distribution are detailed derived. There, we show that we only need R for i, j ‚â§ n to describe the
dynamics. Thus, in this main framework, whenever we refer to R or g we will be alluding to their
i, j ‚â§ n elements. Thus, we obtain:
Rij (t) = Si (t)Œªij (t)

hp
Œ¥(1 ‚àí p) i
+
,
Œ≥s
Œ≥a

gij (œÑ ) = g(œÑ ) =

Œ¥(1‚àíp) a
p s
Œ≥s g (œÑ ) +
Œ≥a g (œÑ )
.
Œ¥(1‚àíp)
p
Œ≥s +
Œ≥a

(3.2)

the Œªij ‚Äôs expressions are the same presented for the SIR-type model in Supplementary Material
2. Œ¥ is a factor that reduces or enhances the asymptomatic infectivity, p is the proportion of
individuals that becomes symptomatic when infected, Œ≥a and Œ≥s are the recover rates of the
asymptomatic and symptomatic individuals, respectively. g a (œÑ ) and g s (œÑ ) are expressed in terms
of exponential functions described according to (3.3).
g a (œÑ ) =

Œ∫Œ≥a
(e‚àíŒ∫œÑ ‚àí e‚àíŒ≥a œÑ ),
Œ≥a ‚àí Œ∫

g s (œÑ ) =

Œ∫Œ≥s
(e‚àíŒ∫œÑ ‚àí e‚àíŒ≥s œÑ ).
Œ≥s ‚àí Œ∫

(3.3)

Whereby, if we isolate the meta-populations from the network, Œ¶ij (t) = 0, for all i and j, the
reproduction numbers and generation interval distributions returns to the expression obtained
in [28].

4. Applications for the meta-population models using actual data
In this section, we present results for the methodology applied to the meta-population model
developed in the previews section. We use actual data of the first six months of the COVID19 pandemic in Brazilian cities, such as: reported cases in each municipality, daily commuter
movement due to work between municipalities and daily mobility tends towards workplaces.
In Supplementary Material 3 we derive and present the expressions and parameters needed to
estimate the reproduction numbers for both meta-population models. Thus, we obtain a daily
time series of the reproduction numbers for each model.

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

Œªij (t)
,
Œ≥

(a) Database

(b) Analyses of the results
In our first results, shown in Figure 1, we present a comparison between the SIR and SEIIR
outputs. Using the daily time series of the reproduction numbers, see Supplementary Material
3, we obtain the series of R(t) and T (t) from (2.16) and (2.24), respectively. We observe that
the R of SEIIR model is, in the average, 33% higher then the corresponding results for the SIR
model. On the other hand, the estimations of the total number of exported cases that are reported,
P Pn
t
i Tij (t) for i 6= j, is very similar for both SIR and SEIIR models Also, it seems that the total
commuter movement, which is the sum of all the inflow and outflow happening in a municipality,
is not the only main factor that determine the number of exported cases of a municipality. This
non-linearity can be observed when comparing S√£o Jo√£o de Meriti (SJdM) and Niter√≥i (Nt) or
Duque de Caxias (DdC) and Nova Igua√ßu (NI) (see Figure 1b). Those municipalities have a similar
amount of total flow but very different results for the exported cases. Interestingly, even not
having the highest Rj , the capital, Rio de Janeiro (RJ) presents the largest amount of exported
cases, which also showcases the non-linear dynamics of the phenomenon.
From now on, we will only look at the results of the SEIIR model. With Tij (t) we are able to
access the contribution of each municipality on the outbreaks happening in the state. Thus, by
dividing Tij (t) by Bi (t) in every time step, we obtain a time series for the proportion of the total
cases in ‚Äúi‚Äù generated by ‚Äúj‚Äù. Therefore, we proceed into evaluating the mean value through time
of Tij /Bi , where it is displaced in Figure 2. It is observed a high autochthonous behavior on the
disease transmission, whereby the highest influence of a city is on itself. Therefore, most of the
cases generated in a municipality are caused by its own individuals. However, we also identify
cities where the cases generated by other municipalities on it are very important. The R(t) matrix
also corroborates the presence of an important autochthonous behavior as its diagonal elements

9

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

In this work, we use daily notifications of new cases due to COVID-19 in Brazil, obtained from
public websites: https://covid.saude.gov.br/ and https://brasil.io/datasets/ ,
which provide data from the Health Ministry. We obtained intermunicipal commuter movement
of workers and students data from a study on population arrangements and urban concentrations
in Brazil conducted by IBGE (Brasilian Institute of Geography and Statistics) in 2015 that can be
found at [29]. In addition, we obtain daily mobility data for each Brazilian state from a public
report by Google, accessed at: https://google.com/covid19/mobility/.
We used the data observed until September 14th, 2020, and performed a 10-day moving
average, in order to attenuate noise and better express the data trend. To take the social distancing
restrictions into account, we considered only the commuter movement data related to work, since,
with the mitigation measures of COVID-19, the flow due to education were significantly reduced.
In addition, because the movement towards work also dropped due to social isolation policies,
we used the mobility data obtained from the community mobility report provided by Google to
estimate this reduction. This database compares for each state the daily mobility to workplaces
with the past trends, therefore, we can access the percentage of reduction in commuting to work.
A moving average is performed in the mobility time series and we reduce the intermunicipal
work flow according to the percentage indicated on the data. Thus, we obtain the flow of
individuals due to commuter work that leads to Œ¶ij (t). The parameters used to feed the model
were obtained in [30] and are displayed in Supplementary Material 3.
The data from the state of Rio de Janeiro was selected for this analysis. Ten cities with the
highest commuter flow with the capital Rio de Janeiro (RJ), were chosen, namely: Duque de
Caxias (DdC), Nova Igua√ßu (NI), S√£o Jo√£o de Meriti (SJdM), Niter√≥i (Nt), S√£o Gon√ßalo (SG),
Belford Roxo (BR), Nil√≥polis (Ns), Mesquita (Mq), Queimados (Q), Mag√© (Ma). All of the chosen
cities for this work are part of the Rio de Janeiro‚Äôs metropolitan region. Additional information
about the municipalities is presented in Supplementary Material 4.

(b)

10

N¬∫ of individuals

(a)
1.5

105

i

103

0.5
0.0 RJ DdC NI SJdM Nt SG BR Ns Mq Q Ma

Cities

SIR

101 RJ DdC NI SJdM Nt SG BR Ns Mq Q Ma

SEIIR

Movement

Cities

Figure 1. Comparison between SIR and SEIIR outputs. SIR results in blue and SEIIR ones in orange. The bar graph
(a) compares the SIR and SEIIR Ri averages in time for all municipalities. In (b), for each municipality, estimations for

the total number of exported cases that are reported for both models are displaced with the total commuter movement in
that city. The names of the municipalities are abbreviated using acronyms: Rio de Janeiro (RJ), Duque de Caxias (DdC),
Nova Igua√ßu (NI), S√£o Jo√£o de Meriti (SJdM), Niter√≥i (Nt), S√£o Gon√ßalo (SG), Belford Roxo (BR), Nil√≥polis (Ns), Mesquita
(Mq), Queimados (Q), Mag√© (Ma).

RJ 94.49 0.79 2.31 0.38 0.92 0.49 0.76 0.15 0.04 0.22 0.18

100%

DdC 14.3679.56 2.07 0.74 0.67 0.16 1.54 0.08 0.02 0.12 0.77
NI 14.97 0.80 77.24 0.62 0.64 0.13 3.69 0.55 0.22 1.28 0.08
SJdM 21.21 2.46 5.50 66.64 0.83 0.18 2.34 0.39 0.07 0.31 0.11

75%

Nt 4.99 0.18 0.49 0.07 88.98 5.48 0.14 0.03 0.01 0.03 0.13
SG 6.84 0.11 0.26 0.04 15.7476.78 0.09 0.02 0.00 0.02 0.11

50%

BR 16.67 1.76 10.70 0.81 0.58 0.12 68.75 0.16 0.07 0.34 0.09
Ns 20.56 0.72 11.76 0.97 0.91 0.19 1.43 62.59 0.33 0.49 0.05
Mq 19.00 0.68 17.92 0.64 0.64 0.15 2.41 1.21 56.79 0.58 0.05

25%

Q 10.10 0.31 9.23 0.26 0.33 0.10 1.08 0.16 0.05 78.33 0.05
Ma 5.89 1.53 0.40 0.06 0.90 0.30 0.18 0.01 0.00 0.03 90.69
RJ DdC NI SJdM Nt SG BR Ns Mq Q Ma

0%

Figure 2. Influence on number of cases of a municipality in another. The heatmap captures the average, through
time, influence on number of cases of a municipality in another as a proportion of the total number of daily cases, Tij /Bi .

i corresponds to the rows and j to the columns.

correspond to the highest values of the reproduction numbers. We also observed lots of very
smalloff-diagonal elements low values through out the matrix.
In Figure 3 we illustrate the results of Figure 2, whereby only non-autochthonous influences
above 5% are considered. Thus, we must highlight the capital, Rio de Janeiro (RJ), as the most
important agent on the disease transmission to the municipalities on the network. However, cities
like Nova Igua√ßu (NI) also presents itself as a relevant disseminator of the pathogen. As shown
in Figure 1, Nova Igua√ßu NI is the highest city in case exportation, besides the capital. In Figure
3 we identify cities like: S√£o Jo√£o de Meriti (SJdM), Belford Roxo (BR), Nil√≥polis (Ns), Mesquita

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

1.0

BR

SJdM

C
M

SG

q

Q

Ma

NI

Nt

RJ

Figure 3. Visualization of the influence between municipalities. Here, we present a visualization of the results
from Figure 2. Only non-autochthonous influences above 5% were considered. The thickness of the lines connecting
municipalities is proportional to the number of cases that one generates on the other. The color of each line represents
the municipality that is generating the cases.

(a)

100
50

N¬∫ of cases

N¬∫ of cases

150

(b)
50
40
30
20
10
0

0
   
   
   
   
   
   
   
                                               
   
 
 
 
 
 

   

   
   
   
   
   
   
   
                                              
 
 
 
 
 
 

Figure 4. Reconstruction of the time series. The black dots represents the daily reported cases in (a) S√£o Gon√ßalo
(SG), (b) S√£o Jo√£o de Meriti (SJdM). The blue dots are the amount of cases generated in (a) S√£o Gon√ßalo (SG), (b) S√£o
Jo√£o de Meriti (SJdM) due to the capital, Rio de Janeiro (RJ). In red we have the number of cases reported in (a) S√£o
Gon√ßalo (SG) due to Niter√≥i (Nt); (b) S√£o Jo√£o de Meriti (SJdM) due to Nova Igua√ßu (NI).

(Mq) and Queimados(Q) as the main receptors of those cases. Niter√≥i (Nt), even having a NIlike number of exported cases, did not presented a high influence on a lot of cities. On the other
hand, Niter√≥i (Nt) generates a significant amount of cases in S√£o Gon√ßalo (SG), highlighting the
importance of the connection of those two municipalities.
We illustrate the time series reconstruction in Figure 4 where two scenarios are displaced. In
the first one, we focus on the cases reported in S√£o Gon√ßalo (SG) and compare total amount,
Bi (t), with the number of daily cases in SG generated by Rio de Janeiro (RJ) and Niter√≥i (Nt).
We observe that Nt has a predominance over the capital, presenting a higher number of cases
generated in all times. The second scenario is related to the total number of cases in S√£o Jo√£o de

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

Ns

11

Dd

5. Discussion
Understanding and dealing with infectious diseases is an on going challenge to humankind.
The methodology presented in this work is very general and can be applied to multiple disease
transmission systems. By merging the model dynamics with the available epidemic data, this
method is able to estimate key epidemiological factors, like the reproduction numbers and the
generation interval distributions. These theoretical results are the basis for a lot of possible data
analyses, specially for highly heterogeneous systems that have been demanding for a suitable
methodology for estimating the reproduction number through actual data. The method is robust
and reproduces known results in literature, as shown in Supplementary Material 1 for the SIR,
SEIR and SEIIR models. This methodology opens room for the analyses of more sophisticated
models, that leads to a better understanding and control of infectious diseases.
With the emerging of the COVID-19 pandemic, due to SARS-Cov-2 coronavirus, in December
2019, scientists allover the world have joined forces to formulate control strategies [31]. Factors
like the presence of asymptomatic individuals, risk groups and spatial distribution of the disease
brings out a system with multiples layers of heterogeneity [26,27,32,33]. Although the application
of some vaccines starts recently, mitigating COVID-19 with non-pharmacological strategies is
essential. Therefore, the second half of this work we focused on the application of the developed
methodology for two models with spatial heterogeneity, one focusing on the COVID-19 specific
dynamics. Each municipal demography, captured by Œ≤ parameters, and the commuter movement
were combined by the model lead to some interesting results. The reproduction numbers are
obtained for both models indicate that they only differ by multiplying factors, as 1/Œ≥ and
Œ¥(1‚àíp)
p
Œ≥s +
Œ≥a , as in [28,30]. The measured results shows that the asymptomatic presence is related
to an increase on the reproduction number, because the model predicts more infected individuals
than what is reported. Another substantial result is obtained when comparing the exported cases
with the total commuter movement in a municipality. In this case, the relationship is not direct,
since the intricate topology of the network fosters a non-linear dynamic in the phenomenon. This
result points up the importance of a model to provide epidemiological meaning of the available
data. For this specific case, it became evident that analysing the system only by the commuter
movement data wouldn‚Äôt be enough to point out the key cities on the disease transmission
dynamic, as we did using the models and methodology.
The results of the model display the role of each municipality on the epidemic on the network.
Cities like Nova Igua√ßu, Niter√≥i and S√£o Gon√ßalo pops out as important agents on the spread
of the pathogen through out the metropolitan region of Rio de Janeiro, Brazil. The capital is
highlighted as the main hub of spreading, which is related to its high incidence of the disease
combined with its central role on the movement behavior of individuals on the network, as also
observed in [26,30,34]. However, cases like Niter√≥i and S√£o Gon√ßalo, where the interaction of both
cities is higher than the capital‚Äôs influence, cannot be neglected. This call‚Äôs the attention for the
relevance of analysis, like in this work, that provides the epidemiological interpretation of data.
In this work, we choose to present an analysis with actual data in which the reproduction number
is not the main result. We proceeded with this approach to portrait the reproduction number not
as a dead end result, but as a tool for obtaining deeper analyses, such as the reconstruction of the
time series and the number of exported cases.
Our results for the Rio de Janeiro metropolitan area, however, have limitations. The model
developed in this work provides a very simple approximation of intercity commuter flow,
while more sophisticated models available in the literature are required to provide more precise
description of the movement behavior. Another limitation of this work is that it does not consider

12

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

Meriti (SJdM) and the contributions due to Rio de Janeiro (RJ) and Nova Igua√ßu (NI). In this case,
the capital presents the largest number of cases generated in that city, besides the city itself. It is
also interesting to observe in both scenarios how the cities contributions merge into a part of the
total cases notified on a municipality.

Ethics. Since all data handled in this study is publicly available, an approval by an ethics committee is not
required, according to Resolutions 466/2012 and 510/2016 (article 1, sections III and V) from the National
Health Council (CNS), Brazil.

Data Accessibility. All data and codes are gathered and presented in our public GitHub repository at
https://github.com/danielcpj/Rt-heterogeneous-models

Authors‚Äô Contributions. DCPJ, STRP and RFSA conceived of and designed the methodology presented
in this study. DCPJ, STRP, JGVM and JFO formulated and interpreted the meta-population models and
applications. DCPJ performed the data analysis and drafted the manuscript. All authors read, reviewed and
approved the manuscript.

Competing Interests. The authors declare that they have no competing interests.
Funding. DCPJ was funded by a Scientfiic Initiation scholarship from CNPq (process number 117568/20198). JFO was supported by the Fiocruz Program of Promotion of Innovation - innovative ideas and products COVID-19, orders and strategies - Inova Fiocruz (Processo VPPIS-005-FIO-20-2-40), and the Center of Data
and Knowledge Integration for Health (CIDACS) through the Zika Platform - a long-term surveillance
platform for Zika virus and microcephaly (Unified Health System (SUS), Brazilian Ministry of Health).
STRP was supported by an International Cooperation grant (process number INT0002/2016) from Bahia
Research Foundation (FAPESB). RFSA was supported by Brazilian agency CNPq through Grants No.
422561/2018-5 and 304257/2019-2. STRP and RFSA were supported by the National Institute of Science and
Technology - Complex Systems from CNPq, Brazil. JGVM acknowledges the support of the National Council
of Technological and Scientific Development, CNPq, Brazil (Grant number: 307828/2018-2).

Acknowledgements. The authors acknowledge the discussions and suggestions from members of the
CoVida Network (http://www.redecovida.org).

Supplementary Materials
Supplementary Material 1- Methodology applied for epidemiological compartment models
Supplementary Material 2- Meta-population models formulation.
Supplementary Material 3- Expressions and parameter values to estimate the reproduction
numbers of the meta-population models
Supplementary Material 4- Additional information about the municipalities.

References
1. Brauer, F. 2008 Epidemic Models with Heterogeneous Mixing and Treatment. Bulletin of
Mathematical Biology 70, 1869-1885. (doi:10.1007/s11538-008-9326-1)
2. Hyman, J. & Li, J. 2000 An intuitive formulation for the reproductive number for the spread of
diseases in heterogeneous populations. Mathematical Biosciences 167, 65-86. (doi:10.1016/s00255564(00)00025-0)
3. Wallinga, J. & Lipsitch, M. 2006 How generation intervals shape the relationship between growth rates
and reproductive numbers. Proceedings of the Royal Society B: Biological Sciences 274, 599-604.
(doi:10.1098/rspb.2006.3754)
4. Martcheva, M. 2015 An introduction to mathematical epidemiology. New York; Heidelberg:
Springer. (doi:10.1007/978-1-4899-7612-3_12)

13

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

the interstate flow, since the state of Rio de Janeiro was portrayed as a closed system Also, we did
not take into account further heterogeneous features, which could be accounted as well by the
general theoretical formalism, besides space and asymptomatic presence, leaving a gap for other
key COVID-19 dynamics characteristics, like age-groups. In addition, the examples presented in
this work considered actual reported data of confirmed cases and mobility, which may present
problems of underestimation and report delay. Taking those limitations into account, the results
displaced here are still able to give substantial understanding of the system studied, which is a
common feature in mathematical modelling. Finally, we reinforce the importance of the method
proposed on this work and highlight its broad application on infectious disease models.

14

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

5. Kermack, W. & McKendrick, A. 1927 A contribution to the mathematical theory of epidemics.
Proceedings of the Royal Society of London. Series A, Containing Papers of a Mathematical
and Physical Character 115, 700-721.(doi:10.1098/rspa.1927.0118).
6. Park, S., Champredon, D. & Dushoff, J. 2020 Inferring generation-interval distributions
from contact-tracing data. Journal of The Royal Society Interface 17, 20190719.
(doi:10.1098/rsif.2019.0719)
7. Huber, J., Johnston, G., Greenhouse, B., Smith, D. & Perkins, T. 2016 Quantitative, modelbased estimates of variability in the generation and serial intervals of Plasmodium falciparum
malaria. Malaria Journal 15. (doi:10.1186/s12936-016-1537-6)
8. Lessler, J. et al. 2016 Times to key events in Zika virus infection and implications for
blood donation: a systematic review. Bulletin of the World Health Organization 94, 841-849.
(doi:10.2471/blt.16.174540)
9. Nishiura, H., Linton, N. & Akhmetzhanov, A. 2020 Serial interval of novel coronavirus
(COVID-19) infections. International Journal of Infectious Diseases 93, 284-286.
(doi:10.1016/j.ijid.2020.02.060)
10. Nishiura, H. & Chowell, G. 2009 The Effective Reproduction Number as a Prelude to
Statistical Estimation of Time-Dependent Epidemic Trends. Mathematical and Statistical Estimation
Approaches in Epidemiology , 103-121. (doi:10.1007/978-90-481-2313-1_5).
11. Champredon, D. & Dushoff, J. 2020 Intrinsic and realized generation intervals in infectiousdisease transmission. (doi:10.1098/rspb.2015.2026)
12. Akkouchi, M. 2004 On the convolution of exponential distribution. J. Chungcheong Math. Soc..
21.
13. Champredon, D., Dushoff, J. & Earn, D. J. D. 2018 Equivalence of the Erlang-distributed SEIR
epidemic model and the renewal equation. (doi:10.1137/18M1186411)
14. Nishiura, H., Castillo-Chavez, C., Safan, M., & Chowell, G. 2009 Transmission potential of
the new influenza A(H1N1) virus and its age-specificity in Japan. Euro Surveill, 14, 19227.
(doi:10.2807/ese.14.22.19227-en)
15. Park, S., Champredon, D., Weitz, J. & Dushoff, J. 2019 A practical generation-intervalbased approach to inferring the strength of epidemics from their speed. Epidemics 27, 12-18.
(doi:10.1016/j.epidem.2018.12.002)
16. Arenas A, Cota W, G√≥mez-Garde√±es J, G√≥mez S, Granell C, Matamalas JT, SorianoPa√±os D, Steinegger B. 2020 Modeling the Spatiotemporal Epidemic Spreading of COVID-19
and the Impact of Mobility and Social Distancing Interventions. Phys. Rev. X 10, 041055.
(doi:10.1103/PhysRevX.10.041055)
17. Fraser C. 2007 Estimating Individual and Household Reproduction Numbers in an Emerging
Epidemic. PLOS ONE 2, e758. (doi:10.1371/journal.pone.0000758)
18. Hethcote, H. 1978 An immunization model for a heterogeneous population. Theoretical Population
Biology 14, 338-349. (doi:10.1016/0040-5809(78)90011-4)
19. van den Driessche, P. & Watmough, J. 2002 Reproduction numbers and sub-threshold endemic
equilibria for compartmental models of disease transmission. Mathematical Biosciences 180,
29-48. doi:10.1016/s0025-5564(02)00108-6
20. van den Driessche, P. 2008 Spatial Structure: Patch Models. Mathematical Epidemiology , 179189. (doi:10.1007/978-3-540-78911-6_7)
21. Bichara, D. & Iggidr, A. 2017 Multi-patch and multi-group epidemic models: a new
framework. Journal of Mathematical Biology 77, 107-134. (doi:10.1007/s00285-017-1191-9)
22. Lloyd, A. & May, R. 1996 Spatial Heterogeneity in Epidemic Models. Journal of Theoretical
Biology 179, 1-11. (doi:10.1006/jtbi.1996.0042)
23. Lajmanovich, A. & Yorke, J. 1976 A deterministic model for gonorrhea in a nonhomogeneous
population. Mathematical Biosciences 28, 221-236. (doi:10.1016/0025-5564(76)90125-5
24. Arino, J. & Portet, S. 2015 Epidemiological implications of mobility between a large
urban centre and smaller satellite cities. Journal of Mathematical Biology 71, 1243-1265.
(doi:10.1007/s00285-014-0854-z)
25. Keeling, M., Danon, L., Vernon, M. & House, T. 2010 Individual identity and movement
networks for disease metapopulations. Proceedings of the National Academy of Sciences 107,
8866-8870. (doi:10.1073/pnas.1000416107)
26. Miranda, J. G. V. et al. 2021 Scaling effect in covid-19 spreading: The role of heterogeneity
in a hybrid ode-networkmodel with restrictions on the inter-cities flow. Physica D: Nonlinear
Phenomena 415, 132792. (doi:10.1016/j.physd.2020.132792)

15

rspa.royalsocietypublishing.org Proc R Soc A 0000000
..........................................................

27. Li R, Pei S, Chen B, Song Y, Zhang T, Yang W, Shaman J. 2020 Substantial undocumented
infection facilitates the rapid dissemination of novel coronavirus (SARS-CoV-2). Science 368,
489‚Äì493. (doi:10.1126/science.abb3221).
28. Oliveira JF et al. 2021 Mathematical modeling of COVID-19 in 14.8 million individuals in
Bahia, Brazil. Nat Commun 12, 333. (doi:10.1038/s41467-020-19798-3)
29. Instituto Brasileiro de Geografia e Estat√≠stica - IBGE.
In: Estimates for the population of Bahia in 2019 [Internet]. [cited 1 Mar 2020].
Available: www.ibge.gov.br/.../arranjos-populacionais
30. Jorge, D. et al. 2020 Assessing the nationwide impact of COVID-19 mitigation policies on the
transmission rate of SARS-CoV-2 in Brazil | medRxiv. (doi:10.1101/2020.06.26.20140780).
31. NEGAHDARIPOUR, M. 2020 The Battle Against COVID-19: Where Do We Stand Now?
Iranian Journal of Medical Sciences 45, 81‚Äì82. (doi:10.30476/ijms.2020.46357).
32. Gomes, M. Gabriela M., et al. "Introducing risk inequality metrics in tuberculosis policy
development." Nature Communications 10.1 (2019): 1-12. (doi:10.1038/s41467-019-10447-y)
33. Eikenberry SE, Mancuso M, Iboi E, Phan T, Eikenberry K, Kuang Y, Kostelich E, Gumel
AB. 2020 To mask or not to mask: Modeling the potential for face mask use by the
general public to curtail the COVID-19 pandemic. Infectious Disease Modelling 5, 293‚Äì308.
(doi:10.1016/j.idm.2020.04.001)
34. Liu J, Hao J, Sun Y, Shi Z. 2021 Network analysis of population flow among
major cities and its influence on COVID-19 transmission in China. Cities 112, 103138.
(doi:10.1016/j.cities.2021.103138)

Estimating the effective reproduction number for
heterogeneous models using actual data
D. C. P. Jorge1,* , J. F. Oliveira2 , J. G. V. Miranda3 , R. F. S. Andrade2,3 , S. T. R. Pinho3

arXiv:2102.12637v1 [q-bio.PE] 25 Feb 2021

1 Instituto

de Fƒ±ÃÅsica TeoÃÅrica, Universidade Estadual Paulista - UNESP, R. Dr. Teobaldo Ferraz 271, SaÃÉo Paulo
01140-070, Brazil
2 Center of Data and Knowledge Integration for Health (CIDACS), Instituto GoncÃßalo Moniz, FundacÃßaÃÉo Oswaldo
Cruz, Salvador, Bahia, Brazil
3 Instituto de Fƒ±ÃÅsica, Universidade Federal da Bahia, Salvador, Bahia, Brazil
* Correspondence: Daniel C. P. Jorge (danielcpjorge98@gmail.com).

ABSTRACT
This document contain the Supplementary Materials for the manuscript entitled "Estimating the effective reproduction number for
heterogeneous models using incidence data" by Jorge et al.

Supplementary Material 1

Methodology applied to epidemiological compartment models

2/19

Applying the method to epidemiological models
We proceed to illustrate the application of the method developed in this work to compartmental epidemic models.
We chose two simple models that are known in literature and two variations of a meta-population model that is
used in the main framework and developed in Supplementary Material 2. We seek to show the method step by step,
presenting its detailed calculations. All models presented are composed of ordinary differential equations. In the
transitions between infected compartments described in these models, V(t, œÑ ), the the infected compartments x(t, œÑ )
appear with linear dependence. Therefore we can simplify:
‚àÇVi
‚àÇVi
=
= cte
‚àÇuj
‚àÇxj

and

d
‚àÇV
u(œâ) = ‚àí
u(œâ).
dœâ
‚àÇx

(1)

In addition, all the parameters of the models in this Supplementary Material are constant, which leads to
‚Ñ¶(t) =

‚àÇ
F (t)
‚àÇX

and

Œì(œâ) = Œì(œÑ )

(2)

SEIR model
The SEIR model is designed by introducing a new exposed E stage of the disease into the SIR model1 . We can
assume that when an individual becomes infected, it must go through a latency period before showing its first
symptoms and starting to infect other individuals. This is accomplished by introducing the exposed compartment
E and its removal rate Œ∫. Thus, all individuals who are infected start in the exposed state and, on average, after
a 1/Œ∫ latency time are introduced into the I compartment. It is also possible to introduce a factor related to a 
pre-symptomatic infection. This way, individuals can start to infect in the exposed compartment, before presenting
symptoms. Thus, this model, considering pre-symptomatic infection, can be written as
dS
dt
dE
dt
dI
dt
dR
dt

i
Œ≤S h
I + E ,
N
i
Œ≤S h
=
I + E ‚àí Œ∫E,
N

=‚àí

(3)
(4)

= Œ∫E ‚àí Œ≥I,

(5)

= Œ≥I.

(6)

Thus, we can sort the infected compartments as X(t) = [E(t), I(t)]. In this way the distributions of the infectious
phase are defined as x(t, œÑ ) = [ie (t, œÑ ), ii (t, œÑ )]. We get F (t) e V(t, œÑ ):
F (t) =

!


Œ≤S 
N I + E
0

,

V(t, œÑ ) =

Œ∫ie (t, œÑ )
Œ≥ii (t, œÑ ) ‚àí Œ∫ie (t, œÑ )

!

,

(7)

as we recover the sub-set of equations for the infected compartments with:
d
X(t) = F (t) ‚àí
dt

Z

0

‚àû

V(t, œÑ )dœÑ.

(8)

The change from E to I is not considered a new infection, but the progression of the disease stage. Therefore, new
infections only occur in the exposed compartment E, causing F2 (t) = 0. Thus, from F (t), we obtain ‚Ñ¶(t):
h ‚àÇ
i  Œ≤S
N
‚Ñ¶(t) =
F (t) =
0
‚àÇX

Œ≤S
N

0

We proceed to obtain Œì(œÑ ) by solving



.



d
‚àÇV
‚àíŒ∫ 0
u(œâ) = ‚àí
u(œâ) =
u(œâ).
Œ∫ ‚àíŒ≥
dœâ
‚àÇx

(9)

(10)
3/19

In order to obtain
u(œâ) =
Therefore:




e‚àíŒ∫œâ
0
Œ∫
‚àíŒ∫œâ ‚àí e‚àíŒ≥œâ ] e‚àíŒ≥œâ u(0).
Œ≥‚àíŒ∫ [e



e‚àíŒ∫œâ
0
Œì(œÑ ) = Œ∫ ‚àíŒ∫œÑ
‚àíŒ≥œÑ ] e‚àíŒ≥œÑ
[e
‚àí
e
Œ≥‚àíŒ∫



(11)

(12)

With ‚Ñ¶(t) and Œì(œÑ ) we perform the multiplication between the matrices, in order to obtain
 Œ≤S

A(t, œÑ ) = N
0

Œ≤S
N

0




e‚àíŒ∫œÑ
0
Œ∫
‚àíŒ∫œÑ ‚àí e‚àíŒ≥œÑ ] e‚àíŒ≥œÑ .
Œ≥‚àíŒ∫ [e

(13)

All terms in the second line are null, leaving only

Œ≤S ‚àíŒ∫œÑ Œ≤S Œ∫
e
+
[e‚àíŒ∫œÑ ‚àí e‚àíŒ≥œÑ ],
N
N Œ≥ ‚àíŒ∫
Œ≤S ‚àíŒ≥œÑ
A12 (t, œÑ ) =
e
.
N

A11 (t, œÑ ) = 

(14)
(15)

Performing the integral from zero to infinity with respect to œÑ we obtain the reproduction numbers of the system
R(t):
Ô£´
 1
S Ô£≠ +
Œ∫
Œ≥
R(t) = Œ≤
N
0

Where it is clear that

Ô£∂
1
Œ≥ Ô£∏.
0

(16)

Ô£∂
 1
+
S Ô£¨Œ∫ Œ≥ Ô£∑
Ô£∑.
R=Œ≤ Ô£¨
NÔ£≠ 1 Ô£∏
Œ≥

(17)

Ô£´
Ô£∂
 1
 O
+
S Ô£¨Œ∫ Œ≥ Ô£∑
1
Ô£∑.
R = Œ±‚äóR =
Œ≤ Ô£¨
0
NÔ£≠ 1 Ô£∏
Œ≥

(18)

Ô£´

Since there is only generation of new infected in the exposed compartment, we have to F1 (t) = F T (t). Thus, the
vector Œ±(t) can be written as Œ± = 1, 0 , thus

Thus, to obtain the total reproduction number of the system, it is enough to make the scalar product between R
and Œ±:
RT (t) = Œ± ¬∑ R =
which leads to
g (œÑ ) =
T

Œ≤S h  1 i
+ ,
N Œ∫ Œ≥

Œ∫
 e‚àíŒ∫œÑ + Œ≥‚àíŒ∫
[e‚àíŒ∫œÑ ‚àí e‚àíŒ≥œÑ ]

/Œ∫ + 1/Œ≥

(19)

.

(20)
4/19

When we make  ‚Üí 0, we retrieve the result of the reproduction number of the classic SEIR model (without
pre-symptomatic infection),R0 = Œ≤/Œ≥. Similarly, the generation interval distribution of the SEIR model is also
reduced to the well-known form in the literature2 , demonstrating robustness in the method. It is trivial to apply the
method to the SIR model, whose analysis corresponds to tanking a limit of Œ∫ ‚Üí ‚àû. Therefore, both the reproduction
number and the generation interval distribution, g(œÑ ) = Œ≥e‚àíŒ≥œÑ , return to the known results from literature3 .
SIIR model
This is an adaptation of the SIR model, where we include two different manifestations of the disease, I1 and I2 .
In this model, there is only one susceptible population whose individuals can evolve into two compartments that
carry the infectious agent. Both types of the disease carry the same pathogen, so that individuals infected with
either type can go for I1 and I2 . When infected, an individual has the probability p of manifesting the type I1 of
the disease and q = (1 ‚àí p) of manifesting the type I2 . We assume two independent infection rates Œ≤1 and Œ≤2 for I1
and I2 . Likewise, each slot has its own Œ≥1 or Œ≥2 removal rate. So, we write the model equations:
dS
dt
dI1
dt
dI2
dt
dR
dt

(Œ≤1 I1 + Œ≤2 I2 )S
,
N
(Œ≤1 I1 + Œ≤2 I2 )S
=p
‚àí Œ≥1 I1 ,
N
(Œ≤1 I1 + Œ≤2 I2 )S
=q
‚àí Œ≥2 I2 ,
N
=‚àí

(21)
(22)
(23)

= Œ≥1 I1 + Œ≥2 I2 .

(24)

We sort
R ‚àû the infected compartments as X(t) = [I1 (t), I2 (t)] and x(t, œÑ ) = [i1 (t, œÑ ), i2 (t, œÑ )], where it is clear that
X(t) = 0 x(t, œÑ )dœÑ . We obtain F (t) and V(t, œÑ ) as:
S
F (t) =
N

!
p(Œ≤1 I1 + Œ≤2 I2 )
q(Œ≤1 I1 + Œ≤2 I2 )

,



Œ≥1 i1 (t, œÑ )
V(t, œÑ ) =
.
Œ≥2 i2 (t, œÑ )

(25)

Thus
S
‚Ñ¶(t) =
N

pŒ≤1

pŒ≤2

qŒ≤1

qŒ≤2

!

‚àí

,


‚àÇV
‚àíŒ≥1
=
0
‚àÇx


0
.
‚àíŒ≥2

(26)

The linear O.D.E system described by the matrix ‚àí‚àÇV/‚àÇx it is simple to solve, since this is a diagonal matrix.
So, we get
Œì(œÑ ) =



e‚àíŒ≥1 œÑ
0

0

e‚àíŒ≥2 œÑ



(27)

,

which, when multiplied by the matrix ‚Ñ¶(t) results in
S
A(t, œÑ ) =
N

pŒ≤1 e‚àíŒ≥1 œÑ

pŒ≤2 e‚àíŒ≥2 œÑ

qŒ≤1 e‚àíŒ≥1 œÑ

qŒ≤2 e‚àíŒ≥2 œÑ

!

It is interesting to realize
that this is one of the cases where Aij (t, œÑ ) = Œ±i Aj (t, œÑ ), recalling that Aj (t, œÑ ) =

Therefore Œ± = p, q and we can factorize the matrix into A and Œ± as:
Ô£´
Ô£∂
  O Œ≤1 S e‚àíŒ≥1 œÑ
p
Ô£¨ N
Ô£∑
A = Œ±‚äóA =
Ô£≠
Ô£∏.
q
Œ≤2 S ‚àíŒ≥2 œÑ
e
N

(28)
P

i Aij (t, œÑ ).

(29)

5/19

h
i
Where ‚äó represents the tensorial product, Œ± ‚äó A = Œ±i Aj . Integrating A(t, œÑ ) in relation to œÑ we get:
R(t) =

Z

‚àû

0

S
A(t, œÑ )dœÑ =
N

Œ≤1 /Œ≥1
Œ≤2 /Œ≥2

!

(30)

.

Therefore, we proceed to the scalar product between Œ± and R:


S(t) Œ≤1
Œ≤2
R (t) = Œ± ¬∑ R =
p +q
.
N
Œ≥1
Œ≥2

(31)

T

When t ‚Üí 0, R0 = pŒ≤1 /Œ≥1 + qŒ≤2 /Œ≥2 . We realize that the total reproduction number is the sum of the reproduction
numbers of the two types of infection times the percentage of occurrence of each. Thus, we proceed to obtain the
distribution of the generation interval, which takes the form:
g T (œÑ ) =

pŒ≤1 e‚àíŒ≥1 œÑ + qŒ≤2 e‚àíŒ≥2 œÑ
.
Œ≤1 /Œ≥1 + Œ≤2 /Œ≥2

(32)

SIR-type meta-population model
In this section we consider a meta-population model that will be used in the main framework and is detailed at
Supplementary Material 2. Here we summarize the model. We consider the existence of ‚Äún‚Äù meta-populations with
coupled SIR-type dynamics. Where, due to the movement of individuals between meta-populations, an infected
compartment in one meta-population can influence the disease transmission process of all the others. The coupling
of the equations happens by the transmission rates Œªik related to the contamination process that emerges from the
flow of individuals. The SIR-type model for n meta-populations can be written as
n

X
dSi
=‚àí
Œªij (t) Ij (t) Si (t),
dt

(33)

j

n

dIi X
=
Œªij (t) Ij (t) Si (t) ‚àí Œ≥ Ii (t),
dt

(34)

j

dRi
=Œ≥Ii (t),
dt

(35)

in which Si (t), Ii (t) and Ri (t) correspond to the susceptible, infected and removed individuals that belong to the
meta-population ‚Äúi‚Äù. The Œªij parameter is related to the transmission between the meta-populations ‚Äúi‚Äù and ‚Äúj‚Äù,
see Supplementary Material 2. We assume that the recover rate Œ≥ is uniform for all meta-populations.The infected
compartments
are sorted as X(t) = [I1 (t), I2 (t), . . . , In (t)] and x(t, œÑ ) = [i1 (t, œÑ ), i2 (t, œÑ ), . . . , in (t, œÑ )], where it is clear
R‚àû
that X(t) = 0 x(t, œÑ )dœÑ . We proceed to identify Fi (t) and Vi (t, œÑ ) as
F (t) =

"

n
X

#

Œªij (t)Ij (t)Si (t) ,

j

"

#

V(t, œÑ ) = ‚àí Œ≥ ii (t, œÑ )

(36)

Therefore we get:
Ô£´

Œª11 S1
Ô£¨ Œª21 S2
Ô£¨
‚Ñ¶(t) = Ô£¨ .
Ô£≠ ..

Œªn1 Sn

Œª12 S1
Œª22 S2
..
.

...
...
..
.

Œªn2 Sn

...

Ô£∂
Œª1n S1
Œª2n S2 Ô£∑
Ô£∑
.. Ô£∑ ,
. Ô£∏

Œªnn Sn

Ô£´
Œ≥
Ô£¨
‚àÇV Ô£¨ 0
‚àí
= Ô£¨.
‚àÇx Ô£≠ ..
0

0
Œ≥
..
.
0

It is clear to see that ‚àí‚àÇV/‚àÇx is a diagonal matrix, such that
Œì(œÑ ) = e‚àíŒ≥œÑ I,

...
...
..
.
...

Ô£∂
0
0Ô£∑
Ô£∑
.. Ô£∑ .
.Ô£∏

(37)

Œ≥

‚àÇV
d
u(œâ) = ‚àí
u(œâ) are of trivial solution
dœâ
‚àÇx
(38)
6/19

where I represents the identity matrix of dimension ‚Äún‚Äù. Thus, when multiplying the matrices ‚Ñ¶ and Œì we arrive at:
h
i
A(t, œÑ ) = Œªik Si e‚àíŒ≥œÑ

(39)

#
Œªik Si
.
R(t) =
Œ≥

(40)

Integramos A de forma a obter a matriz de pr√≥xima gera√ß√£o do sistema R, dada por:
"

That leads to:
gij (œÑ ) = g(œÑ ) = Œ≥ e‚àíŒ≥ œÑ .

(41)

Whereby, if only one meta-population is considered, the SIR model results are recovered3 .
SEIIR-type meta-population model
Finally, we present a meta-population model related to the transmission dynamics of SARS-Cov-2 coronavirus. As
in the previous section, the meta-populations are connected by the commuter movement of individuals. In this
model, individuals that are infected have to pass through a latency period to become infectious, during that time,
we consider that those are in the exposed compartment E. After a mean latency period of 1/k, those infected can
become symptomatic or asymptomatic, I s and I a respectively. While in these compartments, the individuals of
‚Äúj‚Äù are able to generate new infected ones in ‚Äúi‚Äù based on the transmission rate Œªij . However, asymptomatic ones
are considered to have a lower transmissibility, thus, the transmission rate must be multiplied by a factor Œ¥ that
lowers it‚Äôs infectivity. The SEIIR model was developed by Oliveira in4 and in Supplementary Material 2 we derive
an SEIIR-type meta-population model that can be written as:
n
h
i
X
dSi
=‚àí
Œªij (t) Si (t) Ijs (t) + Œ¥Ija (t) Si (t),
dt

(42)

j

n
h
i
dEi X
=
Œªij (t) Si (t) Ijs (t) + Œ¥Ija (t) ‚àí Œ∫ Ei (t),
dt

(43)

j

dIis
=pŒ∫ Ei (t) ‚àí Œ≥s Iis (t),
dt
dIia
=(1 ‚àí p)Œ∫ Ei (t) ‚àí Œ≥a Iia (t),
dt
dRi
=Œ≥s Iis (t) + Œ≥a Iia (t).
dt

(44)
(45)
(46)

To proceed with the methodology, we sort the compartments as X = [E1 , ..., En , I1 a , ..., In a , I1 s , ..., In s ] and
x = [ie 1 , ..., ie n , is 1 , ..., in s , i1 a , ..., in a ] in a way that if there are n meta-populations we have 3n infected compartments.
Therefore, we obtain F (t) and V(t, œÑ ) as:
Fi (t) =

(P

n
j Œªij (t)

0,

h
i
Si (t) Ijs (t) + Œ¥Ija (t) ,

for i ‚â§ n
for i > n

Ô£±
Ô£¥
for i ‚â§ n
Ô£≤Œ∫ xi (t, œÑ ),
Vi (t, œÑ ) = Œ≥s xi (t, œÑ ) ‚àí pŒ∫ xi‚àín (t, œÑ ),
for n < i ‚â§ 2n
Ô£¥
Ô£≥
Œ≥a xi (t, œÑ ) ‚àí (1 ‚àí p)Œ∫ xi‚àí2n (t, œÑ ), for 2n < i

(47)

(48)

where Ijs = Xj+n and Ija = Xj+2n . Thus, from (47), we obtain:

7/19

Ô£´
0
‚Ñ¶(t) = Ô£≠0
0

‚Ñ¶s
0
0

Ô£∂
‚Ñ¶a
0 Ô£∏,
0

Ô£´
‚àíŒ∫
0
‚àÇV Ô£≠
pŒ∫
‚àíŒ≥s
‚àí
=
‚àÇx
(1 ‚àí p)Œ∫
0

Ô£∂
0
0 Ô£∏ ‚äó In .
‚àíŒ≥a

(49)

Whereby In is an n √ó n identity matrix andh‚äó is ai tensor product. Also, ‚Ñ¶ is divided into nine n √ó n submatrices,
where 0 is an all-zeroes n √ó n matrix, ‚Ñ¶s ‚â° Œªij Si and ‚Ñ¶a ‚â° Œ¥‚Ñ¶s . Solving the system of differential equations on
the characteristic line, we obtain:
Ô£´

Ô£¨
Ô£¨
Œì(œÑ ) = Ô£¨
Ô£¨
Ô£≠

e‚àíŒ∫œÑ


p Œ≥sŒ∫‚àíŒ∫ e‚àíŒ∫œÑ ‚àí e‚àíŒ≥s œÑ


(1 ‚àí p) Œ≥aŒ∫‚àíŒ∫ e‚àíŒ∫œÑ ‚àí e‚àíŒ≥a œÑ

Ô£∂

0

0

e‚àíŒ≥s œÑ

0

0

e‚àíŒ≥a œÑ

Ô£∑
Ô£∑
Ô£∑ ‚äó In .
Ô£∑
Ô£∏

(50)

We proceed into the multiplication of the matrices ‚Ñ¶ and Œì in order to obtain:
Ô£´ e
A
Ô£≠
0
A(t, œÑ ) =
0

As
0
0

Ô£∂
Aa
0 Ô£∏
0

(51)

whereby the submatrices are defined as:
"


e
A (t) ‚â° Œªij (t)Si (t) p



Œ∫  ‚àíŒ∫œÑ
Œ∫  ‚àíŒ∫œÑ
e
‚àí e‚àíŒ≥s œÑ + Œ¥(1 ‚àí p)
e
‚àí e‚àíŒ≥a œÑ
Œ≥s ‚àí Œ∫
Œ≥a ‚àí Œ∫

#
,

(52)

As ‚â° e‚àíŒ≥s œÑ ‚Ñ¶s and Aa ‚â° e‚àíŒ≥a œÑ ‚Ñ¶a . Therefore, the next generation matrix is
Ô£´ e
R
R(t) = Ô£≠ 0
0

where:

Rs
0
0

Ô£∂
Ra
0 Ô£∏
0

(53)

"


#
p
(1 ‚àí p)
R (t) ‚â° Œªij (t)Si (t)
+Œ¥
,
Œ≥s
Œ≥a
e

(54)

Because there is no generation of infected individuals on the symptomatic and asymptomatic compartments, the
expressions for Rs and Ra are not needed. This is so because Fi (t) for i > n is null for any time. Therefore, the
renewal equations of Fi (t) for i > n have the tautological result that zero equals zero, regardless of the values of Rs
or Ra . Thus, all we need to describe the dynamics is R for i, j ‚â§ n, that is Re . Lastly, we obtain the generation
interval distribution matrix for i, j ‚â§ n:
gij (œÑ ) ‚â° g(œÑ ) =

Œ¥(1‚àíp) a
p s
Œ≥s g (œÑ ) + Œ≥a g (œÑ )
,
Œ¥(1‚àíp)
p
Œ≥s + Œ≥a

(55)

for
g a (œÑ ) =

Œ∫Œ≥a
(e‚àíŒ∫œÑ ‚àí e‚àíŒ≥a œÑ ),
Œ≥a ‚àí Œ∫

g s (œÑ ) =

Œ∫Œ≥s
(e‚àíŒ∫œÑ ‚àí e‚àíŒ≥s œÑ ).
Œ≥s ‚àí Œ∫

(56)

Whereby, if only one meta-population is considered, we return to the results in literature4 .
8/19

Supplementary Material 2

Meta-population models formulation

9/19

Meta-population models formulation
In this Supplementary Material we will be, inspired by5 , developing a meta-population model that takes into account
the movement of individuals between meta-populations to describe the propagation of a disease through out multiple
municipalities . We will be interpreting the inter-municipal flow as a complex network where its nodes represent
municipalities and the weight of its edges represents the intensity of the flow between the connected municipalities.
We also consider that each municipality can be interpreted as a meta-population, with its own compartments
and parameters, which can be represented by a vector yi (t), where the index ‚Äúi‚Äù indicates the meta-population
portrayed.Each entry of yi (t) represents a compartment of this meta-population, such as yi (t) = Si (t), Ii (t), Ri (t)
in the case of a SIR model. In which Si (t), Ii (t) and Ri (t) correspond to the susceptible, infected and removed
individuals that are residents of the meta population "i", respectively. The sum of the elements of yi corresponds to
the number of individuals of the meta-population "i", in the SIR model we have Si (t) + Ii (t) + Ri (t) = Ni (t).
We can represent the amount of individuals that goes from the meta-population "i" to another meta-population "j"
each day as œïij , so it represents the flow of individuals between those meta-populations. Since each meta-population
is described from it‚Äôs compartments, we can describe the flow of those using yi (t) in
Flow from i to j = œïij (t)

yi
.
Ni

(57)

œï (t)

We define Œ¶ij (t) ‚â° ij
as the density of flow. In that way, Œ¶ij yi is the number of individuals from each
Ni
compartment class that are flowing from "i" to "j". It‚Äôs natural to see that sum of Œ¶ij yi for each compartment class
of yi is equal to œïij , in the SIR model for example: Œ¶ij Si + Œ¶ij Ii + Œ¶ij Ri = œïij .
Given that the meta-populations are connected through the flow , it is necessary to identify how they. For this
purpose, graphs are used which, in general, represent complex networks, given the large number of connections. To
represent networks, matrices are used, as in the case of adjacency matrices whose elements represent the density of
flow (Œ¶ij ). Thus, the values of each Œ¶ij (t) are the weight of the edges with a null value representing the absence of
an edge. Since there are no self interactions in this network, we do not consider the flow of a meta-population to
itself, thus œïii ‚â° 0 .
Due to the circulation of individuals through the network, the characteristics of the meta-populations will be
changed. Thus, we define the effective population of ‚Äúi‚Äù described by the vector ye, i = Se ,i (t), Ie ,i (t), Re ,i (t)
which corresponds to individuals located, at time t, in the ‚Äúi‚Äù meta-population regardless of their origin metapopulation.The effective population represents the new characteristics of a population due to the flow; for example, a
meta-population that does not have infected resident individuals may have carriers of the pathogen in their effective
population due to the flow from some other meta-population that presents infected individuals. We can write ye, i
as:

ye, i (t) =

z }| {
yi (t)

Inflow

Outflow

Resident Pop.

‚àí

}|
{
z
n
X
Œ¶ij yi (t)

+

j6=i

z
}|
{
n
X
Œ¶ji yj (t)

(58)

j6=i

For, N being the number of meta populations. Rearranging the equation:


ye, i (t) = yi (t) 1 ‚àí

n
X
j



Œ¶ij +

n
X

Œ¶ji yj (t)

(59)

j

clear then
from "i" that are in "i" ,
It‚Äôs P
 that the effective population of "i" is the sum of the individuals
Pn
n
yi 1 ‚àí j6=i Œ¶ij , with the individuals from other meta populations that are in "i", j6=i Œ¶ji yj . If we sum each
P
Pn
element of ye, i we have the effective population number: Ne, i = Ni ‚àí n
j6=i œïij +
j6=i œïji . It is important to
highlight that the resident population is not changed, therefore, we do not consider migration but only commuter
periodic movement, whereby the individuals of one meta-population go to another to work or study.
We now proceed in order to describe how the transmission of a disease occurs in a meta-population, taking
into account the flow of individuals in the network. We must then describe the occurrence of new infections in the
10/19

meta-population yi (t), which can occur within the ‚Äúi‚Äù meta-population
Susceptible Indv. from ‚Äúi‚Äù in ‚Äúi‚Äù

}|
{
n

X
Si 1 ‚àí
Œ¶ij

z

Œ≤i
√ó
Ni



Infected Indv. in ‚Äúi‚Äù

z}|{
Ie, i

√ó

j

(60)

,

or on another meta-population "j"

Œ≤j
√ó
Nj

Susceptible Indv. from ‚Äúi‚Äù in ‚Äúj‚Äù

z }| {
Œ¶ij Si

Infected Indv. in ‚Äúj‚Äù

√ó

z}|{
Ie, j

.

(61)

Œ≤i (t) and Œ≤j (t) being the transmission rates within the ‚Äúi‚Äù and ‚Äúj‚Äù meta-populations, respectively. The parameters
Œ≤i (t) and Œ¶ij (t) are time dependent, so we can incorporate the changes in the behavior of the populations on those
variables. Thus, the number of new infections of individuals that belong to ‚Äúi‚Äù, Fi (t), will be equal to the sum of
(60) and (61). We can substitute equation (59) in expressions (60) and (61), in order to expand the term of the
effective population of infected individuals(Ie ,i (t) ,Ie ,i (t)) and be able to express them according to the infected
residents in each meta-population. Carrying out these operations, we get to:

Fi (t) =

n
X

Œªij (t) Si (t)Ij (t)

(62)

j

For:
Œªii =

n
n
2 X
X
Œ≤j 2
Œ≤i 
1‚àí
Œ¶ij +
Œ¶
Ni
Nj ij
j

Œªij =

(63)

j

n
n
n


 Œ≤
 X
X
X
Œ≤i
Œ≤k
j
Œ¶ik Œ¶jk
Œ¶ji 1 ‚àí
Œ¶ij 1 ‚àí
Œ¶ik +
Œ¶jk +
Ni
Nj
Nk
k

k

(64)

k

The Œªij (t) are related to the transmission between individuals of the same meta-population and from individuals
of the ‚Äúj‚Äù meta-population to individuals of the ‚Äúi‚Äù meta-population.
SIR-Type model
In this section, we construct the set of equations for the SIR-type model based in the contamination process modeled
in this Supplementary Material. We will be modeling the resident populations of each municipality and will not be
considering migration, therefore, resident individuals of one meta-population will always remain residents of that
same meta-population. It is assumed that the susceptible population can only decrease due to infection process,
therefore, no life and death dynamic. In the same way, the removed individuals are only generated by a removing
rate Œ≥, uniform for all meta-populations. Gathering those considerations, we write the system of equations:
n

X
dSi
=‚àí
Œªij (t) Ij (t) Si (t),
dt

(65)

j

n

dIi X
=
Œªij (t) Ij (t) Si (t) ‚àí Œ≥ Ii (t),
dt

(66)

j

dRi
=Œ≥Ii (t).
dt

(67)

Where it is clear that when œïij = 0, for all i‚Äôs and j‚Äôs, each meta-population will be described by the classical
SIR homogeneous model. Of course, this SIR approach is not taking into account the other heterogeneities of a
disease besides space. On the following section we present a more sophisticated approach focused on the Covid-19
transmission dynamics.
11/19

A meta-population model for Covid-19 (SEIIR)
In this section, we establish a more precise description for the dynamics of SARS-Cov-2 coronavirus on the
municipalities network. To do so, we consider, as in4 , that the infected individuals can be separated in three classes:
the exposed E, individuals infected which are in the latency period and do not transmit the disease; the symptomatic
individuals I s , that are infectious, present a substantial amount of symptoms and are registered in the official data;
the asymptomatic/undetected ones I a , that are infectious but present mild/non-existing symptoms and are not
registered in the official data. The infected individuals always start in the exposed compartment, a portion p of them
eventually becomes symptomatic and the other (1 ‚àí p) portion becomes asymptomatic. Since we have two types of
infectious individuals, both of them must be taken in consideration in the generation of new infected. Therefore,
assuming that the asymptomatic individuals transmission rate is a fraction Œ¥ of the symptomatic transmission rate,
it is simple to derive, similarly to (60) and (61), the number of infected individuals that are generated on the exposed
compartment of each meta-population:

Fie (t) =

n
X
j

h
i
Œªij (t) Si (t) Ijs (t) + Œ¥Ija (t) .

(68)

Therefore, by the same assumptions presented on the previews section, the following model is obtained:
n
h
i
X
dSi
=‚àí
Œªij (t) Si (t) Ijs (t) + Œ¥Ija (t) Si (t),
dt

(69)

j

n
h
i
dEi X
=
Œªij (t) Si (t) Ijs (t) + Œ¥Ija (t) ‚àí Œ∫ Ei (t),
dt

(70)

j

dIis
=pŒ∫ Ei (t) ‚àí Œ≥s Iis (t),
dt
dIia
=(1 ‚àí p)Œ∫ Ei (t) ‚àí Œ≥a Iia (t),
dt
dRi
=Œ≥s Iis (t) + Œ≥a Iia (t).
dt

(71)
(72)
(73)

Whereby Œ∫, Œ≥s and Œ≥a are the removing rate of the exposed, symptomatic and asymptomatic compartments,
respectively, and are uniform in all meta-populations.

12/19

Supplementary Material 3

Expressions and parameter values for evaluating
R(t) for the meta-population models

13/19

Expressions for evaluating R(t) using incidence data

Here, we derive the expressions and parameter values needed to estimate the reproduction numbers for the metapopulation models. Firstly, we start by substituting the explicit expressions of the reproduction numbers of each
model in the equation 2.24 of the main framework. After some straightforward calculations, we obtain:

Qi (t) =

n
X

Œªij (t)aj (t).

(74)

j

whereby, Qi (t) = Bi (t)/Si (t) and
aj =

t
X
1
g(œÑ )‚àÜt
Œ≥

(75)

œÑ =0

for the SIR model and

aj =

t h
X
Œ¥(1 ‚àí p) i
p
+
g(œÑ )‚àÜt
Œ≥s
Œ≥a

(76)

œÑ =0

for the SEIIR model. We consider that the Bi (t) is the collection of all the new infections during a ‚àÜt time interval
of 1 day. With appropriate units of measure, we have ‚àÜt = 1. In the SIR model we consider that every infection is
reported, œÅi = 1 and in the SEIIR case only the symptomatic individuals report their infections, œÅi = p. We proceed
into estimating the susceptible population. If we integrate (65) and substitute (62) and equation 2.23 of the main
framework, we get:

Si (t) = Ni ‚àí

t
X
Bi (t0 )
.
œÅi
0

(77)

t =0

Finally, substituting (63) and (64) in (74) results in:

Qi (t) =

n
X

Œòij (t)Œ≤j (t),

(78)

j

for:
"
#
n
n
n

2 X


X
X
1
ai 1 ‚àí
œïik +
aj œïji 1 ‚àí
œïik ,
Œòii =
Ni
j
k
k
"
#
n
n


X
X
1
ak œïkj .
Œòij =
aj œïij 1 ‚àí
œïjk + œïij
Nj
k

(79)
(80)

k

Therefore value of Qi (t) and Œ∏ij for each day can be obtained using the reported data and parameters. Thus, for
each day, this leaves us with algebraic system of ‚Äún‚Äù variables, Œ≤j (t) and ‚Äún‚Äù equations. We can analytically solve
this system for every meta-population, with the help of a computer algorithm, and obtain the daily values of Œ≤j (t)
of every meta population. Substituting the values of every Œ≤j (t) in (63) and (64), we can compute the values of
the Œªi j(t)‚Äôs which leads us to the values of the reproduction number, equations 3.1 and 3.2 of the main framework.
Since the available data is of daily number of cases, the R(t) is evaluated for each calendar day.
14/19

Parameters
To estimate the Œ≤i (t) parameters, and consequently estimate the reproduction numbers, the parameters of both
models must be obtained. Œ¥, Œ≥a , Œ≥s , p, and Œ∫ are estimated for the state of Rio de Janeiro in6 and can be found
on Table 1. Additionally, in the SIR type model we assume Œ≥ = Œ≥s . The intermunicipal commuter movement of
workers and students for the cities of Brazil, œïij , can be found in a study conducted by IBGE (Brasilian Institute of
Geography and Statistics)7 .
Supplementary Table 1. Key epidemiological parameters of the SEIIR model obtained in6 .
Parameter
Œ¥
p
Œ∫‚àí1
Œ≥a‚àí1
Œ≥s‚àí1

Description
Asymptomatic/non-detected infectivity factor
Proportion of latent (E) that proceed to symptomatic infective
Mean exposed period (days‚àí1 )
Mean asymptomatic period (days‚àí1 )
Mean symptomatic period (days‚àí1 )

Value
0.258
0.273
1/0.25
1/0.288
1/0.25

15/19

Supplementary Material 4

Additional information about the municipalities

16/19

Additional information about the municipalities

Municipality
Belford Roxo
Duque de Caxias
Mag√©
Mesquita
Nil√≥polis
Niter√≥i
Nova Igua√ßu
Queimados
Rio de Janeiro
S√£o Gon√ßalo
S√£o Jo√£o de Meriti

Acronyms
BR
DdC
Ma
Mq
Ns
Nt
NI
Q
RJ
SG
SJdM

Populational size
485,687
905,129
242,113
800,835
154,749
497,883
167,287
150,333
6,592,227
1,075,372
448,340

Total reported cases
8,578
8,736
3,539
1,351
1,245
12,165
5,908
2,376
95,444
11,601
3,167

Supplementary Table 2
Supplementary Table 3. The selected cities of the state of Rio de Janeiro in the Southeast of Brazil with their
acronyms, number of inhabitants, and the reported COVID-19 cases until September 14th (2020). In bold, the
capital (Rio de Janeiro).

Supplementary Figure 1. Distribution of cases by the chosen cities of this study.
17/19

DdC

BR

q

SG

M

Q

NI

Ma

RJ

dM

SJ

Nt

Ns
Supplementary Figure 2. Average daily commuter movement between municipalities, due to workplaces. The
thickness of each line is proportional to the amount of movement from one municipality to another. Colors are used
only for the purpose of better visualization and have no specific meaning.

18/19

Supplementary References
A contribution to the mathematical theory of epidemics.
1. Kermack, W. O. & McKendrick, A. G.
Proceedings of the Royal Society of London (Series A) 115, 700‚Äì721 (1927).
2. Champredon, D., Dushoff, J. & Earn, D. J. Equivalence of the erlang-distributed seir epidemic model and the
renewal equation. SIAM Journal on Applied Mathematics 78, 3258‚Äì3278 (2018).
3. Nishiura, H. & Chowell, G. The effective reproduction number as a prelude to statistical estimation of timedependent epidemic trends. In Mathematical and statistical estimation approaches in epidemiology, 103‚Äì121
(Springer, 2009).
4. Oliveira, J. F. et al. Mathematical modeling of covid-19 in 14.8 million individuals in bahia, brazil .
5. Miranda, J. G. V. et al. Scaling effect in covid-19 spreading: The role of heterogeneity in a hybrid ode-network
model with restrictions on the inter-cities flow. Physica D: Nonlinear Phenomena 415, 132792 (2021).
6. Jorge, D. C. et al. Assessing the nationwide impact of covid-19 mitigation policies on the transmission rate of
sars-cov-2 in brazil. medRxiv (2020).
7. IBGE. Arranjos populacionais e concentra√ß√µes urbanas no brasil (2016).

19/19

20/19

