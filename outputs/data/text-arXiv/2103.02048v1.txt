A Flexible Rolling Regression Framework for Time-Varying SIRD models:
Application to COVID-19
Javier Rubio-Herrero1,‚àó, Yuchen Wang1

arXiv:2103.02048v1 [q-bio.PE] 2 Mar 2021

Department of Information Technology and Decision Sciences, G. Brint Ryan College of Business, University of North Texas,
1155 Union Circle, Denton, TX 76201

Abstract
The present paper introduces a data-driven framework for describing the time-varying nature of an SIRD
model in the context of COVID-19. By embedding a rolling regression in a mixed integer bilevel nonlinear programming problem, our aim is to provide the research community with a model that reproduces
accurately the observed changes in the number of infected, recovered, and death cases, while providing
information about the time dependency of the parameters that govern the SIRD model. We propose this optimization model and a genetic algorithm to tackle its solution. Moreover, we test this algorithm with 2020
COVID-19 data from the state of Minnesota and found that our results are consistent both qualitatively
and quantitatively, thus proving that the framework proposed is an effective an flexible tool to describe the
dynamics of a pandemic.
Keywords: OR in health services, Epidemiology models, COVID-19, Rolling regression, Metaheuristics

1. Introduction
In December 2019, an outbreak of viral pneumonia of unknown origin occurred in Wuhan, Hubei
Province, China. A new type of coronavirus by the name of 2019 Novel Coronavirus (COVID-19) was
isolated from the confirmed patients. COVID-19, a single-stranded RNA virus of the genus Œ≤, is characterized by a long incubation period and high contagiousness. Common symptoms after infection include
cough, fever, diarrhea, and difficulty breathing (Capano et al., 2020).
Shortly after the outbreak in China, COVID-19 spread throughout the whole world and became a pandemic. By the end of 2020, the total number of confirmed cases of infections reached 100 million globally,
‚àó

Corresponding author
Email addresses: javier.rubioherrero@unt.edu (Javier Rubio-Herrero ), Yuchen.Wang@unt.edu (Yuchen
Wang)
Preprint submitted to XXXX

March 4, 2021

whereas 1.8 million people worldwide had died as a consequence of this pandemic, including 350,000 in the
United States (John Hopkins University). It is well known that the main transmission route of COVID-19 is
by droplets and close contact, but it is also possible that it can be contracted via aerosol transmission. Amidst
the fight against this pandemic, various countries and regions have introduced policies to curb its spread.
Measures such as confinements, stay-at-home orders, remote work, face masks, as well as other policies for
controlling and preventing further spread within and among communities, have become common.
COVID-19 is the second pandemic of the XXI century after the H1N1 pandemic of 2009. After the
Spanish flu that in 1918 caused between 20 and 40 million casualties all over the world (Trilla et al., 2008,
World Health Organization, 2005a), the current pandemic has been the most severe in the last century and
a half. Since its outbreak, countries worldwide have faced shortages in testing capacity, lack of effective
drugs, and insufficient knowledge to handle and control COVID-19, especially during the early stages of
the pandemic. As a consequence, countries have struggled seriously with keeping their healthcare systems
and facilities under maximum capacity. Moreover, COVID-19 has also taken a heavy toll on the global
economy. For example, in the United States, the unemployment rate soared temporarily to 14.8% shortly
after the outbreak (Congressional Research Service, 2021), the highest since the Great Depression that
started in 1929.
As in other pandemics, the battle against COVID is being fought on several fronts: immunization,
treatment, isolation, and training (Laarabi et al., 2013). Due to progress in the clinical understanding of the
disease and the increasing experience gained in treating this virus, mortality rates had dropped by the time
2020 came to an end. Also, as this manuscript is being written, immunization efforts have already started
worldwide. While there is a common goal in keeping the spread of this contagious virus at bay, vaccination
policies vary amongst countries, albeit it is the norm that especial priority is given to healthcare workers,
older people, and to those that, because of preexisting conditions, fall within a group of risk (World Health
Organization, 2005b).

2. Background on mathematical modeling in epidemiology
Mathematical models have lied historically in the heart of epidemiology analysis. Kermack and McKendrick (1927) studied the epidemics of Black Death in London and the plague in Mumbai in 1906 using a
revolutionary susceptible-infected-removed (SIR) model that identified population dynamics with the evolution of these epidemics:
2

dS (t)
dt
dI(t)
dt
dR(t)
dt

S (t)I(t)
,
N
S (t)I(t)
= Œ≤
‚àí Œ≥I(t),
N
= ‚àíŒ≤

= Œ≥I(t),

Where S (t), I(t), R(t) indicate the number of individuals that are susceptible, infected, and recovered
at time t, respectively, and N is the total population under study. The parameter Œ≤ ‚â• 0 represents the
average number of contacts of an infected individual per unit of time, multiplied by the probability of
disease transmission. Œ≥ ‚â• 0 is the proportion of infected individual that recover from the disease (per unit
of time). With these models came the well-known threshold theory, supported by the definition of a basic
reproduction number, which aims to describe whether a disease is prevalent or receding.
Since this seminal work, countless research efforts have been made in this area, very often with highly
accurate descriptive and predictive results. Thus, it does not come as a surprise that these models have been
used for forecasting the likelihood and severity of the COVID-19 pandemic. Examples of recent works are
Wangping et al. (2020), Kucharski et al. (2020), Yang et al. (2020), Fanelli and Piazza (2020), Xue et al.
(2020), Postnikov (2020), Li et al. (2020) and Cooper et al. (2020), to name a few.
In general, well-known extensions of the original SIR model can be consulted in Hethcote (1989, 2000,
2009) and Weiss (2013). While a detailed description of the many known variations of the basic SIR
model is out of the scope of this paper, we will mention several that have been proposed in the context of
COVID-19. For example, Giordano et al. (2020) further expanded the SIR model to a SIDARTHE model
considering diagnosed, ailing, and dead cases, and found the prediction rates fitted the actual rates after
lockdown or social distancing order issued by local government. Even models with more compartments
have been used (Ndairou et al., 2020). However, as commented in Roda et al. (2020), more complicated
models do not necessarily yield better results. As a matter of fact, Ifguis et al. (2020) predicted accurately
COVID-19 cases in Morocco with a simulation based on an SIR model. Croccolo and Roman (2020), on the
other hand, presented a percolation-type model based on an SIR model that aimed at mimicking the effect
of lockdowns in the United States. In any case, most epidemiology models of this sort are complicated to
solve analytically and it is common to resort to simulation or other techniques to attain solutions(e.g., the
work by Khoshnaw et al. (2017) with Elzaki transforms).
The model‚Äôs parameters play an essential role in characterizing the evolution of a disease in the frame3

work of SIR or SIR-related models. For this reason, their study has brought the attention of many researchers. In many instances, these parameters are hypothesized based on previous experience or assumptions. This is the case in Simha et al. (2020), where a standard SIR model is modified with a Brownian
motion to demonstrate the randomness of the virus spread. On other occasions, the parameters are inferred
from available data. For example, Postnikov (2020) fitted the parameters of a simple SIR model using actual
data to demonstrate that these models are applicable in this context (very much in line with what Roda et al.
(2020) suggested).
The basic SIR model introduced above uses constant parameters or rates. However, there are timedependent epidemiology models that allow their rates to be a function of time. This enhances these models‚Äô
flexibility, but it also introduces additional complexity in estimating these rates. Despite this hindrance,
these time-dependent models are commonly used. There exist analytic methods by which it is possible to
obtain time series that represent the model parameters. However, these methods rely on assumptions that
might not always hold. For example, Zhong et al. (2020), and Waqas et al. (2020) assume that the number
of infected people is negligible concerning the number of susceptible individuals. While this is reasonable
during the early stages of a pandemic, it can be questioned later.
Most of the data-driven approaches that aim at inferring the model‚Äôs parameters resort to some fitting
method. Such is the case of Yang et al. (2016), who built a time-dependent SIR model of the Dengue
virus to fit coefficients of transmission over four different time periods. In the context of COVID-19, this
was also done by Teles (2020) when the authors divided the time series in periods of 5 days according to
the virus incubation period and fitted the parameters of their model accordingly. In Godio et al. (2020),
the authors used a metaheuristic approach to fit the parameters of a susceptible-exposed-infected-recovered
(SEIR) model to predict the evolution of the current pandemic in Italy and compare it with Spain and
South Korea. Some other works assume that the model parameters can be characterized by finite impulse
responses (FIRs) and employ ridge regression to find the coefficients of these responses (Chen et al., 2020)
or can be found by using a linear combination of basis functions whose parameters are fitted with sparse
identification techniques (Calafiore et al., 2020). Black-box models like deep neural networks have also
found their application in this field and can be used to find how these parameters change over time, although
inherent to the use of these methods is the fact that closed-form equations are not attained (Jo et al., 2020).
Rolling regression is a time-series modeling technique that is often used in finance and economics
(Fabozzi and Markowitz, 2011, Dunis et al., 2004, Zanin and Marra, 2012). It finds applicability in contexts

4

where regression coefficients fluctuate over time and substitute a static regression approach for a dynamic
method. This increases the flexibility of the regression model and improves its capacity for prediction.
Rolling regression requires selecting a window size that is rolled over time in steps of, typically, one time
period. This window size determines how many data points are selected for evaluating the regression coefficients. When rolled, the regression analysis is updated, and so are the corresponding coefficients. Despite
its convenience for time-series analysis, rolling regression has not received much attention in epidemiology,
in general, and in the study of the current pandemic, in particular. An exception to which we will frequently
refer throughout this paper is Anastassopoulou et al. (2020). However, we believe that the highly-contagious
COVID-19 virus and its shifts in latency and symptoms appearance for different groups make rolling regression an appealing alternative for modeling purposes.
The rolling regression used in Anastassopoulou et al. (2020) is performed with a window of 6 days and,
like Zhong et al. (2020) and Waqas et al. (2020), they assume that the total population can approximate
the number of susceptible individuals. This assumption facilitates the analysis in the early stages of the
pandemic but seems insufficient for characterizing its dynamics later. Also, Anastassopoulou et al. (2020)
rightfully acknowledges that the observed infected and recovered individuals are just a fraction of the actual
ones and carry their study under two separate and predefined scenarios; these fractions vary. Calafiore et al.
(2020) assume that these fractions are equal to each other and other fraction of deceased individuals and
calculate this value by gridding.
Inspired by the models presented by Calafiore et al. (2020), and Anastassopoulou et al. (2020), the
present paper introduces an approach that could be considered a ‚Äúhybrid‚Äù of these two. On the one hand,
we propose a time-varying model where we estimate the parameters of a susceptible-infected-recovereddeceased (SIRD) model via rolling regression with a window size that is not fixed beforehand; on the other
hand, our SIRD model also considers that the observed infected, recovered, and deceased individuals are
fractions of the actual numbers, but we do not assume that these fractions have the same value. Instead, we
opt for an optimization framework in which the data in hand determine these parameters (i.e., fractions and
window size). Thus, this paper addresses a descriptive effort whose goals we summarize below:
1. To provide researchers with a general, data-driven, and flexible framework for modeling the dynamics
of this pandemic. This framework is constituted by a mixed integer bilevel nonlinear programming
(MIBNLP) model in which a rolling regression is the lower-level (or follower) optimization problem.
This MIBNLP derives empirically (i.e., based on the data available) the proportions of the actual
5

number of individuals in each state (S, I, R, D) that our data represent and the optimal window size
such that the SIRD model fits these data in the most accurate manner. We will approach the solution
of this problem with a genetic algorithm.
2. We test our algorithm to solve the proposed MIBNLP with 2020 data from the state of Minnesota,
in the United States. The optimization model will yield time series of the parameters of the SIRD
model. We will analyze these results both qualitatively and quantitatively. The qualitative assessment
will explain the evolution of the obtained time-varying parameters of the SIRD model given the
government policies in this state. The quantitative assessment will study the sensitivity of our results
against a parameter of the MIBNLP model that controls the smoothness of the resulting time series.
We will also compare the summary statistics of these time series with previously published works.
The rest of this paper is organized as follows: in Section 3 we introduce our selected epidemiology
model, the optimization problem in which the rolling regression is embedded, and we introduce our solution
approach; next, we discuss our results in Section 4; finally, we wrap up this work with our conclusions in
Section 5.

3. Rolling regression framework for obtaining time-dependent parameters of the SIRD model
3.1. The epidemiology model
Following Calafiore et al. (2020), we carry our analysis with a time-dependent susceptible-infectedrecovered-deceased (SIRD) model:

dS (t)
dt
dI(t)
dt
dR(t)
dt
dD(t)
dt

S (t)I(t)
,
(S (t) + I(t))
S (t)I(t)
= Œ≤(t)
‚àí Œ≥(t)I(t) ‚àí ¬µ(t)I(t),
(S (t) + I(t))
= ‚àíŒ≤(t)

(1)
(2)

= Œ≥(t)I(t),

(3)

= ¬µ(t)I(t),

(4)

where S (t), I(t), R(t), D(t) denote the number of susceptible, infected, recovered, and deceased individuals
over time, respectively. The time-varying parameters Œ≤(t), Œ≥(t) ‚â• 0 have the same meaning described for the
classic SIR model (see Section 2) and ¬µ(t) ‚â• 0 is the proportion (per unit time) that an infected individual
.
dies as a consequence of the disease. Let us define the vector of variables y(t) = [S (t), I(t), R(t), D(t)]T and
6

.
its time-derivative yÃá(t) = dy(t)/dt. Since we disregard the effect of births and deaths due to causes other
than COVID-19, it is implicit in the formulation above that yÃá(t) = 0, t = 1, . . . , T, and thus we assume that
the population of individuals, N, remains constant throughout the time of study. For a given number of
infected, recovered, and deceased people at time t, the number of susceptible individuals can be calculated
straightforwardly as S (t) = N ‚àí I(t) ‚àí R(t) ‚àí D(t). Therefore, when the states and their change over time are
known, the time-dependent parameters Œ≤(t), Œ≥(t), ¬µ(t) can be estimated empirically with equations (1)-(4). If
.
we define the vector of parameters Œ∏(t) = [Œ≤(t), Œ≥(t), ¬µ(t)]T , these equations can be re-written in matrix form
as a system of linear equations, yÃá(t) = A(t)Œ∏(t), where
Ô£Æ
Ô£ØÔ£ØÔ£Ø‚àí S (t)I(t)
Ô£ØÔ£ØÔ£Ø (S (t)+I(t))
Ô£ØÔ£ØÔ£Ø S (t)I(t)
Ô£ØÔ£ØÔ£Ø
A(t) = Ô£ØÔ£ØÔ£ØÔ£Ø (S (t)+I(t))
Ô£ØÔ£ØÔ£Ø
0
Ô£ØÔ£ØÔ£Ø
Ô£ØÔ£ØÔ£∞
0

Ô£π
0 Ô£∫Ô£∫Ô£∫Ô£∫
Ô£∫Ô£∫Ô£∫
Ô£∫
‚àíI(t) ‚àíI(t)Ô£∫Ô£∫Ô£∫Ô£∫
Ô£∫Ô£∫Ô£∫ .
Ô£∫
I(t)
0 Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫
Ô£∫Ô£∫Ô£∫
0
I(t) Ô£ª
0

However, in reality, the actual number of infected, recovered, and deceased individuals is not accurately
known. Therefore, using directly the observed individuals in each state in the SIRD model will result in
important inaccuracies when estimating the rates of the model. Chen et al. (2020) or Anastassopoulou et al.
(2020) already addressed this issue in the context of COVID-19 (the former with an analytical approach;
the latter in a more empirical fashion). In this work, we propose a generalization of the solution proposed
by Calafiore et al. (2020), who assumed that the data collected represents a fraction of the actual data.
However, these authors assume that this proportion is the same for all states, namely, S (t), I(t), R(t) and
D(t). Our approach suggests different proportions that need to be estimated based on the data available.
.
Let us define Œ±X , X = I, R, D as the proportions of the actual individuals in each compartment that are
observed by our data, with 0 ‚â§ Œ±X ‚â§ 1. Then the observed stocks can be defined as XÃÉ = Œ±X X Further, we
.
.
define SÃÉ = Œ±S S , with 0 ‚â§ Œ±S ‚â§ 1.The four proportions can be included in a vector ŒΩ = [Œ±S , Œ±I , Œ±R , Œ±D ]T .
.
Àô =. dyÃÉ(t)/dt, our linear system of equations can be
Àú RÃÉ(t), DÃÉ(t)]T = and yÃÉ(t)
Hence, letting yÃÉ(t) = [SÃÉ (t), I(t),
Àô = AÃÉ(t, ŒΩ)Œ∏(t), where
reformulated as yÃÉ(t)
Ô£Æ
Àú
SÃÉ (t)I(t)
Ô£ØÔ£ØÔ£Ø‚àíŒ±
Àú
Ô£ØÔ£ØÔ£ØÔ£Ø S (Œ±I SÃÉ (t)+Œ±S I(t))
Ô£ØÔ£ØÔ£Ø
Àú
SÃÉ (t)I(t)
Ô£ØÔ£Ø Œ±I
Àú
AÃÉ(t, ŒΩ) = Ô£ØÔ£ØÔ£ØÔ£Ø (Œ±I SÃÉ (t)+Œ±S I(t))
Ô£ØÔ£ØÔ£Ø
0
Ô£ØÔ£ØÔ£Ø
Ô£ØÔ£ØÔ£∞
0
7

0
Àú
‚àíI(t)
Œ±R Àú
Œ±I I(t)

0

Ô£π
0 Ô£∫Ô£∫Ô£∫Ô£∫
Ô£∫Ô£∫Ô£∫
Ô£∫
Àú
‚àíI(t) Ô£∫Ô£∫Ô£∫Ô£∫
Ô£∫Ô£∫Ô£∫ .
Ô£∫
0 Ô£∫Ô£∫Ô£∫Ô£∫Ô£∫
Ô£∫Ô£∫
Œ±D Àú Ô£∫Ô£ª
I(t)
Œ±I



Àú
Note that given values for Œ±S , Œ±I , Œ±R , and Œ±D , we can calculate SÃÉ (t) = Œ±S N ‚àí I(t)/Œ±
I ‚àí RÃÉ(t)/Œ±R ‚àí DÃÉ(t)/Œ±D .
The definition and usage of Œ±S is merely formal and it lacks meaning, since there is not such as thing as
observed susceptible stock versus actual susceptible stock. However, its addition will act as a ‚Äúnormalizer‚Äù
that will reduce the order of magnitude of S (t) and help in the fitting process that will be introduced shortly.
We will discuss this further in Section 4. Since the data available were collected daily (i.e., at discrete
Àô can be expressed in the form of variations or changes and thus we will work with the
intervals of time), yÃÉ(t)
following system of equations:
‚àÜyÃÉ(t) = AÃÉ(t, ŒΩ)Œ∏(t),

(5)

where ‚àÜ(¬∑) = (¬∑)(t) ‚àí (¬∑)(t ‚àí 1).
3.2. The rolling regression framework
We propose a rolling regression framework that solves Equation (5) for the vector Œ∏(t) in the leastsquares sense by applying multivariate multiple regression. The rolling regression takes place with a window size w and a step of one unit of time (i.e., one day). If we have data for the period t = 1, . . . , T , the
result of this approach will be a series of vectors Œ∏ÃÇ(t), t = w, w + 1, . . . , T . The proposed framework is characterized for its flexibility since we look for the window size and the vector of proportions ŒΩ that provide
the best fit for a given set of data. We will work with an optimization problem that can be cast as follows:

min
ŒΩ, w

T
T
X
1 X ÀÜ
k‚àÜ yÃÉ(t, ŒΩ) ‚àí ‚àÜyÃÉ(t)k2 + Œª
k‚àÜŒ∏ÃÇ(t, ŒΩ)k2
T ‚àí w t=w
t=w+1

(6a)

s.t.

ÀÜ ŒΩ) = AÃÉ(t, ŒΩ)Œ∏ÃÇ(t, ŒΩ),
‚àÜ yÃÉ(t,

(6b)

t = w, . . . , T,

0 ‚â§ŒΩ ‚â§ 1,

(6c)

wmin ‚â§w ‚â§ wmax ,

(6d)

w ‚àà Z+ ,

(6e)

Œ∏ÃÇ(t, ŒΩ) = arg min
Œ∏‚â•0

t
X
œÑ=t‚àíw

kAÃÉ(œÑ, ŒΩ)Œ∏ ‚àí ‚àÜyÃÉ(œÑ)k22 , t = w, . . . , T

(6f)

The optimization problem defined by equations (6a)-(6f) is a mixed integer bilevel nonlinear problem
(MIBNLP) with T ‚àí w lower-level problems corresponding to all the multivariate multiple regressions that
conform our rolling regression over the time of study. It aims at minimizing the average difference between
the variations in the compartments as calculated with the least-squares time series of parameters Œ∏ÃÇ(t, ŒΩ),
8

ÀÜ ŒΩ), and the variations in the states as given by our data, ‚àÜyÃÉ(t). The calculation of the vectors ‚àÜ yÃÉ(t,
ÀÜ ŒΩ)
‚àÜ yÃÉ(t,
takes place in constraint (6b) which, in turn, uses the vectors Œ∏ÃÇ(t, ŒΩ) that solve the multivariate multiple
linear regression problem specified in constraint (6f). Note that the parameters Œ∏ÃÇ(t, ŒΩ) fitted for the window
ÀÜ ŒΩ). Hence, there are T ‚àí w vectors ‚àÜ yÃÉ(t,
ÀÜ ŒΩ) (i.e., T ‚àí w vectors Œ∏ÃÇ(t, ŒΩ))
{t ‚àí w, t} are used to calculate ‚àÜ yÃÉ(t,
and T vectors ‚àÜyÃÉ(t).
This optimization model looks for the optimal vector of proportions and the optimal window size to
perform those regressions. The latter is set to be an integer between two bounds defined by the modeler,
wmin and wmax . In this application, we expect wmin to be a small integer (we will see that in our case, we
set wmin = 5) and, in these circumstances, the first term in Equation (6a) will most likely find smaller errors
in smaller windows. This results in optimal values of w trivially equal to wmin . The downside is that it
also results in very noisy time series for Œ∏ÃÇ(t, ŒΩ), as these parameters will be calculated based on just a few
observations. Therefore, they are very sensitive to the updates that take place when the window is rolled. To
avoid this, the objective function (6a) incorporates a second term that penalizes sudden increments in Œ∏ÃÇ(t, ŒΩ)
with a penalty factor Œª. It is the modeler‚Äôs decision to tune this parameters in order to find a compromise
between the quality of the fit and the smoothness of the time series defined by the vectors Œ∏ÃÇ(t, ŒΩ).
3.3. Solution approach
In order to solve the MIBNLP above we opted for a real-valued genetic algorithm (DreÃÅo et al., 2006,
Haupt and Ellen Haupt, 2004). The individuals in our metaheuristic are vectors [ŒΩ, w] (see Figure 1). For a
given individual that is feasible for the constraints (6c)-(6e), there are T ‚àíw multivariate multiple regressions
that can be run (corresponding to the T ‚àí w lower-level optimization problems), to obtain the time series of
the parameters of the SIRD model. Then, a series of T ‚àí w vectors of predicted variations can be calculated
directly according to constraint (6b).

Figure 1: Structure of an individual in the genetic algorithm

How modelers set the parameters of a genetic algorithm depends largely on their experience and the
application in hand. Aiming at finding an equilibrium between population diversity and time for convergence to a solution, we followed the recommendation given in Storn and Price (1997) and set the initial
9

population size to 10 times the number of elements in an individual (i.e., we selected a size of 50 for our
first generation of individuals). For the crossover stage, individuals were selected randomly in pairs. When
it comes to the elements in ŒΩ, for each pair of individuals crossed over, the resulting offspring was generated
with the average of each parent‚Äôs values. For the value of w, an integer value between the parents‚Äô values of
w was drawn randomly according to a discrete uniform distribution. With 50 individuals in each generation,
we produced an offspring of size 25, where each child was then allowed to mutate in the range of [0, 1] for
each element of ŒΩ and in the set {wmin , wmin + 1, ¬∑ ¬∑ ¬∑ , wmax } for w. After attempting different mutation rates,
an acceptable equilibrium between the heterogeneity of the population and convergence was obtained with
a probability of mutation of 0.2. From the pool of parents and children, the best 50 advanced to the next
generation. Therefore, we followed a best-in-class selection that guaranteed that the fitness function‚Äôs value
was non-decreasing as generations passed. This fitness function was chosen to be Equation (6a). After a
minimum of 40 generations, if for 10 consecutive generations, the difference in the fitness of the best individuals of two consecutive generations was smaller than a threshold  = 10‚àí6 , then the genetic algorithm
was halted. Abusing of notation, the best solution thus far was declared as ‚Äúoptimal‚Äù, even though it is clear
that such claim is highly unlikely when working with metaheuristics. A graphical representation of this
algorithm is presented in Figure 2.

Figure 2: Generation of individuals in the genetic algorithm

10

4. Results
4.1. Quantitative Analysis of the Results
The framework proposed by the optimization problem (6a)-(6f) was tested with COVID-19 data from
Minnesota. These data, which covered the period between April and December of 2020, consisted of daily
numbers on infected, recovered, and dead individuals and was retrieved from The COVID Tracking Project
(The Atlantic Monthly Group, 2021) (see Figure 3). The time series collected was smoothed with a 5-day
average to dampen the usual noise introduced when new data are entered long after the number of infected,
recovered, and dead people have changed. This happens especially on Mondays when databases usually
record changes that occurred during the weekend.

Figure 3: 5-day average of the number of infected, recovered, and dead individuals as consequence of COVID-19 in Minnesota

We solved several instances of the MIBNLP problem as to assess the impact of the penalty parameter
Œª on the model‚Äôs solution. Starting with Œª = 0, we increased its value until the weight of the penalty term
was sufficiently important to steer the optimal value of w, w‚àó , away from wmin . This lower bound was set
to wmin = 5. This was similar to the window of 6 days used by Anastassopoulou et al. (2020). We did not
set wmin to a lower value in order to avoid trivial regressions, but we allowed for a sufficiently wide range
of options by setting wmax = 30.
When testing for different values of the penalty parameter, we found that the time-series of Œ≤(t), Œ≥(t), ŒΩ(t)
were smoother as Œª increased. This behavior was expected, as the penalty term in (6a) increases with Œª.
Smoother functions are attained when windows are larger because the changes incurred in the data used for
the regression every time the window is rolled tend to have a smaller impact as the sample size increases.
The results are shown in Figure 4 where, the higher Œª, the higher the optimal window size. Note that
11

different window sizes produce curves with different time lags.

Figure 4: Effect of different penalty parameters on the fitted time series of parameters

The time series of Œ≤(t), Œ≥(t), and ¬µ(t) that resulted from solving the optimization model (6a)-(6f) (i.e.,

12

Œ∏ÃÇ(t, ŒΩ‚àó )) were substituted in Equation (6b),
ÀÜ ŒΩ‚àó ) = AÃÉ(t, ŒΩ‚àó )Œ∏ÃÇ(t, ŒΩ‚àó ),
‚àÜ yÃÉ(t,

t = w, . . . , T,

and compared with our actual time series of state variations, ‚àÜyÃÉ(t). Figure 5 shows our results for a moderate
value of Œª (Œª = 300). By moderate we mean a value that yielded an optimal window size that was not very
close to neither wmin nor wmax . We show that the best solutions obtained for Œª = 300 produced time series
of variations of the states of the model that followed the data quite accurately. We observe better predictions
until the second half of November, followed by period of less accuracy characterized by sudden changes in
the data. Note that the variations in the number of recovered and deceased people are always non-negative.
This is because both states are terminal states, meaning that the stock in these states in non-decreasing over
time in an SIRD model. The infected stock, however, may see periods of increase and decrease, as it is a
state of transition.

Figure 5: Predicted variations of the number of infected, recovered, and deceased individuals (Œª = 300)

Next, we assess the trade-off between Œª and the accuracy of the predictions. This is shown in Figure
6. Small values of Œª allow reduce the smoothness of the predicted variations considerably in order to adapt
to the noisy data. As Œª increases, the difference between predictions and data is more pronounced at the
end of the year, when higher variations occurred after Thanksgiving. Given that the predictions are being
made over noisy information, it seems sensible that a moderate value of Œª will result in a more accurate
representation of the reality.
On the other hand, Table 1 summarizes the descriptive statistics of the time series found with moderate
values of Œª. The order of magnitude of the parameters found is in agreement with other epidemiological
13

(a) Infected

(b) Recovered

(c) Dead

Figure 6: Accuracy of predictions as a function of Œª

14

studies. For example, Calafiore et al. (2020) analyzed the parameters in two different stages (early versus
late stages of the pandemic) and attained values of Œ≤(t) and Œ≥(t) in the order of v 10‚àí2 and in the order
of v 10‚àí3 for ¬µ(t) for the late stage. With our time series starting in May 2020, a comparison against this
particular stage is fair. These orders of magnitude are average for Minnesota. Chakraborty et al. (2020)
reports values of Œ≤(t) and ¬µ(t) in the United States of orders v 10‚àí2 and v 10‚àí3 , respectively, around the
middle of May. This is also consistent with the average values of Œ≤(t) and slightly higher than minimum
value of ¬µ(t) for Minnesota at that time of the year, as can be inferred from the variations of infected and
recovered individuals in Figure 5.
Date Range

04/18/2020 - 12/31/2020

Penalty factor (Œª)

300
Œ≤(t) (d-1 )

Œ≥(t) (d-1 )

¬µ(t) (d-1 )

Min

1.46 ¬∑ 10‚àí2

1.07 ¬∑ 10‚àí2

6.27 ¬∑ 10‚àí4

Max

1.24 ¬∑ 10‚àí1

8.26 ¬∑ 10‚àí2

6.09 ¬∑ 10‚àí3

Mean

7.79 ¬∑ 10‚àí2

5.95 ¬∑ 10‚àí2

1.92 ¬∑ 10‚àí3

Median

8.31 ¬∑ 10‚àí2

6.49 ¬∑ 10‚àí2

1.22 ¬∑ 10‚àí3

Std. Dev.

2.51 ¬∑ 10‚àí2

1.65 ¬∑ 10‚àí2

1.34 ¬∑ 10‚àí3

Table 1: Summary statistics of the optimal time series found for two states of the United States

The best parameters obtained with the genetic algorithm and what their values imply are also an important discussion. These are shown in Table 2 for three different values of Œª.The disparity in the values of
the proportions suggests that the our framework benefits greatly from the flexibility introduced by allowing
different proportions. Our results for Œ±‚àóI are in line with the Centers for Disease Control and Preventions‚Äôs
(CDC) belief that the actual number of infected people in the United States was two to seven times greater
than the reported cases by the end of the 2020 (i.e., 0.1429 ‚â§ Œ±I ‚â• 0.5). According to a recent study (Noh
and Danuser, 2021), the values of Œ±‚àóI obtained for Minnesota are within the 95% CI of the ascertainment of
infected cases in this state until September 3, 2020. Assessing the accuracy of Œ±‚àóR , and Œ±‚àóD seems complicated due to testing issues and the variability in testing and recording practices among different parts of the
United States. The actual death toll due to COVID-19 is unknown and very often researchers have to study
the increase in deaths due to related conditions in order to make an estimation. For example, Weinberger
et al. (2020) use the excess in deaths from pneumonia and influenza (P&I) to estimate that the death toll due
to COVID-19 in New Jersey can be two or three times the official count (i.e., 0.33 ‚â§ Œ±D ‚â• 0.5). Except for
15

the result obtained for Œª = 300 (Œ±‚àóD = 0.6171), which is slightly more optimistic about this estimation, our
results for Minnesota are also within this range.
Finally, we comment on the best values found for Œ±‚àóS . This parameter does not have a real meaning
because there is not a distinction between observed and actual susceptible stock. However, its introduction
is useful for regression purposes as it helps reduce the number of susceptible individuals introduced in the
model, which is, by far, the largest stock in the model. With such low values of Œ±‚àóS , we have that SÃÉ (t)  S (t)
and therefore we reduce the order of magnitude of the errors incurred by our regression model when predicting the susceptible stock. Using S (t) instead would have focused our model‚Äôs regression efforts in predicting
accurately the changes in this variable, several orders of magnitude larger than the rest, thus disregarding
Àú RÃÉ(t), and DÃÉ(t). The small values of Œ±‚àó obtained in all the instances that
important prediction errors in I(t),
S
were run with our genetic algorithm indicate that the algorithm always seeks the ‚Äúnormalization‚Äù of S (t) in
order to find good fits for the data provided.
Œª

Œ±‚àóS

Œ±‚àóI (d-1 )

Œ±‚àóR (d-1 )

Œ±‚àóD (d-1 )

w‚àó (day)

0

0.0167

0.5215

0.6921

0.5298

5

300

0.0556

0.3570

0.6349

0.6171

14

4

0.0749

0.4476

0.8613

0.4703

29

10

Table 2: Best individuals found with the genetic algorithm for different values of Œª

4.2. Qualitative Analysis of the Results
The results obtained for Œ≤(t) are very sensitive to government policy as well as to people‚Äôs interaction
and observance of social distancing regulations. The time series of Œ≥(t) and ¬µ(t) have a higher dependence on
the availability and effectiveness of health care, as well as on the resource availability in hospitals. Figures
7 and 8 display timelines of relevant events that took place during the period for which our model found
times series of the parameters of the SIRD model.
A timeline of government policy implementations and social interactions is showed in Figure 7. With
the first outbreak of COVID-19 in Minnesota, Œ≤(t) increased sharply to a peak on April 30th , 2020, when
the governor of Minnesota extended the stay-at-home order to May 17, 2020. The order had an effect on
the average number of contacts between people and the transmission of COVID-19 slowed down in the first
weeks of May. On May 18th , 2020, the new Stay safe Minnesota order that contained a series of measures for
controlling the pandemic was issued. This new order, along with the effect of masks and social distancing
16

slowed brought Œ≤(t) to a minimum in the middle of June. However, the impact of these measures backfired
shortly after people gathered massively on May 25th to protest against the death of George Floyd. The effect
of these demonstrations was a surge in Œ≤(t) a few weeks later. The emergency order extended until August
12th , 2020 and the higher temperatures during the summer stabilized the situation and even improved it
slightly (Wang et al., 2020). However, when the economic activity resumed at the end of the summer, large
outbreaks took place in workplaces, bars and restaurants. In late November and early December, when
the reported number of new daily cases surged due to holiday gatherings, the state government limited
gatherings in an attempt to put a curb on this increase.

Figure 7: Effect of policies against COVID-19 on Œ≤(t)

As mentioned in the quantitative assessment of results, the trends in Œ≥(t) and ¬µ(t) depend largely on the
capacity of the health care system to adapt to the hospitalization needs of the population. When hospitals
and emergency rooms do not operate at full capacity, they are able to cope better with the needs of their
patients and provide better service. This usually results in an increase in the proportion of people that
recover (hence, in an increase of Œ≥(t)) and a decrease in the proportion of people that dies from the disease
(hence, a decrease of ¬µ(t)). In the context of COVID-19, the hospitals ability to adapt to the circumstances
derived from the pandemic has had a considerable impact since they operated at full capacity during the first
months of the pandemic. Moreover, health care professionals have learned more and more about possible
17

treatments to curb on the disease‚Äôs symptoms and effects. The consequence has been the aforementioned
increasing trend in Œ≥(t) and the decrease in ¬µ(t), which can be observed in Figure 8. Note that the last weeks
of 2020 saw a shift in the trend of ¬µ(t) as a consequence of the increase of admissions in hospitals following
Thanksgiving.

Figure 8: Effect of policies against COVID-19 on Œ≥(t) and ¬µ(t)

5. Conclusions
The present paper provides an alternative framework for describing the time-varying nature of the parameters of an SIRD model. We introduce our work as a ‚Äúhybrid‚Äù of the works by Anastassopoulou et al.
(2020) and Calafiore et al. (2020). As in Anastassopoulou et al. (2020), we propose a rolling regression
approach, but we do not set the window size beforehand. As in Calafiore et al. (2020), we account for the
differences between actual and observed cases, but we allow these differences to vary between infected, recovered, and dead. Our rolling regression is embedded within a MIBNLP problem that allows for selecting
an optimal window size for the regression as well as for finding the proportions of the actual number of individuals in each compartment that the collected data represent. In an attempt to reduce the noise inherent to
18

the collection of data, our optimization model looks for a trade-off between the accuracy in reproducing the
data that are fed to the model and the smoothness of the time-series of the parameters of the SIRD model.
The solution of this MIBNLP problem is tackled with a real-valued genetic algorithm. Using 2020 data
from Minnesota, we find that the model yields values for the window size and the fractions of actual cases
that our data represent that reproduce satisfactorily the observed daily variations in the number of infected,
recovered, and dead individuals. They also provide smooth time series that show more stable and realistic
variations in the number of average contacts initiated by infected individuals per unit of time (Œ≤(t)), the
proportion of infected people that recover per unit of time (Œ≥(t)), and the proportion of infected individuals
that ultimately die from the disease per unit of time (¬µ(t)).
We analyze our results under the light of quantitative and qualitative assessments. Quantitatively, our
results are in agreement with previously published works, thus proving that our framework is a solid approach that allows for great modeling flexibility. Qualitatively, the time series obtained for the parameters
of the SIRD model were consistent with changes in government policy, with people‚Äôs adoption of social
distancing and personal protection measures, and with the improvement of the capacity of the health care
system to fight against this new virus. While we apply our research to an SIRD model, we anticipate that
this framework can also be used in the context of other compartmental models in epidemiology.
As a future research direction, the implementation of this model opens new questions about the possible
relationship between the three parameters of the SIRD models and their variations over time. If there
exists an interdependency in these changes and whether that synergy can be captured mathematically is an
interesting research question that we would like to address in the near future.

References
Anastassopoulou, C., Russo, L., Tsakris, A., and Siettos, C. (2020). Data-based analysis, modelling and forecasting of the COVID19 outbreak. PloS one, 15(3):e0230405.
Calafiore, G. C., Novara, C., and Possieri, C. (2020). A modified SIR model for the COVID-19 contagion in Italy. arXiv preprint
arXiv:2003.14391.
Capano, G., Howlett, M., Jarvis, D. S., Ramesh, M., and Goyal, N. (2020). Mobilizing policy (in) capacity to fight COVID-19:
Understanding variations in state responses. Policy and Society, 39(3):285‚Äì308.
Chakraborty, A., Chen, J., Desvars-Larrive, A., Klimek, P., Tames, E. F., Garcia, D., Horstmeyer, L., Kaleta, M., Lasser, J.,
Reddish, J., et al. (2020). Analyzing COVID-19 data using SIRD models. medRxiv.
Chen, Y.-C., Lu, P.-E., Chang, C.-S., and Liu, T.-H. (2020). A time-dependent SIR model for COVID-19 with undetectable infected
persons. IEEE Transactions on Network Science and Engineering.

19

Congressional Research Service (2021). Unemployment Rates During the COVID-19 Pandemic: In Brief. Accessed: 2021-02-09.
Cooper, I., Mondal, A., and Antonopoulos, C. G. (2020). A SIR model assumption for the spread of COVID-19 in different
communities. Chaos, Solitons & Fractals, 139:110057.
Croccolo, F. and Roman, H. E. (2020). Spreading of infections on random graphs: A percolation-type model for COVID-19.
Chaos, Solitons & Fractals, 139:110077.
DreÃÅo, J., PeÃÅtrowski, A., Siarry, P., and Taillard, E. (2006). Metaheuristics for hard optimization: methods and case studies. Springer
Science & Business Media.
Dunis, C. L., Laws, J., and Naƒ±Ãàm, P. (2004). Applied quantitative methods for trading and investment. John Wiley & Sons.
Fabozzi, F. J. and Markowitz, H. M. (2011). Equity valuation and portfolio management, volume 199. John Wiley & Sons.
Fanelli, D. and Piazza, F. (2020). Analysis and forecast of COVID-19 spreading in China, Italy and France. Chaos, Solitons &
Fractals, 134:109761.
Giordano, G., Blanchini, F., Bruno, R., Colaneri, P., Di Filippo, A., Di Matteo, A., and Colaneri, M. (2020). Modelling the
COVID-19 epidemic and implementation of population-wide interventions in Italy. Nature Medicine, pages 1‚Äì6.
Godio, A., Pace, F., and Vergnano, A. (2020). SEIR modeling of the Italian epidemic of SARS-CoV-2 using computational swarm
intelligence. International Journal of Environmental Research and Public Health, 17(10):3535.
Haupt, R. L. and Ellen Haupt, S. (2004). Practical genetic algorithms.
Hethcote, H. W. (1989). Three basic epidemiological models. In Applied mathematical ecology, pages 119‚Äì144. Springer.
Hethcote, H. W. (2000). The mathematics of infectious diseases. SIAM review, 42(4):599‚Äì653.
Hethcote, H. W. (2009). The basic epidemiology models: models, expressions for R0, parameter estimation, and applications. In
Mathematical understanding of infectious disease dynamics, pages 1‚Äì61. World Scientific.
Ifguis, O., El Ghozlani, M., Ammou, F., Moutcine, A., and Abdellah, Z. (2020). Simulation of the final size of the evolution curve
of coronavirus epidemic in Morocco using the SIR model. Journal of Environmental and Public Health, 2020.
Jo, H., Son, H., Jung, S. Y., and Hwang, H. J. (2020). Analysis of COVID-19 spread in South Korea using the SIR model with
time-dependent parameters and deep learning. medRxiv.
John Hopkins University. John Hopkins Coronavirus Resource Center. Accessed: 2021-02-13.
Kermack, W. O. and McKendrick, A. G. (1927). A contribution to the mathematical theory of epidemics. Proceedings of the royal
society of london. Series A, Containing papers of a mathematical and physical character, 115(772):700‚Äì721.
Khoshnaw, S. H., Mohammad, N. A., Salih, R. H., et al. (2017). Identifying critical parameters in SIR model for spread of disease.
Open Journal of Modelling and Simulation, 5(01):32.
Kucharski, A. J., Russell, T. W., Diamond, C., Liu, Y., Edmunds, J., Funk, S., Eggo, R. M., Sun, F., Jit, M., Munday, J. D., et al.
(2020). Early dynamics of transmission and control of COVID-19: a mathematical modelling study. The lancet infectious
diseases.
Laarabi, H., Rachik, M., El Kahlaoui, O., and Labriji, E. (2013). Optimal vaccination strategies of an SIR epidemic model with a
saturated treatment. Universal Journal of Applied Mathematics, 1(3):185‚Äì191.
Li, Q., Tang, B., Bragazzi, N. L., Xiao, Y., and Wu, J. (2020). Modeling the impact of mass influenza vaccination and public health
interventions on COVID-19 epidemics with limited detection capability. Mathematical Biosciences, page 108378.
Ndairou, F., Area, I., Nieto, J. J., and Torres, D. F. (2020). Mathematical modeling of COVID-19 transmission dynamics with a
case study of Wuhan. Chaos, Solitons & Fractals, page 109846.

20

Noh, J. and Danuser, G. (2021). Estimation of the fraction of COVID-19 infected people in US states and countries worldwide.
PloS one, 16(2):e0246772.
Postnikov, E. B. (2020). Estimation of COVID-19 dynamics ‚Äúon a back-of-envelope‚Äù: Does the simplest SIR model provide
quantitative parameters and predictions? Chaos, Solitons & Fractals, 135:109841.
Roda, W. C., Varughese, M. B., Han, D., and Li, M. Y. (2020). Why is it difficult to accurately predict the COVID-19 epidemic?
Infectious Disease Modelling.
Simha, A., Prasad, R. V., and Narayana, S. (2020). A simple stochastic SIR model for COVID-19 infection dynamics for karnataka:
Learning from Europe. arXiv preprint arXiv:2003.11920.
Storn, R. and Price, K. (1997). Differential evolution‚Äìa simple and efficient heuristic for global optimization over continuous
spaces. Journal of global optimization, 11(4):341‚Äì359.
Teles, P. (2020). A time-dependent SEIR model to analyse the evolution of the SARS-CoV-2 epidemic outbreak in Portugal. arXiv
preprint arXiv:2004.04735.
The Atlantic Monthly Group (2021). The COVID Tracking Project. Accessed: 2021-02-09.
Trilla, A., Trilla, G., and Daer, C. (2008). The 1918 ‚ÄúSpanish flu‚Äù in Spain. Clinical infectious diseases, 47(5):668‚Äì673.
Wang, J., Tang, K., Feng, K., and Lv, W. (2020). High temperature and high humidity reduce the transmission of COVID-19.
Available at SSRN 3551767.
Wangping, J., Ke, H., Yang, S., Wenzhe, C., Shengshu, W., Shanshan, Y., Jianwei, W., Fuyin, K., Penggang, T., Jing, L., et al.
(2020). Extended SIR prediction of the epidemics trend of COVID-19 in Italy and compared with Hunan, China. Frontiers in
medicine, 7:169.
Waqas, M., Farooq, M., Ahmad, R., and Ahmad, A. (2020). Analysis and prediction of COVID-19 pandemic in Pakistan using
time-dependent SIR model. arXiv preprint arXiv:2005.02353.
Weinberger, D. M., Cohen, T., Crawford, F. W., Mostashari, F., Olson, D., Pitzer, V. E., Reich, N. G., Russi, M., Simonsen, L.,
Watkins, A., et al. (2020). Estimating the early death toll of COVID-19 in the United States. bioRxiv.
Weiss, H. H. (2013). The SIR model and the foundations of public health. Materials matematics, pages 0001‚Äì17.
World Health Organization (2005a). Avian influenza: assessing the pandemic threat. Technical report, World Health Organization.
World Health Organization (2005b). Influenza vaccines. Weekly Epidemiological Record, 80(33):279‚Äì287.
Xue, L., Jing, S., Miller, J. C., Sun, W., Li, H., Estrada-Franco, J. G., Hyman, J. M., and Zhu, H. (2020). A data-driven network
model for the emerging COVID-19 epidemics in Wuhan, Toronto and Italy. Mathematical Biosciences, page 108391.
Yang, H. M., Boldrini, J. L., Fassoni, A. C., Freitas, L. F. S., Gomez, M. C., Lima, K. K. B. d., Andrade, V. R., and Freitas, A. R. R.
(2016). Fitting the incidence data from the city of Campinas, Brazil, based on dengue transmission modellings considering
time-dependent entomological parameters. PloS One, 11(3):e0152186.
Yang, Z., Zeng, Z., Wang, K., Wong, S.-S., Liang, W., Zanin, M., Liu, P., Cao, X., Gao, Z., Mai, Z., et al. (2020). Modified SEIR
and AI prediction of the epidemics trend of COVID-19 in China under public health interventions. Journal of Thoracic Disease,
12(3):165.
Zanin, L. and Marra, G. (2012). Rolling regression versus time-varying coefficient modelling: An empirical investigation of the
Okun‚Äôs law in some Euro area countries. Bulletin of Economic Research, 64(1):91‚Äì108.
Zhong, L., Mu, L., Li, J., Wang, J., Yin, Z., and Liu, D. (2020). Early prediction of the 2019 novel coronavirus outbreak in the
mainland China based on simple mathematical model. IEEE Access, 8:51761‚Äì51769.

21

