Estimation of Covid-19 Prevalence from Serology Tests:
A Partial Identification Approach

arXiv:2006.16214v1 [stat.ME] 29 Jun 2020

Panos Toulisâˆ—
University of Chicago,
Booth School of Business

Abstract
We propose a partial identification method for estimating disease prevalence from serology
studies. Our data are results from antibody tests in some population sample, where the test
parameters, such as the true/false positive rates, are unknown. Our method scans the entire
parameter space, and rejects parameter values using the joint data density as the test statistic.
The proposed method is conservative for marginal inference, in general, but its key advantage
over more standard approaches is that it is valid in finite samples even when the underlying model
is not point identified. Moreover, our method requires only independence of serology test results,
and does not rely on asymptotic arguments, normality assumptions, or other approximations.
We use recent Covid-19 serology studies in the US, and show that the parameter confidence set
is generally wide, and cannot support definite conclusions. Specifically, recent serology studies
from California suggest a prevalence anywhere in the range 0%-2% (at the time of study), and
are therefore inconclusive. However, this range could be narrowed down to 0.7%-1.5% if the
actual false positive rate of the antibody test was indeed near its empirical estimate (âˆ¼0.5%).
In another study from New York state, Covid-19 prevalence is confidently estimated in the range
13%-17% in mid-April of 2020, which also suggests significant geographic variation in Covid-19
exposure across the US. Combining all datasets yields a 5%-8% prevalence range. Our results
overall suggest that serology testing on a massive scale can give crucial information for future
policy design, even when such tests are imperfect and their parameters unknown.

Keywords: partial identification; disease prevalence; serology tests; Covid-19.
JEL classification codes: C12, C14, I10.

âˆ—

Email: panos.toulis@chicagobooth.edu. Code is available at https://github.com/ptoulis/covid-19.

1

Introduction

Since December 2019 the world has been facing the Covid-19 pandemic, and its disastrous effects
in human life and the economy. Responding to the pandemic, most countries have closed off their
borders, and imposed unprecedented, universal lockdowns on their entire economies. The key
reason for such drastic measures is uncertainty: we do not yet know the actual transmission rate,
the lethality, or the prevalence of this new deadly disease. As governments and policy makers
were caught by surprise, there is no doubt that these drastic measures were needed as a first line of
defense. The data show that we would have to deal with a massive humanitarian disaster otherwise.
At the same time, as the economic pain mounts, especially for the most vulnerable and disadvantaged segments of the population, there is an urgent need to think of careful ways to safely reopen
the economy. Estimating the true prevalence of Covid-19 has been identified as a key parameter to
this effort (Alvarez et al., 2020). In the United States, the number of confirmed Covid-19 cases is
1,193,813 as of May 7 with 70,802 total deaths. This implies a (case) prevalence of 0.36% (assuming
328m as the US population), and a 5.9% mortality rate of Covid-19, which is even higher than the
mortality rate reported at times by the World Health Organization.1 However, the true prevalence,
that is, the number of people who are currently infected or have been infected by Covid-19 over
the entire population is likely much higher, and so the mortality rate should be significantly lower
than 5.9%. A growing literature is attempting to estimate these numbers through epidemiological
models (Li et al., 2020; Flaxman et al., 2020), or structural assumptions (HortacÌ§su et al., 2020).
A more robust alternative seems to be possible through randomized serological studies that
detect marker antibodies indicating exposure to Covid-19. In the US, there is currently a massive
coordinated effort to evaluate the widespread application of these tests. The results are expected
in late May of 2020.2 The hope is that these tests will determine the true prevalence of the
virus, and thus its lethality, and also determine whether someone is immune enough to return to
work (the extent of immunity is still uncertain, however). Furthermore, seroprevalence studies can
give information on risk factors for the disease, such as a patientâ€™s age, location, or underlying
health conditions. They may also reveal important medical information on immune responses to
the virus, such as how long antibodies last in peoples bodies following infection, and could also
identify those able to donate blood plasma, which is a possible treatment to seriously ill Covid-19
patients.3 The development of serology tests is therefore essential to designing a careful strategy
towards both effective medical treatments and a gradual reopening of the economy.
1

The official mortality rate was revised from 2% in late January to 4% in early March; see also an official WHO situation report from early March: https://www.who.int/docs/default-source/coronaviruse/situation-reports/
20200306-sitrep-46-covid-19.pdf?sfvrsn=96b04adf_2.
2
CDC page: https://www.cdc.gov/coronavirus/2019-ncov/lab/serology-testing.html.
3
Food and Drug Administration (FDA) announcement on serology studies (04/07/2020): https://www.fda.gov/
news-events/press-announcements/coronavirus-covid-19-update-serological-tests.

1

Until widespread serology testing is possible, however, we have to rely on a limited number
of serology studies that have started to emerge in various areas of the globe, including the US.
Table 1 presents a non-exhaustive summary of such studies around the world. For example, in
Germany, serology tests in early April showed a 14% prevalence in a sample of 500 people.4 In the
Netherlands, a study in mid-April showed a lower prevalence at 3.5% in a small sample of blood
donors.5

6

In the US, in a recent and relatively large study in Santa Clara, California, Bendavid

et al. (2020) estimated an in-sample prevalence of 1.5% from 50 positive test results in a sample
of 3330 patients. Using a reweighing technique, the authors extrapolated this estimate to 2-4%
prevalence in the general population. A follow-up study in LA County found 35 positives out of
846 tests. What is unique about these last two studies is that data from a prior validation study
are also available, where, say, 401 â€œtrue negativesâ€ were tested with 2 positive results, implying
a false positive rate of 0.5%. Upon publication, these studies received intense criticism because
the false positive rate appears to be large enough compared to the underlying disease prevalence.
For example, the Agresti-Coull and Clopper-Pearson 95% confidence intervals for the false positive
rate are [0.014%, 1.92%] and [0.06%, 1.79%], respectively. These intervals for the false positive
rate are not incompatible even with a 0% prevalence, since a 1.5% false positive rate achieves
0.015 Ã— 3330 â‰ˆ 50 (false) positives on average, same as the observed value in the sample.
Such standard methods, however, are justified based on approximations, asymptotic arguments,
prior specifications (for Bayesian methods), or normality assumptions, which are always suspect
in small samples. In this paper, we develop a method that can assess finite-sample statistical
significance in a robust way. The key idea is to treat all unknown quantities as parameters, and
explore the entire parameter space to assess agreement with the observed data. Our method adopts
the partial identification framework, where the goal is not to produce point estimates, but to identify
sets of plausible parameter values (Wooldridge and Imbens, 2007; Tamer, 2010; Chernozhukov et al.,
2007; Manski, 2003, 2010, 2007; Romano and Shaikh, 2008, 2010; HonoreÌ and Tamer, 2006; Imbens
and Manski, 2004; Beresteanu et al., 2012; Stoye, 2009; Kaido et al., 2019). Within that literature,
our proposed method appears to be unique in the sense that it constructs a procedure that is valid
in finite samples given the correct distribution of the test statistic. Importantly, the choice of the
test statistic can affect only the power of our method, but not its validity. Such flexibility may be
especially valuable in choosing a test statistic that is both powerful and easy to compute. Thus, the
main benefit of our approach is that it is valid with enough computation, whereas more standard
methods are only valid with enough samples.
4

Report in German: https://www.land.nrw/sites/default/files/asset/document/zwischenergebnis_
covid19_case_study_gangelt_0.pdf.
5
Presentation slides in Dutch: https://www.tweedekamer.nl/sites/default/files/atoms/files/tb_jaap_van_
dissel_1604_1.pdf.
6
See also a summary of these projects in the journal â€œScienceâ€: https://www.sciencemag.org/news/2020/04/
antibody-surveys-suggesting-vast-undercount-coronavirus-infections-may-be-unreliable.

2

Prevalence

Location

Time

Method

Notes

6.14%

China

01/21

PCR

Sample of 342 pneumonia patients (Liang et al., 2020).

2.6%

Italy

02/21

PCR

Used 80% of entire population in VoÌ, Italy (Lavezzo et al., 2020).

5.3%

USA

03/12

PCR

Used 131 patients with ILI symptoms (Spellberg et al., 2020).

13.7%

USA

03/22

PCR

Sample of 215 pregnant women in NYC (Sutton et al., 2020).

0.34%

USA

03/17

model

(Yadlowsky et al., 2020).

9.4%

Spain

03/28

serology

Sample of 578 healthcare workers (Garcia-Basteiro et al., 2020).

3%

Japan

03/31

serology

Random set of 1000 blood samples in Kobe Hospital (Doi et al., 2020).

36%

USA

04/02

PCR

Study in large homeless shelter in Boston (Baggett et al., 2020).

1.5%

USA

04/03

serology

Recruited 3330 people via Facebook (Bendavid et al., 2020).

2.5%

USA

04/04

model

Uses ILINet data; implies 96% unreported cases (Lu et al., 2020).

9.1%

Switzerland

04/06

serology

Sample of 1335 individuals in Geneva (Stringhini et al., 2020).

14%

Germany

04/09

serology

Self-reported 400 households in Gangelt. (Streeck et al., 2020).

3.1%

Netherlands

04/16

antigen

Used 3% of all blood donors (Jaap van Dissel, 2020).

0.4-40%

USA

04/24

model

Partial identification using #cases/deaths (Manski and Molinari, 2020).

90%

USA

03/16

model

Used airflight data to identify transmission rates (HortacÌ§su et al., 2020).

85%

India

04/02

model

Extrapolated from respiratory-related cases (Venkatesan, 2020).

Unreported

Table 1: Summary of recent Covid-19 prevalence studies crudely categorized as either statistical models or medical
tests (PCR or serology). Most studies report intervals, but here we mainly report midpoints. Top panel: PCR stands
for â€œpolymerase chain reactionâ€, and is a key test to detect presence of the virusâ€™ RNA; serology denotes a serology
test to detect presence of antibodies (e.g., IgA, IgM, IgG). ILI stands for â€œinfluenza-like illnessâ€ and describes methods
that use data recorded from patients with general influenza-like symptoms, including but not limited to Covid-19
cases. Bottom panel: Studies that aimed mainly to estimate percentage of Covid-19 cases that are not reported. This
number can be used to calculate prevalence estimates, but needs to be adjusted for the exact timeframe of the study;
e.g., the analysis of HortacÌ§su et al. (2020) implies a 1.5-2.5% prevalence in Santa Clara county in mid-March.

The rest of this paper is structured as follows. In Section 2 we describe the problem formally.
In Section 3.1 we describe the proposed method on a high level. A more detailed analysis along
with a modicum of theory is given in Section 3.2. In Section 4 we apply the proposed method on
data from the Santa Clara study, the LA County study, and a recent study from New York state.

2

Problem Setup

Here, we formalize the statistical problem of estimating disease prevalence through imperfect medical tests. Every individual i is associated with a binary status xi : it is xi = 1 if the individual has
developed antibodies from exposure to the disease, and xi = 0 if not. We will also refer to these
cases as â€œpositiveâ€ and â€œnegativeâ€, respectively. Patient status is not directly observed, but can be
estimated with a serology (antibody) test.

3

This medical antibody test can be represented by a function t : {0, 1} â†’ {0, 1}, and determines
whether someone is positive or negative. As usual, the categorization of the test results can be
described through the following table:
true status, x =
0

1

0

true negative

false negative

1

false positive

true positive

t(x) =

We will assume that each test result is an independent random outcome, such that the true positive
rate and false positive rate, denoted respectively by q and p,7 are constant:
P {t(x) = 1|x = 1} = q,

(A1)

P {t(x) = 1|x = 0} = p.

(A2)

This assumption may be untenable in practice. In general, patient characteristics, or test target and
delivery conditions can affect the test results. For example, Bendavid et al. (2020) report slightly
different test performance characteristics depending on which antibody (either IgM or IgG) was
being detected. We note, however, that this assumption is not strictly necessary for the validity of
our proposed inference procedure. It is only useful in order to obtain a precise calculation for the
distribution of the test statistic (see Theorem 1 and remarks).
To determine test performance characteristics, and gain information about the true/false positive rates of the antibody test, there is usually a validation study where the underlying status of
participating individuals is known. In the Covid-19 case, for example, such validation study could
include pre-Covid-19 blood samples that have been preserved, and are thus â€œtrue negativesâ€. To
simplify, we assume that in the validation study there is a set Icâˆ’ of participating individuals, where
it is known that everyone is a true negative, and a set Ic+ where everyone is positive; i.e.,
xi = 0, for all i âˆˆ Icâˆ’ , and xi = 1, for all i âˆˆ Ic+ .
There is also the main study with a set Im of participating individuals, where the true status is not
known. We assume no overlap between sets Icâˆ’ , Ic+ and Im , which is a realistic assumption. We
define Ncâˆ’ = |Icâˆ’ | and Nc+ = |Ic+ | as the respective number of participants in the validation study,
and Nm = |Im | as the number of participants in the main study. These numbers are observed, but
the full patient sets or the patient characteristics, may not be observed.
7

The terms â€œsensitivityâ€ and â€œspecificityâ€ are frequently used in practice of medical testing. In our setting,
sensitivity maps to the true positive rate (q), and specificity maps to one minus the false positive rate (1 âˆ’ p). In this
paper, we will only use the terms â€œtrue/false positive rateâ€ as they are more precise and self-explanatory.

4

We also observe the positive test results in both studies:
Scâˆ’ =

X

t(xi ), Sc+ =

iâˆˆIcâˆ’

Sm =

X

X

t(xi ),

[Calibration study]

iâˆˆIc+

t(xi ).

[Main study]

(1)

iâˆˆIm

Thus, Scâˆ’ is the number of false positives in the validation study since we know that all individuals
in Icâˆ’ are true negatives. Similarly, Sc+ is the number of true positives in the validation study
since all individuals in Ic+ are known to be positive. These numbers offer some simple estimates
of the false positive rate and true positive rate of the medical test, respectively: pÌ‚ = Scâˆ’ /Ncâˆ’
+
and qÌ‚ = Sc+ /Nc+ . We use (sâˆ’
c,obs , sc,obs , sm,obs ) to denote the observed values of test positives

(Scâˆ’ , Sc+ , Sm ), respectively, which are integer-valued random variables.
+
The statistical task is therefore to use observed data {(Ncâˆ’ , Nc+ , Nm ), (sâˆ’
c,obs , sc,obs , sm,obs )} and

do inference on the quantity:
P

iâˆˆIm

Ï€=

Nm

xi

,

(2)

i.e., the unknown disease prevalence in the main study. We emphasize that Ï€ is a finite-population
estimand â€” we discuss (briefly) the issue of extrapolation to the general population in Section 5.
The challenge here is that Sm generally includes both false positives and true positives, which
depends on the unknown test parameters, namely the true/false positive rates q and p. Since Ï€Nm
is the (unknown) number of infected individuals in the main study, we can use Assumptions (A1)
and (A2) to write down this decomposition formally:
Scâˆ’ âˆ¼ Binom(Ncâˆ’ , p), Sc+ âˆ¼ Binom(Nc+ , q), and
Sm âˆ¼ Binom(Ï€Nm , q) + Binom(Nm âˆ’ Ï€Nm , p),
{z
} |
{z
}
|
true positives

(3)

false positives

where Binom denotes the binomial random variable. For brevity, we define S = (Scâˆ’ , Sc+ , Sm ) as
our joint data statistic, and Î¸ = (p, q, Ï€) as the joint parameter value. The independence of tests
implies that the density of S can be computed exactly as follows.
ï£®

j=S
Xm

f (S | Î¸) = d(Scâˆ’ ; Ncâˆ’ , p) Â· d(Sc+ ; Nc+ , q) Â· ï£°

ï£¹
d(j; Ï€Nm , q) Â· d(Sm âˆ’ j; Nm âˆ’ Ï€Nm , p)ï£» ,

(4)

j=0

where d(k; n, s) denotes the probability of k successes in a binomial experiment with n trials and
s probability of success. There are several ways to implement Equation (4) efficiently â€” we defer
discussions on computational issues to Section 5.

5

3

Method

We begin with an illustrative example to describe the proposed method on a high level. We give
more details along with some theoretical guarantees in the section that follows.

3.1

Illustrative example

Let us consider the Santa Clara study (Bendavid et al., 2020) with observed data:
+
(Ncâˆ’ , Nc+ , Nm ) = (401, 197, 3330), and (sâˆ’
c,obs , sc,obs , sm,obs ) = (2, 178, 50).

The unknown quantities in our analysis are q, p and Ï€: the true positive rate of the test, the false
positive rate, and the unknown prevalence in the main study, respectively. Assume zero prevalence
(Ï€ = 0%), 90% true positive rate (q = 0.9), and 1.5% false positive rate (p = 0.015). We ask the
question: â€œIs the combination (p, q, Ï€) = (0.015, 0.90, 0) compatible with the data?â€. Naturally,
this can be framed in statistical terms as a null hypothesis:
H0 : (p, q, Ï€) = (0.015, 0.90, 0).

(5)

To test H0 we have to compare the observed positive test results with the values that could have
been observed if indeed the true model parameter values were (p, q, Ï€) = (0.015, 0.90, 0). Our model
is simple enough that we can execute this hypothetical analysis exactly based on the density of
f (S|Î¸) in Equation (4), where S = (Scâˆ’ , Sc+ , Sm ) is the vector of all positive test results, and Î¸
is specified as in H0 ; see Figure 1.
Sc+

of S to its observed value

two components,

(Scâˆ’ , Sm );

(Sc+

To simplify visualization, in Figure 1 we fix the component
= 178), and only plot the density with respect to the other

i.e., we plot f (S | H0 , Sc+ = 178). One can visualize the full joint

distribution f (S | H0 ) as a collection of such conditional densities for all possible values of Sc+ .
The next step is to decide whether the observed value of S, namely sobs = (2, 178, 50), is
compatible with the distribution of Figure 1. We see that the mode of the distribution is around
the point (Scâˆ’ , Sm ) = (5, 45), whereas the point (2, 50) is at the lower edge of the distribution. If
the observed values were even further, say at (Scâˆ’ , Sm ) = (2, 80), then we could confidently reject
H0 since the density at (2, 80) is basically zero. Here, we have to be careful because the actual
observed values are still somewhat likely under H0 . Our method essentially accepts H0 when the
density of this distribution at the observed value sobs of statistic S is above some threshold c0 , that
is, we decide based on the following rule:
Accept H0 if f (sobs |H0 ) > c0 .

6

(6)

Figure 1: Density f (S|H0 ) of test positives S = (Scâˆ’ , Sc+ , Sm ) conditional on H0 of Equation (5),
and with fixed Sc+ = 178 (its observed sample value) to ease visualization. The observed values
(sâˆ’
c,obs , sm,obs ) = (2, 50) are marked with an asterisk. To test H0 we need to calculate some kind of
â€œp-valueâ€ for the observed point. In our construction, we simply test whether the density at the
observed values exceeds an appropriately chosen threshold (see Section 3.2).
The test in Equation (6) is reminiscent of the likelihood ratio test, the key difference being that
our test does not require maximizations of the likelihood function over the parameter space, which is
computationally intensive, and frequently unstable numerically â€” we make a concrete comparison
in the application of Section 4.3. Our test essentially uses the density of S as the test statistic for
H0 , while threshold c0 generally depends on the particular null values being tested. Assuming that
the test of Equation (6) has been defined, we can then test for all possible combinations of our
parameter values, Î¸ âˆˆ Î˜, in some large enough parameter space Î˜, and then invert this procedure
in order to construct the confidence set. As usual, we would like this confidence set to cover the true
parameters with some minimum probability (e.g., 95%). In the following section, we show that this
is possible through an appropriate construction of the test in Equation (6), which takes into account
the level sets of the density function depicted in Figure 1. The overall procedure is computationally
intensive, but is valid in finite samples without the need of asymptotic or normality assumptions.
The details of this construction, including the appropriate selection of the test threshold and the
proof of validity, are presented in the following section.

7

3.2

Theoretical Details

Let S = (Scâˆ’ , Sc+ , Sm ) âˆˆ S denote the statistic, where S = {0, . . . , Ncâˆ’ }Ã—{0, . . . , Nc+ }Ã—{0, . . . , Nm },
and let Î¸ = (p, q, Ï€) âˆˆ Î˜ be the model parameters. We take Î˜ to be finite and discrete; e.g., for
+
probabilities we take a grid of values between 0 and 1. Let sobs = (sâˆ’
c,obs , sc,obs , sm,obs ) denote the

observed value of S in the sample. Let f (S|Î¸) denote the density of the joint statistic conditional
on the model parameter value Î¸, as defined in Equation (4). Suppose that Î¸ 0 is the true unknown
parameter value, and assume that
P (Î¸ 0 âˆˆ Î˜) = 1.

(A4)

Assumption (A4) basically posits that our discretization is fine enough to include the true parameter
value with probability one. In our application, this assumption is rather mild as we are dealing
with parameters that are either probabilities or integers, and so bounded within well-defined ranges.
Moreover, this assumption is implicit essentially in all empirical work since computers operate with
b 1âˆ’Î± âŠ† Î˜ such that P (Î¸ 0 âˆˆ Î˜
b 1âˆ’Î± ) â‰¥ 1âˆ’Î±,
finite precision. Our goal is to construct a confidence set Î˜
b 1âˆ’Î± = Î˜ satisfies this criterion, so we
where Î± is some desired level (e.g., Î± = 0.05). Trivially, Î˜
b as narrow as possible. We will also need the following definition:
will aim to make Î˜
Î½(z, Î¸) = {s âˆˆ S : 0 < f (s|Î¸) â‰¤ z} .

(7)

Function Î½ depends on level sets of f , and counts the number of sample data points (over the
sample space S) with likelihood at Î¸ that is smaller than the observed likelihood at Î¸.
We can now prove the following theorem.
Theorem 1. Suppose that Assumption (A4) holds. Consider the following construction for the
confidence set:

b 1âˆ’Î± = Î¸ âˆˆ Î˜ : f (sobs |Î¸) Â· Î½(f (sobs |Î¸), Î¸) > Î± .
Î˜

(8)

b 1âˆ’Î± ) â‰¥ 1 âˆ’ Î±.
Then, P (Î¸ 0 âˆˆ Î˜
Proof. For any fixed Î¸ âˆˆ Î˜ consider the function g(z, Î¸) = z Â· Î½(z, Î¸), z âˆˆ [0, 1]. Note that, for
fixed Î¸, function g(z, Î¸) is monotone increasing and generally not continuous with respect to z. Let
FÎ¸ = {f (s|Î¸) : s âˆˆ S}, and define as zÎ¸âˆ— the unique fixed point for which g(zÎ¸âˆ— , Î¸) âˆ’ Î± = 0, if that
point exists; if not, define the point as zÎ¸âˆ— = max{z âˆˆ FÎ¸ : g(z, Î¸) â‰¤ Î±}. It follows that g(zÎ¸âˆ— , Î¸) â‰¤ Î±,
for any Î¸, and so the event {f (sobs |Î¸) Â· Î½(f (sobs |Î¸), Î¸) â‰¤ Î±} = {g(f (sobs |Î¸), Î¸) â‰¤ Î±} is the same as
the event {f (sobs |Î¸) â‰¤ zÎ¸âˆ— }. Now we can bound the coverage probability as follows.

8

b 1âˆ’Î± ) = P {f (sobs |Î¸ 0 ) Â· Î½(f (sobs |Î¸ 0 ), Î¸ 0 ) â‰¤ Î±}
P (Î¸ 0 âˆˆ
/Î˜
X 

I f (s|Î¸ 0 ) â‰¤ zÎ¸âˆ—0 f (s|Î¸ 0 )
= P f (sobs |Î¸ 0 ) â‰¤ zÎ¸âˆ—0 =

(9)

sâˆˆS

â‰¤

zÎ¸âˆ—0

X

1 = zÎ¸âˆ—0 Â· Î½(zÎ¸âˆ—0 , Î¸ 0 ) = g(zÎ¸âˆ—0 , Î¸ 0 ) â‰¤ Î±.

sâˆˆS:0<f (s|Î¸ 0 )â‰¤zÎ¸âˆ—

0

In the first line we used the test definition and Assumption (A4); in the second line, we used the
monotonicity of g, and the fact that Î¸ 0 is the true parameter value; in the last line, we used the
definition of zÎ¸âˆ— and the uniform bound on g.
When zÎ¸âˆ— is not a discontinuity point of g, for all Î¸, then our test is exact in the sense that
b 1âˆ’Î± ) = 1 âˆ’ Î±. In general, however, this condition will not hold for all Î˜, and so the
P (Î¸ 0 âˆˆ Î˜
confidence set of Equation (8) may be conservative and lose power. We could potentially achieve
more power if instead we define the confidence set as follows:
(
b alt
Î˜
1âˆ’Î±

=

)
X 
Î¸âˆˆÎ˜:
I f (s|Î¸) â‰¤ f (sobs |Î¸) f (s|Î¸) > Î± .

(10)

sâˆˆS

Theorem 2. Suppose that Assumption (A4) holds. Consider the construction of confidence set
b alt as defined in Equation (10). Then, P (Î¸ 0 âˆˆ Î˜
b alt ) â‰¥ 1 âˆ’ Î±.
Î˜
1âˆ’Î±

1âˆ’Î±

Proof. The proof is almost identical to Theorem 1, if we replace the definition of g with g(z, Î¸) =
P
sâˆˆS I {f (s|Î¸) â‰¤ z} f (s|Î¸), z âˆˆ [0, 1]. With this definition g is a smoother function, which explains
intuitively why this construction will generally lead to more power.
b alt âŠ† Î˜
b 1âˆ’Î± almost surely since
It is straightforward to see that Î˜
1âˆ’Î±
X 
X 
I f (s|Î¸) â‰¤ f (sobs |Î¸) f (s|Î¸) â‰¤ f (sobs |Î¸)
I f (s|Î¸) â‰¤ f (sobs |Î¸) = f (sobs |Î¸)Î½(f (sobs |Î¸), Î¸).
sâˆˆS

sâˆˆS

b 1âˆ’Î± or Î˜
b alt should be
Since both constructions are valid in finite samples, the choice between Î˜
1âˆ’Î±
b 1âˆ’Î± may be easier to compute in
mainly based on computational feasibility. The construction of Î˜
practice as it depends on a summary of the distribution f (s|Î¸) through the level set function Î½, while
b alt requires full knowledge of the entire distribution. If it is computationally
the construction of Î˜
1âˆ’Î±

b alt should be preferred because it is contained in Î˜
b 1âˆ’Î± with probability one,
feasible, however, Î˜
1âˆ’Î±
as argued above. This leads to sharper inference. See also the applications on serology studies in
b alt is feasible.
Section 4 for more details, where the construction of Î˜
1âˆ’Î±

9

3.3

Concrete Procedure and Remarks

Theorems 1 and 2 imply the following simple procedure to construct a 95% confidence set:

Procedure 1
+
1. Observe the value sobs = (sâˆ’
c,obs , sc,obs , sm,obs ) of test positives in the validation study and the

main study. Create a grid Î˜ âŠ‚ [0, 1]3 for the unknown parameters Î¸ = (p, q, Ï€).
2. For every Î¸ in Î˜, calculate f (sobs |Î¸) as in Equation (4), and Î½(sobs , Î¸) as in Equation (7).
3. Reject all values Î¸ âˆˆ Î˜ for which f (sobs |Î¸)Â·Î½(f (sobs |Î¸), Î¸) â‰¤ 0.05; alternatively, we can reject

P
based on sâˆˆS I f (s|Î¸) â‰¤ f (sobs |Î¸) f (s|Î¸) â‰¤ 0.05.
b 0.95 or Î˜
b alt , respectively.
4. The remaining values in Î˜ form the 95% confidence sets Î˜
0.95
Remark 3.1 (Computation). Procedure 1 is fully parallelizable over Î¸, and so the main computational difficultly is the need to sum over the sample space S. Note, however, that Procedure 1 can
work for any choice of S given its density f (S|Î¸). Thus, our method offers valuable flexibility for
inference; for instance, f could be simulated, or S could be a simple statistic (e.g., sample averages)
and not necessarily an â€œarg maxâ€ estimator. See Section 5 for more discussion on computation.
Remark 3.2 (Identification). Procedure 1 is not a typical partial identification method in the
sense that there are settings under which the model of Equation (4) is point identified (i.e., when
Nm , Ncâˆ’ , Nc+ â†’ âˆ). However, we choose to describe Procedure 1 as a partial identification method
for two main reasons. First, it is more plausible, in practice, that the calibration studies are small
and finite (Ncâˆ’ , Nc+ < âˆ), since a calibration study needs to have high-quality, ground-truth data.
Second, it can happen that we donâ€™t have both kinds of calibration studies available (i.e., it could
be that either Ncâˆ’ = 0 or Nc+ = 0). In both of these settings, the underlying model is no longer
point identified, and so Procedure 1 is technically a partial identification method.
Remark 3.3 (Conservativeness). Procedure 1 generally produces conservative confidence intervals.
b alt ) â‰¥ Î± âˆ’ , where  = maxsâˆˆS P {f (S|Î¸ 0 ) = f (s|Î¸ 0 )}. This
However, we can show that P (Î¸ 0 âˆˆ
/Î˜
1âˆ’Î±

value is very small, in general (e.g.,  âˆ¼ 10âˆ’3 in the Santa Clara study). In this case, the alternative
b alt is almost
construction is â€œapproximately exactâ€ in the sense that the coverage probability of Î˜
1âˆ’Î±

equal to (1 âˆ’ Î±).
Remark 3.4 (Marginal inference). The parameter of interest in our application could only be the
disease prevalence, whereas the true/false positive rates of the antibody test may be considered
b 1âˆ’Î± (or Î˜
b alt ) on a single dimension to perform
â€œnuisanceâ€. In this paper, we directly project Î˜
1âˆ’Î±
marginal inference (see Section 4), but this is generally conservative, especially at the boundary
of the parameter space (Stoye, 2009; Kaido et al., 2019; Chen et al., 2018). A sharper way to do
marginal inference with our procedures is an interesting direction for future work.
10

3.4

Comparison to other methods

How does our method compare to a more standard frequentist or Bayesian approach? Here, we
discuss two key differences. First, as we have repeatedly emphasized in this paper, our method
is valid in finite samples under only independence of test results, which is a mild assumption. In
contrast, a standard frequentist approach, say based on the bootstrap, is inherently approximate
and relies on asymptotics, while a Bayesian method requires the specification of priors and posterior
sampling. Of course, our procedure requires more computation, mainly compared to the bootstrap,
and can be conservative for marginal inference (see Remark 3.4), but this is arguably a small price
to pay in a critical application such as the estimation of Covid-19 prevalence.
A second, more subtle, difference is the way our method performs inference. Specifically, we
decide whether any Î¸ âˆˆ Î˜ is in the confidence set based on the entire density f (s|Î¸) over all s âˆˆ S,
whereas both frequentist and Bayesian methods typically perform inference â€œaround the modeâ€
of the likelihood function f (sobs |Î¸) with fixed sobs âˆˆ S (we ignore how the prior specification
affects Bayesian inference to simplify exposition). This can explain, on an intuitive level, how
the inferences of the respective methods may differ. Figure 2 illustrates the difference. On the left
panel, we plot the likelihood, f (sobs |Î¸), as a function of Î¸ âˆˆ Î˜. Typically, in frequentist or Bayesian
methods, the confidence set is around the mode, say Î¸Ì‚. We see that a parameter value, say Î¸ 1 ,
with a likelihood value, f (sobs |Î¸ 1 ), that is low in absolute terms will generally not be included in
the confidence set. However, in our approach, the value f (sobs |Î¸ 1 ) is not important in absolute
terms for doing inference, but is only important relative to all other values {f (s|Î¸ 1 ) : s âˆˆ S} of the
test statistic distribution f (s|Î¸ 1 ). Such inference will typically include the mode, Î¸Ì‚, but will also
include parameter values at the tails of the likelihood function, such as Î¸ 1 . As such, our method
is expected to give more accurate inference in small-sample problems, or in settings with poor
identifiability where the likelihood is non-smooth and multimodal. We argue that we actually see
these effects in the application on Covid-19 serology studies analyzed in the following section â€”
see also Section 4.3 and Appendix D for concrete numerical examples.

4

Application

In this section, we apply the inference procedure of Section 3.3 to several serology test datasets in
the US. Moreover, we present results for combinations of these datasets, assuming that the tests
have identical specifications. This is likely an untenable assumption, but it helps to illustrate how
we can use our approach to flexibly combine all evidence. Before we present the analysis, we first
discuss some data on serology test performance to inform our inference.

11

Figure 2: Illustration of main difference between standard methods of inference, and the partial identification
method in this paper. Left: In standard methods, inference is typically based on the likelihood f (sobs |Î¸)
as a function over Î˜, and around some mode Î¸Ì‚. Parameter values with low likelihood, such as Î¸ 1 , are not
included in the confidence set. Middle & right: In our method, inference is based on the entire distribution
function f (s|Î¸) over the statistic parameter space, S. As such, Î¸Ì‚ will usually be in the confidence set (middle
plot). Moreover, Î¸ 1 will also be in the confidence set if f (sobs |Î¸ 1 ) is high relative to the rest of f (s|Î¸ 1 ) even
when f (sobs |Î¸ 1 ) is small relative to the mode f (sobs |Î¸Ì‚) (right plot).

4.1

Serology test performance

An important aspect of serology studies are the test performance characteristics. As of May 2020,
there are perhaps more than a hundred commercial serology tests in the US, but they can differ
substantially across manufacturers and technologies. In our application, we use data from Bendavid
et al. (2020), who applied a serology testing kit distributed by Premier Biotech. Bendavid et al.
(2020) used validation test results provided by the test manufacturer, and also performed a local
validation study in the lab. The combined validation study estimated a true positive rate of 80.3%
(95% CI: 72.1%-87%), and a false positive rate of 0.5% (95% CI: 0.1%-1.7%).
To get an idea about how these performance characteristics relate to other available serology
tests we use a dataset published by the FDA based on benchmarking 12 other testing kits to grant
emergency use authorization (EUA) status. The dataset is summarized in Table 2. We see that
the characteristics of the testing kit used by Bendavid et al. (2020) are compatible with the FDA
data shown in the table. For example, a true positive rate of 80% is below the mean and median of
the point estimates in the FDA dataset. A false positive rate of 0.5% falls between the median and
mean of the respective FDA point estimates. A reason for this skewness is likely the existence of
one outlier testing kit that performs notably worse than the others (Chembio Diagnostic Systems).
Removing this datapoint brings the mean false positive rate down to 0.6%, very close to the estimate
provided by Bendavid et al. (2020).

12

Test characteristic

min

median

mean

max

true positive rate (q)

point estimate
95% CI, low endpoint
95% CI, high endpoint

77.4%
60.2%
88.5%

91.1%
81%
96.7%

90.6%
80.1%
95.3%

100%
95.8%
100%

false positive rate (p)

point estimate
95% CI, low endpoint
95% CI, high endpoint

0%
0%
0.3%

0.35%
0.1%
1.6%

1.07%
0.52%
3.18%

5.6%
2.7%
11.1%

Table 2:

Performance characteristics of 12 different testing kits granted with emergency
authorization status by the FDA. Source: Author calculations based on publicly available
FDA dataset at https://www.fda.gov/medical-devices/emergency-situations-medical-devices/
eua-authorized-serology-test-performance?mod=article_inline.

4.2

Santa Clara study

In the Santa Clara study, Bendavid et al. (2020) report a validation study and main study, with
(Ncâˆ’ , Nc+ , Nm ) = (401, 197, 3330) participants, respectively. The observed test positives are sobs =
+
(sâˆ’
c,obs , sc,obs , sm,obs ) = (2, 178, 50), respectively. Given these data, we produce the 95% confidence

sets for (p, q, Ï€) following both procedures in (8) and (10) described in Section 3.3. In Figure 11
b 0.95 of Equation (8), with
of Appendix C, we jointly plot all triples in the 3-dimensional space Î˜
additional coloring based on prevalence values. We see that the confidence set is a convex space
tilting to higher prevalence values as the false positive rate of the test decreases. The true positive
rate does not affect prevalence, as long as it stays in the range 80%-95%.
To better visualize the pairwise relationships between the model parameters, we also provide
Figure 3 that breaks down Figure 11 into two subplots, one visualizing the pairs (Ï€, p) and another
b 0.95 and Î˜
b alt to illustrate the differences
visualizing the pairs (Ï€, q). The figure visualizes both Î˜
0.95

between the two constructions. From Figure 3, we see that the Santa Clara study is not conclusive
about Covid-19 prevalence. A prevalence of 0% is plausible, given a high enough false positive rate.
However, if the true false positive rate is near its empirical value of 0.5%, as estimated by Bendavid
b 0.95 .
et al. (2020), then the identified prevalence rate is estimated in the range 0.4%-1.8% in Î˜
b alt offers a sharper inference, as expected, with an estimated
Under this assumption, we see that Î˜
0.95
prevalence in the range 0.7%-1.5%. Even though, strictly speaking, the statistical evidence is not
sufficient here for definite inference on prevalence, we tend to favor the latter interval because (i)
common sense precludes 0% prevalence in the Santa Clara county (total pop. of about 2 million);
(ii) the interval generally agrees with the test performance data presented earlier, and (iii) it is
still in the low end compared to prevalence estimates from other serology studies (see Table 1).
Regardless, pinning down the false positive rate is important for estimating prevalence, especially
when prevalence is as low as it appears to be in the Santa Clara study. Roughly speaking, a decrease
of 1% in the false positive rate implies an increase of 1.3% in prevalence.
13

b 0.95 in Santa Clara study
Î˜

b alt in Santa Clara study
Î˜
0.95

b 0.95 and Î˜
b alt of the basic and the alternate 95% confidence set construction
Figure 3: Confidence sets Î˜
0.95
in Equations (8) and (10), respectively, for the Santa Clara study. Each confidence set is broken down to
pairwise relationships. All values in a shaded area are in the corresponding confidence set. The horizontal
dashed line corresponds to the empirical estimate of the false positive rate (pÌ‚ = 0.5%) of the serology test;
the dashed line corresponds to the estimate of its true positive rate (qÌ‚ = 80%); see Section 4.1 for details.

14

4.3

Santa Clara study: Comparison to other methods

In this section, we aim to discuss how our method practically compares to more standard methods
using data from the Santa Clara study. In our comparison we include Bayesian methods, a classical
likelihood ratio-based test, and the Monte Carlo-based approach to partial identification proposed
by Chen et al. (2018).8

4.3.1

Comparison to standard Bayesian and bootstrap-based methods

Due to initial criticism, the authors of the original Santa Clara study published a revision of their
work, where they use a bootstrap procedure to calculate confidence intervals for prevalence in the
range 0.7%-1.8%.9 Some recent Bayesian analyses report wider prevalence intervals in the range
0.3%-2.1% (Gelman and Carpenter, 2020). In another Bayesian multi-level analysis, Levesque and
Maybury (2020) report similar findings but mention that posterior summarization here may be
subtle, since the posterior density of prevalence in their specification includes 0%. These results
are in agreement with our analysis in the previous section only if we assume that the true false
positive rate of the serology test was near its empirical estimate (âˆ¼0.5%). We discussed intuitively
the reason for such discrepancy in Section 3.4, where we argued that standard methods typically do
inference â€œaround the modeâ€ of the likelihood, and may thus miscalculate the amount of statistical
information hidden in the tails.
For a numerical illustration, consider two parameter values, namely Î¸ 1 = (0.5%, 90%, 1.2%)
and Î¸ 2 = (1.5%, 80%, 0%), where the components denote the false positive rate, true positive rate,
and prevalence, respectively. In the Santa Clara study, f (sobs |Î¸ 1 ) = 2.2 Ã— 10âˆ’3 and f (sobs |Î¸ 2 ) =
9.58 Ã— 10âˆ’8 , that is, Î¸ 2 (which implies 0% prevalence) maps to a likelihood value that is many
orders of magnitude smaller than Î¸ 1 . In fact, Î¸ 1 is close to the mode of the likelihood, and
so frequentist or Bayesian inference is mostly based around that mode, ignoring the tails of the
likelihood function, such as Î¸ 2 . For our method, however, the small value of f (sobs |Î¸ 2 ) is moreor-less irrelevant â€” what matters is how this value compares to the entire distribution f (s|Î¸ 2 ). It
turns out that f (sobs |Î¸ 2 )Î½(f (sobs |Î¸ 2 ), Î¸ 2 ) = 0.137, that is, 13.7% of the mass of f (s|Î¸ 2 ) is below
the observed level f (sobs |Î¸ 2 ) = 9.58 Ã— 10âˆ’8 . As such, Î¸ 2 cannot be rejected at the 5% level (see
also Appendix D). This highlights the key difference of our procedure compared to frequentist or
Bayesian procedures. More generally, we expect to see such important differences between the
inference from our method and the inference from other more standard methods in settings with
small samples or poor identification (e.g., non-separable, multimodal likelihood).
8
9

All these methods are fully implemented in the accompanying code at https://github.com/ptoulis/covid-19.
Link: https://www.medrxiv.org/content/10.1101/2020.04.14.20062463v2.full.pdf.

15

4.3.2

Comparison to likehood ratio test

As briefly described in Section 3.1, our test is related to the likelihood ratio test (Lehmann and
Romano, 2006, Chapter 3). Here, we study the similarities and differences between the two tests,
both theoretically and empirically through the Santa Clara study. Specifically, consider testing a
null hypothesis that the true parameter is equal to some value Î¸ using the likelihood ratio statistic,
t(sobs |Î¸) =

f (sobs |Î¸)
.
maxÎ¸0 6=Î¸ f (sobs |Î¸ 0 )

(11)

Since f is known analytically from Equation (4), the null distribution of t(S|Î¸) can be fully
simulated. An exact p-value can then be obtained by comparing this null distribution with the
observed value t(sobs |Î¸). We can see that this method is similar to ours in the sense that both
methods use the full density f (S|Î¸) in the test, and both are exact. The main difference, however,
is that our method is using a summary of the density values f (S|Î¸) that are below the observed
value f (sobs |Î¸), which avoids the expensive (and sometimes numerically unstable) maximization in
the denominator of the likelihood ratio test in (11). Our proposed method turns out to be orders
of magnitude faster than the likelihood ratio approach as we get 50-fold to 200-fold speedups in
our setup â€” see Section 5.1 for a more detailed comparison in computational efficiency.
To efficiently compare the inference between the two tests, we sampled 5,000 different parameter
b 0.95 â€” i.e., the 95% confidence set from the basic test in Equation (8) â€” and
values from inside Î˜
b 0.95 , and then calculated the overlap between the test decisions.
5,000 parameter values from Î˜ \ Î˜
The likelihood ratio test rejected 3% of the values from the first set, and 98% of the values from the
second set, indicating a good amount of overlap between the two tests. The correlation between the
p-value from the likelihood ratio test, and the values f (sobs |Î¸)Î½(f (sobs |Î¸), Î¸), which our basic test
uses to make a decision in Equation (8), was equal to 0.94. The correlation with the alternative

confidence set construction is 0.90, using instead the values I f (s|Î¸) â‰¤ f (sobs |Î¸) f (s|Î¸) in the
above calculation. Since the likelihood ratio test is exact, these results suggest that our test
procedures are generally high-powered.
In Figures 7 and 8 of Appendix A, we plot the 95% confidence sets from the likelihood ratio test
described above for the Santa Clara study and the LA county study (of the following section). The
b 0.95 but wider than Î˜
b alt ,
estimated prevalence is 0%-1.9% for Santa Clara, which is shorter than Î˜
0.95

as reported earlier; the same holds for LA county. As with our method, prevalence here is estimated
through direct projection of the confidence set, which may be conservative. It is also possible that
b alt (we used only
with more samples the likelihood ratio test could achieve the same interval as Î˜
0.95

100 samples), but this would come at an increased computational cost. Overall, the likelihood ratio
test produces very similar results to our method, but it is not as efficient computationally.
16

4.3.3

Comparison to Monte Carlo confidence set method of Chen et al. (2018)

In recent work, Chen et al. (2018) proposed a Monte Carlo-based method of inference in partially
identified models. The idea is to sample from a quasi-posterior distribution, and then calculate
qn , the 95% percentile of {f (sobs |Î¸ (j) ), j = 1, . . .}, where Î¸ (j) denotes the j-th sample from the
posterior. The 95% confidence set is then defined as:
b = {Î¸ âˆˆ Î˜ : f (sobs |Î¸) â‰¥ qn }.
Î˜

(12)

We implemented this procedure with an MCMC chain that appears to be mixing well â€” see
b is given in Figure 10 of ApAppendix B and Figure 9 for details. The 95% confidence set, Î˜,
pendix B. Simple projection, yields a prevalence in the range 0.9%-1.43%. This suggests that our
MCMC â€œspends more timeâ€ around the mode of the likelihood, which we back up with numerical
evidence in Appendix B. Finally, we also tried Procedure 3 of Chen et al. (2018), which does not
require MCMC simulations but is generally more conservative. Prevalence was estimated in the
range 0.12%-1.65%, which is comparable to our method and the likelihood ratio test.

4.4

LA County study

Next, we analyze the results from a recent serology study in Los Angeles county, which estimated a
prevalence of 4.1% over the entire county population.10 We use the same validation study as before
since this study was executed by the same team as the Santa Clara one. Here, the main study
had Nm = 846 participants with sm,obs = 35 positives.11 For inference, we only use the alternative
b alt , of Equation (10) to simplify exposition. The results are shown in Figure 4.
construction, Î˜
0.95
In contrast to the Santa Clara study, we see that the results from this study are conclusive.
The prevalence rate is estimated in the range 1.7%-5.2%. If the false positive rate is, for example,
closer to its empirical estimate (0.5%) then the identified prevalence is relatively high, somewhere
in the range 3%-5.2%. We also see that the true positive rate is estimated in the range 85%-95%,
which is higher than the empirical point estimate of 80% provided by Bendavid et al. (2020). In
fact, the empirical point estimate is not even in the 95% confidence set. Finally, as an illustration,
we combine the data from the Santa Clara and LA county studies. The assumption is that the
characteristics of the tests used in both studies were identical. The results are shown in Figure 12 of
Appendix C. We see that 0% prevalence is consistent with the combined study as well. Furthermore,
prevalence values higher than 2.5% do not seem plausible in the combined data.
10

http://publichealth.lacounty.gov/phcommon/public/media/mediapubhpdetail.cfm?prid=2328
This number was not reported in the official study announcement mentioned above. It was reported
in a Science article referencing one of the authors of the study: https://www.sciencemag.org/news/2020/04/
antibody-surveys-suggesting-vast-undercount-coronavirus-infections-may-be-unreliable.
11

17

b alt in LA county study
Î˜
0.95

b alt for the LA county study. We see that the evidence for Covid-19
Figure 4: Visualization of Î˜
0.95
prevalence are stronger than the Santa Clara study. Prevalence is estimated in the range 1.7%-5.2%.
This is shortened to 3%-5.2% if we assume a 0.5% false positive rate for the antibody test.

4.5

New York study

Recently, a quasi-randomized study was conducted in New York state, including NYC, which
sampled individuals shopping in grocery stores. Details about this study were not made available.
Here, we assume that the medical testing technology used was the same as in the Santa Clara and
LA county studies, or at least similar enough that the comparison remains informative.
Under this assumption, we can use the same validation study as before, with (Ncâˆ’ , Nc+ ) =
+
(401, 197) participants in the validation study, and (sâˆ’
c,obs , sc,obs ) = (2, 178) positives, respectively.

The main study in New York had Nm = 3000 participants with sm,obs = 420 observed test posib alt confidence set on this dataset is shown in Figure 5. We see that the evidence in
tives.12 The Î˜
0.95

this study is much stronger than the Santa Clara/LA county studies with an estimated prevalence
in the range 12.9%-16.6%. The true positive rate is now an important identifying parameter in the
sense that knowing its true value could narrow down the confidence set even further.
12

https://www.nytimes.com/2020/04/23/nyregion/coronavirus-antibodies-test-ny.html

18

b alt in New York study
Î˜
0.95

b alt , for New York State study. We see that this study
Figure 5: Visualization of confidence set, Î˜
0.95
gives strong evidence for prevalence in the range 13%-16.6%.
Finally, in Figure 13 of Appendix C we present prevalence estimates for a combination of
b 0.95 and Î˜
b alt , to illustrate their
all datasets presented so far, while using both constructions, Î˜
0.95
differences. As mentioned earlier, this requires the assumption that the antibody testing kits used
in all three studies had identical specifications, or at least very similar so that the comparison
remains informative. This assumption is most likely untenable given the available knowledge.
However, we present the results there for illustration and completeness. The general picture in the
combined study is a juxtaposition of earlier findings. For example, both false and positive rates
b alt
are now important for identification. The identified prevalence is in the range 5.2%-8.2% in Î˜
0.95

b 0.95 ). These numbers are larger than the Santa Clara/LA county studies but
(and 3.2%-8.9% in Î˜
smaller than the New York study.

19

5

Discussion

5.1

Computation

The procedure described in Section 3.3 is computationally intensive for two main reasons. First,
we need to consider all values of Î¸ âˆˆ Î˜, which is a three-dimensional grid. Second, given some Î¸,
we need to calculate f (s|Î¸) for each s âˆˆ S, which is also a three-dimensional grid.
To deal with the first problem we can use parallelization, since the test decisions in step 3 of
our procedure are independent of each other. For instance, the results in Section 4 were obtained
in a computing cluster (managed by Slurm) comprised of 500 nodes, each with x86 architecture,
64-bit processors, and 16GB of memory. The total wall clock time to produce all results of the
previous section was about 1 hour. The results for, say, the Santa Clara study can be obtained
in much shorter time (a few minutes) because they contain few positive test results. To address
the second computational bottleneck we can exploit the independence property between Scâˆ’ , Sc+ ,
and Sm , as shown in the product of Equation (4). Since any zero term in this product implies a
zero value for f , we can ignore all individual term values that are very small. Through numerical
experiments, we estimate that this computational trick prunes on average 97% of S leading to a
significant computational speedup. For example, to test one single value Î¸ âˆˆ Î˜ takes about 0.25
seconds in a typical high-end laptop, which is a 200-fold speedup compared to 50 seconds required
by the likelihood ratio test of Section 4.3.2 â€” see Appendix A for more details.

5.2

Extrapolation to general population

As mentioned earlier, prevalence Ï€ in Equation (2) is a finite-population estimand, that is, it is a
number that refers to the particular population in the study. Theorem 1 shows that our procedure
is valid for Ï€ only under Assumption (A4). However, to extrapolate to the general population we
generally need to assume that
Icâˆ’ , Ic+ , Im are random samples from the population.

(A3)

This is currently an untenable assumption. For example, in the Santa Clara study the population of middle-aged white women was overrepresented, while the population of Asian or Latino
communities was underrepresented. The impact from such selection bias on the inferential task is
very hard to ascertain in the available studies. Techniques such as post-stratification or reweighing
can help, but at this early stage any extrapolation using distributional assumptions would be too
speculative. However, selection bias is a well-known issue among researchers, and can be addressed
as widespread and carefully designed antibody testing catches on. We leave this for future work.
20

6

Concluding Remarks

In this paper, we presented a partial identification method for estimating prevalence of Covid-19
from randomized serology studies. The benefit of our method is that it is valid in finite samples,
as it does not rely on asymptotics, approximations or normality assumptions. We show that some
recent serology studies in the US are not conclusive (0% prevalence is in the 95% confidence set).
However, the New York study gives strong evidence for high prevalence in the range 12.9%-16.6%. A
combination of all datasets shifts this range down to 5.2%-8.2%, under a test uniformity assumption.
Looking ahead, we hope that the method developed here can contribute to a more robust analysis
of future Covid-19 serology tests.

7

Acknowledgments

I would like to thank Guanglei Hong, Ali Hortascu, Chuck Manski, Casey Mulligan, Joerg Stoye, and
Harald Uhlig for useful suggestions and feedback. Special thanks to Connor Dowd for his suggestion
of the alternative construction (10), and to Elie Tamer for various important suggestions. Finally,
I gratefully acknowledge support from the John E. Jeuck Fellowship at Booth School of Business.

References
Alvarez, F. E., Argente, D. and Lippi, F. (2020). A simple planning problem for covid-19 lockdown.
Tech. rep., National Bureau of Economic Research.
Baggett, T. P., Keyes, H., Sporn, N. and Gaeta, J. M. (2020). Prevalence of sars-cov-2 infection in
residents of a large homeless shelter in boston. JAMA.
Bendavid, E., Mulaney, B., Sood, N., Shah, S., Ling, E., Bromley-Dulfano, R., Lai, C., Weissberg, Z., Saavedra, R., Tedrow, J. et al. (2020). Covid-19 antibody seroprevalence in santa clara
county, california. medRxiv.
Beresteanu, A., Molchanov, I. and Molinari, F. (2012). Partial identification using random set
theory. Journal of Econometrics, 166 17â€“32.
Chen, X., Christensen, T. M. and Tamer, E. (2018). Monte carlo confidence sets for identified sets.
Econometrica, 86 1965â€“2018.
Chernozhukov, V., Hong, H. and Tamer, E. (2007). Estimation and confidence regions for parameter
sets in econometric models 1. Econometrica, 75 1243â€“1284.
Doi, A., Iwata, K., Kuroda, H., Hasuike, T., Nasu, S., Kanda, A., Nagao, T., Nishioka, H., Tomii,
K., Morimoto, T. et al. (2020). Estimation of seroprevalence of novel coronavirus disease (covid-19)
using preserved serum at an outpatient setting in kobe, japan: A cross-sectional study. medRxiv.

21

Flaxman, S., Mishra, S., Gandy, A., Unwin, H., Coupland, H., Mellan, T., Zhu, H., Berah, T.,
Eaton, J., Perez Guzman, P. et al. (2020). Report 13: Estimating the number of infections and the
impact of non-pharmaceutical interventions on covid-19 in 11 european countries.
Garcia-Basteiro, A. L. et al. (2020). Seroprevalence of antibodies against sars-cov-2 among health care
workers in a large spanish reference hospital. medRxiv.
Gelman, A. and Carpenter, B. (2020). Bayesian analysis of tests with unknown specificity and sensitivity.
medRxiv.
HonoreÌ, B. E. and Tamer, E. (2006). Bounds on parameters in panel dynamic discrete choice models.
Econometrica, 74 611â€“629.
HortacÌ§su, A., Liu, J. and Schwieg, T. (2020). Estimating the fraction of unreported infections in
epidemics with a known epicenter: an application to covid-19. Tech. rep., National Bureau of Economic
Research.
Imbens, G. W. and Manski, C. F. (2004). Confidence intervals for partially identified parameters. Econometrica, 72 1845â€“1857.
Kaido, H., Molinari, F. and Stoye, J. (2019). Confidence intervals for projections of partially identified
parameters. Econometrica, 87 1397â€“1432.
Lavezzo, E., Franchin, E., Ciavarella, C., Cuomo-Dannenburg, G., Barzon, L., Del Vecchio,
C., Rossi, L., Manganelli, R., Loregian, A., Navarin, N. et al. (2020). Suppression of covid-19
outbreak in the municipality of vo, italy. medRxiv.
Lehmann, E. L. and Romano, J. P. (2006). Testing statistical hypotheses. Springer Science & Business
Media.
Levesque, J. and Maybury, D. W. (2020). A note on covid-19 seroprevalence studies: a meta-analysis
using hierarchical modelling. medRxiv.
Li, R., Pei, S., Chen, B., Song, Y., Zhang, T., Yang, W. and Shaman, J. (2020). Substantial
undocumented infection facilitates the rapid dissemination of novel coronavirus (sars-cov2). Science.
Liang, Y., Liang, J., Zhou, Q., Li, X., Lin, F., Deng, Z., Zhang, B., Li, L., Wang, X., Zhu, H.
et al. (2020). Prevalence and clinical features of 2019 novel coronavirus disease (covid-19) in the fever
clinic of a teaching hospital in beijing: a single-center, retrospective study. medRxiv.
Lu, F. S., Nguyen, A., Link, N. and Santillana, M. (2020). Estimating the prevalence of covid-19 in
the united states: Three complementary approaches.
Manski, C. F. (2003). Partial identification of probability distributions. Springer Science & Business Media.
Manski, C. F. (2007). Partial identification of counterfactual choice probabilities. International Economic
Review, 48 1393â€“1410.

22

Manski, C. F. (2010). Partial identification in econometrics. In Microeconometrics. Springer, 178â€“188.
Manski, C. F. and Molinari, F. (2020). Estimating the covid-19 infection rate: Anatomy of an inference
problem. Tech. rep., National Bureau of Economic Research.
Romano, J. P. and Shaikh, A. M. (2008). Inference for identifiable parameters in partially identified
econometric models. Journal of Statistical Planning and Inference, 138 2786â€“2807.
Romano, J. P. and Shaikh, A. M. (2010). Inference for the identified set in partially identified econometric
models. Econometrica, 78 169â€“211.
Spellberg, B., Haddix, M., Lee, R., Butler-Wu, S., Holtom, P., Yee, H. and Gounder, P. (2020).
Community prevalence of sars-cov-2 among patients with influenzalike illnesses presenting to a los angeles
medical center in march 2020. JAMA.
Stoye, J. (2009). More on confidence intervals for partially identified parameters. Econometrica, 77 1299â€“
1315.
Stringhini, S., Wisniak, A., Piumatti, G., Azman, A. S., Lauer, S. A., Baysson, H., De Ridder,
D., Petrovic, D., Schrempft, S., Marcus, K. et al. (2020). Repeated seroprevalence of anti-sarscov-2 igg antibodies in a population-based sample from geneva, switzerland. medRxiv.
Sutton, D., Fuchs, K., Dalton, M. and Goffman, D. (2020). Universal screening for sars-cov-2 in
women admitted for delivery. New England Journal of Medicine.
Tamer, E. (2010). Partial identification in econometrics. Annu. Rev. Econ., 2 167â€“195.
Venkatesan, P. (2020). Estimate of covid-19 case prevalence in india based on surveillance data of patients
with severe acute respiratory illness. medRxiv.
Wooldridge, J. and Imbens, G. (2007). Whats new in econometrics? lecture 9: partial identification.
NBER Summer Institute, 9 2011.
Yadlowsky, S., Shah, N. and Steinhardt, J. (2020). Estimation of sars-cov-2 infection prevalence in
santa clara county. medRxiv.

23

Appendix
A

More details on the likelihood ratio test

The concrete testing procedure for the likelihood ratio test of Section 4.3.2 is as follows.
1. Define the test statistic:
t(s|Î¸) =

f (s|Î¸)
.
maxÎ¸0 6=Î¸ f (s|Î¸ 0 )

2. Calculate the observed value tobs = t(sobs |Î¸).
3. Sample {s(j) , j = 1, . . . , r} from f (S|Î¸) (we set r = 1, 000 samples).
4. Calculate the one-sided p-value as

1
r

Pr

j=1 I{t(s

(j) |Î¸)

â‰¥ tobs }.

For the maximization in the denominator of t(s|Î¸) we use the standard BFGS algorithm on a
natural re-parameterization. Specifically, we define the natural parameters as follows:
Ïˆ0 = logit(p); Ïˆ1 = logit(q); Ïˆ2 = logit(Ï€),
where (p, q, Ï€) â‰¡ Î¸ are the original model parameters, i.e., false positive rate, true positive rate, and
prevalence, respectively; and logit(z) = log(z/(1 âˆ’ z)), z âˆˆ (0, 1). To avoid numerical instabilities
we define logit(0) = log(/(1 âˆ’ )) and logit(1) = log((1 âˆ’ )/), where  is a small constant, e.g.,
 =1e-8. Since the natural parameter Ïˆ = (Ïˆ0 , Ïˆ1 , Ïˆ2 ) is unconstrained, the optimization routine
becomes faster and easier; mapping back from Ïˆ to Î¸ is also straightforward.
The maximization takes about 0.05 seconds of wall-clock time in a typical high-end laptop.13
It therefore takes a total of 50 seconds to test one single hypothesis based on 1,000 samples of the
likelihood ratio. In contrast, our partial identification method takes 0.25 seconds of wall-clock time
to test the same single null hypothesis, a 200-fold speedup. As explained in Section 5.1 this is
because the computation of f (s|Î¸) can be done very efficiently due to the decomposition of f into
three independent terms in Equation (4).
Since the likelihood ratio test cannot be fully implemented, we chose to sample randomly 5,000
b 0.95 , and 5,000 values from Î˜ \ Î˜
b 0.95 , and then
parameter values from the basic confidence set, Î˜
test each value using the likelihood ratio test. The idea is to explore the agreement of the two tests.
The overlap between the likelihood ratio test decisions and the basic construction is 97.3% for the
b 0.95 , and 97.7% for the values from Î˜ \ Î˜
b 0.95 . There was even more agreement with
values from Î˜
13

CPU: Intel(R) Core(TM) i7-8559U CPU at 2.70GHz; Memory: 16 GB 2133 MHz LPDDR3.

24

the alternative construction, specifically 97.3% and 99.6%, respectively. Figure 6 also shows some
more detailed results. The x-axis represents the p-value generated in step 4 of the likelihood ratio
test. The y-axis represents the â€œstrength of evidenceâ€ calculated by our procedure. For the basic
b 0.95 , of Equation (8) the strength of evidence is defined as f (sobs |Î¸)Î½(f (sobs |Î¸), Î¸)
construction, Î˜
b alt , of
â€” the larger this value is, the stronger we reject. For the alternative construction, Î˜
0.95
P
Equation (10) the value is defined as sâˆˆS I{f (s|Î¸) â‰¤ f (sobs |Î¸)}f (s|Î¸). We see high correlation
between the different tests (0.94 and 0.90, respectively).

Figure 6: Relationship between likelihood ratio test and our testing procedures, namely the â€œclassicâ€
construction of Equation (8), and the alternative construction in Equation (10).

25

Santa Clara study

LA county study

Figure 7: 95% confidence set from likelihood ratio test-based procedure of Section 4.3.2 for Santa
Clara study (top) and LA county study (bottom).

26

Santa Clara study and LA county study, combined

Figure 8: 95% confidence set from likelihood ratio test-based procedure of Section 4.3.2 for Santa
Clara study and LA county study combined.

27

B

More details on Monte Carlo confidence sets

To implement the method of Chen et al. (2018) we used the following procedure.
1. We defined the natural parameter, Ïˆ as in the previous section, and imposed a uniform prior:
f (Ïˆ) âˆ 1.
2. We implement the Metropolis-Hastings algorithm through a symmetric proposal distribution,
b Ïƒ 2 I), where Ïˆ
b is the maximum-likelihood estimate.
q(Ïˆ 0 |Ïˆ) âˆ¼ N (Ïˆ,
3. We run the Metropolis-Hastings for 200,000 iterations and got samples from the posterior
distribution f (Ïˆ|sobs ) âˆ f (sobs |Ïˆ)f (Ïˆ). We discarded the first 20% of the posterior samples.
Figure 9 shows that the MCMC chain appears to be mixing well.
4. We transformed the Ïˆ samples back as Î¸ samples, and calculated qn , the 95% percentile of
{f (sobs |Î¸ (j) ), j = 1, . . .}, where Î¸ (j) denotes the j-th sample. The 95% confidence set is then
defined as:
b = {Î¸ âˆˆ Î˜ : f (sobs |Î¸) â‰¥ qn }.
Î˜
The 95% posterior credible interval (shown in the bottom panel of Figure 9) was 0.27%-1.56%,
which is similar but slightly more narrow than the intervals from the Bayesian analyses described in
b defined above is visualized in Figure 10. Simple projection,
Section 4.3. The 95% confidence set, Î˜,
yields a prevalence in the range 0.9%-1.43%. We note that 0.9% corresponds to 32 true positives
out of total 50 positives in the Santa Clara study. We can see from Figure 9 that this number
corresponds to the mode of the posterior marginal distribution for prevalence. Given the symmetry
of this posterior distribution around the mode, it is surprising that the low-end of the confidence
set corresponds to 0.9% prevalence (i.e, 32 true positives out of 3,330 tests). We can explain this
discrepancy numerically by checking that values higher than 32 (prevalence higher than 0.9%), that
is, values on the right-end of the marginal posterior distribution, generally map to (much) higher
likelihood values compared to values on the left-end. So, even though the marginal posterior looks
b defined above is based on the
symmetric, the likelihood values are not. Since, the confidence set Î˜
likelihood values, it will be â€œskewedâ€ towards higher values of Î¸.

28

Figure 9: Mixing plots for the MCMC chain used to construct the 95% confidence set described in
Section 4.3.3.

29

b produced by Procedure 1 of Chen et al.
Figure 10: The MCMC-based 95% confidence set, Î˜,
(2018).

30

C

Additional results from serology studies in the US

Here, we present additional results from our analysis on serology studies from the US. In particular,
we combine datasets from various studies and analyze the results. This requires the assumption
that the antibody testing kits used in all three studies had identical specifications, or at least very
similar so that the comparison remains informative.

b 0.95 , for Santa Clara study, comprised of triples Î¸ = (p, q, Ï€).
Figure 11: Confidence set, Î˜

31

b 0.95 in Santa Clara & LA county studies, combined
Î˜

b alt in Santa Clara & LA county studies, combined
Î˜
0.95

b 0.95 and Î˜
b alt , for the Santa Clara and LA county
Figure 12: Visualization of confidence sets, Î˜
0.95
studies, combined. The combined results are inconclusive (0% prevalence is in the confidence sets).
32

b 0.95 in Santa Clara, LA county & NY studies, combined
Î˜

b alt in Santa Clara, LA county & NY studies, combined
Î˜
0.95

b 0.95 and Î˜
b alt , for Santa Clara, LA county and New
Figure 13: Visualization of confidence sets, Î˜
0.95
York studies, combined. Assuming the data combination is valid, the combined dataset estimates
Covid-19 prevalence in the range 5.2%-8.2%.
33

D

Numerical example illustrating differences with likelihood-based
methods

Here, we illustrate the differences between our proposed inferential method and likelihood-based
methods (both Bayesian and frequentist) through a simple numerical example. Suppose that S is
such that |S| = N , with N extremely large, and fix some parameter value Î¸ 1 to test. Suppose also
that the conditional density f (S|Î¸ 1 ) is defined as:
f (s0 |Î¸ 1 ) = 0.95 âˆ’ 1 , f (s1 |Î¸ 1 ) = , and f (s|Î¸ 1 ) = (0.05 âˆ’  + 1 )/(N âˆ’ 2), âˆ€s âˆˆ S \ {s0 , s1 }.
Set both  and 1 to be infinitesimal values. As such, under Î¸ 1 we observe s0 with probability
roughly equal to 0.95, or s1 with some very small probability , or observe any other remaining
value from S uniformly at random.
Suppose we observe sobs = s1 in the data. Should we reject or accept Î¸ 1 ?
Since we can make  arbitrarily small, an inferential method that focuses only on the likelihood
function, would conclude that any Î¸ âˆˆ Î˜ is more plausible than Î¸ 1 , as long as f (sobs |Î¸) >> .
Both frequentist and Bayesian methods would agree to such conclusion, and typically would perform
inference around the mode of f (sobs |Î¸) with respect to Î¸. However, our procedure makes a different
conclusion, and actually accepts Î¸ 1 (at the 5% level)! The reason is that
X

I{f (s|Î¸ 1 ) â‰¤ f (sobs |Î¸ 1 )}f (s|Î¸ 1 ) =  +

sâˆˆS

0.05 âˆ’  + 1
(N âˆ’ 2) = 0.05 + 1 > 0.05.
N âˆ’2

That is, even though f (sobs |Î¸ 1 ) is equal to a tiny value, there is still 5% of the mass of f (s|Î¸ 1 ) at
or below that value.

34

