ROUGH -F UZZY CPD: A G RADUAL C HANGE P OINT D ETECTION
A LGORITHM

arXiv:2010.06370v1 [stat.ME] 10 Oct 2020

A P REPRINT
Ritwik Bhaduri
Indian Statistical Institute
Kolkata, India
ritwik.bhaduri@gmail.com

Subhrajyoty Roy
Indian Statistical Institute
Kolkata, India
roysubhra98@gmail.com

Sankar K. Pal
Center for Soft Computing Research,
Indian Statistical Institute
Kolkata, India
sankar@isical.ac.in

October 14, 2020

A BSTRACT
Changepoint detection is the problem of finding abrupt or gradual changes in time series data when
the distribution of the time series changes significantly. There are many sophisticated statistical
algorithms for solving changepoint detection problem, although there is not much work devoted
towards gradual changepoints as compared to abrupt ones. Here we present a new approach to solve
changepoint detection problem using fuzzy rough set theory which is able to detect such gradual
changepoints. An expression for the rough-fuzzy estimate of changepoints is derived along with its
mathematical properties concerning fast computation. In a statistical hypothesis testing framework,
asymptotic distribution of the proposed statistic on both single and multiple changepoints is derived
under null hypothesis enabling multiple changepoint detection. Extensive simulation studies have
been performed to investigate how simple crude statistical measures of disparity can be subjected to
improve their efficiency in estimation of gradual changepoints. Also, the said rough-fuzzy estimate
is robust to signal-to-noise ratio, high degree of fuzziness in true changepoints and also to hyper
parameter values. Simulation studies reveal that the proposed method beats other fuzzy methods
and also popular crisp methods like WBS, PELT and BOCD in detecting gradual changepoints. The
applicability of the estimate is demonstrated using multiple real-life datasets including Covid-19.
We have developed the python package roufcp for broader dissemination of the methods.
Keywords Gradual changepoint detection Â· Fuzzy set Â· Rough set Â· Rough-fuzzy Entropy Â· Python package roufcp

1

Introduction

Changepoint detection (CPD) is the process of detecting changes in the probability distribution of a time series data.
There are mainly two different directions of the usabiliy of CPD. First direction concerns with the subject of statistical
quality control, where any kind of abrupt changes in the data generating process of a time series observation can be
detected through CPD methods, which serves the purpose of alarming the concerning authority [1]. On the other hand,
various time series modelling rely on CPD techniques to segment the study period, and then apply different modelling
for each homogeneous segments [2].
First CPD method was possibly proposed by Hinkley [3] based on the likelihood function and it was able to detect at
most one changepoint present in the data. With a clustering approach, Scott and Knott [4] extended the idea to the
detection of multiple changepoints based on Binary Segmentation, which was theoretically corroborated by a similar
study of Sen and Srivastava [5]. Picard [6] extended the algorithm to a much general setup, using a generalized
version of Kolmogorov-Smirnov statistic, as well as its simplification towards the mean and variance change in an
autoregressive process. Some recent and popular algorithms for CPD include Pruned Exact Linear Time (PELT) [7],
Bayesian Change-point Detection analysis [8, 9, 10], Kernel Change-point Detection [11], Change-point detection
using nonparametric statistical measures [12].

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

While there remains a vast amount of literature and existing methods on detection of abrupt changepoints [13, 14, 15],
very few studies are concerned with gradual changepoints [16]. However, in different domains such as linguistics [17],
paleoclimatology [18], paleontology [19], and paleobiology [20], the changes in different phenomenons are often
gradual in nature and not abrupt. In such cases, the changepoint detection algorithms developed to tackle the abrupt
changes are found to be inefficient in estimation due to relatively larger variance. However, combining the theory
of Fuzzy Rough sets allows an improvement over existing CPD algorithms in terms of increasing the efficiency in
estimation, as will be shown in the paper.
The very few investigations focused on detection of fuzzy or gradual changepoints are based on fuzzy clustering techniques. Almost all of them [16, 21] use fuzzy c-means clustering method or its variants to segment the period of study
into homogeneous segments. Other approaches include fuzzy regression algorithms [22, 16], and neural networks [23].
No approach considers the discernibility issues that are prevalent in the examples with gradual changepoints, for instance, observations pertaining to two close time points would naturally come from a similar kind of distributions,
converting each of the segments into a rough set instead of a crisp one. The present paper aims to provide a general
methodology based on fuzzy rough sets to increase the efficiency of any statistical measure that can be used to detect
changepoints.
The novelty of this paper is three fold. The first aspect is that we mathematically model uncertainty associated with
gradual changepoints as a fuzzy set and the indiscernibility between very close time points using rough set theory.
This enables us to devise a changepoint detection algorithm which is relatively robust to both low signal-to-noise ratio
of the data and the high degree of fuzziness of the actual changepoint. Simulation studies show that our estimates
remain fairly accurate over an extensive range of hyper parameter values furthering the robustness of the proposed
method. The second aspect of this paper is that we connect the image segmentation problem from the field of Pattern
Recognition and the changepoint detection problem from statistical domain. This connection was discussed by Chatterjee et al. [24], where they had formally expressed image segmentation as a special case of changepoint detection
problem. However, our work can be interpreted as going to a reverse direction, by generalization of methods proposed
for image segmentation by Sen and Pal [25] for the problem of changepoint detection. The third component of novelty
is reducing the computational complexity of the aforementioned image segmentation algorithm by a series of results,
and fitting the algorithm in the context of statistical changepoint detection problem. To formally present the proposed
algorithm in conjunction with a statistical hypothesis testing framework, we derive the asymptotic distribution of the
proposed rough-fuzzy estimator under some suitable regularity conditions. This enables us to test for false positives
of the detected changepoints and also allows for multiple changepoint detection. The performance of the proposed
method has been illustrated using extensive simulation studies as well as real data applications including COVID-19
dataset. We observe that our method outperforms other fuzzy CPD methods as well as state of the art crisp CPD
methods like Wild Binary Segmentation, PELT and BOCD in detecting gradual changepoints. The implementation of
our method is made available through a python package roufcp, bearing the acronym for the name of the proposed
algorithm Rough-Fuzzy CPD.
The rest of the paper is organized as follows: In section 2, we formulate the problem of CPD and provide a brief introduction to fuzzy set, rough set, and the entropy used to define our statistic. Section 3 provides a general development of
the proposed method and defines a rough-fuzzy estimate of change point. Section 4 contains the mathematical results
of the paper, divided into two subsections. The first subsection deals with the reduction of computational complexity
of the proposed method, while the second subsection provides an asymptotic result which can be put into hypothesis
testing framework to detect false positives and multiple changepoint detection. In section 5, we perform extensive
simulation studies of the performance of the proposed model under different signal-to-noise ratios, levels of fuzziness
of actual changepoint and hyper parameter values. We also compare the performance of our algorithm Rough-Fuzzy
CPD with other fuzzy as well as crisp methods for different simulation setups. In section 6, we apply the proposed
method on real-life datasets. Section 7 concludes the paper with adequate discussion on strengths and a few limitations
of the proposed method, as well as the possibility of future extensions of our work.

2
2.1

Mathematical Backgrounds
Problem of changepoint Detection
T

The mathematical setup of the problem of changepoint detection starts with a multivariate time series signal {yt }t=1 ,
where each yt âˆˆ Rp . There also exist some fixed points 1 < tâˆ—1 < tâˆ—2 < . . . tâˆ—k < T , such that within the interval
2

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT



t(iâˆ’1) , ti , the time series observations follow same probability distributional model, but these models differ from
one interval to another. In particular,
ï£±
ï£´
F0 (t)
if 1 â‰¤ t < t1
ï£´
ï£´
ï£´
ï£´
if t1 â‰¤ t < t2
ï£²F1 (t)
yt âˆ¼ . . .
...
ï£´
ï£´
ï£´
F(kâˆ’1) (t) if t(kâˆ’1) â‰¤ t < tk
ï£´
ï£´
ï£³F (t)
if tk â‰¤ t â‰¤ T
k

(1)

and Fi 6= F(i+1) for i = 0, 1, . . . (kâˆ’1). A special case follows when the signal is assumed to be piece-wise stationary.
The problem of CPD deals with identifying the set of points {t1 , t2 , . . . tk } where the distribution or behavior of the
signal changes, from the knowledge of the available time series observations yt â€™s. The knowledge of the number of
changepoints k may or may not be known a-priori, in which case it also has to be estimated from the data.
A general framework for existing CPD algorithms is provided in a comprehensive review by Truong et al. [26]. Most
of the existing algorithms involve minimization of a criterion function V (T , y) to obtain the best set of changepoints
T,

V (T , y) =

k


X
t
c {yt }ti(iâˆ’1) + Penalty(T )

(2)

i=1

2.2

Fuzzy Set

Fuzzy sets, proposed by Lotfi A. Zadeh [27], provide a mathematical means of modelling vagueness and imprecise
information. They are a generalization of crisp sets or normal sets. A fuzzy set is represented by an ordered pair
hX, Âµi. Denoting U as the universe of objects, and X âŠ† U, the membership function for the set X can be described
as Âµ : U â†’ [0, 1], indicating the degree on inclusion of an element x âˆˆ U into the set X. Consequently, 3 cases are
possible based on the value of Âµ(x):
1. Not included in hX, Âµi if Âµ(x) = 0.
2. Partially included in hX, Âµi if 0 < Âµ(x) < 1.
3. Fully included in hX, Âµi if Âµ(x) < 1.
While fuzzy sets have been extensively used in fields like control systems for electronic devices [28], decision-making
support systems in businesses [29], prediction systems in finance [30], quantitative pattern analysis for industrial
quality assurance [31], and uncertainty modelling in pattern recognition, image processing and vision [32], its use in
changepoint analysis and statistics, in general, has been very limited. In this paper, we shall model the membership of
a data point to a particular distribution as a fuzzy set to characterize the ambiguity in the data generation process.
2.3

Rough set

The notion of rough sets, as introduced by Pawlak [33], is defined as follows: Let A = hU, Ai be an information
system, where U is the universe of all objects as mentioned before, and A be the set of attributes which are used to
identify two elements of U. Let B âŠ† A be a subset of attributes and X âŠ† U. We can approximate the set X using only
the information contained in B by constructing lower and upper approximations of X. Let [x]B denote the equivalence
class of object x relative to IB (equivalence relation induced by the variables in B). In rough set theory, the upper and
lower approximations of the set X under IB are defined as follows;
â€¢ BX = B-Lower approximation of X in U ={x âˆˆ U : [x]B âŠ† X}
â€¢ BX = B-upper approximation of X in U = {x âˆˆ U : [x]B âˆ© X 6= Ï†}
So, the lower approximation of a set X relative to B in U are the elements in U which can be certainly classified as
elements of X based on B. Intuitively, it is the set of all elements x in U such that the equivalence class containing x
is a subset of target set X. In other words, the lower approximation is the set of objects that are certainly members of
the target set X.
3

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

On the other hand, the upper approximation is the complete set of objects x such that the equivalence class containing
x has non empty intersection with X. Intuitively, it is the set of elements in U/B that cannot be positively (i.e.,
unambiguously) classified as belonging to the complement of X of the target set X. In contrast to lower approximation,
the upper approximation is the complete set of objects that are certainly as well as possibly members of the target set
X.
The pair hBX, BXi denotes the rough representation of the crisp set X with respect to B. This rough representation
actually captures the uncertainty in defining X in view of the incomplete information provided by the subset of
attributes B. Pawlak [34] provided a numerical characterization of roughness of X as
|BX|
ÏB (X) = 1 âˆ’
(3)
|BX|
So ÏB = 0 means, the set X is crisp or exact (with respect to B) and conversely, ÏB > 0 means, X is rough, i.e.
ambiguous, with respect to B. This vague definition of X in U (in terms of lower and upper approximations) signifies
incompleteness of knowledge about U.
2.4

Lower and upper approximations of a fuzzy set

Similar to the lower and upper approximation of a crisp set, definition of such approximations for a fuzzy set can also
be established. While the definition of lower and upper approximations of a set may vary based on the nature of set
X (crisp or fuzzy) as well as the nature of relation between elements of the universe U, here, we are only concerned
with approximations of a fuzzy set X with respect to an indiscernibility relation R which is either an equivalence
relation (crisp or fuzzy) or a tolerance relation (crisp or fuzzy). The expressions of upper and lower approximations
for both these cases have been derived by Sen and Pal [25]. Since the set approximations obtained using equivalence
relations are not always smooth, we will restrict our consideration only on the tolerance relations. The general implicit
expressions of these approximations are given below, while a more explicit form of such approximations will be
derived later in eqn. 4.
A tolerance relation (crisp or fuzzy) is a (crisp or fuzzy) relation which satisfies (crisp or fuzzy) reflexivity and symmetry. Unlike equivalence relations, tolerance relations are not necessarily transitive. When R is a tolerance relation, the
space hU, Ri is called tolerance approximation space. Associated with a tolerance relation R, there is a membership
function SR of the relation itself, where SR (u, v) denotes the membership value of the pair (u, v) belonging to the
relation R. With the help of these, the lower and upper approximations of any crisp or fuzzy set X are obtained as
follows;
RX = {(u, M (u))|u âˆˆ U}
(4)
RX = {(u, M (u))|u âˆˆ U}
where the approximations of the membership functions are based on the tolerance function SR of the relation R;
M (u) = inf max(1 âˆ’ SR (u, Ïˆ), ÂµX (Ïˆ))
ÏˆâˆˆU
(5)
M (u) = sup min(SR (u, Ïˆ), ÂµX (Ïˆ))
ÏˆâˆˆU

where ÂµX , which takes values in the interval [0, 1], is the membership function associated with set X. When X is a
crisp set, ÂµX would take values only from the set {0, 1}. Similarly, when R is a crisp tolerance function, SR (u, Ïˆ)
would take values only from the set {0, 1}.
2.5

Entropy measures

Now, using the definitions of upper and lower approximations of a set, an entropy can be defined to quantify the
ambiguity in description of X. While the roughness measure ÏB (X) as in eqn. 3 gives a measure of ambiguity in the
description of X, they are needed to be transformed to properly describe information gain. In this regard, two types of
gain functions as defined by Pal and Pal [35] are considered.
2.5.1

Logarithmic entropy

This is derived by using logarithmic function to measure the gain in incompleteness similar to â€œgain in information"
in Shanonâ€™s entropy. The logarithmic entropy measure for quantifying the incompleteness of knowledge about U with
respect to the definability of a set X âˆˆ U is given as

1
L
HR
(X) = âˆ’ Ï‡(X) + Ï‡(X C )
(6)
2
4

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT



where for any set D âˆˆ U, Ï‡(D) = ÏR (D) logÎ² ÏRÎ²(D) . Note that the â€œgain in incompleteness" term is taken as


logÎ² ÏRÎ²(D) and for Î² > 1 it takes values in [1, âˆ].
2.5.2

Exponential entropy

The other kind of entropy measure is defined using exponential function for the â€œgain in incompleteness". This class of
entropy is derived using Ï‡(D) = ÏR (D)Î² ÏR (D) where ÏR (D) = 1 âˆ’ ÏR (D). So the expression of entropy becomes;

C
1
E
HR
(X) = âˆ’
ÏR (X)Î² ÏR (X) + ÏR (X C )Î² ÏR (X )
(7)
2
Here the gain in incompleteness term is taken as Î² (1âˆ’ÏR ) which takes values in [1, Î²] when Î² > 1. This class
of exponential entropy functions possesses various desirable properties which are not present in the usual Shanonâ€™s
entropy as illustrated by Pal and Pal [35]. Some of them are as follows:
1. In Shanonâ€™s entropy the gain in information log(1/p) â†’ âˆ as p â†’ 0 and is undefined for p = 0. However,
in real life, gain in information from an event, whether highly unlikely or highly probable is expected to be
finite. However, exponential gain function ensures that such gain in information is bounded between 1 and Î².
2. Logarithmic entropy is very sensitive to outliers due to the nature of log function. In contrast, exponential
entropy is more robust to outliers. Particularly, a small probability relative to the other probabilities will bias
the entropy towards the small probability event since the weight function log(1/p) in logarithmic entropy
has an unbounded derivative. In comparison, the weight function Î² (1âˆ’p) used in exponential entropy has
bounded derivative.
We have considered Î² = e in the subsequent sections, but any value greater than 1 is suitable.

3

Proposed Method: Detecting Rough-fuzzy changepoint

In terms of mathematical setup, we consider {y1 , y2 , . . . yT } as the time series data with yt âˆˆ Rp for any t = 1, 2, . . . T .
With the number of changepoints equal to 1, we assume that the data comes from a distribution F at first and then
gradually comes from a different distribution G after some time. Since the location of the changepoint is ambiguous
in nature, this creates the possibility of splitting the set of time points U = {1, 2, ..., T } into two fuzzy partitions,
Î³F = hU, ÂµF i and Î³G = hU, ÂµG i. Here, ÂµF and ÂµG denote the membership function of the respective partitions with
observations coming from F and G respectively. Clearly, an obvious restriction is that ÂµF (t) + ÂµG (t) = 1. This is
related to the incompleteness in knowledge about U and can be quantified by the entropy measures described by Sen
and Pal [25].
To formalize this notion of fuzziness, for t âˆˆ U, for an estimated changepoint s and bandwidth âˆ†, we define a fuzzy
measure similar to that in [25].
ï£±
ï£´
1
tâ‰¤sâˆ’âˆ†
ï£´
ï£´

2
ï£´
ï£´
t âˆ’ (s âˆ’ âˆ†)
ï£´
ï£´
sâˆ’âˆ†<tâ‰¤s
ï£²1 âˆ’ 2
âˆ†

2
Âµs,âˆ† (t) =
(8)
ï£´
(s + âˆ†) âˆ’ t
ï£´
ï£´2
s<tâ‰¤s+âˆ†
ï£´
ï£´
âˆ†
ï£´
ï£´
ï£³
0
t>s+âˆ†
On the basis of this estimated changepoint s, the partitions Î³F and Î³G can be reformalized as Î³s = Î³F =
{(t, Âµs,âˆ† (t))|t âˆˆ U} and Î³sC = Î³G = {(t, 1 âˆ’ Âµs,âˆ† (t))|t âˆˆ U}, which captures the fuzzy nature of the two partitions due to the estimation of changepoint by a fixed quantity s.
Following the footsteps of grayness ambiguity, as formulated in [25], we consider a tolerance function Sw (u, v) such
that,
1. Sw (u, u) = 1 for any u âˆˆ U = {1, 2, . . . T }.
2. Sw (u, v) is a decreasing function in |u âˆ’ v|.
3. Sw (u, v) = 0 if |uâˆ’v| â‰¥ 2w, where w is a chosen window length. This means, sufficiently spaced timepoints
can be distinguished quite nicely.
5

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

Then, the lower and upper approximations of the fuzzy set Î³s can be constructed as Î³s =

A P REPRINT

n
o
(u, MÎ³s ) : u âˆˆ U

and Î³s = {(u, MÎ³s ) : u âˆˆ U}, where MÎ³s and MÎ³s are obtained using eqn. 5 with the tolerance function Sw and
membership function Âµs,âˆ† (t). In a similar way, lower and upper approximations of the fuzzy complement set Î³sC
can also be obtained. While these approximations can be pre-computed without the knowledge of time series data,
we incorporate the knowledge of the available data by means of a regularity measure and combine it with the set
approximations to obtain an ambiguity measure.
In order to create a regularity measure, for each timepoint t, a two sample test statistic is computed to detect the
changes in the samples {y(tâˆ’Î´+1) , y(tâˆ’Î´+2) , . . . yt } and {y(t+1) , y(t+2) , . . . y(t+Î´) }. As the regularity measure R(t) is
expected to take higher value when there is no change in distribution and take lower value when there is a detected
change in distribution, some transformation of test statistic could be used. One such regularity measure to detect the
changes in mean could be based on Hotellingâ€™s T2 test statistic.
R(t) =

1
1 + (yÌ„1 âˆ’ yÌ„2 )| Î£âˆ’1 (yÌ„1 âˆ’ yÌ„2 )

where,
yÌ„1 = Î´

âˆ’1

t
X

y

yÌ„2 = Î´

t0

t0 =(tâˆ’Î´+1)

(t+Î´)
X
âˆ’1

yt0

t0 =(t+1)

(t+Î´)

Î£ = Î´ âˆ’1


|
X 
1
1
yt0 âˆ’ (yÂ¯1 + yÌ„2 )
yt0 âˆ’ (yÂ¯1 + yÌ„2 )
2
2

t0 =(tâˆ’Î´+1)

A roughness measure is created for the two fuzzy partitions Î³s and Î³sC , incorporating the information of changes in the
data as provided by suitably transformed test statistic R(t), and combining them with the respective upper and lower
approximations of the fuzzy membership functions.
PT
t=1 MÎ³s (t)R(t)
Ïâˆ†,Î´,w (Î³s ) = 1 âˆ’ PT
t=1 MÎ³s (t)R(t)
(9)
PT
c
t=1 MÎ³s (t)R(t)
c
Ïâˆ†,Î´,w (Î³s ) = 1 âˆ’ PT
t=1 MÎ³sc (t)R(t)
Based on these roughness measures, entropy quantifying the ambiguity for the fuzzy partitions of the time span for
the specifically chosen changepoint s can be expressed using eqn. 6 or eqn. 7, with ÏR (X) replaced by the roughness
measure given in eqn. 9. Thus, we obtain
C

E
Hâˆ†,Î´,w
(s) = Ïâˆ†,Î´,w (Î³s )e(1âˆ’Ïâˆ†,Î´,w (Î³s )) + Ïâˆ†,Î´,w (Î³sC )e(1âˆ’Ïâˆ†,Î´,w (Î³s ))

(10)

Proceeding in the direction of any general changepoint detection method [26] for detecting a single changepoint
present in the data, any CPD algorithm can be broadly expressed as
tâˆ— =

min

tâˆˆ{1,2,...T }

R(t) =

min

tâˆˆ{1,2,...T }

V (({1, 2, . . . t}, {(t + 1), (t + 2), . . . T }) , y) .

(11)

where tâˆ— is the estimated changepoint and V (Â·, Â·) is a cost function as shown in eqn. 2, which can be interpreted as a
regularity measure. While in this way, the regularity measure R(t) itself becomes an indicator of the changepoint, it
can be greatly enhanced in combination of fuzzy and rough set theory, by constructing the entropy as given in eqn. 10.
Thus, according to the proposed algorithm, the estimated changepoint is given as
tâˆ— =

min

tâˆˆ{1,2,...T }

E
Hâˆ†,Î´,w
(t).

(12)

This estimated changepoint tâˆ— shown in eqn. 12 may be denoted as the rough-fuzzy CP, and the method may be called
rough-fuzzy CPD. Note that while the global minima serves as the estimate of single changepoint, the local minima
of the entropy function, after suitable testing, are used for multiple changepoint detection.
The reason for including roughness in the proposed changepoint detection algorithm is subtle. Since the underlying
distributions of the time series data is unknown, all the information about the changepoint must be gathered in terms of
6

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

the available observations yt , which is now summarized only through a single attribute R(t), the regularity measure.
Along with this loss of information, since the regularity measure R(t) is computed based on overlapping windows,
any information about the locality of a timepoint will permeate to its neighbouring timepoints as well, resulting in
incomplete information about the timepoints itself. This rough resemblance between different time points is modelled
by the tolerance relation which eventually leads to the rough set formulation.
Further, the entropy function depends on the hyper parameters w, Î´ and âˆ†. In the proposed rough-fuzzy CPD, w
denotes the degree of roughness of the tolerance function with higher values indicating greater roughness and âˆ†
determines the fuzziness of the membership function with higher values corresponding to greater fuzziness. It is
important to choose the values of w and âˆ† correctly as wrongly chosen values might result in relatively higher error
in estimation, though a wide range of such optimal values are available as shown in section 5.6.

4

Mathematical Properties

Here we provide two mathematical properties of the aforesaid estimate tâˆ— , involving rough-fuzzy entropy, towards
the detection of gradual changepoints. First one deals with the issue of its speedy computation, while the other
theoretically establishes its ability in detecting multiple changepoints. In the section 4.1, we obtain exact solutions
of upper and lower approximations and also derive relations between them to reduce computation. In section 4.2, we
prove a theorem which gives the asymptotic distribution of rough-fuzzy entropy under the null hypothesis that there
are no changepoints. An immediate corollary of this theorem gives us the joint asymptotic distribution of rough-fuzzy
entropy evaluated at multiple proposed changepoints under the null hypothesis. This helps to present our algorithm in
a hypothesis testing framework and also test for false positives.
4.1

Fast Computation of Upper and Lower Approximations

We start by introducing a result which relates the upper and lower approximations of the set Î³s with the approximations
for the complement set Î³sC . The significance of the result is that in order to obtain the roughness measure Ïâˆ†,Î´,w (Î³s )
and Ïâˆ†,Î´,w (Î³sC ) as given in eqn. 9, it is enough to focus the computation on only one of these terms, and the other can
be obtained as a byproduct of the result.
Lemma 1.
MÎ³ (t) = 1 âˆ’ MÎ³ Cs (t)
s

MÎ³ s (t) = 1 âˆ’ MÎ³ C (t)
s

Proof. Starting with the lower approximation;

MÎ³ (t) = inf max S w (t, Ïˆ), Âµs,âˆ† (Ïˆ)
s
ÏˆâˆˆU


= inf 1 âˆ’ min 1 âˆ’ S w (t, Ïˆ), 1 âˆ’ Âµs,âˆ† (Ïˆ)
ÏˆâˆˆU


= inf 1 âˆ’ min Sw (t, Ïˆ), Âµs,âˆ† (Ïˆ)
ÏˆâˆˆU

= 1 âˆ’ sup min Sw (t, Ïˆ), Âµs,âˆ† (Ïˆ)
ÏˆâˆˆU

= 1 âˆ’ MÎ³ Cs (t)
The other equality proceeds in an exactly similar way.
Also, since the computation of the lower and upper approximations MÎ³s (t) and MÎ³s (t) is independent of the data,
it can be pre-computed for the changepoint analysis problems, given the knowledge of the number of timepoints
T . However, if T is large, computation of eqn. 5 poses a high memory and computational complexity. However, it
is possible to obtain exact expressions of these lower and upper approximations under a very general setup, which
greatly reduces both the computational and storage cost complexities of the whole process.
To establish an explicit formula for lower and upper approximations, we first consider the situation when MÎ³ (t) = 0,
s
which happens if and only if there exists a Ïˆ âˆˆ U such that, both S w (t, Ïˆ) and Âµs,âˆ† (Ïˆ) are equal to 0. While the
7

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

complementary tolerance function S w is 0, if and only if Sw is 1, i.e. the two arguments satisfy t = Ïˆ. On the other
hand, Âµs,âˆ† (Ïˆ) = 0 if and only if Ïˆ â‰¥ (s + âˆ†), combining this with t = Ïˆ yields, t â‰¤ (s + âˆ†).
On the other extreme, MÎ³ (t) = 1, if and only if, either Sw (t, Ïˆ) = 0 or Âµâˆ†,s (Ïˆ) = 1. The former happens when
s
|t âˆ’ Ïˆ| â‰¥ 2w, and the latter happens if Ïˆ2 â‰¤ (s âˆ’ âˆ†). Thus, for any t â‰¤ (s âˆ’ 2w âˆ’ âˆ†), MÎ³ (t) = 1.
s

By symmetry, MÎ³ s (t) = 0 if t â‰¥ (s + 2w + âˆ†) and MÎ³ s (t) = 1 if t â‰¤ (s âˆ’ âˆ†).
1.8

1.6

1.4

1.2

1

m
fg

0.8

0.6

0.4

0.2

-1.8

-1.6

-1.4

-1.2

-1

-0.8

-0.6

-0.4

-0.2

0

0.2

0.4

0.6

0.8

1

1.2

1.4

1.6

1.8

2

2.2

2.4

2.6

2.8

-0.2

-0.4

-0.6

Figure 1: Lower Approximation Curve: red line is ÂµT,âˆ† (Ïˆ) and blue line is S w (t, Ïˆ)
-0.8
and green line is their maximum.
-1

To see the behaviour of MÎ³ (t) when (s âˆ’ 2w âˆ’ âˆ†) â‰¤ t â‰¤ (s + âˆ†), we consider MÎ³ (t) as a minimizer of the function
s
 s
max S w (t, Ïˆ), Âµs,âˆ† (Ïˆ) with respect-1.2
to Ïˆ. This is shown by the upper envelope curve of S w (t, Ïˆ) and Âµs,âˆ† (Ïˆ) in
figure 1. Thus, it is easy to see that the minimizer would appear at a point tâˆ— where the fuzzy membership function
and the tolerance function crosses each other, i.e., S w (t, tâˆ— ) = Âµs,âˆ† (tâˆ— ). This leads us to a result depicting a much
easier way to compute the lower and upper approximations.
Theorem 1. With the membership function Âµs,âˆ† (t), given as inneqn. 8, the lower o
and upper approximations of the
left partition of a chosen changepoint s are expressed by Î³s = (u, MÎ³s ) : u âˆˆ U and Î³s = {(u, MÎ³s ) : u âˆˆ U}
respectively, where
ï£±
ï£´
ï£²1
Sw (t, tâˆ— )
MÎ³s (t) = 1 âˆ’ {tâˆ— :S (t,tâˆ—max
)+Âµs,âˆ† (tâˆ— )=1}
w
ï£´
ï£³
0

if t < (s âˆ’ 2w âˆ’ âˆ†)
if (s âˆ’ 2w âˆ’ âˆ†) â‰¤ t < (s + âˆ†)
if t â‰¥ (s + âˆ†)

and

MÎ³s (t) =

ï£±
ï£´
ï£²1

max
âˆ—

{tâˆ— :Sw (t,t
ï£´
ï£³
0

)=Âµs,âˆ† (tâˆ— )}

Sw (t, tâˆ— )

if t < (s âˆ’ âˆ†)
if (s âˆ’ âˆ†) â‰¤ t < (s + 2w + âˆ†)
if t â‰¥ (s + 2w + âˆ†)

It is possible to obtain a closed form solution of Sw (t, tâˆ— ) = Âµs,âˆ† (tâˆ— ) and similar equations for some specific tolerance
functions. One such specific choice is provided in the following corollary.
8

3

3.2

3.4

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

Corollary 1. Let the membership function Âµs,âˆ† (t) be given as in eqn. 8, and a tolerance function be given as
ï£±
0
if |t âˆ’ t0 | â‰¥ 2w
ï£´
ï£´
2
 0
ï£´
ï£´
ï£´
ï£´
ï£´2 t âˆ’ (t âˆ’ 2w)
if (t âˆ’ 2w) < x < (t âˆ’ w)
ï£´
ï£´
2w
ï£²


2
Sw (t, t0 ) =
xâˆ’t
ï£´
1
âˆ’
2
if |t âˆ’ t0 | â‰¤ w
ï£´
ï£´
2w
ï£´
ï£´

2
ï£´
ï£´
(t + 2w) âˆ’ t0
ï£´
ï£´
ï£³2
if (t + w) < x < (t + 2w).
2w
Then the
for a chosen
as
n lower and upperoapproximations of the left and right partitions
n
o changepoint
n s can be obtained o
C
C
Î³s = (u, MÎ³s ) : u âˆˆ U , Î³s = {(u, MÎ³s ) : u âˆˆ U}, Î³s = (u, MÎ³sC ) : u âˆˆ U and Î³s = (u, MÎ³ C ) : u âˆˆ U ,
s
where
ï£±
ï£´
0
ï£´
ï£´
2

ï£´
ï£´
ï£´ (s + âˆ†) âˆ’ t
ï£´
ï£²2
2(w + âˆ†)

2
MÎ³ (t) =
s
ï£´
(t + 2w) âˆ’ (s âˆ’ âˆ†)
ï£´
ï£´
1âˆ’2
ï£´
ï£´
2(w + âˆ†)
ï£´
ï£´
ï£³
1

if t â‰¥ (s + âˆ†)
if (s âˆ’ w) â‰¤ t < (s + âˆ†)
if (s âˆ’ 2w âˆ’ âˆ†) â‰¤ t < (s âˆ’ w)
if t < (s âˆ’ 2w âˆ’ âˆ†)

and
ï£±
ï£´
0
ï£´
ï£´ 
2
ï£´
ï£´
(s + âˆ†) âˆ’ (t âˆ’ 2w)
ï£´
ï£´
ï£²2
2(w + âˆ†)

2
MÎ³ s (t) =
ï£´
t
ï£´1 âˆ’ 2 âˆ’ (s âˆ’ âˆ†)
ï£´
ï£´
ï£´
2(w + âˆ†)
ï£´
ï£´
ï£³
1

if t â‰¥ (s + 2w + âˆ†)
if (s + w) â‰¤ t < (s + 2w + âˆ†)
if (s âˆ’ âˆ†) â‰¤ t < (s + w)
if t < (s âˆ’ âˆ†),

while the approximations for the complementary set can be obtained using lemma 1.
Lemma 2. If the tolerance function Sw (u, v) can be expressed as a function of the absolute difference of its arguments,
i.e. Sw (u, v) = g(|u âˆ’ v|) such that g(Â·) is symmetric about 0, then;
MÎ³ (t) = 1 âˆ’ MÎ³ s (2s âˆ’ t) âˆ€ t : max{1, 2s âˆ’ T } < t < max{2s, T }
s

Proof. We can rewrite theorem 1, as follows,
ï£±
ï£´
ï£²1
Âµs,âˆ† (tâˆ— )
MÎ³s (t) = {tâˆ— :S (t,tmax
âˆ— )=Âµ
âˆ—
w
s,âˆ† (t )}
ï£´
ï£³
0

if t < (s âˆ’ âˆ†)
if (s âˆ’ âˆ†) â‰¤ t < (s + 2w + âˆ†)
if t â‰¥ (s + 2w + âˆ†)

To prove this lemma, we consider the 3 cases separately.
1. t < s âˆ’ 2w âˆ’ âˆ†
2. t â‰¥ s + âˆ†
3. t âˆˆ [s âˆ’ 2w âˆ’ âˆ†, s + âˆ†)
1. Case 1: t < sâˆ’2wâˆ’âˆ† Here, MÎ³ (t) = 1 and (2sâˆ’T ) > (s+âˆ†+2w). Thus, MÎ³ s (2sâˆ’t) = 0 = 1âˆ’MÎ³ (t)
s
s
which proves lemma 2 for this case.
2. Case 2: t â‰¥ s + âˆ† Here, MÎ³ (t) = 0 and (2s âˆ’ T ) â‰¤ (s âˆ’ âˆ†). Again, symmetric to the previous case,
s
MÎ³ s (2s âˆ’ t) = 1 = 1 âˆ’ MÎ³ (t) which proves lemma 2 for case 2 also.
s

9

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

3. Case 3: (s âˆ’ âˆ†) â‰¤ t < (s + 2w + âˆ†) In this case, (2s âˆ’ T ) âˆˆ (s âˆ’ âˆ†, s + âˆ† + 2w]. Hence,
MÎ³ s (2s âˆ’ t) =
=

=
=

=

max

{tâˆ— :Sw (2sâˆ’t,tâˆ— )=Âµs,âˆ† (tâˆ— )}

Âµs,âˆ† (tâˆ— )

max

{tâˆ— :Sw (2sâˆ’t,tâˆ— )=1âˆ’Âµs,âˆ† (2sâˆ’tâˆ— )}

(1 âˆ’ Âµs,âˆ† (2s âˆ’ tâˆ— ))

Since, Âµs,âˆ† (tâˆ— ) = 1 âˆ’ Âµs,âˆ† (2s âˆ’ tâˆ— )
Sw (2s âˆ’ t, tâˆ— )

max

{tâˆ— :Sw (2sâˆ’t,tâˆ— )+Âµs,âˆ† (2sâˆ’tâˆ— )=1}

max

{z âˆ— :Sw (2sâˆ’t,2sâˆ’z âˆ— )+Âµs,âˆ† (z âˆ— )=1}

Sw (2s âˆ’ t, 2s âˆ’ z âˆ— )

Putting z âˆ— = 2s âˆ’ tâˆ—
max
Sw (t, z âˆ— )
âˆ—
âˆ—

{z âˆ— :Sw (t,z )+Âµs,âˆ† (z )=1}

Since, Sw (Â·, Â·) is location invariant and
g(Â·) is symmetric about 0
= 1 âˆ’ MÎ³ (t)
s

So, lemma 2 also holds for case 3, proving that the result is true in general.

The significance of lemma 2 is that, in case of symmetric and location invariant tolerance function, only one, either
lower or upper, approximation curve is required to be computed.
4.2

Asymptotic distribution

While the rough-fuzzy CPD can be employed and a single changepoint can be detected using eqn. 12, multiple changeE
points can be detected by local minima of the curve Hâˆ†,Î´,w
(s) as a function of s. However, a reference curve must
be computed in order to select the true changepoints from many local minimas. In statistical language, these reference curve is usually computed based on the distribution of the statistic under a suitably chosen null hypothesis, by
modifying the problem into a hypothesis testing framework.
Considering the mathematical framework given in eqn. 1, we can formulate the problem of detecting changepoint as a
hypothesis testing problem.
H0 : F0 = F1 = Â· Â· Â· = Fk = F
H1 : There is at least one inequality
Since the regularity measure R(t) is an indicator of a possible changepoint, hence under the null hypothesis H0 ;
E(R(t)) is a constant independent of the time t. On the basis of this, we obtain asymptotic null distribution of the
proposed statistic under some reasonable assumptions on the asymptotic null distribution of the regularity measure.
Clearly, the asymptotics follow when the number of samples for constructing R(t) i.e. Î´ is tended to infinity, which
forces the total number of timepoints T to be tended to infinity as well. Thus, in order to talk about asymptotics,
we restrict ourselves to an infinite dimensional normed space, which without any loss of generality, can be taken as
lâˆ (N), the set of all uniformly bounded functions from N to R. Also, while the number of timepoints T increases to
infinity, the intervals between successive observations tend to zero, in order to make the total period of observation
constant pertaining to most of the practical situations.
Let us denote the regularity measure RÎ´n as a lâˆ (N) valued random element defined on some probability measure
space (â„¦, A, P) such that RÎ´n (t) is a R-valued random variable denoting the regularity measure based on the 2Î´n
subsamples centered at t for each t = 1, 2, . . . âˆ.
Theorem 2. Assume that under the null hypothesis that there is no changepoint, the regularity measure RÎ´n has an
asymptotic distribution such that for some sequence aÎ´n â†’ âˆ,
aÎ´n (RÎ´n âˆ’ Âµ1(Â·))

Z

where 1 âˆˆ lâˆ (N) is the identity function 1(x) = x, Z is an infinite dimensional Gaussian process with mean function
identically equal to 0 and covariance function Ïƒ : N Ã— N â†’ [0, âˆ).
Also, assume the following regularity conditions:
10

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

1. Âµ 6= 0.
2. For the proposed changepoint s, the series

Pâˆ

t=1

MÎ³s (t) and

Pâˆ

t=1

MÎ³ C (t) are convergent.
s

Define,
Pâˆ

t=1 MÎ³s (t)
b(s) = Pâˆ
MÎ³s (t)
Pt=1
âˆ
t=1 MÎ³sC (t)
b(s) = Pâˆ
t=1 MÎ³ C (t)
s

E
Then, the exponential entropy based statistic Hâˆ†,Î´
(s) defined in eqn. 10 has an asymptotic distribution with the
n ,w
same normalizing constant, aÎ´n such that as aÎ´n â†’ âˆ,
E
aÎ´n (Hâˆ†,Î´
(s) âˆ’ H âˆ— (s))
n ,w

Zâˆ—

where

H âˆ— (s) = (1 âˆ’ b(s)) eb(s) + (1 âˆ’ b(s))eb(s)
and Z âˆ— is a univariate normally distributed random variable with mean 0 and variance Ïƒ âˆ— where;
âˆ
âˆ X
X

Ïƒâˆ— =

As (m)Ïƒ(m, n)As (n)

m=1 n=1

and;
"
As (n) = b(s)eb(s)

( Pâˆ

)
Pâˆ
MÎ³s (n)MÎ³s (t) âˆ’ t=1 MÎ³s (n)MÎ³s (t)
+
Pâˆ
2
Âµ ( t=1 MÎ³s (t))
ï£±
ï£¼ï£¹
P
Pâˆ
ï£´
ï£´
ï£² âˆ
ï£½
C
C
M
(t)
âˆ’
(n)M
(n)M
M
(t)
Î³s
Î³s
t=1
t=1
Î³sC
Î³sC
ï£º
b(s)
b(s)e
ï£»
P
2
ï£´
ï£´
âˆ
ï£³
ï£¾
Âµ
t=1 MÎ³ C (t)

t=1

(13)

s

provided that the series expression of Ïƒ âˆ— is convergent.
Proof. We first fix the parameters âˆ†, w and fix the proposed changepoint s. Let us define, Ïâˆ†,Î´n ,w (Î³s ) as a function
from lâˆ (N) to R, denoted by Ï(s) ;
Pâˆ
t=1 MÎ³s (t)R(t)
(s)
(14)
Ï (RÎ´n ) = 1 âˆ’ Pâˆ
t=1 MÎ³s (t)R(t)
We would first compute the FrÃ©chet derivative of this at Âµ1(Â·).
i
Pâˆ hPâˆ
Pâˆ
MÎ³s (n)MÎ³s (t) âˆ’ t=1 MÎ³s (n)MÎ³s (t) h(n)
n=1
t=1
Ï(s) (Âµ1 + h) âˆ’ Ï(s) (Âµ1) âˆ’
Pâˆ
2
Âµ ( t=1 MÎ³s (t))
i
Pâˆ
Pâˆ hPâˆ
t=1 MÎ³s (n)MÎ³s (t) h(n)
n=1
t=1 MÎ³s (n)MÎ³s (t) âˆ’
=
Pâˆ
Pâˆ
Pâˆ
2
Âµ ( t=1 MÎ³s (t)) + ( t=1 MÎ³s (t)) ( t=1 MÎ³s (t)h(t))
i
Pâˆ hPâˆ
Pâˆ
M
(n)M
(t)
âˆ’
M
(n)M
(t)
h(n)
Î³
Î³
Î³
Î³
s
s
s
s
n=1
t=1
t=1
âˆ’
Pâˆ
2
Âµ ( t=1 MÎ³s (t))
i
Pâˆ hPâˆ
Pâˆ
Pâˆ
n=1
t=1 MÎ³s (n)MÎ³s (t) âˆ’
t=1 MÎ³s (n)MÎ³s (t) h(n)
M (t)h(t)
Pâˆ t=1 Î³s
=
Pâˆ
2
Âµ(
MÎ³s (t))
t=1 MÎ³s (t)(Âµ + h(t))
t=1

11

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

where | Â· | represents the usual absolute value norm on real numbers. Now, since Âµ 6= 0, without loss of generality
assume that, Âµ >  > 0 for some small non-negative . With khkâˆ â†’ 0, we can thus make,
Pâˆ
Pâˆ
M (t)h(t)
t=1 MÎ³s (t)h(t)
Pâˆ t=1 Î³s
P
â‰¤
â‰¤ Bkhkâˆ
âˆ
M
(t)(Âµ
+
h(t))
Î³s
t=1
t=1 MÎ³s (t)(/2)
for sufficiently small khkâˆ and some finite real number B. On the other hand,
i
Pâˆ hPâˆ
Pâˆ
n=1
t=1 MÎ³s (n)MÎ³s (t) âˆ’
t=1 MÎ³s (n)MÎ³s (t) h(n)
Pâˆ
2
Âµ ( t=1 MÎ³s (t))
hP
i
Pâˆ
âˆ
âˆ
M
(n)M
(t)
âˆ’
M
(n)M
(t)
h(n)
X
Î³
Î³
Î³
Î³
s
s
s
s
t=1
t=1
â‰¤
Pâˆ
2
Âµ ( t=1 MÎ³s (t))
n=1
â‰¤
â‰¤

â‰¤
=

by triangle inequality

âˆ X
âˆ
X
2khkâˆ
since, |h(n)| â‰¤ khkâˆ
MÎ³s (n)MÎ³s (t)
Pâˆ
2
Âµ ( t=1 MÎ³s (t)) n=1 t=1
âˆ X
âˆ
X
2khkâˆ
MÎ³s (n)MÎ³s (t)
Pâˆ
2
Âµ ( t=1 MÎ³s (t)) n=1 t=1
!2
âˆ
X
2khkâˆ
MÎ³s (t)
since, MÎ³s (t) â‰¤ MÎ³s (t) and both are nonnegative
Pâˆ
2
Âµ ( t=1 MÎ³s (t))
n=1
2
khkâˆ
Âµ

Thus,
0
1
2B
Ï(s) (Âµ1 + h) âˆ’ Ï(s) (Âµ1) âˆ’ Ï(s) (Âµ1)(h) <
khkâˆ
khkâˆ
Âµ
0

which goes to 0 as khkâˆ â†’ 0, where Ï(s) (Âµ1) : lâˆ (N) â†’ R is;
#
" Pâˆ
Pâˆ
âˆ
X
(n)M
(t)
(t)
âˆ’
(n)M
M
M
0
Î³
Î³
Î³
Î³
s
s
s
s
t=1
t=1
Ï(s) (Âµ1)(h) =
h(n)
Pâˆ
2
Âµ ( t=1 MÎ³s (t))
n=1

(15)

To see that the derivative given in eqn. 15 is well defined, note that
0

Ï(s) (Âµ1)(h) â‰¤

2
khkâˆ ,
Âµ

which shows that the infinite series is convergent as h âˆˆ lâˆ (N).
This shows that the function Ï(s) given in eqn. 14 is FrÃ©chet differentiable (see Miranda and Fichmann [36] for
definition) at Âµ1 and the derivative is given by eqn. 15. In a very similar way, the roughness measure corresponding to
the completement set Î³sC can also be shown to be FrÃ©chet differentiable at Âµ1 as a function of {R(t) : t = 0, 1, 2, . . . }.
Now, in order to obtain the exponential entropy as shown in eqn. 10, we consider the function g : [0, 1]2 â†’ R defined
as;
g(x, y) = xe(1âˆ’x) + ye(1âˆ’y)
Clearly, g is FrÃ©chet differentiable at every point of the domain. Finally, a chain rule [37, 38] can be applied on the
composition of g and the roughness measures to show that, Î¨s is FrÃ©chet differentiable at Âµ1 where Î¨s : lâˆ (N) â†’ R
E
is such that Î¨s (RÎ´n ) = Hâˆ†,Î´
(s).
n ,w
Since FrÃ©chet differentiablity implies Hadamard differentiability (see discussion followed by Definition 2.1 of
Shao [39]), and outputs a linear operator as the derivative, Î¨s is also Hadamard differentiable with the derivative
given by;
âˆ
X
0
Î¨s |Âµ1(Â·) (h) =
As (n)h(n)
n=1

12

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

where the function A(n) is as given in eqn. 13. Clearly, this is a linear and continuous map.
The proof of the result now follows from an infinite dimensional generalization of delta method (Theorem 1 and
Section 1.4 of RÃ¶misch [40]). Based on the discussion above, we see that due to the assumption, Z is a gaussian
process, and also the hadamard derivative of the function Î¨s is linear. Thus, Î¨0s (Z) is a normally distributed random
variable with the mean 0 and variance Ïƒ âˆ— , as given in the statement of the theorem.
An immediate extension of theorem 2 is the analogus result for multiple proposed changepoints.
Corollary 2. Under the same assumptions and conditions of theorem 2, the vector of exponential entropy based
E
statistic Hâˆ†,Î´
(s) for multiple proposed changepoints s1 , s2 , . . . sk has the following asymptotic distribution as
n ,w
aÎ´n â†’ âˆ;
ï£¹
E
Hâˆ†,Î´
(s1 ) âˆ’ H âˆ— (s1 )
n ,w
âˆ—
ï£º
ï£¯H E
âˆ†,Î´n ,w (s2 ) âˆ’ H (s2 ) ï£º
aÎ´n ï£¯
ï£»
ï£°
...
E
âˆ—
Hâˆ†,Î´
(s
)
âˆ’
H
(s
)
k
k
n ,w
ï£®

Nk (0k , Î£âˆ—kÃ—k )

where 0k is the k dimensional null vector, and the entries of the k Ã— k dispersion matrix are given as;
Î£âˆ—kÃ—k


(i,j)

=

âˆ X
âˆ
X

Asi (m)Ïƒ(m, n)Asj (n)

i, j = 1, 2, . . . k

m=1 n=1

In particular, if |si âˆ’ sj | > (4w + 2âˆ†), then Î£âˆ—kÃ—k



= 0.

(i,j)

On the basis of theorem 2 and theorem 2, a hypothesis testing framework can be laid out to detect the significant
changepoints. The final algorithm is shown in algorithm 1. Another consequence of theorem 2 is that if the parameters
E
w and âˆ† are carefully chosen so that the obtained local minima of the entropy function Hâˆ†,Î´,n
(s) are separated by
atleast (4w + 2âˆ†), then the entropy corresponding to these functions are asymptotically independent. Thus, for such
well-separated changepoints, each of them can be tested individually for false positives.

5

Simulation Studies

5.1

Simulation Setups

In order to asses a comparative study of the proposed rough-fuzzy improvement over any changepoint detection algorithm, some simulations are performed. We consider a general model of the observations as follows:
t âˆ¼ N (0, 1)

yt = Âµ(t) + t

where Âµ(t) is the mean function dependent on time, while t denotes independent and identically distributed random
variables, each distributed according to a standard normal distribution. We consider 3 different types of mean curves
as shown in figure 2.
6
6

Data
Mean

0

4

2
Data
Mean

0
2

2

4
0

250

500

Time

750

1000

Value

Value

Value

2

4

6

4

4

2
Data
Mean

0
2

0

250

500

Time

750

1000
4

0

250

500

Time

750

1000

(b) Continuous Jump in mean function
(a) Discrete Jump in mean function (S1) (S2)
(c) Smooth Jump in mean function (S3)

Figure 2: Different Scenarios of changepoints with Changes in mean of the data
13

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

Algorithm 1: Rough-Fuzzy CPD
Input : A multivariate time series Yt for t = 1, 2, . . . T with Yt âˆˆ Rp , Parameters Î´, âˆ† and w, An acceptance
threshold Î± (usally 0.05)
Output: Estimated changepoints s1 , s2 , . . . sk
for t = 1 to T do
Create two samples S1t = {Ymax{1,tâˆ’Î´+1} , . . . , Yt } and S2t = {Yt+1 , . . . , Ymin{T,t+Î´} };
Compute regularity measure R(t) as a similarity between S1t and S2t ;
end
for s = 1 to T do
for t = 1 to T do
Use theorem 1 to compute MÎ³s (t);
Use lemma 2 to compute MÎ³s (t);
Use lemma 1 to compute MÎ³sC (t) and MÎ³ C (t);
s
end
Compute roughness measure Ïâˆ†,Î´,w (Î³s ) and Ïâˆ†,Î´,w (Î³sC ) using eqn. 9;
E
Compute exponential entropy Hâˆ†,Î´,w
(s) using eqn. 10;
end
E
Find local minimas of the sequence {Hâˆ†,Î´,w
(s) : s = 1, 2, . . . T };
One can output these local minimas as proposed changepoints, however if theoretical expressions for Âµ and Ïƒ as
denoted in theorem 2 for the underlying regularity measure R(t) is available, the following testing framework
can be used to further enhance its ability
E
for each local minima sk of Hâˆ†,Î´,w
do
âˆ—
Compute H (sk ) as given in theorem 2 by replacing the infinite sums as sums from t = 1 to T ;
for n = 1 to T do
Use eqn. 13 to compute Ask (n) by replacing the infinite sums as sums from t = 1 to T ;
end
Compute Ïƒ âˆ— for the changepoint 
sk as given in theorem 2using finite sums from t = 1 to T ;
âˆš
E
Accept sk as a changepoint if aÎ´ Hâˆ†,Î´,w
(sk ) âˆ’ H âˆ— (sk ) / Ïƒ âˆ— < zÎ± , where zÎ± is the Î±-th quantile of the

standard normal distribution;
end

Figure 2a depicts the scenario S1 of abrupt change, which is the popular definition of a changepoint. Most of the
existing algorithms are able to detect this type of change. Figure 2b shows the scenario S2 where the mean curve is
piecewise linear, and hence a test for changes in slope of the regression would be able to detect such changes. While
this shows a situation where the change in slope of the regression equation has a discrete jump, situation S3 indicates
a continual change in the slope thus incorporating a much smoother and gradual jump in the dataset as shown in
subfigure 2c.
In order to establish the comparison, we consider three test statistic that are well used in a two-sample setup to detect
the changes in mean. The parametric statistic as square of two sample t-test statistic, nonparametric Kolmogorov
Smirnov test statistic and Augmented Dickey Fuller test statistic among unit root tests were chosen. In each case, the
regularity measure R(t) is obtained by taking reciprocal of the test statistics, to make sure R(t) has a higher value in
absence of changepoints and has a lower value in presence of changepoint. Both eqn. 11 and eqn. 12 were used to
obtain the estimates of the changepoints, and the process was repeated for 200 Monte Carlo resamples and used to
obtain error measures. In applying rough-fuzzy CPD, Î´ = 50 was chosen to compute the regularity measure, while
different values of w and âˆ† were used in the experiment to see their effects.
We present the results of simulation studies for all the 3 cases described above. All the following simulations and real
data applications have been performed by the python package roufcp developed by us.
5.2

Result of Simulation

Table 1 summarizes the result for all 3 types of mean shift changepoints described above. We begin analyzing the
results with changepoint of type S1, where a discrete jump in the mean function has occurred. Note that, the hyperpa14

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

Simulation
setup

Discrete
Jump
in Mean
(S1)

Continuous
Jump in
Mean
(S2)

Smooth
Jump in
Mean
(S2)

Base test
statistic

Parameters for
proposed method

RMSE

t-test

w
w
w
w

=âˆ†=5
= âˆ† = 25
= âˆ† = 50
= âˆ† = 100

1.591
4.961
6.567
21.446

KS-test

w
w
w
w

=âˆ†=5
= âˆ† = 25
= âˆ† = 50
= âˆ† = 100

2.001
4.926
7.404
25.533

ADF-test

w
w
w
w

=âˆ†=5
= âˆ† = 25
= âˆ† = 50
= âˆ† = 100

t-test

Proposed

Base

A P REPRINT

Relative
Decrease in MSE

1.752

17.53%
-701.81%
-1436.26%
-14883.88%

3.928

74.08%
-57.27%
-255.29%
-4125.33%

38.115
41.395
43.843
55.305

106.684

87.23%
84.94%
83.11%
73.12%

w = âˆ† = 25
w = âˆ† = 50
w = âˆ† = 100

25.232
11.326
17.419

35.501

49.48%
89.82%
75.92%

KS-test

w = âˆ† = 25
w = âˆ† = 50
w = âˆ† = 100

26.881
15.071
23.778

79.723

88.63%
96.42%
91.10%

ADF-test

w = âˆ† = 25
w = âˆ† = 50
w = âˆ† = 100

207.811
197.768
189.827

347.614

64.26%
67.63%
70.18%

t-test

w = âˆ† = 25
w = âˆ† = 50
w = âˆ† = 100

12.242
9.596
18.768

18.001

53.75%
71.58%
-8.70%

KS-test

w = âˆ† = 25
w = âˆ† = 50
w = âˆ† = 100

11.640
10.127
22.936

37.714

90.47%
92.78%
63.01%

ADF-test

w = âˆ† = 25
w = âˆ† = 50
w = âˆ† = 100

197.282
187.246
181.6

286.67

52.64%
57.33%
59.87%

Table 1: Comparison of rough-fuzzy CPD (proposed) vs usual (base) methods based on cost minimization for 3 types
of mean shift changepoints

rameters w and âˆ† control the amount of fuzziness and roughness to incorporate when detecting changepoints. Clearly,
w = âˆ† = 0 would entail just a transformation of R(t) as the exponential entropy, and both the estimating equations
eqn. 11 and eqn. 12 would yield the same changepoint. Thus, in general, increasing w and âˆ† would increase RMSE
(root mean square error) if the true model has a discrete jump change in mean function. Indeed, for w = âˆ† = 5, for
KS test, we have a 74% decrease in MSE while with higher values of w and âˆ†, we see higher RMSE for rough-fuzzy
CPD compared to the base methods using t-test and KS-test. For ADF test statistic, however, the proposed method
outperforms the base method across all hyperparameter values, achieving more than 70% reduction in MSE. Hence,
we see it is important to use appropriate values of hyperparameters. Overall, for discrete jump type changepoints
rough-fuzzy CPD performs poorly, giving higher MSE than base model for t-test and Kolmogorov Smirnov tests, and
higher values of w and âˆ† will decrease the accuracy in prediction. This is because the fundamental assumption of the
proposed method viz. "change is fuzzy in nature and not abrupt" is violated in this case. Now, we look at the other 2
types of changepoints where the change is not abrupt and occurs gradually over a period of time.
From Table 1 we observe the performance of rough-fuzzy CPD for situation S2 with continuous change in mean
function. For both t-test statistic and Kolmogorov-Smirnov statistic, the RMSE is much lower in rough-fuzzy CPD
relative to the base method based on the regularity measure R(t). However, with an increase in w and âˆ†, the RMSE
reduces first and then increases, possibly suggesting an existence of optimal hyperparameters in between. Because of
15

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

the specific parametric setup, Augmented Dickey Fuller test and nonparametric Kolmogorov Smirnov test generally
perform worse than parametric t-test. However, in practical applications when the data generating processes are not
known, ADF and KS test might perform better in conjunction with our proposed improvement.

0.04

Method

Density

0.03

Base method
Proposed method (w = 100)
Proposed method (w = 25)
Proposed method (w = 50)

0.02
0.01
0
500

550

600

Time

650

700

750

Figure 3: Base method along with proposed rough-fuzzy CPD based on the regularity measure with Augmented
Dickey Fuller statistic for continuous jump changepoint (S2)
An interesting phenomenon occurs when we use Augmented Dickey Fuller test statistic based regularity measure.
As shown in figure 3, the ADF test usually outputs two changepoints around the true changepoint at 666; but as the
fuzziness is incorporated in the model by increasing w and âˆ†, the bimodal distribution gradually becomes unimodal.
However, there possibly remains a negative bias in estimation, as indicated by the mode of the density curve of the
rough-fuzzy CPD for w = âˆ† = 50.
Turning to situation S3 with smooth change in mean function, the results are found to be similar to scenario S2. Here
also rough-fuzzy CPD has reduced the MSE by more than 50% in most cases. However, we see that for w = âˆ† = 100
the efficiency of model is greatly reduced and it even performs slightly worse than base t-test. Again, as mentioned
earlier, it is of utmost importance to choose the values of the hyperparameters w and âˆ† carefully to obtain accurate
estimates of the changepoint even in the situations where the mean function is gradual and the underlying assumption
of the method is not violated. However, as shown by table 1, rough-fuzzy CPD generally obtains higher reduction
in MSE for S2 (continuous jump) and S3 (smooth jump) compared to S1 (discrete jump). So, with greater degree
of ambiguity in changepoint, the relative performance of our model increases as expected. We shall illustrate this
phenomenon in greater details and more rigorously in subsection 5.4.
5.3

Performance under different signal-to-noise ratios

While detecting fuzzy changepoints is a hard problem, doing so in a noisy data with low Signal-to-Noise Ratio (SNR)
is even harder. Here signal-to-noise ratio is defined as
SN R =

E(S 2 )
E(N 2 )

where N is the noise component of the data and S is the true signal component of the data, which mainly comprises
of the mean function in the time series observations. To check the performance of rough-fuzzy CPD under different
SNRâ€™s, we keep noise N same as before with standard normally distributed and vary the value of signal S by changing the size of the jump in the mean function. In this simulation setup, we consider scenario S2 with continuous
change in mean function, with the jump sizes S == 1/5, 1/4, 1/3, 1/2, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10. For each such setup,
monte carlo estimates of the MSE of the estimated changepoints by the proposed method rough-fuzzy CPD and the
base method using Kolmogorov-Smirnov test, are calculated based on 1000 resamples. In each resample, the true
changepoint value is kept fixed at 666.
16

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

RMSE

300

Method

200

Base Method
Proposed Method

100

0

0

3

SNR

6

9

Figure 4: Performance of proposed rough-fuzzy CPD and base method (KS-test)for different values of signal-to-noise
ratio

Figure 4 shows the variation of RMSE of estimated changepoint for the proposed rough-fuzzy CPD as well as the
base method. We observe that rough-fuzzy CPD has obtained lower RMSE than the base method for all values of
SNR. While SNR increases, the predictive capabilities of both the methods increase. However, it is important to note
that while the base method performs very badly for lower values of SNR (< 1), the performance of rough-fuzzy CPD
using the same regularity measure is not so severely affected. In fact throughout the low and high values of SNR, the
relative improvement of MSE achieved by rough-fuzzy CPD remains fairly uniform ranging from 88 âˆ’ 97%, with the
highest reduction achieved when SNR is 2 or 3.
5.4

Effect of fuzziness of true changepoint on efficiency

The main aim of this paper is to provide a method of changepoint detection when the change is gradual and not abrupt.
In our earlier simulations, scenario S2 and S3 depict such situations where such a gradual change has occurred.
To check how rough-fuzzy CPD performs under different levels of graduality or "fuzziness" of change, we consider
different cases of scenario S2 where the mean function is defined as follows;
ï£±
ï£´
0
t â‰¤ s0 âˆ’ F
ï£´
ï£²
t âˆ’ (s0 âˆ’ F)
Âµs,âˆ† (t) =
s0 âˆ’ F < t â‰¤ s0 + F
ï£´
F
ï£´
ï£³2
t>s +F
0

where s0 is the true changepoint and the parameter F defines the degree of graduality or "fuzziness" of the changepoint.
To see the effect of F on the estimate of rough-fuzzy CPD, we consider 1000 resamples of scenario S2 with true
changepoint at s0 = 666, for 15 different values of F ranging from 10 to 150. The MSE for each level of fuzziness F
is calculated using a monte-carlo method, for the estimated changepoint obtained by rough-fuzzy CPD as well as the
underlying base method with Kolmogorov-Smirnov statistic.
Figure 5 shows the RMSE of estimated changepoints by rough-fuzzy CPD and its base counterpart for different values
of fuzziness F, along with the relative decrease obtained by rough-fuzzy CPD. As shown in subfigure 5a, higher degree
of fuzziness leads to higher error in estimation for both methods, though rough-fuzzy CPD is not as severely affected
as the base method. Figure 5b depicts that the relative performance gain by the proposed rough-fuzzy improvement
is only possible when the fuzziness in the true changepoint crosses a certain threshold, about F = 31 for our specific
setup. However, as the fuzziness increases, due to extremely sensitive performance of the base method, rough-fuzzy
CPD could achieves nearly 95 âˆ’ 99% performance gain in terms of MSE.
17

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

100%

Method

100

Base Method
Proposed Method

50

40

80

Fuzziness

Relative decrease in MSE(%)

RMSE

150

0

A P REPRINT

0%

-100%

-200%
40

120

(a) RMSE of base model (KS) and proposed model

80

Fuzziness of true CP

120

(b) Relative decrease in MSE compared to base
model

Figure 5: Performance of proposed rough-fuzzy CPD and base method (KS-test)for different values of fuzziness of
true changepoint

5.5

Comparison with other methods

To compare performance of the rough-fuzzy CPD with existing changepoint detection algorithms, we have chosen
three existing methods of fuzzy changepoint detection, namely FCP algorithm [16] for regression models, Fuzzy
shift changepoint (FSCP) algorithm [41] and Fuzzy classification maximum likelihood changepoint (FCMLCP) algorithm [42]. Complementary to that, we also consider 3 state of the art abrupt changepoint detection algorithms, namely
Wild Binary Segmentation [43], Pruned Exact Linear Time (PELT) [7] and Bayesian Online changepoint Detection [9,
10]. To compare the performances between rough-fuzzy CPD and these existing methods, we consider rough-fuzzy
CPD with "best" tuning parameter in combination with Kolmogorov-Smirnov statistic, which should perform equally
well under any general model due to its nonparametric nature.
Simulation setup

Algorithm

RMSE

Discrete jump in Mean (S1)

FSCP
FCP
FCMLCP
Wild Binary Segmentation*
PELT
BOCD
Rough-Fuzzy CPD (using KS statistic)

2.107
1.649
5.53
1.857
1.857
6.23
2.001

Continuous jump in Mean (S2)

FSCP
FCP
FCMLCP
Wild Binary Segmentation
PELT
BOCD
Rough-Fuzzy CPD (using KS statistic)*

28.87
190.11
52.39
18.028
29.036
15.478
15.071

Smooth jump in Mean (S3)

FSCP
FCP
FCMLCP
Wild Binary Segmentation
PELT
BOCD
Rough-Fuzzy CPD (using KS statistic)*

17.436
117.35
37.29
14.265
21.424
11.086
10.127

Table 2: Performance comparison of rough-fuzzy CPD (proposed) with existing fuzzy changepoint detection methods
under the simulation setups. Best method in each setup is indicated by âˆ—.

18

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

Table 2 shows the root mean squared error (RMSE) of the estimated changepoints by the proposed algorithm roughfuzzy CPD and the other existing changepoint detection methods, for the simulation scenarios described in section 5.1,
with the best model indicated for each scenario. As shown in table 2, in the scenario S2 and S3 where fuzziness
about the changepoint is present, the proposed model outperforms the existing methods. However, in case of abrupt
changepoints, PELT, Wild Binary Segmentation and FCP are more suited to the task. The Bayesian Online changepoint
detection method turns out to be very close to our method in terms of performance for smooth change in mean, but at
the cost of inaccurate estimate for abrupt changes. One possible reason for this phenomenon could be the underlying
nature of BOCD, which being an online changepoint detection algorithm, determines presence of a changepoint only
from the past data. In such situation, once a true changepoint is visited, BOCD needs to see sufficient samples
from the new distributions before it can conclude such a changepoint is present, thus creating a lag between the true
changepoint and the estimated changepoint. This inability in abrupt changepoint becomes beneficial in detecting
gradual changepoint for BOCD.

5.6

Sensitivity Analysis

24
20
16
12

delta
(a) Variation of RMSE with w and âˆ† for S2

140.0
130.0
120.0
110.0
100.0
90.0
80.0
70.0
60.0
50.0
40.0
30.0
20.0
10.0

28
24
20
16
12
10.0
20.0
30.0
40.0
50.0
60.0
70.0
80.0
90.0
100.0
110.0
120.0
130.0
140.0

28

w

140.0
130.0
120.0
110.0
100.0
90.0
80.0
70.0
60.0
50.0
40.0
30.0
20.0
10.0

10.0
20.0
30.0
40.0
50.0
60.0
70.0
80.0
90.0
100.0
110.0
120.0
130.0
140.0

w

The proposed method rough-fuzzy CPD depends on 3 main factors viz. the regularity measure R(t), the tunable
hyperparameters w and âˆ†. w denotes the degree of roughness of the tolerance function with higher values indicating
greater roughness. Similarly, the parameter âˆ† determines the fuzziness of the membership function with higher
values corresponding to greater fuzziness. While we do not have control over the regularity measure R(t) as it is
exogenous to rough-fuzzy CPD, we need to choose the values of w and âˆ† judiciously to obtain better estimates.
To understand the effect of parameters w and âˆ† we perform some sensitivity analysis. We consider 2 scenarios to

delta
(b) Variation of RMSE with w and âˆ† for S3

Figure 6: Heatmap showing RMSE in estimating changepoint in scenarios S2 and S3 for different values of w and âˆ†

study the effect of hyper parameters. Subfigure 6a shows the variation of RMSE for scenario S2 with continuous
jump in mean function and subfigure 6b shows the variation of RMSE for scenario S3 with smooth jump in mean
function (see figure 2 for reference). In both the cases, for estimation, we let the order pair hw, âˆ†i take values in
{10, 20, . . . , 140} Ã— {10, 20, . . . , 140}. It is evident from figure 6 that there exists a wide range of optimal values of w
and âˆ†, and too high or too low values of both these parameters together are detrimental to the efficacy of the model.
The difference in the range of values of RMSE between subfigures 6a and 6b can be attributed to the difference in
the mean curve of the data used in the 2 scenarios. As shown by using a shared color scale, rough-fuzzy CPD is
able to achieve a lower RMSE for situation S3 than in situation S2 with their corresponding optimal hyperparameter
values. One possible reason could be the resemblance of the chosen membership function for rough-fuzzy CPD with
the change in the mean function for situation S3.
19

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

6

A P REPRINT

Application to Real Data

We consider three real data sets to show the performance of our method rough-fuzzy CPD over the usual regularity
measure based methods. Two popular datasets in changepoint analysis, namely â€œFlow of the River Nile" data and
â€œSeatbelts" data regarding monthly Road Casualties in Great Britain 1969âˆ’84, collected from datasets package [44]
in R [45]. For the third illustration, changepoints are estimated from time varying reproduction rate from coronavirus
disease of 2019 (COVID-19) incidence dataset.
6.1

â€œFlow of the river Nile" dataset

The very well-known â€œFlow of the river Nile" dataset comprises measurements of the annual flow of Nile river at
Aswan from 1871 to 1970. The data has a possible changepoint near 1898 which is associated with the Fashoda
incident [46] in the same year.

1200

1

1000

0.75

Value

Flow of the Nile

1400

800
600

Method

Base method
Proposed method

0.50

0.25

1875

1900

1925

Year

(a) Observed Data

1875

1950

1900

1925

Year

1950

(b) Detected changepoints by base and rough-fuzzy CPD with
t-test statistic based regularity measure

Figure 7: Performance of proposed rough-fuzzy CPD and base method (KS-test) on Nile dataset
The results for Nile dataset is shown in figure 7, where we use t-test as a regularity measure. As shown in subfigure 7a,
there are multiple minimas detected by the base method, while the proposed rough-fuzzy improvement smooths out
these minimas and the false positives are automatically removed. The estimated changepoint by our rough-fuzzy CPD
turns out to be at 1902, which coincides with the completion of Zifta Barrage and Assiut Barrage [47] and is close to
the commonly believed changepoint at 1898.
6.2

â€œSeatbelts" dataset

The popular â€œSeatbelts" dataset consists of the number of drivers in Great Britain wearing seatbelts during the time
period Jan, 1969 to Dec, 1984. There are possibly two evident changepoints present in the data, first one corresponds
to the start of seat belt legislation movements from 1972 when the seatbelts were enforced compulsory in newly
manufactured cars, and the second one corresponding to the compulsory enforcement of seat belt wearing while
driving in 1983 [15].
Figure 8 explains the performance of rough-fuzzy CPD in detecting changepoints for Seatbelts data. Similar to Nile
data, the regularity measure based on nonparametric Kolmogorv Smirnov test tends to have too many local minimas,
each of which can be possibly thought of as an estimate of changepoint. However, in conjunction with the rough-fuzzy
improvement, the prominent local minima appear in 1975 and 1983, both of which are in close proximity of the true
changepoints.
6.3

COVID-19 data

Coronavirus disease of 2019 (COVID-19) is an infectious disease caused by severe acute respiratory syndrome coronavirus 2 (SARS-CoV-2) virus. First detected in Wuhan, China in December, 2019, it has spread across the globe
and has infected over 32.2 Million cases by 25th September, 2020. There has been a multitude of epidemiological
models trying to estimate the spread of COVID-19 in various countries and states [48]. However, many such models
20

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

2500

2000

0.75

Value

Seatbelts

1

Method

Base method
Proposed method

0.50

1500
0.25

1000

1971

1974

1977

Date

(a) Observed Data

1980

1971

1983

1974

1977

Date

1980

1983

(b) Detected changepoints by base and rough-fuzzy CPD with
KS-test statistic based regularity measure

Figure 8: Performance of proposed rough-fuzzy CPD and base method (KS-test) on Seatbelts dataset

fail to predict case counts accurately due to the frequently changing public health measures aimed at simultaneously
controlling the spread of the disease and preventing economic crisis. This makes identification of changepoints in the
epidemic data of particular importance. Another use of identifying changepoints in spread of COVID-19 is inference
regarding the efficacy of non pharmaceutical interventions.
Such work has been done for some countries like USA [49] and Germany [50]. To identify changepoints, Dehning
et al. [50] calculated the time varying rate of transmission Î²(t) in the usual Susceptible Infected Recovered (SIR)
model [51] and detected changepoints in Î²(t) through the course of the pandemic. For the SIR model, the transmission
rate is defined as the rate of transmission of infection from an infected individual to a susceptible individual [51].
While the SIR model and its parameters are relatively straightforward to understand and easy to estimate, the dynamics
of transmission of COVID-19 is much more complex due to the presence of factors like undetected asymptomatic
transmissions, latency period, incubation period, delay in reporting, under reporting, different transmission rates for
asymptomatic and symptomatic individuals, quarantined and hospitalized individuals, and erroneous testing resulting
in false negatives, to name a few. So, Î²(t) alone might not be a suitable representative of the spread of the disease.
So, we look at another related parameter which is the basic reproduction number R0 . While SIR model assumes
constant R0 we estimate the time varying reproduction number Rt . Rt can be defined as the expected number of cases
directly generated by one case in the population at time t [52]. We estimate Rt using the EpiEstim package [53]
in R based on the incidence curve from 15th March to 25th September in India. The required data on the number of
confirmed cases of COVID-19 has been collected from an API made by volunteer driven covid19india group [54]. We
then apply rough-fuzzy CPD on the estimated Rt to identify the changepoints. Note that modelling the changepoints in
a fuzzy manner, instead of crisp, is logical and appropriate here as interventions and measures rolled out by government
are impossible to be implemented throughout a vast country like in India instantaneously.
Figure 9 shows the estimated changepoints along with the estimates of Rt . We see that our method detects 5 changepoints on 1st April, 2nd May, 16th June, 1st July and 4th August. Of these, the changepoints on 2nd May, 1st July and
4th August are very close to the date of commencement of Lockdown 3, Unlock 2 and Unlock 3 respectively. The first
changepoint (on 1st April) corresponds to the initial elbow in the estimate of Rt after 7 days of the 1st Lockdown in
India. This shows that the effect of the 1st Lockdown was not immediate and it took approximately 7 days to initially
check the unrestricted spread of the disease. Hence, we infer that the effect of Lockdown 3, Unlock 2 and Unlock 3
were much more pronounced on Rt than the other nationwide interventions in India.

7

Conclusion

Though gradual changepoints are present in various time series data, they are usually overlooked. Our study aims to
contribute in this direction by enriching the existing methodologies using the principles of Fuzzy Rough set theory.
In fact, the biggest strength of our approach is that it is independent of the base method, and thus any changepoint
detection algorithm expressed as shown in figure 11 can be subjected to improvement by our proposal. Here, we
have presented only 3 cases of base methods for computing the regularity measure - parametric two sample test,
nonparametric two sample tests and stationarity test (unit root test). However, our choices are not limited to the
21

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

3

Mean Rt
Predicted CP

Rt

2

1

0
Apr 01

May 02

Jun 16 Jul 01

Aug 04

Date

Figure 9: Changepoints in estimated Rt for India

aforementioned cases. Any method for detecting changepoint which provides any type of anomaly score or regularity
score can be used in our framework with suitable transformation. Thus our method allows to utilize the rich collection
of methods existing for crisp changepoint detection for the problem of fuzzy changepoint detection.
As various simulations show, even for very simple regularity measures, like t-test statistic and Kolmogorov-Smirnov
test statistic, combining them with the rough-fuzzy CPD increases their efficiency by far. In all cases, except for
the discrete jump models (where the assumption of fuzziness in changepoint is violated), rough-fuzzy CPD reduces
the MSE in detecting the changepoints. In comparison to existing fuzzy and crisp changepoint detection algorithms,
rough-fuzzy CPD turns out to be more efficient in estimation of continuous and smooth changes in mean.
The asymptotic distribution mentioned in theorem 2 and theorem 2 connects the rough-fuzzy CPD to a hypothesis
testing framework, allowing one to output the statistical significance of the estimated changepoints as well. Since,
theorem 2 allows us to derive the joint asymptotic distribution of the proposed entropy at multiple time points, we are
able to rule out false positives and apply the rough-fuzzy CPD for multiple changepoint detection problem.
From a computational point of view, this paper addresses the issue of obtaining closed form expressions for upper and
lower approximations of the rough fuzzy partitions, described by an estimated changepoint, thus allowing the overall
algorithm to be much faster. In general, the time and space complexity of the overall algorithm will be dominated by
the cost of computing the regularity measures.
Our approach of using fuzzy and rough set theories has definite advantages which is reflected in the robustness of
the rough-fuzzy CPD. Under changes in the signal-to-noise ratio, this method gives a steady improvement over the
regularity measure based changepoint detection. We observe that for a diverse range of SNR, the improvement in accuracy of estimates obtained by the rough-fuzzy CPD over that of the base model remains fairly uniform ranging from
88% to 96%. On the other hand, increasing the fuzziness F in the continuous change in mean function increases the
efficiency of the rough-fuzzy CPD in comparison to the base statistic used. As fuzziness increases, a rapid increment
in efficiency can be observed. Also, rough-fuzzy CPD rarely outputs outlying or spurious false positive estimate of
E
changepoint, precisely because the entropy curve Hâˆ†,Î´,w
(s) possesses more smoothness properties than its regularity
measure R(t) counterpart. In fact, even in the cases when the base model predicts a bimodal distribution of estimated changepoints, our model shrinks the two modes towards the true changepoint, as illustrated in figure 3. Finally,
through sensitivity analysis, we have shown that the rough-fuzzy CPD performs reasonably well on a wide range of
hyperparameter values.
22

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

A P REPRINT

On the flip side, there are some obvious limitations. The rough-fuzzy CPD may not perform good if the assumption of
fuzziness in the true changepoint is violated (i.e., there is a discrete jump discontinuity in the mean function), or if the
regularity measure R(t) is a bad indicator for the type of changepoint that we are trying to detect. Another limitation
could be the choice of the hyperparameters w, âˆ† and Î´.
A future possibility for extension of this investigation may consider building a probabilistic view of the detected
changepoint, which should enable one to provide a confidence interval for the estimate of changepoint, which is
more meaningful in terms of gradual change. Further, rough-fuzzy CPD can be viewed as an extension of an image
segmentation algorithm [25] into the domain of changepoint detection. A future endeavor in this direction could be
to generalize a family of image segmentation algorithms to fit perfectly in the context of a changepoint detection
problem.

Software
For broader dissemination of our work, we have developed the python package roufcp which is available at
pypi.org/project/roufcp/. All codes for the package has been open sourced and are made available at a github respository github.com/subroy13/roufcp.

Acknowledgements
SK Pal acknowledges the National Science Chair of SERB-DST, Govt. of India, that he is holding currently.

References
[1]
[2]
[3]
[4]
[5]
[6]
[7]
[8]
[9]
[10]
[11]
[12]
[13]

[14]
[15]

T. L. Lai. â€œSequential changepoint detection in quality control and dynamical systemsâ€. In: Journal of the Royal
Statistical Society: Series B (Methodological) 57.4 (1995), pp. 613â€“644.
D. Lemire. â€œA better alternative to piecewise linear time series segmentationâ€. In: Proceedings of the 2007
SIAM International Conference on Data Mining. SIAM. 2007, pp. 545â€“550.
D. V. Hinkley. Inference about the change-point in a sequence of random variables. 1970.
A. J. Scott and M. Knott. â€œA cluster analysis method for grouping means in the analysis of varianceâ€. In:
Biometrics (1974), pp. 507â€“512.
A. Sen and M. S. Srivastava. â€œOn tests for detecting change in meanâ€. In: The Annals of statistics (1975),
pp. 98â€“108.
D. Picard. â€œTesting and estimating change-points in time seriesâ€. In: Advances in applied probability (1985),
pp. 841â€“867.
R. Killick, P. Fearnhead, and I. A. Eckley. â€œOptimal detection of changepoints with a linear computational
costâ€. In: Journal of the American Statistical Association 107.500 (2012), pp. 1590â€“1598.
R. Turner, Y. Saatci, and C. E. Rasmussen. â€œAdaptive sequential Bayesian change point detectionâ€. In: Temporal
Segmentation Workshop at NIPS. 2009, pp. 1â€“4.
R. P. Adams and D. J. MacKay. â€œBayesian online changepoint detectionâ€. In: arXiv preprint arXiv:0710.3742
(2007).
J. Knoblauch and T. Damoulas. â€œSpatio-temporal Bayesian on-line changepoint detection with model selectionâ€. In: arXiv preprint arXiv:1805.05383 (2018).
Z. Harchaoui, E. Moulines, and F. R. Bach. â€œKernel change-point analysisâ€. In: Advances in neural information
processing systems. 2009, pp. 609â€“616.
K. Haynes, P. Fearnhead, and I. A. Eckley. â€œA computationally efficient nonparametric approach for changepoint detectionâ€. In: Statistics and Computing 27.5 (2017), pp. 1293â€“1305.
A. Tartakovsky, I. Nikiforov, and M. Basseville. Sequential Analysis: Hypothesis Testing and Changepoint
Detection. Chapman & Hall/CRC Monographs on Statistics & Applied Probability. Taylor & Francis, 2014.
ISBN : 9781439838204. URL : https://books.google.co.in/books?id=zhsbBAAAQBAJ.
S. Aminikhanghahi and D. J. Cook. â€œA survey of methods for time series change point detectionâ€. In: Knowledge and information systems 51.2 (2017), pp. 339â€“367.
G. J. van den Burg and C. K. Williams. â€œAn Evaluation of Change Point Detection Algorithmsâ€. In: arXiv
preprint arXiv:2003.06222 (2020).

23

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

[16]
[17]
[18]
[19]
[20]
[21]
[22]
[23]
[24]
[25]

[26]
[27]
[28]
[29]
[30]
[31]
[32]
[33]
[34]
[35]
[36]
[37]
[38]
[39]
[40]
[41]
[42]

[43]

A P REPRINT

S.-T. Chang, K.-P. Lu, and M.-S. Yang. â€œFuzzy change-point algorithms for regression modelsâ€. In: IEEE Transactions on Fuzzy Systems 23.6 (2015), pp. 2343â€“2357.
D. Sharma and L. Sankaran. â€œCognitive and social forces in dialect shift: Gradual change in London Asian
speechâ€. In: Language variation and Change (2011).
M. Trauth et al. â€œAbrupt or Gradual? Change Point Analysis of the Late Pleistocene-Holocene Chew Bahir
Record from Southern Ethiopiaâ€. In: Quaternary Research 90.2 (2018), pp. 321â€“330.
K. C. Rose and T. M. Bown. â€œGradual evolution and species discrimination in the fossil recordâ€. In: Rocky
Mountain Geology 24.special_paper_3 (1986), pp. 119â€“130.
G. Hunt. â€œGradual or pulsed evolution: when should punctuational explanations be preferred?â€ In: Paleobiology
34.3 (2008), pp. 360â€“377.
J.-R. Yu, G.-H. Tzeng, and H.-L. Li. â€œGeneral fuzzy piecewise regression analysis with automatic change-point
detectionâ€. In: Fuzzy sets and systems 119.2 (2001), pp. 247â€“257.
K.-P. Lu, S.-T. Chang, and M.-S. Yang. â€œChange-point detection for shifts in control charts using fuzzy shift
change-point algorithmsâ€. In: Comput. Ind. Eng. 93 (2016), pp. 12â€“27.
M. F. D Angelo et al. â€œIncipient fault detection in induction machine stator-winding using a fuzzy-Bayesian
change point detection approachâ€. In: Applied Soft Computing 11.1 (2011), pp. 179â€“192.
R. Chatterjee and K. Avijit. Global Image Thresholding Based on Change-point Detection. Mar. 2017.
D. Sen and S. K. Pal. â€œGeneralized Rough Sets, Entropy, and Image Ambiguity Measuresâ€. In: Trans. Sys. Man
Cyber. Part B 39.1 (Feb. 2009), pp. 117â€“128. ISSN: 1083-4419. DOI: 10.1109/TSMCB.2008.2005527. URL:
https://doi.org/10.1109/TSMCB.2008.2005527.
C. Truong, L. Oudre, and N. Vayatis. â€œSelective review of offline change point detection methodsâ€. In: Signal
Processing 167 (2020), p. 107299.
L. A. Zadeh. â€œFuzzy setsâ€. In: Information and control 8.3 (1965), pp. 338â€“353.
G. Chen, T. T. Pham, and N. Boustany. â€œIntroduction to fuzzy sets, fuzzy logic, and fuzzy control systemsâ€. In:
Appl. Mech. Rev. 54.6 (2001), B102â€“B103.
H.-J. Zimmermann. â€œFuzzy decision support systemsâ€. In: Computational Intelligence: Soft Computing and
Fuzzy-Neuro Integration with Applications. Springer, 1998, pp. 198â€“229.
G. Bojadziev. Fuzzy logic for business, finance, and management. Vol. 23. World Scientific, 2007.
S. Kabir and Y. Papadopoulos. â€œA review of applications of fuzzy sets to safety and reliability engineeringâ€. In:
International Journal of Approximate Reasoning 100 (2018), pp. 29â€“55.
S. Mitra and S. K. Pal. â€œFuzzy sets in pattern recognition and machine intelligenceâ€. In: Fuzzy Sets and systems
156.3 (2005), pp. 381â€“386.
Z. Pawlak. â€œRough Setsâ€. In: International Journal of Computer and Information Sciences (1982).
Z. Pawlak. â€œRough Sets: Theoretical Aspects of Reasoning about Data Kluwer Academic Publishersâ€. In: Dordrecht (1991).
N. R. Pal and S. K. Pal. â€œEntropy: a new definition and its applicationsâ€. In: IEEE Transactions on Systems,
Man, and Cybernetics 21.5 (1991), pp. 1260â€“1270.
J. C. S. de Miranda and L. Fichmann. â€œA generalization of the concept of differentiabilityâ€. In: Resenhas do
Instituto de MatemÃ¡tica e EstatÃ­stica da Universidade de SÃ£o Paulo 6.4 (2005), pp. 397â€“427.
A. Siddiqi. Functional Analysis and Applications. Industrial and Applied Mathematics. Springer Singapore,
2018. ISBN: 9789811037252. URL: https://books.google.co.in/books?id=7%5C_RZDwAAQBAJ.
S. Arora, H. Browne, and D. Daners. â€œAn alternative approach to FrÃ©chet derivativesâ€. In: arXiv preprint
arXiv:1910.11531 (2019).
J. Shao. â€œDifferentiability of Statistical Functionals and Consistency of the Jackknifeâ€. In: The Annals of Statistics 21.1 (1993), pp. 61â€“75. ISSN: 00905364. URL: http://www.jstor.org/stable/3035580.
W. RÃ¶misch. â€œDelta method, infinite dimensionalâ€. In: Wiley StatsRef: Statistics Reference Online (2014).
K.-P. Lu, S.-T. Chang, and M.-S. Yang. â€œChange-point detection for shifts in control charts using fuzzy shift
change-point algorithmsâ€. In: Computers & Industrial Engineering 93 (2016), pp. 12â€“27.
K.-P. Lu and S.-T. Chang. â€œDetecting change-points for shifts in mean and variance using fuzzy classification
maximum likelihood change-point algorithmsâ€. In: Journal of Computational and Applied Mathematics 308
(2016), pp. 447â€“463.
P. Fryzlewicz et al. â€œWild binary segmentation for multiple change-point detectionâ€. In: The Annals of Statistics
42.6 (2014), pp. 2243â€“2281.

24

Rough-Fuzzy CPD: A Gradual Change Point Detection Algorithm

[44]

[45]
[46]
[47]

[48]

[49]
[50]

[51]

[52]

[53]

[54]

A P REPRINT

J. Durbin, S. James Durbin, and S. Koopman. Time Series Analysis by State Space Methods. Oxford Statistical
Science Series. Clarendon Press, 2001. ISBN: 9780198523543. URL: https : / / books . google . co . in /
books?id=XRCu5iSz%5C_HwC.
R Core Team. R: A Language and Environment for Statistical Computing. R Foundation for Statistical Computing. Vienna, Austria, 2020. URL: https://www.R-project.org/.
M. Lynn S Bickley and D. Bates. The Fashoda Incident of 1898: Encounter on the Nile. Oxford University
Press, 1984. ISBN: 9780192117717. URL: https://books.google.co.in/books?id=pk2aAAAAIAAJ.
E. Wegmann. The Design and Construction of Dams: Including Masonry, Earth, Rock-fill, Timber, and Steel
Structures, Also the Principal Types of Movable Dams. John Wiley & Sons, Incorporated, 1922. ISBN:
9780727752239. URL: https://books.google.co.in/books?id=Lc91swEACAAJ.
S. Purkayastha et al. â€œA comparison of five epidemiological models for transmission of SARS-CoV-2 in Indiaâ€.
In: medRxiv (2020). DOI: 10.1101/2020.09.19.20198010. eprint: https://www.medrxiv.org/content/
early/2020/09/22/2020.09.19.20198010.1.full.pdf. URL: https://www.medrxiv.org/content/
early/2020/09/22/2020.09.19.20198010.1.
S. Zhang, Z. Xu, and H. Peng. â€œChange Point Modeling of Covid-19 Data in the United Statesâ€. In: (2020).
J. Dehning et al. â€œInferring change points in the spread of COVID-19 reveals the effectiveness of interventionsâ€. In: Science 369.6500 (2020). ISSN: 0036-8075. DOI: 10 . 1126 / science . abb9789. eprint: https :
//science.sciencemag.org/content/369/6500/eabb9789.full.pdf. URL: https://science.
sciencemag.org/content/369/6500/eabb9789.
W. O. Kermack and A. G. McKendrick. â€œA contribution to the mathematical theory of epidemicsâ€. In: Proceedings of the royal society of london. Series A, Containing papers of a mathematical and physical character
115.772 (1927), pp. 700â€“721.
C. Fraser et al. â€œPandemic Potential of a Strain of Influenza A (H1N1): Early Findingsâ€. In: Science 324.5934
(2009), pp. 1557â€“1561. ISSN: 0036-8075. DOI: 10.1126/science.1176062. eprint: https://science.
sciencemag.org/content/324/5934/1557.full.pdf. URL: https://science.sciencemag.org/
content/324/5934/1557.
A. Cori et al. â€œA New Framework and Software to Estimate Time-Varying Reproduction Numbers During
Epidemicsâ€. In: American Journal of Epidemiology 178.9 (Sept. 2013), pp. 1505â€“1512. ISSN: 0002-9262. DOI:
10 . 1093 / aje / kwt133. eprint: https : / / academic . oup . com / aje / article - pdf / 178 / 9 / 1505 /
17341195/kwt133.pdf. URL: https://doi.org/10.1093/aje/kwt133.
C.-1. I. O. D. O. Group. Dataset for tracking COVID-19 spread in India. Accessed on 2020-09-26 from https:
//api.covid19india.org/. 2020.

25

