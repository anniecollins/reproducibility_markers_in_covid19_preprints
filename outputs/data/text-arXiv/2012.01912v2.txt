arXiv:2012.01912v2 [stat.AP] 3 Feb 2021

Assaying Large-scale Testing Models to Interpret
COVID-19 Case Numbers.
Michel Besserve1,2,‚àó , Simon Buchholz1 and Bernhard SchoÃàlkopf1
1

2

Max Planck Institute for Intelligent Systems, TuÃàbingen, Germany.
Max Planck Institute for Biological Cybernetics, TuÃàbingen, Germany.
‚àó Correspondence to: michel.besserve@tuebingen.mpg.de

Abstract
Large-scale testing is considered key to assess the state of the current COVID-19 pandemic. Yet, the link between the reported case numbers and the true state of the pandemic
remains elusive. We develop mathematical models based on competing hypotheses regarding this link, thereby providing different prevalence estimates based on case numbers, and
validate them by predicting SARS-CoV-2-attributed death rate trajectories. Assuming that
individuals were tested based solely on a predefined risk of being infectious implies the
absolute case numbers reflect the prevalence, but turned out to be a poor predictor, consistently overestimating growth rates at the beginning of two COVID-19 epidemic waves. In
contrast, assuming that testing capacity is fully exploited performs better. This leads to using the percent-positive rate as a more robust indicator of epidemic dynamics, however we
find it is subject to a saturation phenomenon that needs to be accounted for as the number
of tests becomes larger.

Main
Assessing the spread of infectious diseases such as the novel coronavirus disease 2019 (COVID19) epidemic caused by SARS-CoV-2 is a major challenge for modern societies. Reported case

1

number trajectories reflect in principle the epidemic dynamics, and are thus used within the
scientific community to infer its evolution (1, 2), but are also publicly reported and debated
(3‚Äì5), along with the effectiveness of governmental interventions in lowering them. However,
the number of reported cases may be influenced by multiple factors, notably depending on the
public policy regarding testing, such that its relationship to epidemic dynamics needs to be
clarified.
We first investigate this question theoretically with a SIR model of the epidemic, and characterize the dynamics at a given time t by the instantaneous exponential growth rate Œª(t) of the
prevalence I(t), i.e. the total number of infectious individuals at that time (6, 7) (see Methods,
section SIR Model). In the initial phase of an epidemic wave, Œª(t) is assumed constant and
equals Œª0 , reflecting the baseline disease transmission rate before the onset of governmental
response. This implies that prevalence evolves linearly in logarithmic scale with slope Œª0 , as
illustrated in Fig. 1D. After the onset of containment measures, the growth rate is reduced to a
lower value Œª0 ‚àíŒ∏0 such that the log-prevalence overall evolves as a piecewise linear function of
time, and the absolute change in slope, Œ∏0 , quantifies the causal effect of containment measures
on the transmission rate (see Fig. 1D and Methods, section SIR Model).
To model how this change is reflected in the number of confirmed cases depending on testing
policy, we use similar abstraction principles as for continuous age-structured population models
(8) and define a risk-structured population model as follows. The idealized large-scale testing
mechanism relies on a risk score r attributed to each individual. This risk score accounts for
observable factors officially used by governments to determine an order of priority for testing
(e.g. symptoms, contacts with positive cases, ...), as well as for unobserved factors influencing
the likelihood of a given individual to be tested (e.g. location specific limitation of testing
capacity). At any time the population being actually tested is assumed to be comprised of all
and only the individuals above a given minimum risk score œÅ(t). Given this framework, three

2

Testing capacity

Non-infectious

Candidates for testing

C

Confirmed
cases

Adapted testing (AT) regime

Test
rate

SIR model

Tested

B

Low-risk drop
of % infectious

Saturating testing

E

Density of infectious

Limiting factor (LF) regime

Onset of
containment

Total population

Causal influence
Causal influence to estimate

Density of non-infectious

Risk score (r)

Government
response

Transmission
rate

Prevalence

Fixed risk
threshold

D Evolution of case numbers (AT regime)

Causal graph for AT regime

Log. scale

Infectious

Exhausted
capacity

F

Time (days)

Observed
Hidden

G Evolution of case numbers (LF regime)

Causal graph for LF regime
Test
rate

Confirmed
cases

Government
response

Log. scale

A

Saturating
Testing regime

SIR model

Tested
Transmission
rate

Prevalence

Low-risk drop
of % infectious
Onset of
containment

Total population

Time (days)

Figure 1: Different testing regimes in a risk-structured population model. (A) Schematic
of the AT regime, relying on a risk-structured population model described in B, in which all and
only individuals with a risk score above r0 are tested (orange rectangle) while testing capacity is
larger (violet rectangle). (B) Densities of infectious and non-infectious individuals as a function
of risk score. The density of infectious is represented for a given prevalence I0 in light pink,
to which the dark pink region is added for a doubling of the prevalence. The gray and pink
areas from r0 to rmax reflect the number of negative and positive test outcomes for panel A,
respectively. A drop in the proportion of infectious at low risk scores affects the evolution of
case numbers in the saturating testing regime described in G (black and violet arrow). (C)
Causal graph between observed (blue) and hidden (green) variables in the AT regime. The red
arrow represents the causal effect of measures on the epidemic dynamics we wish to evaluate.
(D) Schematic time course of prevalence (black), number of tests (orange) and of confirmed
cases (cyan), for the AT regime. The dashed line indicates the onset of containment measures,
inflecting the initial growth rate Œª0 of the prevalence. (E) Same as A for the LF regime, in
which limited testing capacity constrains the number of tested individuals (violet arrow) to a
minimum risk score œÅ(t) above the threshold r0 set for candidates (green rectangle). (F) Same
as C for the LF regime, with the number of tests now influencing case numbers. (G) Same as D
for the LF regime. The violet dashed line indicates the drop in the growth rate of case numbers,
resulting from saturating testing (see B).

3

paradigmatic testing regimes are considered in the following paragraphs.
First, in the adapted testing (AT) regime, tests are performed for all individuals with risk
above a constant risk threshold r0 imposed by government policy, such that œÅ(t) = r0 at all
times t. This entails testing capacity allows to handle the growing pools of candidates set by the
policy as the epidemic spreads. The rate of cases thus remains uninfluenced by the number of
tests performed, which only adapts to the number of candidates. To represent the mechanisms
leading to the observed case and test numbers, we use causal graphs, which allow evaluating
causal effects and learning mechanisms from data in a principled way (9, 10). Influences between variables for the AT regime are summarized by the causal graph of Fig. 1C, showing
that the (unobserved) true prevalence is the only direct cause of the observed case numbers
Y (t). This allows to infer the causal effect of government response on prevalence from the time
course of Y (t) using the above mentioned SIR model. Indeed, under simplifying assumptions
(see Methods section Large scale testing models), the total number of positive cases is then
proportional to the prevalence of the disease, I(t), which modulates linearly the risk-structured
density of infectious individuals illustrated in Fig. 1B. Prevalence variations can thus be estimated based on case numbers variation, irrespective of the number of tests performed T (t), as
illustrated in Fig. 1D.
One limitation of the AT regime is that the demand for tests does not necessarily match
the supply. We thus introduce a second regime modeling a limited testing capacity, which
we assume fully exploited to perform the maximum number of tests while prioritizing larger
risk scores. This limiting factor (LF) regime notably models the inability to test all candidates
indicated by the government policy threshold r0 . The number of tests performed, reflecting testing capacity, then becomes a limiting quantity directly influencing the rate of confirmed cases
Y (t) as depicted in Fig. 1E and the corresponding causal graph of Fig. 1F. When estimating
the effect of public policy on epidemic dynamics, this graph configuration indicates a caveat

4

called confounding: government response affects simultaneously the number of tests and the
containment policy, thereby influencing case numbers along two different causal pathways. As
a consequence, the modification of the case numbers‚Äô time course are not solely imputable to
containment measures on transmission rate, but also to concurrent effects of policy on testing
capacity. Not accounting for changes in the number of tests may thus lead to misleading interpretations of epidemic dynamics based on the case number time course. A putative example is
depicted in Fig. 1G, where the growth rate of the number of tests increases concomitantly with
a switch from growth to decay of prevalence due to social distancing measures instated at the
onset of lockdown. Under simplifying assumptions (see Methods, section Large scale testing
models), reported cases then become proportional to the number of tests actually performed,
reflecting the naive intuition: ‚Äúthe more we test, the more we find cases‚Äù. The case numbers are
then approximately given by
Y (t) ‚âà Œ∫I(t)T (t)

(1)

where T (t) is the test rate at time t and Œ∫ is a multiplicative constant. This relation leads to
a growing number of cases in Fig. 1G, that clearly misrepresents the true epidemic dynamics
(characterized by the prevalence) and the effect containment measures have on it.
Finally, the above limiting factor regime can evolve into a saturating testing (ST) regime as
the testing capacity increases during the course of the epidemic, allowing to satisfy the demand
for testing individuals with smaller and smaller risk scores. Going below a certain risk level
may result in an drop of the probability of a single test to detect a true positive (see Fig. 1B).
For example, generalizing testing to asymptomatic individuals is likely to reduce the probability
of detecting positive cases among them. In the example of Fig. 1G (see violet dashed line), this
leads to a milder growth rate of the number of cases compared to the prediction by the LF
regime model of equation 1, again misrepresenting the epidemic dynamics if not accounted for.
We next investigate which of the above large-scale testing regimes describe best the current

5

COVID-19 epidemic based on empirical data. We evaluate the validity of models associated to
each regime based on their ability to predict the evolution of death rates in two datasets: the
World Countries testing dataset of Our World in Data1 (11) containing time resolved evaluations of the number of tests and confirmed cases for many countries across the world, and the US
States dataset from the COVID Tracking Project 2 that contains similar data for all US states. As
described in the schematic of Fig. 2A, the testing models provide an estimate of the prevalence
which can be exploited to predict the variations of deaths rate D(t) across time using a convolution with the onset-to-death distribution, describing the stochastic latency between the time
of infection and time of death in the population, and which has been measured experimentally
and subsequently modeled (12, 13) (see Methods, section Relating infections and deaths).
The testing models include the regimes described in Figs. 1A and 1E: on the one hand the
adapted testing model is our baseline, in which the rate of cases Y (t) reflects I(t) up to a
multiplicative factor; on the other hand, the limiting factor model implies that the rate of cases
is proportional to the product of I(t) and T (t) (based on equation (1)). We additionally included
two models accounting for a possible saturation of the limiting factor regime, as the number of
tests becomes too large (the up-saturating testing regime described in Fig. 1B and G) or as the
number of tests becomes too small (the down-saturating regime, see Methods, section Large
scale testing models). All models are associated with a testing function fm (where m indicates
the model), parameterized by one scalar coefficient in the case of both saturated models, and
linking the number of confirmed cases to prevalence through
Y (t) = I(t)fm (T (t)) .

(2)

b such that
Each model is thus naturally associated to an estimate of prevalence I(t)
b =
I(t)
1
2

Y (t)
.
fm (T (t))

available at ourworldindata.org/coronavirus
available at covidtracking.com

6

(3)

A

Mathematical functions
Observed time series

Covariates

Estimated time series
Model
parameters

Optimization

Test
rate

Testing model
inversion

Death rate
dynamics model

Estimated
prevalence

Estimated
death rate

Death prediction
loss

Confirmed
cases

Death
rate

Rate of confirmed cases/number of infectious

103

Testing models
Adapted
Limiting
Up-saturating
Down-saturating

1.4

**

1.2

*

**

0.6
0.4
Linearity range

101

1.0

* p<.05
** p<.005

1.0

102

D

Prediction error (World countries)

0.8

0.2

101
1750
1500

104
102
103
Tests/day/106 inhabitants

United Kingdom

Adapted
Limiting
Up-saturating
Observed death rate

Adapted

F
1000

1250

800

1000

600

0.8
0.6
0.4
0.2
0.0

0.0

E

Deaths per day

C

Up-saturating testing error

B

104

Limiting

Up-sat.

Down-sat.

France
Adapted
Limiting
Up-saturating
Observed death rate

0.0

G
4000

0.2

0.4
0.6
0.8
Adapted testing error

1.0

1.2

United States

Adapted
Limiting
Up-saturating
Observed death rate

3000
2000

750

400

500

1000

200

250

0

0

0
Mar Apr May Jun Jul Aug Sep Oct NovDec Jan Feb

Mar Apr May Jun Jul Aug Sep Oct NovDec Jan Feb

Mar Apr May Jun Jul Aug Sep Oct NovDec Jan Feb

Figure 2: Validation of population testing models based on death rate prediction. (A)
Schematic of the computational pipeline for death rate prediction based on observed time-series,
mapping testing numbers to inferred death rate, and optimizing the testing model parameters to
minimize the prediction error of the true death rate. Country covariates are allowed to modulate the model parameters. (B) Functions associated to different testing models, with median
parameters fitted by the procedure in A (without covariates) on the World countries dataset.
Dashed line indicate upper and lower saturation threshold parameters, indicating the linearity
range of daily tests per inhabitant for which saturating models departs from the limiting factor
regime by less than a factor two. (C) Country-wise cross-validation prediction error for death
rate using different models linking these quantities to incidence. P-value is obtained by paired
Wilcoxon signed-rank test. (D) Scatter plot showing the superiority of the limiting factor testing
model, relative to the adapted testing model. (E-G) Prediction of the time course of the empirical death rate (in black) for 3 example countries, based on inferring the number of infectious
individuals, either using the limiting factor (in orange), the adapted testing model (in blue) and
the up-saturating model (in green). See also Supplementary Figs. 1-2.
7

This framework is exploited to compare testing models based on and their ensuing ability to preb
dict the observed death rate D(t), with estimate D(t).
For that we perform cross-validation of
these models across countries, optimizing for putative free parameters of each model (see Methods section Validation of testing models). Optimization of the parameters was implemented
using the automated differentiation capabilities of the pyTorch library (14) and the BFGS algorithm (see Methods section Optimisation of testing models). We estimated the prediction error
of the logarithmic death rate of each model using 10-fold cross-validation across 66 countries
(see Methods, section Exclusion-selection of countries for the death prediction for selection
criteria).
The functions associated to different testing models are shown (up to a multiplicative constant) on Fig. 2B (see Methods section Large scale testing models for their theoretical justification), using the median parameters fitted on the World Countries dataset for the Up- and Downsaturating models. In line with our previous explanations, the number of confirmed cases is
independent of the number of tests performed per inhabitants in the adapted model, while there
is a linear dependency between these quantities in the limiting factor model. The up- and downsaturating models are respectively characterized by upper and lower thresholds parameters at
which the confirmed cases prediction depart from the (linear) limiting factor model by a factor
2. Cross-validation results leads to an estimate of the lower threshold of 38(32,43) daily tests per
million inhabitants and an upper threshold of 1.71(1.53,2.06) thousands daily tests per million
inhabitants (estimates are median of the values obtained during cross-validation, CI computed
using the MedianCI function of the DescTools R package).
We further compared cross-validation errors of each model (yielding one error value per
country) using paired two-sided Wilcoxon signed-rank tests. Figure 2C shows that the limiting
factor model performs significantly better than the adapted testing model (p < 3.0 √ó 10‚àí4 ,
N = 66), as further supported by error values of individual countries shown in the scatter plot

8

of Fig. 2D. Moreover, taking into account a form of saturation further significantly improved the
prediction over the simple limiting factor model. In particular, the up-saturating model shows
the strongest improvement (p = 2.1 √ó 10‚àí3 , N = 66). This suggests that in the last months,
the increase in the number of tests has led to testing individuals with a lower probability of
being infectious. This interpretation is in line with the under estimation of death rate by the
limiting factor model (corresponding to the percent-positive rate, up to a multiplicative constant)
during this period, illustrated on several countries in Fig. 2E-G (orange plots). Overall, the
improvements brought by saturating models suggest the range of [38, 1700] tests per day per
million inhabitants provided by their respective thresholds provide a good indication of the
domain of validity of the linear behavior of the limiting factor model.
In order to assay testing models at a different spatial scale, we performed the same analysis
across 40 states of the USA (see Methods, section Data selection for the US). Again, while the
limiting factor model still outperformed the adapted testing model (p = 2.6 √ó 10‚àí7 , N = 40),
both up- and down-saturated parametric models further reduced significantly the prediction error (p = 7.4 √ó 10‚àí4 and p = 2.8 √ó 10‚àí4 , respectively, for the comparison to the limiting factor
model; see Supplementary Fig. 1). This supports again the existence of saturation phenomena
that make the testing model depart from the purely linear limiting factor regime, with lower
threshold 170(160,180) daily tests per million inhabitants, and upper threshold 3.9(3.7,4.3)
thousands daily tests per million inhabitants (median value; CI computed using the MedianCI
function of the DescTools R package).
To improve the predictive power of parametric models on the World‚Äôs countries dataset,
we also investigated ways to handle country heterogeneity. While fitting a separate model to
each country is prone to overfitting, we allowed the model to adapt to the country through the
influence of country specific covariates on the parameter of the model, as illustrated in Fig. 2A.
We used the country‚Äôs Gross Domestic Product (GDP) per capita, population density, and the

9

percentage of urban population as covariates prone to influence the testing capabilities and the
risk structure of the population in our model. Adding these covariates did not consistently
improve the model‚Äôs predictive power (see Supplementary Fig. 2), suggesting the increase in
sample complexity outweighed the benefits of adaptivity to the countries‚Äô heterogeneity allowed
by this covariate dependency.
As shown in the examples of Fig. 2E-G, using the adapted testing model, i.e. case numbers,
to infer death rate may lead to severe misevaluation of the timing and magnitude of the death
rate peaks, which may lead to inaccurate political sentiment towards the disease and unsuitable
political decisions. In contrast, using the limiting factor regime is a major improvement, and has
the benefit do be associated to a simple proxy for epidemic dynamics: the percentage of positive
tests. However, we have evidence that this quantity turns out to saturate, in particular as more
tests are performed, as taking into account this saturation lead to more accurate predictions.
Since these results imply that the adapted testing regime inaccurately estimates the prevalence
of the disease, we next studied the impact of choosing this assumption for growth rate and policy
effect estimations and compared it to the best performing model according to our analysis: the
up-saturating limiting factor model.
Using the OWID testing dataset of World countries (11) we investigated epidemic growth
rate trajectories around two periods of instatement of stronger social distancing measures, that
we call ‚Äúlockdown‚Äù for the sake of conciseness, although the additional measures taken are
not officially qualified as lockdown in every country. These periods respectively start in the first
(called ‚Äúfirst lockdown‚Äù) and fourth (called ‚Äúsecond lockdown‚Äù) quarters of 2020 in many countries, notably European (see Methods, section Choice of lockdown dates and country selection
and Supplementary Tables 1-2 for details). Missing data were interpolated at the resolution of
a single day using cumulative numbers, and rates were estimated using first-order differences
between successive days

10

10
10

2

20

60

New confirmed cases (2nd lockdown)
103

102

101

102
101

10

10
0
10
20
30
days from lockdown onset
Countries (1st lockdown) Countries (2nd lockdown)
Austria
Austria
Belgium
Belgium
Canada
Croatia
Germany
Finland
Italy
France
Malaysia
Germany
Norway
Hungary
Pakistan
Italy
Switzerland
Lithuania
Thailand
Luxembourg
United Arab Emirates
Norway
United Kingdom
Romania
United States
Switzerland

1

Exp. growth rates (1st lockdown)
**

*
n. s.

0.1

20

0
20
40
days from lockdown onset

0.0

0.2

60

F

New tests (2nd lockdown)

Adapted
Up-saturating
Testing model

Exp. growth rates (2nd lockdown)
**

n. s.

0.10
104

103

20

G

100

10
0
10
20
days from lockdown onset

Government response stringency
**

40
Pre-lockdown
During lockdown
First lockdown Second lockdown
Lockdown

n. s.

Pre-lockdown
During lockdown
* p<.05
** p<.005

0.00
0.05
0.10

H 0.5
0.4

60

n. s.

0.05

30

80

20

*

0.1

E

20

Pre-lockdown
During lockdown

0.2

100

Tests per day and 106 inhabitants

Cases per day and 106 inhabitants

D

0
20
40
days from lockdown onset

Growth rate (/day)

100

0.4
0.3

103

Growth rate (/day)

101

C

New tests (1st lockdown)
104

Difference in slopes

102

1

B
Tests per day and 106 inhabitants

New confirmed cases (1st lockdown)

Average stringency index

Cases per day and 106 inhabitants

A

0.3
0.2

Adapted
Up-saturating
Testing model

Estimated lockdown effect
**

**

Adapted
Up-saturating
*

*
**

**

0.1
0.0
0.1
0.2

First lockdown Second lockdown
Lockdown

Figure 3: Impact of testing assumptions on growth rate estimation and policy evaluation.
(A) Number of daily new confirmed cases for each country for the first lockdown. Blue and
orange solid lines represent the average of Poisson regression models across countries, before
and during social distancing, respectively. (B) Same as A for daily new tests, first lockdown.
(C) Statistics of the exponential growth rate of the prevalence estimated by Poisson regression for each country individually, separately for time periods before and during application
of social distancing measures for the first lockdown. Prevalence is estimated according to two
testing models: adapted testing (left) and up-saturating (right). (D-F) Same as A-C for second lockdown. (G) Stringency index statistics across countries before and during application
of increased measures. (H) Estimate of the effect of social distancing on transmission rate,
with or without correction for testing. Indicated p-values correspond to Wilcoxon signed-rank
tests on the sign of the median of the regression coefficients or their difference (when above
a line connecting two quantities). Country color codes for A-B and D-E are indicated at the
figure‚Äôs bottom left corner. In A-B and D-E, linear patterns at the scale of few days reflect the
interpolation of missing data (see Methods). See also Supplementary Figs. 3-4 and Tables 1-2.

11

Figure 3A-B shows clear concurrent changes in testing and confirmed cases during the
first lockdown. Interestingly, while the amount of tests increases exponentially before such
measures are taken, it tends to plateau after, with variable growth rate signs across countries (see also Supplementary Fig. 3 for testing rates). We investigate how these variations
of testing at the demographic scale impact the estimation of the state of the epidemics. We
focus on the exponential growth rate as a marker of this state, as its sign is a key indicator
for decision-makers. Unless mentioned otherwise, statistical analyses are performed with a
(paired, two-sided) Wilcoxon signed-rank test. Fig. 3C compares the exponential growth rates
for the first lockdown estimated with Poisson regression (see Methods) on two time intervals:
before and after instatement of more stringent containment measures, and using both adapted
and up-saturating testing assumptions. While the estimated growth rate is high for the prelockdown period (median: .20 days‚àí1 (.16, .26)) using the adapted testing model, it is significantly smaller (median: .07 days‚àí1 (.00, .11)) when using the limiting factor testing regime
assumption (p = 2.5 √ó 10‚àí6 ; N = 13). This reflects the overestimation of the growth rate
before lockdown, due to a concurrent increase in test rates (see Supplementary Fig. 3), which
is corrected for by the up-saturating testing model. The growth rate estimated during the first
lockdown using the adapted model is not significantly negative for the adapted testing model
(p = 0.064; N = 13). In contrast, using the up-saturating model leads to a significant negative
growth-rate (p = 8.8 √ó 10‚àí3 ; N = 13), as expected, reflecting the effectiveness of the instated
measures. This likely reflects the correction of the upward bias of the adapted testing model
due to the still slightly increasing test rate during this period (p = 4.6 √ó 10‚àí2 ;N = 13, see
Supplementary Fig. 3). We further evaluated the impact of the testing model assumptions on
the estimation of the causal effect of the first lockdown, as measured by the difference between
during- and pre-lockdown slopes, computed separately for each country. The results on Fig. 3H
(left-hand boxes) confirm a significant causal effect of containment measures on growth rate for

12

both adapted and up-saturating factor testing models (p = 1.8 √ó 10‚àí3 and p = 1.9 √ó 10‚àí2 , respectively; N = 13). However, the up-saturating model leads to a significantly lower estimate
of this effect, reflecting the lower value of the initial growth-rate estimate (p = 1.9 √ó 10‚àí3 ;
)N = 13.
We next ran the same analyses for the second lockdown, in the fourth quarter of 2020
(Fig. 3D-F). While the overall initial growth rate prior to lockdown is expected to have moderate magnitude compared to the first lockdown (Fig. 3D), likely reflecting the higher initial stringency of measures as shown in Fig. 3G, using the up-saturating testing assumption additionally
reduces the initial growth-rate (p = 1.4 √ó 10‚àí3 , N = 13), suggesting again that the increase of
testing prior to lockdown tends to over-estimate the growth of the epidemics at the beginning of
this outbreak. In contrast, growth rates during lockdown are not significantly different from zero
under both testing assumptions (p > .05, N = 13), and of comparable magnitude. This result
are in line with the overall unsatisfactory outcome of the containment measures of the second
wave, in line with their significantly smaller stringency shown in Fig. 3G in comparison to the
first wave (p = 2.4 √ó 10‚àí4 , Kruskal-Wallis test; N = 26). Finally, the inferred causal effect
of the second lockdown, shown in Fig. 3H, is significant for both testing regime assumptions,
although the up-saturating model again leads to a lower value of this effect in comparison to
adapted testing (p = 1.6 √ó 10‚àí2 ; N = 13). These growth rate and causal effect analyses were
additionally replicated at the scale of US states for the first lockdown, supporting again an overestimation of the pre-lockdown growth rate and of the causal effect of containment measures
(Supplementary Fig. 4).
Overall, we provide evidence that large-scale testing for SARS-CoV-2 is best approximated
by an saturated limiting factor regime. This entails that the percent-positive tests can be used as
a default statistical proxy for prevalence dynamics instead of the absolute number of confirmed
cases, provided the number of daily tests per million inhabitants remains within a range of

13

[38, 1710] ensuring a linear effect on the number of confirmed cases. Above this range, the
percent-positive tests progressively become insensitive to prevalence variations, emphasizing
the importance of using a non-linear proxy to be able to keep track of the epidemic dynamics.
Our current estimate of the this proxy based on death rate prediction is the up-saturating model
b ‚àù Y (t) T (t) + 1710 ,
I(t)
T (t)

(4)

with T (t) in daily tests per million inhabitants.
Importantly, other proxies provide a biased perspective on the epidemic dynamics. In particular, increases in testing frequency lead to a consistent overestimation of the growth rate at
the onset of epidemic waves when relying only on the time evolution of confirmed cases. This
is likely due to a strengthening of political sentiment towards the disease, concomitant with
increased media coverage. The increase in testing rate however tends to plateau after the establishment of stronger social distancing policies. Putative causes for this change may be the
achievement of sufficient testing capacity from the perspective of health authorities. An important consequence of this time dependent testing rate is to overestimate the causal effect of the
social distancing measures of each epidemic wave and the initial spread of the epidemic, when
evaluations are based on the absolute number of confirmed cases. Using the serial interval distribution of the pandemic, the growth rate Œª of an epidemic relates to the reproduction number
R (15). Our results are thus in line with the observation that estimates for the reproduction
number based on observed cases are often higher (2,13,16) than estimates based on the number
of fatalities or patients in critical care (17), or cases among flight passengers (18). Therefore,
our results suggest that such analyses should either use more reliable indicators like patients
in ICU units or fatalities instead of reported case numbers, or include the most likely testing
assumptions in the model. Notable works that consider the effect of testing on case numbers
include (19, 20) and the project (21). However, as these works employ a limiting factor test-

14

ing model, their estimates are likely to become biased as the number of tests leaves the linearity
range, and they would benefit from using the up-saturating model estimated in the present paper.
One limitation of our results is that upon change of testing policy the relevant model may
change, and the proposed regimes are simple approximationseq: that can be improved by an
accurate and time resolved documentation on the testing process (for example by assessing the
evolution of testing capacity). More generally, as more epidemiological data will be gathered,
more accurate models of large-scale testing can be estimated. Notably, further characterization
of the testing process may be achieved through detailed modeling of the risk score used in
different countries and the distribution of infectious and non-infectious individuals according to
this score.
Finally, these results suggest that changes in public policy regarding testing must be wellthought-out and documented in order to maintain reliable assumptions on the testing mechanisms, and thus a precise and timely evaluation of epidemic dynamics. Awareness of this aspect
of testing at the demographic level are moreover particularly relevant in order to establish optimal epidemic control policies that mitigate economical impacts (22).

Methods
SIR Model
We use a simplified model of exponential spread of the disease within a country, neglecting the
influence of imported cases. We start with the Susceptible-Infectious-Recovered (SIR) model
dS
= ‚àíŒ≤(t)S(t)I(t)
dt
dI
= Œ≤(t)S(t)I(t) ‚àí Œ≥I(t)
dt
dR
= Œ≥I(t)
dt

15

where Œ≥ is the recovery rate, assumed constant, and Œ≤(t) is the disease transmission rate which
might be influenced by time varying social distancing measures. We assume that I(t) (the
current number of contagious individuals in a country) as well as R(t) remain small with respect
to the total population, as supported by empirical evidence (23, 24), such that variations of S(t)
relative to its initial value remain small. This approximation leads to a homogeneous first order
differential equation for I(t)
dI
= (Œ≤(t)S(0) ‚àí Œ≥) I(t) = Œª(t)I(t)
dt

(5)

where the sign of Œª(t) = Œ≤(t)S(0) ‚àí Œ≥ determines whether the outbreak goes on spreading or
diminishes. The rate Œª is closely related to the reproduction number R0 , which can be defined
as R0 =

Œ≤S(0)
Œ≥

in the SIR model (25). To infer the epidemic dynamics, we focus on estimating

Œª(t) which is directly related to I(t) as is logarithmic derivative, using equation 5, such that
d log(I)
1 dI
(t) =
(t) = Œª(t) .
dt
I(t) dt
Notably, this leads to the exponential form of the prevalence, further exploited in the section
Estimation of causal effects,
Z
I(t) = I(0) exp

t


Œª(u)du .

0

Large scale testing models
Risk-based testing framework
Following the same lines as age-structured population models with continuous age distribution
(8, 26), we consider the population as a continuum of individuals, for which we can define
densities of individuals satisfying particular properties. More specifically, we consider a riskstructured population in which the selection of candidates for testing is done through a random
risk variable R(k) that assigns to each individual k a positive risk. Note that for the remainder

16

of the supplementary information, R will always denote the random risk, and not the number
of recovered individuals of the above SIR model. The higher the risk, the higher is the priority
of the individual for being tested. This risk is assumed continuous valued and reflects not only
the observed information (symptoms, contact cases,...) but also exogenous influences that will
affect the probability of the individuals for being tested.
R(k, t) depends on the actual state of the individual œÉ(k, t) (infectious, œÉ(k, t) = 1, or not,
œÉ(k, t) = 0), and on the overall state of the epidemic (I(t) large makes individuals more likely to
be a contact case, thus to have a high risk). As a consequence, using the continuum assumption,
R(k, t) is distributed across the population according to a density of the form p(r|I(t), œÉ(k, t))
such that the probability of an arbitrary individual in state œÉ(k) to have a risk in the small
interval [r, r + dr] is p(r|I(t), œÉ(k))dr. The average number of infectious individuals in the
total population with risk in [r, r + dr] is given by
Ir (t)dr = E

X

1R(k)‚àà[r,r+dr] dr = I(t)p(r|I(t), œÉ = 1)dr ,

k,œÉ(k)=1

in the same way, the number of susceptible with a given risk is given by
Nr (t)dr = N (t)p(r|I(t), œÉ = 0)dr .
where N (t) is the total number of non-infectious individuals in the above SIR model, i.e.,
N (t) = S(t)+R(t). It is reasonable to combine the two compartments because many infections
are not detected so that it is not known if an individual recovered and the testing procedures
often do not depend on an earlier infection. Note that N (t) + I(t) = N (0) = S(0) is constant.
While for each value of the risk, I(t) intervenes as a multiplicative factor for the above
conditional quantities, Ir and Nr do not necessarily evolve linearly with I(t) without further
assumptions due the dependency on p(r|I(t), œÉ). We however make the following additional
assumptions in line with the above section of Supplementary Methods on SIR modeling.

17

‚Ä¢ N (t) remains close to N (0) for all times, i.e., I(t) is always much smaller than N (t)
reflecting that only a small proportion of the population is infected at any time,
‚Ä¢ Ir remains small in comparison to Nr at any given score value r (reflecting the low proportion of infectious within the population, and that the risk value achieved by an individual
does not provide strong evidence for her being infectious),
‚Ä¢ the modulation by I(t) of p(r|I(t), œÉ) is small with respect to its marginal p(r|œÉ), such
that p(r|I(t), œÉ) = p(r|œÉ) + u(r, I(t), œÉ), for  small and |u(r, I(t), œÉ)| < p(r|œÉ)
Specific testing regimes
Inference on the growth rate Œª(t) based on equation 5 requires estimation of the true number
of infectious I(t). In practice only the time evolution of confirmed cases Y (t) is known but
this is not necessarily a good indicator of I(t) as it also depends on the amount of testing T (t).
Taking the above risk based model, we assume the pool of T tested individuals is chosen as the
T having highest risk. This leads to the relation between T and threshold risk œÅ(T ) (taking the
expectation)
Z

rmax

(Nr + Ir ) dr .

T =
œÅ(T )

We assume moreover that testing is ‚Äùideal‚Äù such that every test is 100% reliable, performed
only once per individual and instantaneous (putative lags are discussed in section Reporting
delays). The expected number of confirmed cases is then
Z

rmax

E[Y (t)] =

Ir dr ,
œÅ(T )

with deviation from this expectation due to finite sampling (see section Fitting data with Poisson
regression). Replacing with the above approximation we get
Z

rmax

E[Y (t)] = I(t)

Z

rmax

p(r|œÉ = 1)dr + I(t)
œÅ(T )

u(r, I(t), œÉ = 1)dr ,
œÅ(T )

18

which leads to, by using the assumptions on u, the following approximate expression in the
form of a Taylor expansion:
Z

rmax

p(r|œÉ = 1)dr + o(I(t))

E[Y (t)] = I(t)

(6)

œÅ(T )

implying that the testing models can be expressed as a function of the true number of infected
and the number of tests
Z

rmax

E(Y (t)) ‚âà I(t)f (T (t)) with f (T (t)) =

p(r|œÉ = 1)dr

(7)

œÅ(T )

and due to counting nature of the number of confirmed cases, we assume that Y (t) follows a
Poisson distribution. We then consider the following testing regimes.

Adapted testing (baseline). The baseline model assumes testing has no influence on observed
cases and I and Y are proportional
E[Y (t)] = Œ∫I(t) = I(t)fa (T (t)).

(8)

This can be put in the above framework under the ‚Äùadapted testing ‚Äù assumption stating that:
T (t) is chosen in order to test all candidate individuals up to a fixed risk r0 , fixed by government
response once and for all. Indeed, under the approximation of equation 7, this leads to
Z

rmax

E[Y (t)] ‚âà I(t)

p(r|œÉ = 1)dr ,

(9)

r0

yielding the above linear relationship with Œ∫ =

R rmax
r0

p(r|œÉ = 1)dr, which does not depend on

I(t). On the other hand, to understand how the amount of testing is modulated, we can solve
for T
œÅ(T ) = r0

19

leading to
Z

rmax

Z

rmax

Z

rmax

p(r|I(t), œÉ = 1)dr
p(r|I(t), œÉ = 0)dr+I(t)
(Nr + Ir ) dr = N (t)
r0
r0
r0
Z rmax
Z rmax
rmax
p(r|œÉ = 1)dr+o(I(t))
u(r, I(t), œÉ = 0)dr+I(t)
p(r|œÉ = 0)dr+N (t)
r0
r0
r0
Z rmax
Z r0
Z rmax
p(r|œÉ = 1)dr ,
u(r, I(t), œÉ = 0)dr+I(t)
p(r|œÉ = 0)dr+N (0)
‚âà (N (0)‚àíI(t))
r0
0
r0
Z rmax
Z rmax
Z rmax
(p(r|œÉ = 1) ‚àí p(r|œÉ = 0)) dr .
u(r, I(t), œÉ = 0)dr+I(t)
p(r|œÉ = 0)dr+N (0)
‚âà N (0)

T (r0 ) =
Z
‚âà N (t)

r0

r0

r0

(10)
In this last approximation, the first term is constant, while the next two terms may vary as
a function of the prevalence I(t), in principle with comparable magnitude and also at least
comparable to the variations in the number of confirmed cases of equation 9. Notably, variations
in the second term, reflecting the number of non-infectious, may be caused by contact tracing
measures, leading, when I(t) gets large, to a larger number of non-infectious contacts assigned
high values of r, and thus being tested. The third term trivially reflects the shift in risk-structure
due to shifting from the non-infectious structure to the infectious structure as I(t) increases.
This justifies that the adapted testing assumption entails a putative dependency of the number
of test T (t) on I(t), justifying the causal graph of Fig. 1B (top).

Limiting factor testing.

Due to material or organizational limitations of the testing procedure,

all individuals with risk above r0 may not be tested. We model this regime by assuming that tests
are performed following the risk of individuals in decreasing order, until the testing capacity,
fixed to T (t), is completely exploited. Contrary to the above example, T (t) is now influencing
Y (t) through the relation
Z

rmax

E[Y (t)] = I(t)

p(r|I(t), œÉ = 1)dr .
œÅ(T (t))

20

We use additional assumptions to simplify this relation. Specifically, we assume a constant ratio

p(r|I(t), œÉ = 0)/p(r|I(t), œÉ = 1) = ¬µ0

for r ‚â• œÅ(T (t)) at all times.

(11)

This leads to
Z rmax
Z rmax
Z rmax
p(r|I(t), œÉ = 1)dr ,
p(r|I(t), œÉ = 0)dr + I(t)
(Nr + Ir ) dr = N (t)
T (t) =
œÅ(T )
œÅ(T )
œÅ(T )
Z rmax
Z rmax
p(r|I(t), œÉ = 1)dr ,
p(r|I(t), œÉ = 1)dr + I(t)
= (N (0) ‚àí I(t))¬µ0
œÅ(T )
œÅ(T )
Z rmax
= (¬µ0 N (0) + (1 ‚àí ¬µ0 )I(t))
p(r|I(t), œÉ = 1)dr .
œÅ(T )

(12)
such that the œÅ(T (t)) dependent term in the expectation of confirmed cases writes
Z rmax
T (t)
T (t)
p(r|I(t), œÉ = 1)dr =
‚âà
+ o(I(t))
¬µ0 N (0) + (1 ‚àí ¬µ0 )I(t)
¬µ0 N (0)
œÅ(T (t))
leading to (neglecting the order two term in I(t))
E[Y (t)] ‚âà

1
I(t)T (t) .
¬µ0 N (0)

Thus the expected number of cases takes the form of a mass action law, with proportionality to
both the number of tests T and to the number of infections I that governs the probability that a
randomly tested individual is infected, i.e., in our general testing model framework
E(Y (t)) = Œ∫I(t)T (t) = I(t)fl (T (t)).

(13)

Given detecting a new case relies on both testing the subject and that the subject is infected,
the above approximation can be interpreted as a law of mass action for testing, that induces a
multiplicative effect of the rate of new tests on the rate of new confirmed cases.

Up-saturating testing model. Based on a similar idea as in the previous model we in addition
assume that with increasing test numbers the probability of a test to be positive decreases, i.e.,

21

the quotient Ir /Nr increases as the risk r decreases. We relax the assumption that p(r|œÉ = 1) is
constant and instead consider the following parametric form
p(r|I(t), œÉ = 0) = p(r|œÉ = 0) = ŒΩ0 ,
p(r|I(t), œÉ = 1) = p(r|œÉ = 1) = ŒΩ1

œâ02
.
(rmax ‚àí r + œâ0 )2

This expression is almost constant and equal to ŒΩ1 for r > rmax ‚àí œâ0 but then decays quickly
accounting for saturation of the testing policy. Using manipulations similar to (12) we obtain
the following expression for the risk threshold
Z rmax
Z rmax
p(r|I(t), œÉ = 0)dr ‚âà N (0)ŒΩ0 (rmax ‚àí œÅ(T ))
(Nr + Ir ) dr ‚âà N (t)
T (t) =
œÅ(T )

œÅ(T )

T (t)
.
‚áí œÅ(T ) = rmax ‚àí
ŒΩ0 N (0)
(14)
The expected number of confirmed cases then reads

Z rmax
E[Y (t)] ‚âà I(t)
p(r|œÉ = 1)dr , = I(t)ŒΩ1
T (t)
0 N (0)

rmax ‚àí ŒΩ

= I(t)ŒΩ1 œâ0

œâ02
rmax ‚àí r + œâ0

r=rmax
r=rmax ‚àíT (t)/(N (0)ŒΩ0 )

T (t)/(N (0)ŒΩ0 )
.
T (t)/(N (0)ŒΩ0 ) + œâ0

Upon reparametrizing Œ∫ = ŒΩ1 œâ0 and Œ± = N (0)ŒΩ0 œâ0 we obtain the following testing model
E(Y (t)) = Œ∫I(t)

T (t)
= I(t)fu (T (t)).
T (t) + Œ±

(15)

Note that for small numbers of tests (i.e., T (t) < Œ±) this model behaves similarly to the limiting
factor testing model fl , i.e., every test has the same probability to be positive and confirmed
cases are proportional to I(t)T (t) while for large numbers of tests Y (t) ‚âà Œ∫I(t) and the model
approaches the baseline fa . Thus this model interpolates between the two regimes.
We define the upper threshold of this model as T (t) = Œ±, the point where the prediction
changed by a factor of 2 compared to the limiting factor regime approximation for small T ,
Y (t) ‚âà Œ∫I(t)T (t)/Œ±.

22

Down-saturating testing model.

We investigate one further model that accounts for an in-

creasing ratio Ir /Nr . The idea of this testing model is that a certain fraction of strongly symptomatic patients and very close contacts are always discovered almost independently of the
testing numbers. In our framework this can be formalized by assuming that the distribution
p(r|œÉ = 1) contains a point mass for r = rmax , i.e., P(r = rmax |œÉ = 1) = Œ¥. In addition we
assume that p(r|œÉ = 1) = ŒΩ1 and p(r|I(t), œÉ = 0) = ŒΩ0 as a special case of the limiting factor
testing model. Based on similar calculations as before we obtain
Y (t) = Œ¥I(t) + Œ∫I(t)T (t) = Œ∫I(t)(Œ± + T (t)) = I(t)fd (T (t)).
For a justification of the names of the testing models we refer to the plot in Figure 2A.
We define the lower threshold of this model as T (t) = Œ±, the point where the prediction
changed by a factor of 2 compared to the limiting factor regime approximation for large T ,
Y (t) ‚âà Œ∫I(t)T (t).

Validation of testing models through death predictions
Death statistics of the Covid 19 pandemic are often assumed to be reported more accurately
than the number of infections. Therefore they can be used to check the validity and compare
different testing models. In this section we describe the methodology underlying our validation
approach.
Relating infections and deaths
We modeled the relation between the number of infections I(t) and the number of deaths D(t)
following (13). We assume that the expectation of the death rate D(t) relates to the time series
of daily incidence i(t) through the equation
E(D) = ifr ¬∑ (Œ† ‚àó i)

23

(16)

where Œ† denotes a filter representing the distribution of the time between infection and death,
called onset-to-death distribution, ifr the infection fatality rate and ‚àó the discrete convolution.
We use the parametric model of onset-to-death distribution in days,
Œ†0 = .5 Gamma(k = 4.39, Œ∏ = 1.16) + .5 Gamma(k = 8.46, Œ∏ = 2.22)

(17)

provided by (13) based on the experimental results of (12), and discretize it to obtain one point
per day, using Œ†(t) = P(Œ†0 ‚àà [t ‚àí 0.5, t + 0.5]). We will assume that ifr remains constant in
time but may differ between countries. The actual value is not relevant to our analysis.
Validation of testing models
We can now combine the relation between infections and deaths and the testing model and
assess how well different testing models can explain the observed evolution of cases, deaths,
and tests. Recall that we assume
E(Y (t)) = I(t)f (T (t))

(18)

for some testing model f . We can infer an unbiased estimate of I as
ÀÜ =
I(t)

Y (t)
f (T (t))

(19)

Since our testing model involves the prevalence while the expression for the expected mortality rate involves the incidence we need to connect incidence and prevalence in the SIR model.
In the SIR model the incidence agrees with the gain term i(t) = S(0)Œ≤(t)I(t). Discretization
on a daily level leads to the expression I(t) ‚àí I(t ‚àí 1) ‚âà I 0 (t) = (S(0)Œ≤(t ‚àí 1) ‚àí Œ≥)I(t ‚àí 1)
where Œ≥ is the recovery rate in the SIR model. Combining the last to equations implies
i(t) = I(t) ‚àí (1 ‚àí Œ≥)I(t ‚àí 1).

(20)

The recovery rate Œ≥ in the SIR model corresponds to the inverse of the mean generation interval
which we assume to be 5.0 days based on (27), thus Œ≥ = 0.2 days. Our results are not sensitive

24

to the value of Œ≥ and we can also use the prevalence I as a proxy for the incidence i(t). We use
testing time series T (t) = T C (t) and confirmed cases Y (t) = Y C (t) from some country C to
ÀÜ = Y (t)/fm (T (t)). Then we infer an estimate
estimate infection numbers using (19), i.e., I(t)
C
Dest
(t) ‚àù (Œ† ‚àó iÃÇ)(t) for the expected number of deaths using the relations (16) and (20).

We assess the quality of a testing model by its ability to predict the observed time series of
deaths. Since in most countries the reported number of deaths drops sharply at weekends we
replace the reported number of deaths by a 7 day rolling average DC . We measure the distance
C
by
between DC and Dest



C
‚àÜ(C, fm ) = Var ln(DC (t)) ‚àí ln(Dest
(t))
where the time series is restricted to days with at least 10 observed deaths. We remark that
the variance does not depend on the unspecified constant of proportionality given by if r. We
average this across countries using the expression
‚àÜav (fm ) =

X
1
‚àÜ(C, fm )
.
# countries C Var(ln(DC )) + 1

The normalisation by the variance of ln(DC ) ensures that the results of different countries are
comparable and the error is not dominated by countries with bad data quality.

Optimisation of testing models
Here we describe how the parameters of the testing models are optimized such that the prediction error of equation 21 is minimized.
Our error measure is insensitive to multiplicative factors such that we do not need to optimize the factor Œ∫ contained in all testing models. This allows the testing models to adapt for
different infection fatality rates due to varying age distributions and health systems.
The further parameters involved in the testing model are assumed to be independent of
the country and optimized using 10-fold cross validation and automatic differentiation and the

25

BFGS optimizer using the pyTorch library (14).
We also allow the parameter Œ± of the testing model to be a linear function of a set of n
covariates Xi of the countries, i.e.,
Œ± = Œ≤0 +

n
X

Œ≤i Xi

(21)

i=1

which can be optimized for n + 1 dimensional vector Œ≤.

Estimation of causal effects
Suitable testing model provide estimates for the true dynamics of infection I(t) and therefore
allow to infer changes of Œª(t), which controls the growth or decay of I(t). The growth rate Œª(t)
crucially depends (through the transmission rate Œ≤(t)) on the current social distancing policy
L(t), which affects the contact between individuals in the population. For simplicity we assume
a binary social distancing policy L(t) = H(t ‚àí tL ) where H is the Heaviside function (such
that H(t) = 1 if t ‚â• 0 and H(t) = 0 otherwise) and tL is the time where the lockdown begins.
This results in a step function effect on the growth rate
Œª(t) = Œª0 ‚àí Œ∏0 H(t ‚àí tL ) = Œ≤0 S(0) ‚àí Œ≥ ‚àí Œ∏0 H(t ‚àí tL ) ,
with Œª0 the baseline value of Œª(t) under normal conditions (no social distancing), related to
Œ≤0 the baseline disease transmission rate, and Œ∏0 is the causal effect of social distancing. As a
consequence, the logarithmic number of infected evolves in time as
log I(t) = log I(0) + tŒª0 ‚àí (t ‚àí tL )Œ∏0 H(t ‚àí tL )

(22)

leading to a piecewise linear time course as illustrated on Fig. 1D, where the change in slope
reflects directly the causal effect of social distancing.

26

We now include the testing model relation between I, Y , and T in thea piecewise linear
evolution of log I(t) as in (22) and we obtain
log E[Y (t)] = log I(t) + log f (T (t)) = log I(0) + Œª0 t ‚àí (t ‚àí tL )Œ∏0 H(t ‚àí tL ) + log f (T (t))
(23)
The evolution of log E(Y (t)) is thus guaranteed to reflect the piece-wise linear trajectory of I(t)
only if the correction accounting for varying testing is included in the model.

Fitting data with Poisson regression
Given the log-linear form of the testing models of the theoretical value of Y (t) (based on
equation 2, an appropriate statistical framework for estimating Œª(t) is Poisson regression (28),
which is a particular form of Generalized Linear Model. In this setting, observations of the
number of confirmed cases Yb (t) are assumed Poisson distributed, with expectation parameter
Y (t) = E[Y (t)] modeled with intercept a and slope b as
log E[Y (t)] = a + tb ,

(24)

in the uncorrected case (adapted testing), such that the regression coefficient b, which is the
slope of the curve schematized in Fig. 1D, provides an estimate of Œª(t) on time intervals where
it is assumed constant. The model dependent correction for the varying testing rates can also be
incorporated as in (23) in the Poisson regression as an exposure term, leading to the corrected
model
log E[Y (t)] = a + tb + log f (T (t)) ,

(25)

with f the function associated to the testing model (f is identity for the limiting model, and
constant for the adapted model). These statistical models allow inferring the disease dynamics
from observational data.

27

Data preprocessing
We use the Our World in Data Covid 19 dataset available online at ourworldindata.org and
published in (11). This dataset contains data for over 200 entities and provides various time
resolved data related to Covid 19. Our analysis relies on the number of confirmed cases, testing
information and fatality numbers.
Reporting delays
The available data typically contains a time lag Œ¥ between the date of a test and the date the
result of this test is reported. This implies that the testing models actually relate test statistics
of time t with the prevalence I(t ‚àí Œ¥) at an earlier point. We account for this in the analysis
of causal effects by excluding some days from the regression (see below). In the validation
analysis we assume that for each country the reporting delay for fatalities and tests is similar
such that the offsets cancel. Moreover, this delay is small in regard to the time scale of the death
rate trajectory.
Exclusion-selection of countries for the death prediction
For the model validation based on the death prediction we use all countries for which at least
weekly testing information is available and which had at least 1000 fatalities attributed to SarsCov 2 such that death prediction is meaningful. In addition we removed China from the data
because testing started in a late stage of the epidemics there. This left 66 countries for the data
analysis.
We also investigated the dependence of the testing model on additional country covariates. The covariate data was taken from the DELVE Global COVID-19 Dataset3 (29) and was
originally collected by the World Bank. Data was available for 62 of the previously selected
3

github.com/rs-delve/covid19_datasets

28

countries. We started the time series when at least 20 cases were reported because some of the
testing models notably the limiting factor model become unstable for very small case numbers.
Interpolation of missing data
We base our analysis on reports of daily new tests and confirmed cases. In case daily updates are
missing for n days, we perform linear interpolation of the logarithm of the cumulative number
of test and cases, respectively, and use the daily difference to approximate the daily updates.
In this way, the cumulative number remains consistent with the observations, while the daily
updates are interpolated.
Choice of lockdown dates and country selection
For the analysis of lockdown effects we also relied on the Our World in Data dataset. The
lockdown dates for the spring period was determined based on information reported in the BBC
article Coronavirus: The world in lockdown in maps and charts4 where the earliest date among
‚Äúnational recommendation‚Äù and ‚Äúnational lockdown‚Äù was chosen.
From those countries we selected all countries that had at least 10 cases reported 7 days
before the beginning of the lockdown and at least weekly testing information. The 13 selected
countries and lockdown dates can be found in Table 1.
For the pre-lockdown Poisson regressions we considered the time interval spanning from
the first day with at least 10 cases until 5 days after the onset of the lockdown taking into
account that due to the incubation period and delays in case reporting this time interval captures
infections before the lockdown. For the Poisson regressions during the lockdown we considered
the interval starting 10 days after the lockdown onset and ending when the mobility reduction
was less than 80% of the maximal reduction in mobility as measured by the Google mobility
4

https://www.bbc.com/news/world-52103747

29

reports5 where we used weekly averages of the sum of retail, transit stations, and workplace
indicators.
Many, mostly European, countries ordered a second lockdown in the fall of 2020. As the
measures were installed more gradually the transition between pre-lockdown and lockdown was
less sharp. Therefore we determined the onset of the second lockdown based on the stringency
index from the Oxford COVID-19 Government Response Tracker (OxCGRT) (30) which was
designed to measure the stringency of the governmental responses to the Covid-19 pandemic
on a scale from 0-100. We defined the beginning of the lockdown as the first day where the
stringency index was above 50. The data was taken from the Our World in Data dataset. Using
this definition of the second lockdown 13 countries issued a second lockdown (some countries
were excluded because they never lifted the stringency of their measures below 50 and Thailand
was excluded because there was not enough testing data available for the post lockdown period)
and their lockdown dates can be found in Table 2.
We remark that while the definitions of the two lockdowns do not agree using the stringency
based definition would only change the lockdown dates of the first lockdown by a few days.
For the pre-lockdown regressions for the estimation of causal effects we used the 3 weeks
before the lockdown and for the regressions during lockdown we used data from the 3 weeks
starting 10 days after the onset of the lockdown to again account for reporting delays.
Data selection for the US
We performed a similar analysis for the states of the USA based on data provided by the COVID
Tracking project6 . The lockdown dates for the US states were chosen as the day of the ‚Äôstay at
home order‚Äô. Dates were taken from from Wikipedia7 . There were 30 states that had sufficient
5

available at google.com/covid19/mobility/
available at covidtracking.com
7
available at https://en.wikipedia.org/wiki/U.S._state_and_local_government_
responses_to_the_COVID-19_pandemic
6

30

data for the lockdown analysis. They can be found along with their lockdown dates in Table 3.
For the validation analysis we used the same criteria as above which were satisfied by 40 states.
We did not pursue the addition of covariates for the parametric testing models.

References and notes
1. G. Giordano, et al., Nature Medicine 26, 855 (2020).
2. J. Dehning, et al., Science (2020).
3. P. S. Hart, S. Chinn, S. Soroka, Science Communication 42, 679 (2020).
4. S. Tejedor, L. Cervi, F. Tusa, M. Portales, M. Zabotina, International journal of environmental research and public health 17, 6330 (2020). 32878092[pmid].
5. M. Cinelli, et al., Scientific Reports 10, 16598 (2020).
6. W. O. Kermack, A. G. McKendrick, Proceedings of the Royal Society of London. Series A
138, 55 (1932).
7. W. O. Kermack, A. G. McKendrick, Proceedings of the Royal Society of London. Series A
141, 94 (1933).
8. A. M‚ÄôKendrick, Proceedings of the Edinburgh Mathematical Society 44, 98 (1925).
9. J. Pearl, Causality: Models, Reasoning and Inference (Cambridge University Press, USA,
2009), second edn.
10. J. Peters, D. Janzing, B. SchoÃàlkopf, Elements of Causal Inference - Foundations and Learning Algorithms, Adaptive Computation and Machine Learning Series (The MIT Press,
Cambridge, MA, USA, 2017).

31

11. J. Hasell, et al., Scientific Data 7, 345 (2020).
12. R. Verity, et al., The Lancet infectious diseases (2020).
13. S. Flaxman, et al., Nature 584, 257 (2020).
14. A. Paszke, et al., Advances in Neural Information Processing Systems 32, H. Wallach, et al.,
eds. (Curran Associates, Inc., 2019), pp. 8024‚Äì8035.
15. J. Wallinga, M. Lipsitch, Proceedings of the Royal Society B: Biological Sciences 274, 599
(2007).
16. Y. Liu, A. A. Gayle, A. Wilder-Smith, J. RockloÃàv, Journal of Travel Medicine 27 (2020).
17. H. Salje, et al., Science (2020).
18. N. Imai, et al., Imperial College London (2020).
19. V. Chernozhukov, H. Kasahara, P. Schrimpf, Journal of Econometrics (2020).
20. S. Contreras, J. Dehning, S. B. Mohr, F. P. Spitzner, V. Priesemann, Towards a long-term
control of covid-19 at low case numbers (2020).
21. K. Systrom, T. Vladek, M. Krieger, Rt.live, https://github.com/rtcovidlive/
covid-model (2020).
22. O. Karin, et al., medRxiv (2020).
23. F. Bassi, G. Arbia, P. Falorsi, Science of The Total Environment p. 142799 (2020).
24. A. Rostami, et al., Clinical Microbiology and Infection (2020).
25. P. van den Driessche, Infectious Disease Modelling 2, 288 (2017).

32

26. G. F. Webb, et al., Theory of nonlinear age-dependent population dynamics (CRC Press,
1985).
27. L. Ferretti, et al., Science 368 (2020).
28. R. D. Peng, F. Dominici, T. A. Louis, Journal of the Royal Statistical Society: Series A
(Statistics in Society) 169, 179 (2006).
29. Delve global covid-19 dataset, https://github.com/rs-delve/covid19_
datasets/blob/master/dataset/combined_dataset_latest.csv. Accessed: 01/28/21.
30. T. Hale, et al., Blavatnik School of Government Working Paper (2020).

Acknowledgments
Authors contributions: Conceptualization: M.B., S.B. and B.S.; Methodology: M.B., S.B.
and B.S.; Software: M.B. and S.B.; Validation: M.B. and S.B; Formal analysis: M.B. and S.B.;
Writing - original draft preparation: M.B. and S.B.; Writing - review and editing: M.B., S.B.
and B.S.; Visualization: M.B. and S.B.; Supervision: M.B. and B.S. Competing interests:
All authors declare no competing interests. Data and materials availability: All data will be
available in the manuscript, the Supplementary Materials or online upon acceptance.

33

Supplementary Information for
Assaying Large-scale Testing Models to Interpret COVID-19
Case Numbers.
Michel Besserve, Simon Buchholz and Bernhard SchoÃàlkopf
Correspondence to : michel.besserve@tuebingen.mpg.de
This PDF file includes:
‚Ä¢ Supplementary Figs. 1 to 4
‚Ä¢ Tables S1 to S3

34

Rate of confirmed cases/number of infectious

103

Testing models
Adapted
Limiting
Up-saturating
Down-saturating

B

**

1.0

** p<.005

1.0

**

0.8
0.6

102

**
n. s.

0.4
Linearity range

101

101

104
102
103
Tests/day/106 inhabitants

C

Prediction error (US states)

0.2
Adapted

Limiting

Up-sat.

Down-sat.

Up-saturating testing error

A

104

0.8
0.6
0.4
0.2
0.0
0.0

0.2

0.4
0.6
0.8
Adapted testing error

1.0

Supplementary Figure 1: Testing model validation for US states, related to Fig. 2 (A-C)
Same as Fig 2B-D for the US states dataset, i.e.: (A) Functions associated with different testing
models, with illustrative choice of parameters. (B) State-wise cross-validation prediction error
for death rate using different models linking these quantities to incidence. Significance was
assessed using Wilcoxon signed rank tests. (C) Scatter plot showing the superiority of the
limiting factor testing model, relative to the adapted testing model.

35

Prediction error (world countries)

0.8

Covariates
with covariates
no covariates

0.7
0.6

n. s.

n. s.

Up-saturating

Down-saturating

0.5
0.4
0.3
0.2
0.1
Limiting

Supplementary Figure 2: Comparison of testing models with and without covariates, related to Fig. 2. Country wise cross validation prediction error for the death rate for different
testing models. Blue box-plots indicate regression without covariates. For orange box plots,
the testing models‚Äô parameter was optimized using a linear dependence with respect to the
country‚Äôs Gross Domestic Product (GDP) per capita, population density, and the percentage of
urban population as covariates. Note that both boxplots agree for the case of the limiting testing
model which has no parameters to optimize. Statistical significance was assessed using a paired
Wilcoxon signed rank test (N = 62).

36

Slopes of the testing number
**

growth-rate (/day)

0.3

Pre-lockdown
During lockdown

**

* p<.05
** p<.005

0.2
*
0.1

*

**

n. s.

0.0
First lockdown
Second lockdown
Lockdown

Supplementary Figure 3: Testing statistics, related to Fig. 3. Statistics of the exponential
growth rate of the number of tests estimated by Poisson regression for each country individually,
separately for time periods before and during application of social distancing measures for the
first and second lockdown. Significance was assess using Wilcoxon signed rank tests on the sign
of the median of the regression coefficients or their difference (when above a line connecting
two quantities).

37

A

B

New confirmed cases (1st lockdown)

105
Tests per day and 106 inhabitants

Cases per day and 106 inhabitants

104

New tests (1st lockdown)

103
102
101

104
103
102
101

20

C

10 0
10 20 30
days from lockdown onset

20

D

Exp. growth rates (1st lockdown)
**

Period
Pre-lockdown
During lockdown
**

0.2
0.1

*
n. s.

10 0
10 20 30
days from lockdown onset

40

Estimated 1st lockdown effect
**

0.4

* p<.05
** p<.005

**
0.3
Difference in slopes

0.3
Growth rate (/day)

40

0.0

**

0.2
0.1
0.0

0.1

0.1

Adapted
Up-saturating
Testing model

Adapted

Up-saturating
Testing model

Supplementary Figure 4: Impact of testing assumptions on growth rate and policy evaluation for US states, related to Fig. 3. (A) Number of daily new confirmed cases for each country
of the first lockdown. Blue and orange solid lines represent the average of Poisson regression
models across countries, before and during social distancing, respectively. (B) Same as A for
daily new tests per thousands (right). (C) Statistics of the exponential growth rate of the prevalence estimated by Poisson regression for each country individually, separately for time periods
before and during application of social distancing measures for the first lockdown. Testing is
corrected for according to two testing models: adapted testing (left) and limited testing (right).
(D) Estimate of the effect of social distancing on transmission rate, with or without correction
for testing. Indicated p-values correspond to Wilcoxon signed tests on the sign of the median of
the regression coefficients or their difference (when above a line connecting two quantities).

38

Supplementary Table 1: Lockdown dates and countries selected for the analysis of the first
lockdowns, related to Fig. 3.
Spring lockdown date
Country
Spring lockdown date Country
Austria
2020-03-13 Belgium
2020-03-12
Canada
2020-03-13 Germany
2020-03-18
2020-03-13
Italy
2020-03-12 Malaysia
2020-03-23
Norway
2020-03-12 Pakistan
Switzerland
2020-03-13 Thailand
2020-03-20
United Arab Emirates
2020-03-26 United Kingdom
2020-03-22
United States
2020-03-16

39

Supplementary Table 2: Lockdown dates and countries selected for the analysis of the fall
lockdowns, related to Fig. 3.
Fall lockdown date
Country
Fall lockdown date Country
Austria
2020-10-17 Belgium
2020-10-19
Croatia
2020-12-14 Finland
2020-12-07
2020-10-15
France
2020-10-30 Germany
2020-10-06
Hungary
2020-11-05 Italy
Lithuania
2020-10-28 Luxembourg
2020-10-20
Norway
2020-11-05 Romania
2020-10-20
Switzerland
2020-11-02

40

Supplementary Table 3: Lockdown dates and US states selected for the analysis related to
Fig. 4.
State Lockdown date State Lockdown date
AL
2020-04-04 AZ
2020-03-31
CA
2020-03-19 CO
2020-03-26
2020-04-03
DC
2020-04-01 FL
GA
2020-04-03 IL
2020-03-21
2020-03-23
KS
2020-03-30 LA
MA
2020-03-24 MD
2020-03-30
ME
2020-04-02 MI
2020-03-24
2020-04-06
MN
2020-03-28 MO
2020-03-30
MS
2020-04-03 NC
NH
2020-03-28 NJ
2020-03-21
NV
2020-04-01 NY
2020-03-22
OH
2020-03-24 OK
2020-04-07
PA
2020-04-01 RI
2020-03-28
2020-04-01
SC
2020-04-07 TN
TX
2020-04-02 UT
2020-04-02
VA
2020-03-30 WA
2020-03-23
WI
2020-03-25

41

