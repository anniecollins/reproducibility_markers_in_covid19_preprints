An Environmentally-Adaptive Hawkes Process with
An Application to COVID-19
Tingnan Gong, Yu Chen and Weiping Zhang

arXiv:2101.09942v1 [stat.AP] 25 Jan 2021

Department of Statistics and Finance
University of Science and Technology of China
Hefei, Anhui, P.R. China
Email: cyu@ustc.edu.cn

Abstractâ€”We proposed a new generalized model based on the
classical Hawkes process with environmental multipliers, which
is called an environmentally-adaptive Hawkes (EAH) model.
Compared to the classical self-exciting Hawkes process, the
EAH model exhibits more flexibility in a macro environmentally
temporal sense, and can model more complex processes by
using dynamic branching matrix. We demonstrate the welldefinedness of this EAH model. A more specified version of this
new model is applied to model COVID-19 pandemic data through
an efficient EM-like algorithm. Consequently, the proposed model
consistently outperforms the classical Hawkes process.

I. I NTRODUCTION
The self-exciting point process has been proposed in various
fields such as epidemic forcasting (see [1], [2]). The Hawkes
process is a classical self-exciting point process, in which,
each event i occurs at time ti , and generates new events
with stochastic intensity Ï†(t âˆ’ ti ), where Ï†(t) is a generic
kernel. Thus Hawkes processes prove useful in modeling some
real-world complex systems with clusters (see [3], [4]). The
branching matrix defined in a multivariate Hawkes process
is responsible to describe the complex excitements between
dimensions (nodes) in a network. Particularly, the (i, j) entry
in the branching matrix is non-negative, measuring the excitement from node j to node i. Whereas the branching matrix
is static in a classical Hawkes process, the rigidity arises in a
temporal sense.
Many of current work utilized the Hawkes process to fit the
COVID-19 pandemic (see [5], [6]. [7]). With the self-exciting
property, the Hawkes process is a seemingly proper tool to
fit the COVID-19 spread. However, as shown in Section V,
the self-exciting property tends to build an explosive Hawkes
process and overestimate the deterioration. In many areas of
the real world, indoor public spaces were closed and people
were required to wear a mask. Even many cities were locked
down. Soon the spread of virus would slow down and exhibit
not like a typical Hawkes process anymore. In this paper,
we expect to apply our proposed model to the COVID19 pandemic to capture the time-varying epidemic control,
which is brought by the alertness of the society and the
macro countermove of the local governments. Thus decaying
environmental multipliers are considered when constructing
the new model.
We develop an environmentally-adaptive Hawkes (EAH)
model with dynamic multipliers. The dynamic multiplier is

called the environmental multiplier, which is a time-varying
function. By choosing proper environmental multipliers, the
model exhibits various temporal flexibility. The proposed EAH
model is a novel and sophisticated version of the Hawkes
model. We firstly provides a cluster representation of EAH
model to justify its well-definedness (existence). From the
analysis of the existence, the sufficient condition ensuring
the non-explosiveness of an EAH model is given. Then we
state the uniqueness of the EAH model. Also based on [8],
an EM-like algorithm is developed to efficiently estimates
the parameters in the environmentally-adaptive Hawkes model
with decaying multipliers (EAHDM), a pandemic-specified
version of the EAH model.
The rest of this paper is organized as follows. Section II
introduces the background knowledge on the Hawkes process.
In Section III, we formally construct the EAH model and
clarify its existence and uniqueness. Several properties related
to the probability generation functional (p.g.fl. see [10]) are
given. Also, the multi-dimensional EAH and EAHDM model
are briefly introduced. In Section IV, we develop the EMlike algorithm. In Section V, we demonstrate the proposed
methodology via both simulations and the COVID-19 data.
II. BACKGROUND
An M -dimensional Hawkes process is denoted by H(t) =
(H 1 (t), Â· Â· Â· , H M (t))> , which can be fully characterized by
its intensity Î· = [Î·1 (t), Î·2 (t), . . . , Î·M (t)]> as follows,
Z t
Î·(t) = Âµ +
(A Î¦(t âˆ’ Ï„ )) dH(Ï„ ),
(1)
0

where
represents the Hadamard (elementwise) multiplication and Âµ is the intensity vector of the immigrant process. The
concept of the immigrant process (see [9]) will be further introduced in Section III. A = (Î±ij )M Ã—M is the branching matrix.
[Î¦i,j (t)]M
i,j=1 is the kernel function matrix, or fertility function
matrix, which provides a useful tool to characterize the influence of the history information
and the effect from node

> j to
is the
node i. dH(Ï„ ) = dH 1 (Ï„ ), dH 2 (Ï„ ), . . . , dH M (Ï„ )
Radon-Nykodym differential vector of the Hawkes process,
which is also a counting measure vector. The intensity of
a point process can be intuitively understood as the rate
of the arrivals. From (1), given a fixed timing Ï„ , the intensity of a Hawkes process is stimulated by an increment

A Î¦(t âˆ’ Ï„ )dH(Ï„ ). Now that the rate is increased due to the
new arrival, the next arrival comes sooner in the probability
sense. This is the so-called "self-exciting" property and the
reason that the Hawkes process is commonly used to simulate
the time series with clusters.
The branching matrix A commonly can be considered as a
default setting of the whole network. With the growth of M ,
the Hawkes process can describe rather a complex network in
a space sense. However, in a temporal perspective, a constant
matrix A is too rigid to capture the effects from the changing
factors of the macro outer environment, for example, the
epidemic control policies from local governments. Thus we
develop an environmentally adaptive Hawkes (EAH) model
with a time-varying multiplier A(t).
III. E NVIRONMENTALLY A DAPTIVE H AWKES MODEL
In this section we develop the EAH model along with its
existence, uniqueness and some interesting properties related
to the p.g.fl.. Our theoretical discussion is restrained to onedimension for convenience.
A. Existence and Uniqueness of an EAH Model
Definition 1 (An EAH process). An univariate point process
{N (t), t â‰¥ 0} is an EAH process, if it satisfies
1) N (0) = 0.
2) The intensity Î»(t) is given by the Stieltjes integral
Î»(t) = Âµ + Î±(t) Ã— Ï†(t) âˆ— dN (t),

(2)

where Âµ > 0 and the environmental multiplier Î±(t) â‰¥ 0
, âˆ— means the convolution operation and Ï†(t) â‰¥ 0 is the
kernel function.

size of the first generation which is formed by the direct
descendants of the immigrant. Iteratively, s2 the mean size of
the second generation and so on. The mean P
size of a cluster
âˆ
is the summation of all generations, namely n=0 sn , which
converges with 0 â‰¤ s < 1.
By the same method as in the Hawkes process, we will
construct a cluster process which possesses the intensity (2) to
justify the existence of EAH model. In a cluster representation
of the EAH model, the "identical" property in a Hawkes
process does not exist anymore. The mean size of a direct
descendants process is related to the specific arrival time of the
corresponding parent. Then the mean size of each generation
depends on the arrivals time in the former generation iteratively. Such a high dependence on the history results in huge
trouble in direct calculation of the mean cluster size. Hence
we almost surely bound the mean cluster sizes to ensure the
non-explosiveness, namely that the clusters are almost surely
finite. Denote
Z âˆ
m(u) =
Î±(t)Ï†(t âˆ’ u)dt,
âˆ’âˆ

which represents the mean size of the first generation if the
ancestor of the cluster arrives at u.
Theorem 1 (Existence). Consider the intensity Î»(t) defined
in (2), if there exists an m ( 0 < m < 1) such that m(u) â‰¤ m
for all u > 0, then there exists a non-explosive cluster process
with Î» (t) satisfying
Âµ
a.s..
Î» (t) â‰¤
1âˆ’m
Proof. See Appendix.

In real applications, it is natural to have a beginning point of
In Definition 1, Î±(t) serves as an characterization of the
the process. So we clarify the uniqueness of EAH model with
temporal evolution of the macro outer environment. The kenel
an arbitrarily fixed beginning point, which is straight supported
Ï†(t) is of the similar role as in a Hawkes process. Let
by the first lemma in [9].
Î±(t) = 1, the EAH model reduces to a Hawkes process, which
can be considered as a cluster process defined in Section 3.2 Theorem 2. Given an arbitrarily fixed start time, there exists
in [10]. The process of cluster centers Nc (t), is a Poisson at most one simple point process, whose complete intensity is
process with rate Âµ. The arrivals of Nc (t) are often called given by (2).
immigrants. Each immigrant produces a subsidiary process,
which is also known as a cluster. Actually, in one cluster, B. Other properties
any individual reproduces the next generation, including the
Now we describe the p.g.fl. of the EAH model, based on
immigrant. Thus the cluster is formed by the arrivals of all- which we further derive the distribution of the residual time
generation descendants of an immigrant. For an event arrives at of an EAH model and the length of a particular cluster in an
Ï„ , the process of its direct descendants is constructed as a non- EAH process.
homogenous Poisson process with the intensity Ï†(t âˆ’ Ï„ ). The
Theorem 3. The p.g.fl. of the EAHs has the form
summation of the intensities of the process of cluster centers
Z âˆ

and all clusters gives the intensity of a Hawkes process.
G(z(Â·)) = exp
Âµ [F (z(Â·)|t) âˆ’ 1] dt ,
(3)
Clusters in the Hawkes process are identical processes after
âˆ’âˆ
different temporal translations. Here "identical" means that
each cluster exhibits the same statistical structure leading where F (z(Â·)|t) is the p.g.fl. of a cluster generated by an
to same properties,
for example, the mean size of clusters. immigrant arriving at time t, and including that immigrant.
Râˆ
Define s = 0 Ï†(Ï„ )dÏ„ , which is the mean size of a non- The functional F (z(Â·)|t) satisfies the functional equation
Z âˆ

homogenous Poisson process with intensity Ï†(t), namely the
mean size of the direct descendants of any event, including F (z(Â·)|t) = z(t) exp t [F (z(Â·)|Ï„ ) âˆ’ 1] Î±(Ï„ )Ï†(Ï„ âˆ’ t)dÏ„ .
(4)
the immigrants. Focus on a cluster and s equals to the mean

Proof. See Appendix.
Now we can have an iteration formula of the forward
recurrence time, also known as the residual time of an EAH
model.
Theorem 4. The forward recurrence time, which is observed
from time y, Ly of an EAH model has survivor function
RLy (l) = P(Ly > l) given by

 Z y
[Î³(y, l|t) âˆ’ 1] dt âˆ’ Âµl ,
RL (l) = exp Âµ
âˆ’âˆ

where Î³(y, l|t) satisfies the equation
Î³(y, l|t) =
ï£±
nR
o
y+l
ï£´
ï£² exp y [Î³(y, l|Ï„ ) âˆ’ 1] Î±(Ï„ )Ï†(Ï„ âˆ’ t)dÏ„ , y â‰¥ t;
1,
y â‰¤ t âˆ’ l;
ï£´
ï£³
0,
elsewhere.
Proof. See Appendix.

j

Also, the p.g.fl. of an EAH determines the length of a
cluster, i.e. the time between the immigrant and the last
individual in this cluster. If the immigrant arrives at t, we
denote the length of the cluster as Jt .
Theorem 5. The distribution function DJt (y) = P(Jt â‰¤ y)
of the length of a cluster, whose ancestor arrives at time t,
satisfies, for any y â‰¥ 0,
DJt (y) =
Z

t+y

DJÏ„ (y + t âˆ’ Ï„ )Î±(Ï„ )Ï†(t âˆ’ Ï„ )dÏ„ }.

exp{âˆ’m(t) +

IV. EM- LIKE A LGORITHM
We develop the EM-like algorithm for the EAHDM model
based on the algorithm in [8]. Considering a simple point
process, all arrivals are distinct ordered by {t1 , t2 , . . . , tn }.
The vector {u1 , u2 , . . . , un } with uj âˆˆ {1, 2, . . . , M } represents the corresponding dimensions (nodes) each arrival
belongs
to. Define auxiliary probabilities [pij ]nÃ—n satisfying
P
p
jâ‰¤i ij = 1, âˆ€i âˆˆ {1, 2, . . . , n}.
Similarly to [11], let L(A, d(t), Î²) be the log likelihood of
the multivariate EAH model. By the Jensen inequality in the
concave case, we have


X
Âµui
L(A, d(t), Î²) â‰¥
pii log
pii
ti <t


X X
Aui ,uj
+
pij log
d(ti ) exp{âˆ’Î²ui .uj (ti âˆ’ tj )}
pij
ti <t tj <ti
ï£«
ï£¶
d
X
X Ai,uj d(t)

ï£­Âµi t +
1 âˆ’ exp{âˆ’Î²i,uj (t âˆ’ tj )} ï£¸ .
âˆ’
Î²
i,u
j
t <t
i=1

(5)

t

Proof. See Appendix.

(8)
Denote the right-side term of (8) by L(A, d(t), Î²; p), where
b (k) from
p means the set of {pij }. Given the estimation A
the k-th iteration, we can tighten the lower bound, namely
(k)
L(A, Î²; p), using Lagrange multiplier method to get {pÌ‚ij }.
(k)
Conditioned on {pÌ‚ij }, maximizing L(A, d(t), Î²) w.r.t. A,
b (k+1) .
then we obtain A
ï£±
Âµui
ï£´
,j = i
ï£´
P b(k)
ï£´
ï£´
Âµ
d(t
)
exp{âˆ’Î²
+
A
(t
âˆ’
t
)}
ï£´
u
,u
u
i
u
,u
i
j
i
j
i
i
j
ï£´
ï£²
j<i
(k)
pÌ‚ij =
,
(k)
b
Aui ,uj d(ti ) exp{âˆ’Î²ui ,uj (ti âˆ’ tj )}
ï£´
ï£´
ï£´
,j < i
P b(k)
ï£´
ï£´
ï£´
Aui ,uj d(ti ) exp{âˆ’Î²ui ,uj (ti âˆ’ tj )}
ï£³ Âµui +
j<i

C. Multivariate EAH and EAHDM models
Similarly to the multivariate Hawkes process, we characterize a multivariate EAH model by its intensity defined as
Z t
Î»(t) = Âµ +
Î±(t) Î¦(t âˆ’ Ï„ )dN (Ï„ ), t â‰¥ 0,
(6)
0

where Î±(t) = (Î±ij (t))M Ã—M is the environmental multipliers matrix. And the kernel function matrix, [Î¦i,j (t)]M
i,j=1 is
chosen to be an exponential kernel matrix, namely Î¦i,j (t) =
exp{âˆ’Î²i,j t}. For an EAH model applied on COVID-19, we
reduce our EAH to an EAHDM. Consider an M -dimensional
model,
Z t
Î»(t) = Âµ + d(t)
A Î¦(t âˆ’ Ï„ )dN (Ï„ ), t â‰¥ 0, (7)

b(k+1)
A
u,v

=

d(t)

P

ti <t
ui =u

tj <t
uj =v

P

tj <ti
uj =v

(k)

pÌ‚ij

(1 âˆ’ exp{âˆ’Î²u,v (t âˆ’ tj )})

.

To ease our implementation, we generally discretize the data
by uniform binsize denoted by âˆ†. Also we define l = bt/âˆ†c,
which is the largest integer not over t/âˆ† and represents the
last bin. Denote the sum of arrivals in the i-th bin belonging
to node u by ni,u . In this case, we can still introduce auxiliary
probabilities and derive the corresponding EM-like algorithms.
So the discretized version is
M X
M
X
(k)
ni,u nj,v pÌ‚ij =
u=1 v=1

d(âˆ†i)

0

where A âˆˆ RM Ã—M with all entries being non-negative, and
d(t) : R â†’ R is a non-negative and decreasing function. In
COVID-19 pandemic, the environment turned adverse to the
spread of the virus due to the alertness of the society and the
control of the government. Then this characteristic is revealed
by the user-specified decaying function d(t).

P

Î²u,v

M P
M
P

âˆ’âˆ†Î²u,v (iâˆ’j)
b(k)
ni,u nj,v A
u,v e

u=1 v=1
M
P

ni,u Âµu + d(âˆ†i)

u=1

b(k+1)
A
u,v

M P
M
P P

,
âˆ’âˆ†Î²u,v (iâˆ’j)
b(k)
ni,u nj,v A
u,v e

j<i u=1 v=1

PP
(k)
Î²u,v
ni,u nj,v pÌ‚ij
iâ‰¤l j<i
P
=
.
d(âˆ†l)
nj,v (1 âˆ’ exp{âˆ’âˆ†Î²u,v (l âˆ’ j)})
jâ‰¤l

V. N UMERICAL E XPERIMENTS
In this section, we investigate the performance of our
method via numerical studies. In simulation, we will generate
data from an EAHDM model and estimate A by the EM-like
algorithm. In real data experiments, we will train a Hawkes
process model and an EAHDM model with the COVID-19
pandemic data from Jan. 16 to Feb. 11 in 2020. And we
will exhibit the one-step prediction with the Hawkes process
model and the EAHDM model, which proves that the EAHDM
model outperforms the Hawkes process. Two common cases
exist where the EAHDM model will degenerate. Note that no
exogenous factor steadily infects people. Hence we can assume
that no immigrant process exists in the spread of COVID19 pandemic. Only the several individuals in the beginning
can be acknowledged as immigrants, the confirmed cases
afterwards were all descendants in those clusters generated
from immigrants. So Âµ = 0 in both simulations and real data
experiments.
A. Simulation
In the simulation, a 3-dimension network is constructed.
More specifically, we fix Î² = 0.5 and choose three As in
which A1,2 âˆˆ {1.5, 1.8, 2.0}, A2,1 âˆˆ {1.5, 1.5, 1.5}, A3,2 âˆˆ
{1.5, 1.2, 1.0} and the left entries are all 0. Based on the
same method in [12], we generate the data for 8 days. Since
Âµ = 0, the data on the first day is manually given to trigger
the whole process. Hence three nodes are equally provided
2 arrivals on the first day, on 7 am and 2 pm, respectively.
Then we will descritize the data with binsize âˆ† = 0.1 to
ease the further computation. We estimate A by using EMlike algorithm in Section IV with the known Hawkes skeleton
(see [13]) imbedded. The results are shown in Table I.
TABLE I: Estimates of A.
Simulation
Simulation
Simulation
Simulation
Simulation
Simulation

1
1
2
2
3
3

True Parameter
Estimate
True Parameter
Estimate
True Parameter
Estimate

A1,2
1.500
1.581
1.800
1.725
2.000
1.979

A2,1
1.500
1.500
1.500
1.500
1.500
1.500

A3,2
1.500
1.514
1.200
1.206
1.000
0.971

The EM-like algorithm commonly converges in several
iterations, which is rather efficient. The estimators are accurate
in a mutual relationship sense but not in a absolute sense. In
other words, the ratios among the estimators are robust though
their values are not. Actually whether the estimates are large
or small is determined by the binsize. If the binsize is chosen
small, then estimates turns large. If the bins are crude, then
vice versa. In Table I, we calibrate the estimates through equal
A2,1 , then estimates of A1,2 and A3,2 are also close to the
truth since the mutual relationship is estimated nicely. In real
data application, we calibrate A by minimizing some metric
between the real data and our predictions.
B. COVID-19 data
We now utilize the Hawkes processes and the EAHDM
model to fit the COVID-19 data in China and then make one-

step predictions. Our data is obtained from [14] and we choose
the data source National Health Commission of Chinese. The
period is from Jan. 16 to Feb. 11 in 2020 containing added
confirm cases in four provinces. Those four places are Hubei,
Guangdong, Zhejiang and Henan, whose pandemic were once
the most severe. In many implementation work involved the
Hawkes process, Î² is set manually (for example in [8]). In our
experiments, we let Î² âˆˆ {0.5, 0.1}. In the EAHDM model,
(
1/ max(7, t)2 , 0 â‰¤ t â‰¤ 20
d(t) =
.
1/(t2.4 âˆ’ 926.7), t > 20
The results shown in Figures 1 and 2 indicate that the static
branching matrix A in the Hawkes process makes it hard
to capture the evolution of the environment temporally. Thus
the one-step predictions in the Hawkes process overestimate
the severity after about Feb. 3. In the EAHDM model, the
drawback of the Hawkes process is obviously fixed. Also, as
Î² becomes smaller (from 0.5 to 0.1), the overestimates in the
Hawkes process get worse, while the EAHDM model behaves
more robust. It is interesting that if Î² = 1, the Hawkes process
will ease its overestimates, but still not as good as the EAHDM
model. Additionally, it is not recommended to choose a Î² even
larger than 0.5. Compared to d(t) which reflects the evolution
of outer environment, Î² means the decay rate of the influence
from history events which can be interpreted as the infectivity
of COVID-19 virus. If Î² = 1, then exp{âˆ’Î²t} will be too
small to capture the influence of the history only after 5 days,
which is not reasonable according to our common perception
to the COVID-19 virus.
VI. C ONCLUSION
The Hawkes process is a classical self-exciting process
which is frequently used to model the data with clusters.
Considering the Hawkes process lacks of the flexibility in
a environmentally temporal sense, we develop a novel and
sophisticated EAH model and clarify its existence, uniqueness
and the non-explosive condition. In implementation stage, we
reduced the EAH model to the EAHDM model, which is still
an extension of the Hawkes process. In simulations, the EMlike algorithm requires a few iterations and provides nice estimates of the mutual relationship between nodes in a network.
In the real data experiments, a proper decay function d(t)
displays that the EAHDM outperforms the Hawkes process
when predicting the evolution of the COVID-19 pandemic
in China. Also, the EAHDM model is more robust with the
manually chosen parameter Î² than the Hawkes process.
ACKNOWLEDGMENT
We are indebted to the National Science Foundation of
China (Nos. 71771203, 11671374). We are grateful to Prof.
Yao Xie for helpful discussion.
R EFERENCES
[1] S. Meyer, J. Elias, and M. HÃ¶hle, â€œA spaceâ€“time conditional intensity
model for invasive meningococcal disease occurrence,â€ Biometrics,
vol. 68, no. 2, pp. 607â€“616, 2012.

200
150
100

his_and_est[i, ]

0

Jan 27

Feb 03

Feb 10

Jan 20

Feb 10

Zhejiang
Zhejiang_est

150

200

Henan
Henan_est
his_and_est[i, ]

150

Feb 03

(b)

100

his_and_est[i, ]

Jan 27

time_exp_add1

(a)

100

140

50

5000

Jan 20

time_exp_add1

Feb 03

Feb 10

Feb 10

Jan 27

Feb 03

(g)

Feb 03

Feb 10

Jan 27

100
60

Feb 10

Jan 20

Feb 03

Feb 10

Date

(h)

Fig. 1: One-step estimate on the network formed by Hubei,
Guangdong, Zhejiang and Henan. Î² = 0.5. The black lines
represent the real data and the red dotted lines represent the
one-step predictions. Subfigures (a-d) are from the Hawkes
process. Subfigures (e-h) are from the EAHDM.

Jan 27

Feb 03

Feb 10

Feb 03

Feb 10

Date

(f)

Henan
Henan_est
80
60

Zhejiang
Zhejiang_est

0

0

Jan 20

20

3000

Added confirm cases

Feb 03

40

Added confirm cases

100
60

Added confirm cases

0

Date

Jan 27

(e)

Zhejiang
Zhejiang_est

Feb 10

Guangdong
Guangdong_est

Date

20

80
60
40
20

Jan 27

Jan 20

(f)

0

Jan 20

Hubei
Hubei_est

Date

(e)

Feb 03

(d)

2000

Feb 10

Jan 27

time_exp_add1

0

Jan 20

Date

Henan
Henan_est

Jan 20

0

60

100

Added confirm cases

Guangdong
Guangdong_est

0

Feb 03

Feb 10

(c)

20

Added confirm cases

2000
1000
0

Jan 27

Feb 03

time_exp_add1

(d)

Hubei
Hubei_est

Jan 27

1000

(c)

Jan 20

0

Jan 20

time_exp_add1

100

Jan 27

60

Jan 20

Added confirm cases

Feb 10

20

Feb 03

20

Jan 27

0

0

0

20

60

his_and_est[i, ]

120
80
60
40
20

his_and_est[i, ]

Feb 10

Zhejiang
Zhejiang_est

time_exp_add1

3000

Feb 03

(b)

Henan
Henan_est

Jan 20

Added confirm cases

Jan 27

time_exp_add1

(a)

Added confirm cases

3000

his_and_est[i, ]

Jan 20

100

Feb 10

Guangdong
Guangdong_est

50

Feb 03

time_exp_add1

50

Jan 27

0

0

Jan 20

Hubei
Hubei_est

1000

100

150

Guangdong
Guangdong_est

50

his_and_est[i, ]

3000
2000
1000
0

his_and_est[i, ]

Hubei
Hubei_est

Jan 20

Jan 27
Date

(g)

Feb 03

Feb 10

Jan 20

Jan 27
Date

(h)

Fig. 2: One-step estimate on the network formed by Hubei,
Guangdong, Zhejiang and Henan. Î² = 0.1. The black lines
represent the real data and the red dotted lines represent the
one-step predictions. Subfigures (a-d) are from the Hawkes
process. Subfigures (e-h) are from the EAHDM.

[2] S. Meyer, L. Held et al., â€œPower-law models for infectious disease
spread,â€ Annals of Applied Statistics, vol. 8, no. 3, pp. 1612â€“1639, 2014.
[3] E. Bacry, I. Mastromatteo, and J.-F. Muzy, â€œHawkes processes in finance,â€ Market Microstructure and Liquidity, vol. 1, no. 01, p. 1550005,
2015.
[4] A. G. Hawkes, â€œHawkes processes and their applications to finance: a
review,â€ Quantitative Finance, vol. 18, no. 2, pp. 193â€“198, 2018.
[5] W.-H. Chiang, X. Liu, and G. Mohler, â€œHawkes process modeling
of covid-19 with mobility leading indicators and spatial covariates,â€
medRxiv, 2020.
[6] J. V. Escobar, â€œA hawkes process model for the propagation of covid-19:
Simple analytical results,â€ EPL (Europhysics Letters), vol. 131, no. 6,
p. 68005, 2020.
[7] L. Lesage, â€œA hawkes process to make aware people of the severity of
covid-19 outbreak: application to cases in france,â€ Ph.D. dissertation,
UniversitÃ© de Lorraine; University of Luxembourg, 2020.
[8] S. Li, Y. Xie, M. Farajtabar, A. Verma, and L. Song, â€œDetecting changes
in dynamic events over networks,â€ IEEE Transactions on Signal and
Information Processing over Networks, vol. 3, no. 2, pp. 346â€“359, 2017.
[9] A. G. Hawkes and D. Oakes, â€œA cluster process representation of a selfexciting process,â€ Journal of Applied Probability, pp. 493â€“503, 1974.
[10] D. Vere-Jones, â€œStochastic models for earthquake occurrence,â€ Journal
of the Royal Statistical Society: Series B (Methodological), vol. 32, no. 1,
pp. 1â€“45, 1970.
[11] D. J. Daley and D. Vere-Jones, â€œAn introduction to the theory of point
processes, volume 1: Elementary theory and methods,â€ Verlag New York
Berlin Heidelberg: Springer, 2003.
[12] Y. Ogata, â€œOn lewisâ€™ simulation method for point processes,â€ IEEE
transactions on information theory, vol. 27, no. 1, pp. 23â€“31, 1981.
[13] P. Embrechts and M. Kirchner, â€œHawkes graphs,â€ Theory of Probability
& Its Applications, vol. 62, no. 1, pp. 132â€“156, 2018.
[14] T. Wu, X. Ge, G. Yu, and E. Hu, â€œOpen-source analytics tools for
studying the covid-19 coronavirus outbreak,â€ medRxiv, 2020.
[15] T. E. Harris, â€œThe theory of branching process,â€ 1964.
[16] M. Westcott, â€œOn existence and mixing results for cluster point processes,â€ Journal of the Royal Statistical Society: Series B (Methodological), vol. 33, no. 2, pp. 290â€“300, 1971.

A PPENDIX
Proof of Theorem 1:

Poisson process. In Section 4.1 of [10], we recall the p.g.fl of
non-homogeneous Poisson process as

Z
(Î¾(t) âˆ’ 1)Î±(t)Ï†(t âˆ’ u)dt . (9)
G(Î¾(Â·)|u) = exp
Now we truncate the cluster process at the first generation
(including the first generation). Since p.g.fl. provides sufficient
characterization of a point process, Section 4.2 of [10] indicates that the process of cluster centers with its first generation
descendents is equivalent to a Neyman-Scott cluster process.
Actually,


Z
Î±(t)Ï†(t âˆ’ u)
(Î¾(t) âˆ’ 1)dt .
G(Î¾(Â·)|u) = exp m(u)
m(u)
The cluster size in such a Neyman-Scott process, namely the
size of first generation of a cluster, whose ancestor arrived
at time u, in the formerly constructed process, has a Poisson
distribution with mean m(u). Namely, the size of the first
generation of a cluster whose ancestor arriving at time u obeys
Poi(m(u)).
Now the cluster in the constructed process contains all
generations, by Theorem 5.1 in [15], we can calculate the
upper bound of mean cluster size with probability one as,
âˆ
X
n=0

mn =

1
.
1âˆ’m

Meanwhile, by Theorem 6.1 in [15], when m < 1, the
cluster is a.s. finite. As a result, Corollary 3.2 along with
Theorem 3 in [16] ensures the existence of this non-explosive
cluster process. Now ends the proof.
Proof of Theorem 3
Proof. By the first formula in Section 3.2 of [10], we have
G(z(Â·)) = G0 (F (z(Â·)|t)) ,

Proof. The first step is to construct a cluster process whose
intensity is exactly the form in (2). The process of cluster
centers Nc (t) is set to be a Poisson process of rate Âµ. For
each individual arriving at time Ï„ , the process of the arrivals
of its direct descendants is constructed as a non-homogenous
Poisson process with the intensity Î±(t)Ï†(t âˆ’ Ï„ ).
So far we construct the cluster process we want intuitively.
If the existence of such a cluster process is ensured, based on
the fact that the cluster process is the superposition of every
clusters and the process of cluster centers, it is straightforward
to see the constructed process possesses exactly the intensity
in (2).
So in the second step we try to ensure the existence of
constructed process and control its rate. Now that the process
of cluster centers is a homogenous Poisson process, which is
relatively easy to study with, we focus on the size of each
cluster. From Chapter 1 in [15], particularly Theorem 5.1, we
may firstly bound the size of first generation and the size of
other generations can be controled by a simple iteration.
WLOG we consider a immigrant generated by Nc (Â·) at time
u. As said above, the first generation directly generated by
the immigrant follows a non-stationary Î±(t)Ï†(t âˆ’ u), t > u

where G0 (z(Â·)) is the p.g.fl. of a homogenous Poisson process
with intensity Âµ. By the first formula in Section 4.1 of [10],
G0 (z(Â·)) is rather clear to be
Z âˆ

G0 (z(Â·)) = exp
Âµ(z(t) âˆ’ 1)dt .
âˆ’âˆ

We only need to figure out F (z(Â·)|t). We define Fn (z(Â·)|t)
to be the p.g.fl of the cluster which consists of all births
in all generations up to and including the n-th generation
descendants with the immigrant arriving at t.
Denote H(z(Â·)|t) is the p.g.fl. of a non-homogenous Poisson
process, by which an individual arrives at time t generates its
descendants, in a EAH model. So actually
Z âˆ

(z(Ï„ ) âˆ’ 1)Î±(Ï„ )Ï†(t âˆ’ Ï„ )dÏ„ .
H(z(Â·)|t) = exp
t

Then again, similarly with G(z(Â·)) = G0 (F (z(Â·)|t)), by
the smoothing formula of p.g.fl.,
Fn (z(Â·)|t)
= z(t)H (Fnâˆ’1 (z(Â·)|Ï„ )| t)
Z âˆ

= z(t) exp
(Fnâˆ’1 (z(Â·)|Ï„ ) âˆ’ 1) Î±(Ï„ )Ï†(Ï„ âˆ’ t)dÏ„ .
t

Here F0 (z(Â·)|t) = E(z(t)|t) = z(t) represents the ancestor of
the cluster, which is also the immigrant arriving at time t. Let
n â†’ âˆ and the proof ends.

Then
(Z

âˆ’âˆ
Z y


Âµ [Ï€(y, l, 0|t) âˆ’ 1] dt âˆ’ Âµl .

= exp

Proof. If we take

âˆ’âˆ


z(x) =

Âµ [Ï€(y, l, 0|t) âˆ’ 1] dt

P(Ly > l) = exp

Proof of Theorem 4

)

y+l

y â‰¤xâ‰¤y+l
,
elsewhere

z
1

(10)

We define Î³(y, l|t) = Ï€(y, l, 0|t) and the proof ends.
Proof of Theorem 5

then



R

log(z(u))dNs (u|t)

F (z(Â·)|t) = E e

 R y+l
= E e y zdNs (u|t)


= E z Ns ((y,y+l)|t)



Proof. Let
(11)

say is the p.g.f. for the number of events in the interval (y, y +
l) for a cluster whose originating event occurs at time t. It is
easy to see
ï£±

ï£² E z Ns ((y,y+l)|t) t â‰¤ y
Ï€(y, l, z|t) =
E z Ns ((t,y+l)|t)
y <t<y+l .
ï£³
1
tâ‰¥y+l
Again, based on (4),
Ï€(y, l, z|t) =
ï£±
nR
o
y+l
ï£´
exp
(Ï€
(y,
l,
z|Ï„
)
âˆ’
1)
Î±(Ï„
)Ï†(Ï„
âˆ’
t)dÏ„
tâ‰¤y
ï£´
ï£²
y
1
nR
o tâ‰¥y+l
ï£´
y+l
ï£´
ï£³ z exp
(Ï€ (y, l, z|Ï„ ) âˆ’ 1) Î±(Ï„ )Ï†(Ï„ âˆ’ t)dÏ„
elsewhere
t
(12)
Then
Z âˆ

G(z(Â·)) = exp
Âµ (F (z(Â·)|t) âˆ’ 1) dt
Zâˆ’âˆ

âˆ
= exp
Âµ (Ï€(y, l, z|t) âˆ’ 1) dt
(13)
(Zâˆ’âˆ
)

1
0

xâ‰¤y
.
x>y

Then

Z
F (z(Â·)|t) =E exp

=: Ï€(y, l, z|t),

âˆ


log z(Ï„ )dNs (Ï„ |t)

âˆ’âˆ

=E(0Ns ((y,âˆ)|t) ) = P(Ns ((y, âˆ)|t) = 0).
Also we find that
DJt (y) = P(Jt â‰¤ y) = P(Ns ((t + y, âˆ)|t) = 0).
Based on (4), for y â‰¥ 0,
Z âˆ

DJt (y) = exp
(DJÏ„ (y + t âˆ’ Ï„ ) âˆ’ 1) Î±(Ï„ )Ï†(Ï„ âˆ’ t)dÏ„
 t

Z t+y
= exp âˆ’m(t) +
DJÏ„ (y + t âˆ’ Ï„ )Î±(Ï„ )Ï†(Ï„ âˆ’ t)dÏ„ .

y+l

Âµ (Ï€(y, l, z|t) âˆ’ 1) dt

= exp


z(x) =

âˆ’âˆ

=: Q(y, l, z).
Now we look at the distribution of the residual time of a EAH,
P(Ly > l)
= P(Start observing from y, no events happen in [t, t + l))
= E(0N (y,y+l) )
= Q(y, l, 0)
(Z
)
y+l
= exp
Âµ [Ï€(y, l, 0|t) âˆ’ 1] dt .
âˆ’âˆ

Since
Ï€(y, l, 0|t) =
ï£±
nR
o
y+l
ï£´
tâ‰¤y
ï£² exp y (Ï€ (y, l, 0|Ï„ ) âˆ’ 1) Î±(Ï„ )Ï†(Ï„ âˆ’ t)dÏ„
1
tâ‰¥y+l .
ï£´
ï£³
0
elsewhere
(14)

t

