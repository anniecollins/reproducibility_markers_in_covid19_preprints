Safety-Critical Control of Compartmental Epidemiological Models
with Measurement Delays

arXiv:2009.10262v1 [eess.SY] 22 Sep 2020

TamaÌs G. MolnaÌr1 , Andrew W. Singletary2 , GaÌbor Orosz1,3 and Aaron D. Ames2
Abstractâ€” We introduce a methodology to guarantee safety
against the spread of infectious diseases by viewing epidemiological models as control systems and by considering human
interventions (such as quarantining or social distancing) as control input. We consider a generalized compartmental model that
represents the form of the most popular epidemiological models
and we design safety-critical controllers that formally guarantee
safe evolution with respect to keeping certain populations of
interest under prescribed safe limits. Furthermore, we discuss
how measurement delays originated from incubation period and
testing delays affect safety and how delays can be compensated
via predictor feedback. We demonstrate our results by synthesizing active intervention policies that bound the number
of infections, hospitalizations and deaths for epidemiological
models capturing the spread of COVID-19 in the USA.

I. INTRODUCTION
The rapid spreading of COVID-19 across the world forced
people to change their lives and practice mitigation efforts
at a level never seen before, including social distancing,
mask-wearing, quarantining and stay-at-home orders. These
human actions played a key role in reducing the spreading of
the virus, although such interventions often have economic
consequences, lose of jobs and physiological effects. Therefore, it is important to focus mitigation efforts and determine
when, where and what level of intervention needs to be taken.
This research provides a methodology to determine the
level of active human intervention needed to provide safety
against the spreading of infection while keeping mitigation efforts minimal. We use compartmental epidemiological
models to describe the spreading of the infection [1], [2],
and we view these models as control systems where human
intervention is the control input. Viewing epidemiological
models as control systems has been proposed in the literature
recently [3], [4], [5], and various models with varying
transmission rate [6], [7], [8], [9] have appeared to quantify
the level of human interventions in the case of COVID-19.
In this paper, we build on our recent work [10] and
use a safety-critical control approach to synthesize control
strategies that guide human interventions so that certain
safety criteria (such as keeping infection, hospitalization and
death below given limits) are fulfilled with minimal mitigation efforts. The approach is based on the framework of
1 Department of Mechanical Engineering, University of Michigan,
Ann
Arbor,
MI
48109,
USA
molnart@umich.edu,

orosz@umich.edu
2 Department of Mechanical and Civil Engineering, California Institute
of Technology, Pasadena, CA 91125, USA ames@caltech.edu,

asinglet@caltech.edu
3 Department

of Civil and Environmental Engineering, University of
Michigan, Ann Arbor, MI 48109, USA

Fig. 1. Illustration of the SIR model as control system and its fit to US
COVID-19 data [10]. Model parameters were estimated from compartmental
data (right) by accounting for a measurement delay Ï„ . The transmission rate
and the corresponding control input (left) were fitted to mobility data.

control barrier functions [11], [12] that leverages the theory
of set invariance [13] for dynamical [14], [15] and control
systems [16], [17], [18]. We take into account that data
about the spreading of the infection may involve significant
measurement delays [5], [19], [20], [21] due to the fact that
infected individuals may not show symptoms and get tested
for quite a few days. We use predictor feedback control [22],
[23], [24] to compensate these delays, and we provide safety
guarantees against errors in delay compensation.
The outline of the paper is as follows. Section II introduces a generalized compartmental model, which covers
the class of the most popular epidemiological models. Section III introduces safety critical control without considering
measurement delays, while Sec. IV is dedicated to delay
compensation. Conclusions are drawn in Sec. V.
II. GENERALIZED COMPARTMENTAL MODEL
Compartmental models describe how the size of certain
populations of interest evolve over time. Consider n + m
compartments, given by x âˆˆ Rn+m , which are separated into
two groups: n so-called multiplicative compartments, given
by w âˆˆ Rn , and m outlet compartments, given by z âˆˆ Rm .
The evolution of these compartments over time t can be given
by the following generalized compartmental model:
wÌ‡(t) = f (w(t)) + g(w(t))u(t),
zÌ‡(t) = q(w(t)) + r(z(t)),

(1)

where x = [wT z T ]T , initial conditions are x(0) = x0 , and
f, g : Rn â†’ Rn , q : Rn â†’ Rm and r : Rm â†’ Rm depend
on the choice of the model; see Examples 1, 2 and 3.
In model (1), the multiplicative compartments w are
populations that essentially describe the transmission of
the infection. The transmission can be reduced by active
interventions, whose intensity is quantified by a control
input u âˆˆ U âŠ‚ R. The outlet compartments z, on the other
hand, do not actively govern the transmission, but rather
indicate its effects, as they are driven by the evolution of
the multiplicative compartments.
Example 1. SIR model. One of the most fundamental epidemiological models is the SIR model [25], [26] that consists
of susceptible, S, infected, I, and recovered, R, populations.
The SIR model captures the spread of the infection based on
the interplay between the susceptible and infected populations. Thus, S and I are multiplicative compartments, while
R, that measures the number of recovered (or deceased)
individuals, is an outlet compartment. The model uses three
parameters: the transmission rate Î²0 > 0, the recovery rate
Î³ > 0 and the total population N . Active interventions given
by the control input u âˆˆ [0, 1] allow the population to reduce
the transmission to an effective rate Î² = Î²0 (1 âˆ’ u), where
u = 0 means no intervention and u = 1 means total isolation
of infected individuals. This puts the SIR model with active
intervention to form (1) where

 Î²0

 

SI
S
âˆ’ Î²N0 SI
N
, g(w) =
,
w=
, f (w) = Î²0
I
âˆ’ Î²N0 SI
N SI âˆ’ Î³I
z = R,

q(w) = Î³I,

r(z) = 0.

(2)

Example 2. SEIR model. The SEIR model [27], [28] is
an extension of the SIR model that incorporates an exposed
population E apart from the S, I and R compartments. The
exposed individuals are infected but not yet infectious over a
latency period given by 1/Ïƒ > 0. Since the latency affects the
transmission, E is a multiplicative compartment. The SEIR
model can be described by (1) with
ï£® ï£¹
ï£®
ï£¹
ï£¹
ï£® Î²0
S
âˆ’ Î²N0 SI
N SI
w = ï£°E ï£», f (w) = ï£° Î²N0 SI âˆ’ ÏƒE ï£», g(w) = ï£°âˆ’ Î²N0 SI ï£»,
I
ÏƒE âˆ’ Î³I
0
z = R,

q(w) = Î³I,

r(z) = 0.

(3)

Example 3. SIHRD model. The SIHRD model [10] adds
two more outlet compartments to the SIR model: hospitalized
population H and deceased population D. Their evolution is
captured by three additional parameters: the hospitalization
rate Î» > 0, the recovery rate Î½ > 0 in hospitals and the death
rate Âµ > 0. Equation (1) yields the SIHRD model for

 Î²0

 

SI
S
âˆ’ Î²N0 SI
N
, g(w) =
,
w=
, f (w) = Î²0
I
âˆ’ Î²0 SI
SI âˆ’(Î³ +Î»+Âµ)I
ï£® ï£¹
ï£®N ï£¹
ï£® N ï£¹
H
Î»I
âˆ’Î½H
z=ï£° R ï£», q(w) = ï£°Î³I ï£»,
r(z) = ï£° Î½H ï£».
D
ÂµI
0
(4)

There exist several other compartmental models of
form (1) which involve further compartments, such as the
SIRD [29], SIRT [7], SIXRD [30] or SIDARTHE [1] models.
More complex models can provide higher fidelity, although
they involve more parameters that need to be identified. In
what follows, we show applications of the SIR and SIHRD
models and we discuss the occurrence of time delays related
to incubation and testing. We omit further discussions on
latency, the SEIR model or other more complex models.
Fig. 1 shows the performance of the SIR model in capturing the spread of COVID-19 for the case of US national
data. The parameters Î²0 = 0.33 dayâˆ’1, Î³ = 0.2 dayâˆ’1 and
N = 33 Ã— 106 of the SIR model were fitted following the
algorithm in [10] to the recorded number of confirmed cases
I + R [31] between March 25 and August 9, 2020, while the
control input u(t), that represents the level of quarantining
and social distancing, was identified from mobility data [32]
based on the medium time people spent home. The fitted
control input (blue) follows the trend of the mobility data
(gray) well, especially in March where stay-at-home orders
came into action. While the fit (blue) captures the data about
confirmed cases (gray), the model also has predictive power
(orange); see more details about forecasting in [10].
Note that once an individual gets infected by COVID19, it takes a few days of incubation period to show
symptoms and an additional few days to get tested for the
virus [5], [19], [20], [21]. Therefore, the measured number
of confirmed cases represents a delayed state of the system,
I(t âˆ’ Ï„ ) + R(t âˆ’ Ï„ ), and thus we involved a time delay Ï„
in the model identification process, which was found to be
Ï„ = 11 days by fitting [10]. The delay-free counterpart of
the fit (purple) shows that the measurement delay can lead
to a significant error in identifying the true current level of
infection. The effects of the delay Ï„ on safety-critical control
and its compensation will be discussed in Sec. IV.
III. SAFETY-CRITICAL CONTROL
Formally, safety can be translated into keeping system (1)
within a safe set S âŠ‚ Rn+m that is the 0-superlevel set of a
continuously differentiable function h : Rn+m â†’ R:
S := {x âˆˆ Rn+m : h(x) â‰¥ 0},

(5)

where x = [wT , z T ]T . Function h prescribes the condition
for safety: for example, if one intends to keep the infected
population I under a limit Imax for the SIR, SEIR or SIHRD
models, the safety condition is h(x) = Imax âˆ’ I â‰¥ 0.
To guarantee safety, we design a controller
u(t) = A(x(t))

(6)

that ensures that the set S in (5) is forward invariant under the
dynamics (1), i.e., if x(0) âˆˆ S (h(x(0)) â‰¥ 0), then x(t) âˆˆ S
(h(x(t)) â‰¥ 0) for all t > 0. Below we use the framework of
control barrier functions [11], [12] to synthesize controllers
that are able to keep certain compartments of interest within
prescribed limits. First, we consider safety for multiplicative
compartments, and then for outlet compartments.

A. Safety Guarantees for Multiplicative Compartments
Consider keeping the i-th multiplicative compartment
(1 â‰¤ i â‰¤ n) below a safe limit given by Ci , i.e., we prescribe
h(x) = Ci âˆ’ wi ,

(7)

where Ci is an upper bound for wi . A lower bound could
also be considered similarly, by taking h(x) = wi âˆ’ Ci .
Theorem 1: Consider dynamical system (1), function h
in (7) and the corresponding set S given by (5). The following safety-critical active intervention controller guarantees
that S is forward invariant (safe) under dynamics (1) if
gi (w) 6= 0, âˆ€w âˆˆ Rn :


Ï•i (w(t))
, (8)
u(t) = Ai (x(t)) = âˆ’sign(gi (w(t)))ReLU
|gi (w(t))|
where ReLU(Â·) = max{0, Â·} is the rectified linear unit,
Ï•i (w) = fi (w) âˆ’ Î±(Ci âˆ’ wi )

(9)

and Î± > 0. Furthermore, the controller is optimal in the sense
that it has minimum-norm control input.
Proof. According to [12], the necessary and sufficient condition of forward set invariance is given by1
hÌ‡(x(t)) â‰¥ âˆ’Î±h(x(t)),

(10)

âˆ€t â‰¥ 0, where the derivative is taken along the solution
of (1). If there exists a control input u(t) so that (10)
is satisfied, then h is called a control barrier function.
Substitution of (7) and (1) into (10) gives the safety condition
âˆ’ Ï•i (w(t)) âˆ’ gi (w(t))u(t) â‰¥ 0,

(11)

where Ï•i is given by (9). The control input u(t) must
satisfy (11) for all t â‰¥ 0. To keep control efforts minimal,
one can achieve this by solving the quadratic program:
u(t) = Ai (x(t)) = argmin
uâˆˆU

u2
(12)

s.t. (11).
Based on the KKT conditions [33], the explicit solution is
(
0
if âˆ’ Ï•i (w(t)) â‰¥ 0,
(13)
u(t) = Ai (x(t)) =
Ï•i (w(t))
âˆ’ gi (w(t)) if âˆ’ Ï•i (w(t)) < 0,
if gi (w(t)) 6= 0, which can be simplified to (8).

We remark that if gi (w) = 0, safety can be ensured by the
help of extended control barrier functions as discussed for
the safety guarantees of outlet compartments in Sec. III-B.
For example, to keep the infected population I below the
limit Imax for the SIR model given by (2), one shall prescribe
h(x) = Imax âˆ’ I, and (8) leads to the controller


Î±I (Imax âˆ’ I) + Î³I
.
(14)
AI (x) = ReLU 1 âˆ’
Î²0 SI/N
Fig. 2 shows the dynamics of the closed control loop
for the COVID-19 model fitted in Fig. 1 by prescribing
1 More

precisely, Î± must be chosen as an extended class K function [12],
but we use a constant for simpler discussion and without loss of generality.

Fig. 2. Safety-critical active intervention control of the SIR model fitted in
Fig. 1 to US COVID-19 data. The controller keeps the infected population
under the prescribed limit Imax as opposed to the second wave of infection
that was experienced during the summer of 2020.

Imax = 200, 000 and using Î± = Î³/10. Indeed, the safetycritical controller (red) applied from June 1, 2020 is able
to keep the level of infection under the safe limit (red
dashed), while gradually reducing mitigation efforts to zero.
Meanwhile, the US experienced a second wave of infections
(gray) in the summer of 2020, which was caused by the drop
in mitigation efforts in June (see the blue control input).
B. Safety Guarantees for Outlet Compartments
Now consider the case where the j-th outlet compartment
(1 â‰¤ j â‰¤ m) needs to be kept within the safe limit Cj :
h(x) = Cj âˆ’ zj .

(15)

In the following theorem, we use a dynamic extension of
control barrier functions to guarantee safety.
Theorem 2: Consider dynamical system (1), function h
in (15) and the corresponding set S given by (5). The following safety-critical active intervention controller guarantees
that S is forward invariant (safe) under dynamics (1) if
hÌ‡(x( 0)) + Î±h(x(0)) â‰¥ 0 and if Lg qj (w) 6= 0, âˆ€w âˆˆ Rn :

 e
Ï•j (x(t))
,
u(t) = Aj (x(t)) = âˆ’sign(Lg qj (w(t)))ReLU
|Lg qj (w(t))|
(16)
âˆ‚q
where Lg qj (w) = âˆ‚wj (w)g(w),

âˆ‚qj
âˆ‚rj
(w)f (w) +
(z) q(w) + r(z)
âˆ‚w
âˆ‚z

+ (Î± + Î±e ) qj (w) + rj (z) âˆ’ Î±e Î±(Cj âˆ’ zj ),

Ï•ej (x) =

(17)

and Î± > 0, Î±e > 0. Furthermore, the controller is optimal in
the sense that it has minimum-norm control input.
Proof. We again use (10) as the necessary and sufficient
condition for safety, where the following expression appears:
he (x(t)) := hÌ‡(x(t)) + Î±h(x(t))
= âˆ’(qj (w(t)) + rj (z(t))) + Î±(Cj âˆ’ zj (t)),

(18)

which puts the safety condition into the form he (x(t)) â‰¥ 0,
âˆ€t â‰¥ 0. However, the control input does not explicitly show
up in (18). Still, if there exists a control input that satisfies
hÌ‡e (x(t)) â‰¥ âˆ’Î±e he (x(t)),

(19)

then he is an extended control barrier function [34], [13],
whose 0-superlevel is forward invariant, that is, he (x0 ) â‰¥ 0
implies he (x(t)) â‰¥ 0, âˆ€t > 0. Substitution of (18), (15)
and (1) into (19) gives the extended safety condition
âˆ’ Ï•ej (x(t)) âˆ’ Lg qj (w(t))u(t) â‰¥ 0,

(20)

where Ï•ej is defined by (17). This can be satisfied by a minnorm controller obtained from the quadratic program:
u(t) = Aj (x(t)) = argmin u2
uâˆˆU

s.t. (20).

This assumption often holds for models where compartments need to be upper bounded for safety, e.g., the
assumption holds for keeping E, I, R, H or D below a
safe limit in the SIR, SEIR or SIHRD models. Under this
assumption, one can state the following proposition.
Proposition 3: Consider dynamical system (1) with Assumption 1 and the controllers (8) and (16) that keep individual multiplicative compartments wi , i âˆˆ I âŠ‚ {1, . . . , n}
and outlet compartments zj , j âˆˆ J âŠ‚ {1, . . . , m} safe using
the control barrier functions in (7) and (15). The following
safety-critical active intervention controller guarantees safety
for all compartments at the same time:
u(t) = max {Ai (x(t)), Aj (x(t))} .
iâˆˆI,jâˆˆJ

(21)

The explicit solution of the quadratic program is
(
0
if âˆ’ Ï•ej (x(t)) â‰¥ 0,
(22)
u(t) = Aj (x(t)) =
Ï•ej (x(t))
âˆ’ Lg qj (w(t)) if âˆ’ Ï•ej (x(t)) < 0,
which is equivalent to (16).

As an example of keeping outlet compartments safe,
consider limiting the number of hospitalizations below Hmax
and deaths below Dmax for the SIHRD model given by (4).
By choosing h(x) = Hmax âˆ’ H, one can guarantee safety in
terms of hospitalization based on (16) by the controller:

Î±e Î±H (Hmax âˆ’ H)
AH (x) = ReLU 1 âˆ’ H
Î»Î²0 SI/N

(Î½ âˆ’ Î±H âˆ’ Î±eH )(Î»I âˆ’ Î½H) + (Î³ + Î»+Âµ)Î»I
, (23)
âˆ’
Î»Î²0 SI/N
whereas prescribing h(x) = Dmax âˆ’ D ensures safety by
upper bounding deaths via:

Î±e Î±D (Dmax âˆ’ D)
AD (x) = ReLU 1 âˆ’ D
ÂµÎ²0 SI/N

(Î³ + Î» + Âµ âˆ’ Î±D âˆ’ Î±eD )ÂµI
. (24)
âˆ’
ÂµÎ²0 SI/N

C. Safety Guarantees for a Combination of Compartments
Having synthesized controllers that keep selected compartments safe, let us now guarantee safety for multiple
compartments at the same time: a set of multiplicative compartments I âŠ‚ {1, . . . , n} and a set of outlet compartments
J âŠ‚ {1, . . . , m}. To formulate the safety condition, one
can utilize (11) for any multiplicative compartment i âˆˆ I
and (20) for any outlet compartment j âˆˆ J . Then, one needs
to solve the corresponding quadratic program subject to
all these constraints. In general, the quadratic program can
only be solved numerically and one may need relaxation
terms to satisfy multiple constraints [12]. However, analytical
solutions can be found in some special cases, such as the one
given by the following assumption.
Assumption 1. Assume that the following terms have
the same sign: sign(gi (w(t))) = sign(Lg qj (w(t))) = âˆ’1,
âˆ€i âˆˆ I, âˆ€j âˆˆ J , âˆ€t â‰¥ 0.

(25)

That is, one needs to take the maximum of the individual
control inputs that keep each individual compartment safe.
Proof. If Assumption 1 holds, the safety conditions in (11)
and (20) can be combined into one inequality:


âˆ’Ï•i (w(t)) âˆ’Ï•ej (x(t))
+ u(t) â‰¥ 0. (26)
,
min
iâˆˆI,jâˆˆJ
|gi (w(t))| |Lg qj (w(t))|
Then, one can solve the quadratic program:
u(t) = AIJ (x(t)) = argmin u2
uâˆˆU

(27)

s.t. (26)
in the form:



âˆ’Ï•i (w(t)) âˆ’Ï•ej (x(t))
u(t) = ReLU âˆ’ min
. (28)
,
iâˆˆI,jâˆˆJ |gi (w(t))| |Lg qj (w(t))|
This can be simplified to (25) based on (8) and (16).

Fig. 3 shows the closed loop response of the SIHRD model
given by (4) that was fitted to US COVID-19 data [10].
The data about confirmed cases were scaled by the cube
root of the positivity rate (positive per total tests) to account for the significant under-reporting of cases during
the first wave of the virus (and cube root was applied
to scale less aggressively). Starting from June 1, safetycritical active intervention control is applied to limit both the
hospitalizations below Hmax = 40, 000 and the deaths below
Dmax = 400, 000. Based on (25), we utilize the controller
AHD (x) = max{AH (x), AD (x)} where AH and AD are
given by (23) and (24). The model and controller parameters are Î²0 = 0.53 dayâˆ’1, Î³ = 0.14 dayâˆ’1, Î» = 0.03 dayâˆ’1,
Î½ = 0.14 dayâˆ’1, Âµ = 0.01 dayâˆ’1, N = 15Ã—106, Ï„ = 9 days,
Î±D = Î±eD = Î±H = (Î³ + Î» + Âµ)/10 and Î±eH = Î½/10. Safetycritical control is able to reduce mitigation efforts while
keeping the system below the prescribed hospitalization and
death bounds and preventing a second wave of the virus.
IV. SAFETY UNDER MEASUREMENT DELAYS
Controller (6) in Sec. III is designed based on feeding back
the instantaneous state x(t) of the compartmental model.
However, data about certain compartments is measured with
delay due to the incubation period and testing delays. Thus,

is bounded in the sense that ke(t)kâˆž â‰¤ Îµ for some Îµ â‰¥ 0.
The prediction error leads to an input disturbance
d(t) := A(xp (t)) âˆ’ A(x(t))

(30)

relative to the nominal control input u(t) = A(x(t)), which
yields the closed control loop
wÌ‡(t) = f (w(t)) + g(w(t))(u(t) + d(t)),
zÌ‡(t) = q(w(t)) + r(z(t)).

(31)

Note that for a Lipschitz continuous controller A with
Lipschitz constant c, the input disturbance is upper bounded
by kd(t)kâˆž â‰¤ cke(t)kâˆž â‰¤ cÎµ =: Î´. The following theorem
summarizes how the disturbance affects safety via the notion
of input-to-state safety [35]. For simplicity, we state this
theorem only for the safety of multiplicative compartments.

Fig. 3. The dynamics of the SIHRD model fitted to US COVID-19 data
under the safety-critical active intervention policy that keeps hospitalization
and deaths under the prescribed limits Hmax and Dmax .

the instantaneous state x(t) may not be available for feedback, but the delayed state x(t âˆ’ Ï„ ) with measurement delay
Ï„ shall be used. If one implements A(x(t âˆ’ Ï„ )) instead of
A(x(t)) for active intervention, a significant discrepancy
between the delayed and instantaneous states can endanger safety. For example, the delay was identified to be
Ï„ = 11 days for the US COVID-19 data in Fig. 1, while
the infected population grew from a few thousands to more
than a hundred thousand within 11 days in mid March. This
difference significantly impacts safety-critical control. Thus,
we propose a method to compensate delays via predicting
the instantaneous state from the delayed one and we analyze
how the prediction error affects safety.
A. Safety of Predictor Feedback Control
We use the idea of predictor feedback control [22], [23],
[24] to overcome the effect of delays. Namely, at each
time moment t we use the data that are available up to
time t âˆ’ Ï„ and we calculate a predicted state xp (t) that
approximates the instantaneous state: xp (t) â‰ˆ x(t). Then,
we use the predicted state in the feedback law by applying A(xp (t)) â‰ˆ A(x(t)). If the prediction is perfect (i.e.,
xp (t) = x(t)), safety is guaranteed even in the presence of
delay according to Sec. III. Below we analyze how errors in
the prediction affect safety.
The prediction can be done by any model-based or databased methods; see Example 4 for instance. At this point we
only assume that the prediction error defined by
e(t) := xp (t) âˆ’ x(t)

(29)

Theorem 4: Consider the closed loop dynamical system (31), function h in (7) and the corresponding set S given
by (5). Assume that the nominal controller u(t) guarantees
safety without the input disturbance d(t) by satisfying (11),
while the input disturbance d(t) defined by (30) is bounded
by kd(t)kâˆž â‰¤ Î´. Then, set S is input-to-state safe in the
sense that a larger set Sd âŠ‡ S given by
Sd := {x âˆˆ Rn+m : hd (x) â‰¥ 0}

(32)

is forward invariant (safe) under dynamics (31), where
hd : Rn+m â†’ R is defined by
hd (x) := h(x) +

Î´
kgi (w(t))kâˆž .
Î±

(33)

Proof. Similarly to (10) and (19), the necessary and sufficient condition for the invariance of Sd is given by
hÌ‡d (x(t)) â‰¥ âˆ’Î±hd (x(t)).

(34)

Substituting (33) and taking the derivative along the solution
of (31) yields
âˆ’Ï•i (w(t))âˆ’gi (w(t))(u(t)+d(t))+Î´kgi (w(t))kâˆž â‰¥ 0, (35)
which indeed holds, since (11) and kd(t)kâˆž â‰¤ Î´ hold. 
How much larger set Sd is compared to set S depends on
the size Î´ of the disturbance that is related to the prediction
error Îµ. If the prediction is perfect (xp (t) = x(t)), then
Îµ = 0, Î´ = 0 and Sd recovers S. However, if one implements a delayed state feedback controller without prediction
(xp (t) = x(t âˆ’ Ï„ )), then Îµ and Î´ can be large, while Sd can
be significantly larger than the desired set S.
Example 4. A possible model-based prediction can be done
as follows. At each time moment t, we take the most recent
available measurement x(t âˆ’ Ï„ ) and calculate the predicted
state xp (t) by numerically integrating the ideal delay-free
closed loop over the delay interval Î¸ âˆˆ [t âˆ’ Ï„, t]:
wÌ‡p (Î¸) = f (wp (Î¸)) + g(wp (Î¸))A(xp (Î¸)),
zÌ‡p (Î¸) = q(wp (Î¸)) + r(zp (Î¸)),

(36)

where xp = [wpT zpT ]T and the initial condition for integration is xp (t âˆ’ Ï„ ) = x(t âˆ’ Ï„ ). The results in Figs. 2 and 3

involve this kind of predictor feedback to compensate the delay Ï„ . The simulations were carried out without considering
uncertainties in the delay or other parameters, therefore the
predicted state xp (t) matched the instantaneous state x(t) up
to the numerical accuracy of integration. This allowed us to
guarantee safety even in the presence of a significant delay.
V. CONCLUSIONS
In this paper, we viewed compartmental epidemiological
models as control systems where human actions (such as
quarantining or social distancing) are considered as control
input. By the framework of control barrier functions, we synthesized optimal safety-critical active intervention policies
that formally guarantee safety against the spread of infection
while keeping mitigation efforts minimal. We highlighted
that time delays arising during state measurements can
significantly affect safety-critical control, and we proposed
predictor feedback to compensate the delays while preserving
a certain level of input-to-state safety. We demonstrated our
results on compartmental models fitted to US COVID-19
data, where we synthesized controllers to keep infection,
hospitalization and deaths within prescribed limits. These
controllers can help guide policy makers to decide when and
how much mitigation efforts shall be reduced or increased.
ACKNOWLEDGMENT
The authors would like to thank Franca Hoffmann for
her insights into compartmental epidemiological models and
GaÌbor SteÌpaÌn for discussions regarding non-pharmaceutical
interventions in Europe. This research is supported in part
by the National Science Foundation, CPS Award #1932091.
R EFERENCES
[1] G. Giordano, F. Blanchini, R. Bruno, P. Colaneri, A. Di Filippo,
A. Di Matteo, and M. Colaneri, â€œModelling the COVID-19 epidemic
and implementation of population-wide interventions in Italy,â€ Nature
Medicine, 2020.
[2] A. J. Kucharski, T. W. Russell, C. Diamond, Y. Liu, J. Edmunds,
S. Funk, R. M. Eggo, F. Sun, M. Jit, J. D. Munday et al., â€œEarly
dynamics of transmission and control of COVID-19: a mathematical
modelling study,â€ The Lancet Infectious Diseases, vol. 20, pp. 553â€“
558, 2020.
[3] M. Elhia, M. Rachik, and E. Benlahmar, â€œOptimal control of an SIR
model with delay in state and control variables,â€ ISRN Biomathematics,
vol. 2013, p. 403549, Aug 2013.
[4] L. Bolzoni, E. Bonacini, C. Soresina, and M. Groppi, â€œTime-optimal
control strategies in SIR epidemic models,â€ Mathematical Biosciences,
vol. 292, pp. 86â€“96, Oct 2017.
[5] F. Casella, â€œCan the COVID-19 epidemic be controlled on the basis
of daily test reports?â€ arXiv preprint, p. 2003.06967, 2020.
[6] S. C. Anderson, A. M. Edwards, M. Yerlanov, N. Mulberry, J. Stockdale, S. A. Iyaniwura, R. C. Falcao, M. C. Otterstatter, M. A. Irvine,
N. Z. Janjua, D. Coombs, and C. Colijn, â€œEstimating the impact
of COVID-19 control measures using a Bayesian model of physical
distancing,â€ medRxiv, p. 2020.04.17.20070086, Jan 2020.
[7] R. Dandekar and G. Barbastathis, â€œQuantifying the effect of quarantine control in Covid-19 infectious spread using machine learning,â€
medRxiv, p. 2020.04.03.20052084, 2020.
[8] E. Franco, â€œA feedback SIR (fSIR) model highlights advantages and
limitations of infection-based social distancing,â€ arXiv preprint, p.
2004.13216, 2020.
[9] J. S. Weitz, S. J. Beckett, A. R. Coenen, D. Demory, M. DominguezMirazo, J. Dushoff, C.-Y. Leung, G. Li, A. MaÌ†gaÌ†lie, S. W. Park,
R. Rodriguez-Gonzalez, S. Shivam, and C. Y. Zhao, â€œModeling shield
immunity to reduce COVID-19 epidemic spread,â€ Nature Medicine,
2020.

[10] A. D. Ames, T. G. MolnaÌr, A. W. Singletary, and G. Orosz, â€œSafetycritical control of active interventions for COVID-19 mitigation,â€ IEEE
Access, 2020, under review.
[11] A. D. Ames, J. W. Grizzle, and P. Tabuada, â€œControl barrier function
based quadratic programs with application to adaptive cruise control,â€
in 53rd IEEE Conference on Decision and Control. IEEE, 2014, pp.
6271â€“6278.
[12] A. D. Ames, X. Xu, J. W. Grizzle, and P. Tabuada, â€œControl barrier
function based quadratic programs for safety critical systems,â€ IEEE
Transactions on Automatic Control, vol. 62, no. 8, pp. 3861â€“3876,
2016.
[13] A. D. Ames, S. Coogan, M. Egerstedt, G. Notomista, K. Sreenath,
and P. Tabuada, â€œControl barrier functions: Theory and applications,â€
in 2019 18th European Control Conference (ECC). IEEE, 2019, pp.
3420â€“3431.
[14] H. Brezis, â€œOn a characterization of flow-invariant sets,â€ Communications on Pure and Applied Mathematics, vol. 23, no. 2, pp. 261â€“263,
1970.
[15] R. Abraham, J. E. Marsden, and T. Ratiu, Manifolds, tensor analysis,
and applications. Springer Science & Business Media, 2012, vol. 75.
[16] S. Prajna, â€œBarrier certificates for nonlinear model validation,â€ Automatica, vol. 42, no. 1, pp. 117â€“126, 2006.
[17] J.-P. Aubin, Viability theory. Springer Science & Business Media,
2009.
[18] F. Blanchini and S. Miani, Set-theoretic methods in control. Springer,
2008.
[19] Y. Chen, J. Cheng, Y. Jiang, and K. Liu, â€œA time delay dynamical
model for outbreak of 2019-nCoV and the parameter identication,â€
arXiv preprint, p. 2002.00418, Feb 2020.
[20] S. Pei and J. Shaman, â€œInitial simulation of SARS-CoV2 spread
and intervention effects in the continental US,â€ medRxiv, p.
2020.03.21.20040303, 2020.
[21] P. Boldog, T. Tekeli, Zs. Vizi, A. DeÌnes, F. A. Bartha, and G. RoÌˆst,
â€œRisk assessment of novel coronavirus COVID-19 outbreaks outside
China,â€ Journal of Clinical Medicine, vol. 9, no. 2, p. 571, 2020.
[22] W. Michiels and D. Roose, â€œTime delay compensation in unstable
plants using delayed state feedback,â€ in Proceedings of the IEEE
Conference on Decision and Control, Orlando, FL, USA, 2001.
[23] M. Krstic and N. Bekiaris-Liberis, â€œCompensation of infinitedimensional input dynamics,â€ Annual Reviews in Control, vol. 34,
no. 2, pp. 233â€“244, 2010.
[24] I. Karafyllis and M. Krstic, Predictor feedback for delay systems:
Implementations and approximations. Basel: BirkhaÌˆuser, 2017.
[25] H. W. Hethcote, â€œThe mathematics of infectious diseases,â€ SIAM
review, vol. 42, no. 4, pp. 599â€“653, 2000.
[26] M. Batista, â€œEstimation of the final size of the COVID-19 epidemic,â€
medRxiv, p. 2020.02.16.20023606, 2020.
[27] K. B. Blyuss and Y. N. Kyrychko, â€œEects of latency and age structure on the dynamics and containment of COVID-19,â€ medRxiv, p.
2020.04.25.20079848, Apr 2020.
[28] L. R. Lopez and X. Rodo, â€œA modified SEIR model to predict the
COVID-19 outbreak in Spain and Italy: simulating control scenarios
and multi-scale epidemics,â€ medRxiv, p. 2020.03.27.20045005, Jan
2020.
[29] J. FernaÌndez-Villaverde and C. I. Jones, â€œEstimating and simulating
a SIRD model of COVID-19 for many countries, states, and cities,â€
National Bureau of Economic Research, Working Paper 27128, 2020.
[30] R. Humphries, M. Spillane, K. Mulchrone, S. Wieczorek,
M. Oâ€™Riordain, and P. Hoevel, â€œA metapopulation network model for
the spreading of SARS-CoV-2: Case study for Ireland,â€ medRxiv, p.
2020.06.26.20140590, 2020.
[31] â€œThe COVID Tracking Project,â€ https://covidtracking.com/, 2020,
[Online].
[32] â€œSafeGraph,â€ https://www.safegraph.com, 2020, [Online].
[33] S. Boyd and L. Vandenberghe, Convex Optimization. Cambridge
University Press, 2004.
[34] Q. Nguyen and K. Sreenath, â€œExponential control barrier functions
for enforcing high relative-degree safety-critical constraints,â€ in 2016
American Control Conference (ACC). IEEE, 2016, pp. 322â€“328.
[35] S. Kolathaya and A. D. Ames, â€œInput-to-state safety with control
barrier functions,â€ IEEE Control Systems Letters, vol. 3, no. 1, pp.
108â€“113, 2019.

