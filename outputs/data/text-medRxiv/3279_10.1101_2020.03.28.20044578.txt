medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Government Responses Matter:
Predicting Covid-19 cases in US using an empirical Bayesian time series framework
Ziyue Liu
Indiana University, Indianapolis, IN,USA, ziliu@iu.edu
AND
Wensheng Guo
University of Pennsylvania, Philadelphia, PA, USA, wguo@pennmedicine.upenn.edu
Abstract: Since the Covid-19 outbreak, researchers have been predicting how the epidemic will
evolve, especially the number in each country, through using parametric extrapolations based
on the history. In reality, the epidemic progressing in a particular country depends largely on its
policy responses and interventions. Since the outbreaks in some countries are earlier than
United States, the prediction of US cases can benefit from incorporating the similarity in their
trajectories. We propose an empirical Bayesian time series framework to predict US cases
using different countries as prior reference. The resultant forecast is based on observed US
data and prior information from the reference country while accounting for different population
sizes. When Italy is used as prior in the prediction, which the US data resemble the most, the
cases in the US will exceed 300,000 by the beginning of April unless strong measures are
adopted.

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

When facing an epidemic, people and government of a country may underestimate its
seriousness in the beginning but will eventually step up their responses. Hence the case
numbers tend to increase exponentially in the early stage, while the trends will gradually bend
and plateau. Therefore, similarities in the case number trajectories can be observed in different
countries, though the timing and severity can differ substantially due to different responses.
Figure 1 displays the trajectories of total Covid-19 case numbers for China, S. Korea, Italy,
France, Iran, Germany, Spain and USA using Johns Hopkins data. These countries have more
days from time zero than US, where time zero is defined as first day with 100 or more (100+)
cases as a heuristic but widely used choice1. The curve of South Korea increased rapidly early
on but quickly bended and plateaued, for which S. Koreaâ€™s swift and deterministic policy
responses are credited2. China exhibits similar but later flattening pattern, which agrees with its
missing early intervention window, but later extreme lockdown policy implementation3. On the
other hand, the cases in Italy and France have grown exponentially until recent days, which
have partially been attributed to their late and weak policy responses4. The US trajectory is
almost linear on the logarithm scale. While the US government is catching up with policies such
as work/study from home, social distancing and self-quarantine, the effect has not seen in the
trajectory.
Existing Covid-19 forecasting are extrapolations into the future time5-11. Their validity
relies on the crucial but unrealistic assumption that the future trajectories are completely
determined by the history. This by design cannot incorporate government responses yet to
come. Not surprisingly, these predictions can be off the target. For example, Fanelli and Piazza7
predicted a maximum number of cases in Italy to be 15,000, where the real cases have already
multipled. Batista8 predicted the pandemic should peak around Feb 9th, 2020, but it shows no
sign of slowing down into late-March, 2020. Zheng et al9 predicted about 20,000 cases in South
Korea, which is unlikely to happen given its current flat trend around 9,000. Models used in

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

these forecasting are mainly the susceptible-infected-removed (SIR) models and its variants5-8.
Others include state transition model9, parametric growth curve models such as logistic
curves10, and auto regressive integrated moving average (ARIMA) models11.
Proposed Methods
We propose an empirical Bayesian time series framework to forecast the US trajectory by
utilizing the idea of internal time. Since the virus spread to different countries at different time,
their trajectories are different in calendar time but comparable in internal time. We define time
zero as the first day with 100 or more cases in a given country. We first model the trajectories of
the eight countries by a functional mixed effects model12, where different countries shared a
similar mean trajectory over time, and each country has its own random deviation curve. An
additional scalar fixed effect parameter is incorporated to account for different population sizes
on the natural logarithm scale. The estimated coefficient is 0.34, suggesting while the
population size has some effects on the cases numbers, it is not fully proportion to the
population. Both the population-average curve and random deviation curves are modeled by
cubic splines. The model is then casted into state space model for computational efficiency and
forecasting. The smoothing parameters and the variances are estimated through maximum
likelihood.
Based on the estimated parameters using the eight countries, our next task is forecast
the US cases while incorporate one of the countries as the prior information. This is done
through constructing conditional state space model from the functional mixed effects model
conditional on the observed data of the specified country13. By running the Kalman filter forward
on the conditional state space model with the US time series data and into the future, the results
are the posterior prediction incorporating both the prior information from the specific country and
the observed US data. As the reference country is only specified as the prior, the posterior can
be substantially different from the prior, suggesting strong deviation from the reference country.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

In addition, the observed US data can be substantially different from posterior prediction,
indicating that the US case are following a different trajectory because of different policy
responses. More technical details are given in the Supplement.
Data Analysis
The Johns Hopkins University CSSE data were downloaded from its GitHub repository
(https://github.com/CSSEGISandData/COVID-19). We modeled the natural logarithms of the
case numbers as the outcome. The data were then used for prediction using the proposed
method. After the posterior means and variances were calculated and the 95% prediction
intervals were constructed, they were taken exponential to transform back to the original scale.
The whole data analysis from reading in the data to plotting the results took less than 10
seconds on personal computer with IntelÂ® Coreâ„¢i76600U CPU @ 2.60GHz, 2801Mhz, 2
Cores, 4 Logical Processors.
Results
Results based on US data up to March 26th, 2020 are shown in Figure 2~4. Two important
observations can be made from these figures. There is no apparent slowing down yet for US
trajectory based on either the observed trend or predicted trend. This indicates that US is still in
its exponentially increasing phase in the near future.
Figure 2 displays the results using Italy as prior. It shows that US and Italy have similar
patterns and majority of the observed US data are in the 95% prediction intervals. This suggests
that the trajectory in Italy serves as a good prior for the US prediction. Based on this prediction,
on the next day as March 27th, 2020, US may have as many as 108,595 cases. In about 10
days, the US case number will exceed 300,000 around April 4th, 2020 shall the US policy
responses have similarly effects as Italy.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 3 displays the results using China as prior. It shows that the observed US case
numbers are already higher than the predicted values. Even if the US policy responses have
similar effect as China, US case numbers will exceed 150,000 around April 11th, 2020. The
results using South Korea as prior are displayed in Figure 4. US case numbers are predicted to
exceed 200,000 around April 6th, 2020. Since the observed US data are already well above the
upper bound of the 95% prediction intervals, the data from China and South Korea are not good
priors for the US prediction, suggesting that the situation in the US will be much worse than
those in China and South Korea.

Conclusion
We have proposed a new prediction method for predicting total COVID-19 cases of US by
incorporating the information from other countries. While we demonstrated our method in
predicting US cases, our method can be used for predicting state-by-state data as well as
hospital-by-hospital data. Our prediction intervals are much smaller than most exiting methods
due to the additional information from the reference country. We show that the current trajectory
in US is most similar to that in Italy. The stronger response from Italy has led to slowing down of
the spread in the last few days, while the effect of social distancing in the US has not shown in
the observed data.
It is well-known that there are serious under-reporting or under-detection of cases in
various countries and under-reporting rates may be very different across counties. This can
contribute to substantial differences in the trajectories. With the advance of testing techniques,
more and more people are tested in the US. This may also explain why the reported cases in
the US are substantially higher than other countries in the same stages.
References

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

1. Rattner, N. & Schoen, J. W. These charts show how fast coronavirus cases are
spreading â€“ and what it takes to flatten the curve. CNBC (2020). Available at:
https://www.cnbc.com/2020/03/22/these-charts-show-how-fast-coronavirus-cases-arespreading.html
2. Zastrow, M. South Korea is reporting intimate details of COVID-19 cases: has it helped?
Nature News (2020). Available at: https://www.nature.com/articles/d41586-020-00740-y
3. Cyanoski, D. What Chinaâ€™s coronavirus response can teach the rest of the world? Nature
News (2020). Available at: https://www.nature.com/articles/d41586-020-00741-x
4. Donadio, R. Italyâ€™s coronavirus response is a warning from the future. The Atlantic,
March 8th, 2020. https://www.theatlantic.com/international/archive/2020/03/italycoronavirus-covid19-west-europe-future/607660/
5. Zhang, Y. et al Prediction of the COVID-19 outbreak based on a realistic stochastic
model. Preprint at https://doi.org/10.1101/2020.03.10.20033803
6. Wang, L. et al. An epidemiological forecast model and software assessing interventions
on COVID-19 epidemic in China. Preprint at
https://doi.org/10.1101/2020.02.29.20029421
7. Fanelli, D. & Piazza, F. Analysis and forecast of COVID-19 spreading in China, Italy and
France. Preprint at https://arxiv.org/abs/2003.06031
8. Batista, M. Estimation of the final size of the COVID-19 epidemic. Preprint at
https://doi.org/10.1101/2020.02.16.20023606
9. Zheng, Z., Wu, K., Yao, Z., Zheng, J. & Chen, J. The prediction for development of
COVID-19 in global major epidemic areas through empirical trends in China by utilizing
state transition matrix model. Preprint at https://doi.org/10.1101/2020.03.10.20033670
10. Buizza, R. Probabilistic prediction of COVID-19 infections for China and Italy, using an
ensemble of stochastically-perturbed logistic curves. Preprint at
https://arxiv.org/abs/2003.06418

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

11. Benvenuto, D., Giovanetti, M., Vassalo, L. & Angeletti, Silvia. Application of the ARIMA
model on the COVID-2019 epidemic dataset. Preprint at
https://doi.org/10.1016/j.dib.2020.105340
12. Guo, W. Functional mixed effects models. Biometrics, 58, 121-8 (2002).
13. Guo, W. Dynamic state space models. Journal of Time Series analysis, 24, 149-158
(2003).
14. Durbin, J. & Koopman, S.J. Time Series Analysis by State Space Methods (2nd edn).
Oxford University Press: Oxford, UK. (2012).

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 1. Cases numbers for China, S. Korea, Italy, France, Spain, Germany, Iran, and US on
the natural logarithm scale. For the first seven countries, the raw data are shown as symbols,
the smoothed trends as solid lines, and the 95% confidence intervals in dotted lines. For US,
only the raw data are displayed.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 2. Prediction of the US trajectory using Italy as prior. The horizontal axis is based on US
calendar time. On April 4th, 2020, the mean prediction value exceeds 300,000.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 3. Prediction of the US trajectory using China as prior. The horizontal axis is based on
US calendar time. On April 11th, 2020, the mean prediction value exceeds 150,000.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Figure 4. Prediction of the US trajectory using S. Korea as prior. The horizontal axis is based on
US calendar time. On April 6th, the mean prediction value exceeds 200,000.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Supplement
Functional mixed effects model
Let ğ‘ğ‘–ğ‘— be the number of total COVID-19 cases for the ğ‘– ğ‘¡â„ country on the ğ‘— ğ‘¡â„ day, where day 1 is
defined as the first day with 100 or more cases. We model the natural logarithm of ğ‘ğ‘–ğ‘— , ğ‘¦ğ‘–ğ‘— =
log(ğ‘ğ‘–ğ‘— ), by a functional mixed effects model1 as
1

ğ‘¦ğ‘–ğ‘— = ğ›½ log(ğ‘ğ‘– ) + ğ‘“(ğ‘¡ğ‘— ) + ğ‘”ğ‘– (ğ‘¡ğ‘— ) + ğœ€ğ‘–ğ‘— ,

Where ğ‘ğ‘– is the population size in the unit of millions, ğ›½ is the fixed effect slope for log(ğ‘ğ‘– ), ğ‘“(ğ‘¡ğ‘— )
is the functional fixed effects, ğ‘”ğ‘– (ğ‘¡ğ‘— ) is the functional random effects, and ğœ€ğ‘–ğ‘— ~N(0, ğœğ‘’2 ) is the
error term. We model ğ‘“(ğ‘¡ğ‘— ) by a cubic smoothing spline with the state space representation as

(

2

ğ‘“(ğ‘¡ğ‘— )

ğ‘“(ğ‘¡ğ‘—âˆ’1 )
) = ğ»ğ‘“ (
) + ğœ¼ğ‘— ,
ğ‘“â€²(ğ‘¡ğ‘— )
ğ‘“â€²(ğ‘¡ğ‘—âˆ’1 )

1 ğ›¿ğ‘¡
)
where ğ‘“â€²(ğ‘¡ğ‘— ) is the first derivative with respect to time. The state transition matrix ğ»ğ‘“ = (
0 1
with ğ›¿ğ‘¡ is the time interval between two points with the overall time range scaled to [0,1]. The
ğ›¿ğ‘¡ 3 /3 ğ›¿ğ‘¡ 2 /2
) and ğœ†ğ‘“ is the smoothing
state innovation vector ğœ¼ğ‘— ~N(ğŸ, Î£ğ‘“ ), with Î£ğ‘“ = ğœ†ğ‘“âˆ’1 ( 2
ğ›¿ğ‘¡ /2
ğ›¿ğ‘¡
parameter. The state vector (

ğ‘“(ğ‘¡ğ‘— )

ğ‘“(0)
) ~N(ğŸ, ğœ…ğ¼) with ğœ… â†’ âˆ
) is initialized at time zero as (
ğ‘“â€²(0)
ğ‘“â€²(ğ‘¡ğ‘— )

and ğ¼ is the identity matrix. We model ğ‘”ğ‘– (ğ‘¡ğ‘— ) similarly but using a sine function in the ğ‘Š0 space
with the state space representation2 as

(

3

ğ‘”ğ‘– (ğ‘¡ğ‘— )

ğ‘”ğ‘– (ğ‘¡ğ‘—âˆ’1 )
) = ğ»ğ‘” (
) + ğƒğ‘–ğ‘—
ğ‘”â€²ğ‘– (ğ‘¡ğ‘— )
ğ‘”â€²ğ‘– (ğ‘¡ğ‘—âˆ’1 )

with time rescaled to [0, 0.5]. The state transition matrix ğ»ğ‘” = (
The state innovation vector ğƒğ‘–ğ‘— ~ğ‘µ(ğŸ, Î£ğ‘” ), with

cos(2ğœ‹ğ›¿ğ‘¡)
âˆ’2ğœ‹ sin(2ğœ‹ğ›¿ğ‘¡)

1
sin(2ğœ‹ğ›¿ğ‘¡)
2ğœ‹
).

cos(2ğœ‹ğ›¿ğ‘¡)

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

1
1
1
(1 âˆ’ cos(4ğœ‹ğ›¿ğ‘¡))
ğ›¿ğ‘¡ âˆ’
sin(4ğœ‹ğ›¿ğ‘¡)
2
2
32ğœ‹
16ğœ‹ 2
Î£ğ‘” = ğœ†ğ‘”âˆ’1 (8ğœ‹
),
1
1
ğ›¿ğ‘¡
(1 âˆ’ cos(4ğœ‹ğ›¿ğ‘¡))
sin(4ğœ‹ğ›¿ğ‘¡) +
16ğœ‹ 2
8ğœ‹
2

and ğœ†ğ‘” is the smoothing parameter. The state vector (
ğ‘” (0)
ğœ2
) ~N (ğŸ, ( 1
( ğ‘–
ğ‘”â€²ğ‘– (0)
0

4

ğ‘”ğ‘– (ğ‘¡ğ‘— )

) is initialized at time zero as
ğ‘”â€²ğ‘– (ğ‘¡ğ‘— )

0
) ).
ğœ22

Parameter estimation.
Data from eight countries (China, S. Korea, Italy, France, Iran, Germany, Spain and USA) were
used. Let ğ‘›ğ‘– denote the number of observations for subject ğ‘– = 1, â€¦ , ğ‘˜, ğ’šğ‘– the corresponding
observed data vector, ğ’•ğ‘– the time vector, ğ’‡(ğ’•ğ‘– ) the vector of fixed functional effects evaluated at
ğ’•ğ‘– , ğ’ˆğ‘– (ğ’•ğ‘– ) the functional random effect, ğ‘“"(ğ‘¡) and ğ‘”"ğ‘– (ğ‘¡) the second derivatives with respect to
time, and ğ’š the overall observed data vector. The following penalized log-likelihood3 was
maximized to estimate the parameter vector ğœ½ = (ğ›½, ğœ†ğ‘“ , ğœ†ğ‘” , ğœ12 , ğœ22 , ğœğ‘’2 )
ğ‘˜

ğ‘™(ğœ½|ğ’š) = âˆ‘

âˆ’
ğ‘–=1

1
2
(ğ’šğ‘– âˆ’ ğ›½ log(ğ‘ğ‘– ) âˆ’ ğ’‡(ğ’•ğ‘– ) âˆ’ ğ’ˆğ‘– (ğ’•ğ‘– )) âˆ’ ğœ†ğ‘“ âˆ« ğ‘“"(ğ‘¢)ğ‘‘ğ‘¢
2
2ğœğ‘’

5

ğ‘˜

âˆ’ ğœ†ğ‘” âˆ‘

âˆ« ğ‘”"(ğ‘¢)ğ‘‘ğ‘¢ .
ğ‘–=1

Ì‚ = (0.34,306.69,0.09,1.40,5.81, 0.05). We
The maximum likelihood parameter estimates were ğœ½
adopt an empirical Bayes approach such that these parameters are treated as known in the
following steps.
Construction of the conditional SSM.
For the ğ‘– ğ‘¡â„ reference country, the conditional SSM was constructed on the state vectors
ğ‘‡

dimension of six as ğ’™ğ‘¡ğ‘— = (ğ‘“(ğ‘¡ğ‘— ) ğ‘“â€²(ğ‘¡ğ‘— ) ğ‘”ğ‘– (ğ‘¡ğ‘— ) ğ‘”â€²ğ‘– (ğ‘¡ğ‘— ) ğ‘”ğ‘ˆğ‘† (ğ‘¡ğ‘— ) ğ‘”â€²ğ‘ˆğ‘† (ğ‘¡ğ‘— )) , where subscript
â€˜USâ€™ denote US-specific component. The working data are ğ‘¦Ìƒğ‘–ğ‘— = ğ‘¦ğ‘–ğ‘— âˆ’ ğ›½Ì‚ log(ğ‘ğ‘– ). The observation

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

matrix is ğ¹ = (1 0

1 0 0

0), the state transition matrix is ğ» = block diagonal (ğ»ğ‘“ , ğ»ğ‘” , ğ»ğ‘” ),
ğ‘‡

the state innovation vector ğ•ğ‘— = ((ğœ¼ğ‘— )

ğ‘‡

(ğƒğ‘–ğ‘— )

ğ‘‡ ğ‘‡

(ğƒğ‘ˆğ‘†,ğ‘— ) ) distributed as ğ•ğ‘— ~N(ğŸ, Î£ğ‘— ) where

Î£ğ‘— = block diagonal (Î£ğ‘“ , Î£ğ‘” , Î£ğ‘” ). The working SSM is
ğ‘¦Ìƒğ‘–ğ‘— = ğ¹ğ’™ğ‘¡ğ‘— + ğœ€ğ‘–ğ‘— ,
ğ’™ğ‘¡ğ‘— = ğ»ğ’™ğ‘¡ğ‘—âˆ’1 + ğ•ğ‘— .

6

Let ğ’(âˆ™) denote the mean and ğ‘Š(âˆ™) the variance of ğ’™ğ‘¡ğ‘— . The conditional SSM was constructed in
three steps using the dynamic state space models4.
Step 1. The forward filtering: for ğ‘— = 1, â€¦ , ğ‘›ğ‘–
ğ’(ğ‘—|ğ‘— âˆ’ 1) = ğ»ğ’(ğ‘— âˆ’ 1|ğ‘— âˆ’ 1),
ğ‘Š(ğ‘—|ğ‘— âˆ’ 1) = ğ»ğ‘Š(ğ‘— âˆ’ 1|ğ‘— âˆ’ 1)ğ» ğ‘‡ + Î£ğ‘— ,
ğ‘’ğ‘— = ğ‘¦Ìƒğ‘–ğ‘— âˆ’ ğ¹ğ’(ğ‘—|ğ‘— âˆ’ 1),
ğ¾ğ‘— = ğ‘Š(ğ‘—|ğ‘— âˆ’ 1)ğ¹ ğ‘‡ ,
ğ¾ğ‘— ğ‘’ğ‘—
ğ’(ğ‘—|ğ‘—) = ğ’(ğ‘—|ğ‘— âˆ’ 1) +
,
(ğ¹ğ‘Š(ğ‘—|ğ‘— âˆ’ 1)ğ¹ ğ‘‡ + ğœğ‘’2 )
ğ¾ğ‘— ğ¾ğ‘—ğ‘‡
ğ‘Š(ğ‘—|ğ‘—) = ğ‘Š(ğ‘—|ğ‘— âˆ’ 1) âˆ’
.
(ğ¹ğ‘Š(ğ‘—|ğ‘— âˆ’ 1)ğ¹ ğ‘‡ + ğœğ‘’2 )

7

Step 2. The backward smoothing: at ğ‘— = ğ‘›ğ‘– let ğ’(ğ‘—|ğ‘›ğ‘– ) = ğ’(ğ‘›ğ‘– |ğ‘›ğ‘– ) and ğ‘Š(ğ‘—|ğ‘›ğ‘– ) = ğ‘Š(ğ‘›ğ‘– |ğ‘›ğ‘– ), for
ğ‘— = ğ‘›ğ‘– âˆ’ 1, â€¦ ,0
ğ¶ğ‘— = ğ‘Š(ğ‘—|ğ‘—)ğ» ğ‘‡ {ğ‘Š(ğ‘— + 1|ğ‘—)}âˆ’1 ,
ğ’(ğ‘—|ğ‘›ğ‘– ) = ğ’(ğ‘—|ğ‘—) + ğ¶ğ‘— {ğ’(ğ‘— + 1|ğ‘›ğ‘– ) âˆ’ ğ’(ğ‘— + 1|ğ‘—)},
ğ‘Š(ğ‘—|ğ‘›ğ‘– ) = ğ‘Š(ğ‘—|ğ‘—) + ğ¶ğ‘— {ğ‘Š(ğ‘— + 1|ğ‘›ğ‘– ) âˆ’ ğ‘Š(ğ‘— + 1|ğ‘—)}ğ¶ğ‘—ğ‘‡ .

8

Ìƒ0 ~N(ğ’(0|ğ‘›ğ‘– ), ğ‘Š(0|ğ‘›ğ‘– )), for ğ‘— = 1, â€¦ , ğ‘›ğ‘–
Step 3. Construction step: let ğ’™
Ìƒğ‘— = ğ‘Š(ğ‘—|ğ‘›ğ‘– )ğ¶ğ‘—ğ‘‡ {ğ‘Š(ğ‘— âˆ’ 1|ğ‘›ğ‘– )}âˆ’1 ,
ğ»
Ìƒğ‘— ğ’(ğ‘— âˆ’ 1|ğ‘›ğ‘– ),
Ìƒ ğ‘— = ğ’(ğ‘—|ğ‘›ğ‘– ) âˆ’ ğ»
ğ

9

Ìƒğ‘— ğ‘Š(ğ‘— âˆ’ 1|ğ‘›ğ‘– )ğ»
Ìƒğ‘—ğ‘‡ .
Î£Ìƒğ‘— = ğ‘Š(ğ‘—|ğ‘›ğ‘– ) âˆ’ ğ»
Ìƒğ‘— is the state transition matrix, ğ
Ìƒ ğ‘— is the mean vector and Î£Ìƒğ‘— is the variance matrix of the
where ğ»
state innovations.

medRxiv preprint doi: https://doi.org/10.1101/2020.03.28.20044578; this version posted March 30, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
All rights reserved. No reuse allowed without permission.

Predict US trajectory.
The US trajectory was predicted by running the ğ‘›ğ‘ˆğ‘† observations ğ‘¦Ìƒğ‘ˆğ‘†,ğ‘— = ğ‘¦ğ‘ˆğ‘†,ğ‘— âˆ’ ğ›½Ì‚ log(ğ‘ğ‘ˆğ‘† )
through the conditional SSM constructed above with an observation matrix ğ¹ =
(1 0 0 0

1 0). For ğ‘— = 1, â€¦ , ğ‘›ğ‘ˆğ‘† , the first two equations in (7) generated the one-step

ahead prediction, while the last two equations generate the filtered values. Further running the
model for ğ‘— = ğ‘›ğ‘ˆğ‘† + 1, â€¦ , ğ‘›ğ‘– generated predictions into the future time for US. ğ›½Ì‚ log(ğ‘ğ‘ˆğ‘† ) was
then added back to recover the effects of population size.
References for the supplement
1. Guo, W. Functional mixed effects models. Biometrics, 58, 121-8. (2002).
2. Qin, L. Functional models using smoothing splines, a state space approach. Dissertation.
3. Wahba, G. A comparison of GCV and GML for choosing the smoothing parameter in the
generalized spline smoothing problem. The Annals of Statistics, 13, 1378-1402. (1985).
4. Guo, W. Dynamic state space models. Journal of Time Series analysis, 24, 149-158. (2003).

