medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

Estimating the probability of New Zealand regions being
free from COVID-19 using a stochastic SEIR model
Rafal Bogacz
MRC Brain Network Dynamics Unit, University of Oxford, UK
April 20, 2020
Abstract
This report describes a method for estimating the probability that there are no
infected or pre-symptomatic individuals in a populations on a basis of historical data
describing the number of cases in consecutive days. The method involves fitting a
stochastic version of Susceptible Exposed Infected Recovered model, and using the
model to calculate the probability that the number of both exposed and infected individuals is equal to 0. The model is used to predict the current probabilities for all
District Health Boards in New Zealand. These probabilities are highly correlated with
the number of days with no new cases of COVID-19.

Introduction
As the number of new cases of COVID-19 declines in New Zealand, the government is faced
with a decision when to reduce the restrictions and release the country or its parts from lockdown. To assist in such a decision, it may be helpful to know the estimate for a probability
of a particular region being free of COVID-19. This report presents a method for estimating
such a probability on the basis of a simple model and presents results for individual District
Health Boards (DHB) in New Zealand.
A simple model is employed which makes several simplifying assumptions. Although
these assumptions may not be satisfied, they make the model mathematically tractable,
and thus allows estimation of its parameters. In particular, the model makes the following
assumptions.
â€¢ Since the Ministry of Health reports daily numbers of new cases in each DHB, the
model treats each DHB as a separate population, thus assuming that individuals do
not move between DHB (following government instructions not to travel).
â€¢ The model assumes that the behaviour of people is the same in the whole New Zealand
and throughout the analysed period. Thus a single set of model parameters is fit to
data from 25 March 2020 (when the lockdown was introduced in New Zealand) to 18
April 2020.
1

NOTE: This preprint reports new research that has not been certified by peer review and should not be used to guide clinical practice.

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

â€¢ Since the number of infected individuals in New Zealand is a small fraction of the entire
population, the model assumes that the number of susceptible individuals is constant
within the analysed period.
â€¢ The model assumes that infected individuals are eventually identified, and from this
time, become fully isolated and no longer infect others.
â€¢ Since the incubation period of COVID-19 is around 5 days [1], the individuals who
come in contact with the virus first enter a presymptomatic phase lasting on average
5 days to which we refer as an â€exposed stateâ€, and only then became infectious.
Given the above assumptions the results of the analysis need to be treated with caution.
Nevertheless, it us hoped the the presented method may be also refined for more realistic
set of assumptions.

Methods
Description of the model
We considered a stochastic version of Susceptible Exposed Infected Recovered (SEIR) model
[2]. It assumes that each individual can be in one of 4 states, and move between as illustrated
in Figure 1A. We denote by Et and It the number of presymptomatic and infectious people
on day t, and by âˆ†Et and âˆ†It the number of people becoming presymptomatic or infectious.
We do not have data on these variables, so we assume they are hidden to us and we will infer
their values. On the other hand, we denote by âˆ†Rt , the number of people being reported as
a new case on day t, and we assume that this observed number corresponds to the amount of
people moving to state R where they no longer infect others (as they become fully isolated).
Thus in the presented model the cases reported correspond to individuals moving to state R
rather than I as typically assumed, because we assume that the individuals are more likely to
infect others when they are unaware that they have COVID-19, rather than after diagnosis
when they become particularly careful. Indeed, James et al. recently wrote that the control
measures that specifically target confirmed cases, such as isolation, â€could be modelled by a
larger reduction in transmission rates for confirmed casesâ€ [3]. Here we for simplicity assume
that this transmission rate is reduced to 0.
The changes in model variables over time are given by:
Et = Etâˆ’1 + âˆ†Et âˆ’ âˆ†It

(1)

It = Itâˆ’1 + âˆ†It âˆ’ âˆ†Rt

(2)

The model assumes that every day each infectious individual can infect another person
with probability Î². Hence the number of people becoming presymtomatic is a random
variable with a binomial distribution B:
âˆ†Et âˆ¼ B(Itâˆ’1 , Î²)
2

(3)

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

ğµ ğ¼, ğ›½

ğ¸

ğµ ğ¸, ğœ

ğ¼

ğ¸ğ‘¡âˆ’1

ğ¸ğ‘¡

ğµ ğ¼, ğ›¾

ğ‘…

ğ¼ğ‘¡âˆ’1

ğ¼ğ‘¡

observed

ğ‘†

B
hidden

A

âˆ†ğ‘…ğ‘¡

Figure 1: Model. A) Structure of SEIR model. Circles denote compartments, while arrows
denote the movement of individuals between compartments, and the labels above arrows
indicate the distributions of the number of people moving per day. B) Probabilistic model.
Circles denote random variables, while arrows denote dependencies among them.
Additionally, we assume that presymptomatic and infectious people progress to the next
state in Figure 1A (i.e. infectious and reported) with probabilities Ïƒ and Î³ respectively:
âˆ†It âˆ¼ B(Etâˆ’1 , Ïƒ)

(4)

âˆ†Rt âˆ¼ B(Itâˆ’1 , Î³)

(5)

Estimating the probability of being virus free
We wish to compute a probability distribution of variables Et and It given data on the
number of reported cases upto day t, which we denote by âˆ†R1:t . According to the definition
of conditional probability:
P (Et , It |âˆ†R1:t ) =

P (Et , It , âˆ†R1:t )
P (âˆ†R1:t ))

(6)

X

P (Et , It , âˆ†R1:t )

(7)

where
P (âˆ†R1:t )) =

Et ,It

To compute P (Et , It , âˆ†R1:t ) we take advantage of the fact that the dependencies between
variables in the model (Figure 1B) have a similar structure as in a hidden Markov model, so
this probability can be computed recursively using an algorithm analogous to the forward
algorithm. Thus this probability can be decomposed into a sum of probabilities of disjoint
events:
X
P (Et , It , âˆ†R1:t ) =
P (Et , It , âˆ†Rt , Etâˆ’1 , Itâˆ’1 , âˆ†R1:tâˆ’1 )
(8)
Etâˆ’1 ,Itâˆ’1

3

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

Using the definition of a conditional probability, the probability on the right hand side
of the above equation can be written as a chain of conditional probabilities:
X

P (Et , It , âˆ†R1:t ) =

P (Et , It |âˆ†Rt , Etâˆ’1 , Itâˆ’1 , âˆ†R1:tâˆ’1 )

(9)

Etâˆ’1 ,Itâˆ’1

P (âˆ†Rt |Etâˆ’1 , Itâˆ’1 , âˆ†R1:tâˆ’1 )
P (Etâˆ’1 , Itâˆ’1 , âˆ†R1:tâˆ’1 )

(10)
(11)

Noting that the variables depend only on subset of variables as illustrated in Figure 1B,
the above expression can be simplified to:
X

P (Et , It , âˆ†R1:t ) =

P (Et , It |âˆ†Rt , Etâˆ’1 , Itâˆ’1 )

(12)

P (âˆ†Rt |Itâˆ’1 )
P (Etâˆ’1 , Itâˆ’1 , âˆ†R1:tâˆ’1 )

(13)
(14)

Etâˆ’1 ,Itâˆ’1

To compute the term on the right hand side of Equation 12, we note that Et and It are
determined by changes in these variables (Equations 1-2). To find how âˆ†Et is related with
other variables, we can add Equations 1 and 2, and we get:
âˆ†Et = Et + It + âˆ†Rt âˆ’ Etâˆ’1 âˆ’ Itâˆ’1

(15)

Using Equations 15, 2-5 we obtain:

P (Et , It , âˆ†R1:t ) =

X

P (B(Itâˆ’1 , Î²) = Et + It + âˆ†Rt âˆ’ Etâˆ’1 âˆ’ Itâˆ’1 )

(16)

P (B(Etâˆ’1 , Ïƒ) = It + âˆ†Rt âˆ’ Itâˆ’1 )
P (B(Itâˆ’1 , Î³) = âˆ†Rt )
P (Etâˆ’1 , Itâˆ’1 , âˆ†R1:tâˆ’1 )

(17)
(18)
(19)

Etâˆ’1 ,Itâˆ’1

The above formula allows recursively computing P (Et , It , âˆ†R1:t ) from the corresponding
probability on the previous day. In the presented analyses these probabilities were computed
for the values of Et and It from 0 to n, and in the first step we used uninformative flat
1
prior P (E0 , I0 ) = (n+1)
Once the joint probability P (Et , It , âˆ†R1:t ) is computed for the
2.
last available day, we compute the posterior probability from Equation 6, and report the
probability of the population being virus free P (Et = 0, It = 0|âˆ†R1:t ).

Estimating model parameters
To perform the calculation in the previous section, the values of parameters Î², Ïƒ and Î³ need
to be known. We set Ïƒ = 0.2 since the average incubation period of COVID-19 is around 5
days. We assume that Î² and Î³ are the same for the whole New Zealand. To estimate Î² and Î³,
4

0.4

0.4

0.2

0

0.6

-

0.6

Estimated

0.6

Estimated

Estimated

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

0.2

0.2

0.4

0.6

0.2

0

0
0

0.4

0

True

0.2

0.4

True

0.6

0

0.2

True

0.4

0.6

-

Figure 2: Comparison of true and estimated model parameters. Each dot corresponds to a
single simulation, and the dashed lines indicate the identity line.
we find the values which maximize the product of probabilities of observed data (Equation 7)
across DHB. This maximum is found through a numerical optimization employing a simplex
algorithm [4] with initial values Î² = Î³ = 0.3.
To assess accuracy of this parameter estimation procedure we tested if the correct values
of parameters can be recovered from artificially generated data. We generated 20 artificial
datasets, each containing a similar amount of data that is available on the current history of
cases in New Zealand. For each dataset we randomly generated Î³ from uniform distribution
between 0.1 and 0.4, and generated Î² from uniform distribution between 0.05 and Î³ + 0.05.
With these parameters we generated 20 sequences (corresponding to 20 DHB) of âˆ†Rt . For
each DHB, the initial numbers of presymptomatic and infectious individuals E0 and I0 were
generated from uniform distribution between 1 and 10. The model was then simulated for
21 days according to Equations 1-5. For each dataset we estimated Î² and Î³ and compared
with true values from which data were generated.
Left and middle displays in Figure 2 compare the estimated values of parameters with
the true values. There is a significant correlation between true and recovered values (for
Î²: r = 0.85, p < 0.01, for Î³: r = 0.86, p < 0.01). Nevertheless there is a bias in the
estimation. The direction of this bias is not consistent, but depends on simulation parameters
(the recovery presented in Figure 2 was done with n = 10, but for n = 20 the bias is in
the opposite direction, not shown). Nevertheless the right display in Figure 2 shows that
the difference between parameters is accurately estimated (r = 0.97, p < 0.01). It is not
surprising that this difference is recovered more accurately, because it determines whether
the number of cases increases or decreases over days, which is a salient feature in the data.
By contrast, the individual values of Î² and Î³ influence less salient features (e.g. a probability
of a case after a long period with no cases), so they are more difficult to estimate.

Final estimation of probability
We estimated model parameters using the method described in the previous section with
parameter n = 40 on the basis of data available at: https://www.health.govt.nz/ourwork/diseases-and-conditions/covid-19-novel-coronavirus/covid-19-current-situation/covid-195

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

DHB
Auckland
Bay of Plenty
Canterbury
Capital and Coast
Counties Manukau
Hawkeâ€™s Bay
Hutt Valley
Lakes
Mid Central
Nelson Marlborough
Northland
South Canterbury
Southern
Tairawhiti
Taranaki
Waikato
Wairarapa
Waitemata
West Coast
Whanganui

Number of cases Days with no cases PÎ²Ì‚ PÎ²=0.1
150
0
0%
0%
41
1
4%
8%
126
0
0%
0%
59
1
1%
3%
89
0
0%
1%
38
6
15% 21%
15
13
74% 77%
12
1
25% 36%
25
1
9%
17%
32
11
33% 38%
23
2
15% 23%
13
1
17% 27%
194
1
0%
0%
4
5
61% 66%
10
17
90% 91%
167
0
0%
0%
3
16
92% 93%
184
0
0%
0%
4
13
91% 92%
8
1
44% 54%

PÎ²=0.4
0%
2%
0%
0%
0%
11%
71%
21%
6%
27%
11%
14%
0%
59%
88%
0%
91%
0%
90%
38%

Table 1: Estimates of the probabilities that different DHB in New Zealand are virus free.
These estimates are given in column PÎ²Ì‚ .
current-cases/. Form the available data we extracted the number of cases in each DHB on
each day between 25 March and 18 April 2020.
Subsequently we used the fitted model to predict probability of the population being virus
free P (Et = 0, It = 0|âˆ†R1:t ). To avoid the influence of the prior probability (that was set arbitrarily) on the estimate, for each DHB model was additionally run on the first week of data
10 times, i.e. the model was estimating the probability on the basis of extended sequence of
new cases composed of: [âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:7 , âˆ†R1:t ].
Due to uncertainty in estimates of individual parameters Î² and Î³ seen in Figure 2, we
additionally estimated the probabilities of being virus free using a model with Î² = 0.1 and
Î² = 0.4 and the parameter Î³ set on the basis of the estimated difference Î³ âˆ’ Î².

Results
On the basis of data on the number of cases in New Zealand in the period from 25 March
to 18 April 2020, we estimated parameters of the model as Î² = 0.26, Î³ = 0.42. The lower
value of a rate with which individuals become infected Î² than the rate in which cases are
reported Î³ corresponds to the decreasing number of cases over this period.
Table 1 gives estimated probability that the virus has been eradicated in individual DHBs
6

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

Estimated probability of erradication

1

0.8

0.6

0.4

0.2

0
0

5

10

15

20

Days with no cases

Figure 3: Relationship between the number of days with no new cases and the estimated
probability of regions being virus free.
(column PÎ²Ì‚ ). This probability is highly correlated with the number of days with no new
cases, also given in Table 1 (r = 0.90, p < 0.01). This relationship is also illustrated in
Figure 3. This relationship is not perfect, for example, the estimate for Whanganui is 44%
despite only a single day with no cases, because this most recent case was preceded by 14
days with no cases in this DHB. In agreement with occurrence of cases after such long delays,
even the regions without cases for 16 or 17 days have the probability estimate around 90%
(rather than 100%).
Two most right columns of Table 1 also list the probabilities computed with values of
Î² differing form that estimated (and Î³ set to preserve the difference between estimated Î³
and Î²). These probabilities do not differ much, suggesting that the computation of these
probabilities is robust to the biases in parameter estimates (Figure 2).

Discussion
This report presented a method for estimating the probability of regions being virus free.
This probability is highly correlated with the number of days without cases, suggesting that
the number of case-free days is a useful quantity to consider while making decisions and
informing the public. For example, Figure 4 illustrates how this quantity can be visualized.
The presented estimates have to be treated with great caution, because the model made
many simplifying assumptions which are not satisfied in practice. First, the model assumes
that all individuals with COVID-19 are symptomatic and identified, while another model of
COVID-19 spread in New Zealand assumed probability 0.33 of individuals being subclinical
[5]. It has been demonstrated that failing to detect accurately cases of disease increases

7

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

Number of days with no new cases

14

12

10

8

6

4

2

0

Figure 4: Map of New Zealand with different DHB colour coded according to the number of
days with no new cases.
the time one has to observe no new cases to be sure that a disease has been eradicated [6].
Nevertheless according to the website of the Ministry of Health (address in the Methods),
the fraction of cases due to community transmission (4%) is much lower than the number of
cases due to the contact with known individual (54%) which suggests that the majority of
infectious individuals is being identified in New Zealand.
Second, the model assumed that once individuals become diagnosed, they are isolated,
and no longer infect others. This assumption may also be not satisfied in practice. Third,
the model assumes that there is no movement of individuals between DHB while some of
the DHB (e.g. Auckland and Waitemata) include districts of the same city (e.g. Auckland),
so the assumptions on travel of individuals between DHB could to be included to refine the
model.

Acknowledgement
The author thanks Medical Research Council UK for support.

References
[1] Stephen A Lauer, Kyra H Grantz, Qifang Bi, Forrest K Jones, Qulu Zheng, Hannah R
Meredith, Andrew S Azman, Nicholas G Reich, and Justin Lessler. The incubation period

8

medRxiv preprint doi: https://doi.org/10.1101/2020.04.20.20073304; this version posted April 21, 2020. The copyright holder for this preprint
(which was not certified by peer review) is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.
It is made available under a CC-BY 4.0 International license .

of coronavirus disease 2019 (covid-19) from publicly reported confirmed cases: estimation
and application. Annals of internal medicine, 2020.
[2] Phenyo E Lekone and BaÌˆrbel F FinkenstaÌˆdt. Statistical inference in a stochastic epidemic
seir model with control intervention: Ebola as a case study. Biometrics, 62(4):1170â€“1177,
2006.
[3] Alex James, Shaun C Hendy, Michael J Plank, and Nicholas Steyn. Suppression and
mitigation strategies for control of covid-19 in new zealand. medRxiv, 2020.
[4] John A Nelder and Roger Mead. A simplex method for function minimization. The
computer journal, 7(4):308â€“313, 1965.
[5] Michael J Plank, Rachelle N Binny, Shaun C Hendy, Audrey Lustig, Alex James, and
Nicholas Steyn. A stochastic model for covid-19 spread and the effects of alert level 4 in
aotearoa new zealand. medRxiv, 2020.
[6] Robin N Thompson, Oliver W Morgan, and Katri Jalava. Rigorous surveillance is necessary for high confidence in end-of-outbreak declarations for ebola and other infectious
diseases. Philosophical Transactions of the Royal Society B, 374(1776):20180431, 2019.

9

